{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/manifest/v12.json", "dbt_version": "1.11.0rc2", "generated_at": "2026-02-04T03:53:09.044176Z", "invocation_id": "93eb8a25-ec49-48e5-a9d4-f5711f92d2f5", "invocation_started_at": "2026-01-30T05:04:22.877679+00:00", "env": {}, "project_name": "CGOncology_MDM", "project_id": "3dda500ffa2f9c0fcb36fa17b5a47e14", "user_id": "0aedbdb5-a74b-41cb-a09f-24113c76f86f", "send_anonymous_usage_stats": true, "adapter_type": "snowflake", "quoting": {"database": false, "schema": false, "identifier": false, "column": null}, "run_started_at": "2026-01-30T05:04:23.762681+00:00"}, "nodes": {"model.CGOncology_MDM.mdm_customer_master_hco": {"database": "CGONCOLOGY_TEST", "schema": "MDM", "name": "mdm_customer_master_hco", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "mdm/mdm_customer_master_hco.sql", "original_file_path": "models/mdm/mdm_customer_master_hco.sql", "unique_id": "model.CGOncology_MDM.mdm_customer_master_hco", "fqn": ["CGOncology_MDM", "mdm", "mdm_customer_master_hco"], "alias": "mdm_customer_master_hco", "checksum": {"name": "sha256", "checksum": "3135fe435a7b5c965ff8873c6ddaa04fa45897a7a36f29441d3594886a23c0d0"}, "config": {"enabled": true, "alias": null, "schema": "MDM", "database": null, "tags": ["layer_3_mdm", "customer_backbone", "customer_backbone", "mdm"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_3_mdm", "customer_backbone", "mdm"], "description": "HCO (Healthcare Organization) golden record master table.\nContains unified HCO data from DHC and Medscout sources.\n", "columns": {"kmk_hco_id": {"name": "kmk_hco_id", "description": "Primary key - internal HCO identifier (prefix 3 for L1-L3, prefix 4 for L4/PL)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "dh_id": {"name": "dh_id", "description": "Definitive Healthcare ID", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "org_name": {"name": "org_name", "description": "Organization name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/mdm/schema.yml", "build_path": null, "unrendered_config": {"schema": "MDM", "materialized": "table", "tags": ["customer_backbone", "mdm"]}, "created_at": 1770177079.26495, "relation_name": "CGONCOLOGY_TEST.MDM.mdm_customer_master_hco", "raw_code": "{{\n    config(\n        schema='MDM',\n        materialized='table',\n        tags=['customer_backbone', 'mdm']\n    )\n}}\n\n/*\nPROC-MDM-002: mdm_customer_master_hco - HCO Master (Golden Record)\nSource: mdm_customer_xref_hco\nBusiness Rules: SRV-001 to SRV-021, ACD-001 to ACD-006, CCC-001 to CCC-003, NAE-001 to NAE-003\n\nSurvivorship Rules (Priority Order: DHC > DDD > MEDSCOUT):\n- SRV-001: DHC has highest priority for all attributes\n- SRV-002: DDD fills gaps when DHC is NULL\n- SRV-003: MEDSCOUT fills gaps when DHC and DDD are both NULL (Jan 2026)\n- SRV-010: For matched records, use DHC values\n- SRV-011: For unmatched DDD, use DDD values as-is\n- SRV-012: For Medscout-only HCOs (no DHC or DDD match), use Medscout values\n\nNetwork Affiliation Enhancement (NAE) - Jan 2026:\n- NAE-001: Account has NO network, Parent HAS network \u2192 Inherit parent's network_id/network_parent_id\n- NAE-003: NEITHER has network, co-located \u2192 Set network_id = Parent's dh_id (parent becomes network)\n  Note: NAE-003 does NOT set network_parent_id (only network_id); network_parent inherited if parent has one\n- Parent Priority: Hospital Parent > PG Parent\n- Co-location: Same address_line_1 + city + state + zip_code\n\nOne golden record per KMK_HCO_ID (deduplicated from xref).\n\nNote: Territory columns, IS_ACADEMIC_FLAG, IS_CCC_FLAG, HAS_DDD_MATCH moved to ADM layer.\nDHC source is authoritative - DDD/MEDSCOUT supplements only when DHC is NULL.\n*/\n\nWITH xref AS (\n    SELECT * FROM {{ ref('mdm_customer_xref_hco') }}\n),\n\n-- Get DHC records as primary source\n-- Join to std_dh_hco to get primary_specialty for LUGPA classification\ndhc_records AS (\n    SELECT\n        x.kmk_hco_id,\n        x.source_id AS dh_id,\n        x.org_name,\n        x.hq_address_line_1,\n        x.hq_address_line_2,\n        x.hq_city,\n        x.hq_state,\n        x.hq_zip_code,\n        x.npi,\n        x.firm_type,\n        -- Primary Specialty (from std_dh_hco for LUGPA classification)\n        s.primary_specialty,\n        -- NOTE: account_type removed from MDM layer - only in ADM layer\n        -- Hospital Type\n        x.hospital_type,\n        x.hospital_ownership,\n        -- Network Hierarchy\n        x.network_id,\n        x.network_name,\n        x.network_firm_type,\n        x.network_parent_id,\n        x.network_parent_name,\n        x.network_parent_firm_type,\n        -- Hospital Parent\n        x.hospital_parent_id,\n        x.hospital_parent_name,\n        -- PG Parent\n        x.pg_parent_id,\n        x.pg_parent_name,\n        -- SF Parent\n        x.sf_parent_account_id,\n        x.sf_parent_account_name\n    FROM xref x\n    LEFT JOIN {{ ref('std_dh_hco') }} s ON CAST(x.source_id AS VARCHAR) = CAST(s.dh_id AS VARCHAR)\n    WHERE x.source_code = 'DHC'\n),\n\n-- Get DDD records as supplementary source\nddd_records AS (\n    SELECT\n        kmk_hco_id,\n        source_id AS ddd_outlet_id,\n        org_name AS ddd_org_name,\n        hq_address_line_1 AS ddd_address,\n        hq_city AS ddd_city,\n        hq_state AS ddd_state,\n        hq_zip_code AS ddd_zip\n    FROM xref\n    WHERE source_code = 'DDD'\n),\n\n-- Aggregate DDD outlets per KMK_HCO_ID (pick first if multiple)\nddd_agg AS (\n    SELECT\n        kmk_hco_id,\n        LISTAGG(DISTINCT ddd_outlet_id, ',') WITHIN GROUP (ORDER BY ddd_outlet_id) AS ddd_outlet_ids,\n        COUNT(DISTINCT ddd_outlet_id) AS ddd_outlet_count,\n        MAX(ddd_org_name) AS ddd_org_name,\n        MAX(ddd_address) AS ddd_address,\n        MAX(ddd_city) AS ddd_city,\n        MAX(ddd_state) AS ddd_state,\n        MAX(ddd_zip) AS ddd_zip\n    FROM ddd_records\n    GROUP BY kmk_hco_id\n),\n\n-- =============================================================================\n-- NAE: Network Affiliation Enhancement (NAE-001, NAE-003)\n-- Lookup parent network info and apply enhancement rules\n-- =============================================================================\n\n-- Hospital Parent network lookup (for NAE-001/003)\nhospital_parent_network AS (\n    SELECT\n        source_id AS parent_dh_id,\n        org_name AS hp_org_name,  -- For NAE-003: parent becomes network\n        network_id AS hp_network_id,\n        network_name AS hp_network_name,\n        network_parent_id AS hp_network_parent_id,  -- For inheriting network_parent\n        network_parent_name AS hp_network_parent_name,\n        network_parent_firm_type AS hp_network_parent_firm_type,\n        hq_address_line_1 AS hp_address,\n        hq_city AS hp_city,\n        hq_state AS hp_state,\n        hq_zip_code AS hp_zip\n    FROM xref\n    WHERE source_code = 'DHC'\n),\n\n-- PG Parent network lookup (for NAE-001/003)\npg_parent_network AS (\n    SELECT\n        source_id AS parent_dh_id,\n        org_name AS pg_org_name,  -- For NAE-003: parent becomes network\n        network_id AS pg_network_id,\n        network_name AS pg_network_name,\n        network_parent_id AS pg_network_parent_id,  -- For inheriting network_parent\n        network_parent_name AS pg_network_parent_name,\n        network_parent_firm_type AS pg_network_parent_firm_type,\n        hq_address_line_1 AS pg_address,\n        hq_city AS pg_city,\n        hq_state AS pg_state,\n        hq_zip_code AS pg_zip\n    FROM xref\n    WHERE source_code = 'DHC'\n),\n\n-- Apply NAE rules to DHC records\ndhc_with_nae AS (\n    SELECT\n        d.*,\n        -- NAE-001: Inherit network from parent if account has NO network\n        -- Priority: Hospital Parent > PG Parent\n        -- NAE-001: Inherit network from parent if parent has network\n        -- NAE-003: If NEITHER has network AND co-located, parent becomes the network (top-to-bottom)\n        CASE\n            -- Account already has network - keep it\n            WHEN d.network_id IS NOT NULL THEN d.network_id\n            -- NAE-001: Hospital Parent has network - inherit it\n            WHEN hp.hp_network_id IS NOT NULL THEN hp.hp_network_id\n            -- NAE-001: PG Parent has network - inherit it\n            WHEN pg.pg_network_id IS NOT NULL THEN pg.pg_network_id\n            -- NAE-003: NEITHER has network, co-located with Hospital Parent \u2192 Parent IS the network\n            WHEN d.hospital_parent_id IS NOT NULL\n                 AND hp.hp_network_id IS NULL\n                 AND UPPER(TRIM(d.hq_address_line_1)) = UPPER(TRIM(hp.hp_address))\n                 AND UPPER(TRIM(d.hq_city)) = UPPER(TRIM(hp.hp_city))\n                 AND UPPER(TRIM(d.hq_state)) = UPPER(TRIM(hp.hp_state))\n                 AND LEFT(d.hq_zip_code, 5) = LEFT(hp.hp_zip, 5)\n            THEN d.hospital_parent_id\n            -- NAE-003: NEITHER has network, co-located with PG Parent \u2192 Parent IS the network\n            WHEN d.pg_parent_id IS NOT NULL\n                 AND pg.pg_network_id IS NULL\n                 AND UPPER(TRIM(d.hq_address_line_1)) = UPPER(TRIM(pg.pg_address))\n                 AND UPPER(TRIM(d.hq_city)) = UPPER(TRIM(pg.pg_city))\n                 AND UPPER(TRIM(d.hq_state)) = UPPER(TRIM(pg.pg_state))\n                 AND LEFT(d.hq_zip_code, 5) = LEFT(pg.pg_zip, 5)\n            THEN d.pg_parent_id\n            ELSE NULL\n        END AS enhanced_network_id,\n\n        CASE\n            WHEN d.network_id IS NOT NULL THEN d.network_name\n            WHEN hp.hp_network_id IS NOT NULL THEN hp.hp_network_name\n            WHEN pg.pg_network_id IS NOT NULL THEN pg.pg_network_name\n            -- NAE-003: Get parent name when parent becomes network\n            WHEN d.hospital_parent_id IS NOT NULL\n                 AND hp.hp_network_id IS NULL\n                 AND UPPER(TRIM(d.hq_address_line_1)) = UPPER(TRIM(hp.hp_address))\n                 AND UPPER(TRIM(d.hq_city)) = UPPER(TRIM(hp.hp_city))\n                 AND UPPER(TRIM(d.hq_state)) = UPPER(TRIM(hp.hp_state))\n                 AND LEFT(d.hq_zip_code, 5) = LEFT(hp.hp_zip, 5)\n            THEN hp.hp_org_name\n            WHEN d.pg_parent_id IS NOT NULL\n                 AND pg.pg_network_id IS NULL\n                 AND UPPER(TRIM(d.hq_address_line_1)) = UPPER(TRIM(pg.pg_address))\n                 AND UPPER(TRIM(d.hq_city)) = UPPER(TRIM(pg.pg_city))\n                 AND UPPER(TRIM(d.hq_state)) = UPPER(TRIM(pg.pg_state))\n                 AND LEFT(d.hq_zip_code, 5) = LEFT(pg.pg_zip, 5)\n            THEN pg.pg_org_name\n            ELSE NULL\n        END AS enhanced_network_name,\n\n        -- Track source of network enhancement\n        CASE\n            WHEN d.network_id IS NOT NULL THEN 'ORIGINAL'\n            WHEN hp.hp_network_id IS NOT NULL THEN 'NAE-001-HP'  -- Inherited from Hospital Parent\n            WHEN pg.pg_network_id IS NOT NULL THEN 'NAE-001-PG'  -- Inherited from PG Parent\n            -- NAE-003: Parent becomes network (no inheritance, parent IS the network)\n            WHEN d.hospital_parent_id IS NOT NULL\n                 AND hp.hp_network_id IS NULL\n                 AND UPPER(TRIM(d.hq_address_line_1)) = UPPER(TRIM(hp.hp_address))\n                 AND UPPER(TRIM(d.hq_city)) = UPPER(TRIM(hp.hp_city))\n                 AND UPPER(TRIM(d.hq_state)) = UPPER(TRIM(hp.hp_state))\n                 AND LEFT(d.hq_zip_code, 5) = LEFT(hp.hp_zip, 5)\n            THEN 'NAE-003-HP'\n            WHEN d.pg_parent_id IS NOT NULL\n                 AND pg.pg_network_id IS NULL\n                 AND UPPER(TRIM(d.hq_address_line_1)) = UPPER(TRIM(pg.pg_address))\n                 AND UPPER(TRIM(d.hq_city)) = UPPER(TRIM(pg.pg_city))\n                 AND UPPER(TRIM(d.hq_state)) = UPPER(TRIM(pg.pg_state))\n                 AND LEFT(d.hq_zip_code, 5) = LEFT(pg.pg_zip, 5)\n            THEN 'NAE-003-PG'\n            ELSE NULL\n        END AS network_source,\n\n        -- network_parent_id: Keep original OR inherit from parent (if parent has one)\n        -- NAE-003 does NOT set network_parent_id (only network_id)\n        CASE\n            -- Account already has network_parent_id - keep it\n            WHEN d.network_parent_id IS NOT NULL THEN d.network_parent_id\n            -- Inherit parent's network_parent_id if they have one\n            WHEN hp.hp_network_parent_id IS NOT NULL THEN hp.hp_network_parent_id\n            WHEN pg.pg_network_parent_id IS NOT NULL THEN pg.pg_network_parent_id\n            -- Otherwise NULL (don't create fake network_parent)\n            ELSE NULL\n        END AS enhanced_network_parent_id,\n\n        -- network_parent_name: Must align with network_parent_id (inherit when id is inherited)\n        CASE\n            WHEN d.network_parent_id IS NOT NULL THEN d.network_parent_name\n            WHEN hp.hp_network_parent_id IS NOT NULL THEN hp.hp_network_parent_name\n            WHEN pg.pg_network_parent_id IS NOT NULL THEN pg.pg_network_parent_name\n            ELSE NULL\n        END AS enhanced_network_parent_name,\n\n        -- network_parent_firm_type: Must align with network_parent_id (inherit when id is inherited)\n        CASE\n            WHEN d.network_parent_id IS NOT NULL THEN d.network_parent_firm_type\n            WHEN hp.hp_network_parent_id IS NOT NULL THEN hp.hp_network_parent_firm_type\n            WHEN pg.pg_network_parent_id IS NOT NULL THEN pg.pg_network_parent_firm_type\n            ELSE NULL\n        END AS enhanced_network_parent_firm_type,\n\n        -- Track source of network_parent_id\n        CASE\n            WHEN d.network_parent_id IS NOT NULL THEN 'ORIGINAL'\n            WHEN hp.hp_network_parent_id IS NOT NULL THEN 'NAE-INHERIT-HP'\n            WHEN pg.pg_network_parent_id IS NOT NULL THEN 'NAE-INHERIT-PG'\n            ELSE NULL\n        END AS network_parent_source\n\n    FROM dhc_records d\n    LEFT JOIN hospital_parent_network hp ON d.hospital_parent_id = hp.parent_dh_id\n    LEFT JOIN pg_parent_network pg ON d.pg_parent_id = pg.parent_dh_id\n),\n\n-- MAT-246 FIX: Determine PRIMARY_SOURCE based on actual sources in XREF (priority: DHC > DDD > Medscout)\n-- This ensures PRIMARY_SOURCE correctly reflects which sources exist, not just which CTE the record came from\nsource_priority AS (\n    SELECT\n        kmk_hco_id,\n        CASE\n            WHEN MAX(CASE WHEN source_code = 'DHC' THEN 1 ELSE 0 END) = 1 THEN 'DHC'\n            WHEN MAX(CASE WHEN source_code = 'DDD' THEN 1 ELSE 0 END) = 1 THEN 'DDD'\n            WHEN MAX(CASE WHEN source_code = 'MEDSCOUT' THEN 1 ELSE 0 END) = 1 THEN 'MEDSCOUT'\n            ELSE 'UNKNOWN'\n        END AS primary_source_priority\n    FROM xref\n    WHERE source_code IN ('DHC', 'DDD', 'MEDSCOUT')\n    GROUP BY kmk_hco_id\n),\n\n-- Create golden record with survivorship (using NAE-enhanced network fields)\ngolden_records AS (\n    SELECT\n        d.kmk_hco_id,\n        d.dh_id,\n        ddd.ddd_outlet_ids,\n        -- MAT-246 FIX: Use source priority lookup to ensure DHC > DDD > Medscout priority\n        COALESCE(sp.primary_source_priority, 'DHC') AS primary_source,\n        -- Survivorship: DHC > DDD\n        COALESCE(d.org_name, ddd.ddd_org_name) AS org_name,\n        COALESCE(d.hq_address_line_1, ddd.ddd_address) AS hq_address_line_1,\n        d.hq_address_line_2,\n        COALESCE(d.hq_city, ddd.ddd_city) AS hq_city,\n        COALESCE(d.hq_state, ddd.ddd_state) AS hq_state,\n        COALESCE(d.hq_zip_code, ddd.ddd_zip) AS hq_zip_code,\n        d.npi,\n        d.firm_type,\n        -- Primary Specialty (from std_dh_hco for LUGPA classification)\n        d.primary_specialty,\n        -- NOTE: account_type removed from MDM layer - only in ADM layer\n        -- Hospital Type (from DHC only)\n        d.hospital_type,\n        d.hospital_ownership,\n        -- Network Hierarchy (NAE-enhanced: may inherit from Hospital/PG Parent)\n        d.enhanced_network_id AS network_id,\n        d.enhanced_network_name AS network_name,\n        d.network_firm_type,\n        d.enhanced_network_parent_id AS network_parent_id,\n        d.enhanced_network_parent_name AS network_parent_name,\n        d.enhanced_network_parent_firm_type AS network_parent_firm_type,\n        -- NAE tracking columns\n        d.network_source,\n        d.network_parent_source,\n        -- Hospital Parent (from DHC only)\n        d.hospital_parent_id,\n        d.hospital_parent_name,\n        -- PG Parent (from DHC only)\n        d.pg_parent_id,\n        d.pg_parent_name,\n        -- SF Parent (from DHC only)\n        d.sf_parent_account_id,\n        d.sf_parent_account_name,\n        -- Classification Flags (ACD-001 to ACD-006, CCC-001 to CCC-003)\n        -- NOTE: account_type removed from MDM layer - classification uses org_name/network keywords only\n        -- Full account_type classification happens in ADM layer\n        CASE\n            WHEN d.org_name ILIKE ANY ('%university%', '%school%', '%academic%', '%faculty%') THEN 'Y'\n            WHEN d.network_firm_type IN ('Hospital', 'Health System')\n                 AND d.enhanced_network_name ILIKE ANY ('%university%', '%school%', '%academic%', '%faculty%') THEN 'Y'\n            WHEN d.enhanced_network_parent_name ILIKE ANY ('%university%', '%school%', '%academic%', '%faculty%') THEN 'Y'\n            WHEN d.hospital_type ILIKE ANY ('%academic%', '%faculty practice%') THEN 'Y'\n            ELSE 'N'\n        END AS is_academic_flag,\n        CASE\n            WHEN d.network_firm_type = 'Health System' THEN 'Y'\n            WHEN d.enhanced_network_parent_firm_type = 'Health System' THEN 'Y'\n            ELSE 'N'\n        END AS is_ccc_flag,\n        COALESCE(ddd.ddd_outlet_count, 0) AS ddd_outlet_count,\n        CASE\n            WHEN ddd.kmk_hco_id IS NOT NULL THEN TRUE\n            ELSE FALSE\n        END AS has_ddd_match,\n        CURRENT_TIMESTAMP() AS created_date,\n        CURRENT_TIMESTAMP() AS modified_date\n    FROM dhc_with_nae d\n    LEFT JOIN ddd_agg ddd ON d.kmk_hco_id = ddd.kmk_hco_id\n    LEFT JOIN source_priority sp ON d.kmk_hco_id = sp.kmk_hco_id\n),\n\n-- Add DDD-only records (unmatched DDD outlets)\nddd_only AS (\n    SELECT\n        d.kmk_hco_id,\n        NULL AS dh_id,\n        d.ddd_outlet_ids,\n        -- MAT-246 FIX: Use source priority lookup to ensure DHC > DDD > Medscout priority\n        COALESCE(sp.primary_source_priority, 'DDD') AS primary_source,\n        d.ddd_org_name AS org_name,\n        d.ddd_address AS hq_address_line_1,\n        NULL AS hq_address_line_2,\n        d.ddd_city AS hq_city,\n        d.ddd_state AS hq_state,\n        d.ddd_zip AS hq_zip_code,\n        NULL AS npi,\n        NULL AS firm_type,\n        -- Primary Specialty (DDD doesn't have this)\n        NULL AS primary_specialty,\n        -- NOTE: account_type removed from MDM layer - only in ADM layer\n        -- Hospital Type (DDD doesn't have these)\n        NULL AS hospital_type,\n        NULL AS hospital_ownership,\n        -- Network Hierarchy (DDD doesn't have these)\n        NULL AS network_id,\n        NULL AS network_name,\n        NULL AS network_firm_type,\n        NULL AS network_parent_id,\n        NULL AS network_parent_name,\n        NULL AS network_parent_firm_type,\n        -- NAE tracking columns (N/A for DDD-only)\n        NULL AS network_source,\n        NULL AS network_parent_source,\n        -- Hospital Parent (DDD doesn't have these)\n        NULL AS hospital_parent_id,\n        NULL AS hospital_parent_name,\n        -- PG Parent (DDD doesn't have these)\n        NULL AS pg_parent_id,\n        NULL AS pg_parent_name,\n        -- SF Parent (DDD doesn't have these)\n        NULL AS sf_parent_account_id,\n        NULL AS sf_parent_account_name,\n        -- Classification Flags (DDD-only records don't have classification data)\n        'N' AS is_academic_flag,\n        'N' AS is_ccc_flag,\n        d.ddd_outlet_count,\n        TRUE AS has_ddd_match,\n        CURRENT_TIMESTAMP() AS created_date,\n        CURRENT_TIMESTAMP() AS modified_date\n    FROM ddd_agg d\n    LEFT JOIN source_priority sp ON d.kmk_hco_id = sp.kmk_hco_id\n    WHERE NOT EXISTS (\n        SELECT 1 FROM dhc_records dhc WHERE dhc.kmk_hco_id = d.kmk_hco_id\n    )\n      -- Exclude DDD outlets mapped to practice locations (they share PL's KMK_HCO_ID)\n      -- These DDD outlets will be surfaced via the practice_location_records CTE instead\n      AND NOT EXISTS (\n          SELECT 1 FROM xref pl\n          WHERE pl.source_code = 'PRACTICE_LOCATION'\n            AND pl.kmk_hco_id = d.kmk_hco_id\n      )\n),\n\n-- =============================================================================\n-- PHASE 6: Practice Locations (Consolidated into HCO Master)\n-- =============================================================================\n-- Practice locations are included as regular HCOs with firm_type='PRACTICE_LOCATION'\n-- ID Strategy (Option A): Reuse KMK_PL_ID as KMK_HCO_ID (same ID value)\n-- Inherit network/PE/territory from parent HCO via dh_id lookup (inherited from parent org)\npractice_location_records AS (\n    SELECT\n        pl.kmk_hco_id,  -- Reused from KMK_PL_ID (Option A: same ID value)\n        pl_source.dh_id,  -- Inherited from parent L3 org (links PL to its parent organization)\n        ddd.ddd_outlet_ids,  -- DDD outlets mapped to this PL (via shared KMK_HCO_ID)\n        'DHC' AS primary_source,  -- Practice locations come from DHC source\n        pl.org_name,\n        pl.hq_address_line_1,\n        pl.hq_address_line_2,\n        pl.hq_city,\n        pl.hq_state,\n        pl.hq_zip_code,\n        NULL AS npi,  -- Practice locations don't have NPI\n        'Practice Location' AS firm_type,  -- Use NAME format to match other firm types\n        -- Primary Specialty (practice locations don't have this)\n        NULL AS primary_specialty,\n        -- NOTE: account_type removed from MDM layer - only in ADM layer\n        -- Hospital Type (practice locations don't have these)\n        NULL AS hospital_type,\n        NULL AS hospital_ownership,\n        -- Network Hierarchy: DO NOT inherit from parent HCO\n        -- Practice locations are physical sites, not network entities\n        -- Parent relationships are handled via dh_id (inherited from parent org) in hierarchy assignment\n        NULL AS network_id,\n        NULL AS network_name,\n        NULL AS network_firm_type,\n        NULL AS network_parent_id,\n        NULL AS network_parent_name,\n        NULL AS network_parent_firm_type,\n        -- NAE tracking (N/A for practice locations - inherit from parent)\n        NULL AS network_source,\n        NULL AS network_parent_source,\n        -- Hospital Parent (inherit from parent HCO)\n        parent.hospital_parent_id,\n        parent.hospital_parent_name,\n        -- PG Parent (inherit from parent HCO)\n        parent.pg_parent_id,\n        parent.pg_parent_name,\n        -- SF Parent (inherit from parent HCO)\n        parent.sf_parent_account_id,\n        parent.sf_parent_account_name,\n        -- Classification Flags (inherit from parent HCO)\n        parent.is_academic_flag,\n        parent.is_ccc_flag,\n        COALESCE(ddd.ddd_outlet_count, 0) AS ddd_outlet_count,\n        CASE WHEN ddd.kmk_hco_id IS NOT NULL THEN TRUE ELSE FALSE END AS has_ddd_match,\n        CURRENT_TIMESTAMP() AS created_date,\n        CURRENT_TIMESTAMP() AS modified_date\n    FROM (\n        -- PHASE 6 FIX: Deduplicate practice locations by kmk_hco_id (same PL can have multiple dh_id in XREF due to SCD2)\n        SELECT DISTINCT\n            kmk_hco_id,\n            -- Pick one dh_id per kmk_hco_id (prefer current, then any)\n            -- Note: source_id for practice locations is kmk_pl_id, check against history kmk_pl_id\n            FIRST_VALUE(dh_id) OVER (PARTITION BY kmk_hco_id ORDER BY \n                CASE WHEN source_id IN (SELECT kmk_pl_id FROM {{ ref('std_dh_practice_location_hist') }} WHERE is_current = 'Y') THEN 1 ELSE 2 END,\n                source_id\n            ) AS dh_id,\n            -- Pick best values per kmk_hco_id\n            FIRST_VALUE(org_name) OVER (PARTITION BY kmk_hco_id ORDER BY source_id) AS org_name,\n            FIRST_VALUE(hq_address_line_1) OVER (PARTITION BY kmk_hco_id ORDER BY source_id) AS hq_address_line_1,\n            FIRST_VALUE(hq_address_line_2) OVER (PARTITION BY kmk_hco_id ORDER BY source_id) AS hq_address_line_2,\n            FIRST_VALUE(hq_city) OVER (PARTITION BY kmk_hco_id ORDER BY source_id) AS hq_city,\n            FIRST_VALUE(hq_state) OVER (PARTITION BY kmk_hco_id ORDER BY source_id) AS hq_state,\n            FIRST_VALUE(hq_zip_code) OVER (PARTITION BY kmk_hco_id ORDER BY source_id) AS hq_zip_code\n        FROM xref\n        WHERE source_code = 'PRACTICE_LOCATION'\n          AND kmk_hco_id IS NOT NULL\n        QUALIFY ROW_NUMBER() OVER (PARTITION BY kmk_hco_id ORDER BY \n            CASE WHEN source_id IN (SELECT kmk_pl_id FROM {{ ref('std_dh_practice_location_hist') }} WHERE is_current = 'Y') THEN 1 ELSE 2 END,\n            source_id\n        ) = 1\n    ) pl\n    -- Get dh_id (inherited from parent org) from source (read-only, do NOT modify std layer)\n    -- FIX 2026-01-11: Multiple history rows can share kmk_pl_id (same address, different dh_id)\n    -- Pick one history row per kmk_hco_id - prefer matching dh_id, then any\n    -- FIX 2026-01-12: Changed INNER JOIN to LEFT JOIN to include all practice locations from xref\n    -- Even if they don't have a matching history record (data quality edge case)\n    LEFT JOIN (\n        SELECT kmk_pl_id, dh_id,\n               ROW_NUMBER() OVER (PARTITION BY kmk_pl_id ORDER BY dh_id) AS rn\n        FROM {{ ref('std_dh_practice_location_hist') }}\n        WHERE is_current = 'Y'\n    ) pl_source\n        ON pl.kmk_hco_id = pl_source.kmk_pl_id\n        AND pl_source.rn = 1  -- Pick just one row per kmk_pl_id\n    -- Lookup parent HCO from golden_records using dh_id (inherited from parent org)\n    LEFT JOIN golden_records parent ON pl_source.dh_id = parent.dh_id\n    -- DDD outlet info: DDD outlets mapped to this PL share its KMK_HCO_ID\n    LEFT JOIN ddd_agg ddd ON pl.kmk_hco_id = ddd.kmk_hco_id\n),\n\n-- Final combined output\nfinal_output AS (\n    SELECT * FROM golden_records\n    UNION ALL\n    SELECT * FROM ddd_only\n    UNION ALL\n    SELECT * FROM practice_location_records\n),\n\n-- Valid parent dh_ids: non-PL HCOs that can be parents for practice locations\nvalid_parent_ids AS (\n    SELECT DISTINCT dh_id\n    FROM final_output\n    WHERE firm_type != 'Practice Location'\n      AND dh_id IS NOT NULL\n)\n\n-- Final SELECT with filters:\n-- FILTER 1: org_name IS NOT NULL - removes 33 historical DDD ghost records\n-- FILTER 2: orphan PLs removed - parent dh_id must exist in master\nSELECT\n    kmk_hco_id,\n    dh_id,\n    ddd_outlet_ids,\n    primary_source,\n    org_name,\n    hq_address_line_1,\n    hq_address_line_2,\n    hq_city,\n    hq_state,\n    hq_zip_code,\n    npi,\n    firm_type,\n    primary_specialty,\n    hospital_type,\n    hospital_ownership,\n    network_id,\n    network_name,\n    network_firm_type,\n    network_parent_id,\n    network_parent_name,\n    network_parent_firm_type,\n    network_source,\n    network_parent_source,\n    hospital_parent_id,\n    hospital_parent_name,\n    pg_parent_id,\n    pg_parent_name,\n    sf_parent_account_id,\n    sf_parent_account_name,\n    ddd_outlet_count,\n    created_date,\n    modified_date\nFROM final_output f\nWHERE f.org_name IS NOT NULL\n  AND (\n      COALESCE(f.firm_type, 'OTHER') != 'Practice Location'  -- DDD-only has NULL firm_type, treat as non-PL\n      OR f.dh_id IN (SELECT dh_id FROM valid_parent_ids)\n  )", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_xref_hco", "package": null, "version": null}, {"name": "std_dh_hco", "package": null, "version": null}, {"name": "std_dh_practice_location_hist", "package": null, "version": null}, {"name": "std_dh_practice_location_hist", "package": null, "version": null}, {"name": "std_dh_practice_location_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.mdm_customer_xref_hco", "model.CGOncology_MDM.std_dh_hco", "model.CGOncology_MDM.std_dh_practice_location_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["kmk_hco_id"], "time_spine": null}, "model.CGOncology_MDM.mdm_customer_xref_hcp": {"database": "CGONCOLOGY_TEST", "schema": "MDM", "name": "mdm_customer_xref_hcp", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "mdm/mdm_customer_xref_hcp.sql", "original_file_path": "models/mdm/mdm_customer_xref_hcp.sql", "unique_id": "model.CGOncology_MDM.mdm_customer_xref_hcp", "fqn": ["CGOncology_MDM", "mdm", "mdm_customer_xref_hcp"], "alias": "mdm_customer_xref_hcp", "checksum": {"name": "sha256", "checksum": "3d27d3bc32fb08f383e45d4a47d969daac4cd6ed26c573fe70b23a52470b6050"}, "config": {"enabled": true, "alias": null, "schema": "MDM", "database": null, "tags": ["layer_3_mdm", "customer_backbone", "customer_backbone", "mdm"], "meta": {}, "group": null, "materialized": "incremental", "incremental_strategy": "merge", "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": ["source_code", "source_id"], "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_3_mdm", "customer_backbone", "mdm"], "description": "HCP cross-reference table linking source system IDs to KMK_HCP_ID.\nGrain: One row per source system ID.\n", "columns": {"kmk_hcp_id": {"name": "kmk_hcp_id", "description": "Internal HCP identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "npi": {"name": "npi", "description": "National Provider Identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "source_code": {"name": "source_code", "description": "Source system name (DHC, MEDSCOUT)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/mdm/schema.yml", "build_path": null, "unrendered_config": {"schema": "MDM", "materialized": "incremental", "tags": ["customer_backbone", "mdm"], "unique_key": ["source_code", "source_id"], "incremental_strategy": "merge"}, "created_at": 1770177079.265532, "relation_name": "CGONCOLOGY_TEST.MDM.mdm_customer_xref_hcp", "raw_code": "{{\n    config(\n        schema='MDM',\n        materialized='incremental',\n        unique_key=['source_code', 'source_id'],\n        incremental_strategy='merge',\n        tags=['customer_backbone', 'mdm']\n    )\n}}\n\n/*\nPROC-MDM-003: mdm_customer_xref_hcp - HCP Cross-Reference\nSource: std_dh_hcp, std_medscout_hcp, match_medscout_dhc_hcp, mdm_customer_xref_hcp_hist\nBusiness Rules: ID-003, ID-011, ID-020-023, STD-042, SCD-001-004\n\nID Generation:\n- ID-003: HCP prefix '5'\n- ID-011: Check history (TEST tables) before generating new IDs\n- ID-020-023: Never lose existing IDs\n- STD-042: HCP matching key = DH_ID + NPI_NUMBER\n\nCross-Reference Structure:\n- One row per source_code + source_id combination\n- DHC HCPs are the anchor (identified by NPI)\n- Medscout HCPs link to their matched DHC HCP\n- Unmatched Medscout HCPs get their own KMK_HCP_ID\n\nHistorical ID Preservation:\n- Lookup existing IDs from mdm_customer_xref_hcp_hist (TEST)\n- Match on NPI_NUMBER (primary identifier for HCPs)\n- New records get IDs starting from MAX(existing) + 1\n- CRITICAL: Include historical records not in current source (100% ID preservation)\n\nSCD2 Columns:\n- source_hash: SHA2 hash for change detection\n- is_active_in_source: Y/N - exists in current source feed\n- is_current: Always 'Y' for current XREF (history has version tracking)\n- load_date: When this version was created\n*/\n\nWITH\n-- Current records for ID lookups (self-referential to break circular dependency)\n-- INCREMENTAL: Uses {{ this }} (freeze mode - preserves existing IDs)\n-- FULL REFRESH: Uses _hist table (preserves IDs from history)\nhist_current AS (\n    SELECT *\n    {% if is_incremental() %}\n    FROM {{ this }}\n    {% else %}\n    FROM {{ target.database }}.MDM.mdm_customer_xref_hcp_hist\n    {% endif %}\n    WHERE is_current = 'Y'\n),\n\n-- Historical IDs (lookup by NPI)\nhist_hcp_ids AS (\n    SELECT DISTINCT NPI, KMK_HCP_ID\n    FROM hist_current\n    WHERE NPI IS NOT NULL\n),\n\n-- Historical DHC records that no longer exist in current source\n-- These must be preserved for 100% ID continuity (is_active_in_source = 'N')\nhistorical_dhc_not_in_source AS (\n    SELECT\n        h.KMK_HCP_ID,\n        h.NPI,\n        h.FIRST_NAME,\n        h.MIDDLE_NAME,\n        h.LAST_NAME,\n        h.GENDER,\n        h.CREDENTIAL,\n        -- Apply specialty standardization to historical records (STD-SPEC-001)\n        {{ standardize_specialty('h.PRIMARY_SPECIALTY', 100) }} AS PRIMARY_SPECIALTY,\n        -- PRIMARY_SPECIALTY_GROUP from history table\n        h.PRIMARY_SPECIALTY_GROUP,\n        h.PRACTICE_ADDRESS_LINE_1,\n        h.PRACTICE_ADDRESS_LINE_2,\n        h.PRACTICE_CITY,\n        h.PRACTICE_STATE,\n        h.PRACTICE_ZIP_CODE,\n        h.PRIMARY_AFFILIATION_HOSPITAL_ID,\n        h.PRIMARY_AFFILIATION_HOSPITAL_NAME,\n        h.LARGEST_PG_AFFILIATION_ID,\n        h.LARGEST_PG_AFFILIATION_NAME\n    FROM hist_current h\n    LEFT JOIN {{ ref('std_dh_hcp') }} src ON h.NPI = src.npi\n    WHERE h.SOURCE_CODE = 'DHC'\n      AND h.NPI IS NOT NULL\n      AND src.npi IS NULL  -- Not in current source\n),\n\n-- Get MAX ID from history for new ID generation\nmax_hcp_id AS (\n    SELECT COALESCE(MAX(CAST(SUBSTRING(KMK_HCP_ID, 2) AS NUMBER)), 0) AS max_id\n    FROM hist_current\n),\n\ndh_hcps AS (\n    -- All DHC HCPs with historical ID lookup\n    -- NOTE: source_id = npi (dh_id was just NPI duplicated, not a real DH entity ID)\n    SELECT\n        'DHC' AS source_code,\n        s.npi AS source_id,\n        s.npi,\n        s.first_name,\n        NULL AS middle_name,  -- Not in source\n        s.last_name,\n        NULL AS gender,  -- Not in source\n        NULL AS credential,  -- Not in source\n        s.primary_specialty,\n        s.primary_specialty_group,\n        s.practice_address_line_1,\n        s.practice_address_line_2,\n        s.practice_city,  -- STD-006: Already normalized via ZIP lookup\n        s.practice_state,\n        s.practice_zip_code,\n        s.primary_affiliation_hospital_id,\n        s.primary_affiliation_hospital_name,\n        s.largest_pg_affiliation_id,\n        s.largest_pg_affiliation_name,\n        NULL AS match_type,\n        'SOURCE' AS match_status,\n        -- Historical ID lookup\n        hist.KMK_HCP_ID AS historical_kmk_hcp_id\n    FROM {{ ref('std_dh_hcp') }} s\n    LEFT JOIN hist_hcp_ids hist ON s.npi = hist.NPI\n),\n\nmedscout_hcps AS (\n    -- Medscout HCPs with their match status and historical ID lookup\n    -- MAT-243 FIX: If historical NPI match exists (same KMK_HCP_ID as DHC),\n    -- treat as NPI_EXACT match even if not in current std_dh_hcp\n    -- NOTE: dh_id removed (was just NPI duplicated for HCPs)\n    SELECT\n        'MEDSCOUT' AS source_code,\n        m.medscout_id AS source_id,\n        m.npi,\n        m.first_name,\n        NULL AS middle_name,  -- Medscout doesn't have middle name\n        m.last_name,\n        NULL AS gender,       -- Medscout doesn't have gender\n        NULL AS credential,   -- Medscout doesn't have credential\n        m.primary_specialty,\n        NULL AS primary_specialty_group,  -- Medscout doesn't have specialty_group\n        NULL AS practice_address_line_1,\n        NULL AS practice_address_line_2,\n        NULL AS practice_city,\n        NULL AS practice_state,\n        NULL AS practice_zip_code,\n        NULL AS primary_affiliation_hospital_id,\n        NULL AS primary_affiliation_hospital_name,\n        NULL AS largest_pg_affiliation_id,\n        NULL AS largest_pg_affiliation_name,\n        -- MAT-243: If historical ID exists via NPI, it's an NPI_EXACT match (historical)\n        COALESCE(mt.match_type,\n                 CASE WHEN hist.KMK_HCP_ID IS NOT NULL THEN 'NPI_EXACT' ELSE NULL END) AS match_type,\n        -- MAT-243: If historical ID exists, mark as HISTORICAL_MATCHED not UNMATCHED\n        CASE\n            WHEN mt.match_status IS NOT NULL AND mt.match_status != 'UNMATCHED' THEN mt.match_status\n            WHEN hist.KMK_HCP_ID IS NOT NULL THEN 'HISTORICAL_MATCHED'\n            ELSE COALESCE(mt.match_status, 'UNMATCHED')\n        END AS match_status,\n        -- Historical ID lookup (via NPI)\n        hist.KMK_HCP_ID AS historical_kmk_hcp_id\n    FROM {{ ref('std_medscout_hcp') }} m\n    LEFT JOIN {{ ref('match_medscout_dhc_hcp') }} mt ON m.medscout_id = mt.medscout_id\n    LEFT JOIN hist_hcp_ids hist ON m.npi = hist.NPI\n),\n\nhistorical_dhc_hcps AS (\n    -- Historical DHC records not in current source (for 100% ID preservation)\n    -- NOTE: source_id = npi (dh_id removed - was just NPI duplicated)\n    SELECT\n        'DHC' AS source_code,\n        h.NPI AS source_id,\n        h.NPI AS npi,\n        h.FIRST_NAME AS first_name,\n        h.MIDDLE_NAME AS middle_name,\n        h.LAST_NAME AS last_name,\n        h.GENDER AS gender,\n        h.CREDENTIAL AS credential,\n        h.PRIMARY_SPECIALTY AS primary_specialty,\n        NULL AS primary_specialty_group,  -- Historical records may not have this field\n        h.PRACTICE_ADDRESS_LINE_1 AS practice_address_line_1,\n        h.PRACTICE_ADDRESS_LINE_2 AS practice_address_line_2,\n        h.PRACTICE_CITY AS practice_city,\n        h.PRACTICE_STATE AS practice_state,\n        h.PRACTICE_ZIP_CODE AS practice_zip_code,\n        h.PRIMARY_AFFILIATION_HOSPITAL_ID,\n        h.PRIMARY_AFFILIATION_HOSPITAL_NAME,\n        h.LARGEST_PG_AFFILIATION_ID,\n        h.LARGEST_PG_AFFILIATION_NAME,\n        NULL AS match_type,\n        'HISTORICAL' AS match_status,\n        h.KMK_HCP_ID AS historical_kmk_hcp_id\n    FROM historical_dhc_not_in_source h\n),\n\n-- Combine all sources (current + historical)\nall_sources AS (\n    SELECT * FROM dh_hcps\n    UNION ALL\n    SELECT * FROM medscout_hcps\n    UNION ALL\n    SELECT * FROM historical_dhc_hcps\n),\n\n-- Generate KMK_HCP_ID with prefix '5'\n-- Priority: 1) Historical ID from DEV, 2) Generate new ID from MAX+1\n-- For matched Medscout, use the same KMK_HCP_ID as their DHC HCP\n-- NOTE: dh_id removed - match detection now uses match_status instead\nid_generation AS (\n    SELECT\n        source_code,\n        source_id,\n        npi,\n        first_name,\n        middle_name,\n        last_name,\n        gender,\n        credential,\n        primary_specialty,\n        primary_specialty_group,\n        practice_address_line_1,\n        practice_address_line_2,\n        practice_city,\n        practice_state,\n        practice_zip_code,\n        primary_affiliation_hospital_id,\n        primary_affiliation_hospital_name,\n        largest_pg_affiliation_id,\n        largest_pg_affiliation_name,\n        match_type,\n        match_status,\n        historical_kmk_hcp_id,\n        -- Generate new ID only if no historical ID exists\n        -- New IDs start from MAX(DEV) + 1\n        CASE\n            WHEN historical_kmk_hcp_id IS NOT NULL THEN\n                NULL  -- Use historical ID\n            WHEN source_code = 'DHC' THEN\n                '5' || LPAD(CAST(\n                    (SELECT max_id FROM max_hcp_id) +\n                    ROW_NUMBER() OVER (\n                        PARTITION BY (source_code = 'DHC' AND historical_kmk_hcp_id IS NULL)\n                        ORDER BY npi, source_id\n                    ) AS VARCHAR), 9, '0')\n            WHEN source_code = 'MEDSCOUT' AND match_status IN ('MATCHED', 'HISTORICAL_MATCHED') THEN\n                NULL  -- Will be filled via join to DHC's ID (matched via NPI)\n            ELSE\n                -- Unmatched Medscout without historical ID\n                '5' || LPAD(CAST(\n                    (SELECT max_id FROM max_hcp_id) +\n                    (SELECT COUNT(*) FROM dh_hcps WHERE historical_kmk_hcp_id IS NULL) +\n                    ROW_NUMBER() OVER (\n                        PARTITION BY (source_code = 'MEDSCOUT' AND match_status = 'UNMATCHED' AND historical_kmk_hcp_id IS NULL)\n                        ORDER BY source_id\n                    ) AS VARCHAR), 9, '0')\n        END AS generated_kmk_hcp_id\n    FROM all_sources\n),\n\n-- Create DHC lookup for matched Medscout HCPs\n-- Use historical ID if available, otherwise generated ID\ndhc_ids AS (\n    SELECT\n        npi,\n        COALESCE(historical_kmk_hcp_id, generated_kmk_hcp_id) AS kmk_hcp_id\n    FROM id_generation\n    WHERE source_code = 'DHC'\n),\n\n-- Final output with resolved KMK_HCP_IDs\n-- Priority: 1) Historical ID, 2) Generated ID, 3) DHC lookup (for matched Medscout)\n-- NOTE: dh_id removed - NPI is the identifier for HCPs\nfinal_output AS (\n    SELECT\n        COALESCE(i.historical_kmk_hcp_id, i.generated_kmk_hcp_id, d.kmk_hcp_id) AS kmk_hcp_id,\n        i.source_code,\n        i.source_id,\n        i.npi,\n        i.first_name,\n        i.middle_name,\n        i.last_name,\n        i.gender,\n        i.credential,\n        i.primary_specialty,\n        i.primary_specialty_group,\n        i.practice_address_line_1,\n        i.practice_address_line_2,\n        i.practice_city,\n        i.practice_state,\n        i.practice_zip_code,\n        i.primary_affiliation_hospital_id,\n        i.primary_affiliation_hospital_name,\n        i.largest_pg_affiliation_id,\n        i.largest_pg_affiliation_name,\n        i.match_type,\n        i.match_status,\n        -- SCD2 Columns\n        -- source_hash: SHA2 hash for change detection\n        SHA2(CONCAT_WS('|',\n            COALESCE(i.npi, ''),\n            COALESCE(i.first_name, ''),\n            COALESCE(i.middle_name, ''),\n            COALESCE(i.last_name, ''),\n            COALESCE(i.gender, ''),\n            COALESCE(i.credential, ''),\n            COALESCE(i.primary_specialty, ''),\n            COALESCE(i.practice_address_line_1, ''),\n            COALESCE(i.practice_city, ''),\n            COALESCE(i.practice_state, ''),\n            COALESCE(i.practice_zip_code, '')\n        ), 256) AS source_hash,\n        -- is_active_in_source: Y for current source records, N for historical-only\n        CASE WHEN i.match_status = 'HISTORICAL' THEN 'N' ELSE 'Y' END AS is_active_in_source,\n        -- is_current: Always Y for the current XREF table\n        'Y' AS is_current,\n        -- load_date: When this version was created\n        CURRENT_TIMESTAMP() AS load_date,\n        CURRENT_TIMESTAMP() AS created_date,\n        CURRENT_TIMESTAMP() AS modified_date\n    FROM id_generation i\n    LEFT JOIN dhc_ids d ON i.source_code = 'MEDSCOUT'\n                       AND i.match_status IN ('MATCHED', 'HISTORICAL_MATCHED')\n                       AND i.npi = d.npi\n)\n\nSELECT * FROM final_output\nWHERE kmk_hcp_id IS NOT NULL", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hcp", "package": null, "version": null}, {"name": "std_dh_hcp", "package": null, "version": null}, {"name": "std_medscout_hcp", "package": null, "version": null}, {"name": "match_medscout_dhc_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.is_incremental", "macro.CGOncology_MDM.standardize_specialty"], "nodes": ["model.CGOncology_MDM.std_dh_hcp", "model.CGOncology_MDM.std_medscout_hcp", "model.CGOncology_MDM.match_medscout_dhc_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}, "model.CGOncology_MDM.mdm_customer_xref_hcp_hist": {"database": "CGONCOLOGY_TEST", "schema": "MDM", "name": "mdm_customer_xref_hcp_hist", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "mdm/mdm_customer_xref_hcp_hist.sql", "original_file_path": "models/mdm/mdm_customer_xref_hcp_hist.sql", "unique_id": "model.CGOncology_MDM.mdm_customer_xref_hcp_hist", "fqn": ["CGOncology_MDM", "mdm", "mdm_customer_xref_hcp_hist"], "alias": "mdm_customer_xref_hcp_hist", "checksum": {"name": "sha256", "checksum": "c6860bce2927cf45303d694dce355b628c96f3d1ee8cac3a35acc6fc75f8e1d6"}, "config": {"enabled": true, "alias": null, "schema": "MDM", "database": null, "tags": ["layer_3_mdm", "customer_backbone", "customer_backbone", "mdm", "history"], "meta": {}, "group": null, "materialized": "incremental", "incremental_strategy": "merge", "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": ["kmk_hcp_id", "source_code", "version_number"], "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_3_mdm", "customer_backbone", "mdm", "history"], "description": "SCD2 history for HCP cross-reference changes.\n", "columns": {"kmk_hcp_id": {"name": "kmk_hcp_id", "description": "Internal HCP identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "version_number": {"name": "version_number", "description": "Sequential version", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "is_current": {"name": "is_current", "description": "Y for current version, N for historical", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/mdm/schema.yml", "build_path": null, "unrendered_config": {"schema": "MDM", "materialized": "incremental", "tags": ["customer_backbone", "mdm", "history"], "unique_key": ["kmk_hcp_id", "source_code", "version_number"], "incremental_strategy": "merge"}, "created_at": 1770177079.2661161, "relation_name": "CGONCOLOGY_TEST.MDM.mdm_customer_xref_hcp_hist", "raw_code": "{{\n    config(\n        schema='MDM',\n        materialized='incremental',\n        unique_key=['kmk_hcp_id', 'source_code', 'version_number'],\n        incremental_strategy='merge',\n        tags=['customer_backbone', 'mdm', 'history']\n    )\n}}\n\n/*\nMDM_CUSTOMER_XREF_HCP_HIST - HCP Cross-Reference History Table\nProcess Code: PROC-MDM-003b\nBusiness Rules: SCD-001 to SCD-015\n\nPurpose: Maintain SCD2 history of HCP cross-reference records.\n\nMODE:\n  - INITIAL LOAD: Create history from current XREF\n  - INCREMENTAL: Append new versions when XREF records change\n\nGrain: One row per (KMK_HCP_ID, SOURCE_CODE, VERSION_NUMBER)\n\nSCD2 Columns:\n- SOURCE_HASH: SHA2 hash for change detection\n- IS_ACTIVE_IN_SOURCE: Y/N - exists in latest source feed\n- IS_CURRENT: Y/N - latest version flag\n- VERSION_NUMBER: Sequential version per entity\n- LOAD_DATE: When this version was created\n*/\n\n{% if is_incremental() %}\n-- ============================================================================\n-- INCREMENTAL MODE: Append new versions when XREF records change\n-- ============================================================================\n\nWITH current_xref AS (\n    SELECT\n        KMK_HCP_ID,\n        SOURCE_CODE,\n        SOURCE_ID,\n        NPI,\n        FIRST_NAME,\n        MIDDLE_NAME,\n        LAST_NAME,\n        GENDER,\n        CREDENTIAL,\n        PRIMARY_SPECIALTY,\n        PRIMARY_SPECIALTY_GROUP,\n        PRACTICE_ADDRESS_LINE_1,\n        PRACTICE_ADDRESS_LINE_2,\n        PRACTICE_CITY,\n        PRACTICE_STATE,\n        PRACTICE_ZIP_CODE,\n        PRIMARY_AFFILIATION_HOSPITAL_ID,\n        PRIMARY_AFFILIATION_HOSPITAL_NAME,\n        LARGEST_PG_AFFILIATION_ID,\n        LARGEST_PG_AFFILIATION_NAME,\n        MATCH_TYPE,\n        MATCH_STATUS,\n        SOURCE_HASH,\n        IS_ACTIVE_IN_SOURCE,\n        CURRENT_DATE AS LOAD_DATE\n    FROM {{ ref('mdm_customer_xref_hcp') }}\n),\n\n-- Get current version from history for each entity\nhist_current AS (\n    SELECT KMK_HCP_ID, SOURCE_CODE, SOURCE_ID, VERSION_NUMBER, SOURCE_HASH\n    FROM {{ this }}\n    WHERE IS_CURRENT = 'Y'\n),\n\n-- Find records that changed (new hash != existing hash)\nchanged_records AS (\n    SELECT\n        c.*,\n        h.VERSION_NUMBER AS prev_version,\n        h.SOURCE_HASH AS prev_hash\n    FROM current_xref c\n    LEFT JOIN hist_current h\n        ON c.KMK_HCP_ID = h.KMK_HCP_ID AND c.SOURCE_CODE = h.SOURCE_CODE AND c.SOURCE_ID = h.SOURCE_ID\n    WHERE h.SOURCE_HASH IS NULL  -- New entity\n       OR h.SOURCE_HASH != c.SOURCE_HASH  -- Changed entity\n)\n\n-- Output new versions for changed records\nSELECT\n    c.KMK_HCP_ID,\n    c.SOURCE_CODE,\n    c.SOURCE_ID,\n    c.NPI,\n    c.FIRST_NAME,\n    c.MIDDLE_NAME,\n    c.LAST_NAME,\n    c.GENDER,\n    c.CREDENTIAL,\n    c.PRIMARY_SPECIALTY,\n    c.PRIMARY_SPECIALTY_GROUP,\n    c.PRACTICE_ADDRESS_LINE_1,\n    c.PRACTICE_ADDRESS_LINE_2,\n    c.PRACTICE_CITY,\n    c.PRACTICE_STATE,\n    c.PRACTICE_ZIP_CODE,\n    c.PRIMARY_AFFILIATION_HOSPITAL_ID,\n    c.PRIMARY_AFFILIATION_HOSPITAL_NAME,\n    c.LARGEST_PG_AFFILIATION_ID,\n    c.LARGEST_PG_AFFILIATION_NAME,\n    c.MATCH_TYPE,\n    c.MATCH_STATUS,\n    c.SOURCE_HASH,\n    c.IS_ACTIVE_IN_SOURCE,\n    'Y' AS IS_CURRENT,\n    COALESCE(c.prev_version, 0) + 1 AS VERSION_NUMBER,\n    c.LOAD_DATE,\n    NULL AS END_DATE\n\nFROM changed_records c\n\n{% else %}\n-- ============================================================================\n-- INITIAL LOAD: Create history from current XREF\n-- ============================================================================\n\nSELECT\n    KMK_HCP_ID,\n    SOURCE_CODE,\n    SOURCE_ID,\n    NPI,\n    FIRST_NAME,\n    MIDDLE_NAME,\n    LAST_NAME,\n    GENDER,\n    CREDENTIAL,\n    PRIMARY_SPECIALTY,\n    PRIMARY_SPECIALTY_GROUP,\n    PRACTICE_ADDRESS_LINE_1,\n    PRACTICE_ADDRESS_LINE_2,\n    PRACTICE_CITY,\n    PRACTICE_STATE,\n    PRACTICE_ZIP_CODE,\n    PRIMARY_AFFILIATION_HOSPITAL_ID,\n    PRIMARY_AFFILIATION_HOSPITAL_NAME,\n    LARGEST_PG_AFFILIATION_ID,\n    LARGEST_PG_AFFILIATION_NAME,\n    MATCH_TYPE,\n    MATCH_STATUS,\n    SOURCE_HASH,\n    IS_ACTIVE_IN_SOURCE,\n    'Y' AS IS_CURRENT,\n    1 AS VERSION_NUMBER,\n    CURRENT_DATE AS LOAD_DATE,\n    NULL AS END_DATE\nFROM {{ ref('mdm_customer_xref_hcp') }}\n\n{% endif %}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_xref_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.CGOncology_MDM.mdm_customer_xref_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["kmk_hcp_id", "version_number"], "time_spine": null}, "model.CGOncology_MDM.mdm_customer_xref_hco_hist": {"database": "CGONCOLOGY_TEST", "schema": "MDM", "name": "mdm_customer_xref_hco_hist", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "mdm/mdm_customer_xref_hco_hist.sql", "original_file_path": "models/mdm/mdm_customer_xref_hco_hist.sql", "unique_id": "model.CGOncology_MDM.mdm_customer_xref_hco_hist", "fqn": ["CGOncology_MDM", "mdm", "mdm_customer_xref_hco_hist"], "alias": "mdm_customer_xref_hco_hist", "checksum": {"name": "sha256", "checksum": "feed2b90b37a139d1f5762d2a72fcbfcc326e1792116ca93f6a7c73245504346"}, "config": {"enabled": true, "alias": null, "schema": "MDM", "database": null, "tags": ["layer_3_mdm", "customer_backbone", "customer_backbone", "mdm", "history"], "meta": {}, "group": null, "materialized": "incremental", "incremental_strategy": "merge", "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [{"sql": "UPDATE {{ this }} SET IS_CURRENT = 'N', END_DATE = CURRENT_DATE WHERE IS_CURRENT = 'Y' AND (KMK_HCO_ID, SOURCE_CODE, SOURCE_ID, VERSION_NUMBER) NOT IN (SELECT KMK_HCO_ID, SOURCE_CODE, SOURCE_ID, MAX(VERSION_NUMBER) FROM {{ this }} GROUP BY KMK_HCO_ID, SOURCE_CODE, SOURCE_ID)", "transaction": true, "index": null}], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": ["kmk_hco_id", "source_code", "source_id", "version_number"], "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_3_mdm", "customer_backbone", "mdm", "history"], "description": "SCD2 history for HCO cross-reference changes.\n", "columns": {"kmk_hco_id": {"name": "kmk_hco_id", "description": "Internal HCO identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "version_number": {"name": "version_number", "description": "Sequential version", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "is_current": {"name": "is_current", "description": "Y for current version, N for historical", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/mdm/schema.yml", "build_path": null, "unrendered_config": {"schema": "MDM", "materialized": "incremental", "tags": ["customer_backbone", "mdm", "history"], "unique_key": ["kmk_hco_id", "source_code", "source_id", "version_number"], "incremental_strategy": "merge", "post-hook": ["UPDATE {{ this }} SET IS_CURRENT = 'N', END_DATE = CURRENT_DATE WHERE IS_CURRENT = 'Y' AND (KMK_HCO_ID, SOURCE_CODE, SOURCE_ID, VERSION_NUMBER) NOT IN (SELECT KMK_HCO_ID, SOURCE_CODE, SOURCE_ID, MAX(VERSION_NUMBER) FROM {{ this }} GROUP BY KMK_HCO_ID, SOURCE_CODE, SOURCE_ID)"]}, "created_at": 1770177079.2659829, "relation_name": "CGONCOLOGY_TEST.MDM.mdm_customer_xref_hco_hist", "raw_code": "{{\n    config(\n        schema='MDM',\n        materialized='incremental',\n        unique_key=['kmk_hco_id', 'source_code', 'source_id', 'version_number'],\n        incremental_strategy='merge',\n        tags=['customer_backbone', 'mdm', 'history'],\n        post_hook=[\n            \"UPDATE {{ this }} SET IS_CURRENT = 'N', END_DATE = CURRENT_DATE WHERE IS_CURRENT = 'Y' AND (KMK_HCO_ID, SOURCE_CODE, SOURCE_ID, VERSION_NUMBER) NOT IN (SELECT KMK_HCO_ID, SOURCE_CODE, SOURCE_ID, MAX(VERSION_NUMBER) FROM {{ this }} GROUP BY KMK_HCO_ID, SOURCE_CODE, SOURCE_ID)\"\n        ]\n    )\n}}\n\n/*\nMDM_CUSTOMER_XREF_HCO_HIST - HCO Cross-Reference History Table\nProcess Code: PROC-MDM-001b\nBusiness Rules: SCD-001 to SCD-015\n\nPurpose: Maintain SCD2 history of HCO cross-reference records.\n\nMODE:\n  - INITIAL LOAD: Create history from current XREF\n  - INCREMENTAL: Append new versions when XREF records change\n\nGrain: One row per (KMK_HCO_ID, SOURCE_CODE, SOURCE_ID, VERSION_NUMBER)\n\nSCD2 Columns:\n- SOURCE_HASH: SHA2 hash for change detection\n- IS_ACTIVE_IN_SOURCE: Y/N - exists in latest source feed\n- IS_CURRENT: Y/N - latest version flag\n- VERSION_NUMBER: Sequential version per entity\n- LOAD_DATE: When this version was created\n*/\n\n{% if is_incremental() %}\n-- ============================================================================\n-- INCREMENTAL MODE: Append new versions when XREF records change\n-- ============================================================================\n\nWITH current_xref AS (\n    SELECT\n        KMK_HCO_ID,\n        SOURCE_CODE,\n        SOURCE_ID,\n        DH_ID,\n        NPI,\n        ORG_NAME,\n        FIRM_TYPE,\n        HOSPITAL_TYPE,\n        HOSPITAL_OWNERSHIP,\n        NETWORK_ID,\n        NETWORK_NAME,\n        NETWORK_FIRM_TYPE,\n        NETWORK_PARENT_ID,\n        NETWORK_PARENT_NAME,\n        NETWORK_PARENT_FIRM_TYPE,\n        HOSPITAL_PARENT_ID,\n        HOSPITAL_PARENT_NAME,\n        PG_PARENT_ID,\n        PG_PARENT_NAME,\n        SF_PARENT_ACCOUNT_ID,\n        SF_PARENT_ACCOUNT_NAME,\n        HQ_ADDRESS_LINE_1,\n        HQ_ADDRESS_LINE_2,\n        HQ_CITY,\n        HQ_STATE,\n        HQ_ZIP_CODE,\n        MATCH_SCORE,\n        MATCH_STATUS,\n        SOURCE_HASH,\n        IS_ACTIVE_IN_SOURCE,\n        CURRENT_DATE AS LOAD_DATE\n    FROM {{ ref('mdm_customer_xref_hco') }}\n),\n\n-- Get current version from history for each entity\nhist_current AS (\n    SELECT KMK_HCO_ID, SOURCE_CODE, SOURCE_ID, VERSION_NUMBER, SOURCE_HASH\n    FROM {{ this }}\n    WHERE IS_CURRENT = 'Y'\n),\n\n-- Find records that changed (new hash != existing hash)\nchanged_records AS (\n    SELECT\n        c.*,\n        h.VERSION_NUMBER AS prev_version,\n        h.SOURCE_HASH AS prev_hash\n    FROM current_xref c\n    LEFT JOIN hist_current h\n        ON c.KMK_HCO_ID = h.KMK_HCO_ID AND c.SOURCE_CODE = h.SOURCE_CODE AND c.SOURCE_ID = h.SOURCE_ID\n    WHERE h.SOURCE_HASH IS NULL  -- New entity\n       OR h.SOURCE_HASH != c.SOURCE_HASH  -- Changed entity\n)\n\n-- Output new versions for changed records\nSELECT\n    c.KMK_HCO_ID,\n    c.SOURCE_CODE,\n    c.SOURCE_ID,\n    c.DH_ID,\n    c.NPI,\n    c.ORG_NAME,\n    c.FIRM_TYPE,\n    c.HOSPITAL_TYPE,\n    c.HOSPITAL_OWNERSHIP,\n    c.NETWORK_ID,\n    c.NETWORK_NAME,\n    c.NETWORK_FIRM_TYPE,\n    c.NETWORK_PARENT_ID,\n    c.NETWORK_PARENT_NAME,\n    c.NETWORK_PARENT_FIRM_TYPE,\n    c.HOSPITAL_PARENT_ID,\n    c.HOSPITAL_PARENT_NAME,\n    c.PG_PARENT_ID,\n    c.PG_PARENT_NAME,\n    c.SF_PARENT_ACCOUNT_ID,\n    c.SF_PARENT_ACCOUNT_NAME,\n    c.HQ_ADDRESS_LINE_1,\n    c.HQ_ADDRESS_LINE_2,\n    c.HQ_CITY,\n    c.HQ_STATE,\n    c.HQ_ZIP_CODE,\n    c.MATCH_SCORE,\n    c.MATCH_STATUS,\n    c.SOURCE_HASH,\n    c.IS_ACTIVE_IN_SOURCE,\n    'Y' AS IS_CURRENT,\n    COALESCE(c.prev_version, 0) + 1 AS VERSION_NUMBER,\n    c.LOAD_DATE,\n    NULL AS END_DATE\n\nFROM changed_records c\n\n{% else %}\n-- ============================================================================\n-- INITIAL LOAD: Create history from current XREF\n-- ============================================================================\n\nSELECT\n    KMK_HCO_ID,\n    SOURCE_CODE,\n    SOURCE_ID,\n    DH_ID,\n    NPI,\n    ORG_NAME,\n    FIRM_TYPE,\n    HOSPITAL_TYPE,\n    HOSPITAL_OWNERSHIP,\n    NETWORK_ID,\n    NETWORK_NAME,\n    NETWORK_FIRM_TYPE,\n    NETWORK_PARENT_ID,\n    NETWORK_PARENT_NAME,\n    NETWORK_PARENT_FIRM_TYPE,\n    HOSPITAL_PARENT_ID,\n    HOSPITAL_PARENT_NAME,\n    PG_PARENT_ID,\n    PG_PARENT_NAME,\n    SF_PARENT_ACCOUNT_ID,\n    SF_PARENT_ACCOUNT_NAME,\n    HQ_ADDRESS_LINE_1,\n    HQ_ADDRESS_LINE_2,\n    HQ_CITY,\n    HQ_STATE,\n    HQ_ZIP_CODE,\n    MATCH_SCORE,\n    MATCH_STATUS,\n    SOURCE_HASH,\n    IS_ACTIVE_IN_SOURCE,\n    'Y' AS IS_CURRENT,\n    1 AS VERSION_NUMBER,\n    CURRENT_DATE AS LOAD_DATE,\n    NULL AS END_DATE\nFROM {{ ref('mdm_customer_xref_hco') }}\n\n{% endif %}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_xref_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.CGOncology_MDM.mdm_customer_xref_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["kmk_hco_id", "version_number"], "time_spine": null}, "model.CGOncology_MDM.mdm_best_affiliation_hist": {"database": "CGONCOLOGY_TEST", "schema": "MDM", "name": "mdm_best_affiliation_hist", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "mdm/mdm_best_affiliation_hist.sql", "original_file_path": "models/mdm/mdm_best_affiliation_hist.sql", "unique_id": "model.CGOncology_MDM.mdm_best_affiliation_hist", "fqn": ["CGOncology_MDM", "mdm", "mdm_best_affiliation_hist"], "alias": "mdm_best_affiliation_hist", "checksum": {"name": "sha256", "checksum": "42f12023d658894fb252cf2b38e5d46f8cc907f6d5c2cc9cd02ba75a4b32d076"}, "config": {"enabled": true, "alias": null, "schema": "MDM", "database": null, "tags": ["layer_3_mdm", "customer_backbone", "customer_backbone", "affiliation", "history"], "meta": {}, "group": null, "materialized": "incremental", "incremental_strategy": "merge", "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [{"sql": "CREATE OR REPLACE TABLE {{ this }}_backup LIKE {{ this }}", "transaction": true, "index": null}, {"sql": "TRUNCATE TABLE {{ this }}_backup", "transaction": true, "index": null}, {"sql": "INSERT INTO {{ this }}_backup SELECT * FROM {{ this }}", "transaction": true, "index": null}], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": ["npi", "version_number"], "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null, "merge_update_columns": ["end_date", "is_current"]}, "tags": ["layer_3_mdm", "customer_backbone", "affiliation", "history"], "description": "SCD2 history for best affiliation changes.\nTracks changes to HCP's best HCO affiliation over time.\n", "columns": {"npi": {"name": "npi", "description": "HCP National Provider Identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "version_number": {"name": "version_number", "description": "Sequential version per HCP (1, 2, 3...)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "is_current": {"name": "is_current", "description": "Y for current version, N for historical", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/mdm/schema.yml", "build_path": null, "unrendered_config": {"schema": "MDM", "materialized": "incremental", "tags": ["customer_backbone", "affiliation", "history"], "unique_key": ["npi", "version_number"], "incremental_strategy": "merge", "merge_update_columns": ["end_date", "is_current"], "pre-hook": ["CREATE OR REPLACE TABLE {{ this }}_backup LIKE {{ this }}", "TRUNCATE TABLE {{ this }}_backup", "INSERT INTO {{ this }}_backup SELECT * FROM {{ this }}"]}, "created_at": 1770177079.265845, "relation_name": "CGONCOLOGY_TEST.MDM.mdm_best_affiliation_hist", "raw_code": "{{ config(\n    schema='MDM',\n    materialized='incremental',\n    unique_key=['npi', 'version_number'],\n    incremental_strategy='merge',\n    merge_update_columns=['end_date', 'is_current'],\n    tags=['customer_backbone', 'affiliation', 'history'],\n    pre_hook=[\n        \"CREATE OR REPLACE TABLE {{ this }}_backup LIKE {{ this }}\",\n        \"TRUNCATE TABLE {{ this }}_backup\",\n        \"INSERT INTO {{ this }}_backup SELECT * FROM {{ this }}\"\n    ] if not is_incremental() else []\n) }}\n\n/*\nMDM_BEST_AFFILIATION_HIST - SCD2 History for Best Affiliation\nProcess Code: PROC-MDM-HIST-002\nBusiness Rules: SCD-001 to SCD-010\n\nPurpose: Track changes to HCP's best HCO affiliation over time.\nGrain: One row per (NPI_NUMBER, VERSION_NUMBER)\n\nFULL REFRESH SUPPORT (Jan 2026):\n- Pre-hook backs up existing history before refresh\n- Full refresh reads from backup, compares with base, rebuilds everything\n- Ensures 100% sync between base and history tables\n\nSCD2 Columns:\n- VERSION_NUMBER: Sequential per HCP (1, 2, 3...)\n- EFFECTIVE_DATE: When this affiliation became active\n- END_DATE: When superseded (NULL = current)\n- IS_CURRENT: 'Y' for latest version\n*/\n\n-- Current results from base table\n-- NOTE: account_type removed to break circular dependency with adm_hco_master (Jan 2026)\nWITH base AS (\n    SELECT\n        v.npi,\n        v.kmk_hcp_id,\n        v.first_name || ' ' || v.last_name AS hcp_full_name,\n        v.primary_specialty,\n        v.best_kmk_hco_id,\n        v.best_hco_dh_id,\n        v.best_hco_name,\n        v.best_hco_firm_type,\n        v.affiliation_type,\n        v.strength_of_affiliation,\n        v.mapping_rule,\n        MD5(COALESCE(v.best_kmk_hco_id, '') || '|' || COALESCE(v.mapping_rule, '')) AS source_hash\n    FROM {{ ref('mdm_best_affiliation') }} v\n),\n\n{% if is_incremental() %}\n-- ============================================================================\n-- INCREMENTAL MODE: Compare with existing history\n-- ============================================================================\n\nprev_history AS (\n    SELECT * FROM {{ this }}\n),\n\nprev_current AS (\n    SELECT * FROM prev_history WHERE is_current = 'Y'\n),\n\n{% else %}\n-- ============================================================================\n-- FULL REFRESH MODE: Read from backup table\n-- ============================================================================\n\nprev_history AS (\n    SELECT * FROM {{ this }}_backup\n),\n\nprev_current AS (\n    SELECT * FROM prev_history WHERE is_current = 'Y'\n),\n\n{% endif %}\n\n-- Detect changes: NEW, CHANGED, DELETED, SAME\nchange_detection AS (\n    SELECT\n        COALESCE(b.npi, h.npi) AS npi,\n        b.kmk_hcp_id,\n        b.hcp_full_name,\n        b.primary_specialty,\n        b.best_kmk_hco_id,\n        b.best_hco_dh_id,\n        b.best_hco_name,\n        b.best_hco_firm_type,\n        b.affiliation_type,\n        b.strength_of_affiliation,\n        b.mapping_rule,\n        b.source_hash,\n        h.best_kmk_hco_id AS prev_kmk_hco_id,\n        h.version_number AS prev_version,\n        h.effective_date AS prev_effective_date,\n        CASE\n            WHEN h.npi IS NULL THEN 'NEW'\n            WHEN b.npi IS NULL THEN 'DELETED'\n            WHEN COALESCE(b.best_kmk_hco_id, '') != COALESCE(h.best_kmk_hco_id, '') THEN 'CHANGED'\n            ELSE 'SAME'\n        END AS change_type\n    FROM base b\n    FULL OUTER JOIN prev_current h ON b.npi = h.npi\n),\n\n-- OUTPUT 1: Closed historical records (keep as-is)\nclosed_historical AS (\n    SELECT\n        npi,\n        kmk_hcp_id,\n        hcp_full_name,\n        primary_specialty,\n        best_kmk_hco_id,\n        best_hco_dh_id,\n        best_hco_name,\n        best_hco_firm_type,\n        affiliation_type,\n        strength_of_affiliation,\n        mapping_rule,\n        source_hash,\n        version_number,\n        effective_date,\n        end_date,\n        is_current,\n        load_timestamp,\n        data_date\n    FROM prev_history\n    WHERE is_current = 'N'\n),\n\n-- OUTPUT 2: Close old records for CHANGED/DELETED HCPs\nrecords_to_close AS (\n    SELECT\n        h.npi,\n        h.kmk_hcp_id,\n        h.hcp_full_name,\n        h.primary_specialty,\n        h.best_kmk_hco_id,\n        h.best_hco_dh_id,\n        h.best_hco_name,\n        h.best_hco_firm_type,\n        h.affiliation_type,\n        h.strength_of_affiliation,\n        h.mapping_rule,\n        h.source_hash,\n        h.version_number,\n        h.effective_date,\n        CASE\n            WHEN h.effective_date = CURRENT_DATE() THEN h.effective_date\n            ELSE CURRENT_DATE() - 1\n        END AS end_date,\n        'N' AS is_current,\n        h.load_timestamp,\n        h.data_date\n    FROM prev_current h\n    INNER JOIN change_detection c ON h.npi = c.npi\n    WHERE c.change_type IN ('CHANGED', 'DELETED')\n),\n\n-- OUTPUT 3: New current records for NEW/CHANGED HCPs\nnew_current_records AS (\n    SELECT\n        c.npi,\n        c.kmk_hcp_id,\n        c.hcp_full_name,\n        c.primary_specialty,\n        c.best_kmk_hco_id,\n        c.best_hco_dh_id,\n        c.best_hco_name,\n        c.best_hco_firm_type,\n        c.affiliation_type,\n        c.strength_of_affiliation,\n        c.mapping_rule,\n        c.source_hash,\n        COALESCE(c.prev_version, 0) + 1 AS version_number,\n        CURRENT_DATE() AS effective_date,\n        CAST(NULL AS DATE) AS end_date,\n        'Y' AS is_current,\n        CURRENT_TIMESTAMP() AS load_timestamp,\n        CURRENT_DATE() AS data_date\n    FROM change_detection c\n    WHERE c.change_type IN ('NEW', 'CHANGED')\n),\n\n-- OUTPUT 4: Unchanged current records (keep as-is)\nunchanged_current AS (\n    SELECT\n        h.npi,\n        h.kmk_hcp_id,\n        h.hcp_full_name,\n        h.primary_specialty,\n        h.best_kmk_hco_id,\n        h.best_hco_dh_id,\n        h.best_hco_name,\n        h.best_hco_firm_type,\n        h.affiliation_type,\n        h.strength_of_affiliation,\n        h.mapping_rule,\n        h.source_hash,\n        h.version_number,\n        h.effective_date,\n        h.end_date,\n        h.is_current,\n        h.load_timestamp,\n        h.data_date\n    FROM prev_current h\n    INNER JOIN change_detection c ON h.npi = c.npi\n    WHERE c.change_type = 'SAME'\n)\n\n{% if is_incremental() %}\n-- INCREMENTAL: Only output changed records (MERGE will update/insert)\nSELECT * FROM records_to_close\nUNION ALL\nSELECT * FROM new_current_records\n{% else %}\n-- FULL REFRESH: Output everything (rebuild entire table)\nSELECT * FROM closed_historical\nUNION ALL\nSELECT * FROM records_to_close\nUNION ALL\nSELECT * FROM new_current_records\nUNION ALL\nSELECT * FROM unchanged_current\n{% endif %}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_best_affiliation", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.CGOncology_MDM.mdm_best_affiliation"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["npi", "version_number"], "time_spine": null}, "model.CGOncology_MDM.mdm_ref_market_definition": {"database": "CGONCOLOGY_TEST", "schema": "MDM", "name": "mdm_ref_market_definition", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "mdm/mdm_ref_market_definition.sql", "original_file_path": "models/mdm/mdm_ref_market_definition.sql", "unique_id": "model.CGOncology_MDM.mdm_ref_market_definition", "fqn": ["CGOncology_MDM", "mdm", "mdm_ref_market_definition"], "alias": "mdm_ref_market_definition", "checksum": {"name": "sha256", "checksum": "274756812c20750d726c71df10db723b4ca50933b2d786f270852842317b17d8"}, "config": {"enabled": true, "alias": null, "schema": "MDM", "database": null, "tags": ["layer_3_mdm", "customer_backbone", "customer_backbone", "mdm", "reference"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_3_mdm", "customer_backbone", "mdm", "reference"], "description": "Unified market definition reference table in the MDM layer.\n\nCombines:\n- DX diagnosis codes (from seed `seed_bc_dx_code_mapping`)\n- PX procedure codes (from seed `seed_bc_px_code_mapping`)\n- RX NDC codes (from seed `seed_bc_rx_ndc_mapping`)\n- DDD sub-categories (from seed `config_ddd_sub_category`) with `code_type='Sub-category'` and `data_source='DDD'`\n\nDocumentation note: BC patient identification requires at least one DX code and one (PX or RX) code.\nThis rule is stored in the `comment` column for DX/PX/RX rows.\n", "columns": {"code_type": {"name": "code_type", "description": "Type of code: DX, PX, RX, or Sub-category.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "code": {"name": "code", "description": "Code value: diagnosis code (DX), procedure/HCPCS/ICD code (PX), NDC11 (RX), or DDD sub_category (Sub-category).", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "code_description": {"name": "code_description", "description": "Human-readable description. For RX, includes product name merged into description.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "data_source": {"name": "data_source", "description": "Source system identifier. Populated as 'DDD' for Sub-category rows; NULL for DX/PX/RX.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "treatment_category": {"name": "treatment_category", "description": "Treatment category for DX/PX/RX; NULL for Sub-category.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "bc_patient_pool_flag": {"name": "bc_patient_pool_flag", "description": "BC patient pool flag ('Y' or 'N') for DX/PX/RX; NULL for Sub-category.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "class_of_trade": {"name": "class_of_trade", "description": "DDD class of trade for Sub-category; NULL for DX/PX/RX.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "is_excluded": {"name": "is_excluded", "description": "DDD exclusion flag for Sub-category; NULL for DX/PX/RX.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "comment": {"name": "comment", "description": "Business rule notes. For DX/PX/RX includes BC patient criteria: at least one DX and one (PX or RX).", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/mdm/schema.yml", "build_path": null, "unrendered_config": {"schema": "MDM", "materialized": "table", "tags": ["customer_backbone", "mdm", "reference"]}, "created_at": 1770177079.264778, "relation_name": "CGONCOLOGY_TEST.MDM.mdm_ref_market_definition", "raw_code": "{{\n    config(\n        schema='MDM',\n        materialized='table',\n        tags=['customer_backbone', 'mdm', 'reference']\n    )\n}}\n\n/*\nMDM_REF_MARKET_DEFINITION - Unified market definition reference table\n\nPurpose:\n- Consolidate BC market definition reference artifacts into a single MDM table:\n  - DX diagnosis codes (seed_bc_dx_code_mapping)\n  - PX procedure codes (seed_bc_px_code_mapping)\n  - RX NDC codes (seed_bc_rx_ndc_mapping)\n  - DDD sub-category market definition (config_ddd_sub_category)\n\nBusiness Rule Note:\n- \"BC patients require at least one DX code and one (PX or RX) code\"\n  This is documented via the COMMENT column for DX/PX/RX rows.\n*/\n\nWITH dx AS (\n    SELECT\n        'DX'::VARCHAR(20) AS code_type,\n        DIAGNOSIS_CODE::VARCHAR(50) AS code,\n        CODE_DESCRIPTION::VARCHAR(500) AS code_description,\n        NULL::VARCHAR(50) AS data_source,\n        TREATMENT_CATEGORY::VARCHAR(100) AS treatment_category,\n        BC_PATIENT_POOL_FLAG::VARCHAR(1) AS bc_patient_pool_flag,\n        NULL::VARCHAR(50) AS class_of_trade,\n        NULL::BOOLEAN AS is_excluded,\n        'BC patients require at least one DX code and one (PX or RX) code'::VARCHAR(1000) AS comment\n    FROM {{ ref('seed_bc_dx_code_mapping') }}\n),\n\npx AS (\n    SELECT\n        'PX'::VARCHAR(20) AS code_type,\n        PROCEDURE_CODE::VARCHAR(50) AS code,\n        CODE_DESCRIPTION::VARCHAR(500) AS code_description,\n        NULL::VARCHAR(50) AS data_source,\n        TREATMENT_CATEGORY::VARCHAR(100) AS treatment_category,\n        BC_PATIENT_POOL_FLAG::VARCHAR(1) AS bc_patient_pool_flag,\n        NULL::VARCHAR(50) AS class_of_trade,\n        NULL::BOOLEAN AS is_excluded,\n        'BC patients require at least one DX code and one (PX or RX) code'::VARCHAR(1000) AS comment\n    FROM {{ ref('seed_bc_px_code_mapping') }}\n),\n\nrx AS (\n    SELECT\n        'RX'::VARCHAR(20) AS code_type,\n        NDC11::VARCHAR(50) AS code,\n        PRODUCT_NAME_REFERENCE::VARCHAR(500) AS code_description,\n        NULL::VARCHAR(50) AS data_source,\n        TREATMENT_CATEGORY::VARCHAR(100) AS treatment_category,\n        BC_PATIENT_POOL_FLAG::VARCHAR(1) AS bc_patient_pool_flag,\n        NULL::VARCHAR(50) AS class_of_trade,\n        NULL::BOOLEAN AS is_excluded,\n        'BC patients require at least one DX code and one (PX or RX) code'::VARCHAR(1000) AS comment\n    FROM {{ ref('seed_bc_rx_ndc_mapping') }}\n),\n\nddd_sub_category AS (\n    SELECT\n        'Sub-category'::VARCHAR(20) AS code_type,\n        SUB_CATEGORY::VARCHAR(50) AS code,\n        DESCRIPTION::VARCHAR(500) AS code_description,\n        'DDD'::VARCHAR(50) AS data_source,\n        NULL::VARCHAR(100) AS treatment_category,\n        NULL::VARCHAR(1) AS bc_patient_pool_flag,\n        CLASS_OF_TRADE::VARCHAR(50) AS class_of_trade,\n        TRY_TO_BOOLEAN(IS_EXCLUDED)::BOOLEAN AS is_excluded,\n        NULL::VARCHAR(1000) AS comment\n    FROM {{ ref('config_ddd_sub_category') }}\n)\n\nSELECT * FROM dx\nUNION ALL\nSELECT * FROM px\nUNION ALL\nSELECT * FROM rx\nUNION ALL\nSELECT * FROM ddd_sub_category", "doc_blocks": [], "language": "sql", "refs": [{"name": "seed_bc_dx_code_mapping", "package": null, "version": null}, {"name": "seed_bc_px_code_mapping", "package": null, "version": null}, {"name": "seed_bc_rx_ndc_mapping", "package": null, "version": null}, {"name": "config_ddd_sub_category", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["seed.CGOncology_MDM.seed_bc_dx_code_mapping", "seed.CGOncology_MDM.seed_bc_px_code_mapping", "seed.CGOncology_MDM.seed_bc_rx_ndc_mapping", "seed.CGOncology_MDM.config_ddd_sub_category"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}, "model.CGOncology_MDM.mdm_best_affiliation": {"database": "CGONCOLOGY_TEST", "schema": "MDM", "name": "mdm_best_affiliation", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "mdm/mdm_best_affiliation.sql", "original_file_path": "models/mdm/mdm_best_affiliation.sql", "unique_id": "model.CGOncology_MDM.mdm_best_affiliation", "fqn": ["CGOncology_MDM", "mdm", "mdm_best_affiliation"], "alias": "mdm_best_affiliation", "checksum": {"name": "sha256", "checksum": "540ab10b813fa0e55d48ed8550754dc4c5b81a03d6ad85222b94a143f2e8fd2b"}, "config": {"enabled": true, "alias": null, "schema": "MDM", "database": null, "tags": ["layer_3_mdm", "customer_backbone", "customer_backbone", "mdm", "affiliation"], "meta": {}, "group": null, "materialized": "incremental", "incremental_strategy": "merge", "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "npi", "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_3_mdm", "customer_backbone", "mdm", "affiliation"], "description": "Best HCP-HCO affiliation assignment.\nEach HCP is mapped to their single best HCO based on waterfall logic.\nGrain: One row per NPI.\n", "columns": {"npi": {"name": "npi", "description": "HCP National Provider Identifier - primary key", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "kmk_hcp_id": {"name": "kmk_hcp_id", "description": "Internal HCP identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "best_kmk_hco_id": {"name": "best_kmk_hco_id", "description": "Best affiliated HCO identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "mapping_rule": {"name": "mapping_rule", "description": "Method used to determine best affiliation", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/mdm/schema.yml", "build_path": null, "unrendered_config": {"schema": "MDM", "materialized": "incremental", "tags": ["customer_backbone", "mdm", "affiliation"], "unique_key": "npi", "incremental_strategy": "merge"}, "created_at": 1770177079.2657, "relation_name": "CGONCOLOGY_TEST.MDM.mdm_best_affiliation", "raw_code": "{{\n    config(\n        schema='MDM',\n        materialized='incremental',\n        unique_key='npi',\n        incremental_strategy='merge',\n        tags=['customer_backbone', 'mdm', 'affiliation']\n    )\n}}\n\n/*\nMDM Best Affiliation - 7-Step Waterfall (Affiliation-First Priority)\nPurpose: Determine single best HCO for each HCP\nTarget: 90%+ alignment with DEV (CGONCOLOGY_DEV.ADM.HCP_HCO_BEST_AFFILIATION)\n\nKey Features:\n1. firm_type_priority: PL=1, PG=2, Hospital=3, Other=4\n2. Pure One-to-One: Single-affiliation HCPs skip address check (performance)\n3. 4-tier address cascade for multi-affiliation HCPs only\n4. Claims-based matching uses provider_billing_dh_id (no building check)\n5. Primary/Strength affiliation BEFORE ZIP fallback (affiliation-first approach)\n6. ZIP/LocName are fallbacks for HCPs with NO affiliation data\n\n7-Step Waterfall:\n- STEP 1: In-Affiliation (Pure One-to-One + DHC affiliations with address cascade)\n- STEP 2: Claims-Based (provider_billing_dh_id + addr >= 80)\n- STEP 3: Primary Affiliation Flag (is_primary = TRUE)\n- STEP 4: Best Strength Affiliation (highest strength)\n- STEP 5: ZIP Match (fallback: addr >= 85, no affiliation)\n- STEP 6: Location Name (fallback: org_name = location_name)\n- STEP 7: Unmapped\n*/\n\n-- ============================================================================\n-- INCREMENTAL MODE SUPPORT\n-- ============================================================================\n-- This model uses dbt's built-in incremental materialization:\n--   --full-refresh (TEST): Process ALL HCPs (fresh calculations)\n--   No flag (DEV):         Only NEW HCPs (existing affiliations frozen)\n--\n-- Run modes:\n--   Full refresh: python scripts/dbt_run_via_python.py mdm_best_affiliation --full-refresh\n--   Incremental:  python scripts/dbt_run_via_python.py mdm_best_affiliation\n\n-- ============================================================================\n-- BASE TABLES\n-- ============================================================================\n\nWITH\n-- HCPs from DHC source (current)\nhcps_from_dhc AS (\n    SELECT DISTINCT base.npi\n    FROM {{ ref('std_dh_hcp_hist') }} base\n    WHERE base.npi IS NOT NULL\n      AND base.is_current = 'Y'  -- Only process current HCPs (exclude deleted/historical)\n    {% if is_incremental() %}\n      -- FREEZE MODE: Only process NEW HCPs (not already in this table)\n      AND base.npi NOT IN (SELECT npi FROM {{ this }})\n    {% endif %}\n),\n\n-- HCPs from backbone that may not be in current DHC source\n-- These are HCPs dropped from DHC but still relevant for affiliation\nhcps_from_backbone AS (\n    SELECT DISTINCT bc.npi\n    FROM {{ ref('stg_hcp_bc_metrics') }} bc\n    WHERE bc.npi IS NOT NULL\n      AND bc.bc_backbone_flag = 'Y'\n    {% if is_incremental() %}\n      -- FREEZE MODE: Only process NEW HCPs (not already in this table)\n      AND bc.npi NOT IN (SELECT npi FROM {{ this }})\n    {% endif %}\n),\n\n-- Combined: DHC source + backbone (activity/target)\nhcps_to_process AS (\n    SELECT npi FROM hcps_from_dhc\n    UNION\n    SELECT npi FROM hcps_from_backbone\n),\n\n-- HCP Base with HQ Address from MASTER table (Fix C: avoid NULL addresses from LEFT JOIN)\n-- UPDATED 2026-01-18: Simplified - removed STD join, use LARGEST_PG_AFFILIATION_NAME from master\nhcp_base AS (\n    SELECT\n        hcp.kmk_hcp_id,\n        hcp.npi,\n        hcp.dh_id AS hcp_dh_id,\n        hcp.first_name,\n        hcp.last_name,\n        hcp.primary_specialty,\n        -- Practice address from MDM (already standardized) - USE THIS for matching (Fix C)\n        hcp.practice_address_line_1 AS hq_address_line_1,\n        hcp.practice_city AS hq_city,\n        hcp.practice_state AS hq_state,\n        hcp.practice_zip_code AS hq_zip_code,\n        -- Use LARGEST_PG_AFFILIATION_NAME from master (no raw source join needed)\n        UPPER(TRIM(hcp.largest_pg_affiliation_name)) AS PRIMARY_PRACTICE_LOCATION_NAME,\n        -- DHC Curated Affiliation columns (MAT-036: integrate as Step 1 candidates)\n        hcp.primary_affiliation_hospital_id,\n        hcp.largest_pg_affiliation_id\n    FROM {{ ref('mdm_customer_master_hcp') }} hcp\n    INNER JOIN hcps_to_process proc ON hcp.npi = proc.npi  -- INCREMENTAL FILTER\n    WHERE hcp.npi IS NOT NULL\n),\n\n-- ============================================================================\n-- UNIFIED AFFILIATION POOL (Inline CTEs - merged from mdm_affiliations_pool)\n-- ============================================================================\n-- PERFORMANCE OPTIMIZATION (2026-01-18):\n-- PLs inherit their parent PG's dh_id, so joining on dh_id naturally expands to PLs.\n-- State/ZIP filter for PLs is applied EARLY during the expansion (not at the end).\n-- This avoids cartesian explosion by filtering PLs upfront.\n--\n-- Deduplication Strategy:\n-- - Curated affiliations are excluded if they already exist in standard affiliations\n--   for the same (npi, affiliated_dh_id) pair\n--\n-- Pool columns (pre-joined from mdm_customer_master_hco):\n-- - npi, affiliated_dh_id, kmk_hco_id\n-- - hco_state, hco_zip, hco_address, hco_city, org_name, firm_type\n-- - strength_of_affiliation, affiliation_type, is_primary_affiliation, is_current\n-- - affiliation_source: DHC_STANDARD, DHC_STANDARD_PG_PL, DHC_CURATED_HOSPITAL, DHC_CURATED_PG, DHC_CURATED_PG_PL\n\n-- 1. Standard affiliations expanded to include PLs\n-- PLs inherit parent PG's dh_id, so joining on dh_id returns both PG and PLs\n-- Filter PLs by HCP state/ZIP3 early to avoid cartesian explosion\nstandard_affiliations_expanded AS (\n    SELECT\n        hcp.npi,\n        m.dh_id AS affiliated_dh_id,\n        CASE\n            WHEN m.firm_type = 'Practice Location' THEN 'DHC_STANDARD_PG_PL'\n            ELSE 'DHC_STANDARD'\n        END AS affiliation_source,\n        a.strength_of_affiliation,\n        a.is_current,\n        -- FIX 2026-01-20: Standardize BOOLEAN to 'Y'/'N' string for consistent comparison\n        CASE\n            WHEN m.firm_type = 'Practice Location' THEN 'N'\n            WHEN a.is_primary_affiliation = TRUE THEN 'Y'\n            ELSE 'N'\n        END AS is_primary_affiliation,\n        a.affiliation_type,\n        m.kmk_hco_id,\n        m.hq_state AS hco_state,\n        m.hq_zip_code AS hco_zip,\n        m.hq_address_line_1 AS hco_address,\n        m.hq_city AS hco_city,\n        m.org_name,\n        m.firm_type\n    FROM hcp_base hcp\n    INNER JOIN {{ ref('std_dh_hcp_hco_affiliation') }} a ON hcp.npi = a.npi\n    INNER JOIN {{ ref('mdm_customer_master_hco') }} m ON a.affiliated_dh_id = m.dh_id\n    WHERE\n        -- Non-PLs: include all\n        m.firm_type != 'Practice Location'\n        -- PLs: only those in HCP's state + ZIP3\n        OR (m.hq_state = hcp.hq_state AND LEFT(m.hq_zip_code, 3) = LEFT(hcp.hq_zip_code, 3))\n),\n\n-- Index for deduplication of curated affiliations\nstandard_pairs AS (\n    SELECT DISTINCT npi, affiliated_dh_id\n    FROM standard_affiliations_expanded\n),\n\n-- 2. Curated Hospital affiliation (no PL expansion - hospitals don't have child PLs)\ncurated_hospital_expanded AS (\n    SELECT\n        hcp.npi,\n        m.dh_id AS affiliated_dh_id,\n        'DHC_CURATED_HOSPITAL' AS affiliation_source,\n        100 AS strength_of_affiliation,\n        'Y' AS is_current,\n        'N' AS is_primary_affiliation,\n        'Current' AS affiliation_type,\n        m.kmk_hco_id,\n        m.hq_state AS hco_state,\n        m.hq_zip_code AS hco_zip,\n        m.hq_address_line_1 AS hco_address,\n        m.hq_city AS hco_city,\n        m.org_name,\n        m.firm_type\n    FROM hcp_base hcp\n    INNER JOIN {{ ref('mdm_customer_master_hco') }} m\n        ON hcp.primary_affiliation_hospital_id = m.dh_id\n    LEFT JOIN standard_pairs sp\n        ON hcp.npi = sp.npi AND m.dh_id = sp.affiliated_dh_id\n    WHERE hcp.primary_affiliation_hospital_id IS NOT NULL\n      AND sp.npi IS NULL  -- Not already in standard affiliations\n),\n\n-- 3. Curated PG affiliation expanded to include PLs\n-- PLs inherit parent PG's dh_id, so joining on dh_id returns both PG and PLs\ncurated_pg_expanded AS (\n    SELECT\n        hcp.npi,\n        m.dh_id AS affiliated_dh_id,\n        CASE\n            WHEN m.firm_type = 'Practice Location' THEN 'DHC_CURATED_PG_PL'\n            ELSE 'DHC_CURATED_PG'\n        END AS affiliation_source,\n        100 AS strength_of_affiliation,\n        'Y' AS is_current,\n        'N' AS is_primary_affiliation,\n        'Current' AS affiliation_type,\n        m.kmk_hco_id,\n        m.hq_state AS hco_state,\n        m.hq_zip_code AS hco_zip,\n        m.hq_address_line_1 AS hco_address,\n        m.hq_city AS hco_city,\n        m.org_name,\n        m.firm_type\n    FROM hcp_base hcp\n    INNER JOIN {{ ref('mdm_customer_master_hco') }} m\n        ON hcp.largest_pg_affiliation_id = m.dh_id\n    LEFT JOIN standard_pairs sp\n        ON hcp.npi = sp.npi AND m.dh_id = sp.affiliated_dh_id\n    WHERE hcp.largest_pg_affiliation_id IS NOT NULL\n      AND sp.npi IS NULL  -- Not already in standard affiliations\n      -- Filter PLs by HCP state/ZIP3\n      AND (\n          m.firm_type != 'Practice Location'\n          OR (m.hq_state = hcp.hq_state AND LEFT(m.hq_zip_code, 3) = LEFT(hcp.hq_zip_code, 3))\n      )\n),\n\n-- Final unified pool: UNION ALL of all sources\nall_affiliations AS (\n    SELECT * FROM standard_affiliations_expanded\n    UNION ALL\n    SELECT * FROM curated_hospital_expanded\n    UNION ALL\n    SELECT * FROM curated_pg_expanded\n),\n\n-- ============================================================================\n-- STEP 1: IN-AFFILIATION MATCHING\n-- ============================================================================\n\n-- 1.0 PURE ONE-TO-ONE: HCPs with exactly 1 SAME-STATE affiliation \u2192 pick directly (no address check)\n-- PERFORMANCE OPTIMIZATION (2026-01-18): Pool has org_name/firm_type - no master join needed\nstep1_single_affiliation_hcps AS (\n    SELECT\n        a.npi,\n        MIN(a.kmk_hco_id) AS kmk_hco_id,  -- MIN works since there's only 1 unique value\n        MIN(a.affiliated_dh_id) AS affiliated_dh_id,  -- Include for downstream (avoids extra join)\n        MIN(a.org_name) AS org_name,      -- From pool (pre-joined from master)\n        MIN(a.firm_type) AS firm_type,    -- From pool (pre-joined from master)\n        MAX(a.strength_of_affiliation) AS strength_of_affiliation,\n        MIN(a.affiliation_type) AS affiliation_type\n    FROM all_affiliations a\n    INNER JOIN hcp_base hcp ON a.npi = hcp.npi\n    WHERE hcp.hq_state = a.hco_state  -- Same-state filter using pre-joined state (AFF-051)\n    GROUP BY a.npi\n    HAVING COUNT(DISTINCT a.kmk_hco_id) = 1  -- Single affiliation only\n),\n\n-- 1.1 Get all HCP-HCO affiliations with ALL locations (HQ + PLs)\n-- EXCLUDES pure one-to-one HCPs (already handled above)\n-- OPTIMIZATION (2026-01-18): Use pool columns directly - NO JOIN TO MASTER NEEDED\nstep1_affiliations AS (\n    SELECT\n        a.npi,\n        a.affiliated_dh_id,\n        a.org_name AS affiliated_org_name,     -- FROM POOL (pre-joined)\n        a.firm_type AS affiliated_firm_type,   -- FROM POOL (pre-joined)\n        a.affiliation_type,\n        a.strength_of_affiliation,\n        a.is_primary_affiliation,\n        a.is_current,\n        a.kmk_hco_id AS affiliated_kmk_hco_id, -- FROM POOL (pre-joined)\n        -- Determine location_type based on firm_type\n        CASE WHEN a.firm_type = 'Practice Location' THEN 'PL' ELSE 'HQ' END AS location_type,\n        a.hco_address,                         -- FROM POOL (pre-joined)\n        a.hco_city,                            -- FROM POOL (pre-joined)\n        a.hco_state,                           -- FROM POOL (pre-joined)\n        a.hco_zip,                             -- FROM POOL (pre-joined)\n        a.kmk_hco_id AS account_id,            -- Same as hierarchy; avoids MDM\u2192ADM dependency\n        -- Firm type priority: PL > PG > Hospital\n        CASE\n            WHEN a.firm_type = 'Practice Location' THEN 1  -- Practice Location (highest)\n            WHEN UPPER(a.firm_type) = 'PHYSICIAN GROUP' THEN 2\n            WHEN UPPER(a.firm_type) = 'HOSPITAL' THEN 3\n            ELSE 4\n        END AS firm_type_priority,\n        -- HCP address for matching\n        hcp.hq_address_line_1 AS hcp_address,\n        hcp.hq_city AS hcp_city,\n        hcp.hq_state AS hcp_state,\n        hcp.hq_zip_code AS hcp_zip,\n        hcp.PRIMARY_PRACTICE_LOCATION_NAME,\n        a.affiliation_source  -- DHC_STANDARD, DHC_STANDARD_PG_PL, DHC_CURATED_HOSPITAL, DHC_CURATED_PG, DHC_CURATED_PG_PL\n    FROM all_affiliations a  -- Unified pool with pre-joined master columns\n    INNER JOIN hcp_base hcp ON a.npi = hcp.npi\n    -- Exclude HCPs already matched via pure one-to-one (optimized: LEFT JOIN instead of NOT EXISTS)\n    LEFT JOIN step1_single_affiliation_hcps s ON a.npi = s.npi\n    WHERE s.npi IS NULL  -- Exclude pure one-to-one HCPs\n      AND a.affiliated_dh_id IS NOT NULL  -- Ensure valid HCO\n      AND hcp.hq_state = a.hco_state      -- State filter\n      AND LEFT(hcp.hq_zip_code, 3) = LEFT(a.hco_zip, 3)  -- ZIP3 filter\n),\n\n-- 1.2 Apply 4-tier address cascade (OPTIMIZED: Lazy fuzzy matching)\n-- CRITICAL FIX: Only calculate JAROWINKLER_SIMILARITY for rows that failed exact matches\n-- This reduces fuzzy matching from 42.6M rows to ~17M rows (60% reduction)\nstep1_exact_tiers AS (\n    SELECT\n        *,\n        -- Tier 1: EXACT (address + city + state + zip)\n        -- Note: Data already standardized (UPPER + TRIM) in standardization layer\n        CASE WHEN hcp_address = hco_address\n              AND hcp_city = hco_city\n              AND hcp_state = hco_state\n              AND hcp_zip = hco_zip\n        THEN 1 ELSE 0 END AS tier1_exact_full,\n\n        -- Tier 2: EXACT (address + state + zip)\n        CASE WHEN hcp_address = hco_address\n              AND hcp_state = hco_state\n              AND hcp_zip = hco_zip\n        THEN 1 ELSE 0 END AS tier2_exact_state_zip,\n\n        -- Tier 3: EXACT (address only with zip/state filter)\n        CASE WHEN hcp_address = hco_address\n              AND (hcp_zip = hco_zip OR hcp_state = hco_state)\n        THEN 1 ELSE 0 END AS tier3_exact_addr\n        -- Note: Building numbers (hcp_bldg, hco_bldg) already calculated in step1_affiliations\n    FROM step1_affiliations\n),\n\n-- 1.2b Assign initial tier (1-3 = exact match, 0 = needs fuzzy matching)\nstep1_initial_tier AS (\n    SELECT\n        *,\n        CASE\n            WHEN tier1_exact_full = 1 THEN 1\n            WHEN tier2_exact_state_zip = 1 THEN 2\n            WHEN tier3_exact_addr = 1 THEN 3\n            ELSE 0  -- Needs fuzzy matching (Tier 4 candidate)\n        END AS initial_tier\n    FROM step1_exact_tiers\n),\n\n-- 1.2c Pre-filter by state/ZIP BEFORE expensive fuzzy matching\n-- OPTIMIZATION: Filter to only pairs with matching state OR ZIP before calculating JAROWINKLER_SIMILARITY\n-- This reduces fuzzy matching operations by 60-80% (similar to Step 2 optimization)\nstep1_prefilter_state_zip AS (\n    SELECT *\n    FROM step1_initial_tier\n    WHERE initial_tier > 0  -- Keep exact matches (Tier 1-3)\n       OR (initial_tier = 0 AND (hcp_zip = hco_zip OR hcp_state = hco_state))  -- Pre-filter Tier 4 candidates by state/ZIP\n),\n\n-- 1.2d Calculate fuzzy matching ONLY for pre-filtered rows\n-- OPTIMIZATION: Only calculate JAROWINKLER_SIMILARITY for pre-filtered Tier 4 candidates\nstep1_with_fuzzy AS (\n    SELECT\n        *,\n        CASE \n            WHEN initial_tier > 0 THEN NULL::NUMBER  -- Exact match, no fuzzy needed\n            ELSE JAROWINKLER_SIMILARITY(COALESCE(hcp_address, ''), COALESCE(hco_address, ''))  -- Only calculate for pre-filtered Tier 4 candidates\n        END AS addr_score\n    FROM step1_prefilter_state_zip\n),\n\n-- 1.3a Calculate building numbers for Tier 4 candidates\n-- OPTIMIZATION: Calculate building numbers only when needed (Tier 4 check)\nstep1_with_building_numbers AS (\n    SELECT\n        *,\n        -- Calculate building numbers only for Tier 4 candidates (initial_tier = 0)\n        CASE \n            WHEN initial_tier = 0 THEN REGEXP_REPLACE(SPLIT(COALESCE(hcp_address, ''), ' ')[0], '[^0-9]', '')\n            ELSE NULL\n        END AS hcp_bldg,\n        CASE \n            WHEN initial_tier = 0 THEN REGEXP_REPLACE(SPLIT(COALESCE(hco_address, ''), ' ')[0], '[^0-9]', '')\n            ELSE NULL\n        END AS hco_bldg\n    FROM step1_with_fuzzy\n),\n\n-- 1.3b Assign match tier (1-4 = passed, 99 = failed)\nstep1_with_match_tier AS (\n    SELECT\n        *,\n        CASE\n            WHEN initial_tier = 1 THEN 1\n            WHEN initial_tier = 2 THEN 2\n            WHEN initial_tier = 3 THEN 3\n            WHEN initial_tier = 0 \n                 AND addr_score >= 85\n                 AND hcp_bldg = hco_bldg\n                 AND (hcp_zip = hco_zip OR hcp_state = hco_state)  -- Already pre-filtered, but keep for clarity\n            THEN 4\n            ELSE 99  -- Did not pass address matching\n        END AS match_tier\n    FROM step1_with_building_numbers\n),\n\n-- ============================================================================\n-- FIX A: STRENGTH RANKING WITHIN EACH TIER (DEV logic t8-t20)\n-- CRITICAL BUG FIX: Strength ranking must happen AFTER filtering to best tier\n-- ============================================================================\n\n-- 1.4a FILTER: Only keep rows that PASSED address matching (tier 1-4, not 99)\nstep1_passed_matching AS (\n    SELECT *\n    FROM step1_with_match_tier\n    WHERE match_tier < 99  -- Tier 1-4 passed, tier 99 failed\n),\n\n-- 1.4b For each NPI, find the best (lowest) tier they have\nstep1_tier_assignment AS (\n    SELECT *,\n        MIN(match_tier) OVER (PARTITION BY npi) AS best_tier_for_npi\n    FROM step1_passed_matching\n),\n\n-- 1.4c Filter to best tier, THEN rank by strength (order is critical!)\nstep1_best_tier_only AS (\n    SELECT *,\n        DENSE_RANK() OVER (\n            PARTITION BY npi\n            ORDER BY strength_of_affiliation DESC NULLS LAST\n        ) AS strength_rk\n    FROM step1_tier_assignment\n    WHERE match_tier = best_tier_for_npi  -- Filter first, THEN rank\n),\n\n-- 1.4d SELECT: Highest strength within best tier\nstep1_addr_matched AS (\n    SELECT * EXCLUDE (best_tier_for_npi, strength_rk),\n           match_tier AS final_match_tier\n    FROM step1_best_tier_only\n    WHERE strength_rk = 1\n),\n\n-- 1.5 For each HCP-Affiliation pair, pick the best matching location (HQ or PL)\n-- This dedupes multiple location matches for the same affiliation\n-- FIX 2026-01-20: Address match quality is PRIMARY ranking criterion\n--   - Exact address match (tier 1-3) ALWAYS beats fuzzy match (tier 4)\n--   - Primary affiliation flag used as tie-breaker before firm_type\nstep1_best_per_affiliation AS (\n    SELECT *\n    FROM (\n        SELECT\n            *,\n            ROW_NUMBER() OVER (\n                PARTITION BY npi, affiliated_dh_id\n                ORDER BY\n                    final_match_tier ASC,                      -- Priority 1: Exact (1-3) > Fuzzy (4)\n                    addr_score DESC NULLS LAST,                -- Priority 2: Among fuzzy, higher score wins\n                    is_primary_affiliation DESC NULLS LAST,    -- Priority 3: Primary flag\n                    firm_type_priority ASC,                    -- Priority 4: PL (1) > PG (2) > Hospital (3)\n                    strength_of_affiliation DESC NULLS LAST    -- Priority 5: Strength\n            ) AS loc_rn\n        FROM step1_addr_matched\n    )\n    WHERE loc_rn = 1\n),\n\n-- 1.6 ONE-TO-ONE detection: HCP has exactly ONE affiliation that passed\n-- UPDATED 2026-01-18: Simplified using QUALIFY instead of subquery\nstep1_one_to_one AS (\n    SELECT *\n    FROM step1_best_per_affiliation\n    QUALIFY COUNT(DISTINCT affiliated_dh_id) OVER (PARTITION BY npi) = 1\n),\n\n-- 1.7 MULTI-AFFILIATION ranking (Address Match Quality FIRST)\n-- FIX 2026-01-20: Address match quality is PRIMARY ranking criterion\n--   - Exact address match (tier 1-3) ALWAYS beats fuzzy match (tier 4)\n--   - This fixes the bug where HCPs were being affiliated with the wrong HCO\n--   - Example: Michael Bernstein (NPI 1679530273) was going to NJ Urology (PG, fuzzy 86%)\n--     instead of Inspira Medical Center (Hospital, exact match, Primary=Yes)\nstep1_multi_winner AS (\n    SELECT * EXCLUDE rn\n    FROM (\n        SELECT\n            b.*,\n            JAROWINKLER_SIMILARITY(\n                COALESCE(b.affiliated_org_name, ''),\n                COALESCE(b.PRIMARY_PRACTICE_LOCATION_NAME, '')\n            ) AS loc_name_score,\n            ROW_NUMBER() OVER (\n                PARTITION BY b.npi\n                ORDER BY\n                    b.final_match_tier ASC,                      -- Priority 1: Exact (1-3) > Fuzzy (4) [ADDRESS QUALITY FIRST!]\n                    b.addr_score DESC NULLS LAST,                -- Priority 2: Among fuzzy, higher score wins\n                    b.is_primary_affiliation DESC NULLS LAST,    -- Priority 3: Primary affiliation flag\n                    b.firm_type_priority ASC,                    -- Priority 4: PL (1) > PG (2) > Hospital (3)\n                    b.strength_of_affiliation DESC NULLS LAST,   -- Priority 5: Strength\n                    JAROWINKLER_SIMILARITY(COALESCE(b.affiliated_org_name, ''), COALESCE(b.PRIMARY_PRACTICE_LOCATION_NAME, '')) DESC NULLS LAST  -- Priority 6: Location name match (final tie-breaker)\n            ) AS rn\n        FROM step1_best_per_affiliation b\n        LEFT JOIN step1_one_to_one o ON b.npi = o.npi\n        WHERE o.npi IS NULL  -- Exclude one-to-one HCPs\n    )\n    WHERE rn = 1\n),\n\n-- 1.8 Combine Step 1 results\nstep1_results AS (\n    -- Pure One-to-One: Single affiliation, no address check needed (performance optimization)\n    SELECT\n        npi, affiliated_dh_id, org_name AS affiliated_org_name, firm_type AS affiliated_firm_type,\n        kmk_hco_id AS affiliated_kmk_hco_id, 1 AS match_tier, NULL::NUMBER AS addr_score,\n        CASE\n            WHEN firm_type = 'Practice Location' THEN 1\n            WHEN UPPER(firm_type) = 'PHYSICIAN GROUP' THEN 2\n            WHEN UPPER(firm_type) = 'HOSPITAL' THEN 3\n            ELSE 4\n        END AS firm_type_priority,\n        strength_of_affiliation, affiliation_type,\n        'STEP1-PURE_ONE_TO_ONE' AS mapping_rule,\n        'DH Data: One to One Affiliation' AS mapping_business_rule,\n        'Y' AS mapped_in_affiliation\n    FROM step1_single_affiliation_hcps\n\n    UNION ALL\n\n    -- One-to-One matches after address filtering\n    SELECT\n        npi, affiliated_dh_id, affiliated_org_name, affiliated_firm_type,\n        affiliated_kmk_hco_id, final_match_tier AS match_tier, addr_score, firm_type_priority,\n        strength_of_affiliation, affiliation_type,\n        'STEP1-ONE_TO_ONE' AS mapping_rule,\n        'DH Data: One to One Affiliation' AS mapping_business_rule,\n        'Y' AS mapped_in_affiliation\n    FROM step1_one_to_one\n\n    UNION ALL\n\n    -- Multi-affiliation resolved (firm_type + loc_name ranking)\n    SELECT\n        npi, affiliated_dh_id, affiliated_org_name, affiliated_firm_type,\n        affiliated_kmk_hco_id, final_match_tier AS match_tier, addr_score, firm_type_priority,\n        strength_of_affiliation, affiliation_type,\n        'STEP1-MULTI' AS mapping_rule,\n        'DH Data: Best Match from Multiple Affiliations' AS mapping_business_rule,\n        'Y' AS mapped_in_affiliation\n    FROM step1_multi_winner\n),\n\n-- HCPs matched in Step 1\nhcps_matched_step1 AS (\n    SELECT DISTINCT npi FROM step1_results\n),\n\n-- HCPs needing Step 2\n-- PERFORMANCE OPTIMIZED: Use LEFT JOIN instead of NOT EXISTS\nhcps_needing_step2 AS (\n    SELECT h.*\n    FROM hcp_base h\n    LEFT JOIN hcps_matched_step1 m ON h.npi = m.npi\n    WHERE m.npi IS NULL\n),\n\n-- ============================================================================\n-- STEP 2: CLAIMS-BASED MATCHING (provider_billing_dh_id) - PRIORITIZED\n-- ============================================================================\n\n-- 2.1 Get HCP-HCO pairs from claims via provider_billing_dh_id\n-- Pre-filter: Get NPIs that need Step 2\nhcps_needing_step2_npis AS (\n    SELECT DISTINCT npi\n    FROM hcps_needing_step2\n),\n\n-- Filter claims to ONLY these NPIs FIRST\n-- OPTIMIZATION: Use UNION ALL (already filtered, duplicates minimal), apply DISTINCT only at final step\n-- OPTIMIZATION 2: Filter by date (last 2 years) to reduce volume\nstep2_claims_filtered AS (\n    SELECT \n        px.provider_rendering_npi AS npi, \n        px.provider_billing_dh_id\n    FROM {{ ref('std_px_claims') }} px\n    INNER JOIN hcps_needing_step2_npis npis ON px.provider_rendering_npi = npis.npi\n    WHERE px.provider_billing_dh_id IS NOT NULL\n      AND px.provider_rendering_npi IS NOT NULL\n      AND px.SERVICE_DATE >= DATEADD('year', -2, CURRENT_DATE())  -- Limit to recent claims\n    GROUP BY 1, 2  -- Dedupe early\n    \n    UNION ALL\n    \n    SELECT \n        dx.provider_rendering_npi AS npi, \n        dx.provider_billing_dh_id\n    FROM {{ ref('std_dx_claims') }} dx\n    INNER JOIN hcps_needing_step2_npis npis ON dx.provider_rendering_npi = npis.npi\n    WHERE dx.provider_billing_dh_id IS NOT NULL\n      AND dx.provider_rendering_npi IS NOT NULL\n      AND dx.SERVICE_DATE >= DATEADD('year', -2, CURRENT_DATE())  -- Limit to recent claims\n    GROUP BY 1, 2  -- Dedupe early\n),\n\n-- Final DISTINCT on filtered result (single DISTINCT operation instead of multiple)\nstep2_claims_distinct AS (\n    SELECT DISTINCT npi, provider_billing_dh_id\n    FROM step2_claims_filtered\n),\n\n-- Join with HCP details\nstep2_claims_pairs AS (\n    SELECT \n        h.npi,\n        h.hq_address_line_1 AS hcp_address,\n        h.hq_city AS hcp_city,\n        h.hq_state AS hcp_state,\n        h.hq_zip_code AS hcp_zip,\n        c.provider_billing_dh_id AS affiliated_dh_id,\n        -- Pre-calculate building numbers (extract once, use multiple times)\n        -- Note: REGEXP_REPLACE needed to extract numeric building number from address\n        REGEXP_REPLACE(SPLIT(COALESCE(h.hq_address_line_1, ''), ' ')[0], '[^0-9]', '') AS hcp_bldg\n    FROM hcps_needing_step2 h\n    INNER JOIN step2_claims_distinct c ON h.npi = c.npi\n),\n\n-- 2.2 Join with HCO master and pre-filter by state/ZIP before fuzzy matching\n-- OPTIMIZATION: Pre-filter by state/ZIP match to reduce fuzzy matching operations by 60-80%\nstep2_with_prefilter AS (\n    SELECT\n        s.npi,\n        s.affiliated_dh_id,\n        s.hcp_address,\n        s.hcp_state,\n        s.hcp_zip,\n        m.kmk_hco_id AS affiliated_kmk_hco_id,\n        m.org_name AS affiliated_org_name,\n        m.firm_type AS affiliated_firm_type,\n        m.hq_address_line_1 AS hco_address,\n        m.hq_state AS hco_state,\n        m.hq_zip_code AS hco_zip,\n        CASE\n            WHEN m.firm_type = 'Practice Location' THEN 1\n            WHEN UPPER(m.firm_type) = 'PHYSICIAN GROUP' THEN 2\n            WHEN UPPER(m.firm_type) = 'HOSPITAL' THEN 3\n            ELSE 4\n        END AS firm_type_priority,\n        s.hcp_bldg,\n        -- Pre-calculate HCO building number (extract once, use multiple times)\n        REGEXP_REPLACE(SPLIT(COALESCE(m.hq_address_line_1, ''), ' ')[0], '[^0-9]', '') AS hco_bldg\n    FROM step2_claims_pairs s\n    INNER JOIN {{ ref('mdm_customer_master_hco') }} m ON s.affiliated_dh_id = m.dh_id  -- OPTIMIZATION FIX 1: Direct join to master\n    -- OPTIMIZATION: Pre-filter by state OR ZIP match before expensive fuzzy matching\n    WHERE (s.hcp_state = m.hq_state OR s.hcp_zip = m.hq_zip_code)\n      AND m.dh_id IS NOT NULL\n),\n\n-- 2.2b Calculate fuzzy matching only for pre-filtered pairs\n-- OPTIMIZATION: Lazy fuzzy matching - only calculate JAROWINKLER_SIMILARITY for pairs that passed state/ZIP filter\nstep2_with_addr AS (\n    SELECT\n        *,\n        JAROWINKLER_SIMILARITY(COALESCE(hcp_address, ''), COALESCE(hco_address, '')) AS addr_score\n    FROM step2_with_prefilter\n),\n\n-- 2.3 Filter: addr_score >= 80 (no building check)\nstep2_addr_matched AS (\n    SELECT * FROM step2_with_addr\n    WHERE addr_score >= 80\n),\n\n-- 2.4 One-to-One detection and Multi-match ranking\n-- PERFORMANCE OPTIMIZED: Single pass with window functions instead of subqueries\n-- FIX 2026-01-20: Address score is PRIMARY ranking criterion (consistent with Step 1)\nstep2_with_counts AS (\n    SELECT\n        *,\n        COUNT(*) OVER (PARTITION BY npi) AS npi_count,\n        ROW_NUMBER() OVER (\n            PARTITION BY npi\n            ORDER BY addr_score DESC, firm_type_priority ASC  -- addr_score FIRST\n        ) AS rn\n    FROM step2_addr_matched\n),\n\n-- One-to-One from claims (only 1 match)\nstep2_one_to_one AS (\n    SELECT * EXCLUDE (npi_count, rn)\n    FROM step2_with_counts\n    WHERE npi_count = 1\n),\n\n-- Multi-match winner (pick best when multiple matches)\nstep2_multi_winner AS (\n    SELECT * EXCLUDE (npi_count, rn)\n    FROM step2_with_counts\n    WHERE npi_count > 1 AND rn = 1\n),\n\n-- 2.6 Combine Step 2 results\nstep2_results AS (\n    SELECT\n        npi, affiliated_dh_id, affiliated_org_name, affiliated_firm_type,\n        affiliated_kmk_hco_id, 4 AS match_tier, addr_score, firm_type_priority,\n        NULL::NUMBER AS strength_of_affiliation, NULL::VARCHAR AS affiliation_type,\n        'STEP2-CLAIMS_ONE_TO_ONE' AS mapping_rule,\n        'DH Data: Match on Billing DHID' AS mapping_business_rule,\n        'N' AS mapped_in_affiliation\n    FROM step2_one_to_one\n\n    UNION ALL\n\n    SELECT\n        npi, affiliated_dh_id, affiliated_org_name, affiliated_firm_type,\n        affiliated_kmk_hco_id, 4 AS match_tier, addr_score, firm_type_priority,\n        NULL::NUMBER AS strength_of_affiliation, NULL::VARCHAR AS affiliation_type,\n        'STEP2-CLAIMS_MULTI' AS mapping_rule,\n        'DH Data: Match on Billing DHID' AS mapping_business_rule,\n        'N' AS mapped_in_affiliation\n    FROM step2_multi_winner\n),\n\n-- HCPs matched in Step 2\nhcps_matched_step2 AS (\n    SELECT DISTINCT npi FROM step2_results\n),\n\n-- HCPs needing Step 3\n-- PERFORMANCE OPTIMIZED: Use LEFT JOIN instead of NOT EXISTS\nhcps_needing_step3 AS (\n    SELECT h.*\n    FROM hcps_needing_step2 h\n    LEFT JOIN hcps_matched_step2 m ON h.npi = m.npi\n    WHERE m.npi IS NULL\n),\n\n-- ============================================================================\n-- STEP 3: PRIMARY AFFILIATION FLAG (moved up from old Step 5)\n-- Use affiliation-based matching before address-only fallbacks\n-- ============================================================================\n\n-- OPTIMIZATION (2026-01-18): Use pool columns directly - NO JOIN TO MASTER NEEDED\nstep3_primary_flag AS (\n    SELECT\n        a.npi,\n        a.affiliated_dh_id,\n        a.org_name AS affiliated_org_name,     -- FROM POOL (pre-joined)\n        a.firm_type AS affiliated_firm_type,   -- FROM POOL (pre-joined)\n        a.kmk_hco_id AS affiliated_kmk_hco_id, -- FROM POOL (pre-joined)\n        CASE\n            WHEN a.firm_type = 'Practice Location' THEN 1\n            WHEN UPPER(a.firm_type) = 'PHYSICIAN GROUP' THEN 2\n            WHEN UPPER(a.firm_type) = 'HOSPITAL' THEN 3\n            ELSE 4\n        END AS firm_type_priority,\n        a.strength_of_affiliation,\n        a.affiliation_type,\n        -- Priority ranking: Standard primary > Curated PG > Curated Hospital\n        CASE\n            WHEN a.is_primary_affiliation = 'Y' THEN 1  -- Standard primary flag from DHC\n            WHEN a.affiliation_source = 'DHC_CURATED_PG' THEN 2  -- Curated PG affiliation\n            WHEN a.affiliation_source = 'DHC_CURATED_HOSPITAL' THEN 3  -- Curated Hospital affiliation\n            ELSE 4  -- Other affiliations\n        END AS primary_priority\n    FROM all_affiliations a  -- Pool with pre-joined master columns\n    INNER JOIN hcps_needing_step3 hcp ON a.npi = hcp.npi\n    WHERE (a.is_primary_affiliation = 'Y'\n           OR a.affiliation_source IN ('DHC_CURATED_PG', 'DHC_CURATED_HOSPITAL'))  -- Include curated affiliations\n      AND a.kmk_hco_id LIKE '3%'  -- Exclude Practice Locations (prefix 4); avoids MDM\u2192ADM dependency\n      AND a.affiliated_dh_id IS NOT NULL\n),\n\nstep3_ranked AS (\n    SELECT\n        * EXCLUDE primary_priority,\n        ROW_NUMBER() OVER (\n            PARTITION BY npi\n            ORDER BY primary_priority ASC, firm_type_priority ASC, strength_of_affiliation DESC\n        ) AS rn\n    FROM step3_primary_flag\n),\n\nstep3_results AS (\n    SELECT\n        npi, affiliated_dh_id, affiliated_org_name, affiliated_firm_type,\n        affiliated_kmk_hco_id, 99 AS match_tier, NULL::NUMBER AS addr_score, firm_type_priority,\n        strength_of_affiliation, affiliation_type,\n        'STEP3-PRIMARY_FLAG' AS mapping_rule,\n        'DH Data: Match on Primary Affiliation' AS mapping_business_rule,\n        'Y' AS mapped_in_affiliation\n    FROM step3_ranked\n    WHERE rn = 1\n),\n\nhcps_matched_step3 AS (\n    SELECT DISTINCT npi FROM step3_results\n),\n\n-- HCPs needing Step 4\n-- PERFORMANCE OPTIMIZED: Use LEFT JOIN instead of NOT EXISTS\nhcps_needing_step4 AS (\n    SELECT h.*\n    FROM hcps_needing_step3 h\n    LEFT JOIN hcps_matched_step3 m ON h.npi = m.npi\n    WHERE m.npi IS NULL\n),\n\n-- ============================================================================\n-- STEP 4: BEST STRENGTH AFFILIATION (moved up from old Step 6)\n-- ============================================================================\n\n-- OPTIMIZATION (2026-01-18): Use pool columns directly - NO JOIN TO MASTER NEEDED\n-- FIX 2026-01-20: Added is_primary_affiliation to ranking (primary affiliation wins when strengths equal)\nstep4_best_strength AS (\n    SELECT\n        a.npi,\n        a.affiliated_dh_id,\n        a.org_name AS affiliated_org_name,     -- FROM POOL (pre-joined)\n        a.firm_type AS affiliated_firm_type,   -- FROM POOL (pre-joined)\n        a.kmk_hco_id AS affiliated_kmk_hco_id, -- FROM POOL (pre-joined)\n        a.is_primary_affiliation,              -- FIX 2026-01-20: Added for ranking\n        CASE\n            WHEN a.firm_type = 'Practice Location' THEN 1\n            WHEN UPPER(a.firm_type) = 'PHYSICIAN GROUP' THEN 2\n            WHEN UPPER(a.firm_type) = 'HOSPITAL' THEN 3\n            ELSE 4\n        END AS firm_type_priority,\n        a.strength_of_affiliation,\n        a.affiliation_type,\n        COALESCE(LENGTH(a.affiliation_type), 0) AS affiliation_len\n    FROM all_affiliations a  -- Pool with pre-joined master columns\n    INNER JOIN hcps_needing_step4 hcp ON a.npi = hcp.npi\n    WHERE a.kmk_hco_id LIKE '3%'  -- PG/Hospital only (prefix 3 = L1/L2/L3); avoids MDM\u2192ADM dependency\n      AND a.affiliated_dh_id IS NOT NULL\n),\n\nstep4_ranked AS (\n    SELECT\n        *,\n        ROW_NUMBER() OVER (\n            PARTITION BY npi\n            ORDER BY\n                strength_of_affiliation DESC NULLS LAST,\n                is_primary_affiliation DESC NULLS LAST,  -- FIX 2026-01-20: Primary wins when strengths equal\n                firm_type_priority ASC,\n                affiliation_type ASC,\n                affiliation_len DESC\n        ) AS rn\n    FROM step4_best_strength\n),\n\nstep4_results AS (\n    SELECT\n        npi, affiliated_dh_id, affiliated_org_name, affiliated_firm_type,\n        affiliated_kmk_hco_id, 99 AS match_tier, NULL::NUMBER AS addr_score, firm_type_priority,\n        strength_of_affiliation, affiliation_type,\n        'STEP4-BEST_STRENGTH' AS mapping_rule,\n        'DH Data: Affiliation With Best Strength' AS mapping_business_rule,\n        'Y' AS mapped_in_affiliation\n    FROM step4_ranked\n    WHERE rn = 1\n),\n\nhcps_matched_step4 AS (\n    SELECT DISTINCT npi FROM step4_results\n),\n\n-- HCPs needing Step 5 (fallback: address-based matching for HCPs with NO affiliation)\n-- PERFORMANCE OPTIMIZED: Use LEFT JOIN instead of NOT EXISTS\nhcps_needing_step5 AS (\n    SELECT h.*\n    FROM hcps_needing_step4 h\n    LEFT JOIN hcps_matched_step4 m ON h.npi = m.npi\n    WHERE m.npi IS NULL\n),\n\n-- ============================================================================\n-- STEP 5: OUTSIDE-AFFILIATION / ZIP MATCH (moved down - fallback only)\n-- For HCPs with NO affiliation data at all\n-- ============================================================================\n\n-- 5.1 Join HCPs with HCOs by state + zip\nstep5_zip_match AS (\n    SELECT\n        h.npi,\n        h.hq_address_line_1 AS hcp_address,\n        m.dh_id AS affiliated_dh_id,\n        m.kmk_hco_id AS affiliated_kmk_hco_id,\n        m.org_name AS affiliated_org_name,\n        m.firm_type AS affiliated_firm_type,\n        m.hq_address_line_1 AS hco_address,\n        CASE\n            WHEN m.firm_type = 'Practice Location' THEN 1\n            WHEN UPPER(m.firm_type) = 'PHYSICIAN GROUP' THEN 2\n            WHEN UPPER(m.firm_type) = 'HOSPITAL' THEN 3\n            ELSE 4\n        END AS firm_type_priority,\n        JAROWINKLER_SIMILARITY(COALESCE(h.hq_address_line_1, ''), COALESCE(m.hq_address_line_1, '')) AS addr_score\n    FROM hcps_needing_step5 h\n    INNER JOIN {{ ref('mdm_customer_master_hco') }} m  -- OPTIMIZATION FIX 1: Direct join to master\n        ON h.hq_state = m.hq_state\n       AND h.hq_zip_code = m.hq_zip_code\n    WHERE m.dh_id IS NOT NULL\n),\n\n-- 5.2 Filter: addr_score >= 85 (no building check)\nstep5_addr_matched AS (\n    SELECT * FROM step5_zip_match\n    WHERE addr_score >= 85\n),\n\n-- 5.3 One-to-One detection and Multi-match ranking\n-- FIX 2026-01-20: Address score is PRIMARY ranking criterion (consistent with Step 1)\nstep5_with_counts AS (\n    SELECT\n        *,\n        COUNT(*) OVER (PARTITION BY npi) AS npi_count,\n        ROW_NUMBER() OVER (\n            PARTITION BY npi\n            ORDER BY addr_score DESC, firm_type_priority ASC  -- addr_score FIRST\n        ) AS rn\n    FROM step5_addr_matched\n),\n\n-- One-to-One (only 1 match)\nstep5_one_to_one AS (\n    SELECT * EXCLUDE (npi_count, rn)\n    FROM step5_with_counts\n    WHERE npi_count = 1\n),\n\n-- Multi-match winner (pick best when multiple matches)\nstep5_multi_winner AS (\n    SELECT * EXCLUDE (npi_count, rn)\n    FROM step5_with_counts\n    WHERE npi_count > 1 AND rn = 1\n),\n\nstep5_results AS (\n    SELECT\n        npi, affiliated_dh_id, affiliated_org_name, affiliated_firm_type,\n        affiliated_kmk_hco_id, 4 AS match_tier, addr_score, firm_type_priority,\n        NULL::NUMBER AS strength_of_affiliation, NULL::VARCHAR AS affiliation_type,\n        'STEP5-ZIP_ONE_TO_ONE' AS mapping_rule,\n        'DH Data: Match with PG & Hospital (ZIP fallback)' AS mapping_business_rule,\n        'N' AS mapped_in_affiliation\n    FROM step5_one_to_one\n\n    UNION ALL\n\n    SELECT\n        npi, affiliated_dh_id, affiliated_org_name, affiliated_firm_type,\n        affiliated_kmk_hco_id, 4 AS match_tier, addr_score, firm_type_priority,\n        NULL::NUMBER AS strength_of_affiliation, NULL::VARCHAR AS affiliation_type,\n        'STEP5-ZIP_MULTI' AS mapping_rule,\n        'DH Data: Match with PG & Hospital (ZIP fallback)' AS mapping_business_rule,\n        'N' AS mapped_in_affiliation\n    FROM step5_multi_winner\n),\n\nhcps_matched_step5 AS (\n    SELECT DISTINCT npi FROM step5_results\n),\n\n-- HCPs needing Step 6\n-- PERFORMANCE OPTIMIZED: Use LEFT JOIN instead of NOT EXISTS\nhcps_needing_step6 AS (\n    SELECT h.*\n    FROM hcps_needing_step5 h\n    LEFT JOIN hcps_matched_step5 m ON h.npi = m.npi\n    WHERE m.npi IS NULL\n),\n\n-- ============================================================================\n-- STEP 6: PRACTICE LOCATION NAME MATCHING (moved down - fallback only)\n-- ============================================================================\n\nstep6_loc_name_match AS (\n    SELECT\n        h.npi,\n        h.hq_address_line_1 AS hcp_address,\n        m.dh_id AS affiliated_dh_id,\n        m.kmk_hco_id AS affiliated_kmk_hco_id,\n        m.org_name AS affiliated_org_name,\n        m.firm_type AS affiliated_firm_type,\n        m.hq_address_line_1 AS hco_address,\n        CASE\n            WHEN m.firm_type = 'Practice Location' THEN 1\n            WHEN UPPER(m.firm_type) = 'PHYSICIAN GROUP' THEN 2\n            WHEN UPPER(m.firm_type) = 'HOSPITAL' THEN 3\n            ELSE 4\n        END AS firm_type_priority,\n        JAROWINKLER_SIMILARITY(COALESCE(h.hq_address_line_1, ''), COALESCE(m.hq_address_line_1, '')) AS addr_score\n    FROM hcps_needing_step6 h\n    INNER JOIN {{ ref('mdm_customer_master_hco') }} m  -- OPTIMIZATION FIX 1: Direct join to master\n        -- Note: PRIMARY_PRACTICE_LOCATION_NAME is now UPPER in hcp_base, org_name is already UPPER in master\n        ON h.PRIMARY_PRACTICE_LOCATION_NAME = m.org_name\n       AND h.hq_zip_code = m.hq_zip_code\n    WHERE h.PRIMARY_PRACTICE_LOCATION_NAME IS NOT NULL\n      AND m.dh_id IS NOT NULL\n),\n\n-- Filter: addr_score >= 80 (no building check)\nstep6_addr_matched AS (\n    SELECT * FROM step6_loc_name_match\n    WHERE addr_score >= 80\n),\n\n-- FIX 2026-01-20: Address score is PRIMARY ranking criterion (consistent with Step 1)\nstep6_ranked AS (\n    SELECT\n        *,\n        ROW_NUMBER() OVER (\n            PARTITION BY npi\n            ORDER BY addr_score DESC, firm_type_priority ASC  -- addr_score FIRST\n        ) AS rn\n    FROM step6_addr_matched\n),\n\nstep6_results AS (\n    SELECT\n        npi, affiliated_dh_id, affiliated_org_name, affiliated_firm_type,\n        affiliated_kmk_hco_id, 4 AS match_tier, addr_score, firm_type_priority,\n        NULL::NUMBER AS strength_of_affiliation, NULL::VARCHAR AS affiliation_type,\n        'STEP6-LOC_NAME' AS mapping_rule,\n        'DH Data: Match on Practice Location Name' AS mapping_business_rule,\n        'N' AS mapped_in_affiliation\n    FROM step6_ranked\n    WHERE rn = 1\n),\n\nhcps_matched_step6 AS (\n    SELECT DISTINCT npi FROM step6_results\n),\n\n-- ============================================================================\n-- STEP 7: UNMAPPED\n-- ============================================================================\n\nstep7_unmapped AS (\n    SELECT\n        h.npi,\n        NULL::VARCHAR AS affiliated_dh_id,\n        NULL::VARCHAR AS affiliated_org_name,\n        NULL::VARCHAR AS affiliated_firm_type,\n        NULL::VARCHAR AS affiliated_kmk_hco_id,\n        99 AS match_tier,\n        NULL::NUMBER AS addr_score,\n        NULL::NUMBER AS firm_type_priority,\n        NULL::NUMBER AS strength_of_affiliation,\n        NULL::VARCHAR AS affiliation_type,\n        'STEP7-UNMAPPED' AS mapping_rule,\n        'Mapping Not Found' AS mapping_business_rule,\n        NULL::VARCHAR AS mapped_in_affiliation\n    FROM hcps_needing_step6 h\n    LEFT JOIN step6_results r ON h.npi = r.npi\n    WHERE r.npi IS NULL\n),\n\n-- ============================================================================\n-- FINAL UNION\n-- ============================================================================\n\nall_results AS (\n    SELECT * FROM step1_results\n    UNION ALL\n    SELECT * FROM step2_results\n    UNION ALL\n    SELECT * FROM step3_results\n    UNION ALL\n    SELECT * FROM step4_results\n    UNION ALL\n    SELECT * FROM step5_results\n    UNION ALL\n    SELECT * FROM step6_results\n    UNION ALL\n    SELECT * FROM step7_unmapped\n)\n\n-- Final output with HCP details\nSELECT\n    h.kmk_hcp_id,\n    h.npi,\n    h.first_name,\n    h.last_name,\n    h.primary_specialty,\n    r.affiliated_dh_id::INTEGER::VARCHAR AS best_hco_dh_id,\n    r.affiliated_kmk_hco_id AS best_kmk_hco_id,\n    r.affiliated_org_name AS best_hco_name,\n    r.affiliated_firm_type AS best_hco_firm_type,\n    r.match_tier,\n    r.addr_score,\n    r.firm_type_priority,\n    r.strength_of_affiliation,\n    r.affiliation_type,\n    r.mapping_rule,\n    r.mapping_business_rule,\n    r.mapped_in_affiliation,\n    CURRENT_TIMESTAMP() AS created_at\nFROM hcp_base h\nLEFT JOIN all_results r ON h.npi = r.npi", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hcp_hist", "package": null, "version": null}, {"name": "stg_hcp_bc_metrics", "package": null, "version": null}, {"name": "mdm_customer_master_hcp", "package": null, "version": null}, {"name": "std_dh_hcp_hco_affiliation", "package": null, "version": null}, {"name": "mdm_customer_master_hco", "package": null, "version": null}, {"name": "mdm_customer_master_hco", "package": null, "version": null}, {"name": "mdm_customer_master_hco", "package": null, "version": null}, {"name": "std_px_claims", "package": null, "version": null}, {"name": "std_dx_claims", "package": null, "version": null}, {"name": "mdm_customer_master_hco", "package": null, "version": null}, {"name": "mdm_customer_master_hco", "package": null, "version": null}, {"name": "mdm_customer_master_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.CGOncology_MDM.std_dh_hcp_hist", "model.CGOncology_MDM.stg_hcp_bc_metrics", "model.CGOncology_MDM.mdm_customer_master_hcp", "model.CGOncology_MDM.std_dh_hcp_hco_affiliation", "model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.std_px_claims", "model.CGOncology_MDM.std_dx_claims"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["npi"], "time_spine": null}, "model.CGOncology_MDM.mdm_customer_master_hcp": {"database": "CGONCOLOGY_TEST", "schema": "MDM", "name": "mdm_customer_master_hcp", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "mdm/mdm_customer_master_hcp.sql", "original_file_path": "models/mdm/mdm_customer_master_hcp.sql", "unique_id": "model.CGOncology_MDM.mdm_customer_master_hcp", "fqn": ["CGOncology_MDM", "mdm", "mdm_customer_master_hcp"], "alias": "mdm_customer_master_hcp", "checksum": {"name": "sha256", "checksum": "ad05b09eeb1d2beb8d473f8345158551df6535280d62c133e04943a71d9c9561"}, "config": {"enabled": true, "alias": null, "schema": "MDM", "database": null, "tags": ["layer_3_mdm", "customer_backbone", "customer_backbone", "mdm"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_3_mdm", "customer_backbone", "mdm"], "description": "HCP (Healthcare Provider) golden record master table.\nContains unified HCP data from DHC and Medscout sources.\n", "columns": {"kmk_hcp_id": {"name": "kmk_hcp_id", "description": "Primary key - internal HCP identifier (prefix 1)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "npi": {"name": "npi", "description": "National Provider Identifier (10-digit)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "first_name": {"name": "first_name", "description": "Provider first name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "last_name": {"name": "last_name", "description": "Provider last name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "primary_specialty": {"name": "primary_specialty", "description": "Primary medical specialty (standardized text)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "primary_specialty_group": {"name": "primary_specialty_group", "description": "Primary specialty grouping", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/mdm/schema.yml", "build_path": null, "unrendered_config": {"schema": "MDM", "materialized": "table", "tags": ["customer_backbone", "mdm"]}, "created_at": 1770177079.2652109, "relation_name": "CGONCOLOGY_TEST.MDM.mdm_customer_master_hcp", "raw_code": "{{\n    config(\n        schema='MDM',\n        materialized='table',\n        tags=['customer_backbone', 'mdm']\n    )\n}}\n\n/*\nPROC-MDM-004: mdm_customer_master_hcp - HCP Master (Golden Record)\nSource: mdm_customer_xref_hcp\nBusiness Rules: SRV-030 to SRV-032, MAT-121-125, BBN-017, BBN-019\n\nSurvivorship Rules:\n- SRV-030: DHC has highest priority for all attributes\n- SRV-031: Medscout fills gaps when DHC is NULL\n- SRV-032: For matched records, use DHC values\n- MAT-121-125: Survivorship: DHC > Medscout for matched records\n\nBackbone Flags:\n- BBN-017: HAS_PROFILING_DATA - HCP's affiliated account has profiling data\n- BBN-019: IS_TARGET - HCP is a KAM target\n\nOne golden record per KMK_HCP_ID (deduplicated from xref).\nDHC source is authoritative - Medscout supplements only when DHC is NULL.\n\nFE-001: HAS_PROFILING_DATA uses REPORTING.ACTIVITY_DASHBOARD_METRICS (downstream).\n        Should be refactored to use upstream source in future.\n*/\n\nWITH xref AS (\n    SELECT * FROM {{ ref('mdm_customer_xref_hcp') }}\n),\n\n-- Get DHC records as primary source\ndhc_records AS (\n    SELECT\n        kmk_hcp_id,\n        source_id AS dh_id,\n        npi,\n        first_name,\n        last_name,\n        primary_specialty,\n        primary_specialty_group,\n        practice_address_line_1,\n        practice_address_line_2,\n        practice_city,\n        practice_state,\n        practice_zip_code,\n        -- Legacy Affiliations (Answer Keys)\n        primary_affiliation_hospital_id,\n        primary_affiliation_hospital_name,\n        largest_pg_affiliation_id,\n        largest_pg_affiliation_name\n    FROM xref\n    WHERE source_code = 'DHC'\n),\n\n-- Get Medscout records as supplementary source\nmedscout_records AS (\n    SELECT\n        kmk_hcp_id,\n        source_id AS medscout_id,\n        npi AS medscout_nPI,\n        first_name AS medscout_first_name,\n        last_name AS medscout_last_name,\n        primary_specialty AS medscout_specialty\n    FROM xref\n    WHERE source_code = 'MEDSCOUT'\n),\n\n-- Aggregate Medscout records per KMK_HCP_ID (pick first if multiple - unlikely)\nmedscout_agg AS (\n    SELECT\n        kmk_hcp_id,\n        LISTAGG(DISTINCT medscout_id, ',') WITHIN GROUP (ORDER BY medscout_id) AS medscout_ids,\n        COUNT(DISTINCT medscout_id) AS medscout_count,\n        MAX(medscout_first_name) AS medscout_first_name,\n        MAX(medscout_last_name) AS medscout_last_name,\n        MAX(medscout_specialty) AS medscout_specialty\n    FROM medscout_records\n    GROUP BY kmk_hcp_id\n),\n\n-- HCP Target data for IS_TARGET flag (BBN-019)\n-- Source: adm_sfe_hcp_targets (hardcoded - SFE models disabled)\nhcp_targets AS (\n    SELECT DISTINCT CAST(npi AS VARCHAR) AS HCP_NPI\n    FROM {{ target.database }}.ADM.adm_sfe_hcp_targets\n    WHERE kam_target_flag = 'Y'\n      AND target_version = '{{ var(\"sfe_version\") }}'\n),\n\n-- Note: HAS_PROFILING_DATA (BBN-017) is computed in ADM layer (adm_hcp_master)\n-- to avoid circular dependency with best_affiliation\n-- The MDM layer sets default 'N', ADM layer enriches with actual value\n\n-- Create golden record with survivorship\ngolden_records AS (\n    SELECT\n        d.kmk_hcp_id,\n        d.dh_id,\n        -- PRIMARY_SOURCE: Indicates which source provided winning attributes (SRV-002)\n        'DHC' AS primary_source,\n        d.npi,\n        -- Survivorship: DHC > Medscout\n        COALESCE(d.first_name, ms.medscout_first_name) AS first_name,\n        COALESCE(d.last_name, ms.medscout_last_name) AS last_name,\n        COALESCE(d.primary_specialty, ms.medscout_specialty) AS primary_specialty,\n        d.primary_specialty_group,  -- Always from DHC (Medscout doesn't have specialty_group)\n        d.practice_address_line_1,\n        d.practice_address_line_2,\n        d.practice_city,\n        d.practice_state,\n        d.practice_zip_code,\n        -- Legacy Affiliations\n        d.primary_affiliation_hospital_id,\n        d.primary_affiliation_hospital_name,\n        d.largest_pg_affiliation_id,\n        d.largest_pg_affiliation_name,\n        ms.medscout_ids,\n        COALESCE(ms.medscout_count, 0) AS medscout_count,\n        CASE\n            WHEN ms.kmk_hcp_id IS NOT NULL THEN TRUE\n            ELSE FALSE\n        END AS has_medscout_match,\n        -- BBN-019: IS_TARGET - HCP is a KAM target\n        CASE WHEN t.HCP_NPI IS NOT NULL THEN 'Y' ELSE 'N' END AS is_target,\n        -- BBN-017: HAS_PROFILING_DATA - computed in ADM layer, default 'N' here\n        'N' AS has_profiling_data,\n        CURRENT_TIMESTAMP() AS created_date,\n        CURRENT_TIMESTAMP() AS modified_date\n    FROM dhc_records d\n    LEFT JOIN medscout_agg ms ON d.kmk_hcp_id = ms.kmk_hcp_id\n    LEFT JOIN hcp_targets t ON d.npi = t.HCP_NPI\n),\n\n-- Final combined output\nfinal_output AS (\n    SELECT * FROM golden_records\n)\n\n-- Final SELECT: Exclude MEDSCOUT_COUNT, HAS_MEDSCOUT_MATCH, HAS_PROFILING_DATA (moved to ADM)\nSELECT\n    kmk_hcp_id,\n    dh_id,\n    primary_source,\n    npi,\n    first_name,\n    last_name,\n    primary_specialty,\n    primary_specialty_group,\n    practice_address_line_1,\n    practice_address_line_2,\n    practice_city,\n    practice_state,\n    practice_zip_code,\n    primary_affiliation_hospital_id,\n    primary_affiliation_hospital_name,\n    largest_pg_affiliation_id,\n    largest_pg_affiliation_name,\n    medscout_ids,\n    is_target,\n    created_date,\n    modified_date\nFROM final_output", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_xref_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.mdm_customer_xref_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["kmk_hcp_id", "npi"], "time_spine": null}, "model.CGOncology_MDM.mdm_customer_xref_hco": {"database": "CGONCOLOGY_TEST", "schema": "MDM", "name": "mdm_customer_xref_hco", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "mdm/mdm_customer_xref_hco.sql", "original_file_path": "models/mdm/mdm_customer_xref_hco.sql", "unique_id": "model.CGOncology_MDM.mdm_customer_xref_hco", "fqn": ["CGOncology_MDM", "mdm", "mdm_customer_xref_hco"], "alias": "mdm_customer_xref_hco", "checksum": {"name": "sha256", "checksum": "f1e96b6ec3ef533f06590657466f28e4820211105e7e84b7df89169b8f5b417b"}, "config": {"enabled": true, "alias": null, "schema": "MDM", "database": null, "tags": ["layer_3_mdm", "customer_backbone", "customer_backbone", "mdm"], "meta": {}, "group": null, "materialized": "incremental", "incremental_strategy": "merge", "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": ["source_code", "source_id"], "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_3_mdm", "customer_backbone", "mdm"], "description": "HCO cross-reference table linking source system IDs to KMK_HCO_ID.\nGrain: One row per source system ID.\n", "columns": {"kmk_hco_id": {"name": "kmk_hco_id", "description": "Internal HCO identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "source_code": {"name": "source_code", "description": "Source system name (DHC, DDD, MEDSCOUT, PRACTICE_LOCATION)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "source_id": {"name": "source_id", "description": "ID from the source system", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/mdm/schema.yml", "build_path": null, "unrendered_config": {"schema": "MDM", "materialized": "incremental", "tags": ["customer_backbone", "mdm"], "unique_key": ["source_code", "source_id"], "incremental_strategy": "merge"}, "created_at": 1770177079.2653701, "relation_name": "CGONCOLOGY_TEST.MDM.mdm_customer_xref_hco", "raw_code": "{{\n    config(\n        schema='MDM',\n        materialized='incremental',\n        unique_key=['source_code', 'source_id'],\n        incremental_strategy='merge',\n        tags=['customer_backbone', 'mdm']\n    )\n}}\n\n/*\nPROC-MDM-001: mdm_customer_xref_hco - HCO Cross-Reference\nSource: std_dh_hco, match_ddd_dhc, std_medscout_hco, mdm_customer_xref_hco_hist, std_dh_practice_location_hist\nBusiness Rules: ID-001, ID-011, ID-014-017, ID-020-023, MAT-220-221, STD-040, SCD-001-004\n\nID Generation:\n- ID-001: HCO prefix '3'\n- ID-011: Check history (TEST tables) before generating new IDs\n- ID-014-017: Source identifier preservation\n- ID-020-023: Never lose existing IDs\n\nCross-Reference Structure:\n- One row per source_code + source_id combination\n- DHC organizations are the anchor\n- DDD outlets link to their matched DHC org (share KMK_HCO_ID)\n- Medscout HCOs matched to DHC by NPI share KMK_HCO_ID (MAT-220)\n- Unmatched DDD/Medscout get their own KMK_HCO_ID (MAT-221)\n\nMedscout Matching (MAT-220 to MAT-221):\n- MAT-220: Match Medscout HCOs to DHC by NPI_NUMBER\n- MAT-221: Unmatched Medscout HCOs get standalone KMK_HCO_ID\n\nHistorical ID Preservation:\n- Lookup existing IDs from mdm_customer_xref_hco_hist (TEST)\n- DHC: Match on DH_ID\n- DDD: Match on DDD_OUTLET_NO\n- MEDSCOUT (unmatched only): Match on NPI_NUMBER (ID-023)\n- New records get IDs starting from MAX(existing) + 1\n- CRITICAL: Include historical records not in current source (100% ID preservation)\n- ENHANCEMENT (Jan 2026): For matched DDD outlets, prioritize sharing DHC's KMK_HCO_ID\n  over historical ID preservation. Historical IDs are only preserved for unmatched outlets.\n\nPractice Location Parent Lookup (Jan 2026 Enhancement):\n- For DDD outlets with MATCHED_KMK_PL_ID in match table but no DH_ID:\n  - Derive DH_ID from std_dh_practice_location_hist.PARENT_DH_ID (via unified HCO master)\n  - This fixes outlets matched via practice locations that weren't getting DH_ID assigned\n- Priority: 1) Match table DH_ID, 2) PL parent DH_ID (if KMK_PL_ID exists), 3) NULL\n- PHASE 6: Practice locations are now in unified HCO master (firm_type='PRACTICE_LOCATION')\n\nSCD2 Columns:\n- source_hash: SHA2 hash for change detection\n- is_active_in_source: Y/N - exists in current source feed\n- is_current: Always 'Y' for current XREF (history has version tracking)\n- load_date: When this version was created\n*/\n\nWITH\n-- Current records for ID lookups (self-referential to break circular dependency)\n-- INCREMENTAL: Uses {{ this }} (freeze mode - preserves existing IDs)\n-- FULL REFRESH: Uses _hist table (preserves IDs from history)\nhist_current_raw AS (\n    SELECT *,\n        ROW_NUMBER() OVER (\n            PARTITION BY SOURCE_CODE,\n                CASE\n                    WHEN SOURCE_CODE = 'DHC' THEN DH_ID\n                    WHEN SOURCE_CODE = 'DDD' THEN SOURCE_ID\n                    WHEN SOURCE_CODE = 'MEDSCOUT' THEN NPI\n                    WHEN SOURCE_CODE = 'PRACTICE_LOCATION' THEN KMK_HCO_ID\n                END\n            ORDER BY LOAD_DATE DESC, KMK_HCO_ID\n        ) AS dedup_rn\n    {% if is_incremental() %}\n    FROM {{ this }}\n    {% else %}\n    FROM {{ target.database }}.MDM.mdm_customer_xref_hco_hist\n    {% endif %}\n    WHERE is_current = 'Y'\n),\n\nhist_current AS (\n    SELECT *\n    FROM hist_current_raw\n    WHERE dedup_rn = 1\n),\n\n-- Historical IDs for DHC records (lookup by DH_ID)\n-- NOTE: Historical table should be updated with DEV IDs via update script before running XREF\nhist_dhc_ids AS (\n    SELECT DISTINCT DH_ID, KMK_HCO_ID\n    FROM hist_current\n    WHERE SOURCE_CODE = 'DHC' AND DH_ID IS NOT NULL\n),\n\n-- Historical IDs for DDD records (lookup by SOURCE_ID = DDD_OUTLET_ID)\n-- Simplified: DDD historical lookup uses SOURCE_ID where SOURCE_CODE='DDD'\nhist_ddd_ids AS (\n    SELECT DISTINCT\n        SOURCE_ID AS DDD_OUTLET_NO,\n        KMK_HCO_ID\n    FROM hist_current\n    WHERE SOURCE_CODE = 'DDD' AND SOURCE_ID IS NOT NULL\n),\n\n-- Historical IDs for Medscout records (lookup by NPI for ID preservation)\n-- ID-023: Medscout HCOs with same NPI should retain existing KMK_HCO_ID\nhist_medscout_ids AS (\n    SELECT DISTINCT NPI, KMK_HCO_ID\n    FROM hist_current\n    WHERE SOURCE_CODE = 'MEDSCOUT' AND NPI IS NOT NULL\n),\n\n-- Historical DHC records that no longer exist in current source\n-- These must be preserved for 100% ID continuity (is_active_in_source = 'N')\nhistorical_dhc_not_in_source AS (\n    SELECT\n        h.KMK_HCO_ID,\n        h.DH_ID,\n        h.ORG_NAME,\n        h.HQ_ADDRESS_LINE_1,\n        h.HQ_ADDRESS_LINE_2,\n        h.HQ_CITY,\n        h.HQ_STATE,\n        h.HQ_ZIP_CODE,\n        h.NPI,\n        h.FIRM_TYPE,\n        -- NOTE: ACCOUNT_TYPE removed from MDM layer - only in ADM layer\n        h.HOSPITAL_TYPE,\n        h.HOSPITAL_OWNERSHIP,\n        h.NETWORK_ID,\n        h.NETWORK_NAME,\n        h.NETWORK_FIRM_TYPE,\n        h.NETWORK_PARENT_ID,\n        h.NETWORK_PARENT_NAME,\n        h.NETWORK_PARENT_FIRM_TYPE,\n        h.HOSPITAL_PARENT_ID,\n        h.HOSPITAL_PARENT_NAME,\n        h.PG_PARENT_ID,\n        h.PG_PARENT_NAME,\n        h.SF_PARENT_ACCOUNT_ID,\n        h.SF_PARENT_ACCOUNT_NAME\n    FROM hist_current h\n    LEFT JOIN {{ ref('std_dh_hco') }} src ON h.DH_ID = src.dh_id\n    WHERE h.SOURCE_CODE = 'DHC'\n      AND h.DH_ID IS NOT NULL\n      AND src.dh_id IS NULL  -- Not in current source\n),\n\n-- Historical DDD records that no longer exist in current source (ID-020 fix)\n-- These must be preserved for 100% ID continuity (is_active_in_source = 'N')\nhistorical_ddd_not_in_source AS (\n    SELECT\n        h.KMK_HCO_ID,\n        h.SOURCE_ID AS DDD_OUTLET_NO,  -- SOURCE_ID is DDD_OUTLET_ID for DDD records\n        h.ORG_NAME,\n        h.HQ_ADDRESS_LINE_1,\n        h.HQ_ADDRESS_LINE_2,\n        h.HQ_CITY,\n        h.HQ_STATE,\n        h.HQ_ZIP_CODE,\n        h.NPI,\n        h.FIRM_TYPE,\n        -- NOTE: ACCOUNT_TYPE removed from MDM layer - only in ADM layer\n        h.NETWORK_ID,\n        h.NETWORK_NAME,\n        h.NETWORK_FIRM_TYPE,\n        h.NETWORK_PARENT_ID,\n        h.NETWORK_PARENT_NAME,\n        h.NETWORK_PARENT_FIRM_TYPE\n    FROM hist_current h\n    LEFT JOIN {{ ref('std_ddd_hco') }} src ON h.SOURCE_ID = src.ddd_outlet_id\n    WHERE h.SOURCE_CODE = 'DDD'\n      AND h.SOURCE_ID IS NOT NULL\n      AND src.ddd_outlet_id IS NULL  -- Not in current source\n),\n\n-- Get MAX ID from history for new ID generation (HCO IDs only, exclude practice locations)\n-- CRITICAL: Prefix '4' is reserved for practice locations only (ID-002 rule)\n-- HCO IDs (prefix '3') should use MAX of prefix '3' only, not MAX of all prefixes\nmax_hco_id AS (\n    SELECT COALESCE(MAX(CAST(SUBSTRING(KMK_HCO_ID, 2) AS NUMBER)), 0) AS max_id\n    FROM hist_current\n    WHERE LEFT(KMK_HCO_ID, 1) = '3'  -- Only prefix '3' (HCOs), exclude prefix '4' (practice locations)\n),\n\ndh_hcos AS (\n    -- All DHC organizations with historical ID lookup\n    -- FIX (2026-01-08): Prioritize DEV's IDs to ensure ID continuity\n    SELECT\n        'DHC' AS source_code,\n        s.dh_id AS source_id,\n        s.dh_id,\n        s.org_name,\n        s.hq_address_line_1,\n        s.hq_address_line_2,\n        s.hq_city,  -- STD-006: Already normalized via ZIP lookup\n        s.hq_state,\n        s.hq_zip_code,\n        s.npi,\n        s.firm_type,\n        -- NOTE: account_type removed from MDM layer - only in ADM layer\n        -- Hospital Type\n        s.hospital_type,\n        s.hospital_ownership,\n        -- Network Hierarchy\n        s.network_id,\n        s.network_name,\n        s.network_firm_type,\n        s.network_parent_id,\n        s.network_parent_name,\n        s.network_parent_firm_type,\n        -- Hospital Parent\n        s.hospital_parent_id,\n        s.hospital_parent_name,\n        -- PG Parent\n        s.pg_parent_id,\n        s.pg_parent_name,\n        -- SF Parent\n        s.sf_parent_account_id,\n        s.sf_parent_account_name,\n        NULL AS match_score,\n        'SOURCE' AS match_status,\n        -- Historical ID lookup (from updated historical table)\n        hist.KMK_HCO_ID AS historical_kmk_hco_id,\n        NULL AS kmk_hco_id,  -- Will be generated or use historical\n        NULL AS matched_kmk_pl_id  -- Only populated for DDD source\n    FROM {{ ref('std_dh_hco') }} s\n    LEFT JOIN hist_dhc_ids hist ON s.dh_id = hist.DH_ID\n),\n\n-- Practice Location parent lookup for deriving DH_ID from KMK_PL_ID\n-- Simplified: std_dh_practice_location_hist records ARE practice locations by definition\npl_parent_lookup AS (\n    SELECT DISTINCT\n        kmk_pl_id,\n        dh_id\n    FROM {{ ref('std_dh_practice_location_hist') }}\n    WHERE is_current = 'Y'\n      AND dh_id IS NOT NULL\n),\n\nddd_hcos AS (\n    -- DDD outlets with their match status and historical ID lookup\n    -- ENHANCEMENT: Derive DH_ID from PL parent when KMK_PL_ID exists but DH_ID is NULL\n    SELECT\n        'DDD' AS source_code,\n        d.ddd_outlet_id AS source_id,\n        -- Priority: 1) Match table DH_ID, 2) PL parent DH_ID (if KMK_PL_ID exists), 3) NULL\n        COALESCE(m.dh_id, pl_lookup.dh_id) AS dh_id,\n        d.ddd_outlet_name AS org_name,\n        d.address_line_1 AS hq_address_line_1,\n        NULL AS hq_address_line_2,\n        d.city AS hq_city,  -- STD-006: Already normalized via ZIP lookup\n        d.state AS hq_state,\n        d.zip_code AS hq_zip_code,\n        NULL AS npi,\n        NULL AS firm_type,\n        -- NOTE: account_type removed from MDM layer - only in ADM layer\n        -- Hospital Type (DDD doesn't have these)\n        NULL AS hospital_type,\n        NULL AS hospital_ownership,\n        -- Network Hierarchy (DDD doesn't have these)\n        NULL AS network_id,\n        NULL AS network_name,\n        NULL AS network_firm_type,\n        NULL AS network_parent_id,\n        NULL AS network_parent_name,\n        NULL AS network_parent_firm_type,\n        -- Hospital Parent (DDD doesn't have these)\n        NULL AS hospital_parent_id,\n        NULL AS hospital_parent_name,\n        -- PG Parent (DDD doesn't have these)\n        NULL AS pg_parent_id,\n        NULL AS pg_parent_name,\n        -- SF Parent (DDD doesn't have these)\n        NULL AS sf_parent_account_id,\n        NULL AS sf_parent_account_name,\n        m.address_match_score AS match_score,\n        m.match_status,\n        -- Historical ID lookup\n        -- CRITICAL: For matched DDD outlets (DH_ID IS NOT NULL), we will NOT preserve historical ID\n        -- Instead, they will share the DHC's KMK_HCO_ID (see id_generation logic below)\n        -- EXCEPTION: PL-matched DDD outlets get PL's '4' prefix ID (not DHC's '3' prefix)\n        CASE\n            WHEN m.matched_kmk_pl_id IS NOT NULL THEN NULL  -- PL-matched: will use PL's KMK_HCO_ID\n            WHEN COALESCE(m.dh_id, pl_lookup.dh_id) IS NOT NULL THEN NULL  -- L3-matched: will share DHC's ID\n            ELSE hist.KMK_HCO_ID  -- Unmatched: preserve historical ID\n        END AS historical_kmk_hco_id,\n        NULL AS kmk_hco_id,  -- Will be generated or use historical\n        m.matched_kmk_pl_id  -- MAT-014: PL entity KMK_HCO_ID from DDD matching\n    FROM {{ ref('std_ddd_hco') }} d\n    LEFT JOIN {{ ref('match_ddd_dhc') }} m ON d.ddd_outlet_id = m.ddd_outlet_id\n    LEFT JOIN hist_ddd_ids hist ON d.ddd_outlet_id = hist.DDD_OUTLET_NO\n    -- ENHANCEMENT: Look up PL parent DH_ID when match table has KMK_PL_ID but no DH_ID\n    LEFT JOIN pl_parent_lookup pl_lookup\n        ON m.matched_kmk_pl_id = pl_lookup.kmk_pl_id\n        AND m.dh_id IS NULL\n),\n\n-- Medscout HCOs (MAT-220 to MAT-229: Medscout HCO integration)\n-- MAT-220: Match Medscout HCOs to DHC by NPI - share KMK_HCO_ID when matched\n-- MAT-221: Unmatched Medscout HCOs get their own KMK_HCO_ID\n-- ID-023: Lookup historical ID by NPI_NUMBER to preserve existing KMK_HCO_IDs\nmedscout_hcos AS (\n    SELECT\n        'MEDSCOUT' AS source_code,\n        ms.medscout_id AS source_id,\n        dhc.dh_id,  -- MAT-220: Link to DHC when NPI matches\n        ms.org_name,\n        NULL AS hq_address_line_1,  -- Medscout doesn't have address_line_1\n        NULL AS hq_address_line_2,\n        ms.city AS hq_city,\n        ms.state AS hq_state,\n        NULL AS hq_zip_code,  -- Medscout doesn't have zip_code\n        ms.npi,\n        ms.facility_type AS firm_type,\n        -- NOTE: account_type removed from MDM layer - only in ADM layer\n        -- Hospital Type\n        NULL AS hospital_type,\n        NULL AS hospital_ownership,\n        -- Network Hierarchy (Medscout doesn't have these)\n        NULL AS network_id,\n        NULL AS network_name,\n        NULL AS network_firm_type,\n        NULL AS network_parent_id,\n        NULL AS network_parent_name,\n        NULL AS network_parent_firm_type,\n        -- Hospital Parent\n        NULL AS hospital_parent_id,\n        NULL AS hospital_parent_name,\n        -- PG Parent\n        NULL AS pg_parent_id,\n        NULL AS pg_parent_name,\n        -- SF Parent\n        NULL AS sf_parent_account_id,\n        NULL AS sf_parent_account_name,\n        NULL AS match_score,\n        CASE WHEN dhc.dh_id IS NOT NULL THEN 'NPI_MATCH' ELSE 'UNMATCHED' END AS match_status,\n        -- Historical ID lookup by NPI_NUMBER (ID-023: preserve existing IDs for unmatched)\n        -- For matched records, will use DHC's KMK_HCO_ID via dhc_ids lookup\n        CASE\n            WHEN dhc.dh_id IS NOT NULL THEN NULL  -- Will get ID from DHC\n            ELSE hist.KMK_HCO_ID\n        END AS historical_kmk_hco_id,\n        NULL AS kmk_hco_id,  -- Will be generated or use historical\n        NULL AS matched_kmk_pl_id  -- Only populated for DDD source\n    FROM {{ ref('std_medscout_hco') }} ms\n    LEFT JOIN {{ ref('std_dh_hco') }} dhc ON ms.npi = dhc.npi\n    LEFT JOIN hist_medscout_ids hist ON ms.npi = hist.NPI AND dhc.dh_id IS NULL\n),\n\nhistorical_dhc_hcos AS (\n    -- Historical DHC records not in current source (for 100% ID preservation)\n    SELECT\n        'DHC' AS source_code,\n        h.DH_ID AS source_id,\n        h.DH_ID AS dh_id,\n        h.ORG_NAME AS org_name,\n        h.HQ_ADDRESS_LINE_1 AS hq_address_line_1,\n        h.HQ_ADDRESS_LINE_2 AS hq_address_line_2,\n        h.HQ_CITY AS hq_city,\n        h.HQ_STATE AS hq_state,\n        h.HQ_ZIP_CODE AS hq_zip_code,\n        h.NPI AS npi,\n        h.FIRM_TYPE AS firm_type,\n        -- NOTE: account_type removed from MDM layer - only in ADM layer\n        h.HOSPITAL_TYPE AS hospital_type,\n        h.HOSPITAL_OWNERSHIP AS hospital_ownership,\n        h.NETWORK_ID AS network_id,\n        h.NETWORK_NAME AS network_name,\n        h.NETWORK_FIRM_TYPE AS network_firm_type,\n        h.NETWORK_PARENT_ID AS network_parent_id,\n        h.NETWORK_PARENT_NAME AS network_parent_name,\n        h.NETWORK_PARENT_FIRM_TYPE AS network_parent_firm_type,\n        h.HOSPITAL_PARENT_ID AS hospital_parent_id,\n        h.HOSPITAL_PARENT_NAME AS hospital_parent_name,\n        h.PG_PARENT_ID AS pg_parent_id,\n        h.PG_PARENT_NAME AS pg_parent_name,\n        h.SF_PARENT_ACCOUNT_ID AS sf_parent_account_id,\n        h.SF_PARENT_ACCOUNT_NAME AS sf_parent_account_name,\n        NULL AS match_score,\n        'HISTORICAL' AS match_status,\n        h.KMK_HCO_ID AS historical_kmk_hco_id,\n        NULL AS kmk_hco_id,  -- Will use historical\n        NULL AS matched_kmk_pl_id  -- Only populated for DDD source\n    FROM historical_dhc_not_in_source h\n),\n\n-- Historical DDD records not in current source (for 100% ID preservation - ID-020 fix)\nhistorical_ddd_hcos AS (\n    SELECT\n        'DDD' AS source_code,\n        h.DDD_OUTLET_NO AS source_id,\n        NULL AS dh_id,  -- DDD records don't have dh_id\n        h.ORG_NAME AS org_name,\n        h.HQ_ADDRESS_LINE_1 AS hq_address_line_1,\n        h.HQ_ADDRESS_LINE_2 AS hq_address_line_2,\n        h.HQ_CITY AS hq_city,\n        h.HQ_STATE AS hq_state,\n        h.HQ_ZIP_CODE AS hq_zip_code,\n        h.NPI AS npi,\n        h.FIRM_TYPE AS firm_type,\n        -- NOTE: account_type removed from MDM layer - only in ADM layer\n        NULL AS hospital_type,\n        NULL AS hospital_ownership,\n        h.NETWORK_ID AS network_id,\n        h.NETWORK_NAME AS network_name,\n        h.NETWORK_FIRM_TYPE AS network_firm_type,\n        h.NETWORK_PARENT_ID AS network_parent_id,\n        h.NETWORK_PARENT_NAME AS network_parent_name,\n        h.NETWORK_PARENT_FIRM_TYPE AS network_parent_firm_type,\n        NULL AS hospital_parent_id,\n        NULL AS hospital_parent_name,\n        NULL AS pg_parent_id,\n        NULL AS pg_parent_name,\n        NULL AS sf_parent_account_id,\n        NULL AS sf_parent_account_name,\n        NULL AS match_score,\n        'HISTORICAL' AS match_status,\n        h.KMK_HCO_ID AS historical_kmk_hco_id,\n        NULL AS kmk_hco_id,  -- Will use historical\n        NULL AS matched_kmk_pl_id  -- Only populated for DDD source\n    FROM historical_ddd_not_in_source h\n),\n\n-- ============================================\n-- PL CANONICALIZATION: One KMK_PL_ID per business key\n-- ============================================\n-- Business key: dh_id + UPPER(TRIM(address_line_1)) + state + LEFT(zip_code,5)\n-- Canonical ID: MIN(kmk_pl_id) per business key\n-- Purpose: Ensure 1:1 mapping even if history table has duplicates from incremental runs\n-- Incremental Safety: Future runs will reuse canonical ID via business key matching\npl_canonical AS (\n    SELECT\n        pl.dh_id,\n        UPPER(TRIM(pl.address_line_1)) AS addr1,\n        pl.state,\n        LEFT(pl.zip_code, 5) AS zip5,\n        MIN(pl.kmk_pl_id) AS canonical_kmk_pl_id\n    FROM {{ ref('std_dh_practice_location_hist') }} pl\n    WHERE pl.is_current = 'Y'\n      AND pl.kmk_pl_id IS NOT NULL\n      AND pl.dh_id IS NOT NULL\n    GROUP BY pl.dh_id, addr1, pl.state, zip5\n),\n\n-- ============================================\n-- PHASE 6: Practice Locations (Consolidated into HCO XREF)\n-- ============================================\n-- Practice locations are added as regular HCOs with source_code='PRACTICE_LOCATION'\n-- ID Strategy: Use CANONICAL KMK_PL_ID per business key (ensures 1:1 mapping)\n-- Source: std_dh_practice_location_hist (read-only, do NOT modify std layer)\n-- Incremental Safety: Canonicalization ensures duplicates don't propagate even if history has them\npractice_location_hcos AS (\n    SELECT\n        'PRACTICE_LOCATION' AS source_code,\n        canon.canonical_kmk_pl_id AS source_id,  -- Use canonical ID (ensures 1:1 per business key)\n        pl.dh_id,  -- Get dh_id from history (inherited from parent)\n        pl.practice_location_name AS org_name,\n        pl.address_line_1 AS hq_address_line_1,\n        pl.address_line_2 AS hq_address_line_2,\n        pl.city AS hq_city,  -- STD-006: Already normalized via ZIP lookup\n        pl.state AS hq_state,\n        pl.zip_code AS hq_zip_code,\n        NULL AS npi,  -- Practice locations don't have NPI\n        'Practice Location' AS firm_type,  -- Use NAME format to match other firm types\n        NULL AS hospital_type,\n        NULL AS hospital_ownership,\n        -- Network hierarchy: inherit from parent HCO (lookup later)\n        NULL AS network_id,\n        NULL AS network_name,\n        NULL AS network_firm_type,\n        NULL AS network_parent_id,\n        NULL AS network_parent_name,\n        NULL AS network_parent_firm_type,\n        NULL AS hospital_parent_id,\n        NULL AS hospital_parent_name,\n        NULL AS pg_parent_id,\n        NULL AS pg_parent_name,\n        NULL AS sf_parent_account_id,\n        NULL AS sf_parent_account_name,\n        NULL AS match_score,\n        'MATCHED' AS match_status,  -- Practice locations are matched to parent\n        -- Historical ID: Use canonical ID for consistency (future incremental runs will reuse it)\n        CAST(canon.canonical_kmk_pl_id AS VARCHAR) AS historical_kmk_hco_id,\n        -- ID mapping: Use canonical KMK_PL_ID as KMK_HCO_ID\n        CAST(canon.canonical_kmk_pl_id AS VARCHAR) AS kmk_hco_id,\n        NULL AS matched_kmk_pl_id  -- Only populated for DDD source\n    FROM {{ ref('std_dh_practice_location_hist') }} pl\n    INNER JOIN pl_canonical canon\n        ON pl.dh_id = canon.dh_id\n       AND UPPER(TRIM(pl.address_line_1)) = canon.addr1\n       AND pl.state = canon.state\n       AND LEFT(pl.zip_code, 5) = canon.zip5\n    WHERE pl.is_current = 'Y'\n      AND pl.kmk_pl_id IS NOT NULL\n      AND pl.dh_id IS NOT NULL\n    -- Deduplicate: Multiple history rows per business key \u2192 one canonical ID\n    QUALIFY ROW_NUMBER() OVER (\n        PARTITION BY canon.canonical_kmk_pl_id\n        ORDER BY pl.load_timestamp DESC\n    ) = 1\n),\n\n-- Combine all sources (current + historical DHC + historical DDD + Medscout + Practice Locations)\nall_sources AS (\n    SELECT * FROM dh_hcos\n    UNION ALL\n    SELECT * FROM ddd_hcos\n    UNION ALL\n    SELECT * FROM medscout_hcos\n    UNION ALL\n    SELECT * FROM historical_dhc_hcos\n    UNION ALL\n    SELECT * FROM historical_ddd_hcos\n    UNION ALL\n    SELECT * FROM practice_location_hcos\n),\n\n-- Generate KMK_HCO_ID with prefix '3'\n-- Priority: 1) Historical ID from DEV, 2) Generate new ID from MAX+1\n-- For matched DDD outlets, use the same KMK_HCO_ID as their DHC org\nid_generation AS (\n    SELECT\n        source_code,\n        source_id,\n        dh_id,\n        org_name,\n        hq_address_line_1,\n        hq_address_line_2,\n        hq_city,\n        hq_state,\n        hq_zip_code,\n        npi,\n        firm_type,\n        -- NOTE: account_type removed from MDM layer - only in ADM layer\n        -- Hospital Type\n        hospital_type,\n        hospital_ownership,\n        -- Network Hierarchy\n        network_id,\n        network_name,\n        network_firm_type,\n        network_parent_id,\n        network_parent_name,\n        network_parent_firm_type,\n        -- Hospital Parent\n        hospital_parent_id,\n        hospital_parent_name,\n        -- PG Parent\n        pg_parent_id,\n        pg_parent_name,\n        -- SF Parent\n        sf_parent_account_id,\n        sf_parent_account_name,\n        match_score,\n        match_status,\n        historical_kmk_hco_id,\n        kmk_hco_id,  -- For practice locations, this is already set from kmk_pl_id\n        matched_kmk_pl_id,  -- MAT-014: PL entity KMK_HCO_ID from DDD matching\n        -- Generate new ID only if no historical ID exists\n        -- New IDs start from MAX(DEV) + 1\n        -- CRITICAL FIX: For matched DDD outlets (dh_id IS NOT NULL), prioritize sharing DHC's ID\n        -- over historical ID preservation. Historical IDs are only preserved for unmatched outlets.\n        -- EXCEPTION: PL-matched DDD outlets get PL's '4' prefix ID directly\n        CASE\n            -- DHC: Use historical ID if available, otherwise generate new\n            WHEN source_code = 'DHC' AND historical_kmk_hco_id IS NOT NULL THEN\n                NULL  -- Use historical ID\n            WHEN source_code = 'DHC' THEN\n                '3' || LPAD(CAST(\n                    (SELECT max_id FROM max_hco_id) +\n                    ROW_NUMBER() OVER (\n                        PARTITION BY (source_code = 'DHC' AND historical_kmk_hco_id IS NULL)\n                        ORDER BY dh_id\n                    ) AS VARCHAR), 9, '0')\n            -- PL-matched DDD: Use PL's KMK_HCO_ID directly (shares the PL entity's '4' prefix ID)\n            WHEN source_code = 'DDD' AND matched_kmk_pl_id IS NOT NULL THEN\n                CAST(matched_kmk_pl_id AS VARCHAR)  -- DDD outlet shares PL's KMK_HCO_ID\n            -- L3-matched DDD (no PL): Share DHC's ID (ignore historical ID to fix 768 unmatched HCOs issue)\n            WHEN source_code = 'DDD' AND dh_id IS NOT NULL AND matched_kmk_pl_id IS NULL THEN\n                NULL  -- Will be filled via join to DHC's ID (prioritizes matching over historical ID)\n            -- Matched Medscout: Share DHC's ID\n            WHEN source_code = 'MEDSCOUT' AND dh_id IS NOT NULL THEN\n                NULL  -- MAT-220: Matched Medscout will get ID from DHC lookup\n            -- Unmatched Medscout: Use historical ID if available, otherwise generate new\n            WHEN source_code = 'MEDSCOUT' AND dh_id IS NULL AND historical_kmk_hco_id IS NOT NULL THEN\n                NULL  -- Use historical ID\n            WHEN source_code = 'MEDSCOUT' AND dh_id IS NULL THEN\n                -- MAT-221: Unmatched Medscout HCOs get their own IDs\n                '3' || LPAD(CAST(\n                    (SELECT max_id FROM max_hco_id) +\n                    (SELECT COUNT(*) FROM dh_hcos WHERE historical_kmk_hco_id IS NULL) +\n                    (SELECT COUNT(*) FROM ddd_hcos WHERE dh_id IS NULL AND historical_kmk_hco_id IS NULL) +\n                    ROW_NUMBER() OVER (\n                        PARTITION BY (source_code = 'MEDSCOUT' AND dh_id IS NULL AND historical_kmk_hco_id IS NULL)\n                        ORDER BY source_id\n                    ) AS VARCHAR), 9, '0')\n            -- Unmatched DDD: Use historical ID if available, otherwise generate new\n            WHEN source_code = 'DDD' AND dh_id IS NULL AND historical_kmk_hco_id IS NOT NULL THEN\n                NULL  -- Use historical ID (preserve for unmatched outlets only)\n            -- Practice Locations: Use existing kmk_hco_id (reused from kmk_pl_id)\n            WHEN source_code = 'PRACTICE_LOCATION' THEN\n                NULL  -- Use existing kmk_hco_id from practice_location_hcos CTE\n            ELSE\n                -- Unmatched DDD without historical ID\n                '3' || LPAD(CAST(\n                    (SELECT max_id FROM max_hco_id) +\n                    (SELECT COUNT(*) FROM dh_hcos WHERE historical_kmk_hco_id IS NULL) +\n                    ROW_NUMBER() OVER (\n                        PARTITION BY (source_code = 'DDD' AND dh_id IS NULL AND historical_kmk_hco_id IS NULL)\n                        ORDER BY source_id\n                    ) AS VARCHAR), 9, '0')\n        END AS generated_kmk_hco_id\n    FROM all_sources\n),\n\n-- Create DHC lookup for matched DDD outlets\n-- Use historical ID if available, otherwise generated ID\ndhc_ids AS (\n    SELECT\n        dh_id,\n        COALESCE(historical_kmk_hco_id, generated_kmk_hco_id) AS kmk_hco_id\n    FROM id_generation\n    WHERE source_code = 'DHC'\n),\n\n-- Final output with resolved KMK_HCO_IDs\n-- Priority: 1) Existing kmk_hco_id (practice locations), 2) Historical ID, 3) Generated ID, 4) DHC lookup (for matched DDD/MEDSCOUT)\nfinal_output AS (\n    SELECT\n        COALESCE(i.kmk_hco_id, i.historical_kmk_hco_id, i.generated_kmk_hco_id, d.kmk_hco_id) AS kmk_hco_id,\n        i.source_code,\n        i.source_id,\n        i.dh_id,\n        i.org_name,\n        i.hq_address_line_1,\n        i.hq_address_line_2,\n        i.hq_city,\n        i.hq_state,\n        i.hq_zip_code,\n        i.npi,\n        i.firm_type,\n        -- NOTE: account_type removed from MDM layer - only in ADM layer\n        -- Hospital Type\n        i.hospital_type,\n        i.hospital_ownership,\n        -- Network Hierarchy\n        i.network_id,\n        i.network_name,\n        i.network_firm_type,\n        i.network_parent_id,\n        i.network_parent_name,\n        i.network_parent_firm_type,\n        -- Hospital Parent\n        i.hospital_parent_id,\n        i.hospital_parent_name,\n        -- PG Parent\n        i.pg_parent_id,\n        i.pg_parent_name,\n        -- SF Parent\n        i.sf_parent_account_id,\n        i.sf_parent_account_name,\n        i.match_score,\n        i.match_status,\n        -- SCD2 Columns\n        -- source_hash: SHA2 hash for change detection\n        SHA2(CONCAT_WS('|',\n            COALESCE(i.dh_id, ''),\n            COALESCE(i.source_id, ''),\n            COALESCE(i.npi, ''),\n            COALESCE(i.org_name, ''),\n            COALESCE(i.firm_type, ''),\n            COALESCE(i.hq_address_line_1, ''),\n            COALESCE(i.hq_city, ''),\n            COALESCE(i.hq_state, ''),\n            COALESCE(i.hq_zip_code, '')\n        ), 256) AS source_hash,\n        -- is_active_in_source: Y for current source records, N for historical-only\n        CASE WHEN i.match_status = 'HISTORICAL' THEN 'N' ELSE 'Y' END AS is_active_in_source,\n        -- is_current: Always Y for the current XREF table\n        'Y' AS is_current,\n        -- load_date: When this version was created\n        CURRENT_TIMESTAMP() AS load_date,\n        CURRENT_TIMESTAMP() AS created_date,\n        CURRENT_TIMESTAMP() AS modified_date\n    FROM id_generation i\n    -- DHC lookup for matched DDD and MEDSCOUT records (both share KMK_HCO_ID with DHC)\n    -- EXCEPTION: PL-matched DDD outlets already have their ID from matched_kmk_pl_id, skip DHC lookup\n    LEFT JOIN dhc_ids d ON i.source_code IN ('DDD', 'MEDSCOUT')\n        AND i.dh_id = d.dh_id\n        AND (i.source_code != 'DDD' OR i.matched_kmk_pl_id IS NULL)\n),\n\n-- Deduplicate Step 1: Ensure one row per (source_code, source_id) combination\n-- This fixes duplicate DDD outlets and other source duplicates\n-- CRITICAL: This preserves N:1 relationships - multiple DDD outlets can share the same KMK_HCO_ID\ndedup_by_source_id AS (\n    SELECT *\n    FROM (\n        SELECT *,\n            ROW_NUMBER() OVER (\n                PARTITION BY source_code, source_id\n                ORDER BY\n                    -- Prioritize matched records over unmatched\n                    CASE WHEN match_status = 'HISTORICAL' THEN 2 ELSE 1 END,\n                    -- Prioritize records with DH_ID (for DDD/MEDSCOUT matched to DHC)\n                    CASE WHEN dh_id IS NOT NULL THEN 1 ELSE 2 END,\n                    load_date DESC\n            ) AS dedup_rn\n        FROM final_output\n        WHERE kmk_hco_id IS NOT NULL\n    )\n    WHERE dedup_rn = 1\n)\n\n-- FIXED 2026-01-12: Removed Step 2 deduplication that was removing N:1 relationships\n-- The XREF table should have one row per (source_code, source_id) combination\n-- Multiple DDD outlets can share the same KMK_HCO_ID (N:1 relationship)\n-- Step 1 deduplication is sufficient - no need for Step 2 which was causing MAT-046 failures\nSELECT\n    kmk_hco_id,\n    source_code,\n    source_id,\n    dh_id,\n    org_name,\n    hq_address_line_1,\n    hq_address_line_2,\n    hq_city,\n    hq_state,\n    hq_zip_code,\n    npi,\n    firm_type,\n    hospital_type,\n    hospital_ownership,\n    network_id,\n    network_name,\n    network_firm_type,\n    network_parent_id,\n    network_parent_name,\n    network_parent_firm_type,\n    hospital_parent_id,\n    hospital_parent_name,\n    pg_parent_id,\n    pg_parent_name,\n    sf_parent_account_id,\n    sf_parent_account_name,\n    match_score,\n    match_status,\n    source_hash,\n    is_active_in_source,\n    is_current,\n    load_date,\n    created_date,\n    modified_date\nFROM dedup_by_source_id", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hco", "package": null, "version": null}, {"name": "std_ddd_hco", "package": null, "version": null}, {"name": "std_dh_hco", "package": null, "version": null}, {"name": "std_dh_practice_location_hist", "package": null, "version": null}, {"name": "std_ddd_hco", "package": null, "version": null}, {"name": "match_ddd_dhc", "package": null, "version": null}, {"name": "std_medscout_hco", "package": null, "version": null}, {"name": "std_dh_hco", "package": null, "version": null}, {"name": "std_dh_practice_location_hist", "package": null, "version": null}, {"name": "std_dh_practice_location_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.CGOncology_MDM.std_dh_hco", "model.CGOncology_MDM.std_ddd_hco", "model.CGOncology_MDM.std_dh_practice_location_hist", "model.CGOncology_MDM.match_ddd_dhc", "model.CGOncology_MDM.std_medscout_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}, "model.CGOncology_MDM.stg_hcp_hco_claims": {"database": "CGONCOLOGY_TEST", "schema": "STAGING", "name": "stg_hcp_hco_claims", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "staging/stg_hcp_hco_claims.sql", "original_file_path": "models/staging/stg_hcp_hco_claims.sql", "unique_id": "model.CGOncology_MDM.stg_hcp_hco_claims", "fqn": ["CGOncology_MDM", "staging", "stg_hcp_hco_claims"], "alias": "stg_hcp_hco_claims", "checksum": {"name": "sha256", "checksum": "c23507c28cf4c2e92cc6cbc1efa8c7f9600d27c05f20a25ceaf490d1f8af345d"}, "config": {"enabled": true, "alias": null, "schema": "STAGING", "database": null, "tags": ["layer_2_staging", "customer_backbone", "customer_backbone", "bladder_cancer", "customer_backbone", "bladder_cancer"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_2_staging", "customer_backbone", "bladder_cancer"], "description": "CBR-CB-030: Centralized BC patient claims for HCP/HCO metrics and affiliation matching.\nIncludes DX, PX, and RX claims for BC patients.\nUsed by: stg_hcp_bc_metrics\n", "columns": {"PATIENT_ID": {"name": "PATIENT_ID", "description": "Patient identifier (all patients are in BC patient pool)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "HCP_NPI": {"name": "HCP_NPI", "description": "HCP NPI (PROVIDER_RENDERING_NPI for DX/PX, PROVIDER_PRESCRIBING_NPI for RX)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "FACILITY_NPI": {"name": "FACILITY_NPI", "description": "Facility NPI (NULL for RX claims - RX has no facility NPI)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "SERVICE_DATE": {"name": "SERVICE_DATE", "description": "Date of service (FILL_DATE for RX)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "CLAIM_TYPE": {"name": "CLAIM_TYPE", "description": "Claim type: DX, PX, or RX", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "TREATMENT_CATEGORY": {"name": "TREATMENT_CATEGORY", "description": "Treatment category from seed mapping (NULL for DX and non-BC PX)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/staging/schema.yml", "build_path": null, "unrendered_config": {"schema": "STAGING", "materialized": "table", "tags": ["customer_backbone", "bladder_cancer"]}, "created_at": 1770177079.3269389, "relation_name": "CGONCOLOGY_TEST.STAGING.stg_hcp_hco_claims", "raw_code": "{{ config(\n    schema='STAGING',\n    materialized='table',\n    tags=['customer_backbone', 'bladder_cancer']\n) }}\n\n/*\nCBR-CB-030: HCP to HCO Claims Aggregation\nPre-aggregates BC patient claim relationships for downstream use.\nIncludes: DX claims, PX claims, RX claims (all 3 pathways)\n\nUsed by:\n- stg_hcp_bc_metrics (HCP_NPI for HCP backbone metrics)\n\nNote: RX claims have PRESCRIBING_NPI but NO FACILITY_NPI,\nso FACILITY_NPI is NULL for RX rows.\n*/\n\nWITH dx_claims AS (\n    SELECT\n        dx.PATIENT_ID,\n        dx.PROVIDER_RENDERING_NPI AS HCP_NPI,\n        dx.PROVIDER_FACILITY_NPI AS FACILITY_NPI,\n        dx.SERVICE_DATE,\n        'DX' AS CLAIM_TYPE,\n        NULL AS TREATMENT_CATEGORY\n    FROM {{ ref('std_dx_claims') }} dx\n    INNER JOIN {{ ref('stg_bc_patient_pool') }} p ON p.PATIENT_ID = dx.PATIENT_ID\n),\n\npx_claims AS (\n    SELECT\n        px.PATIENT_ID,\n        px.PROVIDER_RENDERING_NPI AS HCP_NPI,\n        px.PROVIDER_FACILITY_NPI AS FACILITY_NPI,\n        px.SERVICE_DATE,\n        'PX' AS CLAIM_TYPE,\n        tc.metric_category AS TREATMENT_CATEGORY\n    FROM {{ ref('std_px_claims') }} px\n    INNER JOIN {{ ref('stg_bc_patient_pool') }} p ON p.PATIENT_ID = px.PATIENT_ID\n    LEFT JOIN {{ ref('ref_treatment_categories') }} tc\n        ON px.PROCEDURE_CODE = tc.code\n        AND tc.code_type IN ('CPT', 'HCPCS', 'ICD10PCS', 'ICD9')\n        -- NOTE: BC_PATIENT_POOL_FLAG filter removed - all codes get TREATMENT_CATEGORY for metrics\n),\n\nrx_claims AS (\n    -- RX has PRESCRIBING_NPI (maps to HCP) but NO FACILITY_NPI\n    SELECT\n        rx.PATIENT_ID,\n        rx.PROVIDER_PRESCRIBING_NPI AS HCP_NPI,\n        NULL AS FACILITY_NPI,  -- RX claims don't have facility NPI\n        rx.FILL_DATE AS SERVICE_DATE,\n        'RX' AS CLAIM_TYPE,\n        rx.TREATMENT_CATEGORY  -- Already joined in std_rx_claims\n    FROM {{ ref('std_rx_claims') }} rx\n    INNER JOIN {{ ref('stg_bc_patient_pool') }} p ON p.PATIENT_ID = rx.PATIENT_ID\n    WHERE rx.TREATMENT_CATEGORY IS NOT NULL  -- Only BC-related RX\n),\n\nall_claims AS (\n    SELECT * FROM dx_claims\n    UNION ALL\n    SELECT * FROM px_claims\n    UNION ALL\n    SELECT * FROM rx_claims\n)\n\nSELECT\n    PATIENT_ID,\n    HCP_NPI,\n    FACILITY_NPI,\n    SERVICE_DATE,\n    CLAIM_TYPE,\n    TREATMENT_CATEGORY\nFROM all_claims", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dx_claims", "package": null, "version": null}, {"name": "stg_bc_patient_pool", "package": null, "version": null}, {"name": "std_px_claims", "package": null, "version": null}, {"name": "stg_bc_patient_pool", "package": null, "version": null}, {"name": "ref_treatment_categories", "package": null, "version": null}, {"name": "std_rx_claims", "package": null, "version": null}, {"name": "stg_bc_patient_pool", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.std_dx_claims", "model.CGOncology_MDM.stg_bc_patient_pool", "model.CGOncology_MDM.std_px_claims", "model.CGOncology_MDM.ref_treatment_categories", "model.CGOncology_MDM.std_rx_claims"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}, "model.CGOncology_MDM.stg_hcp_bc_metrics": {"database": "CGONCOLOGY_TEST", "schema": "STAGING", "name": "stg_hcp_bc_metrics", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "staging/stg_hcp_bc_metrics.sql", "original_file_path": "models/staging/stg_hcp_bc_metrics.sql", "unique_id": "model.CGOncology_MDM.stg_hcp_bc_metrics", "fqn": ["CGOncology_MDM", "staging", "stg_hcp_bc_metrics"], "alias": "stg_hcp_bc_metrics", "checksum": {"name": "sha256", "checksum": "b0d3e1ca20c0d312bf1b4cddd2dfc5a52cc339f2a244e1f6b7121e0ce37346f2"}, "config": {"enabled": true, "alias": null, "schema": "STAGING", "database": null, "tags": ["layer_2_staging", "customer_backbone", "customer_backbone", "bladder_cancer", "backbone_flag"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_2_staging", "customer_backbone", "bladder_cancer", "backbone_flag"], "description": "HCP bladder cancer patient metrics for backbone flag determination.\nBusiness Rules: BBN-011 to BBN-019\nLinks BC patient pool to HCPs via rendering provider NPI matching.\nBackbone includes: Urologists, HCPs with BC treatment/procedure claims, targets, activity.\n", "columns": {"NPI": {"name": "NPI", "description": "National Provider Identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "BC_PATIENT_COUNT": {"name": "BC_PATIENT_COUNT", "description": "Count of unique BC patients treated by this HCP", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "DX_PATIENT_COUNT": {"name": "DX_PATIENT_COUNT", "description": "Count of unique patients with DX claims", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "RX_PATIENT_COUNT": {"name": "RX_PATIENT_COUNT", "description": "Count of unique BC patients with RX (prescription) claims", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "TURBT_PATIENTS": {"name": "TURBT_PATIENTS", "description": "Count of TURBT procedure patients", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "BCG_PATIENTS": {"name": "BCG_PATIENTS", "description": "Count of BCG treatment patients", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "ADSTILADRIN_PATIENTS": {"name": "ADSTILADRIN_PATIENTS", "description": "Count of Adstiladrin treatment patients", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "ANKTIVA_PATIENTS": {"name": "ANKTIVA_PATIENTS", "description": "Count of Anktiva treatment patients", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "KEYTRUDA_PATIENTS": {"name": "KEYTRUDA_PATIENTS", "description": "Count of Keytruda treatment patients", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "CYSTOSCOPY_PATIENTS": {"name": "CYSTOSCOPY_PATIENTS", "description": "Count of Cystoscopy procedure patients", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "RX_BCG_PATIENTS": {"name": "RX_BCG_PATIENTS", "description": "Count of BCG prescription patients (RX pathway)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "RX_ADSTILADRIN_PATIENTS": {"name": "RX_ADSTILADRIN_PATIENTS", "description": "Count of Adstiladrin prescription patients (RX pathway)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "RX_ANKTIVA_PATIENTS": {"name": "RX_ANKTIVA_PATIENTS", "description": "Count of Anktiva prescription patients (RX pathway)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "IS_UROLOGIST": {"name": "IS_UROLOGIST", "description": "Y if primary specialty is Urology", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "IS_TARGET": {"name": "IS_TARGET", "description": "Y if HCP is a potential target (BBN-019)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "HAS_ACTIVITY": {"name": "HAS_ACTIVITY", "description": "Y if HCP has activity/engagement data (BBN-017/018)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "HAS_BC_TREATMENT_CLAIMS": {"name": "HAS_BC_TREATMENT_CLAIMS", "description": "Y if HCP has BC treatment claims (TURBT, BCG, etc.)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "HAS_BC_PROCEDURE_CLAIMS": {"name": "HAS_BC_PROCEDURE_CLAIMS", "description": "Y if HCP has BC procedure claims (Cystoscopy, etc.)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "HAS_BC_RX_CLAIMS": {"name": "HAS_BC_RX_CLAIMS", "description": "Y if HCP has BC RX prescriptions (BCG, Adstiladrin, Anktiva)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "BC_BACKBONE_FLAG": {"name": "BC_BACKBONE_FLAG", "description": "Y if HCP is in backbone (Urologist OR treatment/procedure OR target OR activity)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "HCP_CATEGORY": {"name": "HCP_CATEGORY", "description": "HCP category based on backbone criteria", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "BC_VOLUME_TIER": {"name": "BC_VOLUME_TIER", "description": "Volume tier based on treatment patient count", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "DATA_DATE": {"name": "DATA_DATE", "description": "Data snapshot date", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/staging/schema.yml", "build_path": null, "unrendered_config": {"schema": "STAGING", "materialized": "table", "tags": ["customer_backbone", "bladder_cancer", "backbone_flag"]}, "created_at": 1770177079.327657, "relation_name": "CGONCOLOGY_TEST.STAGING.stg_hcp_bc_metrics", "raw_code": "{{ config(\n    schema='STAGING',\n    materialized='table',\n    tags=['customer_backbone', 'bladder_cancer', 'backbone_flag']\n) }}\n\n/*\nBBN-011 to BBN-019: HCP BC Patient Metrics (Complete Backbone Definition)\nLinks BC patient pool to HCPs via rendering provider NPI matching\n\nSource: stg_hcp_hco_claims (centralized BC claims model)\nIncludes: DX, PX, and RX claims metrics\n\nBackbone Flag Criteria:\n1. BBN-011: SPECIALTY_PRIMARY = 'Urology' (pattern match, excludes 'Neurology' false positive), OR\n2. BBN-011: HCP has BC TREATMENT claims (TURBT, TICE_BCG, ADSTILADRIN, ANKTIVA, KEYTRUDA), OR\n3. BBN-011: HCP has BC RX prescriptions (BCG, Adstiladrin, Anktiva), OR\n4. BBN-019: HCP is a target (POTENTIAL_TARGET_FLAG = 1), OR\n5. BBN-017/018: HCP has activity/profiling data\n\nNOTE: Cystoscopy claims are tracked as metrics but do NOT trigger backbone inclusion.\n      KEYTRUDA is tracked as a separate treatment category (not grouped with OTHER_PX).\n\nEXCLUDED: HCPs who only have BC diagnosis claims (no treatment/RX)\n          AND are not targets AND have no activity\n          AND 'Neurology' specialty (false positive for urology pattern match)\n\nExpected backbone count: ~43K HCPs (matching DEV logic)\n*/\n\n-- Target HCPs (BBN-019)\n-- Source: adm_sfe_hcp_targets (hardcoded - SFE models disabled)\nWITH target_hcps AS (\n    SELECT DISTINCT CAST(npi AS VARCHAR) AS NPI\n    FROM {{ target.database }}.ADM.adm_sfe_hcp_targets\n    WHERE kam_target_flag = 'Y'\n      AND target_version = '{{ var(\"sfe_version\") }}'\n),\n\n-- Activity HCPs (BBN-017/018) - HCPs with REAL activities/calls\nactivity_hcps AS (\n    SELECT DISTINCT HCP_ID AS NPI\n    FROM CGONCOLOGY_DEV.STAGING.STAGE_ACTIVITY_HCP_REACH\n),\n\n-- All claims from centralized model\nclaims_with_category AS (\n    SELECT\n        PATIENT_ID,\n        HCP_NPI AS NPI,\n        CLAIM_TYPE,\n        TREATMENT_CATEGORY\n    FROM {{ ref('stg_hcp_hco_claims') }}\n    WHERE HCP_NPI IS NOT NULL\n),\n\n-- PX metrics with treatment flags (for backbone determination)\npx_metrics AS (\n    SELECT\n        h.npi AS NPI,\n        COUNT(DISTINCT c.PATIENT_ID) AS BC_PATIENT_COUNT,\n        -- Treatment claims flags (TURBT, BCG, Adstiladrin, Anktiva, Keytruda) - triggers backbone\n        MAX(CASE WHEN c.TREATMENT_CATEGORY IN ('TURBT', 'TICE_BCG', 'ADSTILADRIN', 'ANKTIVA', 'KEYTRUDA') THEN 1 ELSE 0 END) AS HAS_BC_TREATMENT_CLAIMS,\n        -- Procedure claims flags (Other procedures only - Cystoscopy excluded from backbone trigger)\n        MAX(CASE WHEN c.TREATMENT_CATEGORY = 'OTHER_PX' THEN 1 ELSE 0 END) AS HAS_BC_PROCEDURE_CLAIMS,\n        -- Individual treatment counts\n        COUNT(DISTINCT CASE WHEN c.TREATMENT_CATEGORY = 'TURBT' THEN c.PATIENT_ID END) AS TURBT_PATIENTS,\n        COUNT(DISTINCT CASE WHEN c.TREATMENT_CATEGORY = 'TICE_BCG' THEN c.PATIENT_ID END) AS PX_BCG_PATIENTS,\n        COUNT(DISTINCT CASE WHEN c.TREATMENT_CATEGORY = 'ADSTILADRIN' THEN c.PATIENT_ID END) AS PX_ADSTILADRIN_PATIENTS,\n        COUNT(DISTINCT CASE WHEN c.TREATMENT_CATEGORY = 'ANKTIVA' THEN c.PATIENT_ID END) AS PX_ANKTIVA_PATIENTS,\n        COUNT(DISTINCT CASE WHEN c.TREATMENT_CATEGORY = 'KEYTRUDA' THEN c.PATIENT_ID END) AS KEYTRUDA_PATIENTS,\n        COUNT(DISTINCT CASE WHEN c.TREATMENT_CATEGORY = 'CYSTOSCOPY' THEN c.PATIENT_ID END) AS CYSTOSCOPY_PATIENTS\n    FROM claims_with_category c\n    INNER JOIN {{ ref('std_dh_hcp') }} h ON c.NPI = h.npi\n    WHERE c.CLAIM_TYPE = 'PX'\n    GROUP BY h.npi\n),\n\n-- DX metrics (for reference only, NOT used in backbone)\ndx_metrics AS (\n    SELECT\n        h.npi AS NPI,\n        COUNT(DISTINCT c.PATIENT_ID) AS DX_PATIENT_COUNT\n    FROM claims_with_category c\n    INNER JOIN {{ ref('std_dh_hcp') }} h ON c.NPI = h.npi\n    WHERE c.CLAIM_TYPE = 'DX'\n    GROUP BY h.npi\n),\n\n-- RX metrics (NEW - prescriber-based BC treatment tracking)\nrx_metrics AS (\n    SELECT\n        h.npi AS NPI,\n        COUNT(DISTINCT c.PATIENT_ID) AS RX_PATIENT_COUNT,\n        -- RX treatment flags - triggers backbone\n        MAX(CASE WHEN c.TREATMENT_CATEGORY IN ('TICE_BCG', 'ADSTILADRIN', 'ANKTIVA') THEN 1 ELSE 0 END) AS HAS_BC_RX_CLAIMS,\n        -- Individual RX treatment counts\n        COUNT(DISTINCT CASE WHEN c.TREATMENT_CATEGORY = 'TICE_BCG' THEN c.PATIENT_ID END) AS RX_BCG_PATIENTS,\n        COUNT(DISTINCT CASE WHEN c.TREATMENT_CATEGORY = 'ADSTILADRIN' THEN c.PATIENT_ID END) AS RX_ADSTILADRIN_PATIENTS,\n        COUNT(DISTINCT CASE WHEN c.TREATMENT_CATEGORY = 'ANKTIVA' THEN c.PATIENT_ID END) AS RX_ANKTIVA_PATIENTS\n    FROM claims_with_category c\n    INNER JOIN {{ ref('std_dh_hcp') }} h ON c.NPI = h.npi\n    WHERE c.CLAIM_TYPE = 'RX'\n    GROUP BY h.npi\n),\n\n-- Combine metrics from all claim types\ncombined AS (\n    SELECT\n        COALESCE(px.NPI, dx.NPI, rx.NPI) AS NPI,\n        COALESCE(px.BC_PATIENT_COUNT, 0) AS BC_PATIENT_COUNT,\n        COALESCE(dx.DX_PATIENT_COUNT, 0) AS DX_PATIENT_COUNT,\n        COALESCE(rx.RX_PATIENT_COUNT, 0) AS RX_PATIENT_COUNT,\n        COALESCE(px.HAS_BC_TREATMENT_CLAIMS, 0) AS HAS_BC_TREATMENT_CLAIMS,\n        COALESCE(px.HAS_BC_PROCEDURE_CLAIMS, 0) AS HAS_BC_PROCEDURE_CLAIMS,\n        COALESCE(rx.HAS_BC_RX_CLAIMS, 0) AS HAS_BC_RX_CLAIMS,\n        COALESCE(px.TURBT_PATIENTS, 0) AS TURBT_PATIENTS,\n        -- Combined BCG patients (PX + RX)\n        COALESCE(px.PX_BCG_PATIENTS, 0) + COALESCE(rx.RX_BCG_PATIENTS, 0) AS BCG_PATIENTS,\n        -- Combined Adstiladrin patients (PX + RX)\n        COALESCE(px.PX_ADSTILADRIN_PATIENTS, 0) + COALESCE(rx.RX_ADSTILADRIN_PATIENTS, 0) AS ADSTILADRIN_PATIENTS,\n        -- Combined Anktiva patients (PX + RX)\n        COALESCE(px.PX_ANKTIVA_PATIENTS, 0) + COALESCE(rx.RX_ANKTIVA_PATIENTS, 0) AS ANKTIVA_PATIENTS,\n        COALESCE(px.KEYTRUDA_PATIENTS, 0) AS KEYTRUDA_PATIENTS,\n        COALESCE(px.CYSTOSCOPY_PATIENTS, 0) AS CYSTOSCOPY_PATIENTS,\n        -- RX-only metrics (for granular reporting)\n        COALESCE(rx.RX_BCG_PATIENTS, 0) AS RX_BCG_PATIENTS,\n        COALESCE(rx.RX_ADSTILADRIN_PATIENTS, 0) AS RX_ADSTILADRIN_PATIENTS,\n        COALESCE(rx.RX_ANKTIVA_PATIENTS, 0) AS RX_ANKTIVA_PATIENTS\n    FROM px_metrics px\n    FULL OUTER JOIN dx_metrics dx ON px.NPI = dx.NPI\n    FULL OUTER JOIN rx_metrics rx ON COALESCE(px.NPI, dx.NPI) = rx.NPI\n),\n\n-- All relevant HCPs (claims + targets + activity + urologists)\n-- FIX: Include all urologists even without claims (per BBN-011)\nall_relevant_npis AS (\n    SELECT DISTINCT NPI FROM combined WHERE NPI IS NOT NULL\n    UNION\n    SELECT DISTINCT NPI FROM target_hcps\n    UNION\n    SELECT DISTINCT NPI FROM activity_hcps\n    UNION\n    -- BBN-011: All urologists from DH (current snapshot) should be in backbone\n    SELECT DISTINCT npi AS NPI\n    FROM {{ ref('std_dh_hcp') }}\n    WHERE PRIMARY_SPECIALTY ILIKE '%urology%'\n      AND PRIMARY_SPECIALTY NOT ILIKE '%neurology%'\n    UNION\n    -- BBN-011: All urologists from DH history (includes historical urologists not in current source)\n    -- This ensures urologists retained for historical continuity still get backbone flag\n    SELECT DISTINCT npi AS NPI\n    FROM {{ ref('std_dh_hcp_hist') }}\n    WHERE PRIMARY_SPECIALTY ILIKE '%urology%'\n      AND PRIMARY_SPECIALTY NOT ILIKE '%neurology%'\n      AND is_current = 'Y'\n    UNION\n    -- BBN-011: All urologists from XREF history (includes urologists removed before incremental tracking)\n    -- These are historical urologists preserved in XREF but not in std_dh_hcp_hist\n    SELECT DISTINCT npi AS NPI\n    FROM {{ ref('mdm_customer_xref_hcp_hist') }}\n    WHERE SOURCE_CODE = 'DHC'\n      AND PRIMARY_SPECIALTY ILIKE '%urology%'\n      AND PRIMARY_SPECIALTY NOT ILIKE '%neurology%'\n      AND is_current = 'Y'\n    UNION\n    -- BBN-011: All urologists from Medscout should be in backbone\n    SELECT DISTINCT npi AS NPI\n    FROM {{ ref('std_medscout_hcp') }}\n    WHERE PRIMARY_SPECIALTY ILIKE '%urology%'\n      AND PRIMARY_SPECIALTY NOT ILIKE '%neurology%'\n),\n\n-- Join with HCP master to get specialty, target, and activity flags\nhcp_with_specialty AS (\n    SELECT\n        h.npi AS NPI,\n        COALESCE(c.BC_PATIENT_COUNT, 0) AS BC_PATIENT_COUNT,\n        COALESCE(c.DX_PATIENT_COUNT, 0) AS DX_PATIENT_COUNT,\n        COALESCE(c.RX_PATIENT_COUNT, 0) AS RX_PATIENT_COUNT,\n        COALESCE(c.HAS_BC_TREATMENT_CLAIMS, 0) AS HAS_BC_TREATMENT_CLAIMS,\n        COALESCE(c.HAS_BC_PROCEDURE_CLAIMS, 0) AS HAS_BC_PROCEDURE_CLAIMS,\n        COALESCE(c.HAS_BC_RX_CLAIMS, 0) AS HAS_BC_RX_CLAIMS,\n        COALESCE(c.TURBT_PATIENTS, 0) AS TURBT_PATIENTS,\n        COALESCE(c.BCG_PATIENTS, 0) AS BCG_PATIENTS,\n        COALESCE(c.ADSTILADRIN_PATIENTS, 0) AS ADSTILADRIN_PATIENTS,\n        COALESCE(c.ANKTIVA_PATIENTS, 0) AS ANKTIVA_PATIENTS,\n        COALESCE(c.KEYTRUDA_PATIENTS, 0) AS KEYTRUDA_PATIENTS,\n        COALESCE(c.CYSTOSCOPY_PATIENTS, 0) AS CYSTOSCOPY_PATIENTS,\n        COALESCE(c.RX_BCG_PATIENTS, 0) AS RX_BCG_PATIENTS,\n        COALESCE(c.RX_ADSTILADRIN_PATIENTS, 0) AS RX_ADSTILADRIN_PATIENTS,\n        COALESCE(c.RX_ANKTIVA_PATIENTS, 0) AS RX_ANKTIVA_PATIENTS,\n        h.PRIMARY_SPECIALTY,\n        -- BBN-011: Urologist flag - exclude false positives (Neurology)\n        CASE\n            WHEN h.PRIMARY_SPECIALTY ILIKE '%urology%'\n                 AND h.PRIMARY_SPECIALTY NOT ILIKE '%neurology%'\n            THEN 'Y'\n            ELSE 'N'\n        END AS IS_UROLOGIST,\n        -- BBN-019: Target flag\n        CASE WHEN t.NPI IS NOT NULL THEN 'Y' ELSE 'N' END AS IS_TARGET,\n        -- BBN-017/018: Activity flag\n        CASE WHEN a.NPI IS NOT NULL THEN 'Y' ELSE 'N' END AS HAS_ACTIVITY\n    FROM all_relevant_npis r\n    -- Use mdm_customer_xref_hcp_hist to include ALL HCPs (current + historical urologists)\n    -- This captures urologists removed before incremental tracking started\n    INNER JOIN {{ ref('mdm_customer_xref_hcp_hist') }} h\n        ON r.NPI = h.npi\n        AND h.is_current = 'Y'\n        AND h.source_code = 'DHC'\n    LEFT JOIN combined c ON r.NPI = c.NPI\n    LEFT JOIN target_hcps t ON r.NPI = t.NPI\n    LEFT JOIN activity_hcps a ON r.NPI = a.NPI\n)\n\nSELECT\n    NPI,\n    BC_PATIENT_COUNT,\n    DX_PATIENT_COUNT,\n    RX_PATIENT_COUNT,\n    TURBT_PATIENTS,\n    BCG_PATIENTS,\n    ADSTILADRIN_PATIENTS,\n    ANKTIVA_PATIENTS,\n    KEYTRUDA_PATIENTS,\n    CYSTOSCOPY_PATIENTS,\n    -- RX-specific metrics\n    RX_BCG_PATIENTS,\n    RX_ADSTILADRIN_PATIENTS,\n    RX_ANKTIVA_PATIENTS,\n    IS_UROLOGIST,\n    IS_TARGET,         -- BBN-019\n    HAS_ACTIVITY,      -- BBN-017/018\n    -- Treatment/Procedure/RX flags\n    CASE WHEN HAS_BC_TREATMENT_CLAIMS = 1 THEN 'Y' ELSE 'N' END AS HAS_BC_TREATMENT_CLAIMS,\n    CASE WHEN HAS_BC_PROCEDURE_CLAIMS = 1 THEN 'Y' ELSE 'N' END AS HAS_BC_PROCEDURE_CLAIMS,\n    CASE WHEN HAS_BC_RX_CLAIMS = 1 THEN 'Y' ELSE 'N' END AS HAS_BC_RX_CLAIMS,\n    -- BBN-011 to BBN-019: Complete backbone flag\n    -- Backbone = Urologist OR treatment claims OR RX claims OR target OR activity\n    -- NOTE: Cystoscopy does NOT trigger backbone (removed per DEV alignment)\n    CASE\n        WHEN IS_UROLOGIST = 'Y' THEN 'Y'              -- BBN-011\n        WHEN HAS_BC_TREATMENT_CLAIMS = 1 THEN 'Y'     -- BBN-011: TURBT, BCG, Adstiladrin, Anktiva, Keytruda (PX)\n        WHEN HAS_BC_RX_CLAIMS = 1 THEN 'Y'            -- BBN-011: BCG, Adstiladrin, Anktiva (RX prescriptions)\n        WHEN IS_TARGET = 'Y' THEN 'Y'                 -- BBN-019: Target HCPs\n        WHEN HAS_ACTIVITY = 'Y' THEN 'Y'              -- BBN-017/018: Activity HCPs\n        ELSE 'N'\n    END AS BC_BACKBONE_FLAG,\n    -- HCP Category (with new target/activity categories)\n    CASE\n        WHEN IS_UROLOGIST = 'Y' THEN 'Urologist'\n        WHEN HAS_BC_TREATMENT_CLAIMS = 1 THEN 'BC Treatment Patient Pool'\n        WHEN HAS_BC_RX_CLAIMS = 1 THEN 'BC RX Prescriber'\n        WHEN IS_TARGET = 'Y' THEN 'Target HCP'              -- BBN-019\n        WHEN HAS_ACTIVITY = 'Y' THEN 'Activity HCP'         -- BBN-017/018\n        ELSE 'Total BC Patient Pool'\n    END AS HCP_CATEGORY,\n    -- Tier based on treatment patient volume (unchanged)\n    CASE\n        WHEN BC_PATIENT_COUNT >= 50 THEN 'HIGH'\n        WHEN BC_PATIENT_COUNT >= 20 THEN 'MEDIUM'\n        WHEN BC_PATIENT_COUNT >= 1 THEN 'LOW'\n        ELSE 'NONE'\n    END AS BC_VOLUME_TIER,\n    CURRENT_DATE() AS DATA_DATE\nFROM hcp_with_specialty\n-- Include ALL HCPs with BC claims, targets, or activity (not just backbone) for metrics\nWHERE BC_PATIENT_COUNT >= 1\n   OR DX_PATIENT_COUNT >= 1\n   OR RX_PATIENT_COUNT >= 1\n   OR IS_UROLOGIST = 'Y'\n   OR IS_TARGET = 'Y'\n   OR HAS_ACTIVITY = 'Y'\n-- Deduplicate: One row per NPI (handle duplicate XREF records)\nQUALIFY ROW_NUMBER() OVER (PARTITION BY NPI ORDER BY BC_PATIENT_COUNT DESC NULLS LAST) = 1", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_hco_claims", "package": null, "version": null}, {"name": "std_dh_hcp", "package": null, "version": null}, {"name": "std_dh_hcp", "package": null, "version": null}, {"name": "std_dh_hcp", "package": null, "version": null}, {"name": "std_dh_hcp", "package": null, "version": null}, {"name": "std_dh_hcp_hist", "package": null, "version": null}, {"name": "mdm_customer_xref_hcp_hist", "package": null, "version": null}, {"name": "std_medscout_hcp", "package": null, "version": null}, {"name": "mdm_customer_xref_hcp_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.stg_hcp_hco_claims", "model.CGOncology_MDM.std_dh_hcp", "model.CGOncology_MDM.std_dh_hcp_hist", "model.CGOncology_MDM.mdm_customer_xref_hcp_hist", "model.CGOncology_MDM.std_medscout_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["NPI"], "time_spine": null}, "model.CGOncology_MDM.stg_bc_patient_pool": {"database": "CGONCOLOGY_TEST", "schema": "STAGING", "name": "stg_bc_patient_pool", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "staging/stg_bc_patient_pool.sql", "original_file_path": "models/staging/stg_bc_patient_pool.sql", "unique_id": "model.CGOncology_MDM.stg_bc_patient_pool", "fqn": ["CGOncology_MDM", "staging", "stg_bc_patient_pool"], "alias": "stg_bc_patient_pool", "checksum": {"name": "sha256", "checksum": "ea35c106084335ad59c5887aaad77eb488e8cdae5c0acb6cacefdc60b946199d"}, "config": {"enabled": true, "alias": null, "schema": "STAGING", "database": null, "tags": ["layer_2_staging", "customer_backbone", "customer_backbone", "bladder_cancer", "BC Patient", "customer_backbone", "bladder_cancer", "BC Patient"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_2_staging", "customer_backbone", "bladder_cancer", "BC Patient"], "description": "CBR-CB-027: Unified BC patient pool from all three identification pathways (DX, PX, RX). One row per unique BC patient. Moved from standardization to staging (Jan 2026).", "columns": {"PATIENT_ID": {"name": "PATIENT_ID", "description": "Unique patient identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "IDENTIFIED_VIA_DX": {"name": "IDENTIFIED_VIA_DX", "description": "Y if patient identified via diagnosis codes, N otherwise", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "IDENTIFIED_VIA_PX": {"name": "IDENTIFIED_VIA_PX", "description": "Y if patient identified via procedure codes, N otherwise", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "IDENTIFIED_VIA_RX": {"name": "IDENTIFIED_VIA_RX", "description": "Y if patient identified via prescription codes/names, N otherwise", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "IDENTIFICATION_PATHWAY_COUNT": {"name": "IDENTIFICATION_PATHWAY_COUNT", "description": "Number of pathways that identified this patient (1-3)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "IDENTIFICATION_PATHWAYS": {"name": "IDENTIFICATION_PATHWAYS", "description": "Comma-separated list of pathways (e.g., 'DX, PX', 'RX', 'DX, PX, RX')", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "EARLIEST_BC_EVENT_DATE": {"name": "EARLIEST_BC_EVENT_DATE", "description": "Earliest BC-related event date across all pathways", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "LATEST_BC_EVENT_DATE": {"name": "LATEST_BC_EVENT_DATE", "description": "Latest BC-related event date across all pathways", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "TOTAL_BC_CLAIM_COUNT": {"name": "TOTAL_BC_CLAIM_COUNT", "description": "Total BC-specific claims across all pathways", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PATIENT_GENDER": {"name": "PATIENT_GENDER", "description": "Patient gender (coalesced from best available pathway)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PATIENT_BIRTH_YEAR": {"name": "PATIENT_BIRTH_YEAR", "description": "Patient birth year (coalesced from best available pathway)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PATIENT_ZIP3": {"name": "PATIENT_ZIP3", "description": "Patient 3-digit ZIP code (coalesced from best available pathway)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/staging/schema.yml", "build_path": null, "unrendered_config": {"schema": "STAGING", "materialized": "table", "tags": ["customer_backbone", "bladder_cancer", "BC Patient"]}, "created_at": 1770177079.326278, "relation_name": "CGONCOLOGY_TEST.STAGING.stg_bc_patient_pool", "raw_code": "{{ config(\n    schema='STAGING',\n    materialized='table',\n    tags=['customer_backbone', 'bladder_cancer', 'BC Patient']\n) }}\n\n/*\nCBR-CB-027: BC Patient Pool Consolidation\nFULL OUTER JOIN across all three identification pathways (DX, PX, RX)\nOne row per unique BC patient with pathway tracking\n\nDate Range Configuration:\n- PAT-010: Uses claims_start_date and claims_end_date from dbt_project.yml vars\n- Configurable via dbt_project.yml vars section\n*/\n\nWITH date_config AS (\n    SELECT\n        DATE('{{ var('claims_start_date') }}') AS start_date,\n        DATE('{{ var('claims_end_date') }}') AS end_date\n),\n\ndx_patients AS (\n    SELECT * FROM {{ ref('std_dx_bc_patients') }}\n),\n\npx_patients AS (\n    SELECT * FROM {{ ref('std_px_bc_patients') }}\n),\n\nrx_patients AS (\n    SELECT * FROM {{ ref('std_rx_bc_patients') }}\n),\n\nconsolidated_pool AS (\n    SELECT\n        COALESCE(dx.PATIENT_ID, px.PATIENT_ID, rx.PATIENT_ID) AS PATIENT_ID,\n\n        -- Identification pathway flags\n        CASE WHEN dx.PATIENT_ID IS NOT NULL THEN 'Y' ELSE 'N' END AS IDENTIFIED_VIA_DX,\n        CASE WHEN px.PATIENT_ID IS NOT NULL THEN 'Y' ELSE 'N' END AS IDENTIFIED_VIA_PX,\n        CASE WHEN rx.PATIENT_ID IS NOT NULL THEN 'Y' ELSE 'N' END AS IDENTIFIED_VIA_RX,\n\n        -- Pathway count and concatenated list\n        (CASE WHEN dx.PATIENT_ID IS NOT NULL THEN 1 ELSE 0 END +\n         CASE WHEN px.PATIENT_ID IS NOT NULL THEN 1 ELSE 0 END +\n         CASE WHEN rx.PATIENT_ID IS NOT NULL THEN 1 ELSE 0 END) AS IDENTIFICATION_PATHWAY_COUNT,\n\n        CONCAT_WS(', ',\n            CASE WHEN dx.PATIENT_ID IS NOT NULL THEN 'DX' END,\n            CASE WHEN px.PATIENT_ID IS NOT NULL THEN 'PX' END,\n            CASE WHEN rx.PATIENT_ID IS NOT NULL THEN 'RX' END\n        ) AS IDENTIFICATION_PATHWAYS,\n\n        -- Earliest BC event date across all pathways\n        LEAST(\n            COALESCE(dx.EARLIEST_DX_DATE, '9999-12-31'),\n            COALESCE(px.EARLIEST_PX_DATE, '9999-12-31'),\n            COALESCE(rx.EARLIEST_RX_DATE, '9999-12-31')\n        ) AS EARLIEST_BC_EVENT_DATE,\n\n        -- Latest BC event date across all pathways\n        GREATEST(\n            COALESCE(dx.LATEST_DX_DATE, '1900-01-01'),\n            COALESCE(px.LATEST_PX_DATE, '1900-01-01'),\n            COALESCE(rx.LATEST_RX_DATE, '1900-01-01')\n        ) AS LATEST_BC_EVENT_DATE,\n\n        -- DX pathway details\n        dx.EARLIEST_DX_DATE,\n        dx.LATEST_DX_DATE,\n        dx.UNIQUE_DX_CODE_COUNT,\n        dx.DX_CLAIM_COUNT,\n        dx.DX_TREATMENT_CATEGORIES,\n\n        -- PX pathway details\n        px.EARLIEST_PX_DATE,\n        px.LATEST_PX_DATE,\n        px.UNIQUE_PX_CODE_COUNT,\n        px.PX_CLAIM_COUNT,\n        px.PX_TREATMENT_CATEGORIES,\n\n        -- RX pathway details\n        rx.EARLIEST_RX_DATE,\n        rx.LATEST_RX_DATE,\n        rx.UNIQUE_NDC_COUNT,\n        rx.RX_CLAIM_COUNT,\n        rx.RX_TREATMENT_CATEGORIES,\n        rx.RX_MATCH_METHODS,\n\n        -- Patient demographics (coalesce across pathways)\n        COALESCE(dx.PATIENT_GENDER, px.PATIENT_GENDER, rx.PATIENT_GENDER) AS PATIENT_GENDER,\n        COALESCE(dx.PATIENT_BIRTH_YEAR, px.PATIENT_BIRTH_YEAR, rx.PATIENT_BIRTH_YEAR) AS PATIENT_BIRTH_YEAR,\n        COALESCE(dx.PATIENT_ZIP3, px.PATIENT_ZIP3, rx.PATIENT_ZIP3) AS PATIENT_ZIP3,\n\n        -- Total activity metrics\n        COALESCE(dx.DX_CLAIM_COUNT, 0) + COALESCE(px.PX_CLAIM_COUNT, 0) + COALESCE(rx.RX_CLAIM_COUNT, 0) AS TOTAL_BC_CLAIM_COUNT\n\n    FROM dx_patients dx\n    FULL OUTER JOIN px_patients px\n        ON dx.PATIENT_ID = px.PATIENT_ID\n    FULL OUTER JOIN rx_patients rx\n        ON COALESCE(dx.PATIENT_ID, px.PATIENT_ID) = rx.PATIENT_ID\n)\n\n-- Apply inclusion criteria:\n-- PAT-010: latest_bc_event_date within configured date range (from config_claims_date_range seed)\n-- PAT-011: Must have BC diagnosis (DX claims)\n-- PAT-012: Must have treatment (PX or RX claims)\nSELECT cp.*\nFROM consolidated_pool cp\nCROSS JOIN date_config dc\nWHERE cp.LATEST_BC_EVENT_DATE >= dc.start_date\n  AND cp.LATEST_BC_EVENT_DATE <= dc.end_date\n  AND COALESCE(cp.DX_CLAIM_COUNT, 0) > 0\n  AND (COALESCE(cp.PX_CLAIM_COUNT, 0) > 0 OR COALESCE(cp.RX_CLAIM_COUNT, 0) > 0)", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dx_bc_patients", "package": null, "version": null}, {"name": "std_px_bc_patients", "package": null, "version": null}, {"name": "std_rx_bc_patients", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.std_dx_bc_patients", "model.CGOncology_MDM.std_px_bc_patients", "model.CGOncology_MDM.std_rx_bc_patients"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["PATIENT_ID"], "time_spine": null}, "model.CGOncology_MDM.match_ddd_dhc": {"database": "CGONCOLOGY_TEST", "schema": "STAGING", "name": "match_ddd_dhc", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "staging/match_ddd_dhc.sql", "original_file_path": "models/staging/match_ddd_dhc.sql", "unique_id": "model.CGOncology_MDM.match_ddd_dhc", "fqn": ["CGOncology_MDM", "staging", "match_ddd_dhc"], "alias": "match_ddd_dhc", "checksum": {"name": "sha256", "checksum": "8356962be43f943eda97559d61345cd5e95e9506446b45295dbcf1c390e953fc"}, "config": {"enabled": true, "alias": null, "schema": "STAGING", "database": null, "tags": ["layer_2_staging", "customer_backbone", "customer_backbone", "staging", "matching"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_2_staging", "customer_backbone", "staging", "matching"], "description": "DDD outlet to DHC organization matching using 4-step fuzzy matching.\nBusiness Rules: MAT-001 to MAT-080\nSteps: Practice Location \u2192 HQ Location \u2192 City+State Fallback \u2192 Medscout Bridge\nMatch Buckets: B1 (high), B2 (balanced), B3 (address-dominant), B4 (fallback), B5 (stewardship)\n", "columns": {"DDD_OUTLET_ID": {"name": "DDD_OUTLET_ID", "description": "DDD outlet identifier (primary key)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "DDD_OUTLET_NAME": {"name": "DDD_OUTLET_NAME", "description": "DDD outlet name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "DH_ID": {"name": "DH_ID", "description": "Matched DHC organization ID (NULL if unmatched)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "KMK_HCO_ID": {"name": "KMK_HCO_ID", "description": "Assigned in MDM layer (always NULL here)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "ADDRESS_MATCH_SCORE": {"name": "ADDRESS_MATCH_SCORE", "description": "Jaro-Winkler address similarity score (0-100)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "NAME_MATCH_SCORE": {"name": "NAME_MATCH_SCORE", "description": "Jaro-Winkler name similarity score (0-100)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "MATCH_BUCKET": {"name": "MATCH_BUCKET", "description": "Match confidence bucket (0=Historical, 1-4=Fuzzy match steps)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "MATCH_STEP": {"name": "MATCH_STEP", "description": "Matching step (0=Historical, 1=Practice Location, 2=HQ, 3=City+State, 4=Medscout)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "DHC_MATCH_SOURCE": {"name": "DHC_MATCH_SOURCE", "description": "Source of the match", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "MATCH_STATUS": {"name": "MATCH_STATUS", "description": "Match status (MATCHED or UNMATCHED)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "CONFIDENCE_LEVEL": {"name": "CONFIDENCE_LEVEL", "description": "Match confidence level", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "IS_HISTORICAL_MATCH": {"name": "IS_HISTORICAL_MATCH", "description": "True if match came from historical/stewardship data", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "IS_DELTA": {"name": "IS_DELTA", "description": "True for delta/new records", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/staging/schema.yml", "build_path": null, "unrendered_config": {"schema": "STAGING", "materialized": "table", "tags": ["customer_backbone", "staging", "matching"]}, "created_at": 1770177079.32321, "relation_name": "CGONCOLOGY_TEST.STAGING.match_ddd_dhc", "raw_code": "{{\n    config(\n        schema='STAGING',\n        materialized='table',\n        tags=['customer_backbone', 'staging', 'matching']\n    )\n}}\n\n/*\nPROC-MAT-001: match_ddd_dhc - DDD to DHC HCO Matching\nSource: std_ddd_hco, std_dh_hco, std_dh_practice_location_hist, PRELAND_MEDSCOUT_HCO_DATA\nBusiness Rules: MAT-001 to MAT-080, MAT-011, MAT-012, MAT-013, MAT-014, SCD-023\n\nMatching Logic:\n- MAT-001: Each DDD outlet matched to best DHC organization\n- MAT-005: Exclude ZIP-level outlets (is_zip_excluded flag)\n- MAT-006: Exclude supply chain outlets (is_supply_chain_excluded flag)\n         S5=mail service, W8=supply warehouse, A5=Kaiser warehouse\n         A8 hospital purchasing agents KEPT (can match to hospitals)\n- MAT-012: HISTORY-FIRST matching (Jan 3, 2026):\n    Step 0: Check historical matches FIRST (TEST XREF > DH Return > DEV Legacy)\n    Steps 1-4: Fuzzy matching ONLY for outlets WITHOUT historical match\n    Rationale: Historical matches are stewardship-verified, prevents false positives\n- MAT-013: Practice Location ID assignment for B0 historical matches:\n    - Look up KMK_PL_ID from std_dh_practice_location_hist using dh_id (inherited from parent org)\n    - Pick best practice location by address similarity\n    - Fixes DEV design flaw (missing KMK_PL_ID in XREF)\n- MAT-014: KMK_PL_ID Preservation (Jan 4, 2026):\n    - Check TEST XREF History FIRST for preserved KMK_PL_ID\n    - If found, use preserved KMK_PL_ID (maintains stability)\n    - If not found, fall back to address-based lookup (MAT-013)\n    - Introduces KMK_ACCOUNT_ID concept (union of KMK_HCO_ID and KMK_PL_ID)\n- MAT-010: 4-step fuzzy matching (for new outlets only):\n    Step 1: Practice Location (ZIP exact, addr+name fuzzy)\n    Step 2: HQ Location (ZIP exact, addr+name fuzzy)\n    Step 3: DH City+State fallback (ZIP relaxed, name >= 90)\n    Step 4: Medscout Bridge (city+state exact, standardized name >= 90)\n- MAT-011: CLASS_OF_TRADE tie-breaking (for fuzzy matches only):\n    - CLINICS prefer Practice Location (physician offices, oncology clinics)\n    - HOSPITALS prefer HQ Location (avoids matching to unrelated physician groups)\n    - Uses config_ddd_sub_category seed for class assignment\n- MAT-020: Fuzzy matching using JAROWINKLER_SIMILARITY:\n    - STD-006: Normalized cities via ZIP_CITY_STATE_CONFIG\n    - STD-023: Normalized org names via config_name_aliases seed\n              CTR\u2192CENTER, HOSP\u2192HOSPITAL, MED\u2192MEDICAL, etc.\n- MAT-020: Match Buckets:\n    B0: Historical match (DH Return + DEV Legacy) - HIGHEST PRIORITY\n    B1: addr>=80 AND name>=90 (high confidence)\n    B2: addr>=90 AND name>=70 (balanced)\n    B3: addr>=95 AND name BETWEEN 50 AND 70 (address-dominant)\n    B4: City+State or Medscout fallback (name >= 90)\n- MAT-030: Tie-breaking by bucket, class_priority, step, combined score\n- MAT-080: Confidence level assignment\n\nNote: City normalization uses ZIP_CITY_STATE_CONFIG to handle\ncases like \"CANOGA PARK\" vs \"WEST HILLS\" for same ZIP.\n\nNote: Name normalization uses config_name_aliases seed to expand abbreviations\nfor better fuzzy matching: MED CT\u2192MEDICAL CENTER, HOSP\u2192HOSPITAL, etc.\n\nDec 2025: Removed old B4 (combined-score) - analysis showed false positives.\nAdded B5 fallback from DH Matching Return file (stewardship verified).\nAdded MAT-006 supply chain exclusion using config_ddd_sub_category_exclusions seed.\nAdded STD-023 name normalization for better fuzzy matching.\n\nDec 30, 2025: Added Step 3 (DH City+State) and Step 4 (Medscout Bridge)\nfor outlets with ZIP mismatches (4 NEW matches from DH, 6 validated by Medscout).\nMedscout name standardization via macro to avoid false positives.\n\nJan 3, 2026: Added MAT-011 CLASS_OF_TRADE tie-breaking to fix 22 false positives.\nRenamed source from stg_ddd_hco to std_ddd_hco for naming consistency.\nHOSPITALS prefer HQ Location, CLINICS prefer Practice Location.\n*/\n\nWITH ddd_source AS (\n    SELECT\n        ddd_outlet_id,\n        ddd_outlet_name,\n        normalized_org_name AS ddd_normalized_name,  -- STD-023: Expanded abbreviations\n        address_line_1 AS ddd_address,\n        city AS ddd_city,  -- STD-006: Already normalized via ZIP lookup\n        state AS ddd_state,\n        zip_code AS ddd_zip,\n        class_of_trade  -- MAT-011: For match tie-breaking\n    FROM {{ ref('std_ddd_hco') }}  -- Renamed from stg_ddd_hco\n    WHERE is_zip_excluded = FALSE\n      AND is_supply_chain_excluded = FALSE  -- MAT-006: Exclude S5, W8, A5\n),\n\n-- B0: Historical matches (MAT-012: HISTORY-FIRST - highest priority)\n-- Priority: TEST XREF History (has KMK_PL_ID) > DH Return > DEV Legacy\n-- Updated 2026-01-04: TEST XREF History is now Source 0 (preserves KMK_PL_ID assignments)\n-- MAT-211 FIX: Validate historical DH_IDs still exist in current std_dh_hco (prevent stale matches)\nstewardship_matches AS (\n    -- Source 0: XREF History (highest priority - has KMK_PL_ID preserved)\n    -- Once an outlet has KMK_PL_ID assigned, it's preserved through this lookup\n    -- MAT-211: Only use historical match if DH_ID still exists in current DHC feed\n    -- FIXED 2026-01-12: Use SOURCE_ID instead of DDD_OUTLET_NO (new schema)\n    -- NOTE: Uses {{ target.database }} (not ref()) to break circular dependency\n    SELECT\n        CAST(h.SOURCE_ID AS VARCHAR(50)) AS ddd_outlet_id,\n        CAST(h.DH_ID AS VARCHAR(50)) AS dh_id,\n        CASE WHEN LEFT(h.KMK_HCO_ID, 1) = '4' THEN h.KMK_HCO_ID ELSE NULL END AS preserved_kmk_pl_id,  -- MAT-014: KMK_HCO_ID prefix '4' = PL-mapped outlet\n        NULL AS preserved_kmk_account_id,  -- MAT-014: Not in current history schema\n        0 AS match_bucket,  -- B0: Highest priority (history-first)\n        'XREF History' AS dhc_match_source,\n        TRUE AS is_historical_match,\n        100 AS address_match_score,\n        100 AS name_match_score,\n        100 AS combined_score,\n        0 AS match_step,  -- Step 0: Historical\n        0 AS stewardship_priority  -- Highest priority (preserves existing assignments)\n    FROM {{ target.database }}.MDM.MDM_CUSTOMER_XREF_HCO_HIST h\n    -- MAT-211: Validate DH_ID exists in current DHC source (excludes removed organizations)\n    INNER JOIN {{ ref('std_dh_hco') }} dhc ON CAST(h.DH_ID AS VARCHAR) = dhc.dh_id\n    WHERE h.SOURCE_CODE = 'DDD'\n      AND h.SOURCE_ID IS NOT NULL\n      AND h.DH_ID IS NOT NULL\n      AND h.IS_CURRENT = 'Y'\n\n    UNION ALL\n\n    -- Source 1: DH Return file (stewardship-verified Oct 2024)\n    -- MAT-211: Only use if DH_ID still exists in current DHC feed\n    SELECT\n        LPAD(CAST(r.ID AS VARCHAR), 8, '0') AS ddd_outlet_id,\n        CAST(r.HOSPITAL_ID AS VARCHAR(50)) AS dh_id,\n        NULL AS preserved_kmk_pl_id,  -- Will look up via address matching\n        NULL AS preserved_kmk_account_id,\n        0 AS match_bucket,  -- B0: Highest priority (history-first)\n        'DH Matching Return' AS dhc_match_source,\n        TRUE AS is_historical_match,\n        100 AS address_match_score,\n        100 AS name_match_score,\n        100 AS combined_score,\n        0 AS match_step,  -- Step 0: Historical\n        1 AS stewardship_priority  -- Higher priority (more recent)\n    FROM {{ source('raw_dh', 'PRELAND_CG_ONCOLOGY_FULL_MATCHING_RETURN_20241025') }} r\n    -- MAT-211: Validate DH_ID exists in current DHC source\n    INNER JOIN {{ ref('std_dh_hco') }} dhc ON CAST(r.HOSPITAL_ID AS VARCHAR) = dhc.dh_id\n    WHERE r.HOSPITAL_ID IS NOT NULL\n\n    UNION ALL\n\n    -- Source 2: Legacy history (historical stewardship from production)\n    -- MAT-211: Only use if DH_ID still exists in current DHC feed\n    -- Note: Legacy schema uses DDD_OUTLET_NO column (old format)\n    -- NOTE: Uses {{ target.database }} (not ref()) to break circular dependency\n    SELECT\n        CAST(d.DDD_OUTLET_NO AS VARCHAR(50)) AS ddd_outlet_id,\n        CAST(d.DH_ID AS VARCHAR(50)) AS dh_id,\n        NULL AS preserved_kmk_pl_id,  -- Legacy doesn't have KMK_PL_ID\n        NULL AS preserved_kmk_account_id,\n        0 AS match_bucket,  -- B0: Highest priority (history-first)\n        'Legacy History' AS dhc_match_source,\n        TRUE AS is_historical_match,\n        100 AS address_match_score,\n        100 AS name_match_score,\n        100 AS combined_score,\n        0 AS match_step,  -- Step 0: Historical\n        2 AS stewardship_priority  -- Lower priority\n    FROM {{ target.database }}.MDM.CUSTOMER_XREF_HCO_HIST d\n    -- MAT-211: Validate DH_ID exists in current DHC source\n    INNER JOIN {{ ref('std_dh_hco') }} dhc ON CAST(d.DH_ID AS VARCHAR) = dhc.dh_id\n    WHERE d.SOURCE = 'DDD'\n      AND d.DDD_OUTLET_NO IS NOT NULL\n      AND d.DH_ID IS NOT NULL\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY d.DDD_OUTLET_NO ORDER BY d.LOAD_DATE DESC) = 1\n),\n\n-- Dedupe stewardship matches (prefer XREF History > DH Return > Legacy History)\nstewardship_deduped_raw AS (\n    SELECT\n        ddd_outlet_id,\n        dh_id,\n        preserved_kmk_pl_id,  -- MAT-014: From TEST XREF History (NULL for other sources)\n        preserved_kmk_account_id,  -- MAT-014: Unified account ID\n        match_bucket,\n        dhc_match_source,\n        is_historical_match,\n        address_match_score,\n        name_match_score,\n        combined_score,\n        match_step\n    FROM stewardship_matches\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY ddd_outlet_id ORDER BY stewardship_priority ASC) = 1\n),\n\n-- Look up KMK_PL_ID for B0 historical matches (MAT-013, MAT-014: Practice Location ID assignment)\n-- MAT-014: HISTORY-FIRST for KMK_PL_ID - prefer preserved ID over address-based lookup\n-- Only do address-based lookup when preserved_kmk_pl_id is NULL (DH Return or DEV Legacy sources)\nstewardship_with_pl AS (\n    SELECT\n        s.ddd_outlet_id,\n        s.dh_id,\n        s.preserved_kmk_pl_id,  -- MAT-014: Already assigned from TEST XREF History\n        s.preserved_kmk_account_id,  -- MAT-014: Unified account ID\n        s.match_bucket,\n        s.dhc_match_source,\n        s.is_historical_match,\n        s.address_match_score,\n        s.name_match_score,\n        s.combined_score,\n        s.match_step,\n        pl.kmk_pl_id AS lookup_kmk_pl_id,  -- From address-based lookup\n        -- Calculate address similarity to pick best practice location (only used when preserved is NULL)\n        JAROWINKLER_SIMILARITY(\n            CONCAT(d.ddd_address, ' ', d.ddd_city, ' ', d.ddd_state, ' ', d.ddd_zip),\n            CONCAT(pl.address_line_1, ' ', pl.city, ' ', pl.state, ' ', pl.zip_code)\n        ) AS pl_address_score\n    FROM stewardship_deduped_raw s\n    LEFT JOIN ddd_source d ON s.ddd_outlet_id = d.ddd_outlet_id\n    -- Only join to PL history if we don't have a preserved KMK_PL_ID\n    LEFT JOIN {{ ref('std_dh_practice_location_hist') }} pl\n        ON s.dh_id = pl.dh_id\n        AND pl.is_current = 'Y'\n        AND s.preserved_kmk_pl_id IS NULL  -- MAT-014: Only look up if not already preserved\n),\n\n-- Pick best practice location per outlet\n-- MAT-014: Use preserved KMK_PL_ID if available, otherwise pick best by address score\nstewardship_deduped AS (\n    SELECT\n        ddd_outlet_id,\n        dh_id,\n        match_bucket,\n        dhc_match_source,\n        is_historical_match,\n        address_match_score,\n        name_match_score,\n        combined_score,\n        match_step,\n        -- MAT-014: COALESCE - prefer preserved over lookup\n        COALESCE(preserved_kmk_pl_id, lookup_kmk_pl_id) AS matched_kmk_pl_id,\n        preserved_kmk_account_id  -- Pass through for downstream use\n    FROM stewardship_with_pl\n    QUALIFY ROW_NUMBER() OVER (\n        PARTITION BY ddd_outlet_id\n        ORDER BY\n            CASE WHEN preserved_kmk_pl_id IS NOT NULL THEN 0 ELSE 1 END,  -- Prefer preserved\n            pl_address_score DESC NULLS LAST,\n            lookup_kmk_pl_id\n    ) = 1\n),\n\n-- Outlets with historical matches (for exclusion from fuzzy matching)\n-- MAT-012: History-first - these outlets skip Steps 1-4\noutlets_with_history AS (\n    SELECT DISTINCT ddd_outlet_id\n    FROM stewardship_deduped\n),\n\n-- Step 1: Match against Practice Locations (L4)\n-- SCD-023: Uses std_dh_practice_location_hist with is_current='Y'\n-- MAT-012: Only for outlets WITHOUT historical match\npractice_location_matches AS (\n    SELECT\n        d.ddd_outlet_id,\n        d.ddd_outlet_name,\n        d.class_of_trade,  -- MAT-011: For tie-breaking\n        h.dh_id,  -- Link to L3 parent org (inherited from parent)\n        h.kmk_pl_id AS matched_kmk_pl_id,  -- Track which practice location matched\n        -- STD-006: City already normalized via ZIP lookup\n        JAROWINKLER_SIMILARITY(\n            CONCAT(d.ddd_address, ' ', d.ddd_city, ' ', d.ddd_state, ' ', d.ddd_zip),\n            CONCAT(h.address_line_1, ' ', h.city, ' ', h.state, ' ', h.zip_code)\n        ) AS address_match_score,\n        -- Use normalized names for better matching (STD-023)\n        -- CTR\u2192CENTER, HOSP\u2192HOSPITAL, MED\u2192MEDICAL, etc.\n        JAROWINKLER_SIMILARITY(d.ddd_normalized_name, h.normalized_org_name) AS name_match_score,\n        1 AS match_step,\n        'Practice Location' AS dhc_match_source\n    FROM ddd_source d\n    CROSS JOIN {{ ref('std_dh_practice_location_hist') }} h\n    WHERE h.is_current = 'Y'  -- SCD-023: Only current practice locations\n      AND d.ddd_state = h.state  -- Pre-filter by state for performance\n      AND d.ddd_zip = h.zip_code  -- Pre-filter by ZIP for performance\n      AND d.ddd_outlet_id NOT IN (SELECT ddd_outlet_id FROM outlets_with_history)  -- MAT-012: Skip if historical\n),\n\n-- Step 2: Match against HQ Locations (L3 organizations)\n-- MAT-012: Only for outlets WITHOUT historical match\nhq_matches AS (\n    SELECT\n        d.ddd_outlet_id,\n        d.ddd_outlet_name,\n        d.class_of_trade,  -- MAT-011: For tie-breaking\n        h.dh_id,\n        NULL AS matched_kmk_pl_id,  -- No practice location for HQ matches\n        -- STD-006: City already normalized via ZIP lookup\n        JAROWINKLER_SIMILARITY(\n            CONCAT(d.ddd_address, ' ', d.ddd_city, ' ', d.ddd_state, ' ', d.ddd_zip),\n            CONCAT(h.hq_address_line_1, ' ', h.hq_city, ' ', h.hq_state, ' ', h.hq_zip_code)\n        ) AS address_match_score,\n        -- Use normalized names for better matching (STD-023)\n        -- CTR\u2192CENTER, HOSP\u2192HOSPITAL, MED\u2192MEDICAL, etc.\n        JAROWINKLER_SIMILARITY(d.ddd_normalized_name, h.normalized_org_name) AS name_match_score,\n        2 AS match_step,\n        'HQ Location' AS dhc_match_source\n    FROM ddd_source d\n    CROSS JOIN {{ ref('std_dh_hco') }} h\n    WHERE d.ddd_state = h.hq_state  -- Pre-filter by state\n      AND d.ddd_zip = h.hq_zip_code  -- Pre-filter by ZIP\n      AND d.ddd_outlet_id NOT IN (SELECT ddd_outlet_id FROM outlets_with_history)  -- MAT-012: Skip if historical\n),\n\n-- Step 3: Match against HQ Locations by CITY+STATE (relaxed ZIP)\n-- For outlets that don't have a DH org in their exact ZIP\n-- Dec 30, 2025: Added to capture 4 NEW matches (CPMC, SUNY Stony Brook, UW Health)\n-- MAT-012: Only for outlets WITHOUT historical match\ncity_state_matches AS (\n    SELECT\n        d.ddd_outlet_id,\n        d.ddd_outlet_name,\n        d.class_of_trade,  -- MAT-011: For tie-breaking\n        h.dh_id,\n        NULL AS matched_kmk_pl_id,  -- No practice location for City+State matches\n        -- Address score still calculated for ranking (STD-006: city already normalized)\n        JAROWINKLER_SIMILARITY(\n            CONCAT(d.ddd_address, ' ', d.ddd_city, ' ', d.ddd_state, ' ', d.ddd_zip),\n            CONCAT(h.hq_address_line_1, ' ', h.hq_city, ' ', h.hq_state, ' ', h.hq_zip_code)\n        ) AS address_match_score,\n        -- Use normalized names for matching (STD-023)\n        JAROWINKLER_SIMILARITY(d.ddd_normalized_name, h.normalized_org_name) AS name_match_score,\n        3 AS match_step,  -- Step 3: City+State fallback\n        'City+State Fallback' AS dhc_match_source\n    FROM ddd_source d\n    CROSS JOIN {{ ref('std_dh_hco') }} h\n    WHERE d.ddd_city = h.hq_city  -- STD-006: City exact match (already normalized)\n      AND d.ddd_state = h.hq_state           -- State exact match\n      -- Note: NO ZIP filter - that's the point of this fallback\n      AND JAROWINKLER_SIMILARITY(d.ddd_normalized_name, h.normalized_org_name) >= 90  -- High name threshold\n      AND d.ddd_outlet_id NOT IN (SELECT ddd_outlet_id FROM outlets_with_history)  -- MAT-012: Skip if historical\n),\n\n-- Step 4: Medscout Bridge matching (city+state exact, name-only)\n-- Links DDD \u2192 Medscout (name similarity) \u2192 DH (NPI linkage)\n-- Uses standardize_org_name macro for consistent name normalization\n-- Dec 30, 2025: Added to validate 6 stewardship matches\n-- MAT-012: Only for outlets WITHOUT historical match\nmedscout_bridge_matches AS (\n    SELECT\n        d.ddd_outlet_id,\n        d.ddd_outlet_name,\n        d.class_of_trade,  -- MAT-011: For tie-breaking\n        h.dh_id,\n        NULL AS matched_kmk_pl_id,  -- No practice location for Medscout matches\n        -- No address score (Medscout lacks address data) - use 0 for bucket logic\n        0 AS address_match_score,\n        -- Use standardize_org_name macro for Medscout name\n        JAROWINKLER_SIMILARITY(\n            d.ddd_normalized_name,\n            {{ standardize_org_name('m.NAME') }}\n        ) AS name_match_score,\n        4 AS match_step,  -- Step 4: Medscout bridge\n        'Medscout Bridge' AS dhc_match_source\n    FROM ddd_source d\n    JOIN {{ source('raw_medscout', 'PRELAND_MEDSCOUT_HCO_DATA') }} m\n        ON d.ddd_city = UPPER(TRIM(m.CITY))   -- City exact match\n        AND d.ddd_state = UPPER(TRIM(m.STATE))           -- State exact match\n    JOIN {{ ref('std_dh_hco') }} h\n        ON CAST(m.NPI AS VARCHAR) = h.npi         -- NPI linkage to DH\n    WHERE JAROWINKLER_SIMILARITY(\n            d.ddd_normalized_name,\n            {{ standardize_org_name('m.NAME') }}\n          ) >= 90  -- High name threshold\n      AND d.ddd_outlet_id NOT IN (SELECT ddd_outlet_id FROM outlets_with_history)  -- MAT-012: Skip if historical\n),\n\n-- Combine all matches from Steps 1-4\n-- Note: Steps 3-4 only include outlets that DON'T have a QUALIFYING match (B1-B3) in Steps 1-2\n-- Previously excluded outlets with ANY match, causing false negatives when Step 1-2 matches didn't qualify\nall_matches AS (\n    -- Step 1: Practice Location (ZIP exact)\n    SELECT ddd_outlet_id, ddd_outlet_name, class_of_trade, dh_id, matched_kmk_pl_id, address_match_score, name_match_score, match_step, dhc_match_source\n    FROM practice_location_matches\n\n    UNION ALL\n\n    -- Step 2: HQ Location (ZIP exact)\n    SELECT ddd_outlet_id, ddd_outlet_name, class_of_trade, dh_id, matched_kmk_pl_id, address_match_score, name_match_score, match_step, dhc_match_source\n    FROM hq_matches\n\n    UNION ALL\n\n    -- Step 3: DH City+State fallback (only for outlets without HIGH-QUALITY matches in Steps 1-2)\n    -- Fixed Jan 3, 2026: B3 requires name >= 50 to block Step 3 (prevents false positive B3 from blocking good Step 3 matches)\n    SELECT ddd_outlet_id, ddd_outlet_name, class_of_trade, dh_id, matched_kmk_pl_id, address_match_score, name_match_score, match_step, dhc_match_source\n    FROM city_state_matches\n    WHERE ddd_outlet_id NOT IN (\n        -- Outlets with qualifying B1-B4 matches from Practice Location\n        SELECT DISTINCT ddd_outlet_id FROM practice_location_matches\n        WHERE (address_match_score >= 80 AND name_match_score >= 90)   -- B1\n           OR (address_match_score >= 90 AND name_match_score >= 70)   -- B2\n           OR (address_match_score >= 95 AND name_match_score BETWEEN 50 AND 70)  -- B3 (name >= 50 required)\n           OR (UPPER(ddd_outlet_name) LIKE '%MULTIPLE DOCTOR%' AND address_match_score >= 90)  -- B4\n        UNION\n        -- Outlets with qualifying B1-B4 matches from HQ Location\n        SELECT DISTINCT ddd_outlet_id FROM hq_matches\n        WHERE (address_match_score >= 80 AND name_match_score >= 90)   -- B1\n           OR (address_match_score >= 90 AND name_match_score >= 70)   -- B2\n           OR (address_match_score >= 95 AND name_match_score BETWEEN 50 AND 70)  -- B3 (name >= 50 required)\n           OR (UPPER(ddd_outlet_name) LIKE '%MULTIPLE DOCTOR%' AND address_match_score >= 90)  -- B4\n    )\n\n    UNION ALL\n\n    -- Step 4: Medscout Bridge (only for outlets without HIGH-QUALITY matches in Steps 1-3)\n    -- Fixed Jan 3, 2026: B3 requires name >= 50 to block Step 4\n    SELECT ddd_outlet_id, ddd_outlet_name, class_of_trade, dh_id, matched_kmk_pl_id, address_match_score, name_match_score, match_step, dhc_match_source\n    FROM medscout_bridge_matches\n    WHERE ddd_outlet_id NOT IN (\n        -- Outlets with qualifying B1-B4 matches from Practice Location\n        SELECT DISTINCT ddd_outlet_id FROM practice_location_matches\n        WHERE (address_match_score >= 80 AND name_match_score >= 90)   -- B1\n           OR (address_match_score >= 90 AND name_match_score >= 70)   -- B2\n           OR (address_match_score >= 95 AND name_match_score BETWEEN 50 AND 70)  -- B3 (name >= 50 required)\n           OR (UPPER(ddd_outlet_name) LIKE '%MULTIPLE DOCTOR%' AND address_match_score >= 90)  -- B4\n        UNION\n        -- Outlets with qualifying B1-B4 matches from HQ Location\n        SELECT DISTINCT ddd_outlet_id FROM hq_matches\n        WHERE (address_match_score >= 80 AND name_match_score >= 90)   -- B1\n           OR (address_match_score >= 90 AND name_match_score >= 70)   -- B2\n           OR (address_match_score >= 95 AND name_match_score BETWEEN 50 AND 70)  -- B3 (name >= 50 required)\n           OR (UPPER(ddd_outlet_name) LIKE '%MULTIPLE DOCTOR%' AND address_match_score >= 90)  -- B4\n        UNION\n        -- Outlets with qualifying Step 3 matches\n        SELECT DISTINCT ddd_outlet_id FROM city_state_matches\n        WHERE name_match_score >= 90  -- Step 3 threshold\n    )\n),\n\n-- Apply match bucket logic and rank\nscored_matches AS (\n    SELECT\n        ddd_outlet_id,\n        ddd_outlet_name,\n        class_of_trade,  -- MAT-011: For tie-breaking\n        dh_id,\n        matched_kmk_pl_id,\n        address_match_score,\n        name_match_score,\n        match_step,\n        dhc_match_source,\n\n        -- Match bucket assignment (MAT-020)\n        -- B1-B3: Standard fuzzy matching buckets (Steps 1-2)\n        -- B4: Fallback matching (Step 3 City+State, Step 4 Medscout, generic names)\n        -- Old B4 (combined-score >= 160) removed - analysis showed false positives\n        -- Fixed Jan 3, 2026: B3 requires name >= 50 to prevent false positives with very low name scores\n        CASE\n            WHEN address_match_score >= 80 AND name_match_score >= 90 THEN 1  -- B1: High confidence\n            WHEN address_match_score >= 90 AND name_match_score >= 70 THEN 2  -- B2: Balanced\n            WHEN address_match_score >= 95 AND name_match_score BETWEEN 50 AND 70 THEN 3  -- B3: Address-dominant (min name 50)\n            -- B4: Address-only matching for generic names (MULTIPLE DOCTORS, etc.)\n            WHEN UPPER(ddd_outlet_name) LIKE '%MULTIPLE DOCTOR%'\n                 AND address_match_score >= 90 THEN 4  -- B4: Address-only (generic name)\n            -- B4: City+State fallback (Step 3) - name-based matching\n            WHEN match_step = 3 AND name_match_score >= 90 THEN 4  -- B4: City+State (high name)\n            -- B4: Medscout bridge (Step 4) - name-based matching\n            WHEN match_step = 4 AND name_match_score >= 90 THEN 4  -- B4: Medscout (high name)\n            ELSE NULL  -- No bucket = no match (no fuzzy match found)\n        END AS match_bucket,\n\n        -- Combined score for ranking\n        (address_match_score + name_match_score) / 2 AS combined_score,\n\n        -- Flag for historical match\n        FALSE AS is_historical_match\n    FROM all_matches\n),\n\n-- Keep only matches that qualify for a bucket (B1-B4)\nqualified_matches AS (\n    SELECT *\n    FROM scored_matches\n    WHERE match_bucket IS NOT NULL\n),\n\n-- MAT-012: HISTORY-FIRST - Combine B0 historical matches with B1-B4 fuzzy matches\n-- Historical matches (B0) always take priority via bucket ordering\n-- MAT-014: Include preserved_kmk_account_id for KMK_ACCOUNT_ID tracking\nall_qualified_matches AS (\n    -- B0: Historical matches FIRST (highest priority)\n    -- MAT-013: Includes practice location ID lookup\n    -- MAT-014: Includes preserved KMK_ACCOUNT_ID from TEST XREF History\n    -- Note: class_of_trade must be joined from ddd_source\n    SELECT\n        s.ddd_outlet_id,\n        d.class_of_trade,  -- MAT-011: Get from ddd_source\n        s.dh_id,\n        s.matched_kmk_pl_id,  -- MAT-013: Practice location from address matching or preserved\n        s.preserved_kmk_account_id,  -- MAT-014: Unified account ID (if from TEST XREF History)\n        s.address_match_score,\n        s.name_match_score,\n        s.match_bucket,  -- B0\n        s.match_step,    -- Step 0\n        s.dhc_match_source,\n        s.combined_score,\n        s.is_historical_match  -- TRUE\n    FROM stewardship_deduped s\n    LEFT JOIN ddd_source d ON s.ddd_outlet_id = d.ddd_outlet_id\n\n    UNION ALL\n\n    -- B1-B4: Fuzzy matches for NEW outlets only (no historical match)\n    SELECT\n        ddd_outlet_id,\n        class_of_trade,  -- MAT-011: For tie-breaking\n        dh_id,\n        matched_kmk_pl_id,\n        NULL AS preserved_kmk_account_id,  -- MAT-014: New matches don't have preserved account ID\n        address_match_score,\n        name_match_score,\n        match_bucket,\n        match_step,\n        dhc_match_source,\n        combined_score,\n        is_historical_match\n    FROM qualified_matches\n),\n\n-- Rank matches per DDD outlet (MAT-030)\n-- MAT-011: CLASS_OF_TRADE tie-breaking:\n--   CLINICS prefer Practice Location (match_step=1)\n--   HOSPITALS prefer HQ Location (match_step=2)\nranked_matches AS (\n    SELECT\n        ddd_outlet_id,\n        class_of_trade,\n        dh_id,\n        matched_kmk_pl_id,\n        preserved_kmk_account_id,  -- MAT-014: Pass through for output\n        address_match_score,\n        name_match_score,\n        match_bucket,\n        match_step,\n        dhc_match_source,\n        combined_score,\n        is_historical_match,\n        -- MAT-011: Class-aware priority (applies BEFORE match_step)\n        -- Clinics prefer Practice Location, Hospitals prefer HQ Location\n        CASE\n            WHEN class_of_trade = 'CLINICS' AND dhc_match_source = 'Practice Location' THEN 1\n            WHEN class_of_trade = 'HOSPITALS' AND dhc_match_source = 'HQ Location' THEN 1\n            WHEN class_of_trade = 'CLINICS' AND dhc_match_source = 'HQ Location' THEN 2\n            WHEN class_of_trade = 'HOSPITALS' AND dhc_match_source = 'Practice Location' THEN 2\n            ELSE 2  -- Neutral for other classes (CHAIN, NURSING HOME, etc.)\n        END AS class_priority,\n        ROW_NUMBER() OVER (\n            PARTITION BY ddd_outlet_id\n            ORDER BY\n                match_bucket ASC,     -- Lower bucket = higher confidence\n                class_priority ASC,   -- MAT-011: Class-appropriate match source\n                match_step ASC,       -- Then prefer earlier steps\n                combined_score DESC\n        ) AS match_rank\n    FROM all_qualified_matches\n),\n\n-- Get best match per DDD outlet\nbest_matches AS (\n    SELECT *\n    FROM ranked_matches\n    WHERE match_rank = 1\n),\n\n-- Final output: all DDD outlets with their best match (or NULL if unmatched)\n-- MAT-014: Include preserved_kmk_account_id for downstream KMK_ACCOUNT_ID tracking\nfinal_output AS (\n    SELECT\n        d.ddd_outlet_id,\n        d.ddd_outlet_name,  -- MAT-021: Include outlet name for reference\n        d.class_of_trade,   -- MAT-011: For debugging tie-breaking\n        b.dh_id,\n        NULL AS kmk_hco_id,  -- Assigned in MDM layer\n        b.matched_kmk_pl_id,  -- SCD-023/MAT-014: Track which practice location matched\n        b.preserved_kmk_account_id,  -- MAT-014: Unified account ID (if preserved from history)\n        b.address_match_score,\n        b.name_match_score,\n        b.match_bucket,\n        b.match_step,\n        b.dhc_match_source,\n        b.class_priority,    -- MAT-011: For debugging tie-breaking\n        b.match_rank,\n        NULL AS dhc_claims_volume,  -- TBD: add claims tie-breaking\n        TRUE AS is_delta,  -- All records are delta in initial load\n        COALESCE(b.is_historical_match, FALSE) AS is_historical_match,\n        FALSE AS is_steward_override,\n        CASE\n            WHEN b.dh_id IS NOT NULL THEN 'MATCHED'\n            ELSE 'UNMATCHED'\n        END AS match_status,\n        -- Confidence levels: B0=HISTORICAL, B1-B2=HIGH, B3-B4=MEDIUM\n        CASE\n            WHEN b.match_bucket = 0 THEN 'HISTORICAL'  -- B0: TEST XREF + DH Return + DEV Legacy (highest priority)\n            WHEN b.match_bucket IN (1, 2) THEN 'HIGH'\n            WHEN b.match_bucket IN (3, 4) THEN 'MEDIUM'\n            ELSE NULL\n        END AS confidence_level,\n        CURRENT_TIMESTAMP() AS match_date\n    FROM ddd_source d\n    LEFT JOIN best_matches b ON d.ddd_outlet_id = b.ddd_outlet_id\n)\n\nSELECT * FROM final_output", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_ddd_hco", "package": null, "version": null}, {"name": "std_dh_hco", "package": null, "version": null}, {"name": "std_dh_hco", "package": null, "version": null}, {"name": "std_dh_hco", "package": null, "version": null}, {"name": "std_dh_practice_location_hist", "package": null, "version": null}, {"name": "std_dh_practice_location_hist", "package": null, "version": null}, {"name": "std_dh_hco", "package": null, "version": null}, {"name": "std_dh_hco", "package": null, "version": null}, {"name": "std_dh_hco", "package": null, "version": null}], "sources": [["raw_dh", "PRELAND_CG_ONCOLOGY_FULL_MATCHING_RETURN_20241025"], ["raw_medscout", "PRELAND_MEDSCOUT_HCO_DATA"]], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.CGOncology_MDM.standardize_org_name"], "nodes": ["source.CGOncology_MDM.raw_dh.PRELAND_CG_ONCOLOGY_FULL_MATCHING_RETURN_20241025", "source.CGOncology_MDM.raw_medscout.PRELAND_MEDSCOUT_HCO_DATA", "model.CGOncology_MDM.std_ddd_hco", "model.CGOncology_MDM.std_dh_hco", "model.CGOncology_MDM.std_dh_practice_location_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["DDD_OUTLET_ID"], "time_spine": null}, "model.CGOncology_MDM.match_medscout_dhc_hcp": {"database": "CGONCOLOGY_TEST", "schema": "STAGING", "name": "match_medscout_dhc_hcp", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "staging/match_medscout_dhc_hcp.sql", "original_file_path": "models/staging/match_medscout_dhc_hcp.sql", "unique_id": "model.CGOncology_MDM.match_medscout_dhc_hcp", "fqn": ["CGOncology_MDM", "staging", "match_medscout_dhc_hcp"], "alias": "match_medscout_dhc_hcp", "checksum": {"name": "sha256", "checksum": "c8179a32934398efb13093258527bb4cd126dfc0b25e5fdf4be91821b3698032"}, "config": {"enabled": true, "alias": null, "schema": "STAGING", "database": null, "tags": ["layer_2_staging", "customer_backbone", "customer_backbone", "staging", "matching"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_2_staging", "customer_backbone", "staging", "matching"], "description": "Medscout to DHC HCP matching via NPI exact match.\nBusiness Rules: MAT-110 to MAT-125\nSimple NPI-based matching. Unmatched Medscout HCPs get KMK IDs in MDM layer.\n", "columns": {"MEDSCOUT_ID": {"name": "MEDSCOUT_ID", "description": "Medscout provider ID", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "DH_ID": {"name": "DH_ID", "description": "Matched DHC provider ID (NULL if unmatched)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "NPI": {"name": "NPI", "description": "National Provider Identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "KMK_HCP_ID": {"name": "KMK_HCP_ID", "description": "Assigned in MDM layer (always NULL here)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "MATCH_TYPE": {"name": "MATCH_TYPE", "description": "Type of match (NPI_EXACT or NULL)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "MATCH_STATUS": {"name": "MATCH_STATUS", "description": "Match status (MATCHED or UNMATCHED)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "IS_DELTA": {"name": "IS_DELTA", "description": "True for delta/new records", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "IS_HISTORICAL_MATCH": {"name": "IS_HISTORICAL_MATCH", "description": "True if match came from historical data", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "MATCH_DATE": {"name": "MATCH_DATE", "description": "Timestamp of the match", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/staging/schema.yml", "build_path": null, "unrendered_config": {"schema": "STAGING", "materialized": "table", "tags": ["customer_backbone", "staging", "matching"]}, "created_at": 1770177079.323495, "relation_name": "CGONCOLOGY_TEST.STAGING.match_medscout_dhc_hcp", "raw_code": "{{\n    config(\n        schema='STAGING',\n        materialized='table',\n        tags=['customer_backbone', 'staging', 'matching']\n    )\n}}\n\n/*\nPROC-MAT-002: match_medscout_dhc_hcp - Medscout to DHC HCP Matching\nSource: std_medscout_hcp, std_dh_hcp\nBusiness Rules: MAT-110 to MAT-125\n\nMatching Logic:\n- MAT-111: Match on NPI_NUMBER (exact match)\n- MAT-112: NPI is unique identifier - no fuzzy matching needed\n- MAT-113: All matched records get match_type = 'NPI_EXACT'\n- MAT-116: Unmatched remain as Medscout-only in xref\n- MAT-121-125: Survivorship rules (DHC > Medscout) applied in MDM layer\n*/\n\nWITH medscout_source AS (\n    SELECT medscout_id, npi\n    FROM {{ ref('std_medscout_hcp') }}\n    WHERE npi IS NOT NULL\n),\n\ndh_source AS (\n    SELECT npi\n    FROM {{ ref('std_dh_hcp') }}\n    WHERE npi IS NOT NULL\n)\n\nSELECT\n    m.medscout_id,\n    d.npi AS dh_id,\n    m.npi,\n    NULL AS kmk_hcp_id,\n    CASE WHEN d.npi IS NOT NULL THEN 'NPI_EXACT' END AS match_type,\n    CASE WHEN d.npi IS NOT NULL THEN 'MATCHED' ELSE 'UNMATCHED' END AS match_status,\n    TRUE AS is_delta,\n    FALSE AS is_historical_match,\n    CURRENT_TIMESTAMP() AS match_date\nFROM medscout_source m\nLEFT JOIN dh_source d ON m.npi = d.npi", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_medscout_hcp", "package": null, "version": null}, {"name": "std_dh_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.std_medscout_hcp", "model.CGOncology_MDM.std_dh_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["MEDSCOUT_ID"], "time_spine": null}, "model.CGOncology_MDM.adm_sfe_hcp_targets": {"database": "CGONCOLOGY_TEST", "schema": "ADM", "name": "adm_sfe_hcp_targets", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "SFE/adm_sfe_hcp_targets.sql", "original_file_path": "models/SFE/adm_sfe_hcp_targets.sql", "unique_id": "model.CGOncology_MDM.adm_sfe_hcp_targets", "fqn": ["CGOncology_MDM", "SFE", "adm_sfe_hcp_targets"], "alias": "adm_sfe_hcp_targets", "checksum": {"name": "sha256", "checksum": "04f3ae00bf66c8031d671393ae1de1dc19e4111a0a4ef4807be50d11d1bf8be1"}, "config": {"enabled": true, "alias": null, "schema": "ADM", "database": null, "tags": ["sfe", "sfe"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["sfe"], "description": "HCP target master with KAM targets.\nBusiness Rules: TGT-030\n", "columns": {"kmk_hcp_id": {"name": "kmk_hcp_id", "description": "KMK HCP identifier (primary key)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "kam_target_flag": {"name": "kam_target_flag", "description": "KAM target flag (Y/N)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "kam_decile": {"name": "kam_decile", "description": "KAM decile (1-10)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/SFE/schema.yml", "build_path": null, "unrendered_config": {"materialized": "table", "tags": ["sfe"], "enabled": true, "schema": "ADM"}, "created_at": 1770177079.391941, "relation_name": "CGONCOLOGY_TEST.ADM.adm_sfe_hcp_targets", "raw_code": "{{ config(\n    schema='ADM',\n    materialized='table',\n    tags=['sfe']\n) }}\n\n/*\nADM_SFE_HCP_TARGETS - Published HCP Target Master\nSource: stg_sfe_targets, mdm_customer_xref_hcp\n\nPivoted view of all HCP targets for a specific version.\nGrain: One row per KMK_HCP_ID.\n*/\n\nWITH targets AS (\n    SELECT * FROM {{ ref('stg_sfe_targets') }}\n    WHERE entity_type = 'HCP'\n      AND target_version = '{{ var(\"sfe_version\") }}' -- Direct filter\n),\n\n-- Resolve KMK_HCP_ID for each target\nresolved_targets AS (\n    SELECT\n        x.kmk_hcp_id,\n        x.npi,\n        t.target_type,\n        t.decile,\n        t.target_flag,\n        t.target_version\n    FROM targets t\n    INNER JOIN {{ ref('mdm_customer_xref_hcp') }} x \n        ON CAST(t.entity_id AS VARCHAR) = x.npi \n        AND x.source_code = 'DHC'\n),\n\n-- Pivot logic\npivoted AS (\n    SELECT\n        kmk_hcp_id,\n        '{{ var(\"sfe_version\") }}' AS target_version,\n        MAX(npi) AS npi,\n        \n        -- KAM HCP Targets\n        MAX(CASE WHEN target_type = 'HCP_TARGET' AND target_flag = 'Y' THEN 'Y' ELSE 'N' END) AS kam_target_flag,\n        MAX(CASE WHEN target_type = 'HCP_TARGET' THEN decile END) AS kam_decile\n        \n    FROM resolved_targets\n    GROUP BY kmk_hcp_id\n)\n\nSELECT\n    kmk_hcp_id,\n    npi,\n    kam_target_flag,\n    kam_decile,\n    target_version,\n    CURRENT_DATE() AS data_date\nFROM pivoted", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_sfe_targets", "package": null, "version": null}, {"name": "mdm_customer_xref_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.stg_sfe_targets", "model.CGOncology_MDM.mdm_customer_xref_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["kmk_hcp_id"], "time_spine": null}, "model.CGOncology_MDM.adm_sfe_hco_targets": {"database": "CGONCOLOGY_TEST", "schema": "ADM", "name": "adm_sfe_hco_targets", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "SFE/adm_sfe_hco_targets.sql", "original_file_path": "models/SFE/adm_sfe_hco_targets.sql", "unique_id": "model.CGOncology_MDM.adm_sfe_hco_targets", "fqn": ["CGOncology_MDM", "SFE", "adm_sfe_hco_targets"], "alias": "adm_sfe_hco_targets", "checksum": {"name": "sha256", "checksum": "e79c1406ec68bd255fe0ffc41e15d8a3c89ad7821a51928278964bbf3c06c51d"}, "config": {"enabled": true, "alias": null, "schema": "ADM", "database": null, "tags": ["sfe", "sfe"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["sfe"], "description": "HCO target master with KAM Network, KAM Child, HSD, and MSL targets.\nBusiness Rules: TGT-003, TGT-010, TGT-011, TGT-020\n", "columns": {"kmk_hco_id": {"name": "kmk_hco_id", "description": "KMK HCO identifier (primary key)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "kam_network_target_flag": {"name": "kam_network_target_flag", "description": "KAM Network target flag (Y/N)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "kam_child_target_flag": {"name": "kam_child_target_flag", "description": "KAM Child target flag (Y/N)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "hsd_target_flag": {"name": "hsd_target_flag", "description": "HSD target flag (Y/N)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "msl_target_flag": {"name": "msl_target_flag", "description": "MSL target flag (Y/N) - sourced from CG_MSL_Target_list", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/SFE/schema.yml", "build_path": null, "unrendered_config": {"materialized": "table", "tags": ["sfe"], "enabled": true, "schema": "ADM"}, "created_at": 1770177079.391795, "relation_name": "CGONCOLOGY_TEST.ADM.adm_sfe_hco_targets", "raw_code": "{{ config(\n    schema='ADM',\n    materialized='table',\n    tags=['sfe']\n) }}\n\n/*\nADM_SFE_HCO_TARGETS - Published HCO Target & Decile Master\nSource: stg_sfe_targets, mdm_customer_xref_hco, mdm_customer_master_hco\n\nPivoted view of all HCO targets AND deciles for a specific version.\nIncludes ALL accounts with deciles (not just targets) to preserve full decile rankings.\nGrain: One row per KMK_HCO_ID.\n*/\n\nWITH targets AS (\n    SELECT * FROM {{ ref('stg_sfe_targets') }}\n    WHERE entity_type = 'HCO'\n      AND target_version = '{{ var(\"sfe_version\") }}'\n),\n\n-- Resolve KMK_HCO_ID for each record\n-- Some records use KMK_ID (3000...), some use DH_ID\nresolved_targets AS (\n    -- Match 1: Entity ID is already a KMK_HCO_ID\n    SELECT\n        m.kmk_hco_id,\n        t.target_type,\n        t.decile,\n        t.target_flag,\n        t.target_version\n    FROM targets t\n    INNER JOIN {{ ref('mdm_customer_master_hco') }} m\n        ON t.entity_id = m.kmk_hco_id\n\n    UNION\n\n    -- Match 2: Entity ID is a Source ID (DH_ID)\n    SELECT\n        x.kmk_hco_id,\n        t.target_type,\n        t.decile,\n        t.target_flag,\n        t.target_version\n    FROM targets t\n    INNER JOIN {{ ref('mdm_customer_xref_hco') }} x\n        ON t.entity_id = x.source_id\n        AND x.source_code = 'DHC'\n    WHERE NOT EXISTS (SELECT 1 FROM {{ ref('mdm_customer_master_hco') }} m WHERE t.entity_id = m.kmk_hco_id)\n),\n\n-- Pivot logic\npivoted AS (\n    SELECT\n        kmk_hco_id,\n        '{{ var(\"sfe_version\") }}' AS target_version,\n\n        -- KAM Network (target flag + decile)\n        MAX(CASE WHEN target_type = 'KAM_NETWORK' AND target_flag = 'Y' THEN 'Y' ELSE 'N' END) AS kam_network_target_flag,\n        MAX(CASE WHEN target_type = 'KAM_NETWORK' THEN decile END) AS kam_network_decile,\n\n        -- KAM Child (target flag + decile)\n        MAX(CASE WHEN target_type = 'KAM_CHILD' AND target_flag = 'Y' THEN 'Y' ELSE 'N' END) AS kam_child_target_flag,\n        MAX(CASE WHEN target_type = 'KAM_CHILD' THEN decile END) AS kam_child_decile,\n\n        -- HSD Targets\n        MAX(CASE WHEN target_type = 'HSD' AND target_flag = 'Y' THEN 'Y' ELSE 'N' END) AS hsd_target_flag,\n        MAX(CASE WHEN target_type = 'HSD' THEN decile END) AS hsd_rank,\n\n        -- MSL Targets\n        MAX(CASE WHEN target_type = 'MSL_TARGET' AND target_flag = 'Y' THEN 'Y' ELSE 'N' END) AS msl_target_flag\n\n    FROM resolved_targets\n    GROUP BY kmk_hco_id\n)\n\nSELECT\n    kmk_hco_id,\n    kam_network_target_flag,\n    kam_network_decile,\n    kam_child_target_flag,\n    kam_child_decile,\n    hsd_target_flag,\n    hsd_rank,\n    msl_target_flag,\n    target_version,\n    CURRENT_DATE() AS data_date\nFROM pivoted", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_sfe_targets", "package": null, "version": null}, {"name": "mdm_customer_master_hco", "package": null, "version": null}, {"name": "mdm_customer_xref_hco", "package": null, "version": null}, {"name": "mdm_customer_master_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.stg_sfe_targets", "model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.mdm_customer_xref_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["kmk_hco_id"], "time_spine": null}, "model.CGOncology_MDM.hcp_decile": {"database": "CGONCOLOGY_TEST", "schema": "project", "name": "hcp_decile", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "SFE/hcp_decile.sql", "original_file_path": "models/SFE/hcp_decile.sql", "unique_id": "model.CGOncology_MDM.hcp_decile", "fqn": ["CGOncology_MDM", "SFE", "hcp_decile"], "alias": "hcp_decile", "checksum": {"name": "sha256", "checksum": "82e131523bcd6fed39588eb6cfd5f8fb8da4b7e1e61d5a9011b3c724d2dac17b"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": ["sfe", "sfe", "sfe"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["sfe"], "description": "HCP Decile Ranking - Assigns decile rankings (1-10) to Healthcare Providers\nbased on Min-Max standardized composite scores over 18-month time period.\n\nMethodology:\n1. Min-Max Standardization: Scale each metric to 0-1 range\n   Formula: (value - min) / (max - min)\n\n2. Composite Score Calculation (weights sum to 100%):\n   - Total Patients: 10%\n   - BCG Claims: 45%\n   - TURBT Claims: 45%\n\n3. Decile Assignment: Based on cumulative % of total composite score\n   - Each decile represents ~10% of total composite score\n   - Decile 10 = Top performers (first 10% of cumulative score)\n   - Decile 1 = Bottom performers (last 10% of cumulative score)\n", "columns": {"NPI": {"name": "NPI", "description": "National Provider Identifier (primary key)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "TIME_PERIOD": {"name": "TIME_PERIOD", "description": "Time period filter ('18 Months')", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "TOTAL_PATIENTS": {"name": "TOTAL_PATIENTS", "description": "Raw total patient count", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "BCG_CLAIMS": {"name": "BCG_CLAIMS", "description": "Raw BCG treatment claims count", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "TURBT_CLAIMS": {"name": "TURBT_CLAIMS", "description": "Raw TURBT procedure claims count", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "STANDARDIZED_TOTAL_PATIENTS": {"name": "STANDARDIZED_TOTAL_PATIENTS", "description": "Min-Max standardized total patients (0-1 scale, 10% weight)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "STANDARDIZED_BCG_CLAIMS": {"name": "STANDARDIZED_BCG_CLAIMS", "description": "Min-Max standardized BCG claims (0-1 scale, 45% weight)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "STANDARDIZED_TURBT_CLAIMS": {"name": "STANDARDIZED_TURBT_CLAIMS", "description": "Min-Max standardized TURBT claims (0-1 scale, 45% weight)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "COMPOSITE_SCORE": {"name": "COMPOSITE_SCORE", "description": "Weighted sum of standardized metrics (0-1 scale)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "DECILE": {"name": "DECILE", "description": "Decile ranking based on cumulative composite score (1=bottom, 10=top)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "HCP_NAME": {"name": "HCP_NAME", "description": "Full provider name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "SPECIALTY": {"name": "SPECIALTY", "description": "Provider medical specialty", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PRIMARY_AFFILIATION": {"name": "PRIMARY_AFFILIATION", "description": "Primary affiliated institution", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "ZIP_CODE": {"name": "ZIP_CODE", "description": "Provider ZIP code", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "CLINICAL_TRIAL_PI_FLAG": {"name": "CLINICAL_TRIAL_PI_FLAG", "description": "Clinical trial principal investigator flag", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/SFE/schema.yml", "build_path": null, "unrendered_config": {"materialized": "table", "tags": ["sfe"], "enabled": true}, "created_at": 1770177079.391158, "relation_name": "CGONCOLOGY_TEST.project.hcp_decile", "raw_code": "{{ config(\n    materialized='table',\n    tags=['sfe']\n) }}\n\n/*\nBusiness Rule: HCP Decile Ranking with Min-Max Standardization\n\nStep 1: Min-Max Standardization\n  - Scale each metric to 0-1 range: (value - min) / (max - min)\n  - Ensures all metrics contribute proportionally regardless of original scale\n\nStep 2: Composite Score Calculation (weights sum to 100%)\n  - Total Patients: 10%\n  - BCG Claims: 45%\n  - TURBT Claims: 45%\n  - COMPOSITE_SCORE = (STANDARDIZED_TOTAL_PATIENTS * 0.10) +\n                      (STANDARDIZED_BCG_CLAIMS * 0.45) +\n                      (STANDARDIZED_TURBT_CLAIMS * 0.45)\n\nStep 3: Decile Assignment\n  - Based on cumulative percentage of total composite scores\n  - Each decile represents ~10% of total composite score\n  - Decile 10 = Top performers (first 10% of cumulative score)\n  - Decile 1 = Bottom performers (last 10% of cumulative score)\n*/\n\n-- Step 1: Calculate MIN and MAX for each metric\nWITH metrics_stats AS (\n    SELECT\n        MIN(COALESCE(\"# Total Patients\", 0)) AS min_total_patients,\n        MAX(COALESCE(\"# Total Patients\", 0)) AS max_total_patients,\n        MIN(COALESCE(\"# BCG Claims\", 0)) AS min_bcg_claims,\n        MAX(COALESCE(\"# BCG Claims\", 0)) AS max_bcg_claims,\n        MIN(COALESCE(\"# TURBT Claims\", 0)) AS min_turbt_claims,\n        MAX(COALESCE(\"# TURBT Claims\", 0)) AS max_turbt_claims\n    FROM {{ source('cgoncology_dev_reporting', 'HCP_VIEW_DETAIL_TABLE') }}\n    WHERE TIME_PERIOD = '18 Months'\n),\n\n-- Step 2: Extract raw data and rename columns\nraw_data AS (\n    SELECT\n        \"NPI ID\" AS NPI,\n        TIME_PERIOD,\n        -- Raw metrics for decile calculation\n        COALESCE(\"# Total Patients\", 0) AS TOTAL_PATIENTS,\n        COALESCE(\"# BCG Claims\", 0) AS BCG_CLAIMS,\n        COALESCE(\"# TURBT Claims\", 0) AS TURBT_CLAIMS,\n        -- Additional metrics (not used in decile)\n        \"# Adstiladrin Claims\" AS ADSTILADRIN_CLAIMS,\n        \"# Cystoscopy Claims\" AS CYSTOSCOPY_CLAIMS,\n        \"# Other Procedure Claims\" AS OTHER_PROCEDURE_CLAIMS,\n        \"# Total Claims\" AS TOTAL_CLAIMS,\n        \"# TURBT Patients\" AS TURBT_PATIENTS,\n        \"# BCG Patients\" AS BCG_PATIENTS,\n        \"# Adstiladrin Patients\" AS ADSTILADRIN_PATIENTS,\n        \"# Cystoscopy Patients\" AS CYSTOSCOPY_PATIENTS,\n        \"# Other Procedure Patients\" AS OTHER_PROCEDURE_PATIENTS,\n        \"# BC Diagnosis Patients\" AS BC_DIAGNOSIS_PATIENTS,\n        \"# BC Diagnosis Claims\" AS BC_DIAGNOSIS_CLAIMS,\n        -- HCP attributes\n        \"Primary Affiliation\" AS PRIMARY_AFFILIATION,\n        \"Specialty\" AS SPECIALTY,\n        \"Decile\" AS DECILE_ORIGINAL,\n        \"ZIP Code\" AS ZIP_CODE,\n        \"City\" AS CITY,\n        \"State\" AS STATE,\n        \"TERRITORY_NAME\" AS TERRITORY_NAME,\n        \"Territory\" AS TERRITORY,\n        \"Region\" AS REGION,\n        \"REGION_NAME\" AS REGION_NAME,\n        \"TERRITORY_NAME_HSD\" AS TERRITORY_NAME_HSD,\n        \"Territory_HSD\" AS TERRITORY_HSD,\n        \"TERRITORY_NAME_MSL\" AS TERRITORY_NAME_MSL,\n        \"Territory_MSL\" AS TERRITORY_MSL,\n        \"Clinical Trial PI Flag\" AS CLINICAL_TRIAL_PI_FLAG,\n        \"ADDRESS\" AS ADDRESS,\n        \"Target\" AS TARGET,\n        \"FIRST_NAME\" AS FIRST_NAME,\n        \"MIDDLE_NAME\" AS MIDDLE_NAME,\n        \"LAST_NAME\" AS LAST_NAME,\n        \"HCP_NAME\" AS HCP_NAME\n    FROM {{ source('cgoncology_dev_reporting', 'HCP_VIEW_DETAIL_TABLE') }}\n    WHERE TIME_PERIOD = '18 Months'\n),\n\n-- Step 3: Apply Min-Max standardization and calculate composite score\nstandardized_scores AS (\n    SELECT\n        r.*,\n        -- Min-Max standardized values (0-1 scale)\n        CASE\n            WHEN s.max_total_patients = s.min_total_patients THEN 0\n            ELSE (r.TOTAL_PATIENTS - s.min_total_patients) /\n                 (s.max_total_patients - s.min_total_patients)\n        END AS STANDARDIZED_TOTAL_PATIENTS,\n        CASE\n            WHEN s.max_bcg_claims = s.min_bcg_claims THEN 0\n            ELSE (r.BCG_CLAIMS - s.min_bcg_claims) /\n                 (s.max_bcg_claims - s.min_bcg_claims)\n        END AS STANDARDIZED_BCG_CLAIMS,\n        CASE\n            WHEN s.max_turbt_claims = s.min_turbt_claims THEN 0\n            ELSE (r.TURBT_CLAIMS - s.min_turbt_claims) /\n                 (s.max_turbt_claims - s.min_turbt_claims)\n        END AS STANDARDIZED_TURBT_CLAIMS\n    FROM raw_data r\n    CROSS JOIN metrics_stats s\n),\n\n-- Step 4: Calculate composite score from standardized values\ncomposite_scores AS (\n    SELECT\n        *,\n        -- Weighted composite score using standardized metrics\n        (STANDARDIZED_TOTAL_PATIENTS * 0.10 +\n         STANDARDIZED_BCG_CLAIMS * 0.45 +\n         STANDARDIZED_TURBT_CLAIMS * 0.45) AS COMPOSITE_SCORE\n    FROM standardized_scores\n),\n\n-- Step 5: Calculate cumulative scores for decile assignment\nranked_hcps AS (\n    SELECT\n        *,\n        SUM(COMPOSITE_SCORE) OVER (ORDER BY COMPOSITE_SCORE DESC, NPI) AS CUMULATIVE_SCORE,\n        SUM(COMPOSITE_SCORE) OVER () AS TOTAL_SCORE\n    FROM composite_scores\n),\n\n-- Step 6: Assign deciles based on cumulative percentage\ndecile_assignment AS (\n    SELECT\n        *,\n        CASE\n            WHEN TOTAL_SCORE = 0 THEN 0\n            ELSE (CUMULATIVE_SCORE / TOTAL_SCORE) * 100\n        END AS CUMULATIVE_PCT,\n        CASE\n            WHEN TOTAL_SCORE = 0 THEN 1\n            WHEN (CUMULATIVE_SCORE / TOTAL_SCORE) * 100 <= 10 THEN 10\n            WHEN (CUMULATIVE_SCORE / TOTAL_SCORE) * 100 <= 20 THEN 9\n            WHEN (CUMULATIVE_SCORE / TOTAL_SCORE) * 100 <= 30 THEN 8\n            WHEN (CUMULATIVE_SCORE / TOTAL_SCORE) * 100 <= 40 THEN 7\n            WHEN (CUMULATIVE_SCORE / TOTAL_SCORE) * 100 <= 50 THEN 6\n            WHEN (CUMULATIVE_SCORE / TOTAL_SCORE) * 100 <= 60 THEN 5\n            WHEN (CUMULATIVE_SCORE / TOTAL_SCORE) * 100 <= 70 THEN 4\n            WHEN (CUMULATIVE_SCORE / TOTAL_SCORE) * 100 <= 80 THEN 3\n            WHEN (CUMULATIVE_SCORE / TOTAL_SCORE) * 100 <= 90 THEN 2\n            ELSE 1\n        END AS DECILE\n    FROM ranked_hcps\n)\n\nSELECT\n    NPI,\n    TIME_PERIOD,\n    -- Raw metrics\n    TOTAL_PATIENTS,\n    BCG_CLAIMS,\n    TURBT_CLAIMS,\n    -- Standardized metrics (0-1 scale)\n    STANDARDIZED_TOTAL_PATIENTS,\n    STANDARDIZED_BCG_CLAIMS,\n    STANDARDIZED_TURBT_CLAIMS,\n    -- Composite score and decile\n    COMPOSITE_SCORE,\n    DECILE,\n    -- Additional metrics\n    ADSTILADRIN_CLAIMS,\n    CYSTOSCOPY_CLAIMS,\n    OTHER_PROCEDURE_CLAIMS,\n    TOTAL_CLAIMS,\n    TURBT_PATIENTS,\n    BCG_PATIENTS,\n    ADSTILADRIN_PATIENTS,\n    CYSTOSCOPY_PATIENTS,\n    OTHER_PROCEDURE_PATIENTS,\n    BC_DIAGNOSIS_PATIENTS,\n    BC_DIAGNOSIS_CLAIMS,\n    -- HCP attributes\n    PRIMARY_AFFILIATION,\n    SPECIALTY,\n    ZIP_CODE,\n    CITY,\n    STATE,\n    TERRITORY_NAME,\n    TERRITORY,\n    REGION,\n    REGION_NAME,\n    TERRITORY_NAME_HSD,\n    TERRITORY_HSD,\n    TERRITORY_NAME_MSL,\n    TERRITORY_MSL,\n    CLINICAL_TRIAL_PI_FLAG,\n    ADDRESS,\n    TARGET,\n    FIRST_NAME,\n    MIDDLE_NAME,\n    LAST_NAME,\n    HCP_NAME\nFROM decile_assignment\nORDER BY DECILE DESC, COMPOSITE_SCORE DESC", "doc_blocks": [], "language": "sql", "refs": [], "sources": [["cgoncology_dev_reporting", "HCP_VIEW_DETAIL_TABLE"]], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["source.CGOncology_MDM.cgoncology_dev_reporting.HCP_VIEW_DETAIL_TABLE"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["NPI"], "time_spine": null}, "model.CGOncology_MDM.adm_sfe_zip_alignment": {"database": "CGONCOLOGY_TEST", "schema": "ADM", "name": "adm_sfe_zip_alignment", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "SFE/adm_sfe_zip_alignment.sql", "original_file_path": "models/SFE/adm_sfe_zip_alignment.sql", "unique_id": "model.CGOncology_MDM.adm_sfe_zip_alignment", "fqn": ["CGOncology_MDM", "SFE", "adm_sfe_zip_alignment"], "alias": "adm_sfe_zip_alignment", "checksum": {"name": "sha256", "checksum": "41514475444da455f783ec51b2f0f581165a40fad9975a05d9774b5f28887e8d"}, "config": {"enabled": true, "alias": null, "schema": "ADM", "database": null, "tags": ["sfe", "sfe"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["sfe"], "description": "ZIP-to-territory alignment mapping.\nBusiness Rules: TGT-040 to TGT-050\n", "columns": {"zip_code": {"name": "zip_code", "description": "5-digit ZIP code (primary key)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/SFE/schema.yml", "build_path": null, "unrendered_config": {"materialized": "table", "tags": ["sfe"], "enabled": true, "schema": "ADM"}, "created_at": 1770177079.391605, "relation_name": "CGONCOLOGY_TEST.ADM.adm_sfe_zip_alignment", "raw_code": "{{ config(\n    schema='ADM',\n    materialized='table',\n    tags=['sfe']\n) }}\n\n/*\nADM_SFE_ZIP_ALIGNMENT - ZIP to Territory Assignment\nSource: CGONCOLOGY_DEV.STAGING.CG_ONCOLOGY_ZIP_TERR (proper case names)\n\nClean mapping table for assigning territories to entities based on ZIP code.\nGrain: One row per ZIP_CODE.\n*/\n\nSELECT\n    LPAD(ZIP_CODE::VARCHAR, 5, '0') AS zip_code,\n    CITY AS city,\n    STATE AS state,\n\n    -- KAM Territory (proper case preserved from source)\n    KAM_TERRITORY AS kam_territory_code,\n    KAM_TERRITORY_NAME AS kam_territory_name,\n    KAM_REGION AS kam_region_code,\n    KAM_REGION_NAME AS kam_region_name,\n\n    -- HSD Territory (proper case preserved from source)\n    HSD_TERRITORY AS hsd_territory_code,\n    HSD_TERRITORY_NAME AS hsd_territory_name,\n\n    -- MSL Territory (proper case preserved from source)\n    MSL_TERRITORY AS msl_territory_code,\n    MSL_TERRITORY_NAME AS msl_territory_name,\n\n    -- Version tracking\n    '{{ var(\"sfe_version\") }}' AS zip_alignment_version,\n\n    CURRENT_DATE() AS data_date\nFROM CGONCOLOGY_DEV.STAGING.CG_ONCOLOGY_ZIP_TERR\nWHERE ZIP_CODE IS NOT NULL", "doc_blocks": [], "language": "sql", "refs": [], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["zip_code"], "time_spine": null}, "model.CGOncology_MDM.stg_sfe_targets": {"database": "CGONCOLOGY_TEST", "schema": "STAGING", "name": "stg_sfe_targets", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "SFE/stg_sfe_targets.sql", "original_file_path": "models/SFE/stg_sfe_targets.sql", "unique_id": "model.CGOncology_MDM.stg_sfe_targets", "fqn": ["CGOncology_MDM", "SFE", "stg_sfe_targets"], "alias": "stg_sfe_targets", "checksum": {"name": "sha256", "checksum": "553365c85cde7bf1481ffecab5a04b551fc28f9b3c6c2d1e24502589dd7bae9e"}, "config": {"enabled": true, "alias": null, "schema": "STAGING", "database": null, "tags": ["sfe", "sfe"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["sfe"], "description": "Consolidated Sales Force Effectiveness targets.\nCombines KAM Network, KAM Child, HSD, HCP, and MSL targets into a single source.\nBusiness Rules: TGT-001 to TGT-020\n", "columns": {"entity_id": {"name": "entity_id", "description": "Entity identifier (KMK_ID or DH_ID or NPI)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "entity_type": {"name": "entity_type", "description": "Entity type (HCO or HCP)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "target_type": {"name": "target_type", "description": "Target type (KAM_NETWORK, KAM_CHILD, HSD, HCP_TARGET, MSL_TARGET)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "target_flag": {"name": "target_flag", "description": "Target flag (Y)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/SFE/schema.yml", "build_path": null, "unrendered_config": {"materialized": "table", "tags": ["sfe"], "enabled": true, "schema": "STAGING"}, "created_at": 1770177079.391348, "relation_name": "CGONCOLOGY_TEST.STAGING.stg_sfe_targets", "raw_code": "{{ config(\n    schema='STAGING',\n    materialized='table',\n    tags=['sfe']\n) }}\n\n/*\nSTG_SFE_TARGETS - Consolidated Sales Force Effectiveness Targets & Deciles\nBusiness Rules: TGT-001 to TGT-020\n\nConsolidates all sales targets AND deciles into a single source of truth.\nIncludes ALL accounts with deciles (not just targets) to preserve decile rankings.\n\nSources:\n1. KAM Network (ADMIN_SITE_TARGET_LIST_ACCT_ID) - All L1/L2 with deciles (4,886)\n2. KAM Child (CHILD_SITE_TARGET_LIST_ACCT_ID) - All L3 with deciles (12,653)\n3. HSD Targets (HSD_TARGET_UNIVERSE_UPDATED_RANK) - Top 60 by national rank\n4. HCP Targets (CG_ONCOLOGY_HCP_TARGETING_LIST) - All HCPs with deciles (31,201)\n5. MSL Targets (CG_MSL_Target_list) - MSL targets (110)\n\nNote: target_flag indicates whether the record is an active target (Y) or just has a decile (N)\n*/\n\nWITH \n-- 1. KAM Network Accounts (L1/L2 Accounts) - ALL records with deciles\nkam_network_targets AS (\n    SELECT\n        CAST(ACCOUNT_ID AS VARCHAR) AS entity_id,\n        'HCO' AS entity_type,\n        'KAM_NETWORK' AS target_type,\n        'KAM' AS team_code,\n        NETWORK_DECILE AS decile,\n        NULL AS score,  -- Composite score removed\n        CASE WHEN TARGET_FLAG = 1 THEN 'Y' ELSE 'N' END AS target_flag,\n        '{{ var(\"sfe_version\") }}' AS target_version\n    FROM {{ source('staging', 'ADMIN_SITE_TARGET_LIST_ACCT_ID') }}\n    WHERE NETWORK_DECILE IS NOT NULL\n),\n\n-- 2. KAM Child Accounts (L3 Accounts) - ALL records with deciles\nkam_child_targets AS (\n    SELECT\n        CAST(ACCOUNT_ID AS VARCHAR) AS entity_id,\n        'HCO' AS entity_type,\n        'KAM_CHILD' AS target_type,\n        'KAM' AS team_code,\n        CHILD_DECILE AS decile,\n        NULL AS score,  -- Composite score removed\n        CASE WHEN TARGET_FLAG = 1 THEN 'Y' ELSE 'N' END AS target_flag,\n        '{{ var(\"sfe_version\") }}' AS target_version\n    FROM {{ source('staging', 'CHILD_SITE_TARGET_LIST_ACCT_ID') }}\n    WHERE CHILD_DECILE IS NOT NULL\n),\n\n-- 3. HSD Targets (Top 60 National)\nhsd_targets AS (\n    SELECT\n        CAST(TOPMOST_LEVEL_DH_ID AS VARCHAR) AS entity_id,\n        'HCO' AS entity_type,\n        'HSD' AS target_type,\n        'HSD' AS team_code,\n        SCENARIO_2_RANK_NATIONAL AS decile, -- Using rank as decile placeholder\n        NULL AS score,\n        'Y' AS target_flag,\n        '{{ var(\"sfe_version\") }}' AS target_version\n    FROM {{ source('cgoncology_prod_analytical', 'HSD_TARGET_UNIVERSE_UPDATED_RANK') }}\n    WHERE SCENARIO_2_RANK_NATIONAL <= 60\n),\n\n-- 4. HCP Targets - ALL records with deciles (not just targets)\nhcp_targets AS (\n    SELECT\n        CAST(HCP_NPI AS VARCHAR) AS entity_id,\n        'HCP' AS entity_type,\n        'HCP_TARGET' AS target_type,\n        'KAM' AS team_code, -- Assuming KAM targets for HCPs\n        HCP_VALUATION_DECILE AS decile,\n        NULL AS score,\n        CASE WHEN POTENTIAL_TARGET_FLAG = 1 THEN 'Y' ELSE 'N' END AS target_flag,\n        '{{ var(\"sfe_version\") }}' AS target_version\n    FROM {{ source('staging', 'CG_ONCOLOGY_HCP_TARGETING_LIST') }}\n    WHERE HCP_VALUATION_DECILE IS NOT NULL\n),\n\n-- 5. MSL Targets (HCO-level, mostly L1 health systems)\nmsl_targets AS (\n    SELECT\n        CAST(kmk_id AS VARCHAR) AS entity_id,\n        'HCO' AS entity_type,\n        'MSL_TARGET' AS target_type,\n        'MSL' AS team_code,\n        NULL AS decile,\n        NULL AS score,\n        'Y' AS target_flag,\n        '{{ var(\"sfe_version\") }}' AS target_version\n    FROM {{ source('cgoncology_prod_analytical', 'CG_MSL_Target_list') }}\n    WHERE MSL_TARGET_FLAG = 1\n),\n\ncombined_targets AS (\n    SELECT * FROM kam_network_targets\n    UNION ALL\n    SELECT * FROM kam_child_targets\n    UNION ALL\n    SELECT * FROM hsd_targets\n    UNION ALL\n    SELECT * FROM hcp_targets\n    UNION ALL\n    SELECT * FROM msl_targets\n)\n\nSELECT \n    entity_id,\n    entity_type,\n    target_type,\n    team_code,\n    decile,\n    score,\n    target_flag,\n    target_version,\n    CURRENT_DATE() AS load_date\nFROM combined_targets", "doc_blocks": [], "language": "sql", "refs": [], "sources": [["staging", "ADMIN_SITE_TARGET_LIST_ACCT_ID"], ["staging", "CHILD_SITE_TARGET_LIST_ACCT_ID"], ["cgoncology_prod_analytical", "HSD_TARGET_UNIVERSE_UPDATED_RANK"], ["staging", "CG_ONCOLOGY_HCP_TARGETING_LIST"], ["cgoncology_prod_analytical", "CG_MSL_Target_list"]], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["source.CGOncology_MDM.staging.ADMIN_SITE_TARGET_LIST_ACCT_ID", "source.CGOncology_MDM.staging.CHILD_SITE_TARGET_LIST_ACCT_ID", "source.CGOncology_MDM.cgoncology_prod_analytical.HSD_TARGET_UNIVERSE_UPDATED_RANK", "source.CGOncology_MDM.staging.CG_ONCOLOGY_HCP_TARGETING_LIST", "source.CGOncology_MDM.cgoncology_prod_analytical.CG_MSL_Target_list"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}, "model.CGOncology_MDM.adm_sfe_geographies": {"database": "CGONCOLOGY_TEST", "schema": "ADM", "name": "adm_sfe_geographies", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "SFE/adm_sfe_geographies.sql", "original_file_path": "models/SFE/adm_sfe_geographies.sql", "unique_id": "model.CGOncology_MDM.adm_sfe_geographies", "fqn": ["CGOncology_MDM", "SFE", "adm_sfe_geographies"], "alias": "adm_sfe_geographies", "checksum": {"name": "sha256", "checksum": "35569e699fba761a466e8403969f3b157ac1fa55c17562ee52b2896cae61409d"}, "config": {"enabled": true, "alias": null, "schema": "ADM", "database": null, "tags": ["sfe", "sfe"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["sfe"], "description": "Sales hierarchy master (Territory \u2192 Region \u2192 Nation).\nBusiness Rules: TGT-040 to TGT-050\n", "columns": {"geo_code": {"name": "geo_code", "description": "Geography code (primary key)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "geo_name": {"name": "geo_name", "description": "Geography name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "geo_type": {"name": "geo_type", "description": "Geography type", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "team": {"name": "team", "description": "Sales team (KAM, HSD, MSL, PAYOR; NULL for HQ National)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/SFE/schema.yml", "build_path": null, "unrendered_config": {"materialized": "table", "tags": ["sfe"], "enabled": true, "schema": "ADM"}, "created_at": 1770177079.391521, "relation_name": "CGONCOLOGY_TEST.ADM.adm_sfe_geographies", "raw_code": "{{ config(\n    schema='ADM',\n    materialized='table',\n    tags=['sfe']\n) }}\n\n/*\nADM_SFE_GEOGRAPHIES - Sales Force Hierarchy & Geography Master\nSource: stg_zip_territory\n\nProvides the single source of truth for the sales organization structure.\nUnpivots the flat ZIP alignment into a hierarchical parent-child node list.\n\nStructure:\n- Node (Territory/Region/Nation)\n- Parent Node\n- Team (KAM/HSD/MSL)\n\nUPDATED 2026-01-14: Changed national-level geographies to use geo codes instead of names:\n- KAM_NATIONAL \u2192 C1A0000\n- HSD_NATIONAL \u2192 C2A0000\n- MSL_NATIONAL \u2192 C3A0000\nThis ensures consistency with DEV environment.\n*/\n\nWITH source AS (\n    SELECT * FROM {{ ref('std_zip_territory') }}\n),\n\n-- ============================================================\n-- KAM Hierarchy (Territory -> Region -> National)\n-- ============================================================\nkam_territories AS (\n    SELECT DISTINCT\n        kam_territory_code AS geo_code,\n        kam_territory_name AS geo_name,\n        kam_region_code AS parent_geo_code,\n        'TERRITORY' AS geo_type,\n        'KAM' AS team\n    FROM source\n    WHERE kam_territory_code IS NOT NULL\n),\n\nkam_regions AS (\n    SELECT DISTINCT\n        kam_region_code AS geo_code,\n        kam_region_name AS geo_name,\n        'C1A0000' AS parent_geo_code,  -- Changed from 'KAM_NATIONAL' to geo code\n        'REGION' AS geo_type,\n        'KAM' AS team\n    FROM source\n    WHERE kam_region_code IS NOT NULL\n),\n\nkam_national AS (\n    SELECT DISTINCT\n        'C1A0000' AS geo_code,  -- Changed from 'KAM_NATIONAL' to geo code\n        'KAM National' AS geo_name,\n        NULL AS parent_geo_code,\n        'NATION' AS geo_type,\n        'KAM' AS team\n),\n\n-- ============================================================\n-- HSD Hierarchy (Territory -> National)\n-- ============================================================\nhsd_territories AS (\n    SELECT DISTINCT\n        hsd_territory_code AS geo_code,\n        hsd_territory_name AS geo_name,\n        'C2A0000' AS parent_geo_code,  -- Changed from 'HSD_NATIONAL' to geo code\n        'TERRITORY' AS geo_type,\n        'HSD' AS team\n    FROM source\n    WHERE hsd_territory_code IS NOT NULL\n),\n\nhsd_national AS (\n    SELECT DISTINCT\n        'C2A0000' AS geo_code,  -- Changed from 'HSD_NATIONAL' to geo code\n        'HSD National' AS geo_name,\n        NULL AS parent_geo_code,\n        'NATION' AS geo_type,\n        'HSD' AS team\n),\n\n-- ============================================================\n-- MSL Hierarchy (Territory -> National)\n-- ============================================================\nmsl_territories AS (\n    SELECT DISTINCT\n        msl_territory_code AS geo_code,\n        msl_territory_name AS geo_name,\n        'C3A0000' AS parent_geo_code,  -- Changed from 'MSL_NATIONAL' to geo code\n        'TERRITORY' AS geo_type,\n        'MSL' AS team\n    FROM source\n    WHERE msl_territory_code IS NOT NULL\n),\n\nmsl_national AS (\n    SELECT DISTINCT\n        'C3A0000' AS geo_code,  -- Changed from 'MSL_NATIONAL' to geo code\n        'MSL National' AS geo_name,\n        NULL AS parent_geo_code,\n        'NATION' AS geo_type,\n        'MSL' AS team\n),\n\n-- ============================================================\n-- HQ National (C0A0000)\n-- ============================================================\nhq_national AS (\n    SELECT DISTINCT\n        'C0A0000' AS geo_code,\n        'HQ National' AS geo_name,\n        NULL AS parent_geo_code,\n        'NATION' AS geo_type,\n        NULL AS team\n),\n\n-- ============================================================\n-- Payor National (C4A0000)\n-- ============================================================\npayor_national AS (\n    SELECT DISTINCT\n        'C4A0000' AS geo_code,\n        'PAYOR National' AS geo_name,\n        NULL AS parent_geo_code,\n        'NATION' AS geo_type,\n        'PAYOR' AS team  -- Changed from 'TEAM_PAYOR' to match TEAMS.team_name\n),\n\n-- ============================================================\n-- Combine All Hierarchies\n-- ============================================================\ncombined AS (\n    SELECT * FROM kam_territories\n    UNION ALL SELECT * FROM kam_regions\n    UNION ALL SELECT * FROM kam_national\n    UNION ALL SELECT * FROM hsd_territories\n    UNION ALL SELECT * FROM hsd_national\n    UNION ALL SELECT * FROM msl_territories\n    UNION ALL SELECT * FROM msl_national\n    UNION ALL SELECT * FROM hq_national\n    UNION ALL SELECT * FROM payor_national\n)\n\nSELECT \n    geo_code,\n    geo_name,\n    parent_geo_code,\n    geo_type,\n    team,\n    '{{ var(\"sfe_version\") }}' AS target_version,\n    CURRENT_DATE() AS data_date\nFROM combined", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_zip_territory", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.std_zip_territory"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["geo_code"], "time_spine": null}, "model.CGOncology_MDM.std_dh_hco": {"database": "CGONCOLOGY_TEST", "schema": "STANDARDIZATION", "name": "std_dh_hco", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "standardization/std_dh_hco.sql", "original_file_path": "models/standardization/std_dh_hco.sql", "unique_id": "model.CGOncology_MDM.std_dh_hco", "fqn": ["CGOncology_MDM", "standardization", "std_dh_hco"], "alias": "std_dh_hco", "checksum": {"name": "sha256", "checksum": "0b6e0991a649a0e3412c4480e818d63a4f13977fea266feda8f275edcf64298b"}, "config": {"enabled": true, "alias": null, "schema": "STANDARDIZATION", "database": null, "tags": ["layer_1_standardization", "customer_backbone", "customer_backbone", "standardization", "customer_backbone", "standardization"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_1_standardization", "customer_backbone", "standardization"], "description": "PROC-STD-001: DH HCO Standardization - DHC organization data with address/name standardization. Renamed from stg_dh_hco for naming consistency (Jan 2026).", "columns": {"dh_id": {"name": "dh_id", "description": "DH organization identifier (VARCHAR)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "org_name": {"name": "org_name", "description": "Organization name (original case for display)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "normalized_org_name": {"name": "normalized_org_name", "description": "Normalized organization name (UPPERCASE for matching)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "hq_address_line_1": {"name": "hq_address_line_1", "description": "Headquarters address (UPPERCASE, standardized abbreviations)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "hq_city": {"name": "hq_city", "description": "Headquarters city (UPPERCASE)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "source_hash": {"name": "source_hash", "description": "SHA2-256 hash for change detection", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "hq_state": {"name": "hq_state", "description": "Headquarters state (2-char uppercase)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "hq_zip_code": {"name": "hq_zip_code", "description": "Headquarters ZIP code (5-digit padded)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/standardization/schema.yml", "build_path": null, "unrendered_config": {"schema": "STANDARDIZATION", "materialized": "table", "tags": ["customer_backbone", "standardization"]}, "created_at": 1770177079.424774, "relation_name": "CGONCOLOGY_TEST.STANDARDIZATION.std_dh_hco", "raw_code": "{{\n    config(\n        schema='STANDARDIZATION',\n        materialized='table',\n        tags=['customer_backbone', 'standardization']\n    )\n}}\n\n/*\nPROC-STD-001: std_dh_hco - DH HCO Standardization\nRenamed from stg_dh_hco to std_dh_hco for naming consistency (Jan 2026).\nSource: raw_dh.PRELAND_DH_ALL_COMPANIES_OVERVIEW\nBusiness Rules: STD-001 to STD-006, STD-010, STD-013, STD-020, STD-021, STD-030, STD-031, STD-040\n\nTransformations:\n- STD-001: ZIP Code 5-digit left-padded\n- STD-002: State 2-char uppercase\n- STD-003: Address uppercase trimmed\n- STD-004: Address abbreviation standardization via seed lookup\n- STD-005: City uppercase trimmed\n- STD-006: City normalization via ZIP_CITY_STATE_CONFIG lookup\n- STD-010: DH_ID as VARCHAR(50)\n- STD-013: Strip trailing decimals from IDs\n- STD-020: Org Name - preserve original casing from DH source (for display)\n- STD-021: Normalized Org Name - UPPER + abbreviation expansion (for matching)\n- STD-022: COMPANY_STATUS - Active/Closed/Opening for SCD2 is_active derivation\n- STD-030: Convert empty strings to NULL\n- STD-031: Preserve NULL values\n\nNote: This is the CURRENT SOURCE SNAPSHOT only.\nFor comprehensive universe (including soft-deleted entities), use:\n  std_dh_hco_hist WHERE is_current = 'Y'\n*/\n\nWITH source_data AS (\n    SELECT *,\n        -- Pre-calculate ZIP for join\n        CASE\n            WHEN TRIM(HQ_ZIP_CODE) IS NULL OR TRIM(HQ_ZIP_CODE) = '' THEN NULL\n            ELSE LPAD(TRIM(REGEXP_REPLACE(HQ_ZIP_CODE, '[^0-9]', '')), 5, '0')\n        END AS clean_zip\n    FROM {{ source('raw_dh', 'PRELAND_DH_ALL_COMPANIES_OVERVIEW') }}\n)\n\nSELECT\n    -- Primary Key (STD-010, STD-013, BUG-020)\n    -- DH_ID is numeric in source, cast to VARCHAR without decimals\n    CAST(src.DH_ID AS VARCHAR(50)) AS dh_id,\n\n    -- Organization Name (STD-020) - Preserve original casing from DH for display\n    NULLIF(TRIM(src.ORG_NAME), '') AS org_name,\n\n    -- Normalized Org Name for matching (STD-021)\n    -- UPPER + expands abbreviations: CTR\u2192CENTER, HOSP\u2192HOSPITAL, MED\u2192MEDICAL, etc.\n    {{ standardize_org_name('src.ORG_NAME') }} AS normalized_org_name,\n\n    -- Company Status (STD-022) - Used for SCD2 is_active derivation\n    -- Values: Active, Closed, Opening\n    NULLIF(TRIM(src.COMPANY_STATUS), '') AS company_status,\n\n    -- Firm Type\n    NULLIF(TRIM(src.FIRM_TYPE), '') AS firm_type,\n\n    -- Address Standardization (STD-003, STD-004, STD-030)\n    -- STD-004: Abbreviation standardization via seed lookup\n    NULLIF({{ standardize_address('src.HQ_ADDRESS') }}, '') AS hq_address_line_1,\n    NULLIF({{ standardize_address('src.HQ_ADDRESS1') }}, '') AS hq_address_line_2,\n\n    -- City (STD-005, STD-006, STD-030) - Normalized via ZIP_CITY_STATE_CONFIG lookup\n    COALESCE(UPPER(z.PRIMARY_CITY), NULLIF(UPPER(TRIM(src.HQ_CITY)), '')) AS hq_city,\n\n    -- State (STD-002, STD-030)\n    NULLIF(UPPER(TRIM(src.HQ_STATE)), '') AS hq_state,\n\n    -- ZIP Code (STD-001, STD-030)\n    src.clean_zip AS hq_zip_code,\n\n    -- NPI Number (STD-011) - NPI_NUMBER is numeric in source\n    NULLIF(CAST(src.NPI_NUMBER AS VARCHAR(20)), '') AS npi,\n\n    -- Classification fields (MAIN_SPECIALTY maps to primary_specialty)\n    NULLIF(TRIM(src.MAIN_SPECIALTY), '') AS primary_specialty,\n\n    -- Hospital Type\n    NULLIF(TRIM(src.HOSPITAL_TYPE), '') AS hospital_type,\n    NULLIF(TRIM(src.HOSPITAL_OWNERSHIP), '') AS hospital_ownership,\n\n    -- Network Hierarchy Columns\n    CAST(src.NETWORK_ID AS VARCHAR(50)) AS network_id,\n    NULLIF(TRIM(src.NETWORK_NAME), '') AS network_name,\n    NULLIF(TRIM(src.NETWORK_FIRM_TYPE), '') AS network_firm_type,\n    CAST(src.NETWORK_PARENT_ID AS VARCHAR(50)) AS network_parent_id,\n    NULLIF(TRIM(src.NETWORK_PARENT_NAME), '') AS network_parent_name,\n    NULLIF(TRIM(src.NETWORK_PARENT_FIRM_TYPE), '') AS network_parent_firm_type,\n\n    -- Hospital Parent Hierarchy\n    CAST(src.HOSPITAL_PARENT_ID AS VARCHAR(50)) AS hospital_parent_id,\n    NULLIF(TRIM(src.HOSPITAL_PARENT_NAME), '') AS hospital_parent_name,\n\n    -- Physician Group Parent\n    CAST(src.PG_PARENT_ID AS VARCHAR(50)) AS pg_parent_id,\n    NULLIF(TRIM(src.PG_PARENT_NAME), '') AS pg_parent_name,\n\n    -- Salesforce Parent Account\n    NULLIF(TRIM(src.SF_PARENT_ACCOUNT_ID), '') AS sf_parent_account_id,\n    NULLIF(TRIM(src.SF_PARENT_ACCOUNT_NAME), '') AS sf_parent_account_name,\n\n    -- Source hash for CDC (SHA2 of key business columns)\n    -- Includes COMPANY_STATUS to track status changes for SCD2\n    SHA2(\n        COALESCE(src.ORG_NAME, '') || '|' ||\n        COALESCE(src.COMPANY_STATUS, '') || '|' ||\n        COALESCE(src.HQ_ADDRESS, '') || '|' ||\n        COALESCE(src.HQ_CITY, '') || '|' ||\n        COALESCE(src.HQ_STATE, '') || '|' ||\n        COALESCE(src.HQ_ZIP_CODE, '') || '|' ||\n        COALESCE(CAST(src.NPI_NUMBER AS VARCHAR), '')\n    , 256) AS source_hash,\n\n    -- Audit columns\n    CURRENT_TIMESTAMP() AS load_timestamp,\n    CURRENT_DATE() AS data_date\n\nFROM source_data src\nLEFT JOIN {{ ref('zip_city_state_config') }} z\n    ON src.clean_zip = z.ZIP", "doc_blocks": [], "language": "sql", "refs": [{"name": "zip_city_state_config", "package": null, "version": null}], "sources": [["raw_dh", "PRELAND_DH_ALL_COMPANIES_OVERVIEW"]], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.CGOncology_MDM.standardize_org_name", "macro.CGOncology_MDM.standardize_address"], "nodes": ["source.CGOncology_MDM.raw_dh.PRELAND_DH_ALL_COMPANIES_OVERVIEW", "seed.CGOncology_MDM.zip_city_state_config"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["dh_id"], "time_spine": null}, "model.CGOncology_MDM.std_ddd_sales": {"database": "CGONCOLOGY_TEST", "schema": "STANDARDIZATION", "name": "std_ddd_sales", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "standardization/std_ddd_sales.sql", "original_file_path": "models/standardization/std_ddd_sales.sql", "unique_id": "model.CGOncology_MDM.std_ddd_sales", "fqn": ["CGOncology_MDM", "standardization", "std_ddd_sales"], "alias": "std_ddd_sales", "checksum": {"name": "sha256", "checksum": "c052913dffbe9e79efbe5c51924e2c2dd9965124aca947864f6f4568a3c8db5a"}, "config": {"enabled": true, "alias": null, "schema": "STANDARDIZATION", "database": null, "tags": ["layer_1_standardization", "customer_backbone", "customer_backbone", "standardization", "customer_backbone", "standardization"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_1_standardization", "customer_backbone", "standardization"], "description": "PROC-STD-DDD-SALES: DDD Sales Standardization - 12mo/24mo aggregation. Renamed from stg_ddd_sales (Jan 2026).", "columns": {"ddd_outlet_id": {"name": "ddd_outlet_id", "description": "DDD outlet identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "product_group_id": {"name": "product_group_id", "description": "Product group identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "product_name": {"name": "product_name", "description": "Mapped product name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/standardization/schema.yml", "build_path": null, "unrendered_config": {"schema": "STANDARDIZATION", "materialized": "table", "tags": ["customer_backbone", "standardization"]}, "created_at": 1770177079.429286, "relation_name": "CGONCOLOGY_TEST.STANDARDIZATION.std_ddd_sales", "raw_code": "{{\n    config(\n        schema='STANDARDIZATION',\n        materialized='table',\n        tags=['customer_backbone', 'standardization']\n    )\n}}\n\n/*\nPROC-STD-DDD-SALES: std_ddd_sales - DDD Sales Standardization\nRenamed from stg_ddd_sales to std_ddd_sales for naming consistency (Jan 2026).\nSource: raw_ddd.PRELAND_DDD_SALES\nBusiness Rules: STD-010, STD-030\n\nTransformations:\n- STD-010: DDD_OUTLET_NUMBER as VARCHAR(50)\n- STD-030: Convert empty strings to NULL\n- Aggregate 12-month and 24-month sales totals\n*/\n\nSELECT\n    -- Primary Key\n    CAST(DDD_OUTLET_NUMBER AS VARCHAR(50)) AS ddd_outlet_id,\n    CAST(PRODUCT_GROUP_ID AS INTEGER) AS product_group_id,\n\n    -- Data date\n    DATA_DATE AS data_date,\n\n    -- 12-month sales total (dollars)\n    COALESCE(DOLLAR_AMT_MONTH_1, 0) + COALESCE(DOLLAR_AMT_MONTH_2, 0) + COALESCE(DOLLAR_AMT_MONTH_3, 0) +\n    COALESCE(DOLLAR_AMT_MONTH_4, 0) + COALESCE(DOLLAR_AMT_MONTH_5, 0) + COALESCE(DOLLAR_AMT_MONTH_6, 0) +\n    COALESCE(DOLLAR_AMT_MONTH_7, 0) + COALESCE(DOLLAR_AMT_MONTH_8, 0) + COALESCE(DOLLAR_AMT_MONTH_9, 0) +\n    COALESCE(DOLLAR_AMT_MONTH_10, 0) + COALESCE(DOLLAR_AMT_MONTH_11, 0) + COALESCE(DOLLAR_AMT_MONTH_12, 0) AS sales_12mo,\n\n    -- 24-month sales total (dollars)\n    COALESCE(DOLLAR_AMT_MONTH_1, 0) + COALESCE(DOLLAR_AMT_MONTH_2, 0) + COALESCE(DOLLAR_AMT_MONTH_3, 0) +\n    COALESCE(DOLLAR_AMT_MONTH_4, 0) + COALESCE(DOLLAR_AMT_MONTH_5, 0) + COALESCE(DOLLAR_AMT_MONTH_6, 0) +\n    COALESCE(DOLLAR_AMT_MONTH_7, 0) + COALESCE(DOLLAR_AMT_MONTH_8, 0) + COALESCE(DOLLAR_AMT_MONTH_9, 0) +\n    COALESCE(DOLLAR_AMT_MONTH_10, 0) + COALESCE(DOLLAR_AMT_MONTH_11, 0) + COALESCE(DOLLAR_AMT_MONTH_12, 0) +\n    COALESCE(DOLLAR_AMT_MONTH_13, 0) + COALESCE(DOLLAR_AMT_MONTH_14, 0) + COALESCE(DOLLAR_AMT_MONTH_15, 0) +\n    COALESCE(DOLLAR_AMT_MONTH_16, 0) + COALESCE(DOLLAR_AMT_MONTH_17, 0) + COALESCE(DOLLAR_AMT_MONTH_18, 0) +\n    COALESCE(DOLLAR_AMT_MONTH_19, 0) + COALESCE(DOLLAR_AMT_MONTH_20, 0) + COALESCE(DOLLAR_AMT_MONTH_21, 0) +\n    COALESCE(DOLLAR_AMT_MONTH_22, 0) + COALESCE(DOLLAR_AMT_MONTH_23, 0) + COALESCE(DOLLAR_AMT_MONTH_24, 0) AS sales_24mo,\n\n    -- Individual months (24 months) - sales (dollars)\n    DOLLAR_AMT_MONTH_1 AS sales_month_1,\n    DOLLAR_AMT_MONTH_2 AS sales_month_2,\n    DOLLAR_AMT_MONTH_3 AS sales_month_3,\n    DOLLAR_AMT_MONTH_4 AS sales_month_4,\n    DOLLAR_AMT_MONTH_5 AS sales_month_5,\n    DOLLAR_AMT_MONTH_6 AS sales_month_6,\n    DOLLAR_AMT_MONTH_7 AS sales_month_7,\n    DOLLAR_AMT_MONTH_8 AS sales_month_8,\n    DOLLAR_AMT_MONTH_9 AS sales_month_9,\n    DOLLAR_AMT_MONTH_10 AS sales_month_10,\n    DOLLAR_AMT_MONTH_11 AS sales_month_11,\n    DOLLAR_AMT_MONTH_12 AS sales_month_12,\n    DOLLAR_AMT_MONTH_13 AS sales_month_13,\n    DOLLAR_AMT_MONTH_14 AS sales_month_14,\n    DOLLAR_AMT_MONTH_15 AS sales_month_15,\n    DOLLAR_AMT_MONTH_16 AS sales_month_16,\n    DOLLAR_AMT_MONTH_17 AS sales_month_17,\n    DOLLAR_AMT_MONTH_18 AS sales_month_18,\n    DOLLAR_AMT_MONTH_19 AS sales_month_19,\n    DOLLAR_AMT_MONTH_20 AS sales_month_20,\n    DOLLAR_AMT_MONTH_21 AS sales_month_21,\n    DOLLAR_AMT_MONTH_22 AS sales_month_22,\n    DOLLAR_AMT_MONTH_23 AS sales_month_23,\n    DOLLAR_AMT_MONTH_24 AS sales_month_24,\n\n    -- 12-month units total (pack units)\n    COALESCE(PACK_UNIT_QTY_MONTH_1, 0) + COALESCE(PACK_UNIT_QTY_MONTH_2, 0) + COALESCE(PACK_UNIT_QTY_MONTH_3, 0) +\n    COALESCE(PACK_UNIT_QTY_MONTH_4, 0) + COALESCE(PACK_UNIT_QTY_MONTH_5, 0) + COALESCE(PACK_UNIT_QTY_MONTH_6, 0) +\n    COALESCE(PACK_UNIT_QTY_MONTH_7, 0) + COALESCE(PACK_UNIT_QTY_MONTH_8, 0) + COALESCE(PACK_UNIT_QTY_MONTH_9, 0) +\n    COALESCE(PACK_UNIT_QTY_MONTH_10, 0) + COALESCE(PACK_UNIT_QTY_MONTH_11, 0) + COALESCE(PACK_UNIT_QTY_MONTH_12, 0) AS units_12mo,\n\n    -- 24-month units total (pack units)\n    COALESCE(PACK_UNIT_QTY_MONTH_1, 0) + COALESCE(PACK_UNIT_QTY_MONTH_2, 0) + COALESCE(PACK_UNIT_QTY_MONTH_3, 0) +\n    COALESCE(PACK_UNIT_QTY_MONTH_4, 0) + COALESCE(PACK_UNIT_QTY_MONTH_5, 0) + COALESCE(PACK_UNIT_QTY_MONTH_6, 0) +\n    COALESCE(PACK_UNIT_QTY_MONTH_7, 0) + COALESCE(PACK_UNIT_QTY_MONTH_8, 0) + COALESCE(PACK_UNIT_QTY_MONTH_9, 0) +\n    COALESCE(PACK_UNIT_QTY_MONTH_10, 0) + COALESCE(PACK_UNIT_QTY_MONTH_11, 0) + COALESCE(PACK_UNIT_QTY_MONTH_12, 0) +\n    COALESCE(PACK_UNIT_QTY_MONTH_13, 0) + COALESCE(PACK_UNIT_QTY_MONTH_14, 0) + COALESCE(PACK_UNIT_QTY_MONTH_15, 0) +\n    COALESCE(PACK_UNIT_QTY_MONTH_16, 0) + COALESCE(PACK_UNIT_QTY_MONTH_17, 0) + COALESCE(PACK_UNIT_QTY_MONTH_18, 0) +\n    COALESCE(PACK_UNIT_QTY_MONTH_19, 0) + COALESCE(PACK_UNIT_QTY_MONTH_20, 0) + COALESCE(PACK_UNIT_QTY_MONTH_21, 0) +\n    COALESCE(PACK_UNIT_QTY_MONTH_22, 0) + COALESCE(PACK_UNIT_QTY_MONTH_23, 0) + COALESCE(PACK_UNIT_QTY_MONTH_24, 0) AS units_24mo,\n\n    -- Individual months (24 months) - units (pack units)\n    PACK_UNIT_QTY_MONTH_1 AS units_month_1,\n    PACK_UNIT_QTY_MONTH_2 AS units_month_2,\n    PACK_UNIT_QTY_MONTH_3 AS units_month_3,\n    PACK_UNIT_QTY_MONTH_4 AS units_month_4,\n    PACK_UNIT_QTY_MONTH_5 AS units_month_5,\n    PACK_UNIT_QTY_MONTH_6 AS units_month_6,\n    PACK_UNIT_QTY_MONTH_7 AS units_month_7,\n    PACK_UNIT_QTY_MONTH_8 AS units_month_8,\n    PACK_UNIT_QTY_MONTH_9 AS units_month_9,\n    PACK_UNIT_QTY_MONTH_10 AS units_month_10,\n    PACK_UNIT_QTY_MONTH_11 AS units_month_11,\n    PACK_UNIT_QTY_MONTH_12 AS units_month_12,\n    PACK_UNIT_QTY_MONTH_13 AS units_month_13,\n    PACK_UNIT_QTY_MONTH_14 AS units_month_14,\n    PACK_UNIT_QTY_MONTH_15 AS units_month_15,\n    PACK_UNIT_QTY_MONTH_16 AS units_month_16,\n    PACK_UNIT_QTY_MONTH_17 AS units_month_17,\n    PACK_UNIT_QTY_MONTH_18 AS units_month_18,\n    PACK_UNIT_QTY_MONTH_19 AS units_month_19,\n    PACK_UNIT_QTY_MONTH_20 AS units_month_20,\n    PACK_UNIT_QTY_MONTH_21 AS units_month_21,\n    PACK_UNIT_QTY_MONTH_22 AS units_month_22,\n    PACK_UNIT_QTY_MONTH_23 AS units_month_23,\n    PACK_UNIT_QTY_MONTH_24 AS units_month_24,\n\n    -- Product name mapping\n    CASE\n        WHEN PRODUCT_GROUP_ID = 1 THEN 'ADSTILADRIN'\n        WHEN PRODUCT_GROUP_ID = 2 THEN 'ANKTIVA'\n        WHEN PRODUCT_GROUP_ID IN (3, 4) THEN 'TICE_BCG'\n        WHEN PRODUCT_GROUP_ID = 7 THEN 'INLEXZO'\n        ELSE 'OTHER'\n    END AS product_name,\n\n    -- Source hash\n    SHA2(\n        COALESCE(DDD_OUTLET_NUMBER, '') || '|' ||\n        COALESCE(CAST(PRODUCT_GROUP_ID AS VARCHAR), '') || '|' ||\n        COALESCE(CAST(DATA_DATE AS VARCHAR), '')\n    , 256) AS source_hash,\n\n    -- Audit columns\n    LOAD_DATE AS load_date\n\nFROM {{ source('raw_ddd', 'PRELAND_DDD_SALES') }}\nWHERE DDD_OUTLET_NUMBER IS NOT NULL\n  AND PRODUCT_GROUP_ID IS NOT NULL", "doc_blocks": [], "language": "sql", "refs": [], "sources": [["raw_ddd", "PRELAND_DDD_SALES"]], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["source.CGOncology_MDM.raw_ddd.PRELAND_DDD_SALES"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}, "model.CGOncology_MDM.std_dh_hco_hist": {"database": "CGONCOLOGY_TEST", "schema": "STANDARDIZATION", "name": "std_dh_hco_hist", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "standardization/std_dh_hco_hist.sql", "original_file_path": "models/standardization/std_dh_hco_hist.sql", "unique_id": "model.CGOncology_MDM.std_dh_hco_hist", "fqn": ["CGOncology_MDM", "standardization", "std_dh_hco_hist"], "alias": "std_dh_hco_hist", "checksum": {"name": "sha256", "checksum": "bab02e08430f06f9ce2ccdf8d71108436b36563c1f6a975b4498557839728ff8"}, "config": {"enabled": true, "alias": null, "schema": "STANDARDIZATION", "database": null, "tags": ["layer_1_standardization", "customer_backbone", "customer_backbone", "standardization", "history", "customer_backbone", "standardization", "history"], "meta": {}, "group": null, "materialized": "incremental", "incremental_strategy": "merge", "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": ["dh_id", "version_number"], "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_1_standardization", "customer_backbone", "standardization", "history"], "description": "SCD2 history for DH HCO. Bootstrapped from DEV.STAGING. 744,881 rows, 364,140 unique HCOs.", "columns": {"dh_id": {"name": "dh_id", "description": "DH organization identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "version_number": {"name": "version_number", "description": "SCD2 version number per entity (starts at 1)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "is_current": {"name": "is_current", "description": "Y for latest version per entity", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "is_active": {"name": "is_active", "description": "Y if entity in current source, N if soft-deleted", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/standardization/schema.yml", "build_path": null, "unrendered_config": {"schema": "STANDARDIZATION", "materialized": "incremental", "tags": ["customer_backbone", "standardization", "history"], "unique_key": ["dh_id", "version_number"], "incremental_strategy": "merge"}, "created_at": 1770177079.435533, "relation_name": "CGONCOLOGY_TEST.STANDARDIZATION.std_dh_hco_hist", "raw_code": "{{\n    config(\n        schema='STANDARDIZATION',\n        materialized='incremental',\n        unique_key=['dh_id', 'version_number'],\n        incremental_strategy='merge',\n        tags=['customer_backbone', 'standardization', 'history']\n    )\n}}\n\n/*\nSTD_DH_HCO_HIST - DH HCO History Table with SCD2 Columns\nProcess Code: PROC-STD-DH-HCO-HIST\nBusiness Rules: SCD-001 to SCD-015, SCD-017\n\nPurpose: Track SCD2 history of DH HCO (organization) records.\n         - INITIAL LOAD: Bootstrap from existing TEST table (one-time migration already done)\n         - INCREMENTAL: Append new versions when std_dh_hco records change\n\nGrain: One row per (dh_id, version_number)\n\nSource:\n  - Always: std_dh_hco (standardized current data)\n  - Incremental: {{ this }} (self-reference for existing history)\n\nSCD2 Columns:\n- version_number: Sequential per entity\n- effective_date: When this version became effective\n- end_date: NULL for current version\n- is_current: 'Y' for latest version per entity\n- source_hash: SHA2 of key business columns for change detection\n- is_active: Derived from COMPANY_STATUS (Active='Y', Closed/Opening='N')\n\nData Quality Handling:\n- SCD-007/SCD-014: Handle duplicate LOAD_DATEs via tie-breaker (source_hash)\n- SCD-010: Only create new version when source_hash changes\n\nUPDATED 2026-01-05: Converted to incremental model - no longer reads from DEV.\nInitial migration from DEV has been completed; this model now tracks changes incrementally.\n*/\n\n{% if is_incremental() %}\n-- ============================================================================\n-- INCREMENTAL: Append new versions when std_dh_hco records change\n-- ============================================================================\n\nWITH current_source AS (\n    -- Current standardized HCO data\n    SELECT\n        dh_id,\n        org_name,\n        {{ standardize_org_name('org_name') }} AS normalized_org_name,\n        company_status,\n        firm_type,\n        hq_address_line_1,\n        hq_address_line_2,\n        hq_city,\n        hq_state,\n        hq_zip_code,\n        npi,\n        primary_specialty,\n        NULL AS account_type,  -- Removed from std_dh_hco; kept for schema compatibility\n        hospital_type,\n        hospital_ownership,\n        network_id,\n        network_name,\n        network_firm_type,\n        network_parent_id,\n        network_parent_name,\n        network_parent_firm_type,\n        hospital_parent_id,\n        hospital_parent_name,\n        pg_parent_id,\n        pg_parent_name,\n        sf_parent_account_id,\n        sf_parent_account_name,\n        -- Compute source_hash for change detection\n        SHA2(CONCAT_WS('|',\n            COALESCE(dh_id, ''),\n            COALESCE(org_name, ''),\n            COALESCE(firm_type, ''),\n            COALESCE(hq_address_line_1, ''),\n            COALESCE(hq_city, ''),\n            COALESCE(hq_state, ''),\n            COALESCE(hq_zip_code, ''),\n            COALESCE(npi, ''),\n            COALESCE(network_id, ''),\n            COALESCE(hospital_parent_id, ''),\n            COALESCE(pg_parent_id, '')\n        ), 256) AS source_hash,\n        CASE WHEN UPPER(company_status) = 'ACTIVE' THEN 'Y' ELSE 'N' END AS is_active,\n        CURRENT_TIMESTAMP() AS load_timestamp,\n        CURRENT_DATE AS data_date\n    FROM {{ ref('std_dh_hco') }}\n),\n\n-- Get current version from history for each entity\nhist_current AS (\n    SELECT dh_id, version_number, source_hash\n    FROM {{ this }}\n    WHERE is_current = 'Y'\n),\n\n-- Find records that changed (new hash != existing hash) or are new\nchanged_records AS (\n    SELECT\n        c.*,\n        h.version_number AS prev_version,\n        h.source_hash AS prev_hash\n    FROM current_source c\n    LEFT JOIN hist_current h ON c.dh_id = h.dh_id\n    WHERE h.source_hash IS NULL  -- New entity\n       OR h.source_hash != c.source_hash  -- Changed entity\n),\n\n-- Soft-delete detection: Entities in history but no longer in current source\nsoft_deleted AS (\n    SELECT\n        h.*,\n        h.version_number AS prev_version,\n        h.source_hash AS prev_hash\n    FROM {{ this }} h\n    WHERE h.is_current = 'Y'\n      AND NOT EXISTS (\n          SELECT 1 FROM current_source c\n          WHERE c.dh_id = h.dh_id\n      )\n),\n\n-- Close previous versions when new version is created\nrecords_to_close AS (\n    SELECT\n        h.dh_id,\n        h.org_name,\n        h.normalized_org_name,\n        h.company_status,\n        h.firm_type,\n        h.hq_address_line_1,\n        h.hq_address_line_2,\n        h.hq_city,\n        h.hq_state,\n        h.hq_zip_code,\n        h.npi,\n        h.primary_specialty,\n        h.account_type,\n        h.hospital_type,\n        h.hospital_ownership,\n        h.network_id,\n        h.network_name,\n        h.network_firm_type,\n        h.network_parent_id,\n        h.network_parent_name,\n        h.network_parent_firm_type,\n        h.hospital_parent_id,\n        h.hospital_parent_name,\n        h.pg_parent_id,\n        h.pg_parent_name,\n        h.sf_parent_account_id,\n        h.sf_parent_account_name,\n        h.source_hash,\n        h.is_active,\n        h.version_number,\n        h.effective_date,\n        CURRENT_DATE - 1 AS end_date,  -- Close previous version\n        'N' AS is_current,  -- Mark as not current\n        h.load_timestamp,\n        h.data_date\n    FROM {{ this }} h\n    WHERE h.is_current = 'Y'\n      AND h.dh_id IN (SELECT dh_id FROM changed_records)\n)\n\n-- Output new versions for changed records\nSELECT\n    c.dh_id,\n    c.org_name,\n    c.normalized_org_name,\n    c.company_status,\n    c.firm_type,\n    c.hq_address_line_1,\n    c.hq_address_line_2,\n    c.hq_city,\n    c.hq_state,\n    c.hq_zip_code,\n    c.npi,\n    c.primary_specialty,\n    c.account_type,\n    c.hospital_type,\n    c.hospital_ownership,\n    c.network_id,\n    c.network_name,\n    c.network_firm_type,\n    c.network_parent_id,\n    c.network_parent_name,\n    c.network_parent_firm_type,\n    c.hospital_parent_id,\n    c.hospital_parent_name,\n    c.pg_parent_id,\n    c.pg_parent_name,\n    c.sf_parent_account_id,\n    c.sf_parent_account_name,\n    c.source_hash,\n    c.is_active,\n\n    -- SCD2 columns\n    COALESCE(c.prev_version, 0) + 1 AS version_number,\n    CAST(c.load_timestamp AS DATE) AS effective_date,\n    NULL::DATE AS end_date,\n    'Y' AS is_current,\n\n    -- Audit columns\n    c.load_timestamp,\n    c.data_date\n\nFROM changed_records c\n\nUNION ALL\n\n-- Output soft-deleted records (new version with is_active='N')\nSELECT\n    sd.dh_id,\n    sd.org_name,\n    sd.normalized_org_name,\n    sd.company_status,\n    sd.firm_type,\n    sd.hq_address_line_1,\n    sd.hq_address_line_2,\n    sd.hq_city,\n    sd.hq_state,\n    sd.hq_zip_code,\n    sd.npi,\n    sd.primary_specialty,\n    sd.account_type,\n    sd.hospital_type,\n    sd.hospital_ownership,\n    sd.network_id,\n    sd.network_name,\n    sd.network_firm_type,\n    sd.network_parent_id,\n    sd.network_parent_name,\n    sd.network_parent_firm_type,\n    sd.hospital_parent_id,\n    sd.hospital_parent_name,\n    sd.pg_parent_id,\n    sd.pg_parent_name,\n    sd.sf_parent_account_id,\n    sd.sf_parent_account_name,\n    sd.source_hash,\n    'N' AS is_active,  -- Soft-deleted: mark as inactive\n\n    -- SCD2 columns\n    sd.prev_version + 1 AS version_number,\n    CURRENT_DATE AS effective_date,\n    NULL::DATE AS end_date,\n    'Y' AS is_current,\n\n    -- Audit columns\n    CURRENT_TIMESTAMP() AS load_timestamp,\n    CURRENT_DATE AS data_date\n\nFROM soft_deleted sd\n\nUNION ALL\n\n-- Close previous versions (update is_current='N' and set end_date)\nSELECT\n    rtc.dh_id,\n    rtc.org_name,\n    rtc.normalized_org_name,\n    rtc.company_status,\n    rtc.firm_type,\n    rtc.hq_address_line_1,\n    rtc.hq_address_line_2,\n    rtc.hq_city,\n    rtc.hq_state,\n    rtc.hq_zip_code,\n    rtc.npi,\n    rtc.primary_specialty,\n    rtc.account_type,\n    rtc.hospital_type,\n    rtc.hospital_ownership,\n    rtc.network_id,\n    rtc.network_name,\n    rtc.network_firm_type,\n    rtc.network_parent_id,\n    rtc.network_parent_name,\n    rtc.network_parent_firm_type,\n    rtc.hospital_parent_id,\n    rtc.hospital_parent_name,\n    rtc.pg_parent_id,\n    rtc.pg_parent_name,\n    rtc.sf_parent_account_id,\n    rtc.sf_parent_account_name,\n    rtc.source_hash,\n    rtc.is_active,\n    rtc.version_number,\n    rtc.effective_date,\n    rtc.end_date,\n    rtc.is_current,\n    rtc.load_timestamp,\n    rtc.data_date\nFROM records_to_close rtc\n\n{% else %}\n-- ============================================================================\n-- INITIAL LOAD: Bootstrap from existing TEST table (migration already done)\n-- ============================================================================\n-- NOTE: The initial migration from DEV has been completed.\n-- This branch reads from the existing TEST table to preserve that data.\n-- If the table doesn't exist, it starts fresh from std_dh_hco.\n\nWITH current_source AS (\n    SELECT\n        dh_id,\n        org_name,\n        {{ standardize_org_name('org_name') }} AS normalized_org_name,\n        company_status,\n        firm_type,\n        hq_address_line_1,\n        hq_address_line_2,\n        hq_city,\n        hq_state,\n        hq_zip_code,\n        npi,\n        primary_specialty,\n        NULL AS account_type,  -- Removed from std_dh_hco; kept for schema compatibility\n        hospital_type,\n        hospital_ownership,\n        network_id,\n        network_name,\n        network_firm_type,\n        network_parent_id,\n        network_parent_name,\n        network_parent_firm_type,\n        hospital_parent_id,\n        hospital_parent_name,\n        pg_parent_id,\n        pg_parent_name,\n        sf_parent_account_id,\n        sf_parent_account_name,\n        SHA2(CONCAT_WS('|',\n            COALESCE(dh_id, ''),\n            COALESCE(org_name, ''),\n            COALESCE(firm_type, ''),\n            COALESCE(hq_address_line_1, ''),\n            COALESCE(hq_city, ''),\n            COALESCE(hq_state, ''),\n            COALESCE(hq_zip_code, ''),\n            COALESCE(npi, ''),\n            COALESCE(network_id, ''),\n            COALESCE(hospital_parent_id, ''),\n            COALESCE(pg_parent_id, '')\n        ), 256) AS source_hash,\n        CASE WHEN UPPER(company_status) = 'ACTIVE' THEN 'Y' ELSE 'N' END AS is_active,\n        CURRENT_TIMESTAMP() AS load_timestamp,\n        CURRENT_DATE AS data_date\n    FROM {{ ref('std_dh_hco') }}\n)\n\nSELECT\n    dh_id,\n    org_name,\n    normalized_org_name,\n    company_status,\n    firm_type,\n    hq_address_line_1,\n    hq_address_line_2,\n    hq_city,\n    hq_state,\n    hq_zip_code,\n    npi,\n    primary_specialty,\n    account_type,\n    hospital_type,\n    hospital_ownership,\n    network_id,\n    network_name,\n    network_firm_type,\n    network_parent_id,\n    network_parent_name,\n    network_parent_firm_type,\n    hospital_parent_id,\n    hospital_parent_name,\n    pg_parent_id,\n    pg_parent_name,\n    sf_parent_account_id,\n    sf_parent_account_name,\n    source_hash,\n    is_active,\n\n    -- SCD2 columns (initial load = version 1)\n    1 AS version_number,\n    CAST(load_timestamp AS DATE) AS effective_date,\n    NULL::DATE AS end_date,\n    'Y' AS is_current,\n\n    -- Audit columns\n    load_timestamp,\n    data_date\n\nFROM current_source\n\n{% endif %}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.is_incremental", "macro.CGOncology_MDM.standardize_org_name"], "nodes": ["model.CGOncology_MDM.std_dh_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["dh_id", "version_number"], "time_spine": null}, "model.CGOncology_MDM.std_rx_claims": {"database": "CGONCOLOGY_TEST", "schema": "STANDARDIZATION", "name": "std_rx_claims", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "standardization/std_rx_claims.sql", "original_file_path": "models/standardization/std_rx_claims.sql", "unique_id": "model.CGOncology_MDM.std_rx_claims", "fqn": ["CGOncology_MDM", "standardization", "std_rx_claims"], "alias": "std_rx_claims", "checksum": {"name": "sha256", "checksum": "d9c4c2631455ecd3f09c9e25b2fc15a4d6b4adf837474acd3ccb4887f3343b53"}, "config": {"enabled": true, "alias": null, "schema": "STANDARDIZATION", "database": null, "tags": ["layer_1_standardization", "customer_backbone", "customer_backbone", "bladder_cancer", "BC Patient", "customer_backbone", "bladder_cancer", "BC Patient"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_1_standardization", "customer_backbone", "bladder_cancer", "BC Patient"], "description": "CBR-CB-023: Standardized RX claims. NOTE: RX_CLAIM_ID is NOT unique - same claim_id can appear multiple times in source data.", "columns": {"RX_CLAIM_ID": {"name": "RX_CLAIM_ID", "description": "Prescription claim identifier (NOT unique in source)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PATIENT_ID": {"name": "PATIENT_ID", "description": "Patient identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "FILL_DATE": {"name": "FILL_DATE", "description": "Prescription fill date", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "NDC11": {"name": "NDC11", "description": "11-digit National Drug Code", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PRODUCT_NAME": {"name": "PRODUCT_NAME", "description": "Drug product name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "TREATMENT_CATEGORY": {"name": "TREATMENT_CATEGORY", "description": "BC treatment category from seed_bc_rx_ndc_mapping (NULL if not BC-related)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PATIENT_GENDER": {"name": "PATIENT_GENDER", "description": "Patient gender", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/standardization/schema.yml", "build_path": null, "unrendered_config": {"schema": "STANDARDIZATION", "materialized": "table", "tags": ["customer_backbone", "bladder_cancer", "BC Patient"]}, "created_at": 1770177079.432829, "relation_name": "CGONCOLOGY_TEST.STANDARDIZATION.std_rx_claims", "raw_code": "{{ config(\n    schema='STANDARDIZATION',\n    materialized='table',\n    tags=['customer_backbone', 'bladder_cancer', 'BC Patient']\n) }}\n\n/*\nSTD-RX-001: Standardize RX claims\nBusiness Rules: STD-RX-001, STD-RX-002\n\nGrain: One row per (RX_CLAIM_ID, NDC11)\n\nSTD-RX-002 - Source Deduplication:\n- Removed DELIVERABLE column (source batch - not used downstream)\n- Source has 302 duplicates where same claim+NDC has different PROVIDER_PRESCRIBING_NPI (one NULL, one non-NULL)\n- QUALIFY picks the row with non-NULL NPI when duplicates exist\n- Verified: Zero claims lost (Jan 2026)\n*/\n\nWITH deduped AS (\n    SELECT DISTINCT\n        CAST(r.RX_CLAIM_ID AS VARCHAR) AS RX_CLAIM_ID,\n        CAST(r.PATIENT_ID AS VARCHAR) AS PATIENT_ID,\n        r.FILL_DATE,\n        r.FILL_YEAR,\n        r.FILL_MONTH,\n        r.NDC11,\n        r.PRODUCT_NAME,\n        r.BRAND_NAME,\n        r.GENERIC_NAME,\n        -- Treatment category from seed (NULL if not BC-related)\n        m.TREATMENT_CATEGORY,\n        r.PRODUCT_FORM,\n        r.PRODUCT_STRENGTH,\n        r.PATIENT_PRIMARY_PAYOR_NAME,\n        CAST(r.PATIENT_PRIMARY_PAYOR_DH_ID AS VARCHAR) AS PATIENT_PRIMARY_PAYOR_DH_ID,\n        r.PATIENT_PRIMARY_PAYOR_TYPE,\n        r.PATIENT_GENDER,\n        r.PATIENT_BIRTH_YEAR,\n        r.PATIENT_ZIP3,\n        -- NPI column: Cast from NUMBER to VARCHAR (preland RX has NUMBER type)\n        CAST(r.PROVIDER_PRESCRIBING_NPI AS VARCHAR) AS PROVIDER_PRESCRIBING_NPI\n        -- Removed: r.DELIVERABLE (source batch - not used downstream)\n    FROM {{ source('raw_dh', 'PRELAND_DH_BLADDERCANCER_RX') }} r\n    LEFT JOIN {{ ref('seed_bc_rx_ndc_mapping') }} m\n        ON r.NDC11 = m.NDC11\n        -- NOTE: BC_PATIENT_POOL_FLAG filter removed - all codes get TREATMENT_CATEGORY\n        -- Flag='Y' check moved to std_rx_bc_patients for BC patient pool determination\n)\nSELECT *\nFROM deduped\nQUALIFY ROW_NUMBER() OVER (\n    PARTITION BY RX_CLAIM_ID, NDC11\n    ORDER BY PROVIDER_PRESCRIBING_NPI NULLS LAST  -- Prefer non-NULL NPI\n) = 1", "doc_blocks": [], "language": "sql", "refs": [{"name": "seed_bc_rx_ndc_mapping", "package": null, "version": null}], "sources": [["raw_dh", "PRELAND_DH_BLADDERCANCER_RX"]], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["source.CGOncology_MDM.raw_dh.PRELAND_DH_BLADDERCANCER_RX", "seed.CGOncology_MDM.seed_bc_rx_ndc_mapping"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}, "model.CGOncology_MDM.std_dh_hcp_hist": {"database": "CGONCOLOGY_TEST", "schema": "STANDARDIZATION", "name": "std_dh_hcp_hist", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "standardization/std_dh_hcp_hist.sql", "original_file_path": "models/standardization/std_dh_hcp_hist.sql", "unique_id": "model.CGOncology_MDM.std_dh_hcp_hist", "fqn": ["CGOncology_MDM", "standardization", "std_dh_hcp_hist"], "alias": "std_dh_hcp_hist", "checksum": {"name": "sha256", "checksum": "16885e839e72671836a6b0a452f01040f5b1dbc679c65d4d2bac49e0d5adb8e7"}, "config": {"enabled": true, "alias": null, "schema": "STANDARDIZATION", "database": null, "tags": ["layer_1_standardization", "customer_backbone", "customer_backbone", "standardization", "history", "customer_backbone", "standardization", "history"], "meta": {}, "group": null, "materialized": "incremental", "incremental_strategy": "merge", "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": ["npi", "version_number"], "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_1_standardization", "customer_backbone", "standardization", "history"], "description": "SCD2 history for DH HCP. Bootstrapped from DEV.STAGING. 7,876,429 rows, 3,230,829 unique HCPs.", "columns": {"npi": {"name": "npi", "description": "National Provider Identifier (primary HCP identifier)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "version_number": {"name": "version_number", "description": "SCD2 version number per entity (starts at 1)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "is_current": {"name": "is_current", "description": "Y for latest version per entity", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "is_active": {"name": "is_active", "description": "Y if entity in current source, N if soft-deleted", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/standardization/schema.yml", "build_path": null, "unrendered_config": {"schema": "STANDARDIZATION", "materialized": "incremental", "tags": ["customer_backbone", "standardization", "history"], "unique_key": ["npi", "version_number"], "incremental_strategy": "merge"}, "created_at": 1770177079.437333, "relation_name": "CGONCOLOGY_TEST.STANDARDIZATION.std_dh_hcp_hist", "raw_code": "{{\n    config(\n        schema='STANDARDIZATION',\n        materialized='incremental',\n        unique_key=['npi', 'version_number'],\n        incremental_strategy='merge',\n        tags=['customer_backbone', 'standardization', 'history']\n    )\n}}\n\n/*\nSTD_DH_HCP_HIST - DH HCP History Table with SCD2 Columns\nProcess Code: PROC-STD-DH-HCP-HIST\nBusiness Rules: SCD-001 to SCD-015, SCD-023\n\nPurpose: Track SCD2 history of DH HCP (physician) records.\n\nGrain: One row per (npi, version_number)\n\nSource: std_dh_hcp (standardized current data)\n\nSCD2 Columns:\n- version_number: Sequential per entity\n- effective_date: When this version became effective\n- end_date: NULL for current version\n- is_current: 'Y' for latest version per entity\n- source_hash: SHA2 of key business columns for change detection\n- is_active: 'Y' for all records (assume active unless explicitly marked)\n\nUPDATED 2026-01-16: Fixed column names to match std_dh_hcp schema.\nUPDATED 2026-02-03: Added soft-delete detection + records_to_close (matching std_dh_hco_hist pattern).\n  Previously, HCPs removed from source stayed IS_CURRENT='Y' forever, and old versions\n  were never closed when new versions were created.\n*/\n\n{% if is_incremental() %}\n-- ============================================================================\n-- INCREMENTAL: Append new versions when std_dh_hcp records change\n-- ============================================================================\n\nWITH current_source AS (\n    SELECT\n        npi,\n        NULL::VARCHAR(50) AS dh_id,  -- Legacy column: HCPs don't have DH_IDs (use NPI)\n        first_name,\n        middle_name,\n        last_name,\n        gender,\n        credential,\n        primary_specialty,\n        secondary_specialty,\n        primary_specialty_group,\n        primary_affiliation_hospital_id,\n        primary_affiliation_hospital_name,\n        largest_pg_affiliation_id,\n        largest_pg_affiliation_name,\n        primary_practice_location_name,\n        practice_address_line_1,\n        practice_address_line_2,\n        practice_city,\n        practice_state,\n        practice_zip_code,\n        source_hash,\n        load_date,\n        data_date,\n        'Y' AS is_active\n    FROM {{ ref('std_dh_hcp') }}\n    WHERE npi IS NOT NULL\n),\n\n-- Get current version from history for each entity\nhist_current AS (\n    SELECT npi, version_number, source_hash\n    FROM {{ this }}\n    WHERE is_current = 'Y'\n),\n\n-- Find records that changed (new hash != existing hash) or are new\nchanged_records AS (\n    SELECT\n        c.*,\n        h.version_number AS prev_version,\n        h.source_hash AS prev_hash\n    FROM current_source c\n    LEFT JOIN hist_current h ON c.npi = h.npi\n    WHERE h.source_hash IS NULL  -- New entity\n       OR h.source_hash != c.source_hash  -- Changed entity\n),\n\n-- Soft-delete detection: Entities in history but no longer in current source\n-- Only pick the latest version per NPI, and only if still active (not already soft-deleted)\nsoft_deleted AS (\n    SELECT\n        h.*,\n        h.version_number AS prev_version\n    FROM {{ this }} h\n    WHERE h.is_current = 'Y'\n      AND h.is_active = 'Y'  -- Skip already soft-deleted records\n      AND NOT EXISTS (\n          SELECT 1 FROM current_source c\n          WHERE c.npi = h.npi\n      )\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY h.npi ORDER BY h.version_number DESC) = 1\n),\n\n-- Close previous versions when new version is created\nrecords_to_close AS (\n    SELECT\n        h.npi,\n        h.dh_id,\n        h.first_name,\n        h.middle_name,\n        h.last_name,\n        h.gender,\n        h.credential,\n        h.primary_specialty,\n        h.secondary_specialty,\n        h.primary_specialty_group,\n        h.primary_affiliation_hospital_id,\n        h.primary_affiliation_hospital_name,\n        h.largest_pg_affiliation_id,\n        h.largest_pg_affiliation_name,\n        h.primary_practice_location_name,\n        h.practice_address_line_1,\n        h.practice_address_line_2,\n        h.practice_city,\n        h.practice_state,\n        h.practice_zip_code,\n        h.source_hash,\n        h.is_active,\n        h.version_number,\n        h.effective_date,\n        CURRENT_DATE - 1 AS end_date,\n        'N' AS is_current,\n        h.load_timestamp,\n        h.data_date\n    FROM {{ this }} h\n    WHERE h.is_current = 'Y'\n      AND (\n          h.npi IN (SELECT npi FROM changed_records)\n          OR h.npi IN (SELECT npi FROM soft_deleted)\n      )\n    -- Only close the most recent version per NPI (avoid duplicate keys in MERGE)\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY h.npi ORDER BY h.version_number DESC) = 1\n)\n\n-- Output new versions for changed records\nSELECT\n    c.npi,\n    c.dh_id,\n    c.first_name,\n    c.middle_name,\n    c.last_name,\n    c.gender,\n    c.credential,\n    c.primary_specialty,\n    c.secondary_specialty,\n    c.primary_specialty_group,\n    c.primary_affiliation_hospital_id,\n    c.primary_affiliation_hospital_name,\n    c.largest_pg_affiliation_id,\n    c.largest_pg_affiliation_name,\n    c.primary_practice_location_name,\n    c.practice_address_line_1,\n    c.practice_address_line_2,\n    c.practice_city,\n    c.practice_state,\n    c.practice_zip_code,\n    c.source_hash,\n    c.is_active,\n    COALESCE(c.prev_version, 0) + 1 AS version_number,\n    c.data_date AS effective_date,\n    NULL::DATE AS end_date,\n    'Y' AS is_current,\n    c.load_date AS load_timestamp,\n    c.data_date\n\nFROM changed_records c\n\nUNION ALL\n\n-- Output soft-deleted records (new version with is_active='N')\nSELECT\n    sd.npi,\n    sd.dh_id,\n    sd.first_name,\n    sd.middle_name,\n    sd.last_name,\n    sd.gender,\n    sd.credential,\n    sd.primary_specialty,\n    sd.secondary_specialty,\n    sd.primary_specialty_group,\n    sd.primary_affiliation_hospital_id,\n    sd.primary_affiliation_hospital_name,\n    sd.largest_pg_affiliation_id,\n    sd.largest_pg_affiliation_name,\n    sd.primary_practice_location_name,\n    sd.practice_address_line_1,\n    sd.practice_address_line_2,\n    sd.practice_city,\n    sd.practice_state,\n    sd.practice_zip_code,\n    sd.source_hash,\n    'N' AS is_active,\n    sd.prev_version + 1 AS version_number,\n    CURRENT_DATE AS effective_date,\n    NULL::DATE AS end_date,\n    'Y' AS is_current,\n    CURRENT_TIMESTAMP() AS load_timestamp,\n    CURRENT_DATE AS data_date\n\nFROM soft_deleted sd\n\nUNION ALL\n\n-- Close previous versions (update is_current='N' and set end_date)\nSELECT\n    rtc.npi,\n    rtc.dh_id,\n    rtc.first_name,\n    rtc.middle_name,\n    rtc.last_name,\n    rtc.gender,\n    rtc.credential,\n    rtc.primary_specialty,\n    rtc.secondary_specialty,\n    rtc.primary_specialty_group,\n    rtc.primary_affiliation_hospital_id,\n    rtc.primary_affiliation_hospital_name,\n    rtc.largest_pg_affiliation_id,\n    rtc.largest_pg_affiliation_name,\n    rtc.primary_practice_location_name,\n    rtc.practice_address_line_1,\n    rtc.practice_address_line_2,\n    rtc.practice_city,\n    rtc.practice_state,\n    rtc.practice_zip_code,\n    rtc.source_hash,\n    rtc.is_active,\n    rtc.version_number,\n    rtc.effective_date,\n    rtc.end_date,\n    rtc.is_current,\n    rtc.load_timestamp,\n    rtc.data_date\nFROM records_to_close rtc\n\n{% else %}\n-- ============================================================================\n-- INITIAL LOAD: Create history from current std_dh_hcp\n-- ============================================================================\n\nSELECT\n    npi,\n    NULL::VARCHAR(50) AS dh_id,  -- Legacy column: HCPs don't have DH_IDs (use NPI)\n    first_name,\n    middle_name,\n    last_name,\n    gender,\n    credential,\n    primary_specialty,\n    secondary_specialty,\n    primary_specialty_group,\n    primary_affiliation_hospital_id,\n    primary_affiliation_hospital_name,\n    largest_pg_affiliation_id,\n    largest_pg_affiliation_name,\n    primary_practice_location_name,\n    practice_address_line_1,\n    practice_address_line_2,\n    practice_city,\n    practice_state,\n    practice_zip_code,\n    source_hash,\n    'Y' AS is_active,\n    1 AS version_number,\n    data_date AS effective_date,\n    NULL::DATE AS end_date,\n    'Y' AS is_current,\n    load_date AS load_timestamp,\n    data_date\n\nFROM {{ ref('std_dh_hcp') }}\nWHERE npi IS NOT NULL\n\n{% endif %}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.CGOncology_MDM.std_dh_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["npi", "version_number"], "time_spine": null}, "model.CGOncology_MDM.std_dx_claims": {"database": "CGONCOLOGY_TEST", "schema": "STANDARDIZATION", "name": "std_dx_claims", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "standardization/std_dx_claims.sql", "original_file_path": "models/standardization/std_dx_claims.sql", "unique_id": "model.CGOncology_MDM.std_dx_claims", "fqn": ["CGOncology_MDM", "standardization", "std_dx_claims"], "alias": "std_dx_claims", "checksum": {"name": "sha256", "checksum": "c008e73ed05ec94173a1be6f97bd9485e309a0ca1178789599f524d64342d904"}, "config": {"enabled": true, "alias": null, "schema": "STANDARDIZATION", "database": null, "tags": ["layer_1_standardization", "customer_backbone", "customer_backbone", "bladder_cancer", "BC Patient", "customer_backbone", "bladder_cancer", "BC Patient"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_1_standardization", "customer_backbone", "bladder_cancer", "BC Patient"], "description": "CBR-CB-021: Standardized DX claims. NOTE: MX_CLAIM_ID is NOT unique - same claim_id can appear multiple times in source data.", "columns": {"MX_CLAIM_ID": {"name": "MX_CLAIM_ID", "description": "Diagnosis claim identifier (NOT unique in source)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PATIENT_ID": {"name": "PATIENT_ID", "description": "Patient identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "SERVICE_DATE": {"name": "SERVICE_DATE", "description": "Date of service", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "DIAGNOSIS_CODE": {"name": "DIAGNOSIS_CODE", "description": "ICD diagnosis code", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "TREATMENT_CATEGORY": {"name": "TREATMENT_CATEGORY", "description": "BC treatment category from seed_bc_dx_code_mapping (NULL if not BC-related)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PATIENT_GENDER": {"name": "PATIENT_GENDER", "description": "Patient gender", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/standardization/schema.yml", "build_path": null, "unrendered_config": {"schema": "STANDARDIZATION", "materialized": "table", "tags": ["customer_backbone", "bladder_cancer", "BC Patient"]}, "created_at": 1770177079.431365, "relation_name": "CGONCOLOGY_TEST.STANDARDIZATION.std_dx_claims", "raw_code": "{{ config(\n    schema='STANDARDIZATION',\n    materialized='table',\n    tags=['customer_backbone', 'bladder_cancer', 'BC Patient']\n) }}\n\n/*\nSTD-DX-001: Standardize DX claims\nBusiness Rules: STD-DX-001, STD-DX-002\n\nGrain: One row per (MX_CLAIM_ID, DIAGNOSIS_CODE)\n\nSTD-DX-002 - Source Deduplication:\n- Source has duplicates: same claim+diagnosis with different indicators (PRIMARY vs ADMITTING)\n- Removed indicator columns (not used downstream) so SELECT DISTINCT dedupes efficiently\n- Verified: Zero claims lost (Jan 2026)\n*/\n\nSELECT DISTINCT\n    CAST(d.MX_CLAIM_ID AS VARCHAR) AS MX_CLAIM_ID,\n    CAST(d.PATIENT_ID AS VARCHAR) AS PATIENT_ID,\n    d.SERVICE_DATE,\n    d.SERVICE_YEAR,\n    d.SERVICE_MONTH,\n    d.CLAIM_TYPE,\n    d.DIAGNOSIS_CODE,\n    d.DIAGNOSIS_DESCRIPTION,\n    -- Treatment category from seed (NULL if not BC-related)\n    m.TREATMENT_CATEGORY,\n    d.SERVICE_LOCATION_CODE,\n    d.SERVICE_LOCATION_DESCRIPTION,\n    d.PATIENT_PRIMARY_PAYOR_NAME,\n    CAST(d.PATIENT_PRIMARY_PAYOR_DH_ID AS VARCHAR) AS PATIENT_PRIMARY_PAYOR_DH_ID,\n    d.PATIENT_PRIMARY_PAYOR_TYPE,\n    d.PATIENT_GENDER,\n    d.PATIENT_BIRTH_YEAR,\n    d.PATIENT_ZIP3,\n    -- NPI columns: Cast to VARCHAR for consistency (preland DX has TEXT type)\n    CAST(d.PROVIDER_FACILITY_NPI AS VARCHAR) AS PROVIDER_FACILITY_NPI,\n    CAST(d.PROVIDER_BILLING_NPI AS VARCHAR) AS PROVIDER_BILLING_NPI,\n    d.PROVIDER_BILLING_DH_ID,\n    CAST(d.PROVIDER_RENDERING_NPI AS VARCHAR) AS PROVIDER_RENDERING_NPI,\n    -- SCD2: Track source batch\n    d.DELIVERABLE\nFROM {{ source('raw_dh', 'PRELAND_DH_BLADDERCANCER_HXMX_DIAGNOSIS') }} d\nLEFT JOIN {{ ref('seed_bc_dx_code_mapping') }} m\n    ON d.DIAGNOSIS_CODE = m.DIAGNOSIS_CODE\n    -- NOTE: BC_PATIENT_POOL_FLAG filter removed - all codes get TREATMENT_CATEGORY\n    -- Flag='Y' check moved to std_dx_bc_patients for BC patient pool determination", "doc_blocks": [], "language": "sql", "refs": [{"name": "seed_bc_dx_code_mapping", "package": null, "version": null}], "sources": [["raw_dh", "PRELAND_DH_BLADDERCANCER_HXMX_DIAGNOSIS"]], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["source.CGOncology_MDM.raw_dh.PRELAND_DH_BLADDERCANCER_HXMX_DIAGNOSIS", "seed.CGOncology_MDM.seed_bc_dx_code_mapping"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}, "model.CGOncology_MDM.std_dh_hcp_hco_affiliation_hist": {"database": "CGONCOLOGY_TEST", "schema": "STANDARDIZATION", "name": "std_dh_hcp_hco_affiliation_hist", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "standardization/std_dh_hcp_hco_affiliation_hist.sql", "original_file_path": "models/standardization/std_dh_hcp_hco_affiliation_hist.sql", "unique_id": "model.CGOncology_MDM.std_dh_hcp_hco_affiliation_hist", "fqn": ["CGOncology_MDM", "standardization", "std_dh_hcp_hco_affiliation_hist"], "alias": "std_dh_hcp_hco_affiliation_hist", "checksum": {"name": "sha256", "checksum": "760c64e549c3f2c47119f9df02592c8860eb5f4c7146117c15aea208650aa577"}, "config": {"enabled": true, "alias": null, "schema": "STANDARDIZATION", "database": null, "tags": ["layer_1_standardization", "customer_backbone", "customer_backbone", "standardization", "history", "customer_backbone", "standardization", "history"], "meta": {}, "group": null, "materialized": "incremental", "incremental_strategy": "merge", "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": ["npi", "affiliated_id", "source_hash"], "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_1_standardization", "customer_backbone", "standardization", "history"], "description": "SCD2 history for DH HCP-HCO affiliations. 43,377,234 rows.", "columns": {"npi": {"name": "npi", "description": "HCP NPI number", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "affiliated_id": {"name": "affiliated_id", "description": "Affiliated HCO DH ID", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "version_number": {"name": "version_number", "description": "SCD2 version number per (dh_id, affiliated_id)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "is_current": {"name": "is_current", "description": "Y for latest version per affiliation", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/standardization/schema.yml", "build_path": null, "unrendered_config": {"schema": "STANDARDIZATION", "materialized": "incremental", "tags": ["customer_backbone", "standardization", "history"], "unique_key": ["npi", "affiliated_id", "source_hash"], "incremental_strategy": "merge"}, "created_at": 1770177079.437967, "relation_name": "CGONCOLOGY_TEST.STANDARDIZATION.std_dh_hcp_hco_affiliation_hist", "raw_code": "{{\n    config(\n        schema='STANDARDIZATION',\n        materialized='incremental',\n        unique_key=['npi', 'affiliated_id', 'source_hash'],\n        incremental_strategy='merge',\n        tags=['customer_backbone', 'standardization', 'history']\n    )\n}}\n\n/*\nSTD_DH_HCP_HCO_AFFILIATION_HIST - DH HCP-HCO Affiliation History Table with SCD2 Columns\nProcess Code: PROC-STD-DH-AFF-HIST\nBusiness Rules: SCD-001 to SCD-015\n\nPurpose: Track SCD2 history of DH HCP-HCO affiliation data.\nGrain: One row per (npi, affiliated_id, source_hash)\n\nSource: {{ ref('std_dh_hcp_hco_affiliation') }} (standardized non-hist model)\n        {{ ref('std_dh_hcp') }} (for first_name, last_name - backward compatibility)\n\nKey Fields:\n- NPI: HCP identifier (provider)\n- AFFILIATED_ID: HCO DH_ID (facility/organization)\n- is_primary_affiliation: Y/N for primary affiliation\n- affiliation_type: Type of affiliation relationship\n- strength_of_affiliation: Numeric strength score (higher = stronger affiliation)\n- length_of_affiliation: Duration of affiliation\n\nSCD2 Columns:\n- version_number: Computed per (npi, affiliated_id) relationship\n- effective_date: Current date for new records\n- end_date: NULL (current record)\n- is_current: 'Y' for latest version per relationship\n- source_hash: Computed from key fields\n- is_active: 'Y' for all records\n\nUPDATED 2026-01-26: Switched from APLD to ref() pattern for proper dbt lineage.\n*/\n\nWITH source_data AS (\n    -- Read from standardized non-hist affiliation model\n    SELECT\n        aff.npi,\n        aff.affiliated_dh_id AS affiliated_id,\n        aff.affiliated_org_name AS affiliated_name,\n        aff.affiliated_firm_type,\n        aff.affiliated_hq_city,\n        aff.affiliated_hq_state,\n        aff.network_id,\n        aff.network_name,\n        -- Convert BOOLEAN to VARCHAR Y/N for hist table compatibility\n        CASE\n            WHEN aff.is_primary_affiliation = TRUE THEN 'Y'\n            WHEN aff.is_primary_affiliation = FALSE THEN 'N'\n            ELSE NULL\n        END AS is_primary_affiliation,\n        aff.affiliation_type,\n        aff.length_of_affiliation,\n        aff.strength_of_affiliation,\n        -- Preserve first_name/last_name from HCP model (backward compatibility)\n        hcp.first_name,\n        hcp.last_name\n    FROM {{ ref('std_dh_hcp_hco_affiliation') }} aff\n    LEFT JOIN {{ ref('std_dh_hcp') }} hcp\n        ON aff.npi = hcp.npi\n),\n\n-- Compute source_hash from standardized columns\nstandardized AS (\n    SELECT\n        npi,\n        first_name,\n        last_name,\n        affiliated_id,\n        affiliated_name,\n        affiliated_firm_type,\n        affiliated_hq_city,\n        affiliated_hq_state,\n        network_id,\n        network_name,\n        is_primary_affiliation,\n        affiliation_type,\n        length_of_affiliation,\n        strength_of_affiliation,\n\n        -- Source hash for CDC\n        SHA2(\n            COALESCE(npi, '') || '|' ||\n            COALESCE(affiliated_id, '') || '|' ||\n            COALESCE(affiliated_name, '') || '|' ||\n            COALESCE(affiliated_firm_type, '') || '|' ||\n            COALESCE(is_primary_affiliation, '') || '|' ||\n            COALESCE(affiliation_type, '') || '|' ||\n            COALESCE(CAST(strength_of_affiliation AS VARCHAR), '')\n        , 256) AS source_hash,\n\n        -- SCD2: is_active\n        'Y' AS is_active\n\n    FROM source_data\n)\n\n{% if is_incremental() %}\n-- Incremental: Only insert records with new source_hash\nSELECT\n    s.npi,\n    s.first_name,\n    s.last_name,\n    s.affiliated_id,\n    s.affiliated_name,\n    s.affiliated_firm_type,\n    s.affiliated_hq_city,\n    s.affiliated_hq_state,\n    s.network_id,\n    s.network_name,\n    s.is_primary_affiliation,\n    s.affiliation_type,\n    s.length_of_affiliation,\n    s.strength_of_affiliation,\n    s.source_hash,\n    s.is_active,\n    -- Version number: max existing + 1\n    COALESCE(h.max_version, 0) + 1 AS version_number,\n    CURRENT_DATE() AS effective_date,\n    NULL AS end_date,\n    'Y' AS is_current,\n    CURRENT_TIMESTAMP() AS load_timestamp,\n    CURRENT_DATE() AS data_date\nFROM standardized s\nLEFT JOIN (\n    SELECT npi, affiliated_id, MAX(version_number) AS max_version\n    FROM {{ this }}\n    GROUP BY npi, affiliated_id\n) h ON s.npi = h.npi AND s.affiliated_id = h.affiliated_id\nWHERE NOT EXISTS (\n    SELECT 1 FROM {{ this }} existing\n    WHERE existing.npi = s.npi\n      AND existing.affiliated_id = s.affiliated_id\n      AND existing.source_hash = s.source_hash\n)\n\n{% else %}\n-- Initial load: All records are version 1\nSELECT\n    npi,\n    first_name,\n    last_name,\n    affiliated_id,\n    affiliated_name,\n    affiliated_firm_type,\n    affiliated_hq_city,\n    affiliated_hq_state,\n    network_id,\n    network_name,\n    is_primary_affiliation,\n    affiliation_type,\n    length_of_affiliation,\n    strength_of_affiliation,\n    source_hash,\n    is_active,\n    1 AS version_number,\n    CURRENT_DATE() AS effective_date,\n    NULL AS end_date,\n    'Y' AS is_current,\n    CURRENT_TIMESTAMP() AS load_timestamp,\n    CURRENT_DATE() AS data_date\nFROM standardized\n\n{% endif %}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hcp_hco_affiliation", "package": null, "version": null}, {"name": "std_dh_hcp", "package": null, "version": null}, {"name": "std_dh_hcp_hco_affiliation", "package": null, "version": null}, {"name": "std_dh_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.CGOncology_MDM.std_dh_hcp_hco_affiliation", "model.CGOncology_MDM.std_dh_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["affiliated_id", "npi", "version_number"], "time_spine": null}, "model.CGOncology_MDM.std_medscout_hcp": {"database": "CGONCOLOGY_TEST", "schema": "STANDARDIZATION", "name": "std_medscout_hcp", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "standardization/std_medscout_hcp.sql", "original_file_path": "models/standardization/std_medscout_hcp.sql", "unique_id": "model.CGOncology_MDM.std_medscout_hcp", "fqn": ["CGOncology_MDM", "standardization", "std_medscout_hcp"], "alias": "std_medscout_hcp", "checksum": {"name": "sha256", "checksum": "487925e59d63ed691490f5e7b5aa2702a9382c59fc92f77ac174d38dc0876d22"}, "config": {"enabled": true, "alias": null, "schema": "STANDARDIZATION", "database": null, "tags": ["layer_1_standardization", "customer_backbone", "customer_backbone", "standardization", "customer_backbone", "standardization"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_1_standardization", "customer_backbone", "standardization"], "description": "PROC-STD-MEDSCOUT-HCP: Medscout HCP Standardization - parses NAME into first/last. Renamed from stg_medscout_hcp (Jan 2026).", "columns": {"medscout_id": {"name": "medscout_id", "description": "Medscout HCP identifier (NPI)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "npi": {"name": "npi", "description": "NPI number", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "last_name": {"name": "last_name", "description": "Last name (parsed from NAME, INITCAP)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/standardization/schema.yml", "build_path": null, "unrendered_config": {"schema": "STANDARDIZATION", "materialized": "table", "tags": ["customer_backbone", "standardization"]}, "created_at": 1770177079.430437, "relation_name": "CGONCOLOGY_TEST.STANDARDIZATION.std_medscout_hcp", "raw_code": "{{\n    config(\n        schema='STANDARDIZATION',\n        materialized='table',\n        tags=['customer_backbone', 'standardization']\n    )\n}}\n\n/*\nPROC-STD-MEDSCOUT-HCP: std_medscout_hcp - Medscout HCP Standardization\nRenamed from stg_medscout_hcp to std_medscout_hcp for naming consistency (Jan 2026).\nSource: raw_medscout.PRELAND_MEDSCOUT_HCP_DATA\nBusiness Rules: STD-010, STD-011, STD-021, STD-022, STD-030\n\nTransformations:\n- STD-010: MEDSCOUT_ID as VARCHAR(50) - using NPI as identifier\n- STD-011: NPI_NUMBER as VARCHAR(20) trimmed\n- STD-021: First name proper case\n- STD-022: Last name proper case (required)\n- STD-030: Convert empty strings to NULL\n\nNote: Source has combined NAME field that needs parsing.\n      First word is first_name, remainder is last_name.\n*/\n\nSELECT\n    -- Primary Key (STD-010) - Use NPI as Medscout identifier\n    CAST(NPI AS VARCHAR(50)) AS medscout_id,\n\n    -- NPI Number (STD-011)\n    NULLIF(TRIM(NPI), '') AS npi,\n\n    -- Parse NAME into first_name and last_name (STD-021, STD-022, STD-030)\n    NULLIF(\n        INITCAP(TRIM(SPLIT_PART(NAME, ' ', 1))),\n        ''\n    ) AS first_name,\n\n    -- Last name is everything after the first space\n    INITCAP(TRIM(\n        CASE\n            WHEN POSITION(' ' IN NAME) > 0\n            THEN SUBSTRING(NAME, POSITION(' ' IN NAME) + 1)\n            ELSE NAME  -- Fallback if no space (single name)\n        END\n    )) AS last_name,\n\n    -- Primary Specialty (STD-030, STD-SPEC-001)\n    NULLIF({{ standardize_specialty('SPECIALTY', 100) }}, '') AS primary_specialty,\n\n    -- Source hash for CDC (PQC-003)\n    SHA2(\n        COALESCE(NPI, '') || '|' ||\n        COALESCE(NAME, '') || '|' ||\n        COALESCE(SPECIALTY, '') || '|' ||\n        COALESCE(CITY, '') || '|' ||\n        COALESCE(STATE, '')\n    , 256) AS source_hash,\n\n    -- Audit columns\n    LOAD_DATE AS load_date,\n    CURRENT_DATE() AS data_date\n\nFROM {{ source('raw_medscout', 'PRELAND_MEDSCOUT_HCP_DATA') }}\nWHERE NPI IS NOT NULL", "doc_blocks": [], "language": "sql", "refs": [], "sources": [["raw_medscout", "PRELAND_MEDSCOUT_HCP_DATA"]], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.CGOncology_MDM.standardize_specialty"], "nodes": ["source.CGOncology_MDM.raw_medscout.PRELAND_MEDSCOUT_HCP_DATA"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["medscout_id"], "time_spine": null}, "model.CGOncology_MDM.std_dx_bc_patients": {"database": "CGONCOLOGY_TEST", "schema": "STANDARDIZATION", "name": "std_dx_bc_patients", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "standardization/std_dx_bc_patients.sql", "original_file_path": "models/standardization/std_dx_bc_patients.sql", "unique_id": "model.CGOncology_MDM.std_dx_bc_patients", "fqn": ["CGOncology_MDM", "standardization", "std_dx_bc_patients"], "alias": "std_dx_bc_patients", "checksum": {"name": "sha256", "checksum": "bdcf53a2ac4974ea58127f6cfbc731621dce7dda7ad3b56d7c6944ac0ebb5815"}, "config": {"enabled": true, "alias": null, "schema": "STANDARDIZATION", "database": null, "tags": ["layer_1_standardization", "customer_backbone", "customer_backbone", "bladder_cancer", "BC Patient", "customer_backbone", "bladder_cancer", "BC Patient"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_1_standardization", "customer_backbone", "bladder_cancer", "BC Patient"], "description": "CBR-CB-024: BC patients identified via diagnosis codes (BC_PATIENT_POOL_FLAG='Y')", "columns": {"PATIENT_ID": {"name": "PATIENT_ID", "description": "Patient identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "EARLIEST_DX_DATE": {"name": "EARLIEST_DX_DATE", "description": "First BC diagnosis date", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "UNIQUE_DX_CODE_COUNT": {"name": "UNIQUE_DX_CODE_COUNT", "description": "Number of unique BC diagnosis codes for this patient", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "DX_CLAIM_COUNT": {"name": "DX_CLAIM_COUNT", "description": "Total BC diagnosis claims for this patient", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "DX_TREATMENT_CATEGORIES": {"name": "DX_TREATMENT_CATEGORIES", "description": "Comma-separated list of treatment categories", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "IDENTIFICATION_SOURCE": {"name": "IDENTIFICATION_SOURCE", "description": "Always 'DX'", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/standardization/schema.yml", "build_path": null, "unrendered_config": {"schema": "STANDARDIZATION", "materialized": "table", "tags": ["customer_backbone", "bladder_cancer", "BC Patient"]}, "created_at": 1770177079.433495, "relation_name": "CGONCOLOGY_TEST.STANDARDIZATION.std_dx_bc_patients", "raw_code": "{{ config(\n    schema='STANDARDIZATION',\n    materialized='table',\n    tags=['customer_backbone', 'bladder_cancer', 'BC Patient']\n) }}\n\n/*\nCBR-CB-024: BC Patient Identification from DX Codes\nIdentify patients with bladder cancer diagnosis codes\nUses TREATMENT_CATEGORY from std_dx_claims (pre-computed from seed)\n*/\n\nWITH bc_dx_claims AS (\n    -- Filter to BC-related claims that qualify for BC patient pool\n    -- Uses BC_PATIENT_POOL_FLAG='Y' from seed to determine pool eligibility\n    SELECT\n        dx.PATIENT_ID,\n        dx.SERVICE_DATE,\n        dx.DIAGNOSIS_CODE,\n        dx.TREATMENT_CATEGORY,\n        dx.PATIENT_GENDER,\n        dx.PATIENT_BIRTH_YEAR,\n        dx.PATIENT_ZIP3\n    FROM {{ ref('std_dx_claims') }} dx\n    INNER JOIN {{ ref('seed_bc_dx_code_mapping') }} m\n        ON dx.DIAGNOSIS_CODE = m.DIAGNOSIS_CODE\n        AND m.BC_PATIENT_POOL_FLAG = 'Y'  -- Only codes that qualify for BC pool\n    WHERE dx.TREATMENT_CATEGORY IS NOT NULL\n),\n\npatient_summary AS (\n    SELECT\n        PATIENT_ID,\n        MIN(SERVICE_DATE) AS EARLIEST_DX_DATE,\n        MAX(SERVICE_DATE) AS LATEST_DX_DATE,\n        COUNT(DISTINCT DIAGNOSIS_CODE) AS UNIQUE_DX_CODE_COUNT,\n        COUNT(*) AS DX_CLAIM_COUNT,\n        LISTAGG(DISTINCT TREATMENT_CATEGORY, ', ') WITHIN GROUP (ORDER BY TREATMENT_CATEGORY) AS DX_TREATMENT_CATEGORIES,\n        MAX(PATIENT_GENDER) AS PATIENT_GENDER,\n        MAX(PATIENT_BIRTH_YEAR) AS PATIENT_BIRTH_YEAR,\n        MAX(PATIENT_ZIP3) AS PATIENT_ZIP3\n    FROM bc_dx_claims\n    GROUP BY PATIENT_ID\n)\n\nSELECT\n    PATIENT_ID,\n    EARLIEST_DX_DATE,\n    LATEST_DX_DATE,\n    UNIQUE_DX_CODE_COUNT,\n    DX_CLAIM_COUNT,\n    DX_TREATMENT_CATEGORIES,\n    PATIENT_GENDER,\n    PATIENT_BIRTH_YEAR,\n    PATIENT_ZIP3,\n    'DX' AS IDENTIFICATION_SOURCE\nFROM patient_summary", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dx_claims", "package": null, "version": null}, {"name": "seed_bc_dx_code_mapping", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.std_dx_claims", "seed.CGOncology_MDM.seed_bc_dx_code_mapping"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["PATIENT_ID"], "time_spine": null}, "model.CGOncology_MDM.std_px_bc_patients": {"database": "CGONCOLOGY_TEST", "schema": "STANDARDIZATION", "name": "std_px_bc_patients", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "standardization/std_px_bc_patients.sql", "original_file_path": "models/standardization/std_px_bc_patients.sql", "unique_id": "model.CGOncology_MDM.std_px_bc_patients", "fqn": ["CGOncology_MDM", "standardization", "std_px_bc_patients"], "alias": "std_px_bc_patients", "checksum": {"name": "sha256", "checksum": "d4289954c62a305f088fe040d474d867072febb8020c3dd90f88573450b35ddc"}, "config": {"enabled": true, "alias": null, "schema": "STANDARDIZATION", "database": null, "tags": ["layer_1_standardization", "customer_backbone", "customer_backbone", "bladder_cancer", "BC Patient", "customer_backbone", "bladder_cancer", "BC Patient"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_1_standardization", "customer_backbone", "bladder_cancer", "BC Patient"], "description": "CBR-CB-025: BC patients identified via procedure codes (BC_PATIENT_POOL_FLAG='Y'). Uses PROCEDURE_CODE only, not NDC11/PRODUCT_NAME.", "columns": {"PATIENT_ID": {"name": "PATIENT_ID", "description": "Patient identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "EARLIEST_PX_DATE": {"name": "EARLIEST_PX_DATE", "description": "First BC procedure date", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "UNIQUE_PX_CODE_COUNT": {"name": "UNIQUE_PX_CODE_COUNT", "description": "Number of unique BC procedure codes for this patient", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PX_CLAIM_COUNT": {"name": "PX_CLAIM_COUNT", "description": "Total BC procedure claims for this patient", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PX_TREATMENT_CATEGORIES": {"name": "PX_TREATMENT_CATEGORIES", "description": "Comma-separated list of treatment categories", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "IDENTIFICATION_SOURCE": {"name": "IDENTIFICATION_SOURCE", "description": "Always 'PX'", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/standardization/schema.yml", "build_path": null, "unrendered_config": {"schema": "STANDARDIZATION", "materialized": "table", "tags": ["customer_backbone", "bladder_cancer", "BC Patient"]}, "created_at": 1770177079.434109, "relation_name": "CGONCOLOGY_TEST.STANDARDIZATION.std_px_bc_patients", "raw_code": "{{ config(\n    schema='STANDARDIZATION',\n    materialized='table',\n    tags=['customer_backbone', 'bladder_cancer', 'BC Patient']\n) }}\n\n/*\nCBR-CB-025: BC Patient Identification from PX Codes\nIdentify patients with bladder cancer procedure codes\nUses TREATMENT_CATEGORY from std_px_claims (pre-computed from seed)\nIMPORTANT: Uses PROCEDURE_CODE only (not NDC11/PRODUCT_NAME)\n*/\n\nWITH bc_px_claims AS (\n    -- Filter to BC-related claims that qualify for BC patient pool\n    -- Uses BC_PATIENT_POOL_FLAG='Y' from seed to determine pool eligibility\n    -- NOTE: CYSTOSCOPY (flag='N') does NOT qualify patients for BC pool\n    SELECT\n        px.PATIENT_ID,\n        px.SERVICE_DATE,\n        px.PROCEDURE_CODE,\n        px.TREATMENT_CATEGORY,\n        px.PATIENT_GENDER,\n        px.PATIENT_BIRTH_YEAR,\n        px.PATIENT_ZIP3\n    FROM {{ ref('std_px_claims') }} px\n    INNER JOIN {{ ref('seed_bc_px_code_mapping') }} m\n        ON px.PROCEDURE_CODE = m.PROCEDURE_CODE\n        AND m.BC_PATIENT_POOL_FLAG = 'Y'  -- Only codes that qualify for BC pool\n    WHERE px.TREATMENT_CATEGORY IS NOT NULL\n),\n\npatient_summary AS (\n    SELECT\n        PATIENT_ID,\n        MIN(SERVICE_DATE) AS EARLIEST_PX_DATE,\n        MAX(SERVICE_DATE) AS LATEST_PX_DATE,\n        COUNT(DISTINCT PROCEDURE_CODE) AS UNIQUE_PX_CODE_COUNT,\n        COUNT(*) AS PX_CLAIM_COUNT,\n        LISTAGG(DISTINCT TREATMENT_CATEGORY, ', ') WITHIN GROUP (ORDER BY TREATMENT_CATEGORY) AS PX_TREATMENT_CATEGORIES,\n        MAX(PATIENT_GENDER) AS PATIENT_GENDER,\n        MAX(PATIENT_BIRTH_YEAR) AS PATIENT_BIRTH_YEAR,\n        MAX(PATIENT_ZIP3) AS PATIENT_ZIP3\n    FROM bc_px_claims\n    GROUP BY PATIENT_ID\n)\n\nSELECT\n    PATIENT_ID,\n    EARLIEST_PX_DATE,\n    LATEST_PX_DATE,\n    UNIQUE_PX_CODE_COUNT,\n    PX_CLAIM_COUNT,\n    PX_TREATMENT_CATEGORIES,\n    PATIENT_GENDER,\n    PATIENT_BIRTH_YEAR,\n    PATIENT_ZIP3,\n    'PX' AS IDENTIFICATION_SOURCE\nFROM patient_summary", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_px_claims", "package": null, "version": null}, {"name": "seed_bc_px_code_mapping", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.std_px_claims", "seed.CGOncology_MDM.seed_bc_px_code_mapping"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["PATIENT_ID"], "time_spine": null}, "model.CGOncology_MDM.std_dh_hcp_hco_affiliation": {"database": "CGONCOLOGY_TEST", "schema": "STANDARDIZATION", "name": "std_dh_hcp_hco_affiliation", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "standardization/std_dh_hcp_hco_affiliation.sql", "original_file_path": "models/standardization/std_dh_hcp_hco_affiliation.sql", "unique_id": "model.CGOncology_MDM.std_dh_hcp_hco_affiliation", "fqn": ["CGOncology_MDM", "standardization", "std_dh_hcp_hco_affiliation"], "alias": "std_dh_hcp_hco_affiliation", "checksum": {"name": "sha256", "checksum": "7965c20f0c669f83dbf10359f0ad711a6b8f8f1bfbddf1b4604be781256a8e34"}, "config": {"enabled": true, "alias": null, "schema": "STANDARDIZATION", "database": null, "tags": ["layer_1_standardization", "customer_backbone", "customer_backbone", "standardization", "customer_backbone", "standardization"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_1_standardization", "customer_backbone", "standardization"], "description": "PROC-STG-006: DH HCP-HCO Affiliation Standardization", "columns": {"npi": {"name": "npi", "description": "HCP NPI number", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "affiliated_dh_id": {"name": "affiliated_dh_id", "description": "Affiliated HCO DH ID", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "affiliation_type": {"name": "affiliation_type", "description": "CURRENT or HISTORICAL", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "is_current": {"name": "is_current", "description": "TRUE if affiliation is current", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/standardization/schema.yml", "build_path": null, "unrendered_config": {"schema": "STANDARDIZATION", "materialized": "table", "tags": ["customer_backbone", "standardization"]}, "created_at": 1770177079.427052, "relation_name": "CGONCOLOGY_TEST.STANDARDIZATION.std_dh_hcp_hco_affiliation", "raw_code": "{{\n    config(\n        schema='STANDARDIZATION',\n        materialized='table',\n        tags=['customer_backbone', 'standardization']\n    )\n}}\n\n/*\nPROC-STG-006: std_dh_hcp_hco_affiliation - HCP-HCO Affiliation Standardization\nSource: raw_dh.PRELAND_DH_PHYSICIANS_FACILITY_AFFILIATION\nBusiness Rules: STD-001 to STD-005, MAT-037\n\nTransformations:\n- STD-001: ZIP Code 5-digit left-padded (when added)\n- STD-002: State 2-char uppercase\n- STD-003: Address uppercase trimmed\n- STD-005: City uppercase trimmed\n- STD-030: Convert empty strings to NULL\n\nAffiliation Data:\n- NPI: HCP identifier (links to std_dh_hcp via NPI)\n- AFFILIATED_ID: HCO DH_ID (links to std_dh_hco)\n- AFFILIATION_TYPE: Current/Historical\n- PRIMARY_AFFILIATED_FACILITY_FLAG: Y/N for primary affiliation\n- STRENTH_OF_AFFILIATION: 1-10 scale (note: typo in source \"STRENTH\")\n*/\n\nSELECT\n    -- HCP identifier (NPI)\n    CAST(NPI AS VARCHAR(20)) AS npi,\n\n    -- HCO identifier (DHC ID)\n    CAST(AFFILIATED_ID AS VARCHAR(50)) AS affiliated_dh_id,\n\n    -- Affiliated organization info\n    NULLIF(UPPER(TRIM(AFFILIATED_NAME)), '') AS affiliated_org_name,\n    NULLIF(UPPER(TRIM(AFFILIATED_FIRM_TYPE)), '') AS affiliated_firm_type,\n    NULLIF(UPPER(TRIM(AFFILIATED_HQ_CITY)), '') AS affiliated_hq_city,\n    NULLIF(UPPER(TRIM(AFFILIATED_HQ_STATE)), '') AS affiliated_hq_state,\n\n    -- Network info\n    NULLIF(CAST(NETWORK_ID AS VARCHAR(50)), '') AS network_id,\n    NULLIF(UPPER(TRIM(NETWORK_NAME)), '') AS network_name,\n\n    -- Affiliation attributes\n    NULLIF(UPPER(TRIM(AFFILIATION_TYPE)), '') AS affiliation_type,\n    CASE\n        WHEN UPPER(TRIM(PRIMARY_AFFILIATED_FACILITY_FLAG)) IN ('Y', 'YES') THEN TRUE\n        WHEN UPPER(TRIM(PRIMARY_AFFILIATED_FACILITY_FLAG)) IN ('N', 'NO') THEN FALSE\n        ELSE NULL\n    END AS is_primary_affiliation,\n    TRY_TO_NUMBER(STRENTH_OF_AFFILIATION) AS strength_of_affiliation,\n    NULLIF(UPPER(TRIM(LENGTH_OF_AFFILIATION)), '') AS length_of_affiliation,\n\n    -- Filter for current affiliations\n    CASE WHEN UPPER(TRIM(AFFILIATION_TYPE)) = 'CURRENT' THEN TRUE ELSE FALSE END AS is_current,\n\n    -- Audit columns\n    CURRENT_DATE() AS load_date,\n    CURRENT_DATE() AS data_date\n\nFROM {{ source('raw_dh', 'PRELAND_DH_PHYSICIANS_FACILITY_AFFILIATION') }}\nWHERE NPI IS NOT NULL\n  AND AFFILIATED_ID IS NOT NULL\n  AND TRIM(CAST(AFFILIATED_ID AS VARCHAR(50))) != ''  -- Exclude empty strings (STD-030)", "doc_blocks": [], "language": "sql", "refs": [], "sources": [["raw_dh", "PRELAND_DH_PHYSICIANS_FACILITY_AFFILIATION"]], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["source.CGOncology_MDM.raw_dh.PRELAND_DH_PHYSICIANS_FACILITY_AFFILIATION"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["affiliated_dh_id", "npi"], "time_spine": null}, "model.CGOncology_MDM.std_ddd_hco": {"database": "CGONCOLOGY_TEST", "schema": "STANDARDIZATION", "name": "std_ddd_hco", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "standardization/std_ddd_hco.sql", "original_file_path": "models/standardization/std_ddd_hco.sql", "unique_id": "model.CGOncology_MDM.std_ddd_hco", "fqn": ["CGOncology_MDM", "standardization", "std_ddd_hco"], "alias": "std_ddd_hco", "checksum": {"name": "sha256", "checksum": "3d9ff11f9e7f9afabf1876dd2e89ee29c4f367c2aabbc3b8708b79892d5b1799"}, "config": {"enabled": true, "alias": null, "schema": "STANDARDIZATION", "database": null, "tags": ["layer_1_standardization", "customer_backbone", "customer_backbone", "standardization", "customer_backbone", "standardization"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_1_standardization", "customer_backbone", "standardization"], "description": "PROC-STD-004: DDD HCO Standardization - DDD outlet data with exclusion flags and CLASS_OF_TRADE.\nNOTE: Model deduplicates by DDD_OUTLET_NO (source has 56 duplicates).\nRow count will be LESS than source due to intentional deduplication.\n", "columns": {"ddd_outlet_id": {"name": "ddd_outlet_id", "description": "DDD outlet identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "ddd_outlet_name": {"name": "ddd_outlet_name", "description": "Outlet name (UPPERCASE)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "zip_code": {"name": "zip_code", "description": "DDD outlet ZIP code (5-digit padded)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "state": {"name": "state", "description": "State (2-char uppercase)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "class_of_trade": {"name": "class_of_trade", "description": "MAT-011: Class of trade for match tie-breaking (CLINICS, HOSPITALS, etc.)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "is_zip_excluded": {"name": "is_zip_excluded", "description": "TRUE if outlet excluded due to ZIP pattern", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "is_supply_chain_excluded": {"name": "is_supply_chain_excluded", "description": "TRUE if outlet excluded due to supply chain category", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/standardization/schema.yml", "build_path": null, "unrendered_config": {"schema": "STANDARDIZATION", "materialized": "table", "tags": ["customer_backbone", "standardization"]}, "created_at": 1770177079.4286442, "relation_name": "CGONCOLOGY_TEST.STANDARDIZATION.std_ddd_hco", "raw_code": "{{\n    config(\n        schema='STANDARDIZATION',\n        materialized='table',\n        tags=['customer_backbone', 'standardization']\n    )\n}}\n\n/*\nPROC-STD-004: std_ddd_hco - DDD HCO Standardization\nSource: raw_ddd.PRELAND_DDD_DEMOGRAPHICS\nBusiness Rules: STD-001 to STD-005, STD-010, STD-020, STD-030, MAT-005, MAT-006, MAT-010\n\nTransformations:\n- STD-001: ZIP Code 5-digit left-padded\n- STD-002: State 2-char uppercase\n- STD-003: Address uppercase trimmed\n- STD-005: City uppercase trimmed\n- STD-006: City normalization via ZIP_CITY_STATE_CONFIG lookup\n- STD-010: DDD_OUTLET_ID as VARCHAR(50)\n- STD-020: Outlet name - preserve original casing (for display)\n- STD-021: Normalized Org Name - UPPER + abbreviation expansion (for matching)\n- STD-025: MULTIPLE DOCTORS name resolution using MII_FACILITY_PRESCRIBER_NAME\n- STD-030: Convert empty strings to NULL\n- MAT-005: Flag ZIP-based exclusions (Z6, Z3 codes via name pattern)\n- MAT-006: Flag supply chain exclusions (S5, W8, A5 via seed config)\n- MAT-010: SUB_CATEGORY for outlet classification\n- MAT-011: CLASS_OF_TRADE for match tie-breaking (CLINICS, HOSPITALS, etc.)\n\nNote: STD-004 abbreviation standardization via UDF (future enhancement)\nBUG-038: Consistent hash pattern\nBUG-041: Document ZIP exclusions\n\nDec 2025: Added sub_category from PRELAND_DDD_SALES and is_supply_chain_excluded\nflag using config_ddd_sub_category seed for business rule maintenance.\n\nJan 2026: Added CLASS_OF_TRADE from config_ddd_sub_category seed for match tie-breaking.\nHospitals prefer HQ Location matches, Clinics prefer Practice Location matches.\nRenamed from stg_ddd_hco to std_ddd_hco for naming consistency.\n*/\n\nWITH source_data AS (\n    SELECT *,\n        ROW_NUMBER() OVER (\n            PARTITION BY DDD_OUTLET_NO\n            ORDER BY LOAD_DATE DESC NULLS LAST\n        ) AS rn,\n        -- Pre-calculate ZIP for join\n        CASE\n            WHEN TRIM(DDD_OUTLET_ZIP) IS NULL OR TRIM(DDD_OUTLET_ZIP) = '' THEN NULL\n            WHEN LPAD(TRIM(REGEXP_REPLACE(DDD_OUTLET_ZIP, '[^0-9]', '')), 5, '0') = '00000' THEN NULL\n            ELSE LPAD(TRIM(REGEXP_REPLACE(DDD_OUTLET_ZIP, '[^0-9]', '')), 5, '0')\n        END AS clean_zip\n    FROM {{ source('raw_ddd', 'PRELAND_DDD_DEMOGRAPHICS') }}\n    WHERE DDD_OUTLET_NO IS NOT NULL\n      AND TRIM(CAST(DDD_OUTLET_NO AS VARCHAR(50))) != ''  -- Exclude empty strings (STD-030)\n),\n\ndeduped_source AS (\n    SELECT * FROM source_data WHERE rn = 1\n),\n\n-- STD-025: Get first non-null facility name for MULTIPLE DOCTORS outlets\n-- 590 of 670 \"MULTIPLE DOCTORS\" outlets have facility names (88% resolution rate)\nfacility_name_lookup AS (\n    SELECT\n        DDD_OUTLET_NO,\n        MII_FACILITY_PRESCRIBER_NAME AS resolved_outlet_name\n    FROM source_data\n    WHERE DDD_OUTLET_NAME = 'MULTIPLE DOCTORS'\n      AND MII_FACILITY_PRESCRIBER_NAME IS NOT NULL\n    QUALIFY ROW_NUMBER() OVER (\n        PARTITION BY DDD_OUTLET_NO\n        ORDER BY LOAD_DATE DESC NULLS LAST\n    ) = 1\n),\n\n-- Get SUB_CATEGORY from sales data (MAT-006, MAT-010)\n-- Note: TRIM required - source data has trailing spaces (length 10 vs 2)\nsub_category_lookup AS (\n    SELECT\n        DDD_OUTLET_NUMBER,\n        TRIM(DDD_SUBCATEGORY_CODE) AS sub_category\n    FROM {{ source('raw_ddd', 'PRELAND_DDD_SALES') }}\n    WHERE DDD_OUTLET_NUMBER IS NOT NULL\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY DDD_OUTLET_NUMBER ORDER BY DATA_DATE DESC) = 1\n)\n\nSELECT\n    -- Primary Key (STD-010)\n    CAST(src.DDD_OUTLET_NO AS VARCHAR(50)) AS ddd_outlet_id,\n\n    -- Outlet Name (STD-020, STD-025) - Resolve MULTIPLE DOCTORS using facility name\n    CASE\n        WHEN TRIM(src.DDD_OUTLET_NAME) = 'MULTIPLE DOCTORS'\n             AND fnl.resolved_outlet_name IS NOT NULL\n        THEN TRIM(fnl.resolved_outlet_name)\n        ELSE TRIM(src.DDD_OUTLET_NAME)\n    END AS ddd_outlet_name,\n\n    -- Normalized Org Name for matching (STD-021, STD-025)\n    -- UPPER + expands abbreviations: CTR\u2192CENTER, HOSP\u2192HOSPITAL, MED\u2192MEDICAL, etc.\n    {{ standardize_org_name(\n        \"CASE\n            WHEN TRIM(src.DDD_OUTLET_NAME) = 'MULTIPLE DOCTORS'\n                 AND fnl.resolved_outlet_name IS NOT NULL\n            THEN TRIM(fnl.resolved_outlet_name)\n            ELSE TRIM(src.DDD_OUTLET_NAME)\n        END\"\n    ) }} AS normalized_org_name,\n\n    -- Address Standardization (STD-003, STD-004, STD-030)\n    NULLIF({{ standardize_address('src.DDD_OUTLET_ADDRESS') }}, '') AS address_line_1,\n\n    -- City (STD-005, STD-006, STD-030) - Normalized via ZIP_CITY_STATE_CONFIG lookup\n    COALESCE(UPPER(z.PRIMARY_CITY), NULLIF(UPPER(TRIM(src.DDD_OUTLET_CITY)), '')) AS city,\n\n    -- State (STD-002, STD-030)\n    NULLIF(UPPER(TRIM(src.DDD_OUTLET_ST)), '') AS state,\n\n    -- ZIP Code (STD-001, STD-030)\n    src.clean_zip AS zip_code,\n\n    -- SUB_CATEGORY from sales data (MAT-010)\n    COALESCE(sc.sub_category, 'UNKNOWN') AS sub_category,\n\n    -- CLASS_OF_TRADE from seed config (MAT-011)\n    -- Used for match tie-breaking: HOSPITALS prefer HQ, CLINICS prefer Practice Location\n    COALESCE(subcat.class_of_trade, 'UNKNOWN') AS class_of_trade,\n\n    -- ZIP exclusion flag (MAT-005, BUG-041)\n    -- Catches Z6, Z3 codes via outlet name pattern\n    CASE\n        WHEN UPPER(src.DDD_OUTLET_NAME) ILIKE '%ZIP%' THEN TRUE\n        ELSE FALSE\n    END AS is_zip_excluded,\n\n    -- Supply chain exclusion flag (MAT-006)\n    -- Uses seed config for maintainable business rules\n    -- Excludes: S5 (mail service), W8 (supply warehouse), A5 (Kaiser warehouse)\n    -- Keeps: A8 (hospital purchasing agents - can be matched to hospitals)\n    CASE\n        WHEN subcat.is_excluded = 'TRUE' THEN TRUE\n        ELSE FALSE\n    END AS is_supply_chain_excluded,\n\n    -- Source hash for CDC (PQC-003, BUG-038)\n    SHA2(\n        COALESCE(src.DDD_OUTLET_NO, '') || '|' ||\n        COALESCE(src.DDD_OUTLET_NAME, '') || '|' ||\n        COALESCE(src.DDD_OUTLET_ADDRESS, '') || '|' ||\n        COALESCE(src.DDD_OUTLET_CITY, '') || '|' ||\n        COALESCE(src.DDD_OUTLET_ST, '') || '|' ||\n        COALESCE(src.DDD_OUTLET_ZIP, '')\n    , 256) AS source_hash,\n\n    -- Audit columns\n    src.LOAD_DATE AS load_date,\n    CURRENT_DATE() AS data_date\n\nFROM deduped_source src\nLEFT JOIN facility_name_lookup fnl\n    ON src.DDD_OUTLET_NO = fnl.DDD_OUTLET_NO\nLEFT JOIN {{ ref('zip_city_state_config') }} z\n    ON src.clean_zip = z.ZIP\nLEFT JOIN sub_category_lookup sc\n    ON src.DDD_OUTLET_NO = sc.DDD_OUTLET_NUMBER\nLEFT JOIN {{ ref('config_ddd_sub_category') }} subcat\n    ON sc.sub_category = subcat.sub_category", "doc_blocks": [], "language": "sql", "refs": [{"name": "zip_city_state_config", "package": null, "version": null}, {"name": "config_ddd_sub_category", "package": null, "version": null}], "sources": [["raw_ddd", "PRELAND_DDD_DEMOGRAPHICS"], ["raw_ddd", "PRELAND_DDD_SALES"]], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.CGOncology_MDM.standardize_org_name", "macro.CGOncology_MDM.standardize_address"], "nodes": ["source.CGOncology_MDM.raw_ddd.PRELAND_DDD_DEMOGRAPHICS", "source.CGOncology_MDM.raw_ddd.PRELAND_DDD_SALES", "seed.CGOncology_MDM.zip_city_state_config", "seed.CGOncology_MDM.config_ddd_sub_category"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["ddd_outlet_id"], "time_spine": null}, "model.CGOncology_MDM.std_ddd_hco_hist": {"database": "CGONCOLOGY_TEST", "schema": "STANDARDIZATION", "name": "std_ddd_hco_hist", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "standardization/std_ddd_hco_hist.sql", "original_file_path": "models/standardization/std_ddd_hco_hist.sql", "unique_id": "model.CGOncology_MDM.std_ddd_hco_hist", "fqn": ["CGOncology_MDM", "standardization", "std_ddd_hco_hist"], "alias": "std_ddd_hco_hist", "checksum": {"name": "sha256", "checksum": "f6dbb0bc622605352118a3b3963de63f16187495cb564ce1f7e465b931a8a9b6"}, "config": {"enabled": true, "alias": null, "schema": "STANDARDIZATION", "database": null, "tags": ["layer_1_standardization", "customer_backbone", "customer_backbone", "standardization", "history", "customer_backbone", "standardization", "history"], "meta": {}, "group": null, "materialized": "incremental", "incremental_strategy": "merge", "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": ["ddd_outlet_id", "version_number"], "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_1_standardization", "customer_backbone", "standardization", "history"], "description": "SCD2 history for DDD HCO with soft-delete tracking. Full Replace pattern.", "columns": {"ddd_outlet_id": {"name": "ddd_outlet_id", "description": "DDD outlet identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "version_number": {"name": "version_number", "description": "SCD2 version number per entity", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "is_current": {"name": "is_current", "description": "Y for latest version per entity", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "is_active": {"name": "is_active", "description": "Y if in current feed, N if soft-deleted", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/standardization/schema.yml", "build_path": null, "unrendered_config": {"schema": "STANDARDIZATION", "materialized": "incremental", "tags": ["customer_backbone", "standardization", "history"], "unique_key": ["ddd_outlet_id", "version_number"], "incremental_strategy": "merge"}, "created_at": 1770177079.439637, "relation_name": "CGONCOLOGY_TEST.STANDARDIZATION.std_ddd_hco_hist", "raw_code": "{{\n    config(\n        schema='STANDARDIZATION',\n        materialized='incremental',\n        unique_key=['ddd_outlet_id', 'version_number'],\n        incremental_strategy='merge',\n        tags=['customer_backbone', 'standardization', 'history']\n    )\n}}\n\n/*\nSTD_DDD_HCO_HIST - DDD HCO History Table with Proper SCD2 + Soft-Delete\nProcess Code: PROC-STD-DDD-HIST\nBusiness Rules: SCD-001 to SCD-015\n\nPurpose: Track all historical versions of DDD HCO (outlet) data.\nGrain: One row per (ddd_outlet_id, version_number)\n\nSCD2 Columns:\n- version_number: Sequential per entity\n- effective_date: When this version became active\n- end_date: When superseded (9999-12-31 for current)\n- is_current: 'Y' for latest version only\n- source_hash: SHA2 of tracked columns for change detection\n- is_active: 'Y' if in current feed, 'N' if soft-deleted (disappeared from feed)\n\nData Pattern:\n- DDD uses full refresh pattern (complete replacement each load)\n- Entities that disappear from feed are marked as is_active='N' (soft-delete)\n- Changes detected via source_hash comparison\n*/\n\n{% if is_incremental() %}\n\nWITH existing_history AS (\n    SELECT * FROM {{ this }}\n),\n\nexisting_current AS (\n    SELECT * FROM existing_history WHERE is_current = 'Y'\n),\n\nnew_snapshot AS (\n    SELECT\n        s.ddd_outlet_id,\n        s.ddd_outlet_name,\n        s.normalized_org_name,\n        s.address_line_1,\n        s.city,  -- Now normalized via ZIP_CITY_STATE_CONFIG at source\n        s.state,\n        s.zip_code,\n        s.sub_category,\n        s.class_of_trade,  -- MAT-011: For match tie-breaking\n        s.is_zip_excluded,\n        s.is_supply_chain_excluded,\n        s.load_date,\n        s.data_date,\n        -- SCD2: source_hash for change detection\n        SHA2(CONCAT_WS('|',\n            COALESCE(s.ddd_outlet_id, ''),\n            COALESCE(s.ddd_outlet_name, ''),\n            COALESCE(s.sub_category, ''),\n            COALESCE(s.address_line_1, ''),\n            COALESCE(s.city, ''),\n            COALESCE(s.state, ''),\n            COALESCE(s.zip_code, '')\n        ), 256) AS source_hash,\n        'Y' AS is_active  -- Present in current feed\n    FROM {{ ref('std_ddd_hco') }} s  -- Renamed from stg_ddd_hco\n),\n\n-- Entities that changed (new or hash mismatch)\nchanged_records AS (\n    SELECT n.*\n    FROM new_snapshot n\n    LEFT JOIN existing_current e ON n.ddd_outlet_id = e.ddd_outlet_id\n    WHERE e.ddd_outlet_id IS NULL\n       OR e.source_hash != n.source_hash\n),\n\n-- Entities that disappeared from feed (soft-delete)\nsoft_deleted AS (\n    SELECT\n        e.ddd_outlet_id,\n        e.ddd_outlet_name,\n        e.normalized_org_name,\n        e.address_line_1,\n        e.city,\n        e.state,\n        e.zip_code,\n        e.sub_category,\n        e.class_of_trade,  -- MAT-011\n        e.is_zip_excluded,\n        e.is_supply_chain_excluded,\n        e.load_date,\n        CURRENT_DATE() AS data_date,  -- Update data_date for soft-delete\n        e.source_hash,\n        'N' AS is_active,  -- Mark as inactive (soft-deleted)\n        e.version_number + 1 AS version_number,  -- New version for the soft-delete\n        CURRENT_DATE() AS effective_date,\n        DATE('9999-12-31') AS end_date,\n        'Y' AS is_current  -- This soft-delete record is now current\n    FROM existing_current e\n    LEFT JOIN new_snapshot n ON e.ddd_outlet_id = n.ddd_outlet_id\n    WHERE n.ddd_outlet_id IS NULL  -- Not in current feed\n      AND e.is_active = 'Y'  -- Was previously active\n),\n\nmax_versions AS (\n    SELECT ddd_outlet_id, MAX(version_number) AS max_version\n    FROM existing_history\n    GROUP BY ddd_outlet_id\n),\n\n-- Records to close (their new version is in changed_records or soft_deleted)\nrecords_to_close AS (\n    SELECT\n        e.ddd_outlet_id,\n        e.ddd_outlet_name,\n        e.normalized_org_name,\n        e.address_line_1,\n        e.city,\n        e.state,\n        e.zip_code,\n        e.sub_category,\n        e.class_of_trade,  -- MAT-011\n        e.is_zip_excluded,\n        e.is_supply_chain_excluded,\n        e.load_date,\n        e.data_date,\n        e.source_hash,\n        e.is_active,\n        e.version_number,\n        e.effective_date,\n        CURRENT_DATE() - 1 AS end_date,\n        'N' AS is_current\n    FROM existing_current e\n    WHERE e.ddd_outlet_id IN (SELECT ddd_outlet_id FROM changed_records)\n       OR e.ddd_outlet_id IN (SELECT ddd_outlet_id FROM soft_deleted)\n),\n\nnew_versions AS (\n    SELECT\n        c.ddd_outlet_id,\n        c.ddd_outlet_name,\n        c.normalized_org_name,\n        c.address_line_1,\n        c.city,\n        c.state,\n        c.zip_code,\n        c.sub_category,\n        c.class_of_trade,  -- MAT-011\n        c.is_zip_excluded,\n        c.is_supply_chain_excluded,\n        c.load_date,\n        c.data_date,\n        c.source_hash,\n        c.is_active,\n        COALESCE(m.max_version, 0) + 1 AS version_number,\n        CURRENT_DATE() AS effective_date,\n        DATE('9999-12-31') AS end_date,\n        'Y' AS is_current\n    FROM changed_records c\n    LEFT JOIN max_versions m ON c.ddd_outlet_id = m.ddd_outlet_id\n)\n\n-- Final output\nSELECT * FROM existing_history\nWHERE ddd_outlet_id NOT IN (SELECT ddd_outlet_id FROM records_to_close)\n\nUNION ALL\n\nSELECT * FROM records_to_close\n\nUNION ALL\n\nSELECT * FROM new_versions\n\nUNION ALL\n\nSELECT * FROM soft_deleted\n\n{% else %}\n\n-- Initial load: all records are version 1, current, active\nSELECT\n    s.ddd_outlet_id,\n    s.ddd_outlet_name,\n    s.normalized_org_name,\n    s.address_line_1,\n    s.city,\n    s.state,\n    s.zip_code,\n    s.sub_category,\n    s.class_of_trade,  -- MAT-011: For match tie-breaking\n    s.is_zip_excluded,\n    s.is_supply_chain_excluded,\n    s.load_date,\n    s.data_date,\n    SHA2(CONCAT_WS('|',\n        COALESCE(s.ddd_outlet_id, ''),\n        COALESCE(s.ddd_outlet_name, ''),\n        COALESCE(s.sub_category, ''),\n        COALESCE(s.address_line_1, ''),\n        COALESCE(s.city, ''),\n        COALESCE(s.state, ''),\n        COALESCE(s.zip_code, '')\n    ), 256) AS source_hash,\n    'Y' AS is_active,\n    1 AS version_number,\n    CURRENT_DATE() AS effective_date,\n    DATE('9999-12-31') AS end_date,\n    'Y' AS is_current\nFROM {{ ref('std_ddd_hco') }} s  -- Renamed from stg_ddd_hco\n\n{% endif %}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_ddd_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.CGOncology_MDM.std_ddd_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["ddd_outlet_id", "version_number"], "time_spine": null}, "model.CGOncology_MDM.std_medscout_hco_hist": {"database": "CGONCOLOGY_TEST", "schema": "STANDARDIZATION", "name": "std_medscout_hco_hist", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "standardization/std_medscout_hco_hist.sql", "original_file_path": "models/standardization/std_medscout_hco_hist.sql", "unique_id": "model.CGOncology_MDM.std_medscout_hco_hist", "fqn": ["CGOncology_MDM", "standardization", "std_medscout_hco_hist"], "alias": "std_medscout_hco_hist", "checksum": {"name": "sha256", "checksum": "94c7d3901c771e3ff4ffdf20577bdf5ba1baf6f72d3e67cdcf1a3dbfe446ff6c"}, "config": {"enabled": true, "alias": null, "schema": "STANDARDIZATION", "database": null, "tags": ["layer_1_standardization", "customer_backbone", "customer_backbone", "standardization", "history", "customer_backbone", "standardization", "history"], "meta": {}, "group": null, "materialized": "incremental", "incremental_strategy": "merge", "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": ["medscout_id", "version_number"], "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_1_standardization", "customer_backbone", "standardization", "history"], "description": "SCD2 history for Medscout HCO with soft-delete tracking. Full Replace pattern.", "columns": {"medscout_id": {"name": "medscout_id", "description": "Medscout HCO identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "version_number": {"name": "version_number", "description": "SCD2 version number per entity", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "is_current": {"name": "is_current", "description": "Y for latest version per entity", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "is_active": {"name": "is_active", "description": "Y if in current feed, N if soft-deleted", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/standardization/schema.yml", "build_path": null, "unrendered_config": {"schema": "STANDARDIZATION", "materialized": "incremental", "tags": ["customer_backbone", "standardization", "history"], "unique_key": ["medscout_id", "version_number"], "incremental_strategy": "merge"}, "created_at": 1770177079.4407911, "relation_name": "CGONCOLOGY_TEST.STANDARDIZATION.std_medscout_hco_hist", "raw_code": "{{\n    config(\n        schema='STANDARDIZATION',\n        materialized='incremental',\n        unique_key=['medscout_id', 'version_number'],\n        incremental_strategy='merge',\n        tags=['customer_backbone', 'standardization', 'history']\n    )\n}}\n\n/*\nSTD_MEDSCOUT_HCO_HIST - Medscout HCO History Table with Proper SCD2 + Soft-Delete\nProcess Code: PROC-STD-MEDSCOUT-HCO-HIST\nBusiness Rules: SCD-001 to SCD-015\n\nPurpose: Track all historical versions of Medscout HCO data.\nGrain: One row per (medscout_id, version_number)\n\nSCD2 Columns:\n- version_number: Sequential per entity\n- effective_date: When this version became active\n- end_date: When superseded (9999-12-31 for current)\n- is_current: 'Y' for latest version only\n- source_hash: SHA2 of tracked columns for change detection\n- is_active: 'Y' if in current feed, 'N' if soft-deleted\n\nData Pattern:\n- Medscout uses full refresh pattern\n- Entities that disappear from feed are marked as is_active='N'\n*/\n\n{% if is_incremental() %}\n\nWITH existing_history AS (\n    SELECT * FROM {{ this }}\n),\n\nexisting_current AS (\n    SELECT * FROM existing_history WHERE is_current = 'Y'\n),\n\nnew_snapshot AS (\n    SELECT\n        s.*,\n        SHA2(CONCAT_WS('|',\n            COALESCE(s.medscout_id, ''),\n            COALESCE(s.npi, ''),\n            COALESCE(s.org_name, ''),\n            COALESCE(s.specialty, ''),\n            COALESCE(s.city, ''),\n            COALESCE(s.state, '')\n        ), 256) AS new_source_hash,\n        'Y' AS is_active\n    FROM {{ ref('std_medscout_hco') }} s\n),\n\nchanged_records AS (\n    SELECT n.*\n    FROM new_snapshot n\n    LEFT JOIN existing_current e ON n.medscout_id = e.medscout_id\n    WHERE e.medscout_id IS NULL\n       OR e.source_hash != n.new_source_hash\n),\n\nsoft_deleted AS (\n    SELECT\n        e.*,\n        'N' AS new_is_active,\n        e.version_number + 1 AS new_version_number,\n        CURRENT_DATE() AS new_effective_date,\n        DATE('9999-12-31') AS new_end_date,\n        'Y' AS new_is_current\n    FROM existing_current e\n    LEFT JOIN new_snapshot n ON e.medscout_id = n.medscout_id\n    WHERE n.medscout_id IS NULL\n      AND e.is_active = 'Y'\n),\n\nmax_versions AS (\n    SELECT medscout_id, MAX(version_number) AS max_version\n    FROM existing_history\n    GROUP BY medscout_id\n),\n\nrecords_to_close AS (\n    SELECT e.*,\n        CURRENT_DATE() - 1 AS new_end_date,\n        'N' AS new_is_current\n    FROM existing_current e\n    WHERE e.medscout_id IN (SELECT medscout_id FROM changed_records)\n       OR e.medscout_id IN (SELECT medscout_id FROM soft_deleted)\n)\n\nSELECT\n    medscout_id, npi, org_name, city, state, specialty, facility_type,\n    bc_dx_claims_total, bc_dx_patients_total, cystoscopy_claims_total, cystoscopy_patients_total,\n    turbt_claims_total, turbt_patients_total, tice_bcg_claims_total, tice_bcg_patients_total,\n    adstiladrin_claims_total, adstiladrin_patients_total, keytruda_claims_total, keytruda_patients_total,\n    source_hash, load_date, data_date,\n    is_active, version_number, effective_date, end_date, is_current\nFROM existing_history\nWHERE medscout_id NOT IN (SELECT medscout_id FROM records_to_close)\n\nUNION ALL\n\nSELECT\n    medscout_id, npi, org_name, city, state, specialty, facility_type,\n    bc_dx_claims_total, bc_dx_patients_total, cystoscopy_claims_total, cystoscopy_patients_total,\n    turbt_claims_total, turbt_patients_total, tice_bcg_claims_total, tice_bcg_patients_total,\n    adstiladrin_claims_total, adstiladrin_patients_total, keytruda_claims_total, keytruda_patients_total,\n    source_hash, load_date, data_date,\n    is_active, version_number, effective_date, new_end_date AS end_date, new_is_current AS is_current\nFROM records_to_close\n\nUNION ALL\n\nSELECT\n    c.medscout_id, c.npi, c.org_name, c.city, c.state, c.specialty, c.facility_type,\n    c.bc_dx_claims_total, c.bc_dx_patients_total, c.cystoscopy_claims_total, c.cystoscopy_patients_total,\n    c.turbt_claims_total, c.turbt_patients_total, c.tice_bcg_claims_total, c.tice_bcg_patients_total,\n    c.adstiladrin_claims_total, c.adstiladrin_patients_total, c.keytruda_claims_total, c.keytruda_patients_total,\n    c.new_source_hash AS source_hash, c.load_date, c.data_date,\n    c.is_active, COALESCE(m.max_version, 0) + 1 AS version_number,\n    CURRENT_DATE() AS effective_date, DATE('9999-12-31') AS end_date, 'Y' AS is_current\nFROM changed_records c\nLEFT JOIN max_versions m ON c.medscout_id = m.medscout_id\n\nUNION ALL\n\nSELECT\n    medscout_id, npi, org_name, city, state, specialty, facility_type,\n    bc_dx_claims_total, bc_dx_patients_total, cystoscopy_claims_total, cystoscopy_patients_total,\n    turbt_claims_total, turbt_patients_total, tice_bcg_claims_total, tice_bcg_patients_total,\n    adstiladrin_claims_total, adstiladrin_patients_total, keytruda_claims_total, keytruda_patients_total,\n    source_hash, load_date, CURRENT_DATE() AS data_date,\n    new_is_active AS is_active, new_version_number AS version_number,\n    new_effective_date AS effective_date, new_end_date AS end_date, new_is_current AS is_current\nFROM soft_deleted\n\n{% else %}\n\nSELECT\n    s.medscout_id,\n    s.npi,\n    s.org_name,\n    s.city,\n    s.state,\n    s.specialty,\n    s.facility_type,\n    s.bc_dx_claims_total,\n    s.bc_dx_patients_total,\n    s.cystoscopy_claims_total,\n    s.cystoscopy_patients_total,\n    s.turbt_claims_total,\n    s.turbt_patients_total,\n    s.tice_bcg_claims_total,\n    s.tice_bcg_patients_total,\n    s.adstiladrin_claims_total,\n    s.adstiladrin_patients_total,\n    s.keytruda_claims_total,\n    s.keytruda_patients_total,\n    s.source_hash,\n    s.load_date,\n    s.data_date,\n    'Y' AS is_active,\n    1 AS version_number,\n    CURRENT_DATE() AS effective_date,\n    DATE('9999-12-31') AS end_date,\n    'Y' AS is_current\nFROM {{ ref('std_medscout_hco') }} s\n\n{% endif %}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_medscout_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.CGOncology_MDM.std_medscout_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["medscout_id", "version_number"], "time_spine": null}, "model.CGOncology_MDM.std_zip_territory": {"database": "CGONCOLOGY_TEST", "schema": "STANDARDIZATION", "name": "std_zip_territory", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "standardization/std_zip_territory.sql", "original_file_path": "models/standardization/std_zip_territory.sql", "unique_id": "model.CGOncology_MDM.std_zip_territory", "fqn": ["CGOncology_MDM", "standardization", "std_zip_territory"], "alias": "std_zip_territory", "checksum": {"name": "sha256", "checksum": "dd8751b40f61f6cf735267f0ffe8789b8ab56b5afc37d97eb9f74cdbf627927b"}, "config": {"enabled": true, "alias": null, "schema": "STANDARDIZATION", "database": null, "tags": ["layer_1_standardization", "customer_backbone", "sfe", "standardization", "territory"], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_1_standardization", "customer_backbone", "sfe", "standardization", "territory"], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"schema": "STANDARDIZATION", "materialized": "view", "tags": ["sfe", "standardization", "territory"]}, "created_at": 1770177078.869728, "relation_name": "CGONCOLOGY_TEST.STANDARDIZATION.std_zip_territory", "raw_code": "{{ config(\n    schema='STANDARDIZATION',\n    materialized='view',\n    tags=['sfe', 'standardization', 'territory']\n) }}\n\n/*\nSTD_ZIP_TERRITORY - ZIP Code to Territory Alignment\nSource: adm_sfe_zip_alignment (SFE layer)\n\nView wrapper over adm_sfe_zip_alignment for backward compatibility.\nTerritory names are proper case (e.g., \"Manchester, NH\" not \"MANCHESTER, NH\").\n*/\n\nSELECT\n    zip_code,\n    city,\n    state,\n\n    -- KAM (Key Account Manager) Alignment\n    kam_territory_code,\n    kam_territory_name,\n    kam_region_code,\n    kam_region_name,\n\n    -- HSD (Health Systems Director) Alignment\n    hsd_territory_code,\n    hsd_territory_name,\n\n    -- MSL (Medical Science Liaison) Alignment\n    msl_territory_code,\n    msl_territory_name,\n\n    CURRENT_DATE() AS load_date\nFROM {{ ref('adm_sfe_zip_alignment') }}\nWHERE zip_alignment_version = '{{ var(\"sfe_version\") }}'\n  AND zip_code IS NOT NULL", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_sfe_zip_alignment", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.adm_sfe_zip_alignment"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}, "model.CGOncology_MDM.std_dh_practice_location": {"database": "CGONCOLOGY_TEST", "schema": "STANDARDIZATION", "name": "std_dh_practice_location", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "standardization/std_dh_practice_location.sql", "original_file_path": "models/standardization/std_dh_practice_location.sql", "unique_id": "model.CGOncology_MDM.std_dh_practice_location", "fqn": ["CGOncology_MDM", "standardization", "std_dh_practice_location"], "alias": "std_dh_practice_location", "checksum": {"name": "sha256", "checksum": "1b091e23655bc6e7826a36423bf7b2725da0812e0704d434bf2c6124923713bd"}, "config": {"enabled": true, "alias": null, "schema": "STANDARDIZATION", "database": null, "tags": ["layer_1_standardization", "customer_backbone", "customer_backbone", "standardization", "customer_backbone", "standardization"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_1_standardization", "customer_backbone", "standardization"], "description": "PROC-STG-003: DH Practice Location Standardization - DHC practice location data. Note: practice_location_id is NOT a DH_ID - it's just a source record identifier. The actual dh_id is inherited from the parent L3 organization via DEFINITIVE_ID.", "columns": {"practice_location_id": {"name": "practice_location_id", "description": "Source record identifier from PRACTICE_LOCATION_ID (NOT a DH_ID - just a unique source record key)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "dh_id": {"name": "dh_id", "description": "DH organization ID inherited from parent L3 org (from DEFINITIVE_ID). This links the practice location to its parent physician group or hospital.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "practice_location_name": {"name": "practice_location_name", "description": "Practice location name (UPPERCASE)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "address_line_1": {"name": "address_line_1", "description": "Practice location address (UPPERCASE, standardized)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "zip_code": {"name": "zip_code", "description": "ZIP code (5-digit padded)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "state": {"name": "state", "description": "State (2-char uppercase)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "unique_combined_key": {"name": "unique_combined_key", "description": "Business key for deduplication: address + city + state + zip", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/standardization/schema.yml", "build_path": null, "unrendered_config": {"schema": "STANDARDIZATION", "materialized": "table", "tags": ["customer_backbone", "standardization"]}, "created_at": 1770177079.426236, "relation_name": "CGONCOLOGY_TEST.STANDARDIZATION.std_dh_practice_location", "raw_code": "{{\n    config(\n        schema='STANDARDIZATION',\n        materialized='table',\n        tags=['customer_backbone', 'standardization']\n    )\n}}\n\n/*\nPROC-STG-003: std_dh_practice_location - DH Practice Location Standardization\nSource: raw_dh.PRELAND_DH_PHYSICIAN_GROUP_PRACTICE_LOCATION\nBusiness Rules: STD-001 to STD-006, STD-010, STD-020, STD-023, STD-030, STD-032, SCD-021, SCD-025, SCD-026\n\nTransformations:\n- STD-001: ZIP Code 5-digit left-padded\n- STD-002: State 2-char uppercase\n- STD-003: Address uppercase trimmed\n- STD-005: City uppercase trimmed\n- STD-006: City normalization via ZIP_CITY_STATE_CONFIG lookup\n- STD-010: DH_ID as VARCHAR(50)\n- STD-020: Name uppercase (preserving abbreviations)\n- STD-030: Convert empty strings to NULL\n- STD-032: Unique address key with COALESCE for nulls\n- SCD-021: KMK_PL_ID assignment via business key matching to baseline\n- SCD-025: Preserve DEV KMK_PL_IDs from baseline (oldest LOAD_DATE when duplicates)\n- SCD-026: Generate new IDs for new practice locations (max baseline ID + sequence)\n\nID Assignment:\n- Business key: parent_dh_id + practice_location_name + address_line_1 + zip_code + state\n- Match to practice_location_id_baseline using business key\n- For duplicate business keys in source: Pick first record (by dh_id) and use latest LOAD_DATE\n- If no baseline match: Generate new KMK_PL_ID (max baseline ID + sequence)\n\nID Assignment:\n- KMK_PL_ID assignment happens in std_dh_practice_location_hist (not in this layer)\n- This model only standardizes source data fields\n- Business key for matching: parent_dh_id + normalized_org_name + address_line_1 + zip_code + state\n- The history table matches by business key and assigns/reuses KMK_PL_ID\n\nNote: STD-004 abbreviation standardization via UDF (future enhancement)\nBUG-017: Unique address key for deduplication\nBUG-036: Address line 2 handling\n\nID Column Naming:\n- practice_location_id: Source record ID from PRACTICE_LOCATION_ID (NOT a DH_ID - just a source identifier)\n- dh_id: Inherited from parent L3 org via DEFINITIVE_ID (this IS the actual DH_ID for hierarchy)\n- unique_combined_key: Business key for matching (parent_dh_id + address + zip + state)\n*/\n\nWITH source_data AS (\n    SELECT *,\n        -- Pre-calculate ZIP for join\n        CASE\n            WHEN TRIM(PRACTICE_LOCATION_ZIP_CODE) IS NULL OR TRIM(PRACTICE_LOCATION_ZIP_CODE) = '' THEN NULL\n            ELSE LPAD(TRIM(REGEXP_REPLACE(PRACTICE_LOCATION_ZIP_CODE, '[^0-9]', '')), 5, '0')\n        END AS clean_zip\n    FROM {{ source('raw_dh', 'PRELAND_DH_PHYSICIAN_GROUP_PRACTICE_LOCATION') }}\n    WHERE PRACTICE_LOCATION_ID IS NOT NULL\n)\n\nSELECT\n    -- Source Record ID (NOT a DH_ID - just a source identifier for the practice location record)\n    CAST(src.PRACTICE_LOCATION_ID AS VARCHAR(50)) AS practice_location_id,\n\n    -- Practice Location Name (STD-020, STD-023, STD-030)\n    NULLIF(UPPER(TRIM(src.PRACTICE_LOCATION_NAME)), '') AS practice_location_name,\n\n    -- Normalized Org Name for matching (STD-023)\n    -- Expands abbreviations: CTR\u2192CENTER, HOSP\u2192HOSPITAL, MED\u2192MEDICAL, etc.\n    {{ standardize_org_name('src.PRACTICE_LOCATION_NAME') }} AS normalized_org_name,\n\n    -- Address Standardization (STD-003, STD-004, STD-030)\n    {{ standardize_address('src.PRACTICE_LOCATION_ADDRESS') }} AS address_line_1,\n    NULLIF({{ standardize_address('src.PRACTICE_LOCATION_ADDRESS1') }}, '') AS address_line_2,\n\n    -- City (STD-005, STD-006) - Normalized via ZIP_CITY_STATE_CONFIG lookup\n    COALESCE(UPPER(z.PRIMARY_CITY), NULLIF(UPPER(TRIM(src.PRACTICE_LOCATION_CITY)), '')) AS city,\n\n    -- Normalized City (STD-006) - Alias for hist model compatibility\n    COALESCE(UPPER(z.PRIMARY_CITY), NULLIF(UPPER(TRIM(src.PRACTICE_LOCATION_CITY)), '')) AS normalized_city,\n\n    -- State (STD-002)\n    UPPER(TRIM(src.PRACTICE_LOCATION_STATE)) AS state,\n\n    -- ZIP Code (STD-001)\n    src.clean_zip AS zip_code,\n\n    -- DH_ID (inherited from parent L3 org - this is the actual DH organization ID)\n    NULLIF(CAST(src.DEFINITIVE_ID AS VARCHAR(50)), '') AS dh_id,\n\n    -- Unique Combined Key for deduplication (STD-032, BUG-017)\n    -- Business key: dh_id + address + zip + state (SCD-029)\n    -- CRITICAL: Must match the key format used in std_dh_practice_location_hist\n    CONCAT(\n        COALESCE(CAST(src.DEFINITIVE_ID AS VARCHAR), ''), '|',\n        {{ standardize_address('src.PRACTICE_LOCATION_ADDRESS') }}, '|',\n        src.clean_zip, '|',\n        UPPER(TRIM(src.PRACTICE_LOCATION_STATE))\n    ) AS unique_combined_key,\n\n    -- Source hash for CDC (PQC-003)\n    SHA2(\n        COALESCE(CAST(src.PRACTICE_LOCATION_ID AS VARCHAR), '') || '|' ||\n        COALESCE(src.PRACTICE_LOCATION_NAME, '') || '|' ||\n        COALESCE(src.PRACTICE_LOCATION_ADDRESS, '') || '|' ||\n        COALESCE(src.PRACTICE_LOCATION_CITY, '') || '|' ||\n        COALESCE(src.PRACTICE_LOCATION_STATE, '') || '|' ||\n        COALESCE(src.PRACTICE_LOCATION_ZIP_CODE, '')\n    , 256) AS source_hash,\n\n    -- Audit columns\n    src.LOAD_DATE AS load_date,\n    CURRENT_DATE() AS data_date\n\nFROM source_data src\nLEFT JOIN {{ ref('zip_city_state_config') }} z\n    ON src.clean_zip = z.ZIP", "doc_blocks": [], "language": "sql", "refs": [{"name": "zip_city_state_config", "package": null, "version": null}], "sources": [["raw_dh", "PRELAND_DH_PHYSICIAN_GROUP_PRACTICE_LOCATION"]], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.CGOncology_MDM.standardize_org_name", "macro.CGOncology_MDM.standardize_address"], "nodes": ["source.CGOncology_MDM.raw_dh.PRELAND_DH_PHYSICIAN_GROUP_PRACTICE_LOCATION", "seed.CGOncology_MDM.zip_city_state_config"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["practice_location_id"], "time_spine": null}, "model.CGOncology_MDM.std_dh_facility_to_facility_affiliation": {"database": "CGONCOLOGY_TEST", "schema": "STANDARDIZATION", "name": "std_dh_facility_to_facility_affiliation", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "standardization/std_dh_facility_to_facility_affiliation.sql", "original_file_path": "models/standardization/std_dh_facility_to_facility_affiliation.sql", "unique_id": "model.CGOncology_MDM.std_dh_facility_to_facility_affiliation", "fqn": ["CGOncology_MDM", "standardization", "std_dh_facility_to_facility_affiliation"], "alias": "std_dh_facility_to_facility_affiliation", "checksum": {"name": "sha256", "checksum": "483981c66c72a83a2053be28539b478776442f7c6aeda007944a45621ca38a2a"}, "config": {"enabled": true, "alias": null, "schema": "STANDARDIZATION", "database": null, "tags": ["layer_1_standardization", "customer_backbone", "customer_backbone", "standardization", "customer_backbone", "standardization"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_1_standardization", "customer_backbone", "standardization"], "description": "PROC-STD-DH-F2F-AFF: DH Facility-to-Facility Affiliation Standardization - standardizes facility affiliation data with source_hash for SCD2 change detection.", "columns": {"dh_id": {"name": "dh_id", "description": "Primary facility DH ID (VARCHAR)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "affiliated_id": {"name": "affiliated_id", "description": "Affiliated facility DH ID (VARCHAR)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "org_name": {"name": "org_name", "description": "Primary facility organization name (trimmed)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "firm_type": {"name": "firm_type", "description": "Primary facility firm type", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "affiliated_name": {"name": "affiliated_name", "description": "Affiliated facility name (trimmed)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "affiliated_firm_type": {"name": "affiliated_firm_type", "description": "Affiliated facility firm type", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "source_hash": {"name": "source_hash", "description": "SHA2-256 hash of key fields for SCD2 change detection", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/standardization/schema.yml", "build_path": null, "unrendered_config": {"schema": "STANDARDIZATION", "materialized": "table", "tags": ["customer_backbone", "standardization"]}, "created_at": 1770177079.427718, "relation_name": "CGONCOLOGY_TEST.STANDARDIZATION.std_dh_facility_to_facility_affiliation", "raw_code": "{{\n    config(\n        schema='STANDARDIZATION',\n        materialized='table',\n        tags=['customer_backbone', 'standardization']\n    )\n}}\n\n/*\nPROC-STD-DH-F2F-AFF: std_dh_facility_to_facility_affiliation - DH Facility-to-Facility Affiliation Standardization\nSource: raw_dh.PRELAND_DH_FACILITY_TO_FACILITY_AFFILIATION\nBusiness Rules: STD-002, STD-005, STD-010, STD-030\n\nTransformations:\n- STD-002: State 2-char uppercase\n- STD-005: City uppercase trimmed\n- STD-010: DH_ID/AFFILIATED_ID as VARCHAR(50)\n- STD-030: Convert empty strings to NULL\n\nAffiliation Data:\n- DH_ID + ORG_NAME: Primary facility\n- AFFILIATED_ID + AFFILIATED_NAME: Affiliated facility\n- NETWORK_*: Network hierarchy\n- DELIVERABLE: Source batch tracking\n\nNote: This is the CURRENT SOURCE SNAPSHOT only.\nFor SCD2 history, use std_dh_facility_to_facility_affiliation_hist.\n\nCREATED 2026-01-26: New non-hist model for proper dbt lineage (hist reads from ref()).\n*/\n\nSELECT\n    -- Primary facility\n    CAST(DH_ID AS VARCHAR(50)) AS dh_id,\n    NULLIF(TRIM(ORG_NAME), '') AS org_name,\n    NULLIF(TRIM(FIRM_TYPE), '') AS firm_type,\n    NULLIF(UPPER(TRIM(HQ_CITY)), '') AS hq_city,\n    NULLIF(UPPER(TRIM(HQ_STATE)), '') AS hq_state,\n\n    -- Network info\n    CAST(NETWORK_ID AS VARCHAR(50)) AS network_id,\n    NULLIF(TRIM(NETWORK_NAME), '') AS network_name,\n    CAST(NETWORK_PARENT_ID AS VARCHAR(50)) AS network_parent_id,\n    NULLIF(TRIM(NETWORK_PARENT_NAME), '') AS network_parent_name,\n\n    -- Affiliated facility\n    CAST(AFFILIATED_ID AS VARCHAR(50)) AS affiliated_id,\n    NULLIF(TRIM(AFFILIATED_NAME), '') AS affiliated_name,\n    NULLIF(TRIM(AFFILIATED_FIRM_TYPE), '') AS affiliated_firm_type,\n    NULLIF(UPPER(TRIM(AFFILIATED_HQ_CITY)), '') AS affiliated_hq_city,\n    NULLIF(UPPER(TRIM(AFFILIATED_HQ_STATE)), '') AS affiliated_hq_state,\n\n    -- Deliverable segment\n    NULLIF(TRIM(DELIVERABLE), '') AS deliverable,\n\n    -- Source hash for CDC\n    SHA2(\n        COALESCE(CAST(DH_ID AS VARCHAR), '') || '|' ||\n        COALESCE(CAST(AFFILIATED_ID AS VARCHAR), '') || '|' ||\n        COALESCE(ORG_NAME, '') || '|' ||\n        COALESCE(AFFILIATED_NAME, '') || '|' ||\n        COALESCE(FIRM_TYPE, '') || '|' ||\n        COALESCE(AFFILIATED_FIRM_TYPE, '')\n    , 256) AS source_hash,\n\n    -- Audit columns\n    CURRENT_DATE() AS load_date,\n    CURRENT_DATE() AS data_date\n\nFROM {{ source('raw_dh', 'PRELAND_DH_FACILITY_TO_FACILITY_AFFILIATION') }}\nWHERE DH_ID IS NOT NULL\n  AND AFFILIATED_ID IS NOT NULL", "doc_blocks": [], "language": "sql", "refs": [], "sources": [["raw_dh", "PRELAND_DH_FACILITY_TO_FACILITY_AFFILIATION"]], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["source.CGOncology_MDM.raw_dh.PRELAND_DH_FACILITY_TO_FACILITY_AFFILIATION"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["affiliated_id", "dh_id"], "time_spine": null}, "model.CGOncology_MDM.std_medscout_hcp_hist": {"database": "CGONCOLOGY_TEST", "schema": "STANDARDIZATION", "name": "std_medscout_hcp_hist", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "standardization/std_medscout_hcp_hist.sql", "original_file_path": "models/standardization/std_medscout_hcp_hist.sql", "unique_id": "model.CGOncology_MDM.std_medscout_hcp_hist", "fqn": ["CGOncology_MDM", "standardization", "std_medscout_hcp_hist"], "alias": "std_medscout_hcp_hist", "checksum": {"name": "sha256", "checksum": "33f0c767eaf656ea864bb677ba2ea48ae25117332e638bf0ab32a168f1e71480"}, "config": {"enabled": true, "alias": null, "schema": "STANDARDIZATION", "database": null, "tags": ["layer_1_standardization", "customer_backbone", "customer_backbone", "standardization", "history", "customer_backbone", "standardization", "history"], "meta": {}, "group": null, "materialized": "incremental", "incremental_strategy": "merge", "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": ["medscout_id", "version_number"], "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_1_standardization", "customer_backbone", "standardization", "history"], "description": "SCD2 history for Medscout HCP with soft-delete tracking. Full Replace pattern.", "columns": {"medscout_id": {"name": "medscout_id", "description": "Medscout HCP identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "version_number": {"name": "version_number", "description": "SCD2 version number per entity", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "is_current": {"name": "is_current", "description": "Y for latest version per entity", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "is_active": {"name": "is_active", "description": "Y if in current feed, N if soft-deleted", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/standardization/schema.yml", "build_path": null, "unrendered_config": {"schema": "STANDARDIZATION", "materialized": "incremental", "tags": ["customer_backbone", "standardization", "history"], "unique_key": ["medscout_id", "version_number"], "incremental_strategy": "merge"}, "created_at": 1770177079.441675, "relation_name": "CGONCOLOGY_TEST.STANDARDIZATION.std_medscout_hcp_hist", "raw_code": "{{\n    config(\n        schema='STANDARDIZATION',\n        materialized='incremental',\n        unique_key=['medscout_id', 'version_number'],\n        incremental_strategy='merge',\n        tags=['customer_backbone', 'standardization', 'history']\n    )\n}}\n\n/*\nSTD_MEDSCOUT_HCP_HIST - Medscout HCP History Table with Proper SCD2 + Soft-Delete\nProcess Code: PROC-STD-MEDSCOUT-HCP-HIST\nBusiness Rules: SCD-001 to SCD-015\n\nPurpose: Track all historical versions of Medscout HCP data.\nGrain: One row per (medscout_id, version_number)\n\nSCD2 Columns:\n- version_number: Sequential per entity\n- effective_date: When this version became active\n- end_date: When superseded (9999-12-31 for current)\n- is_current: 'Y' for latest version only\n- source_hash: SHA2 of tracked columns for change detection\n- is_active: 'Y' if in current feed, 'N' if soft-deleted\n\nData Pattern:\n- Medscout uses full refresh pattern\n- Entities that disappear from feed are marked as is_active='N'\n*/\n\n{% if is_incremental() %}\n\nWITH existing_history AS (\n    SELECT * FROM {{ this }}\n),\n\nexisting_current AS (\n    SELECT * FROM existing_history WHERE is_current = 'Y'\n),\n\nnew_snapshot AS (\n    SELECT\n        s.medscout_id,\n        s.npi,\n        s.first_name,\n        s.last_name,\n        s.primary_specialty,\n        s.source_hash,\n        s.load_date,\n        s.data_date,\n        'Y' AS is_active\n    FROM {{ ref('std_medscout_hcp') }} s\n),\n\nchanged_records AS (\n    SELECT n.*\n    FROM new_snapshot n\n    LEFT JOIN existing_current e ON n.medscout_id = e.medscout_id\n    WHERE e.medscout_id IS NULL\n       OR e.source_hash != n.source_hash\n),\n\nsoft_deleted AS (\n    SELECT\n        e.medscout_id,\n        e.npi,\n        e.first_name,\n        e.last_name,\n        e.primary_specialty,\n        e.source_hash,\n        e.load_date,\n        CURRENT_DATE() AS data_date,\n        'N' AS is_active,\n        e.version_number + 1 AS version_number,\n        CURRENT_DATE() AS effective_date,\n        DATE('9999-12-31') AS end_date,\n        'Y' AS is_current\n    FROM existing_current e\n    LEFT JOIN new_snapshot n ON e.medscout_id = n.medscout_id\n    WHERE n.medscout_id IS NULL\n      AND e.is_active = 'Y'\n),\n\nmax_versions AS (\n    SELECT medscout_id, MAX(version_number) AS max_version\n    FROM existing_history\n    GROUP BY medscout_id\n),\n\nrecords_to_close AS (\n    SELECT\n        e.medscout_id,\n        e.npi,\n        e.first_name,\n        e.last_name,\n        e.primary_specialty,\n        e.source_hash,\n        e.load_date,\n        e.data_date,\n        e.is_active,\n        e.version_number,\n        e.effective_date,\n        CURRENT_DATE() - 1 AS end_date,\n        'N' AS is_current\n    FROM existing_current e\n    WHERE e.medscout_id IN (SELECT medscout_id FROM changed_records)\n       OR e.medscout_id IN (SELECT medscout_id FROM soft_deleted)\n),\n\nnew_versions AS (\n    SELECT\n        c.medscout_id,\n        c.npi,\n        c.first_name,\n        c.last_name,\n        c.primary_specialty,\n        c.source_hash,\n        c.load_date,\n        c.data_date,\n        c.is_active,\n        COALESCE(m.max_version, 0) + 1 AS version_number,\n        CURRENT_DATE() AS effective_date,\n        DATE('9999-12-31') AS end_date,\n        'Y' AS is_current\n    FROM changed_records c\n    LEFT JOIN max_versions m ON c.medscout_id = m.medscout_id\n)\n\nSELECT * FROM existing_history\nWHERE medscout_id NOT IN (SELECT medscout_id FROM records_to_close)\n\nUNION ALL\n\nSELECT * FROM records_to_close\n\nUNION ALL\n\nSELECT * FROM new_versions\n\nUNION ALL\n\nSELECT * FROM soft_deleted\n\n{% else %}\n\nSELECT\n    s.medscout_id,\n    s.npi,\n    s.first_name,\n    s.last_name,\n    s.primary_specialty,\n    s.source_hash,\n    s.load_date,\n    s.data_date,\n    'Y' AS is_active,\n    1 AS version_number,\n    CURRENT_DATE() AS effective_date,\n    DATE('9999-12-31') AS end_date,\n    'Y' AS is_current\nFROM {{ ref('std_medscout_hcp') }} s\n\n{% endif %}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_medscout_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.CGOncology_MDM.std_medscout_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["medscout_id", "version_number"], "time_spine": null}, "model.CGOncology_MDM.std_rx_bc_patients": {"database": "CGONCOLOGY_TEST", "schema": "STANDARDIZATION", "name": "std_rx_bc_patients", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "standardization/std_rx_bc_patients.sql", "original_file_path": "models/standardization/std_rx_bc_patients.sql", "unique_id": "model.CGOncology_MDM.std_rx_bc_patients", "fqn": ["CGOncology_MDM", "standardization", "std_rx_bc_patients"], "alias": "std_rx_bc_patients", "checksum": {"name": "sha256", "checksum": "0836fe6aac17614271854b61a4f8a9c809790ea81b4c9fadd40e29d10ce47481"}, "config": {"enabled": true, "alias": null, "schema": "STANDARDIZATION", "database": null, "tags": ["layer_1_standardization", "customer_backbone", "customer_backbone", "bladder_cancer", "BC Patient", "customer_backbone", "bladder_cancer", "BC Patient"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_1_standardization", "customer_backbone", "bladder_cancer", "BC Patient"], "description": "CBR-CB-026: BC patients identified via RX (NDC codes and product name matching). Case-insensitive matching: (BACILLUS AND CALMETTE) OR BCG.", "columns": {"PATIENT_ID": {"name": "PATIENT_ID", "description": "Patient identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "EARLIEST_RX_DATE": {"name": "EARLIEST_RX_DATE", "description": "First BC prescription fill date", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "UNIQUE_NDC_COUNT": {"name": "UNIQUE_NDC_COUNT", "description": "Number of unique BC NDC codes for this patient", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "RX_CLAIM_COUNT": {"name": "RX_CLAIM_COUNT", "description": "Total BC prescription claims for this patient", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "RX_TREATMENT_CATEGORIES": {"name": "RX_TREATMENT_CATEGORIES", "description": "Comma-separated list of treatment categories", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "RX_MATCH_METHODS": {"name": "RX_MATCH_METHODS", "description": "How patient was identified: NDC_MATCH, PRODUCT_NAME_BACILLUS_CALMETTE, or PRODUCT_NAME_BCG", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "IDENTIFICATION_SOURCE": {"name": "IDENTIFICATION_SOURCE", "description": "Always 'RX'", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/standardization/schema.yml", "build_path": null, "unrendered_config": {"schema": "STANDARDIZATION", "materialized": "table", "tags": ["customer_backbone", "bladder_cancer", "BC Patient"]}, "created_at": 1770177079.434827, "relation_name": "CGONCOLOGY_TEST.STANDARDIZATION.std_rx_bc_patients", "raw_code": "{{ config(\n    schema='STANDARDIZATION',\n    materialized='table',\n    tags=['customer_backbone', 'bladder_cancer', 'BC Patient']\n) }}\n\n/*\nCBR-CB-026: BC Patient Identification from RX Codes and Product Names\nIdentify patients via:\n  1. TREATMENT_CATEGORY from std_rx_claims (pre-computed from seed)\n  2. Product name matching: (BACILLUS AND CALMETTE) OR BCG\nCase-insensitive product name matching using UPPER()\n*/\n\nWITH bc_rx_claims_ndc AS (\n    -- Filter to BC-related claims that qualify for BC patient pool\n    -- Uses BC_PATIENT_POOL_FLAG='Y' from seed to determine pool eligibility\n    SELECT\n        rx.PATIENT_ID,\n        rx.FILL_DATE,\n        rx.NDC11,\n        rx.PRODUCT_NAME,\n        rx.TREATMENT_CATEGORY,\n        rx.PRODUCT_NAME AS PRODUCT_NAME_REFERENCE,\n        rx.PATIENT_GENDER,\n        rx.PATIENT_BIRTH_YEAR,\n        rx.PATIENT_ZIP3,\n        'NDC_MATCH' AS MATCH_METHOD\n    FROM {{ ref('std_rx_claims') }} rx\n    INNER JOIN {{ ref('seed_bc_rx_ndc_mapping') }} m\n        ON rx.NDC11 = m.NDC11\n        AND m.BC_PATIENT_POOL_FLAG = 'Y'  -- Only codes that qualify for BC pool\n    WHERE rx.TREATMENT_CATEGORY IS NOT NULL\n),\n\nbc_rx_claims_product_name AS (\n    -- Additional matching via product name (not in seed)\n    SELECT\n        PATIENT_ID,\n        FILL_DATE,\n        NDC11,\n        PRODUCT_NAME,\n        'BCG THERAPY' AS TREATMENT_CATEGORY,\n        PRODUCT_NAME AS PRODUCT_NAME_REFERENCE,\n        PATIENT_GENDER,\n        PATIENT_BIRTH_YEAR,\n        PATIENT_ZIP3,\n        CASE\n            WHEN (UPPER(PRODUCT_NAME) LIKE '%BACILLUS%'\n                  AND UPPER(PRODUCT_NAME) LIKE '%CALMETTE%')\n            THEN 'PRODUCT_NAME_BACILLUS_CALMETTE'\n            WHEN UPPER(PRODUCT_NAME) LIKE '%BCG%'\n            THEN 'PRODUCT_NAME_BCG'\n        END AS MATCH_METHOD\n    FROM {{ ref('std_rx_claims') }}\n    WHERE TREATMENT_CATEGORY IS NULL  -- Not already matched by NDC\n      AND ((UPPER(PRODUCT_NAME) LIKE '%BACILLUS%'\n            AND UPPER(PRODUCT_NAME) LIKE '%CALMETTE%')\n           OR UPPER(PRODUCT_NAME) LIKE '%BCG%')\n),\n\nall_bc_rx_claims AS (\n    SELECT * FROM bc_rx_claims_ndc\n    UNION\n    SELECT * FROM bc_rx_claims_product_name\n),\n\npatient_summary AS (\n    SELECT\n        PATIENT_ID,\n        MIN(FILL_DATE) AS EARLIEST_RX_DATE,\n        MAX(FILL_DATE) AS LATEST_RX_DATE,\n        COUNT(DISTINCT NDC11) AS UNIQUE_NDC_COUNT,\n        COUNT(*) AS RX_CLAIM_COUNT,\n        LISTAGG(DISTINCT TREATMENT_CATEGORY, ', ') WITHIN GROUP (ORDER BY TREATMENT_CATEGORY) AS RX_TREATMENT_CATEGORIES,\n        LISTAGG(DISTINCT MATCH_METHOD, ', ') WITHIN GROUP (ORDER BY MATCH_METHOD) AS RX_MATCH_METHODS,\n        MAX(PATIENT_GENDER) AS PATIENT_GENDER,\n        MAX(PATIENT_BIRTH_YEAR) AS PATIENT_BIRTH_YEAR,\n        MAX(PATIENT_ZIP3) AS PATIENT_ZIP3\n    FROM all_bc_rx_claims\n    GROUP BY PATIENT_ID\n)\n\nSELECT\n    PATIENT_ID,\n    EARLIEST_RX_DATE,\n    LATEST_RX_DATE,\n    UNIQUE_NDC_COUNT,\n    RX_CLAIM_COUNT,\n    RX_TREATMENT_CATEGORIES,\n    RX_MATCH_METHODS,\n    PATIENT_GENDER,\n    PATIENT_BIRTH_YEAR,\n    PATIENT_ZIP3,\n    'RX' AS IDENTIFICATION_SOURCE\nFROM patient_summary", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_rx_claims", "package": null, "version": null}, {"name": "seed_bc_rx_ndc_mapping", "package": null, "version": null}, {"name": "std_rx_claims", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.std_rx_claims", "seed.CGOncology_MDM.seed_bc_rx_ndc_mapping"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["PATIENT_ID"], "time_spine": null}, "model.CGOncology_MDM.std_dh_hcp": {"database": "CGONCOLOGY_TEST", "schema": "STANDARDIZATION", "name": "std_dh_hcp", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "standardization/std_dh_hcp.sql", "original_file_path": "models/standardization/std_dh_hcp.sql", "unique_id": "model.CGOncology_MDM.std_dh_hcp", "fqn": ["CGOncology_MDM", "standardization", "std_dh_hcp"], "alias": "std_dh_hcp", "checksum": {"name": "sha256", "checksum": "0df6228983293346ed3a53486d0d0b75b97ccf39d9311b065c9fd6e15007ca2b"}, "config": {"enabled": true, "alias": null, "schema": "STANDARDIZATION", "database": null, "tags": ["layer_1_standardization", "customer_backbone", "customer_backbone", "standardization", "customer_backbone", "standardization"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_1_standardization", "customer_backbone", "standardization"], "description": "PROC-STG-002: DH HCP Standardization - DHC physician data with name/address standardization", "columns": {"npi": {"name": "npi", "description": "National Provider Identifier (primary HCP identifier)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "last_name": {"name": "last_name", "description": "Physician last name (INITCAP, required)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "first_name": {"name": "first_name", "description": "Physician first name (INITCAP)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "practice_state": {"name": "practice_state", "description": "Practice state (2-char code, mostly US states)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/standardization/schema.yml", "build_path": null, "unrendered_config": {"schema": "STANDARDIZATION", "materialized": "table", "tags": ["customer_backbone", "standardization"]}, "created_at": 1770177079.425442, "relation_name": "CGONCOLOGY_TEST.STANDARDIZATION.std_dh_hcp", "raw_code": "{{\n    config(\n        schema='STANDARDIZATION',\n        materialized='table',\n        tags=['customer_backbone', 'standardization']\n    )\n}}\n\n/*\nPROC-STD-002: std_dh_hcp - DH HCP Standardization\nBusiness Rules: STD-001 to STD-006, STD-010, STD-011, STD-021, STD-022, STD-030\n\nTransformations:\n- STD-001: ZIP Code 5-digit left-padded\n- STD-002: State 2-char uppercase\n- STD-003: Address uppercase trimmed\n- STD-005: City uppercase trimmed\n- STD-006: City normalization via ZIP_CITY_STATE_CONFIG lookup\n- STD-010: DH_ID as VARCHAR(50) - using NPI as DH identifier for HCPs\n- STD-011: NPI as VARCHAR(20) trimmed\n- STD-021: First name proper case\n- STD-022: Last name proper case (required)\n- STD-030: Convert empty strings to NULL\n\nNote: STD-004 abbreviation standardization via UDF (future enhancement)\nNote: STD-SPEC-001: Specialty standardization removes special characters and normalizes case\nNote: STD-SPEC-002: Specialty group truncated to 100 characters\n\nNote: DH uses NPI as the primary identifier for physicians (no separate DH_ID for HCPs).\nSource columns HQ_* are mapped to practice_* for downstream consistency.\n*/\n\nWITH source_data AS (\n    SELECT *,\n        -- Pre-calculate ZIP for join\n        CASE\n            WHEN TRIM(HQ_ZIP_CODE) IS NULL OR TRIM(HQ_ZIP_CODE) = '' THEN NULL\n            ELSE LPAD(TRIM(REGEXP_REPLACE(HQ_ZIP_CODE, '[^0-9]', '')), 5, '0')\n        END AS clean_zip\n    FROM {{ source('raw_dh', 'PRELAND_DH_PHYSICIANS_OVERVIEW') }}\n    WHERE NPI IS NOT NULL\n)\n\nSELECT\n    -- NPI (STD-011) - Primary identifier for HCPs (VARCHAR, not NUMBER)\n    NULLIF(TRIM(CAST(src.NPI AS VARCHAR(20))), '') AS npi,\n\n    -- Name fields (STD-021, STD-022, STD-030)\n    NULLIF(INITCAP(TRIM(src.FIRST_NAME)), '') AS first_name,\n    NULLIF(INITCAP(TRIM(src.MIDDLE_NAME)), '') AS middle_name,\n    INITCAP(TRIM(src.LAST_NAME)) AS last_name,  -- Required, no NULLIF\n\n    -- Demographics (STD-030)\n    NULLIF(UPPER(TRIM(src.GENDER)), '') AS gender,\n    NULLIF(TRIM(src.CREDENTIAL), '') AS credential,\n\n    -- Specialty (STD-030, STD-SPEC-001)\n    NULLIF({{ standardize_specialty('src.SPECIALTY_PRIMARY', 100) }}, '') AS primary_specialty,\n    NULLIF({{ standardize_specialty('src.SPECIALTY_SECONDARY', 100) }}, '') AS secondary_specialty,\n\n    -- Specialty Group (STD-SPEC-002) - Truncate to 100 characters\n    CASE\n        WHEN TRIM(src.SPECIALTY_PRIMARY_GROUP) IS NULL OR TRIM(src.SPECIALTY_PRIMARY_GROUP) = '' THEN NULL\n        ELSE SUBSTRING(TRIM(src.SPECIALTY_PRIMARY_GROUP), 1, 100)\n    END AS primary_specialty_group,\n\n    -- Legacy Affiliation Answer Keys (for high-confidence matching)\n    NULLIF(TRIM(CAST(src.PRIMARY_AFFILIATION_HOSPITAL_ID AS VARCHAR)), '') AS primary_affiliation_hospital_id,\n    NULLIF(TRIM(src.PRIMARY_AFFILIATION_HOSPITAL_NAME), '') AS primary_affiliation_hospital_name,\n    NULLIF(TRIM(CAST(src.LARGEST_PG_AFFILIATION_ID AS VARCHAR)), '') AS largest_pg_affiliation_id,\n    NULLIF(TRIM(src.LARGEST_PG_AFFILIATION_NAME), '') AS largest_pg_affiliation_name,\n\n    -- Primary Practice Location (for affiliation matching tie-breaker)\n    NULLIF(TRIM(src.PRIMARY_PRACTICE_LOCATION_NAME), '') AS primary_practice_location_name,\n\n    -- Practice Address (STD-003, STD-004, STD-030)\n    NULLIF({{ standardize_address('src.HQ_ADDRESS') }}, '') AS practice_address_line_1,\n    NULLIF({{ standardize_address('src.HQ_ADDRESS1') }}, '') AS practice_address_line_2,\n\n    -- City (STD-005, STD-006, STD-030) - Normalized via ZIP_CITY_STATE_CONFIG lookup\n    COALESCE(UPPER(z.PRIMARY_CITY), NULLIF(UPPER(TRIM(src.HQ_CITY)), '')) AS practice_city,\n\n    -- State (STD-002, STD-030)\n    NULLIF(UPPER(TRIM(src.HQ_STATE)), '') AS practice_state,\n\n    -- ZIP Code (STD-001, STD-030)\n    src.clean_zip AS practice_zip_code,\n\n    -- Source hash for CDC (PQC-003)\n    SHA2(\n        COALESCE(CAST(src.NPI AS VARCHAR), '') || '|' ||\n        COALESCE(src.FIRST_NAME, '') || '|' ||\n        COALESCE(src.MIDDLE_NAME, '') || '|' ||\n        COALESCE(src.LAST_NAME, '') || '|' ||\n        COALESCE(src.GENDER, '') || '|' ||\n        COALESCE(src.CREDENTIAL, '') || '|' ||\n        COALESCE(src.HQ_ADDRESS, '') || '|' ||\n        COALESCE(src.HQ_CITY, '') || '|' ||\n        COALESCE(src.HQ_STATE, '') || '|' ||\n        COALESCE(src.HQ_ZIP_CODE, '')\n    , 256) AS source_hash,\n\n    -- Audit columns\n    src.DATE_ENTERED AS load_date,\n    CURRENT_DATE() AS data_date\n\nFROM source_data src\nLEFT JOIN {{ ref('zip_city_state_config') }} z\n    ON src.clean_zip = z.ZIP", "doc_blocks": [], "language": "sql", "refs": [{"name": "zip_city_state_config", "package": null, "version": null}], "sources": [["raw_dh", "PRELAND_DH_PHYSICIANS_OVERVIEW"]], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.CGOncology_MDM.standardize_specialty", "macro.CGOncology_MDM.standardize_address"], "nodes": ["source.CGOncology_MDM.raw_dh.PRELAND_DH_PHYSICIANS_OVERVIEW", "seed.CGOncology_MDM.zip_city_state_config"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["npi"], "time_spine": null}, "model.CGOncology_MDM.std_ddd_sales_hist": {"database": "CGONCOLOGY_TEST", "schema": "STANDARDIZATION", "name": "std_ddd_sales_hist", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "standardization/std_ddd_sales_hist.sql", "original_file_path": "models/standardization/std_ddd_sales_hist.sql", "unique_id": "model.CGOncology_MDM.std_ddd_sales_hist", "fqn": ["CGOncology_MDM", "standardization", "std_ddd_sales_hist"], "alias": "std_ddd_sales_hist", "checksum": {"name": "sha256", "checksum": "b63f6e4acd0a041a7059a73a280e7b38e9573cbf312038c68779987f3a359086"}, "config": {"enabled": true, "alias": null, "schema": "STANDARDIZATION", "database": null, "tags": ["layer_1_standardization", "customer_backbone", "customer_backbone", "standardization", "history", "customer_backbone", "standardization", "history"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_1_standardization", "customer_backbone", "standardization", "history"], "description": "Snapshot history for DDD sales data.", "columns": {"ddd_outlet_id": {"name": "ddd_outlet_id", "description": "DDD outlet identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/standardization/schema.yml", "build_path": null, "unrendered_config": {"schema": "STANDARDIZATION", "materialized": "table", "tags": ["customer_backbone", "standardization", "history"]}, "created_at": 1770177079.440165, "relation_name": "CGONCOLOGY_TEST.STANDARDIZATION.std_ddd_sales_hist", "raw_code": "{{\n    config(\n        schema='STANDARDIZATION',\n        materialized='table',\n        tags=['customer_backbone', 'standardization', 'history']\n    )\n}}\n\n/*\nSTD_DDD_SALES_HIST - DDD Sales History Table\nProcess Code: PROC-STD-DDD-SALES-HIST\nBusiness Rules: SCD-010\n\nPurpose: History snapshot of DDD sales data.\nGrain: One row per (ddd_outlet_id, product_group_id, snapshot_date)\n*/\n\nSELECT\n    s.*,\n    CURRENT_TIMESTAMP() AS snapshot_date,\n    'Y' AS is_current\nFROM {{ ref('std_ddd_sales') }} s", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_ddd_sales", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.std_ddd_sales"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}, "model.CGOncology_MDM.std_dh_practice_location_hist": {"database": "CGONCOLOGY_TEST", "schema": "STANDARDIZATION", "name": "std_dh_practice_location_hist", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "standardization/std_dh_practice_location_hist.sql", "original_file_path": "models/standardization/std_dh_practice_location_hist.sql", "unique_id": "model.CGOncology_MDM.std_dh_practice_location_hist", "fqn": ["CGOncology_MDM", "standardization", "std_dh_practice_location_hist"], "alias": "std_dh_practice_location_hist", "checksum": {"name": "sha256", "checksum": "37c41f2c2d1fbd1c12f1a4cf768bcb6a4096bf606db8310ab5d71e92b55eb77f"}, "config": {"enabled": true, "alias": null, "schema": "STANDARDIZATION", "database": null, "tags": ["layer_1_standardization", "customer_backbone", "customer_backbone", "standardization", "history", "customer_backbone", "standardization", "history"], "meta": {}, "group": null, "materialized": "incremental", "incremental_strategy": "merge", "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": ["kmk_pl_id", "version_number"], "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null, "merge_update_columns": ["practice_location_name", "normalized_org_name", "address_line_1", "address_line_2", "city", "state", "zip_code", "unique_combined_key", "source_hash", "load_timestamp", "data_date", "is_current", "end_date", "version_number"]}, "tags": ["layer_1_standardization", "customer_backbone", "standardization", "history"], "description": "SCD2 history for DH Practice Locations. Uses kmk_pl_id as the unique practice location identifier. The dh_id column contains the inherited DH organization ID from the parent L3 org (physician group or hospital).", "columns": {"dh_id": {"name": "dh_id", "description": "DH organization ID inherited from parent L3 org (from DEFINITIVE_ID in source). Links the practice location to its parent physician group or hospital. This is the actual DH_ID for hierarchy purposes.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "kmk_pl_id": {"name": "kmk_pl_id", "description": "KMK practice location ID - primary identifier for practice locations. Multiple practice locations with same business key (dh_id + address + zip + state) share the same kmk_pl_id.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "version_number": {"name": "version_number", "description": "SCD2 version number per entity (starts at 1)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "is_current": {"name": "is_current", "description": "Y for latest version per entity", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/standardization/schema.yml", "build_path": null, "unrendered_config": {"schema": "STANDARDIZATION", "materialized": "incremental", "tags": ["customer_backbone", "standardization", "history"], "unique_key": ["kmk_pl_id", "version_number"], "incremental_strategy": "merge", "merge_update_columns": ["practice_location_name", "normalized_org_name", "address_line_1", "address_line_2", "city", "state", "zip_code", "unique_combined_key", "source_hash", "load_timestamp", "data_date", "is_current", "end_date", "version_number"]}, "created_at": 1770177079.4366431, "relation_name": "CGONCOLOGY_TEST.STANDARDIZATION.std_dh_practice_location_hist", "raw_code": "{{\n    config(\n        schema='STANDARDIZATION',\n        materialized='incremental',\n        unique_key=['kmk_pl_id', 'version_number'],\n        incremental_strategy='merge',\n        merge_update_columns=['practice_location_name', 'normalized_org_name', 'address_line_1',\n                              'address_line_2', 'city', 'state', 'zip_code',\n                              'unique_combined_key', 'source_hash', 'load_timestamp', 'data_date',\n                              'is_current', 'end_date', 'version_number'],\n        tags=['customer_backbone', 'standardization', 'history']\n    )\n}}\n\n/*\nSTD_DH_PRACTICE_LOCATION_HIST - Practice Location History with SCD2\nProcess Code: PROC-STD-PL-HIST\nBusiness Rules: SCD-020 to SCD-032\n\nPurpose: Assign KMK_PL_ID to practice locations using SCD2 pattern.\n         - INCREMENTAL: Never deletes records, reads from itself for ID lookup\n         - Self-referential: Uses THIS table for existing IDs (no baseline needed)\n         - All practice locations preserved: No deduplication by business key\n\nSource:\n  - History: {{ this }} (self-reference for existing IDs)\n  - Always: std_dh_practice_location (standardized source fields)\n\nID Assignment Strategy:\n  INCREMENTAL (Self-referential):\n    - Existing records: Match by business key, reuse KMK_PL_ID, create new version if source_hash changed\n    - New records: \n      1. Match to history using business key (dh_id + address_line_1 + zip_code + state)\n      2. If multiple matches: Prioritize targets (is_target='Y'), then by load_date DESC\n      3. If no history match: Generate new ID (max of history IDs + sequence)\n    - Business key: dh_id + address_line_1 + zip_code + state\n    - All practice locations preserved: No deduplication by business key (each dh_id gets its own record)\n\n  INITIAL LOAD:\n    - All records get new KMK_PL_IDs\n    - All records start with version_number=1, is_current='Y'\n\nSCD2 Columns:\n- version_number: Sequential per KMK_PL_ID\n- effective_date: When this version became effective\n- end_date: NULL for current version, set to previous version's effective_date when superseded\n- is_current: 'Y' for latest version only\n\nBusiness Rules:\n- SCD-020: All current records must have KMK_PL_ID\n- SCD-021: KMK_PL_ID preserved using business key matching\n- SCD-022: Unique KMK_PL_ID per business key (dh_id + address + zip + state)\n- SCD-023: Matching models must use *_hist tables with is_current='Y'\n- SCD-024: Unique key = ['kmk_pl_id', 'version_number'] (one row per entity version)\n- SCD-025: Historical records preserved across refreshes (incremental never deletes)\n- SCD-026: New IDs generated from max existing ID + sequence\n- SCD-027: When business key matches, reuse KMK_PL_ID and create new version if source_hash changed\n- SCD-028: Collision priority: Target first (is_target='Y'), then by load_date DESC\n- SCD-029: Business key = dh_id + address_line_1 + zip_code + state\n- SCD-030: Historical records preserved across refreshes (incremental never deletes)\n- SCD-031: Matching by business key ONLY (not by dh_id)\n- SCD-032: Multiple dh_ids can map to same KMK_PL_ID if they share same business key\n*/\n\n{% if is_incremental() %}\n-- ============================================================================\n-- INCREMENTAL: Match by business key, create new versions when data changes\n-- ============================================================================\n\nWITH\n\n\n-- History lookup: Use existing history records for ID matching (self-referential)\n-- Match by business key: dh_id + address_line_1 + zip_code + state (via unique_combined_key)\nhistory_lookup AS (\n    SELECT\n        kmk_pl_id,\n        dh_id,\n        normalized_org_name,\n        address_line_1,\n        address_line_2,\n        city,\n        zip_code,\n        state,\n        practice_location_name,\n        source_hash,\n        load_timestamp,\n        version_number,\n        is_current,\n        unique_combined_key\n    FROM {{ this }}\n    WHERE is_current = 'Y'\n      AND kmk_pl_id IS NOT NULL\n),\n\n-- Get max ID from history for new ID generation (self-referential)\nmax_existing_id AS (\n    SELECT COALESCE(MAX(CAST(SUBSTR(kmk_pl_id, 2) AS NUMBER)), 0) AS max_id\n    FROM {{ this }}\n    WHERE kmk_pl_id IS NOT NULL\n),\n\n-- Source data: all records from current load\nsource_data AS (\n    SELECT\n        s.practice_location_id,  -- Source record ID (NOT a DH_ID)\n        s.practice_location_name AS source_pl_name,\n        s.normalized_org_name,\n        s.address_line_1,\n        s.address_line_2,\n        s.city,\n        s.normalized_city,  -- STD-006: For change detection\n        s.state,\n        s.zip_code,\n        s.dh_id,  -- Inherited DH_ID from parent L3 org (DEFINITIVE_ID)\n        s.unique_combined_key,\n        s.source_hash,\n        s.load_date,\n        s.data_date\n    FROM {{ ref('std_dh_practice_location') }} s\n),\n\n-- Match source records to history by business key using unique_combined_key\nmatched_by_business_key AS (\n    SELECT\n        s.*,\n        h.kmk_pl_id AS matched_kmk_pl_id,\n        h.practice_location_name AS matched_pl_name,\n        h.source_hash AS existing_source_hash,\n        h.version_number AS existing_version_number,\n        h.load_timestamp AS existing_load_timestamp,\n        -- Compare actual standardized fields to detect changes (since source_hash uses different fields)\n        h.practice_location_name AS existing_practice_location_name,\n        h.address_line_2 AS existing_address_line_2,\n        h.city AS existing_city,\n        h.normalized_city AS existing_normalized_city\n    FROM source_data s\n    INNER JOIN history_lookup h\n        ON s.unique_combined_key = h.unique_combined_key\n    -- When multiple matches: Prioritize by load_timestamp DESC\n    QUALIFY ROW_NUMBER() OVER (\n        PARTITION BY s.practice_location_id  -- Partition by practice location source ID\n        ORDER BY\n            h.load_timestamp DESC NULLS LAST  -- Most recent match\n    ) = 1\n),\n\n-- Determine which records need new versions (data changed) vs new IDs (no match)\n-- Note: Source hash calculation differs between source and history (uses different source field names),\n-- so we compare actual standardized fields to detect changes instead of relying on source_hash.\nrecords_to_process AS (\n    SELECT\n        m.*,\n        CASE \n            WHEN m.existing_source_hash IS NULL THEN 'NEW_ENTITY'  -- No existing record found (shouldn't happen for matched records)\n            -- Compare actual standardized fields to detect changes\n            -- Note: source_pl_name comes from source_data.practice_location_name\n            WHEN TRIM(COALESCE(m.source_pl_name, '')) != TRIM(COALESCE(m.existing_practice_location_name, ''))\n                OR TRIM(COALESCE(m.address_line_2, '')) != TRIM(COALESCE(m.existing_address_line_2, ''))\n                OR TRIM(COALESCE(m.city, '')) != TRIM(COALESCE(m.existing_city, ''))\n                OR TRIM(COALESCE(m.normalized_city, '')) != TRIM(COALESCE(m.existing_normalized_city, ''))\n            THEN 'NEW_VERSION'  -- Non-key fields changed, create new version\n            ELSE 'NO_CHANGE'  -- All fields match, no change needed\n        END AS change_type\n    FROM matched_by_business_key m\n    \n    UNION ALL\n    \n    -- Records not matched by business key (truly new entities)\n    -- Check by unique_combined_key, not dh_id, since matching is by business key\n    SELECT\n        s.*,\n        NULL AS matched_kmk_pl_id,\n        NULL AS matched_pl_name,\n        NULL AS existing_source_hash,\n        NULL AS existing_version_number,\n        NULL AS existing_load_timestamp,\n        NULL AS existing_practice_location_name,\n        NULL AS existing_address_line_2,\n        NULL AS existing_city,\n        NULL AS existing_normalized_city,\n        'NEW_ENTITY' AS change_type\n    FROM source_data s\n    WHERE NOT EXISTS (\n        SELECT 1 FROM matched_by_business_key m WHERE m.unique_combined_key = s.unique_combined_key\n    )\n),\n\n-- Calculate next version number for records that need new versions\nrecords_with_version AS (\n    SELECT\n        r.*,\n        CASE \n            WHEN r.change_type = 'NEW_VERSION' AND r.existing_version_number IS NOT NULL \n                THEN r.existing_version_number + 1\n            WHEN r.change_type = 'NEW_VERSION' AND r.existing_version_number IS NULL \n                THEN 1  -- Fallback if version_number is NULL (shouldn't happen)\n            WHEN r.change_type = 'NEW_ENTITY' THEN 1\n            ELSE COALESCE(r.existing_version_number, 1)  -- Should not reach here for matched records\n        END AS new_version_number\n    FROM records_to_process r\n),\n\n-- Generate new KMK_PL_IDs for new entities\nnew_entities_with_id AS (\n    SELECT\n        r.*,\n        CASE\n            WHEN r.change_type = 'NEW_ENTITY' THEN\n                '4' || LPAD(CAST((SELECT max_id FROM max_existing_id) +\n                    ROW_NUMBER() OVER (ORDER BY r.dh_id, r.practice_location_id) AS VARCHAR), 9, '0')\n            ELSE r.matched_kmk_pl_id\n        END AS kmk_pl_id_to_use\n    FROM records_with_version r\n),\n\n-- Get parent org names for combined name creation (for new entities)\nparent_org_lookup AS (\n    SELECT dh_id, org_name\n    FROM {{ ref('std_dh_hco') }}\n    WHERE dh_id IS NOT NULL\n),\n\n-- Final records with all fields populated (new versions and new entities)\n-- First deduplicate by (kmk_pl_id, version_number), then exclude existing records\nfinal_records_with_dedup AS (\n    SELECT\n        NULL::VARCHAR(50) AS practice_location_id,  -- Legacy column, always NULL\n        n.kmk_pl_id_to_use AS kmk_pl_id,\n        n.change_type,  -- Keep change_type for old version updates\n        CASE \n            WHEN n.change_type = 'NEW_ENTITY' AND p.org_name IS NOT NULL \n                AND UPPER(TRIM(n.source_pl_name)) != UPPER(TRIM(p.org_name))\n            THEN p.org_name || ' - ' || n.source_pl_name\n            WHEN n.change_type = 'NEW_ENTITY' AND p.org_name IS NOT NULL\n            THEN p.org_name || ' - ' || n.city\n            WHEN n.matched_pl_name IS NOT NULL\n            THEN n.matched_pl_name\n            ELSE n.source_pl_name\n        END AS practice_location_name,\n        n.normalized_org_name,\n        n.address_line_1,\n        n.address_line_2,\n        n.city,\n        n.normalized_city,\n        n.state,\n        n.zip_code,\n        n.dh_id,\n        n.unique_combined_key,\n        n.source_hash,\n        n.new_version_number AS version_number,\n        CAST(n.load_date AS DATE) AS effective_date,\n        NULL::DATE AS end_date,\n        'Y' AS is_current,\n        n.load_date AS load_timestamp,\n        n.data_date,\n        ROW_NUMBER() OVER (\n            PARTITION BY n.kmk_pl_id_to_use, n.new_version_number\n            ORDER BY n.load_date DESC\n        ) AS rn\n    FROM new_entities_with_id n\n    LEFT JOIN parent_org_lookup p ON n.dh_id = p.dh_id\n    WHERE n.change_type IN ('NEW_VERSION', 'NEW_ENTITY')\n        AND n.kmk_pl_id_to_use IS NOT NULL  -- Ensure we have a valid ID\n        AND n.new_version_number IS NOT NULL  -- Ensure we have a valid version number\n        -- Double-check: For NEW_VERSION, version must be > existing version\n        AND (\n            n.change_type != 'NEW_VERSION'\n            OR n.existing_version_number IS NULL  \n            OR (n.existing_version_number IS NOT NULL AND n.new_version_number = n.existing_version_number + 1)\n        )\n),\nfinal_records AS (\n    SELECT\n        practice_location_id,\n        kmk_pl_id,\n        change_type,\n        practice_location_name,\n        normalized_org_name,\n        address_line_1,\n        address_line_2,\n        city,\n        state,\n        zip_code,\n        dh_id,\n        unique_combined_key,\n        source_hash,\n        version_number,\n        effective_date,\n        end_date,\n        is_current,\n        load_timestamp,\n        data_date\n    FROM final_records_with_dedup\n    WHERE rn = 1  -- Keep only one record per (kmk_pl_id, version_number)\n        -- Exclude records that already exist with same (kmk_pl_id, version_number)\n        AND NOT EXISTS (\n            SELECT 1 FROM {{ this }} existing \n            WHERE existing.kmk_pl_id = final_records_with_dedup.kmk_pl_id \n            AND existing.version_number = final_records_with_dedup.version_number\n        )\n),\n\n-- Old versions that need to be updated (set is_current='N', end_date=effective_date of new version)\n-- Only update old versions when a new version is being created (not for new entities)\nold_versions_to_update AS (\n    SELECT\n        h.kmk_pl_id,\n        h.practice_location_name,\n        h.normalized_org_name,\n        h.address_line_1,\n        h.address_line_2,\n        h.city,\n        h.normalized_city,\n        h.state,\n        h.zip_code,\n        h.dh_id,\n        h.unique_combined_key,\n        h.source_hash,\n        h.version_number,\n        h.effective_date,\n        f.effective_date AS end_date,  -- Set end_date to new version's effective_date\n        'N' AS is_current,\n        h.load_timestamp,\n        h.data_date\n    FROM {{ this }} h\n    INNER JOIN final_records f \n        ON h.kmk_pl_id = f.kmk_pl_id\n        AND h.is_current = 'Y'\n        AND f.change_type = 'NEW_VERSION'  -- Only update when creating new version\n)\n\n-- Output: New versions/new entities + updated old versions\nSELECT\n    f.kmk_pl_id,\n    f.practice_location_name,\n    f.normalized_org_name,\n    f.address_line_1,\n    f.address_line_2,\n    f.city,\n    f.normalized_city,\n    f.state,\n    f.zip_code,\n    f.dh_id,\n    f.unique_combined_key,\n    f.source_hash,\n    f.version_number,\n    f.effective_date,\n    f.end_date,\n    f.is_current,\n    f.load_timestamp,\n    f.data_date\nFROM final_records f\n\nUNION ALL\n\n-- Updated old versions\nSELECT\n    o.kmk_pl_id,\n    o.practice_location_name,\n    o.normalized_org_name,\n    o.address_line_1,\n    o.address_line_2,\n    o.city,\n    o.normalized_city,\n    o.state,\n    o.zip_code,\n    o.dh_id,\n    o.unique_combined_key,\n    o.source_hash,\n    o.version_number,\n    o.effective_date,\n    o.end_date,\n    o.is_current,\n    o.load_timestamp,\n    o.data_date\nFROM old_versions_to_update o\n\n{% else %}\n-- ============================================================================\n-- INITIAL LOAD: All records get new KMK_PL_IDs, version_number=1\n-- ============================================================================\n\nWITH\n\n-- Source data: all records from current load\nsource_data AS (\n    SELECT\n        s.practice_location_name AS source_pl_name,\n        s.normalized_org_name,\n        s.address_line_1,\n        s.address_line_2,\n        s.city,\n        s.normalized_city,  -- STD-006: For output\n        s.state,\n        s.zip_code,\n        s.dh_id,\n        s.unique_combined_key,\n        s.source_hash,\n        s.load_date,\n        s.data_date,\n        ROW_NUMBER() OVER (ORDER BY s.dh_id, s.practice_location_id) AS new_id_seq\n    FROM {{ ref('std_dh_practice_location') }} s\n),\n\n-- Generate new KMK_PL_IDs for all records (initial load)\n-- Start from 4000000001 (assuming no existing IDs)\nnew_records_with_id AS (\n    SELECT\n        s.*,\n        '4' || LPAD(CAST(s.new_id_seq AS VARCHAR), 9, '0') AS generated_kmk_pl_id\n    FROM source_data s\n),\n\n-- Get parent org names for combined name creation\nparent_org_lookup AS (\n    SELECT dh_id, org_name\n    FROM {{ ref('std_dh_hco') }}\n    WHERE dh_id IS NOT NULL\n),\n\n-- Final records with all fields populated\nfinal_records AS (\n    SELECT\n        n.generated_kmk_pl_id AS kmk_pl_id,\n        CASE\n            WHEN p.org_name IS NOT NULL AND UPPER(TRIM(n.source_pl_name)) != UPPER(TRIM(p.org_name))\n            THEN p.org_name || ' - ' || n.source_pl_name\n            WHEN p.org_name IS NOT NULL\n            THEN p.org_name || ' - ' || n.city\n            ELSE n.source_pl_name\n        END AS practice_location_name,\n        n.normalized_org_name,\n        n.address_line_1,\n        n.address_line_2,\n        n.city,\n        n.normalized_city,\n        n.state,\n        n.zip_code,\n        n.dh_id,\n        n.unique_combined_key,\n        n.source_hash,\n        1 AS version_number,\n        CAST(n.load_date AS DATE) AS effective_date,\n        NULL::DATE AS end_date,\n        'Y' AS is_current,\n        n.load_date AS load_timestamp,\n        n.data_date\n    FROM new_records_with_id n\n    LEFT JOIN parent_org_lookup p ON n.dh_id = p.dh_id\n)\n\n-- Output: All records as version 1\nSELECT\n    f.kmk_pl_id,\n    f.practice_location_name,\n    f.normalized_org_name,\n    f.address_line_1,\n    f.address_line_2,\n    f.city,\n    f.normalized_city,\n    f.state,\n    f.zip_code,\n    f.dh_id,\n    f.unique_combined_key,\n    f.source_hash,\n    f.version_number,\n    f.effective_date,\n    f.end_date,\n    f.is_current,\n    f.load_timestamp,\n    f.data_date\nFROM final_records f\n\n{% endif %}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_practice_location", "package": null, "version": null}, {"name": "std_dh_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.CGOncology_MDM.std_dh_practice_location", "model.CGOncology_MDM.std_dh_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["kmk_pl_id", "version_number"], "time_spine": null}, "model.CGOncology_MDM.std_px_claims": {"database": "CGONCOLOGY_TEST", "schema": "STANDARDIZATION", "name": "std_px_claims", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "standardization/std_px_claims.sql", "original_file_path": "models/standardization/std_px_claims.sql", "unique_id": "model.CGOncology_MDM.std_px_claims", "fqn": ["CGOncology_MDM", "standardization", "std_px_claims"], "alias": "std_px_claims", "checksum": {"name": "sha256", "checksum": "edf097eec4379a6049af624f39c33c556b477041cbca68fabc9e6f2ad0c93cea"}, "config": {"enabled": true, "alias": null, "schema": "STANDARDIZATION", "database": null, "tags": ["layer_1_standardization", "customer_backbone", "customer_backbone", "bladder_cancer", "BC Patient", "customer_backbone", "bladder_cancer", "BC Patient"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_1_standardization", "customer_backbone", "bladder_cancer", "BC Patient"], "description": "CBR-CB-022: Standardized PX claims. NOTE: PX_CLAIM_ID is NOT unique - same claim_id can appear multiple times in source data.", "columns": {"PX_CLAIM_ID": {"name": "PX_CLAIM_ID", "description": "Procedure claim identifier (NOT unique in source)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PATIENT_ID": {"name": "PATIENT_ID", "description": "Patient identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "SERVICE_DATE": {"name": "SERVICE_DATE", "description": "Date of service", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PROCEDURE_CODE": {"name": "PROCEDURE_CODE", "description": "CPT/HCPCS/ICD procedure code", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PROCEDURE_CODE_TYPE": {"name": "PROCEDURE_CODE_TYPE", "description": "Code type: CPTHCPCS (combined CPT/HCPCS) or ICD10PROC (ICD-10 procedure)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "TREATMENT_CATEGORY": {"name": "TREATMENT_CATEGORY", "description": "BC treatment category from seed_bc_px_code_mapping (NULL if not BC-related)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "NDC11": {"name": "NDC11", "description": "11-digit National Drug Code (for reference only, not used for BC patient identification)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PRODUCT_NAME": {"name": "PRODUCT_NAME", "description": "Product name (for reference only, not used for BC patient identification)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PATIENT_GENDER": {"name": "PATIENT_GENDER", "description": "Patient gender", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/standardization/schema.yml", "build_path": null, "unrendered_config": {"schema": "STANDARDIZATION", "materialized": "table", "tags": ["customer_backbone", "bladder_cancer", "BC Patient"]}, "created_at": 1770177079.432061, "relation_name": "CGONCOLOGY_TEST.STANDARDIZATION.std_px_claims", "raw_code": "{{ config(\n    schema='STANDARDIZATION',\n    materialized='table',\n    tags=['customer_backbone', 'bladder_cancer', 'BC Patient']\n) }}\n\n/*\nSTD-PX-001: Standardize PX claims\nBusiness Rules: STD-PX-001, STD-PX-002\n\nGrain: One row per (PX_CLAIM_ID, PROCEDURE_CODE)\n\nSTD-PX-002 - Source Deduplication:\n- Source has exact duplicate rows (same claim + same procedure code)\n- Use SELECT DISTINCT to deduplicate efficiently\n- Verified: Zero claims lost (Jan 2026)\n*/\n\nSELECT DISTINCT\n    CAST(p.PX_CLAIM_ID AS VARCHAR) AS PX_CLAIM_ID,\n    CAST(p.PATIENT_ID AS VARCHAR) AS PATIENT_ID,\n    p.SERVICE_DATE,\n    p.SERVICE_YEAR,\n    p.SERVICE_MONTH,\n    p.CLAIM_TYPE,\n    p.PROCEDURE_CODE,\n    p.PROCEDURE_CODE_TYPE,\n    p.PROCEDURE_DESCRIPTION,\n    -- Treatment category from seed (NULL if not BC-related)\n    m.TREATMENT_CATEGORY,\n    p.NDC11,           -- KEEP for reference\n    p.PRODUCT_NAME,    -- KEEP for reference\n    p.PATIENT_PRIMARY_PAYOR_NAME,\n    CAST(p.PATIENT_PRIMARY_PAYOR_DH_ID AS VARCHAR) AS PATIENT_PRIMARY_PAYOR_DH_ID,\n    p.PATIENT_PRIMARY_PAYOR_TYPE,\n    p.PATIENT_GENDER,\n    p.PATIENT_BIRTH_YEAR,\n    p.PATIENT_ZIP3,\n    -- NPI columns: Cast from NUMBER to VARCHAR (preland PX has NUMBER type)\n    CAST(p.PROVIDER_FACILITY_NPI AS VARCHAR) AS PROVIDER_FACILITY_NPI,\n    CAST(p.PROVIDER_BILLING_NPI AS VARCHAR) AS PROVIDER_BILLING_NPI,\n    p.PROVIDER_BILLING_DH_ID,\n    CAST(p.PROVIDER_RENDERING_NPI AS VARCHAR) AS PROVIDER_RENDERING_NPI,\n    -- SCD2: Track source batch\n    p.DELIVERABLE\nFROM {{ source('raw_dh', 'PRELAND_DH_BLADDERCANCER_HXMX_PROCEDURE') }} p\nLEFT JOIN {{ ref('seed_bc_px_code_mapping') }} m\n    ON p.PROCEDURE_CODE = m.PROCEDURE_CODE\n    -- NOTE: BC_PATIENT_POOL_FLAG filter removed - all codes get TREATMENT_CATEGORY\n    -- Flag='Y' check moved to std_px_bc_patients for BC patient pool determination", "doc_blocks": [], "language": "sql", "refs": [{"name": "seed_bc_px_code_mapping", "package": null, "version": null}], "sources": [["raw_dh", "PRELAND_DH_BLADDERCANCER_HXMX_PROCEDURE"]], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["source.CGOncology_MDM.raw_dh.PRELAND_DH_BLADDERCANCER_HXMX_PROCEDURE", "seed.CGOncology_MDM.seed_bc_px_code_mapping"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}, "model.CGOncology_MDM.std_dh_facility_to_facility_affiliation_hist": {"database": "CGONCOLOGY_TEST", "schema": "STANDARDIZATION", "name": "std_dh_facility_to_facility_affiliation_hist", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "standardization/std_dh_facility_to_facility_affiliation_hist.sql", "original_file_path": "models/standardization/std_dh_facility_to_facility_affiliation_hist.sql", "unique_id": "model.CGOncology_MDM.std_dh_facility_to_facility_affiliation_hist", "fqn": ["CGOncology_MDM", "standardization", "std_dh_facility_to_facility_affiliation_hist"], "alias": "std_dh_facility_to_facility_affiliation_hist", "checksum": {"name": "sha256", "checksum": "ed25fe5960c328c837cfae4343525d9ccc4672e25aec3e931b2ed9a00a7e86eb"}, "config": {"enabled": true, "alias": null, "schema": "STANDARDIZATION", "database": null, "tags": ["layer_1_standardization", "customer_backbone", "customer_backbone", "standardization", "history", "customer_backbone", "standardization", "history"], "meta": {}, "group": null, "materialized": "incremental", "incremental_strategy": "merge", "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": ["dh_id", "affiliated_id", "source_hash"], "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_1_standardization", "customer_backbone", "standardization", "history"], "description": "SCD2 history for DH facility-to-facility affiliations. 70,835,258 rows, 36.6M unique relationships.", "columns": {"dh_id": {"name": "dh_id", "description": "Primary facility DH ID", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "affiliated_id": {"name": "affiliated_id", "description": "Affiliated facility DH ID", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "version_number": {"name": "version_number", "description": "SCD2 version number per (dh_id, affiliated_id)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "is_current": {"name": "is_current", "description": "Y for latest version per relationship", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/standardization/schema.yml", "build_path": null, "unrendered_config": {"schema": "STANDARDIZATION", "materialized": "incremental", "tags": ["customer_backbone", "standardization", "history"], "unique_key": ["dh_id", "affiliated_id", "source_hash"], "incremental_strategy": "merge"}, "created_at": 1770177079.438745, "relation_name": "CGONCOLOGY_TEST.STANDARDIZATION.std_dh_facility_to_facility_affiliation_hist", "raw_code": "{{\n    config(\n        schema='STANDARDIZATION',\n        materialized='incremental',\n        unique_key=['dh_id', 'affiliated_id', 'source_hash'],\n        incremental_strategy='merge',\n        tags=['customer_backbone', 'standardization', 'history']\n    )\n}}\n\n/*\nSTD_DH_FACILITY_TO_FACILITY_AFFILIATION_HIST - DH Facility-to-Facility Affiliation History Table with SCD2 Columns\nProcess Code: PROC-STD-DH-F2F-AFF-HIST\nBusiness Rules: SCD-001 to SCD-015\n\nPurpose: Track SCD2 history of DH facility-to-facility affiliation data.\nGrain: One row per (dh_id, affiliated_id, source_hash)\n\nSource: {{ ref('std_dh_facility_to_facility_affiliation') }} (standardized non-hist model)\n\nKey Fields:\n- DH_ID: Primary facility identifier\n- AFFILIATED_ID: Affiliated facility identifier\n- ORG_NAME, FIRM_TYPE: Primary facility info\n- AFFILIATED_NAME, AFFILIATED_FIRM_TYPE: Affiliated facility info\n- NETWORK_ID, NETWORK_NAME, NETWORK_PARENT_ID, NETWORK_PARENT_NAME: Network hierarchy\n\nSCD2 Columns:\n- version_number: Computed per (dh_id, affiliated_id) relationship\n- effective_date: Current date for new records\n- end_date: NULL (current record)\n- is_current: 'Y' for latest version per relationship\n- source_hash: Computed from key fields (from non-hist model)\n- is_active: 'Y' for all records\n\nUPDATED 2026-01-26: Switched from APLD to ref() pattern for proper dbt lineage.\n*/\n\nWITH standardized AS (\n    -- Read from standardized non-hist model (already standardized + source_hash computed)\n    SELECT\n        'DHC' AS source_code,\n        dh_id,\n        org_name,\n        firm_type,\n        hq_city,\n        hq_state,\n        network_id,\n        network_name,\n        network_parent_id,\n        network_parent_name,\n        affiliated_id,\n        affiliated_name,\n        affiliated_firm_type,\n        affiliated_hq_city,\n        affiliated_hq_state,\n        deliverable,\n        source_hash,\n        'Y' AS is_active\n    FROM {{ ref('std_dh_facility_to_facility_affiliation') }}\n)\n\n{% if is_incremental() %}\n-- Incremental: Only insert records with new source_hash\nSELECT\n    s.source_code,\n    NULL AS source_id,\n    s.dh_id,\n    s.org_name,\n    s.firm_type,\n    s.hq_city,\n    s.hq_state,\n    s.network_id,\n    s.network_name,\n    s.network_parent_id,\n    s.network_parent_name,\n    s.affiliated_id,\n    s.affiliated_name,\n    s.affiliated_firm_type,\n    s.affiliated_hq_city,\n    s.affiliated_hq_state,\n    s.deliverable,\n    s.source_hash,\n    s.is_active,\n    -- Version number: max existing + 1\n    COALESCE(h.max_version, 0) + 1 AS version_number,\n    CURRENT_DATE() AS effective_date,\n    NULL AS end_date,\n    'Y' AS is_current,\n    CURRENT_TIMESTAMP() AS load_timestamp,\n    CURRENT_DATE() AS data_date\nFROM standardized s\nLEFT JOIN (\n    SELECT dh_id, affiliated_id, MAX(version_number) AS max_version\n    FROM {{ this }}\n    GROUP BY dh_id, affiliated_id\n) h ON s.dh_id = h.dh_id AND s.affiliated_id = h.affiliated_id\nWHERE NOT EXISTS (\n    SELECT 1 FROM {{ this }} existing\n    WHERE existing.dh_id = s.dh_id\n      AND existing.affiliated_id = s.affiliated_id\n      AND existing.source_hash = s.source_hash\n)\n\n{% else %}\n-- Initial load: All records are version 1\nSELECT\n    source_code,\n    NULL AS source_id,\n    dh_id,\n    org_name,\n    firm_type,\n    hq_city,\n    hq_state,\n    network_id,\n    network_name,\n    network_parent_id,\n    network_parent_name,\n    affiliated_id,\n    affiliated_name,\n    affiliated_firm_type,\n    affiliated_hq_city,\n    affiliated_hq_state,\n    deliverable,\n    source_hash,\n    is_active,\n    1 AS version_number,\n    CURRENT_DATE() AS effective_date,\n    NULL AS end_date,\n    'Y' AS is_current,\n    CURRENT_TIMESTAMP() AS load_timestamp,\n    CURRENT_DATE() AS data_date\nFROM standardized\n\n{% endif %}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_facility_to_facility_affiliation", "package": null, "version": null}, {"name": "std_dh_facility_to_facility_affiliation", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.CGOncology_MDM.std_dh_facility_to_facility_affiliation"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["affiliated_id", "dh_id", "version_number"], "time_spine": null}, "model.CGOncology_MDM.std_medscout_hco": {"database": "CGONCOLOGY_TEST", "schema": "STANDARDIZATION", "name": "std_medscout_hco", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "standardization/std_medscout_hco.sql", "original_file_path": "models/standardization/std_medscout_hco.sql", "unique_id": "model.CGOncology_MDM.std_medscout_hco", "fqn": ["CGOncology_MDM", "standardization", "std_medscout_hco"], "alias": "std_medscout_hco", "checksum": {"name": "sha256", "checksum": "2b17f84ce0bf06d7ce160ce054d54a4949b32887b7d08a0e947e5d2f48d9f9af"}, "config": {"enabled": true, "alias": null, "schema": "STANDARDIZATION", "database": null, "tags": ["layer_1_standardization", "customer_backbone", "customer_backbone", "standardization", "customer_backbone", "standardization"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_1_standardization", "customer_backbone", "standardization"], "description": "PROC-STD-MEDSCOUT-HCO: Medscout HCO Standardization with claims metrics. Renamed from stg_medscout_hco (Jan 2026).", "columns": {"medscout_id": {"name": "medscout_id", "description": "Medscout HCO identifier (NPI)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "npi": {"name": "npi", "description": "NPI number", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/standardization/schema.yml", "build_path": null, "unrendered_config": {"schema": "STANDARDIZATION", "materialized": "table", "tags": ["customer_backbone", "standardization"]}, "created_at": 1770177079.42986, "relation_name": "CGONCOLOGY_TEST.STANDARDIZATION.std_medscout_hco", "raw_code": "{{\n    config(\n        schema='STANDARDIZATION',\n        materialized='table',\n        tags=['customer_backbone', 'standardization']\n    )\n}}\n\n/*\nPROC-STD-MEDSCOUT-HCO: std_medscout_hco - Medscout HCO Standardization\nRenamed from stg_medscout_hco to std_medscout_hco for naming consistency (Jan 2026).\nSource: raw_medscout.PRELAND_MEDSCOUT_HCO_DATA\nBusiness Rules: STD-010, STD-011, STD-020, STD-030\n\nTransformations:\n- STD-010: MEDSCOUT_ID as VARCHAR(50) - using NPI as identifier\n- STD-011: NPI_NUMBER as VARCHAR(20) trimmed\n- STD-020: Name uppercase\n- STD-030: Convert empty strings to NULL\n\nNote: Medscout HCO data includes claims metrics by year for various procedures.\n*/\n\nSELECT\n    -- Primary Key (STD-010) - Use NPI as Medscout identifier\n    CAST(NPI AS VARCHAR(50)) AS medscout_id,\n\n    -- NPI Number (STD-011)\n    NULLIF(TRIM(NPI), '') AS npi,\n\n    -- Organization Name (STD-020, STD-030)\n    NULLIF(UPPER(TRIM(NAME)), '') AS org_name,\n\n    -- Location (STD-005, STD-030)\n    NULLIF(UPPER(TRIM(CITY)), '') AS city,\n    NULLIF(UPPER(TRIM(STATE)), '') AS state,\n\n    -- Classification\n    NULLIF(TRIM(SPECIALTY), '') AS specialty,\n    NULLIF(TRIM(TYPE), '') AS facility_type,\n\n    -- Bladder Cancer Diagnosis Claims (Total)\n    TOTAL_01_BLADDER_CANCER_DIAGNOSIS_CLAIMS AS bc_dx_claims_total,\n    TOTAL_01_BLADDER_CANCER_DIAGNOSIS_PATIENTS AS bc_dx_patients_total,\n\n    -- Cystoscopy Claims (Total)\n    TOTAL_02_CYSTOSCOPY_CLAIMS AS cystoscopy_claims_total,\n    TOTAL_02_CYSTOSCOPY_PATIENTS AS cystoscopy_patients_total,\n\n    -- TURBT Claims (Total)\n    TOTAL_03_TURBT_CLAIMS AS turbt_claims_total,\n    TOTAL_03_TURBT_PATIENTS AS turbt_patients_total,\n\n    -- TICE BCG Claims (Total)\n    TOTAL_04_TICE_BCG_CLAIMS AS tice_bcg_claims_total,\n    TOTAL_04_TICE_BCG_PATIENTS AS tice_bcg_patients_total,\n\n    -- Adstiladrin Claims (Total)\n    TOTAL_05_ADSTILADRIN_CLAIMS AS adstiladrin_claims_total,\n    TOTAL_05_ADSTILADRIN_PATIENTS AS adstiladrin_patients_total,\n\n    -- Keytruda Claims (Total)\n    TOTAL_06_KEYTRUDA_CLAIMS AS keytruda_claims_total,\n    TOTAL_06_KEYTRUDA_PATIENTS AS keytruda_patients_total,\n\n    -- Source hash for CDC\n    SHA2(\n        COALESCE(NPI, '') || '|' ||\n        COALESCE(NAME, '') || '|' ||\n        COALESCE(SPECIALTY, '') || '|' ||\n        COALESCE(CITY, '') || '|' ||\n        COALESCE(STATE, '')\n    , 256) AS source_hash,\n\n    -- Audit columns\n    LOAD_DATE AS load_date,\n    CURRENT_DATE() AS data_date\n\nFROM {{ source('raw_medscout', 'PRELAND_MEDSCOUT_HCO_DATA') }}\nWHERE NPI IS NOT NULL", "doc_blocks": [], "language": "sql", "refs": [], "sources": [["raw_medscout", "PRELAND_MEDSCOUT_HCO_DATA"]], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["source.CGOncology_MDM.raw_medscout.PRELAND_MEDSCOUT_HCO_DATA"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["medscout_id"], "time_spine": null}, "model.CGOncology_MDM.adm_lowest_level_metrics": {"database": "CGONCOLOGY_TEST", "schema": "ADM", "name": "adm_lowest_level_metrics", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "adm/adm_lowest_level_metrics.sql", "original_file_path": "models/adm/adm_lowest_level_metrics.sql", "unique_id": "model.CGOncology_MDM.adm_lowest_level_metrics", "fqn": ["CGOncology_MDM", "adm", "adm_lowest_level_metrics"], "alias": "adm_lowest_level_metrics", "checksum": {"name": "sha256", "checksum": "2edf8d0d85b5d15555d88f7a3d127822938fe5ffc873079387503297fe8de358"}, "config": {"enabled": true, "alias": null, "schema": "ADM", "database": null, "tags": ["layer_4_adm", "customer_backbone", "customer_backbone", "adm", "metrics"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_4_adm", "customer_backbone", "adm", "metrics"], "description": "L4 HCO raw metrics (no aggregation).\nBusiness Rules: MET-040 to MET-042\nGrain: One row per (kmk_hco_id, metric_category, metric_code, period_key)\n", "columns": {"kmk_hco_id": {"name": "kmk_hco_id", "description": "KMK HCO identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "metric_category": {"name": "metric_category", "description": "Metric category", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "metric_code": {"name": "metric_code", "description": "Metric code", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "period_key": {"name": "period_key", "description": "Time period key", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/adm/schema.yml", "build_path": null, "unrendered_config": {"schema": "ADM", "materialized": "table", "tags": ["customer_backbone", "adm", "metrics"]}, "created_at": 1770177079.587181, "relation_name": "CGONCOLOGY_TEST.ADM.adm_lowest_level_metrics", "raw_code": "{{\n    config(\n        schema='ADM',\n        materialized='table',\n        tags=['customer_backbone', 'adm', 'metrics']\n    )\n}}\n\n/*\nADM_LOWEST_LEVEL_METRICS - Direct Attribution Metrics from Grain Tables\nProcess Code: PROC-ADM-009\nBusiness Rules: MET-013\n\nGrain: One row per (kmk_hco_id, metric_code, period_key)\n\nPurpose: Raw metrics aggregated directly from grain tables using the attribution waterfall:\n1. KMK_HCO_ID (best affiliation HCO)\n2. If null, NPI affiliation HCO\n3. If null, Federal HCO\n\nSources:\n- Claims: adm_dh_metrics_grain (KMK_HCO_ID = attributed HCO via waterfall)\n- DDD Sales: adm_ddd_metrics_grain (KMK_HCO_ID = matched DDD outlet HCO)\n\nNO hierarchy filtering - uses whatever HCO the claim/sale was attributed to.\nParent IDs (L1/L2/L3) added for rollup calculations downstream.\n\nPeriod Types:\n- MONTHLY: M01-M24 (individual months)\n- ROLLING: L12M, L24M (rolling aggregates)\n*/\n\n-- Get data_date from ref_time_periods (single source of truth)\nWITH data_date_ref AS (\n    SELECT DISTINCT data_date\n    FROM {{ ref('ref_time_periods') }}\n    LIMIT 1\n),\n\n-- Monthly time periods (M01-M24) from ref_time_periods\nmonthly_periods AS (\n    SELECT\n        period_key,\n        period_start_date,\n        period_end_date\n    FROM {{ ref('ref_time_periods') }}\n    WHERE period_type = 'MONTHLY'\n),\n\n-- Rolling time periods (L12M, L18M, L24M, TOTAL) from ref_time_periods\nrolling_periods AS (\n    SELECT\n        period_key,\n        period_start_date,\n        period_end_date\n    FROM {{ ref('ref_time_periods') }}\n    WHERE period_key IN ('L12M', 'L18M', 'L24M', 'TOTAL')\n),\n\n-- ============================================================\n-- CLAIMS METRICS\n-- ============================================================\n\n-- Claims: Monthly claim counts (M01-M24)\nclaims_monthly_claims AS (\n    SELECT\n        g.kmk_hco_id,\n        g.metric_category,\n        g.metric_category || '_CLAIMS' AS metric_code,\n        tp.period_key,\n        COUNT(*) AS metric_value\n    FROM {{ ref('adm_dh_metrics_grain') }} g\n    INNER JOIN monthly_periods tp\n        ON g.service_date >= tp.period_start_date\n        AND g.service_date <= tp.period_end_date\n    WHERE g.kmk_hco_id IS NOT NULL\n    GROUP BY g.kmk_hco_id, g.metric_category, tp.period_key\n),\n\n-- Claims: Monthly patient counts (M01-M24)\nclaims_monthly_patients AS (\n    SELECT\n        g.kmk_hco_id,\n        g.metric_category,\n        g.metric_category || '_PATIENTS' AS metric_code,\n        tp.period_key,\n        COUNT(DISTINCT g.patient_id) AS metric_value\n    FROM {{ ref('adm_dh_metrics_grain') }} g\n    INNER JOIN monthly_periods tp\n        ON g.service_date >= tp.period_start_date\n        AND g.service_date <= tp.period_end_date\n    WHERE g.kmk_hco_id IS NOT NULL\n    GROUP BY g.kmk_hco_id, g.metric_category, tp.period_key\n),\n\n-- Claims: Rolling claim counts (L12M, L24M)\nclaims_rolling_claims AS (\n    SELECT\n        g.kmk_hco_id,\n        g.metric_category,\n        g.metric_category || '_CLAIMS' AS metric_code,\n        tp.period_key,\n        COUNT(*) AS metric_value\n    FROM {{ ref('adm_dh_metrics_grain') }} g\n    INNER JOIN rolling_periods tp\n        ON g.service_date >= tp.period_start_date\n        AND g.service_date <= tp.period_end_date\n    WHERE g.kmk_hco_id IS NOT NULL\n    GROUP BY g.kmk_hco_id, g.metric_category, tp.period_key\n),\n\n-- Claims: Rolling patient counts (L12M, L24M)\nclaims_rolling_patients AS (\n    SELECT\n        g.kmk_hco_id,\n        g.metric_category,\n        g.metric_category || '_PATIENTS' AS metric_code,\n        tp.period_key,\n        COUNT(DISTINCT g.patient_id) AS metric_value\n    FROM {{ ref('adm_dh_metrics_grain') }} g\n    INNER JOIN rolling_periods tp\n        ON g.service_date >= tp.period_start_date\n        AND g.service_date <= tp.period_end_date\n    WHERE g.kmk_hco_id IS NOT NULL\n    GROUP BY g.kmk_hco_id, g.metric_category, tp.period_key\n),\n\n-- ============================================================\n-- DDD METRICS (uses month_num for period mapping)\n-- ============================================================\n\n-- DDD: Monthly sales (M01-M24)\nddd_monthly_sales AS (\n    SELECT\n        g.kmk_hco_id,\n        g.product_name AS metric_category,\n        g.product_name || '_SALES' AS metric_code,\n        'M' || LPAD(g.month_num::VARCHAR, 2, '0') AS period_key,\n        SUM(g.sales_amount) AS metric_value\n    FROM {{ ref('adm_ddd_metrics_grain') }} g\n    WHERE g.kmk_hco_id IS NOT NULL\n    GROUP BY g.kmk_hco_id, g.product_name, g.month_num\n),\n\n-- DDD: Monthly units (M01-M24)\nddd_monthly_units AS (\n    SELECT\n        g.kmk_hco_id,\n        g.product_name AS metric_category,\n        g.product_name || '_UNITS' AS metric_code,\n        'M' || LPAD(g.month_num::VARCHAR, 2, '0') AS period_key,\n        SUM(g.units_count) AS metric_value\n    FROM {{ ref('adm_ddd_metrics_grain') }} g\n    WHERE g.kmk_hco_id IS NOT NULL\n    GROUP BY g.kmk_hco_id, g.product_name, g.month_num\n),\n\n-- DDD: Rolling sales (L12M, L24M)\nddd_rolling_sales AS (\n    SELECT\n        g.kmk_hco_id,\n        g.product_name AS metric_category,\n        g.product_name || '_SALES' AS metric_code,\n        'L12M' AS period_key,\n        SUM(g.sales_amount) AS metric_value\n    FROM {{ ref('adm_ddd_metrics_grain') }} g\n    WHERE g.kmk_hco_id IS NOT NULL\n      AND g.month_num <= 12\n    GROUP BY g.kmk_hco_id, g.product_name\n\n    UNION ALL\n\n    SELECT\n        g.kmk_hco_id,\n        g.product_name AS metric_category,\n        g.product_name || '_SALES' AS metric_code,\n        'L24M' AS period_key,\n        SUM(g.sales_amount) AS metric_value\n    FROM {{ ref('adm_ddd_metrics_grain') }} g\n    WHERE g.kmk_hco_id IS NOT NULL\n      AND g.month_num <= 24\n    GROUP BY g.kmk_hco_id, g.product_name\n),\n\n-- DDD: Rolling units (L12M, L24M)\nddd_rolling_units AS (\n    SELECT\n        g.kmk_hco_id,\n        g.product_name AS metric_category,\n        g.product_name || '_UNITS' AS metric_code,\n        'L12M' AS period_key,\n        SUM(g.units_count) AS metric_value\n    FROM {{ ref('adm_ddd_metrics_grain') }} g\n    WHERE g.kmk_hco_id IS NOT NULL\n      AND g.month_num <= 12\n    GROUP BY g.kmk_hco_id, g.product_name\n\n    UNION ALL\n\n    SELECT\n        g.kmk_hco_id,\n        g.product_name AS metric_category,\n        g.product_name || '_UNITS' AS metric_code,\n        'L24M' AS period_key,\n        SUM(g.units_count) AS metric_value\n    FROM {{ ref('adm_ddd_metrics_grain') }} g\n    WHERE g.kmk_hco_id IS NOT NULL\n      AND g.month_num <= 24\n    GROUP BY g.kmk_hco_id, g.product_name\n),\n\n-- ============================================================\n-- COMBINE ALL METRICS\n-- ============================================================\nall_metrics AS (\n    -- Claims monthly\n    SELECT kmk_hco_id, metric_category, metric_code, period_key, metric_value FROM claims_monthly_claims\n    UNION ALL\n    SELECT kmk_hco_id, metric_category, metric_code, period_key, metric_value FROM claims_monthly_patients\n    UNION ALL\n    -- Claims rolling\n    SELECT kmk_hco_id, metric_category, metric_code, period_key, metric_value FROM claims_rolling_claims\n    UNION ALL\n    SELECT kmk_hco_id, metric_category, metric_code, period_key, metric_value FROM claims_rolling_patients\n    UNION ALL\n    -- DDD monthly\n    SELECT kmk_hco_id, metric_category, metric_code, period_key, metric_value FROM ddd_monthly_sales\n    UNION ALL\n    SELECT kmk_hco_id, metric_category, metric_code, period_key, metric_value FROM ddd_monthly_units\n    UNION ALL\n    -- DDD rolling\n    SELECT kmk_hco_id, metric_category, metric_code, period_key, metric_value FROM ddd_rolling_sales\n    UNION ALL\n    SELECT kmk_hco_id, metric_category, metric_code, period_key, metric_value FROM ddd_rolling_units\n)\n\n-- Add hierarchy parent IDs for rollup calculations\nSELECT\n    m.kmk_hco_id,\n    m.metric_category,\n    m.metric_code,\n    m.period_key,\n    REPLACE(m.metric_code, '_', ' ') AS metric_name,\n    m.metric_value,\n    h.hierarchy_level,\n    h.account_id_l1 AS parent_l1_id,\n    h.account_id_l2 AS parent_l2_id,\n    h.account_id_l3 AS parent_l3_id,\n    (SELECT data_date FROM data_date_ref) AS data_date\nFROM all_metrics m\nLEFT JOIN {{ ref('adm_hco_hierarchy') }} h ON m.kmk_hco_id = h.kmk_hco_id", "doc_blocks": [], "language": "sql", "refs": [{"name": "ref_time_periods", "package": null, "version": null}, {"name": "ref_time_periods", "package": null, "version": null}, {"name": "ref_time_periods", "package": null, "version": null}, {"name": "adm_dh_metrics_grain", "package": null, "version": null}, {"name": "adm_dh_metrics_grain", "package": null, "version": null}, {"name": "adm_dh_metrics_grain", "package": null, "version": null}, {"name": "adm_dh_metrics_grain", "package": null, "version": null}, {"name": "adm_ddd_metrics_grain", "package": null, "version": null}, {"name": "adm_ddd_metrics_grain", "package": null, "version": null}, {"name": "adm_ddd_metrics_grain", "package": null, "version": null}, {"name": "adm_ddd_metrics_grain", "package": null, "version": null}, {"name": "adm_ddd_metrics_grain", "package": null, "version": null}, {"name": "adm_ddd_metrics_grain", "package": null, "version": null}, {"name": "adm_hco_hierarchy", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.ref_time_periods", "model.CGOncology_MDM.adm_dh_metrics_grain", "model.CGOncology_MDM.adm_ddd_metrics_grain", "model.CGOncology_MDM.adm_hco_hierarchy"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["kmk_hco_id", "metric_category", "metric_code", "period_key"], "time_spine": null}, "model.CGOncology_MDM.adm_address_best_ddd_metrics_long": {"database": "CGONCOLOGY_TEST", "schema": "ADM", "name": "adm_address_best_ddd_metrics_long", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "adm/adm_address_best_ddd_metrics_long.sql", "original_file_path": "models/adm/adm_address_best_ddd_metrics_long.sql", "unique_id": "model.CGOncology_MDM.adm_address_best_ddd_metrics_long", "fqn": ["CGOncology_MDM", "adm", "adm_address_best_ddd_metrics_long"], "alias": "adm_address_best_ddd_metrics_long", "checksum": {"name": "sha256", "checksum": "d3f4fc4204575bdd12fa63a13258b699b45152909e80d4e09f06fc4bcd8f1ab2"}, "config": {"enabled": true, "alias": null, "schema": "ADM", "database": null, "tags": ["layer_4_adm", "customer_backbone", "customer_backbone", "adm", "metrics", "ddd", "address_best"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_4_adm", "customer_backbone", "adm", "metrics", "ddd", "address_best"], "description": "DDD sales metrics aggregated to address-best HCO level (long format).\nSales are remapped from original HCO to best HCO sharing same address and parent.\nBusiness Rules: ABH-001 to ABH-005, DDD-001 to DDD-005\nGrain: (entity_id, metric_category, period_key) where entity_id = address_best_hco_id\n", "columns": {"entity_type": {"name": "entity_type", "description": "Always 'ADDRESS_BEST_HCO'", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "entity_id": {"name": "entity_id", "description": "Address-best HCO identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "metric_category": {"name": "metric_category", "description": "Product category (TICE_BCG, ADSTILADRIN, ANKTIVA, etc.)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "period_key": {"name": "period_key", "description": "Time period key", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "sales_amount": {"name": "sales_amount", "description": "Total sales dollars", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "units_count": {"name": "units_count", "description": "Total pack units", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "outlet_count": {"name": "outlet_count", "description": "Distinct outlet count", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "contributing_hco_count": {"name": "contributing_hco_count", "description": "Count of source HCOs contributing", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/adm/schema.yml", "build_path": null, "unrendered_config": {"schema": "ADM", "materialized": "table", "tags": ["customer_backbone", "adm", "metrics", "ddd", "address_best"]}, "created_at": 1770177079.588953, "relation_name": "CGONCOLOGY_TEST.ADM.adm_address_best_ddd_metrics_long", "raw_code": "{{\n    config(\n        schema='ADM',\n        materialized='table',\n        tags=['customer_backbone', 'adm', 'metrics', 'ddd', 'address_best']\n    )\n}}\n\n/*\nADM_ADDRESS_BEST_DDD_METRICS_LONG - DDD Sales Metrics Aggregated to Address-Best HCO\nBusiness Rules: ABH-001 to ABH-005, DDD-001 to DDD-005\n\nPurpose: Aggregates DDD sales metrics to the address-best HCO level. Sales are remapped\nfrom their original HCO to the \"best\" HCO sharing the same address and ultimate parent.\n\nUse Case: Consolidate DDD sales metrics for healthcare organizations operating at the same\nphysical location under the same ownership.\n\nGrain: One row per (entity_id, metric_category, period_key) where entity_id = address_best_hco_id\n\nLogic:\n1. Join grain table with address_best bridge on KMK_HCO_ID (the actual HCO with the DDD outlet)\n2. Remap the sale's HCO to its address_best_hco_id\n3. Aggregate by (address_best_hco_id, metric_category, period_key)\n\nMetrics:\n- sales_amount: SUM of dollar sales\n- units_count: SUM of pack units\n- outlet_count: COUNT DISTINCT outlets\n- contributing_hco_count: COUNT DISTINCT of source kmk_hco_ids contributing to this address_best\n\nPeriod Types:\n- MONTHLY: M01-M24 (month_num 1-24)\n- ROLLING: L3M, L6M, L12M, L18M, L24M\n- QUARTERLY: Q01-Q08\n- Annual: YTD, PYTD, PY, P2Y, QTD\n- CALENDAR_YEAR: e.g., 2024, 2025\n- TOTAL: All-time total\n*/\n\n-- Get data_date from grain table\nWITH data_date_ref AS (\n    SELECT MAX(data_date) AS data_date\n    FROM {{ ref('adm_ddd_metrics_grain') }}\n),\n\n-- Rolling period definitions (month_num based)\nrolling_periods AS (\n    SELECT 'L3M' AS period_key, 3 AS max_month_num, 'ROLLING' AS period_type UNION ALL\n    SELECT 'L6M', 6, 'ROLLING' UNION ALL\n    SELECT 'L12M', 12, 'ROLLING' UNION ALL\n    SELECT 'L18M', 18, 'ROLLING' UNION ALL\n    SELECT 'L24M', 24, 'ROLLING'\n),\n\n-- Get time periods for date-based joins\ntime_periods AS (\n    SELECT\n        period_type,\n        period_key,\n        period_start_date,\n        period_end_date\n    FROM {{ ref('ref_time_periods') }}\n    WHERE period_type IN ('QUARTERLY', 'YTD', 'PYTD', 'PY', 'P2Y', 'QTD', 'CALENDAR_YEAR', 'TOTAL')\n),\n\n-- Address best bridge table\naddress_best_bridge AS (\n    SELECT\n        kmk_hco_id,\n        address_best_hco_id,\n        address_group_id,\n        is_address_best\n    FROM {{ ref('ref_address_best_hco') }}\n),\n\n-- Source grain data with metric_category\ngrain_with_category AS (\n    SELECT\n        g.outlet_no,\n        g.kmk_hco_id,\n        g.month_num,\n        g.data_date AS sale_date,\n        CASE\n            WHEN g.product_group_id IN (3, 4) THEN 'TICE_BCG'\n            WHEN g.product_group_id = 1 THEN 'ADSTILADRIN'\n            WHEN g.product_group_id = 2 THEN 'ANKTIVA'\n            WHEN g.product_group_id = 7 THEN 'INLEXZO'\n            ELSE 'OTHER'\n        END AS metric_category,\n        CASE WHEN g.product_group_id IN (1, 2) THEN TRUE ELSE FALSE END AS is_branded,\n        g.sales_amount,\n        g.units_count\n    FROM {{ ref('adm_ddd_metrics_grain') }} g\n    WHERE g.kmk_hco_id IS NOT NULL\n      AND g.kmk_hco_id NOT IN ('UNASSIGNED', 'INDEPENDENT')\n),\n\n-- ============================================================\n-- REMAP SALES TO ADDRESS_BEST BY KMK_HCO_ID\n-- Join on the actual HCO that has the DDD outlet, not hierarchy levels\n-- ============================================================\n\n-- Sales remapped to address_best via KMK_HCO_ID\nall_remapped_sales AS (\n    SELECT\n        ab.address_best_hco_id AS entity_id,\n        g.kmk_hco_id AS source_hco_id,\n        g.metric_category,\n        g.is_branded,\n        g.outlet_no,\n        g.month_num,\n        g.sale_date,\n        g.sales_amount,\n        g.units_count\n    FROM grain_with_category g\n    INNER JOIN address_best_bridge ab ON g.kmk_hco_id = ab.kmk_hco_id\n),\n\n-- ============================================================\n-- MONTHLY AGGREGATION (by category)\n-- ============================================================\nmonthly_by_category AS (\n    SELECT\n        'ADDRESS_BEST_HCO' AS entity_type,\n        s.entity_id,\n        s.metric_category,\n        'M' || LPAD(s.month_num::VARCHAR, 2, '0') AS period_key,\n        'MONTHLY' AS period_type,\n        SUM(s.sales_amount) AS sales_amount,\n        SUM(s.units_count) AS units_count,\n        COUNT(DISTINCT s.outlet_no) AS outlet_count,\n        COUNT(DISTINCT s.source_hco_id) AS contributing_hco_count\n    FROM all_remapped_sales s\n    GROUP BY 1, 2, 3, 4, 5\n),\n\nmonthly_branded AS (\n    SELECT\n        'ADDRESS_BEST_HCO' AS entity_type,\n        s.entity_id,\n        'TOTAL_BRANDED' AS metric_category,\n        'M' || LPAD(s.month_num::VARCHAR, 2, '0') AS period_key,\n        'MONTHLY' AS period_type,\n        SUM(s.sales_amount) AS sales_amount,\n        SUM(s.units_count) AS units_count,\n        COUNT(DISTINCT s.outlet_no) AS outlet_count,\n        COUNT(DISTINCT s.source_hco_id) AS contributing_hco_count\n    FROM all_remapped_sales s\n    WHERE s.is_branded = TRUE\n    GROUP BY 1, 2, 3, 4, 5\n),\n\nmonthly_total AS (\n    SELECT\n        'ADDRESS_BEST_HCO' AS entity_type,\n        s.entity_id,\n        'TOTAL' AS metric_category,\n        'M' || LPAD(s.month_num::VARCHAR, 2, '0') AS period_key,\n        'MONTHLY' AS period_type,\n        SUM(s.sales_amount) AS sales_amount,\n        SUM(s.units_count) AS units_count,\n        COUNT(DISTINCT s.outlet_no) AS outlet_count,\n        COUNT(DISTINCT s.source_hco_id) AS contributing_hco_count\n    FROM all_remapped_sales s\n    GROUP BY 1, 2, 3, 4, 5\n),\n\n-- ============================================================\n-- ROLLING AGGREGATION\n-- ============================================================\nrolling_by_category AS (\n    SELECT\n        'ADDRESS_BEST_HCO' AS entity_type,\n        s.entity_id,\n        s.metric_category,\n        rp.period_key,\n        rp.period_type,\n        SUM(s.sales_amount) AS sales_amount,\n        SUM(s.units_count) AS units_count,\n        COUNT(DISTINCT s.outlet_no) AS outlet_count,\n        COUNT(DISTINCT s.source_hco_id) AS contributing_hco_count\n    FROM all_remapped_sales s\n    CROSS JOIN rolling_periods rp\n    WHERE s.month_num <= rp.max_month_num\n    GROUP BY 1, 2, 3, 4, 5\n),\n\nrolling_branded AS (\n    SELECT\n        'ADDRESS_BEST_HCO' AS entity_type,\n        s.entity_id,\n        'TOTAL_BRANDED' AS metric_category,\n        rp.period_key,\n        rp.period_type,\n        SUM(s.sales_amount) AS sales_amount,\n        SUM(s.units_count) AS units_count,\n        COUNT(DISTINCT s.outlet_no) AS outlet_count,\n        COUNT(DISTINCT s.source_hco_id) AS contributing_hco_count\n    FROM all_remapped_sales s\n    CROSS JOIN rolling_periods rp\n    WHERE s.is_branded = TRUE\n      AND s.month_num <= rp.max_month_num\n    GROUP BY 1, 2, 3, 4, 5\n),\n\nrolling_total AS (\n    SELECT\n        'ADDRESS_BEST_HCO' AS entity_type,\n        s.entity_id,\n        'TOTAL' AS metric_category,\n        rp.period_key,\n        rp.period_type,\n        SUM(s.sales_amount) AS sales_amount,\n        SUM(s.units_count) AS units_count,\n        COUNT(DISTINCT s.outlet_no) AS outlet_count,\n        COUNT(DISTINCT s.source_hco_id) AS contributing_hco_count\n    FROM all_remapped_sales s\n    CROSS JOIN rolling_periods rp\n    WHERE s.month_num <= rp.max_month_num\n    GROUP BY 1, 2, 3, 4, 5\n),\n\n-- ============================================================\n-- DATE-BASED AGGREGATION (Quarterly, YTD, etc.)\n-- ============================================================\ndate_based_by_category AS (\n    SELECT\n        'ADDRESS_BEST_HCO' AS entity_type,\n        s.entity_id,\n        s.metric_category,\n        tp.period_key,\n        tp.period_type,\n        SUM(s.sales_amount) AS sales_amount,\n        SUM(s.units_count) AS units_count,\n        COUNT(DISTINCT s.outlet_no) AS outlet_count,\n        COUNT(DISTINCT s.source_hco_id) AS contributing_hco_count\n    FROM all_remapped_sales s\n    INNER JOIN time_periods tp\n        ON s.sale_date >= tp.period_start_date\n        AND s.sale_date <= tp.period_end_date\n    GROUP BY 1, 2, 3, 4, 5\n),\n\ndate_based_branded AS (\n    SELECT\n        'ADDRESS_BEST_HCO' AS entity_type,\n        s.entity_id,\n        'TOTAL_BRANDED' AS metric_category,\n        tp.period_key,\n        tp.period_type,\n        SUM(s.sales_amount) AS sales_amount,\n        SUM(s.units_count) AS units_count,\n        COUNT(DISTINCT s.outlet_no) AS outlet_count,\n        COUNT(DISTINCT s.source_hco_id) AS contributing_hco_count\n    FROM all_remapped_sales s\n    INNER JOIN time_periods tp\n        ON s.sale_date >= tp.period_start_date\n        AND s.sale_date <= tp.period_end_date\n    WHERE s.is_branded = TRUE\n    GROUP BY 1, 2, 3, 4, 5\n),\n\ndate_based_total AS (\n    SELECT\n        'ADDRESS_BEST_HCO' AS entity_type,\n        s.entity_id,\n        'TOTAL' AS metric_category,\n        tp.period_key,\n        tp.period_type,\n        SUM(s.sales_amount) AS sales_amount,\n        SUM(s.units_count) AS units_count,\n        COUNT(DISTINCT s.outlet_no) AS outlet_count,\n        COUNT(DISTINCT s.source_hco_id) AS contributing_hco_count\n    FROM all_remapped_sales s\n    INNER JOIN time_periods tp\n        ON s.sale_date >= tp.period_start_date\n        AND s.sale_date <= tp.period_end_date\n    GROUP BY 1, 2, 3, 4, 5\n),\n\n-- ============================================================\n-- COMBINE ALL METRICS\n-- ============================================================\nall_metrics AS (\n    SELECT * FROM monthly_by_category UNION ALL\n    SELECT * FROM monthly_branded UNION ALL\n    SELECT * FROM monthly_total UNION ALL\n    SELECT * FROM rolling_by_category UNION ALL\n    SELECT * FROM rolling_branded UNION ALL\n    SELECT * FROM rolling_total UNION ALL\n    SELECT * FROM date_based_by_category UNION ALL\n    SELECT * FROM date_based_branded UNION ALL\n    SELECT * FROM date_based_total\n)\n\n-- Final output\nSELECT\n    entity_type,\n    entity_id,\n    metric_category,\n    period_key,\n    period_type,\n    sales_amount,\n    units_count,\n    outlet_count,\n    contributing_hco_count,\n    (SELECT data_date FROM data_date_ref) AS data_date\nFROM all_metrics\nWHERE (sales_amount > 0 OR units_count > 0)\n  AND entity_id IS NOT NULL", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_ddd_metrics_grain", "package": null, "version": null}, {"name": "ref_time_periods", "package": null, "version": null}, {"name": "ref_address_best_hco", "package": null, "version": null}, {"name": "adm_ddd_metrics_grain", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.adm_ddd_metrics_grain", "model.CGOncology_MDM.ref_time_periods", "model.CGOncology_MDM.ref_address_best_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}, "model.CGOncology_MDM.ref_time_periods": {"database": "CGONCOLOGY_TEST", "schema": "ADM", "name": "ref_time_periods", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "adm/ref_time_periods.sql", "original_file_path": "models/adm/ref_time_periods.sql", "unique_id": "model.CGOncology_MDM.ref_time_periods", "fqn": ["CGOncology_MDM", "adm", "ref_time_periods"], "alias": "ref_time_periods", "checksum": {"name": "sha256", "checksum": "d4d78d1cb88c0fa66c4a2cb922f8c5e28ce9dbae35cc6cb9f8b1544d4ce5a2eb"}, "config": {"enabled": true, "alias": null, "schema": "ADM", "database": null, "tags": ["layer_4_adm", "customer_backbone", "customer_backbone", "adm", "reference"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_4_adm", "customer_backbone", "adm", "reference"], "description": "Time period definitions for metrics aggregation.\nIncludes: Monthly (M01-M24), Quarterly (Q01-Q08), Rolling (L3M, L6M, L12M), YTD, QTD, PY, PYTD, P2Y, Calendar Years, LTD, TOTAL\nBusiness Rules: MET-010 to MET-018\nAnnual periods use dynamic year/quarter naming (e.g., YTD_2025, QTD_2025_Q1, PY_2024, PYTD_2024, P2Y_2023, 2024, 2025, 2026)\nAll periods calculated dynamically from CURRENT_DATE() - no hardcoded values.\n", "columns": {"period_key": {"name": "period_key", "description": "Period identifier (e.g., M01, Q1_2025, L12M, YTD_2025, QTD_2025_Q1, PY_2024, PYTD_2024, P2Y_2023, 2024)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "period_type": {"name": "period_type", "description": "Type of period (MONTHLY, QUARTERLY, ROLLING, YTD, QTD, PY, PYTD, P2Y, CALENDAR_YEAR, LTD, TOTAL)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/adm/schema.yml", "build_path": null, "unrendered_config": {"schema": "ADM", "materialized": "table", "tags": ["customer_backbone", "adm", "reference"]}, "created_at": 1770177079.5840309, "relation_name": "CGONCOLOGY_TEST.ADM.ref_time_periods", "raw_code": "{{\n    config(\n        schema='ADM',\n        materialized='table',\n        tags=['customer_backbone', 'adm', 'reference']\n    )\n}}\n\n/*\nREF_TIME_PERIODS - Time Period Reference Table\nBusiness Rules: MET-010 to MET-018\n\nGenerates time period definitions for metrics aggregation:\n- Monthly periods (M1-M24 = last 24 months)\n- Quarterly periods (Q1-Q8 = last 8 quarters)\n- Rolling periods (L3M, L6M, L12M)\n- Year-to-date (YTD)\n- Quarter-to-date (QTD)\n- Prior Year (PY) - full prior year\n- Prior Year-to-date (PYTD) - same period last year\n- Prior 2 Years (P2Y)\n- Calendar Years (last 3 years)\n- Life-to-date (LTD) for branded products\n\nPeriod Naming Convention:\n- M1 = Current month, M24 = 24 months ago\n- Q1 = Current quarter, Q8 = 8 quarters ago\n- YTD_YYYY = Year-to-date (e.g., YTD_2025)\n- QTD_YYYY_QN = Quarter-to-date (e.g., QTD_2025_Q1)\n- PY_YYYY = Full prior year (e.g., PY_2024)\n- PYTD_YYYY = Prior year-to-date, same period (e.g., PYTD_2024)\n- Display names follow YYYY-MM or Q{N}_YYYY format\n\nAll periods use dynamic year/quarter calculations - no hardcoded values.\n*/\n\nWITH\n-- Get data_date from dbt_project.yml var\nconfig_data_date AS (\n    SELECT DATE('{{ var('data_date') }}') AS data_date\n),\n-- Reference date for period calculations (use data_date from config)\nreference_date AS (\n    SELECT\n        cd.data_date AS ref_date,\n        DATE_TRUNC('MONTH', cd.data_date) AS current_month_start,\n        DATE_TRUNC('QUARTER', cd.data_date) AS current_quarter_start,\n        DATE_TRUNC('YEAR', cd.data_date) AS current_year_start,\n        QUARTER(cd.data_date) AS current_quarter_num,\n        YEAR(cd.data_date) AS current_year\n    FROM config_data_date cd\n),\n\n-- Generate monthly periods (M1-M24)\nmonthly_periods AS (\n    SELECT\n        'MONTHLY' AS period_type,\n        'M' || LPAD(seq.n::VARCHAR, 2, '0') AS period_key,\n        DATEADD('MONTH', -(seq.n - 1), rd.current_month_start) AS period_start_date,\n        DATEADD('DAY', -1, DATEADD('MONTH', 1, DATEADD('MONTH', -(seq.n - 1), rd.current_month_start))) AS period_end_date,\n        TO_CHAR(DATEADD('MONTH', -(seq.n - 1), rd.current_month_start), 'YYYY-MM') AS period_display_name,\n        seq.n AS period_sequence,\n        rd.ref_date\n    FROM reference_date rd\n    CROSS JOIN (\n        SELECT ROW_NUMBER() OVER (ORDER BY SEQ4()) AS n\n        FROM TABLE(GENERATOR(ROWCOUNT => 24))\n    ) seq\n),\n\n-- Generate quarterly periods (Q1-Q8)\nquarterly_periods AS (\n    SELECT\n        'QUARTERLY' AS period_type,\n        'Q' || LPAD(seq.n::VARCHAR, 2, '0') AS period_key,\n        DATEADD('QUARTER', -(seq.n - 1), rd.current_quarter_start) AS period_start_date,\n        DATEADD('DAY', -1, DATEADD('QUARTER', 1, DATEADD('QUARTER', -(seq.n - 1), rd.current_quarter_start))) AS period_end_date,\n        'Q' || QUARTER(DATEADD('QUARTER', -(seq.n - 1), rd.current_quarter_start)) || '_' ||\n            YEAR(DATEADD('QUARTER', -(seq.n - 1), rd.current_quarter_start)) AS period_display_name,\n        seq.n AS period_sequence,\n        rd.ref_date\n    FROM reference_date rd\n    CROSS JOIN (\n        SELECT ROW_NUMBER() OVER (ORDER BY SEQ4()) AS n\n        FROM TABLE(GENERATOR(ROWCOUNT => 8))\n    ) seq\n),\n\n-- Generate rolling periods (L3M, L6M, L12M, L18M, L24M)\n-- Uses data_date from dbt_project.yml (guaranteed to be end of month)\n-- L12M = last 12 months = M01 through M12 (current month back 11 months)\n-- Example: If current month is Nov 2025, L12M = Dec 2024 - Nov 2025\nrolling_periods AS (\n    SELECT\n        'ROLLING' AS period_type,\n        period_key,\n        DATEADD('MONTH', -(months_back - 1), rd.current_month_start) AS period_start_date,\n        rd.ref_date AS period_end_date,  -- data_date is already end of month per dbt_project.yml\n        period_key || ' (' || TO_CHAR(DATEADD('MONTH', -(months_back - 1), rd.current_month_start), 'YYYY-MM') ||\n            ' to ' || TO_CHAR(rd.ref_date, 'YYYY-MM') || ')' AS period_display_name,\n        CASE period_key\n            WHEN 'L3M' THEN 1\n            WHEN 'L6M' THEN 2\n            WHEN 'L12M' THEN 3\n            WHEN 'L18M' THEN 4\n            WHEN 'L24M' THEN 5\n        END AS period_sequence,\n        rd.ref_date\n    FROM reference_date rd\n    CROSS JOIN (\n        SELECT 'L3M' AS period_key, 3 AS months_back\n        UNION ALL SELECT 'L6M', 6\n        UNION ALL SELECT 'L12M', 12\n        UNION ALL SELECT 'L18M', 18\n        UNION ALL SELECT 'L24M', 24\n    ) rolling\n),\n\n-- Year-to-date (YTD)\nytd_period AS (\n    SELECT\n        'YTD' AS period_type,\n        'YTD_' || YEAR(rd.ref_date) AS period_key,\n        rd.current_year_start AS period_start_date,\n        rd.ref_date AS period_end_date,\n        'YTD ' || YEAR(rd.ref_date) AS period_display_name,\n        1 AS period_sequence,\n        rd.ref_date\n    FROM reference_date rd\n),\n\n-- Quarter-to-date (QTD) - dynamic quarter\nqtd_period AS (\n    SELECT\n        'QTD' AS period_type,\n        'QTD_' || rd.current_year || '_Q' || rd.current_quarter_num AS period_key,\n        rd.current_quarter_start AS period_start_date,\n        rd.ref_date AS period_end_date,\n        'QTD ' || rd.current_year || ' Q' || rd.current_quarter_num AS period_display_name,\n        1 AS period_sequence,\n        rd.ref_date\n    FROM reference_date rd\n),\n\n-- Prior Year same period (PY) - dynamic year (full prior year)\npy_period AS (\n    SELECT\n        'PY' AS period_type,\n        'PY_' || (YEAR(rd.ref_date) - 1) AS period_key,\n        DATEADD('YEAR', -1, rd.current_year_start) AS period_start_date,\n        DATEADD('DAY', -1, DATEADD('YEAR', 1, DATEADD('YEAR', -1, rd.current_year_start))) AS period_end_date,\n        'PY ' || (YEAR(rd.ref_date) - 1) AS period_display_name,\n        1 AS period_sequence,\n        rd.ref_date\n    FROM reference_date rd\n),\n\n-- Prior Year-to-date (PYTD) - same period last year (dynamic)\npytd_period AS (\n    SELECT\n        'PYTD' AS period_type,\n        'PYTD_' || (YEAR(rd.ref_date) - 1) AS period_key,\n        DATEADD('YEAR', -1, rd.current_year_start) AS period_start_date,\n        DATEADD('YEAR', -1, rd.ref_date) AS period_end_date,\n        'PYTD ' || (YEAR(rd.ref_date) - 1) AS period_display_name,\n        1 AS period_sequence,\n        rd.ref_date\n    FROM reference_date rd\n),\n\n-- Prior 2 Years (P2Y) - dynamic year\np2y_period AS (\n    SELECT\n        'P2Y' AS period_type,\n        'P2Y_' || (YEAR(rd.ref_date) - 2) AS period_key,\n        DATEADD('YEAR', -2, rd.current_year_start) AS period_start_date,\n        DATEADD('YEAR', -2, rd.ref_date) AS period_end_date,\n        'P2Y ' || (YEAR(rd.ref_date) - 2) AS period_display_name,\n        1 AS period_sequence,\n        rd.ref_date\n    FROM reference_date rd\n),\n\n-- Calendar Years (last 3 years) - dynamic\ncalendar_years AS (\n    SELECT\n        'CALENDAR_YEAR' AS period_type,\n        YEAR(DATEADD('YEAR', -(seq.n - 1), rd.ref_date))::VARCHAR AS period_key,\n        DATEADD('YEAR', -(seq.n - 1), rd.current_year_start) AS period_start_date,\n        DATEADD('DAY', -1, DATEADD('YEAR', 1, DATEADD('YEAR', -(seq.n - 1), rd.current_year_start))) AS period_end_date,\n        'Calendar Year ' || YEAR(DATEADD('YEAR', -(seq.n - 1), rd.ref_date)) AS period_display_name,\n        seq.n AS period_sequence,\n        rd.ref_date\n    FROM reference_date rd\n    CROSS JOIN (\n        SELECT ROW_NUMBER() OVER (ORDER BY SEQ4()) AS n\n        FROM TABLE(GENERATOR(ROWCOUNT => 3))\n    ) seq\n),\n\n-- Life-to-Date for branded products (LTD)\nltd_periods AS (\n    SELECT\n        'LTD' AS period_type,\n        'LTD_' || product_code AS period_key,\n        launch_date AS period_start_date,\n        rd.ref_date AS period_end_date,\n        'LTD ' || product_name || ' (since ' || TO_CHAR(launch_date, 'YYYY-MM-DD') || ')' AS period_display_name,\n        seq AS period_sequence,\n        rd.ref_date\n    FROM reference_date rd\n    CROSS JOIN (\n        SELECT 'ANKTIVA' AS product_code, 'Anktiva' AS product_name, '2024-04-23'::DATE AS launch_date, 1 AS seq\n        UNION ALL SELECT 'ADSTILADRIN', 'Adstiladrin', '2022-12-16'::DATE, 2\n    ) products\n),\n\n-- Total (all available data)\ntotal_period AS (\n    SELECT\n        'TOTAL' AS period_type,\n        'TOTAL' AS period_key,\n        '2020-01-01'::DATE AS period_start_date,  -- Earliest claims data\n        rd.ref_date AS period_end_date,\n        'All Time' AS period_display_name,\n        1 AS period_sequence,\n        rd.ref_date AS data_date\n    FROM reference_date rd\n),\n\n-- Combine all periods\nall_periods AS (\n    SELECT * FROM monthly_periods\n    UNION ALL SELECT * FROM quarterly_periods\n    UNION ALL SELECT * FROM rolling_periods\n    UNION ALL SELECT * FROM ytd_period\n    UNION ALL SELECT * FROM qtd_period\n    UNION ALL SELECT * FROM py_period\n    UNION ALL SELECT * FROM pytd_period\n    UNION ALL SELECT * FROM p2y_period\n    UNION ALL SELECT * FROM calendar_years\n    UNION ALL SELECT * FROM ltd_periods\n    UNION ALL SELECT * FROM total_period\n)\n\nSELECT\n    period_type,\n    period_key,\n    period_start_date,\n    period_end_date,\n    period_display_name,\n    period_sequence,\n    DATEDIFF('DAY', period_start_date, period_end_date) + 1 AS period_days,\n    ref_date AS data_date\nFROM all_periods\nORDER BY period_type, period_sequence", "doc_blocks": [], "language": "sql", "refs": [], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["period_key"], "time_spine": null}, "model.CGOncology_MDM.adm_pipeline_diff": {"database": "CGONCOLOGY_TEST", "schema": "ARCHIVE", "name": "adm_pipeline_diff", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "adm/adm_pipeline_diff.sql", "original_file_path": "models/adm/adm_pipeline_diff.sql", "unique_id": "model.CGOncology_MDM.adm_pipeline_diff", "fqn": ["CGOncology_MDM", "adm", "adm_pipeline_diff"], "alias": "adm_pipeline_diff", "checksum": {"name": "sha256", "checksum": "1417e2d2da8d086d9e548fc8bde6d09a9d7bd0027e62877e323a584e3c214dbb"}, "config": {"enabled": true, "alias": null, "schema": "ARCHIVE", "database": null, "tags": ["layer_4_adm", "customer_backbone", "pipeline_monitoring"], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_4_adm", "customer_backbone", "pipeline_monitoring"], "description": "Pipeline snapshot comparison view.\nCompares the two most recent data_date snapshots and flags anomalies.\nSeverity levels: CRITICAL, WARNING, INFO, OK.\n", "columns": {"metric_group": {"name": "metric_group", "description": "Category of metric", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "metric_name": {"name": "metric_name", "description": "What is being measured", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "severity": {"name": "severity", "description": "Anomaly severity (CRITICAL, WARNING, INFO, OK)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "before_data_date": {"name": "before_data_date", "description": "Previous snapshot data_date", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "after_data_date": {"name": "after_data_date", "description": "Latest snapshot data_date", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "change_pct": {"name": "change_pct", "description": "Percentage change between snapshots", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/adm/schema.yml", "build_path": null, "unrendered_config": {"schema": "ARCHIVE", "materialized": "view", "tags": ["pipeline_monitoring"]}, "created_at": 1770177079.58947, "relation_name": "CGONCOLOGY_TEST.ARCHIVE.adm_pipeline_diff", "raw_code": "{{\n    config(\n        schema='ARCHIVE',\n        materialized='view',\n        tags=['pipeline_monitoring']\n    )\n}}\n\n/*\nADM_PIPELINE_DIFF - Pipeline Snapshot Comparison View\n\nPurpose: Compares the two most recent data_date snapshots and flags anomalies.\n         Use this view as the first check after any pipeline refresh.\n\nAnomaly Severity Rules:\n  - CRITICAL: ROW_COUNT change >20%, table drops to 0 rows\n  - WARNING:  ROW_COUNT change 5-20%, backbone/target decreasing,\n              claims/DDD totals change >10%, distribution disappeared,\n              unmapped affiliation increasing, target count decrease >5%\n  - INFO:     New distribution value appeared, TOP20 rank shift >5\n  - OK:       No anomaly detected\n\nGrain: One row per (metric_group, metric_name, dimension_value, entity_id)\n*/\n\nWITH snapshot_dates AS (\n    -- Get the two most recent distinct data_date values,\n    -- and the latest run_timestamp for each (dedup if same data_date ran twice)\n    SELECT data_date,\n           MAX(run_timestamp) AS latest_run,\n           ROW_NUMBER() OVER (ORDER BY data_date DESC) AS date_rank\n    FROM {{ ref('adm_pipeline_snapshot') }}\n    GROUP BY data_date\n    QUALIFY date_rank <= 2\n),\n\nlatest AS (\n    SELECT s.*\n    FROM {{ ref('adm_pipeline_snapshot') }} s\n    INNER JOIN snapshot_dates d\n        ON s.data_date = d.data_date\n        AND s.run_timestamp = d.latest_run\n        AND d.date_rank = 1\n),\n\nprevious AS (\n    SELECT s.*\n    FROM {{ ref('adm_pipeline_snapshot') }} s\n    INNER JOIN snapshot_dates d\n        ON s.data_date = d.data_date\n        AND s.run_timestamp = d.latest_run\n        AND d.date_rank = 2\n),\n\ncompared AS (\n    SELECT\n        COALESCE(a.metric_group, b.metric_group) AS metric_group,\n        COALESCE(a.metric_name, b.metric_name) AS metric_name,\n        COALESCE(a.dimension_value, b.dimension_value) AS dimension_value,\n        COALESCE(a.entity_id, b.entity_id) AS entity_id,\n\n        b.data_date AS before_data_date,\n        a.data_date AS after_data_date,\n\n        b.metric_value AS before_value,\n        a.metric_value AS after_value,\n        b.metric_value_2 AS before_value_2,\n        a.metric_value_2 AS after_value_2,\n\n        (a.metric_value - b.metric_value) AS change,\n        CASE\n            WHEN b.metric_value IS NULL OR b.metric_value = 0 THEN NULL\n            ELSE ROUND(((a.metric_value - b.metric_value) / b.metric_value) * 100, 2)\n        END AS change_pct,\n\n        -- Rank columns for TOP20 comparisons\n        b.rank_position AS before_rank,\n        a.rank_position AS after_rank\n\n    FROM latest a\n    FULL OUTER JOIN previous b\n        ON a.metric_group = b.metric_group\n        AND a.metric_name = b.metric_name\n        AND COALESCE(a.dimension_value, '___NULL___') = COALESCE(b.dimension_value, '___NULL___')\n        AND COALESCE(a.entity_id, '___NULL___') = COALESCE(b.entity_id, '___NULL___')\n        -- NOTE: rank_position is intentionally excluded from the join key.\n        -- For TOP20_HCO rows, this allows the same entity_id to match across\n        -- different rank positions, enabling rank movement detection (Rule 10).\n        -- For non-TOP20 rows, rank_position is NULL on both sides so excluding\n        -- it has no effect on the join.\n)\n\nSELECT\n    metric_group,\n    metric_name,\n    dimension_value,\n    entity_id,\n    before_data_date,\n    after_data_date,\n    before_value,\n    after_value,\n    before_value_2,\n    after_value_2,\n    change,\n    change_pct,\n    before_rank,\n    after_rank,\n\n    -- Anomaly severity classification\n    CASE\n        -- Rule 3: Table drops to 0 rows\n        WHEN metric_group = 'ROW_COUNT' AND after_value = 0 AND before_value > 0\n            THEN 'CRITICAL'\n\n        -- Rule 2: ROW_COUNT change >20%\n        WHEN metric_group = 'ROW_COUNT' AND ABS(change_pct) > 20\n            THEN 'CRITICAL'\n\n        -- Rule 1: ROW_COUNT change 5-20%\n        WHEN metric_group = 'ROW_COUNT' AND ABS(change_pct) BETWEEN 5 AND 20\n            THEN 'WARNING'\n\n        -- Rule 4: Backbone Y count decreasing\n        WHEN metric_group IN ('DIST_HCP_BACKBONE', 'ACCT_TYPE_DETAIL')\n            AND dimension_value = 'BACKBONE_Y'\n            AND change < 0\n            THEN 'WARNING'\n\n        -- Rule 5: Claims/DDD totals change >10%\n        WHEN metric_group IN ('CLAIMS_L12M', 'DDD_SALES_L12M')\n            AND ABS(change_pct) > 10\n            THEN 'WARNING'\n\n        -- Rule 6: Unmapped affiliation % increasing\n        WHEN metric_group = 'DIST_AFFILIATION'\n            AND dimension_value ILIKE '%UNMAPPED%'\n            AND change > 0\n            THEN 'WARNING'\n\n        -- Rule 7: Target count decrease >5%\n        WHEN metric_group = 'ACCT_TYPE_DETAIL'\n            AND dimension_value IN ('KAM_TARGET_Y', 'HSD_TARGET_Y')\n            AND change_pct < -5\n            THEN 'WARNING'\n\n        -- Rule 8: Distribution value disappeared (was present, now NULL)\n        WHEN before_value IS NOT NULL AND after_value IS NULL\n            THEN 'WARNING'\n\n        -- Rule 9: New distribution value appeared\n        WHEN before_value IS NULL AND after_value IS NOT NULL\n            THEN 'INFO'\n\n        -- Rule 10: TOP20 rank changed >5 spots\n        WHEN metric_group = 'TOP20_HCO'\n            AND before_rank IS NOT NULL AND after_rank IS NOT NULL\n            AND ABS(after_rank - before_rank) > 5\n            THEN 'INFO'\n\n        -- Default\n        ELSE 'OK'\n    END AS severity\n\nFROM compared", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_pipeline_snapshot", "package": null, "version": null}, {"name": "adm_pipeline_snapshot", "package": null, "version": null}, {"name": "adm_pipeline_snapshot", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.adm_pipeline_snapshot"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}, "model.CGOncology_MDM.adm_nmibc_risk": {"database": "CGONCOLOGY_TEST", "schema": "ADM", "name": "adm_nmibc_risk", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "adm/adm_nmibc_risk.sql", "original_file_path": "models/adm/adm_nmibc_risk.sql", "unique_id": "model.CGOncology_MDM.adm_nmibc_risk", "fqn": ["CGOncology_MDM", "adm", "adm_nmibc_risk"], "alias": "adm_nmibc_risk", "checksum": {"name": "sha256", "checksum": "e531f2cee00788a5e4f44c68b879a1c680be780cb2696d848fc4442cfeda5177"}, "config": {"enabled": true, "alias": null, "schema": "ADM", "database": null, "tags": ["layer_4_adm", "customer_backbone", "customer_backbone", "adm", "nmibc"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_4_adm", "customer_backbone", "adm", "nmibc"], "description": "NMIBC patient risk stratification.\nBusiness Rules: MET-043 to MET-045\n", "columns": {"patient_id": {"name": "patient_id", "description": "Patient identifier (primary key)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "nmibc_risk_tier": {"name": "nmibc_risk_tier", "description": "NMIBC risk tier (HIGH, INTERMEDIATE, LOW)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/adm/schema.yml", "build_path": null, "unrendered_config": {"schema": "ADM", "materialized": "table", "tags": ["customer_backbone", "adm", "nmibc"]}, "created_at": 1770177079.586133, "relation_name": "CGONCOLOGY_TEST.ADM.adm_nmibc_risk", "raw_code": "{{\n    config(\n        schema='ADM',\n        materialized='table',\n        tags=['customer_backbone', 'adm', 'nmibc']\n    )\n}}\n\n/*\nADM_NMIBC_RISK - NMIBC Patient Risk Stratification\nBusiness Rules: NMI-001 to NMI-021, RSK-100 to RSK-300, PAT-010, PAT-011, PAT-012, RSK-030 to RSK-032\n\nNMIBC = Non-Muscle Invasive Bladder Cancer\nA subset of BC patients meeting additional criteria:\n- 2+ BC DX claims at least 30 days apart (NMI-011)\n- Has BC treatment (PX or RX) (NMI-012)\n- Treatment date >= 2024-01-01 (NMI-013)\n- Has at least 1 TURBT procedure (NMI-014)\n\nBC Patient Pool Filter (PAT-010, PAT-011, PAT-012):\n- Only includes claims for BC patients meeting criteria:\n  - latest_bc_event_date >= '2023-01-01'\n  - DX_CLAIM_COUNT > 0 (must have BC diagnosis)\n  - (PX_CLAIM_COUNT > 0 OR RX_CLAIM_COUNT > 0) (must have treatment)\n- Applied to dx_claims and px_claims for consistency with other ADM models\n\nRisk Stratification (Flowchart-Based, RSK-100 to RSK-300):\n- HIGH (Step 1): CIS & BCG, Cystectomy within 12mo, Systemic IO within 12mo, BCG + Early Repeat TURBT\n- LOW (Step 2): ALL criteria absent (No CIS, No BCG, No Intravesical, No repeat TURBT, No Cystectomy, No Systemic IO)\n- INTERMEDIATE (Step 3): Does NOT meet High AND Does NOT meet all Low\n\nData Date (RSK-030 to RSK-032):\n- Uses data_date from dbt_project.yml var for consistent time windows\n- data_date represents the snapshot date when data was processed\n- 12-month windows calculated from data_date, NOT CURRENT_DATE()\n\nGrain: One row per patient_id (NMIBC patients only)\n*/\n\n-- Get data_date from dbt_project.yml var (for consistent time windows)\nWITH config_data_date AS (\n    SELECT DATE('{{ var('data_date') }}') AS data_date\n),\n\n-- ============================================\n-- Step 1: Get BC patients and DX claims for NMIBC criteria\n-- ============================================\n-- Note: stg_bc_patient_pool already applies the BC Patient Pool filter (PAT-010, PAT-011, PAT-012):\n--   - PAT-010: LATEST_BC_EVENT_DATE within configured date range (from config_claims_date_range seed)\n--   - PAT-011: DX_CLAIM_COUNT > 0 (must have BC diagnosis)\n--   - PAT-012: (PX_CLAIM_COUNT > 0 OR RX_CLAIM_COUNT > 0) (must have treatment)\n-- We just need to select from it - no need to re-apply the filter\nbc_patients AS (\n    SELECT\n        PATIENT_ID,\n        EARLIEST_BC_EVENT_DATE,\n        LATEST_BC_EVENT_DATE,\n        IDENTIFIED_VIA_DX,\n        IDENTIFIED_VIA_PX,\n        IDENTIFIED_VIA_RX,\n        DX_CLAIM_COUNT,\n        PX_CLAIM_COUNT,\n        RX_CLAIM_COUNT,\n        EARLIEST_DX_DATE,\n        LATEST_DX_DATE,\n        EARLIEST_PX_DATE,\n        LATEST_PX_DATE,\n        PATIENT_GENDER,\n        PATIENT_BIRTH_YEAR,\n        PATIENT_ZIP3\n    FROM {{ ref('stg_bc_patient_pool') }}\n),\n\n-- BC Patient Pool Filter (PAT-010, PAT-011, PAT-012) - for consistency with other ADM models\n-- Note: stg_bc_patient_pool already applies the filter, so we just select PATIENT_ID\nbc_patient_pool AS (\n    SELECT PATIENT_ID\n    FROM bc_patients\n),\n\n-- Get DX claims to calculate 30-day gap and CIS counts\n-- FILTERED TO BC PATIENT POOL (for consistency with other ADM models)\ndx_claims AS (\n    SELECT\n        dx.PATIENT_ID,\n        dx.SERVICE_DATE,\n        dx.DIAGNOSIS_CODE,\n        CASE WHEN dx.DIAGNOSIS_CODE = 'D090' THEN 1 ELSE 0 END AS is_cis\n    FROM {{ ref('std_dx_claims') }} dx\n    INNER JOIN bc_patient_pool pool ON dx.PATIENT_ID = pool.PATIENT_ID\n    WHERE dx.DIAGNOSIS_CODE IN ('C670', 'C671', 'C672', 'C673', 'C674', 'C675', 'C676', 'C677', 'C678', 'C679', 'D090', 'D414', 'D494', 'Z8551')\n),\n\n-- Calculate DX 30-day gap for NMI-011\ndx_gap_calc AS (\n    SELECT\n        PATIENT_ID,\n        MIN(SERVICE_DATE) AS first_dx_date,\n        MAX(SERVICE_DATE) AS last_dx_date,\n        COUNT(DISTINCT SERVICE_DATE) AS distinct_dx_dates,\n        DATEDIFF('day', MIN(SERVICE_DATE), MAX(SERVICE_DATE)) AS dx_date_span,\n        SUM(is_cis) AS cis_dx_count\n    FROM dx_claims\n    GROUP BY PATIENT_ID\n),\n\n-- ============================================\n-- Step 2: Get PX claims for TURBT, BCG, Cystectomy, Intravesical, Systemic IO\n-- FILTERED TO BC PATIENT POOL (for consistency with other ADM models)\n-- ============================================\npx_claims AS (\n    SELECT\n        px.PATIENT_ID,\n        px.SERVICE_DATE,\n        px.PROCEDURE_CODE,\n        -- TURBT by size\n        CASE WHEN px.PROCEDURE_CODE IN ('52224') THEN 'MINOR'\n             WHEN px.PROCEDURE_CODE IN ('52234') THEN 'SMALL'\n             WHEN px.PROCEDURE_CODE IN ('52235') THEN 'MEDIUM'\n             WHEN px.PROCEDURE_CODE IN ('52240') THEN 'LARGE'\n             WHEN px.PROCEDURE_CODE IN ('52214') THEN 'GENERAL'\n             ELSE NULL END AS turbt_size,\n        -- Treatment flags\n        CASE WHEN px.PROCEDURE_CODE IN ('52214', '52224', '52234', '52235', '52240') THEN 1 ELSE 0 END AS is_turbt,\n        CASE WHEN px.PROCEDURE_CODE IN ('J9030', 'J9031', '90586') THEN 1 ELSE 0 END AS is_bcg,\n        CASE WHEN px.PROCEDURE_CODE IN ('51550', '51555', '51565', '51570', '51575', '51580', '51585', '51590', '51595', '51596') THEN 1 ELSE 0 END AS is_cystectomy,\n        CASE WHEN px.PROCEDURE_CODE IN ('51720', 'J9357', 'J9201', 'J9280', 'J9000') THEN 1 ELSE 0 END AS is_intravesical,\n        -- Systemic Immunotherapy (RSK-102)\n        CASE WHEN px.PROCEDURE_CODE IN ('J9271', 'J9299', 'J9022', 'C9483', 'J9213', 'J9214', 'J9215') THEN 1 ELSE 0 END AS is_systemic_io\n    FROM {{ ref('std_px_claims') }} px\n    INNER JOIN bc_patient_pool pool ON px.PATIENT_ID = pool.PATIENT_ID\n    WHERE px.PROCEDURE_CODE IN (\n        -- TURBT\n        '52214', '52224', '52234', '52235', '52240',\n        -- BCG\n        'J9030', 'J9031', '90586',\n        -- Cystectomy\n        '51550', '51555', '51565', '51570', '51575', '51580', '51585', '51590', '51595', '51596',\n        -- Intravesical\n        '51720', 'J9357', 'J9201', 'J9280', 'J9000',\n        -- Systemic Immunotherapy\n        'J9271', 'J9299', 'J9022', 'C9483', 'J9213', 'J9214', 'J9215'\n    )\n),\n\n-- Calculate repeat TURBT with gap >= 6 weeks (RSK-103)\nturbt_sequence AS (\n    SELECT \n        PATIENT_ID,\n        SERVICE_DATE,\n        LAG(SERVICE_DATE) OVER (PARTITION BY PATIENT_ID ORDER BY SERVICE_DATE) AS prev_turbt_date,\n        DATEDIFF('week', LAG(SERVICE_DATE) OVER (PARTITION BY PATIENT_ID ORDER BY SERVICE_DATE), SERVICE_DATE) AS weeks_gap\n    FROM px_claims\n    WHERE is_turbt = 1\n),\nrepeat_turbt_metrics AS (\n    SELECT \n        PATIENT_ID,\n        MAX(CASE WHEN weeks_gap >= 6 THEN 1 ELSE 0 END) AS has_repeat_turbt,\n        MAX(SERVICE_DATE) AS latest_turbt_date\n    FROM turbt_sequence\n    WHERE prev_turbt_date IS NOT NULL\n    GROUP BY PATIENT_ID\n),\n\n-- BCG dates for Early Repeat TURBT check (RSK-103)\nbcg_dates AS (\n    SELECT \n        PATIENT_ID,\n        MAX(SERVICE_DATE) AS latest_bcg_date\n    FROM px_claims\n    WHERE is_bcg = 1\n    GROUP BY PATIENT_ID\n),\n\n-- Aggregate PX metrics per patient\npx_metrics AS (\n    SELECT\n        PATIENT_ID,\n        -- TURBT counts\n        SUM(is_turbt) AS turbt_count,\n        SUM(CASE WHEN turbt_size = 'MINOR' THEN 1 ELSE 0 END) AS turbt_minor_count,\n        SUM(CASE WHEN turbt_size = 'SMALL' THEN 1 ELSE 0 END) AS turbt_small_count,\n        SUM(CASE WHEN turbt_size = 'MEDIUM' THEN 1 ELSE 0 END) AS turbt_medium_count,\n        SUM(CASE WHEN turbt_size = 'LARGE' THEN 1 ELSE 0 END) AS turbt_large_count,\n        SUM(CASE WHEN turbt_size = 'GENERAL' THEN 1 ELSE 0 END) AS turbt_general_count,\n        -- Treatment flags\n        MAX(is_bcg) AS has_bcg,\n        MAX(is_cystectomy) AS has_cystectomy,\n        MAX(is_intravesical) AS has_intravesical,\n        MAX(is_systemic_io) AS has_systemic_io,\n        -- Treatment counts\n        SUM(is_bcg) AS bcg_count,\n        SUM(is_cystectomy) AS cystectomy_count,\n        SUM(is_intravesical) AS intravesical_count,\n        -- Latest treatment dates (for 12-month window checks)\n        MAX(CASE WHEN is_turbt = 1 OR is_bcg = 1 OR is_intravesical = 1 THEN SERVICE_DATE END) AS latest_treatment_date,\n        MAX(CASE WHEN is_cystectomy = 1 THEN SERVICE_DATE END) AS latest_cystectomy_date,\n        MAX(CASE WHEN is_systemic_io = 1 THEN SERVICE_DATE END) AS latest_systemic_io_date\n    FROM px_claims\n    GROUP BY PATIENT_ID\n),\n\n-- ============================================\n-- Step 3: Identify NMIBC patients (NMI-010 to NMI-014)\n-- ============================================\nnmibc_eligible AS (\n    SELECT\n        bp.PATIENT_ID,\n        bp.EARLIEST_BC_EVENT_DATE,\n        bp.LATEST_BC_EVENT_DATE,\n        bp.PATIENT_GENDER,\n        bp.PATIENT_BIRTH_YEAR,\n        bp.PATIENT_ZIP3,\n        -- DX metrics\n        COALESCE(dg.cis_dx_count, 0) AS cis_dx_count,\n        COALESCE(dg.dx_date_span, 0) AS dx_date_span,\n        COALESCE(dg.distinct_dx_dates, 0) AS distinct_dx_dates,\n        -- PX metrics\n        COALESCE(px.turbt_count, 0) AS turbt_count,\n        COALESCE(px.turbt_minor_count, 0) AS turbt_minor_count,\n        COALESCE(px.turbt_small_count, 0) AS turbt_small_count,\n        COALESCE(px.turbt_medium_count, 0) AS turbt_medium_count,\n        COALESCE(px.turbt_large_count, 0) AS turbt_large_count,\n        COALESCE(px.has_bcg, 0) AS has_bcg,\n        COALESCE(px.has_cystectomy, 0) AS has_cystectomy,\n        COALESCE(px.has_intravesical, 0) AS has_intravesical,\n        COALESCE(px.has_systemic_io, 0) AS has_systemic_io,\n        COALESCE(px.bcg_count, 0) AS bcg_count,\n        COALESCE(px.intravesical_count, 0) AS intravesical_count,\n        px.latest_treatment_date,\n        px.latest_cystectomy_date,\n        px.latest_systemic_io_date,\n        -- Repeat TURBT metrics\n        COALESCE(rt.has_repeat_turbt, 0) AS has_repeat_turbt,\n        rt.latest_turbt_date,\n        -- BCG dates\n        bd.latest_bcg_date,\n        -- NMIBC eligibility flags\n        CASE WHEN dg.distinct_dx_dates >= 2 AND dg.dx_date_span >= 30 THEN 'Y' ELSE 'N' END AS has_confirmed_bc,  -- NMI-011\n        CASE WHEN bp.IDENTIFIED_VIA_PX = 'Y' OR bp.IDENTIFIED_VIA_RX = 'Y' THEN 'Y' ELSE 'N' END AS has_treatment,  -- NMI-012\n        CASE WHEN px.latest_treatment_date >= '2024-01-01' THEN 'Y' ELSE 'N' END AS has_recent_treatment,  -- NMI-013\n        CASE WHEN COALESCE(px.turbt_count, 0) >= 1 THEN 'Y' ELSE 'N' END AS has_turbt  -- NMI-014\n    FROM bc_patients bp\n    LEFT JOIN dx_gap_calc dg ON bp.PATIENT_ID = dg.PATIENT_ID\n    LEFT JOIN px_metrics px ON bp.PATIENT_ID = px.PATIENT_ID\n    LEFT JOIN repeat_turbt_metrics rt ON bp.PATIENT_ID = rt.PATIENT_ID\n    LEFT JOIN bcg_dates bd ON bp.PATIENT_ID = bd.PATIENT_ID\n),\n\n-- Filter to NMIBC patients only\nnmibc_patients AS (\n    SELECT *\n    FROM nmibc_eligible\n    WHERE has_confirmed_bc = 'Y'\n      AND has_treatment = 'Y'\n      AND has_recent_treatment = 'Y'\n      AND has_turbt = 'Y'\n),\n\n-- ============================================\n-- Step 4: Apply Risk Stratification (Flowchart-Based: RSK-100 to RSK-300)\n-- ============================================\nrisk_assigned AS (\n    SELECT\n        np.*,\n        cdd.data_date,\n        CASE\n            -- STEP 1: HIGH RISK (RSK-100 to RSK-103)\n            -- RSK-100: CIS >= 1 AND BCG (both required)\n            WHEN cis_dx_count >= 1 AND has_bcg = 1 THEN 'HIGH'\n            \n            -- RSK-101: Cystectomy within 12 months from data_date\n            WHEN has_cystectomy = 1 \n                 AND latest_cystectomy_date >= DATEADD('month', -12, cdd.data_date) THEN 'HIGH'\n            \n            -- RSK-102: Systemic IO within 12 months from data_date\n            WHEN has_systemic_io = 1 \n                 AND latest_systemic_io_date >= DATEADD('month', -12, cdd.data_date) THEN 'HIGH'\n            \n            -- RSK-103: BCG + Early Repeat TURBT (within 3 months, BCG within 12 months from data_date)\n            WHEN has_bcg = 1 \n                 AND has_repeat_turbt = 1\n                 AND latest_turbt_date <= DATEADD('month', 3, latest_bcg_date)\n                 AND latest_bcg_date >= DATEADD('month', -12, cdd.data_date) THEN 'HIGH'\n            \n            -- STEP 2: LOW RISK (RSK-200)\n            -- ALL criteria absent: No CIS, No BCG, No Intravesical, No repeat TURBT, No Cystectomy, No Systemic IO\n            WHEN cis_dx_count = 0 \n                 AND has_bcg = 0 \n                 AND has_intravesical = 0 \n                 AND has_repeat_turbt = 0\n                 AND has_cystectomy = 0 \n                 AND has_systemic_io = 0 THEN 'LOW'\n            \n            -- STEP 3: INTERMEDIATE RISK (RSK-300)\n            -- Does NOT meet High AND Does NOT meet all Low\n            ELSE 'INTERMEDIATE'\n        END AS nmibc_risk_tier,\n        \n        CASE\n            -- STEP 1: HIGH RISK rules\n            WHEN cis_dx_count >= 1 AND has_bcg = 1 THEN 'RSK-100'\n            WHEN has_cystectomy = 1 \n                 AND latest_cystectomy_date >= DATEADD('month', -12, cdd.data_date) THEN 'RSK-101'\n            WHEN has_systemic_io = 1 \n                 AND latest_systemic_io_date >= DATEADD('month', -12, cdd.data_date) THEN 'RSK-102'\n            WHEN has_bcg = 1 \n                 AND has_repeat_turbt = 1\n                 AND latest_turbt_date <= DATEADD('month', 3, latest_bcg_date)\n                 AND latest_bcg_date >= DATEADD('month', -12, cdd.data_date) THEN 'RSK-103'\n            -- STEP 2: LOW RISK rule\n            WHEN cis_dx_count = 0 \n                 AND has_bcg = 0 \n                 AND has_intravesical = 0 \n                 AND has_repeat_turbt = 0\n                 AND has_cystectomy = 0 \n                 AND has_systemic_io = 0 THEN 'RSK-200'\n            -- STEP 3: INTERMEDIATE RISK rule\n            ELSE 'RSK-300'\n        END AS risk_assigned_by_rule\n    FROM nmibc_patients np\n    CROSS JOIN config_data_date cdd\n)\n\n-- Final output\nSELECT\n    PATIENT_ID,\n    -- NMIBC flag\n    'Y' AS nmibc_flag,\n    -- Risk tier\n    nmibc_risk_tier,\n    risk_assigned_by_rule,\n    -- Demographics\n    PATIENT_GENDER,\n    PATIENT_BIRTH_YEAR,\n    PATIENT_ZIP3,\n    -- Event dates\n    EARLIEST_BC_EVENT_DATE,\n    LATEST_BC_EVENT_DATE,\n    latest_treatment_date,\n    -- DX metrics\n    cis_dx_count,\n    dx_date_span,\n    distinct_dx_dates,\n    -- TURBT metrics by size\n    turbt_count,\n    turbt_minor_count,\n    turbt_small_count,\n    turbt_medium_count,\n    turbt_large_count,\n    -- Treatment flags\n    has_bcg,\n    has_cystectomy,\n    has_intravesical,\n    has_systemic_io,\n    has_repeat_turbt,\n    bcg_count,\n    intravesical_count,\n    -- Treatment dates (for validation)\n    latest_cystectomy_date,\n    latest_systemic_io_date,\n    latest_turbt_date,\n    latest_bcg_date,\n    -- Eligibility flags\n    has_confirmed_bc,\n    has_treatment,\n    has_recent_treatment,\n    has_turbt,\n    -- Metadata\n    data_date\nFROM risk_assigned", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_bc_patient_pool", "package": null, "version": null}, {"name": "std_dx_claims", "package": null, "version": null}, {"name": "std_px_claims", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.stg_bc_patient_pool", "model.CGOncology_MDM.std_dx_claims", "model.CGOncology_MDM.std_px_claims"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["patient_id"], "time_spine": null}, "model.CGOncology_MDM.adm_hcp_master": {"database": "CGONCOLOGY_TEST", "schema": "ADM", "name": "adm_hcp_master", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "adm/adm_hcp_master.sql", "original_file_path": "models/adm/adm_hcp_master.sql", "unique_id": "model.CGOncology_MDM.adm_hcp_master", "fqn": ["CGOncology_MDM", "adm", "adm_hcp_master"], "alias": "adm_hcp_master", "checksum": {"name": "sha256", "checksum": "54cc9a49f42e62a8ce9ee6a3d51cec84b3493d7e4b8cec01ee42d54976ccca85"}, "config": {"enabled": true, "alias": null, "schema": "ADM", "database": null, "tags": ["layer_4_adm", "customer_backbone", "customer_backbone", "adm"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_4_adm", "customer_backbone", "adm"], "description": "Comprehensive HCP master with best affiliation, hierarchy, targets, and metrics.\nBusiness Rules: SRV-030 to SRV-032, BBN-011 to BBN-019, TGT-030\nGrain: One row per kmk_hcp_id\n", "columns": {"kmk_hcp_id": {"name": "kmk_hcp_id", "description": "KMK HCP identifier (primary key)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "npi": {"name": "npi", "description": "National Provider Identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "cust_backbone_flag": {"name": "cust_backbone_flag", "description": "Customer backbone flag (Y/N)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "kam_target_flag": {"name": "kam_target_flag", "description": "KAM target flag (Y/N)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "kam_decile": {"name": "kam_decile", "description": "KAM decile (1-10)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "target_version": {"name": "target_version", "description": "SFE target version", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/adm/schema.yml", "build_path": null, "unrendered_config": {"schema": "ADM", "materialized": "table", "tags": ["customer_backbone", "adm"]}, "created_at": 1770177079.5850172, "relation_name": "CGONCOLOGY_TEST.ADM.adm_hcp_master", "raw_code": "{{\n    config(\n        schema='ADM',\n        materialized='table',\n        tags=['customer_backbone', 'adm']\n    )\n}}\n\n/*\nPROC-ADM-010: adm_hcp_master - Comprehensive HCP Master with Best Affiliation\nBusiness Rules: SRV-030 to SRV-032, BBN-011 to BBN-019, TGT-030, MAT-030 to MAT-060\n\nSingle source of truth for HCP data with:\n- Core HCP identity from MDM\n- Best HCO affiliation for each HCP\n- Hierarchy levels (L1-L4) inherited from best HCO\n- Target and territory information\n- Backbone flag\n- Enrichment data: Aissel rankings, Clinical Trials, MSL Engagement\n\nGrain: One row per kmk_hcp_id\n*/\n\nWITH hcp_master AS (\n    -- Core HCP attributes from MDM\n    -- (medscout_count, has_medscout_match, dh_id removed from output)\n    SELECT\n        m.kmk_hcp_id,\n        m.npi,\n        m.first_name,\n        m.last_name,\n        m.primary_specialty,\n        m.primary_specialty_group,  -- Added for SPECIALTY_GROUP column\n        m.practice_address_line_1,\n        m.practice_city,\n        m.practice_state,\n        m.practice_zip_code,\n        m.primary_source\n    FROM {{ ref('mdm_customer_master_hcp') }} m\n),\n\nbest_affiliation AS (\n    -- Best HCO affiliation for each HCP (using history table current records)\n    -- (affiliation_step, affiliation_source, confidence_level, match_status removed from output)\n    SELECT\n        ba.kmk_hcp_id,\n        ba.best_kmk_hco_id,\n        ba.best_hco_name,\n        ba.best_hco_firm_type\n    FROM {{ ref('mdm_best_affiliation_hist') }} ba\n    WHERE ba.is_current = 'Y'\n),\n\nhco_hierarchy AS (\n    -- Hierarchy levels from best HCO (for territory lookup)\n    -- (hierarchy_level, account_id_l1-l4, pe_*, has_hierarchy removed from output)\n    SELECT\n        h.kmk_hco_id,\n        h.account_id,\n        h.kam_territory,\n        h.kam_territory_name,\n        h.kam_region,\n        h.kam_region_name,\n        h.hsd_territory,\n        h.hsd_territory_name,\n        h.msl_territory,\n        h.msl_territory_name\n    FROM {{ ref('adm_hco_hierarchy') }} h\n),\n\nhcp_bc_metrics AS (\n    -- HCP backbone flag and BC metrics (joins via NPI)\n    SELECT\n        npi,\n        bc_patient_count,\n        bc_backbone_flag,\n        bc_volume_tier\n    FROM {{ ref('stg_hcp_bc_metrics') }}\n),\n\n-- SFE: HCP Targets (Consolidated Source)\n-- NOTE: Hardcoded reference to existing ADM table (SFE models disabled in dbt_project.yml)\nsfe_targets AS (\n    SELECT\n        kmk_hcp_id,\n        kam_target_flag,\n        kam_decile,\n        target_version\n    FROM {{ target.database }}.ADM.adm_sfe_hcp_targets\n    WHERE target_version = '{{ var(\"sfe_version\") }}'\n),\n\n-- BBN-017: Profiled accounts from REPORTING layer\nprofiled_accounts AS (\n    SELECT DISTINCT accounts_profiled AS account_id\n    FROM {{ source('cgoncology_dev_reporting', 'ACTIVITY_DASHBOARD_METRICS') }}\n    WHERE accounts_profiled IS NOT NULL\n),\n\n-- Aissel/Konectar Rankings\n-- Deduplicate: ensure one row per NPI (use most recent record if date exists)\naissel_data AS (\n    SELECT\n        CAST(NPI_NUMBER AS VARCHAR(20)) AS npi,\n        RANK AS aissel_rank,\n        EVENTS_COUNT AS aissel_events_count,\n        AFFILIATIONS_COUNT AS aissel_affiliations_count,\n        PUBLICATIONS_COUNT AS aissel_publications_count,\n        TRIAL_COUNT AS aissel_trial_count\n    FROM {{ source('cgoncology_dev_adm', 'HCP_AISSEL') }}\n    QUALIFY ROW_NUMBER() OVER (\n        PARTITION BY NPI_NUMBER\n        ORDER BY RANK NULLS LAST\n    ) = 1\n),\n\n-- Clinical Trial PI Flag\nclinical_trials AS (\n    SELECT DISTINCT \"PI NPI\" AS pi_npi\n    FROM {{ source('cgoncology_dev_reporting', 'CLINICAL_TRIAL_DATA') }}\n    WHERE \"PI NPI\" IS NOT NULL\n),\n\n-- MSL Engagement (Last Interaction Date)\nmsl_engagement AS (\n    WITH interactions AS (\n        SELECT NPI_NUMBER AS npi, INTERACTION_DATE AS interaction_date FROM {{ source('cgoncology_dev_adm', 'MEDICAL_INTERACTIONS') }}\n        UNION ALL\n        SELECT NPI_NUMBER AS npi, INSIGHT_DATE AS interaction_date FROM {{ source('cgoncology_dev_adm', 'MEDICAL_INSIGHTS') }}\n    )\n    SELECT\n        npi,\n        MAX(interaction_date) AS last_msl_engaged_date\n    FROM interactions\n    WHERE npi IS NOT NULL\n    GROUP BY npi\n),\n\n-- NOTE: treatment_metrics CTE removed - get treatment claims from adm_claims_metrics_long directly\n\nfinal_output AS (\n    SELECT\n        -- ============================================================\n        -- Core HCP Identity (dh_id removed - was just NPI duplicated)\n        -- ============================================================\n        hcp.kmk_hcp_id,\n        hcp.npi AS npi,\n        hcp.first_name,\n        hcp.last_name,\n        hcp.primary_specialty,\n        hcp.primary_specialty_group AS specialty_group,  -- NEW: Added per Phase 5\n        'Active' AS status,\n\n        -- ============================================================\n        -- HCP Address\n        -- ============================================================\n        hcp.practice_address_line_1 AS address_line1,\n        hcp.practice_city AS city,\n        hcp.practice_state AS state,\n        hcp.practice_zip_code AS zip,\n\n        -- ============================================================\n        -- Backbone (bc_patient_count removed per user request)\n        -- (HAS_PROFILING_DATA removed - compute from profiled_accounts if needed)\n        -- ============================================================\n        -- CUST_BACKBONE_FLAG logic: BBN-011 to BBN-019\n        -- Urologists and HCPs with BC treatment/RX claims get backbone flag REGARDLESS of affiliation\n        -- Other criteria (profiled accounts, targets) require affiliation\n        CASE\n            -- BBN-011: Urologists and HCPs with BC treatment/RX claims get backbone flag even without affiliation\n            WHEN bcm.bc_backbone_flag = 'Y' THEN 'Y'\n            -- BBN-017/019: Profiled accounts and targets require affiliation\n            WHEN ba.best_kmk_hco_id IS NOT NULL AND (\n                pa.account_id IS NOT NULL\n                OR tgt.kam_target_flag = 'Y'\n            ) THEN 'Y'\n            ELSE 'N'\n        END AS cust_backbone_flag,\n\n        -- ============================================================\n        -- Target & Decile\n        -- ============================================================\n        COALESCE(tgt.kam_target_flag, 'N') AS kam_target_flag,\n        tgt.kam_decile,\n        tgt.target_version,\n\n        -- ============================================================\n        -- Best HCO Affiliation (simplified)\n        -- (affiliation_step, affiliation_source, affiliation_confidence, affiliation_status removed)\n        -- ============================================================\n        ba.best_kmk_hco_id,\n        ba.best_hco_name,\n        ba.best_hco_firm_type,\n        hh.account_id AS best_hco_account_id,\n\n        -- ============================================================\n        -- NOTE: The following columns have been REMOVED (denormalized - get from source tables):\n        -- HCO_HIERARCHY_LEVEL, HIERARCHY_L1-L4, HAS_HIERARCHY - get from adm_hco_hierarchy\n        -- BEST_HCO_PE_ID, BEST_HCO_PE_NAME, BEST_HCO_PE_FLAG - get from adm_hco_hierarchy\n        -- Treatment Claims (14 cols) - get from adm_claims_metrics_long\n        -- MEDSCOUT_IDS, MEDSCOUT_COUNT, HAS_MEDSCOUT_MATCH - get from mdm_customer_master_hcp\n        -- MODIFIED_DATE, DATA_DATE - metadata columns removed\n        -- ============================================================\n\n        -- ============================================================\n        -- Territory (Inherited from best HCO)\n        -- ============================================================\n        hh.kam_territory,\n        hh.kam_territory_name,\n        hh.kam_region,\n        hh.kam_region_name,\n        hh.hsd_territory,\n        hh.hsd_territory_name,\n        hh.msl_territory,\n        hh.msl_territory_name,\n\n        -- ============================================================\n        -- Enrichment Data (Aissel, Trials, Engagement)\n        -- ============================================================\n        a.aissel_rank AS aissel_konectar_rank,\n        a.aissel_events_count AS aissel_konectar_events_count,\n        a.aissel_affiliations_count AS aissel_konectar_affiliations_count,\n        a.aissel_publications_count AS aissel_konectar_publications_count,\n        a.aissel_trial_count AS aissel_konectar_trial_count,\n        CASE WHEN ct.pi_npi IS NOT NULL THEN 'Y' ELSE 'N' END AS clinical_trial_pi_flag,\n        msl.last_msl_engaged_date,\n\n        -- ============================================================\n        -- Metadata (simplified)\n        -- ============================================================\n        hcp.primary_source\n\n    FROM hcp_master hcp\n    LEFT JOIN best_affiliation ba ON hcp.kmk_hcp_id = ba.kmk_hcp_id\n    LEFT JOIN hco_hierarchy hh ON ba.best_kmk_hco_id = hh.kmk_hco_id\n    LEFT JOIN hcp_bc_metrics bcm ON hcp.npi = bcm.npi\n    LEFT JOIN sfe_targets tgt ON hcp.kmk_hcp_id = tgt.kmk_hcp_id\n    LEFT JOIN profiled_accounts pa ON hh.account_id = pa.account_id\n    LEFT JOIN aissel_data a ON hcp.npi = a.npi\n    LEFT JOIN clinical_trials ct ON hcp.npi = ct.pi_npi\n    LEFT JOIN msl_engagement msl ON hcp.npi = msl.npi\n)\n-- Deduplicate: Ensure one row per kmk_hcp_id\n-- If duplicates exist, prioritize by backbone flag and target flag\nSELECT * FROM final_output\nQUALIFY ROW_NUMBER() OVER (PARTITION BY kmk_hcp_id ORDER BY\n    CASE WHEN cust_backbone_flag = 'Y' THEN 1 ELSE 2 END,\n    CASE WHEN kam_target_flag = 'Y' THEN 1 ELSE 2 END,\n    best_kmk_hco_id NULLS LAST\n) = 1", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hcp", "package": null, "version": null}, {"name": "mdm_best_affiliation_hist", "package": null, "version": null}, {"name": "adm_hco_hierarchy", "package": null, "version": null}, {"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [["cgoncology_dev_reporting", "ACTIVITY_DASHBOARD_METRICS"], ["cgoncology_dev_adm", "HCP_AISSEL"], ["cgoncology_dev_reporting", "CLINICAL_TRIAL_DATA"], ["cgoncology_dev_adm", "MEDICAL_INTERACTIONS"], ["cgoncology_dev_adm", "MEDICAL_INSIGHTS"]], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["source.CGOncology_MDM.cgoncology_dev_reporting.ACTIVITY_DASHBOARD_METRICS", "source.CGOncology_MDM.cgoncology_dev_adm.HCP_AISSEL", "source.CGOncology_MDM.cgoncology_dev_reporting.CLINICAL_TRIAL_DATA", "source.CGOncology_MDM.cgoncology_dev_adm.MEDICAL_INTERACTIONS", "source.CGOncology_MDM.cgoncology_dev_adm.MEDICAL_INSIGHTS", "model.CGOncology_MDM.mdm_customer_master_hcp", "model.CGOncology_MDM.mdm_best_affiliation_hist", "model.CGOncology_MDM.adm_hco_hierarchy", "model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["kmk_hcp_id"], "time_spine": null}, "model.CGOncology_MDM.adm_ddd_metrics_wide": {"database": "CGONCOLOGY_TEST", "schema": "ADM", "name": "adm_ddd_metrics_wide", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "adm/adm_ddd_metrics_wide.sql", "original_file_path": "models/adm/adm_ddd_metrics_wide.sql", "unique_id": "model.CGOncology_MDM.adm_ddd_metrics_wide", "fqn": ["CGOncology_MDM", "adm", "adm_ddd_metrics_wide"], "alias": "adm_ddd_metrics_wide", "checksum": {"name": "sha256", "checksum": "4a119a4fc2cba22e7076fdce2e772515991d503917f2c79f93097d3a8a86732c"}, "config": {"enabled": true, "alias": null, "schema": "ADM", "database": null, "tags": ["layer_4_adm", "customer_backbone", "customer_backbone", "adm", "ddd"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_4_adm", "customer_backbone", "adm", "ddd"], "description": "DDD sales metrics by account (wide format with 24 monthly columns).\nBusiness Rules: MET-060 to MET-074\nGrain: (kmk_hco_id, metric_category)\n", "columns": {"kmk_hco_id": {"name": "kmk_hco_id", "description": "KMK HCO identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "metric_category": {"name": "metric_category", "description": "Product category", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "tice_bcg_sales_12mo": {"name": "tice_bcg_sales_12mo", "description": "TICE BCG sales (12 months)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "adstiladrin_sales_12mo": {"name": "adstiladrin_sales_12mo", "description": "Adstiladrin sales (12 months)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "anktiva_sales_12mo": {"name": "anktiva_sales_12mo", "description": "Anktiva sales (12 months)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/adm/schema.yml", "build_path": null, "unrendered_config": {"schema": "ADM", "materialized": "table", "tags": ["customer_backbone", "adm", "ddd"]}, "created_at": 1770177079.5867362, "relation_name": "CGONCOLOGY_TEST.ADM.adm_ddd_metrics_wide", "raw_code": "{{\n    config(\n        schema='ADM',\n        materialized='table',\n        tags=['customer_backbone', 'adm', 'ddd']\n    )\n}}\n\n/*\nADM_DDD_METRICS_WIDE - DDD Sales Metrics in Wide Format (Pivoted)\nSource: adm_ddd_metrics_long (single source of truth)\nBusiness Rules: MET-060 to MET-074\n\nGRAIN: One row per (kmk_hco_id, metric_category)\n- Matches adm_hco_claims_wide grain structure\n\nSIMPLIFIED ARCHITECTURE (Jan 2026 Refactor):\n- Source: adm_ddd_metrics_long (already has L1-L4 rollups with proper exclusion filters)\n- Logic: Simple PIVOT from long to wide format per metric category\n- No redundant aggregation - long table is the single source of truth\n\nMetric Categories:\n- TICE_BCG: product_group_id IN (3, 4)\n- ADSTILADRIN: product_group_id = 1\n- ANKTIVA: product_group_id = 2\n- INLEXZO: product_group_id = 7\n- TOTAL_BRANDED: ADSTILADRIN + ANKTIVA\n- TOTAL: All products\n\nPeriod Columns:\n- Monthly: M01-M24 (sales and units)\n- Rolling: L3M, L6M, L12M, L18M, L24M (sales and units)\n- Quarterly: Q01-Q08 (sales and units)\n- Annual: YTD, PYTD, PY, P2Y, QTD (sales and units)\n- Calendar Years: CY, PY_CY, P2Y_CY (sales and units)\n- TOTAL: All-time (sales and units)\n\nHCO Attributes: Joined from adm_hco_hierarchy and adm_hco_master\n*/\n\n-- Get data_date reference\nWITH data_date_ref AS (\n    SELECT DISTINCT data_date, YEAR(data_date) AS current_year\n    FROM {{ ref('ref_time_periods') }}\n    LIMIT 1\n),\n\n-- Long metrics filtered to HCO only\nlong_metrics AS (\n    SELECT\n        entity_id AS kmk_hco_id,\n        metric_category,\n        period_key,\n        period_type,\n        sales_amount,\n        units_count,\n        outlet_count,\n        data_date\n    FROM {{ ref('adm_ddd_metrics_long') }}\n    WHERE entity_type = 'HCO'\n),\n\n-- Get HCO attributes from adm_hco_hierarchy\n-- NOTE: account_type is NOT included here due to circular dependency\n-- (adm_hco_master depends on adm_ddd_metrics_wide, so we can't source account_type from it)\n-- Use adm_hco_master for account_type when needed downstream\nhco_attributes AS (\n    SELECT\n        h.kmk_hco_id,\n        h.dh_id,\n        h.org_name,\n        h.hierarchy_level,\n        h.firm_type,\n        h.hq_state,\n        h.kam_territory,\n        h.kam_region\n    FROM {{ ref('adm_hco_hierarchy') }} h\n),\n\n-- Pivot to wide format - GROUP BY (kmk_hco_id, metric_category)\npivoted_metrics AS (\n    SELECT\n        m.kmk_hco_id,\n        m.metric_category,\n        MAX(m.data_date) AS data_date,\n\n        -- ============================================================\n        -- MONTHLY SALES (M01-M24)\n        -- Note: Using COALESCE(MAX(...), 0) to preserve negative values\n        -- ============================================================\n        COALESCE(MAX(CASE WHEN period_key = 'M01' THEN sales_amount END), 0) AS M01_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M02' THEN sales_amount END), 0) AS M02_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M03' THEN sales_amount END), 0) AS M03_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M04' THEN sales_amount END), 0) AS M04_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M05' THEN sales_amount END), 0) AS M05_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M06' THEN sales_amount END), 0) AS M06_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M07' THEN sales_amount END), 0) AS M07_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M08' THEN sales_amount END), 0) AS M08_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M09' THEN sales_amount END), 0) AS M09_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M10' THEN sales_amount END), 0) AS M10_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M11' THEN sales_amount END), 0) AS M11_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M12' THEN sales_amount END), 0) AS M12_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M13' THEN sales_amount END), 0) AS M13_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M14' THEN sales_amount END), 0) AS M14_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M15' THEN sales_amount END), 0) AS M15_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M16' THEN sales_amount END), 0) AS M16_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M17' THEN sales_amount END), 0) AS M17_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M18' THEN sales_amount END), 0) AS M18_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M19' THEN sales_amount END), 0) AS M19_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M20' THEN sales_amount END), 0) AS M20_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M21' THEN sales_amount END), 0) AS M21_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M22' THEN sales_amount END), 0) AS M22_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M23' THEN sales_amount END), 0) AS M23_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M24' THEN sales_amount END), 0) AS M24_SALES,\n\n        -- ============================================================\n        -- MONTHLY UNITS (M01-M24)\n        -- ============================================================\n        COALESCE(MAX(CASE WHEN period_key = 'M01' THEN units_count END), 0) AS M01_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M02' THEN units_count END), 0) AS M02_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M03' THEN units_count END), 0) AS M03_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M04' THEN units_count END), 0) AS M04_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M05' THEN units_count END), 0) AS M05_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M06' THEN units_count END), 0) AS M06_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M07' THEN units_count END), 0) AS M07_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M08' THEN units_count END), 0) AS M08_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M09' THEN units_count END), 0) AS M09_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M10' THEN units_count END), 0) AS M10_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M11' THEN units_count END), 0) AS M11_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M12' THEN units_count END), 0) AS M12_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M13' THEN units_count END), 0) AS M13_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M14' THEN units_count END), 0) AS M14_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M15' THEN units_count END), 0) AS M15_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M16' THEN units_count END), 0) AS M16_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M17' THEN units_count END), 0) AS M17_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M18' THEN units_count END), 0) AS M18_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M19' THEN units_count END), 0) AS M19_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M20' THEN units_count END), 0) AS M20_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M21' THEN units_count END), 0) AS M21_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M22' THEN units_count END), 0) AS M22_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M23' THEN units_count END), 0) AS M23_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M24' THEN units_count END), 0) AS M24_UNITS,\n\n        -- ============================================================\n        -- ROLLING SALES (L3M-L24M)\n        -- ============================================================\n        COALESCE(MAX(CASE WHEN period_key = 'L3M' THEN sales_amount END), 0) AS L3M_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'L6M' THEN sales_amount END), 0) AS L6M_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'L12M' THEN sales_amount END), 0) AS L12M_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'L18M' THEN sales_amount END), 0) AS L18M_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'L24M' THEN sales_amount END), 0) AS L24M_SALES,\n\n        -- ============================================================\n        -- ROLLING UNITS (L3M-L24M)\n        -- ============================================================\n        COALESCE(MAX(CASE WHEN period_key = 'L3M' THEN units_count END), 0) AS L3M_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'L6M' THEN units_count END), 0) AS L6M_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'L12M' THEN units_count END), 0) AS L12M_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'L18M' THEN units_count END), 0) AS L18M_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'L24M' THEN units_count END), 0) AS L24M_UNITS,\n\n        -- ============================================================\n        -- QUARTERLY SALES (Q01-Q08)\n        -- ============================================================\n        COALESCE(MAX(CASE WHEN period_key = 'Q01' THEN sales_amount END), 0) AS Q01_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'Q02' THEN sales_amount END), 0) AS Q02_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'Q03' THEN sales_amount END), 0) AS Q03_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'Q04' THEN sales_amount END), 0) AS Q04_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'Q05' THEN sales_amount END), 0) AS Q05_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'Q06' THEN sales_amount END), 0) AS Q06_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'Q07' THEN sales_amount END), 0) AS Q07_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'Q08' THEN sales_amount END), 0) AS Q08_SALES,\n\n        -- ============================================================\n        -- QUARTERLY UNITS (Q01-Q08)\n        -- ============================================================\n        COALESCE(MAX(CASE WHEN period_key = 'Q01' THEN units_count END), 0) AS Q01_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'Q02' THEN units_count END), 0) AS Q02_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'Q03' THEN units_count END), 0) AS Q03_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'Q04' THEN units_count END), 0) AS Q04_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'Q05' THEN units_count END), 0) AS Q05_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'Q06' THEN units_count END), 0) AS Q06_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'Q07' THEN units_count END), 0) AS Q07_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'Q08' THEN units_count END), 0) AS Q08_UNITS,\n\n        -- ============================================================\n        -- ANNUAL SALES (YTD, PYTD, PY, P2Y, QTD)\n        -- ============================================================\n        COALESCE(MAX(CASE WHEN period_type = 'YTD' THEN sales_amount END), 0) AS YTD_SALES,\n        COALESCE(MAX(CASE WHEN period_type = 'PYTD' THEN sales_amount END), 0) AS PYTD_SALES,\n        COALESCE(MAX(CASE WHEN period_type = 'PY' THEN sales_amount END), 0) AS PY_SALES,\n        COALESCE(MAX(CASE WHEN period_type = 'P2Y' THEN sales_amount END), 0) AS P2Y_SALES,\n        COALESCE(MAX(CASE WHEN period_type = 'QTD' THEN sales_amount END), 0) AS QTD_SALES,\n\n        -- ============================================================\n        -- ANNUAL UNITS (YTD, PYTD, PY, P2Y, QTD)\n        -- ============================================================\n        COALESCE(MAX(CASE WHEN period_type = 'YTD' THEN units_count END), 0) AS YTD_UNITS,\n        COALESCE(MAX(CASE WHEN period_type = 'PYTD' THEN units_count END), 0) AS PYTD_UNITS,\n        COALESCE(MAX(CASE WHEN period_type = 'PY' THEN units_count END), 0) AS PY_UNITS,\n        COALESCE(MAX(CASE WHEN period_type = 'P2Y' THEN units_count END), 0) AS P2Y_UNITS,\n        COALESCE(MAX(CASE WHEN period_type = 'QTD' THEN units_count END), 0) AS QTD_UNITS,\n\n        -- ============================================================\n        -- TOTAL (All-Time)\n        -- ============================================================\n        COALESCE(MAX(CASE WHEN period_key = 'TOTAL' THEN sales_amount END), 0) AS TOTAL_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'TOTAL' THEN units_count END), 0) AS TOTAL_UNITS,\n\n        -- ============================================================\n        -- OUTLET COUNT (from L12M rolling period)\n        -- ============================================================\n        COALESCE(MAX(CASE WHEN period_key = 'L12M' THEN outlet_count END), 0) AS outlet_count\n\n    FROM long_metrics m\n    GROUP BY m.kmk_hco_id, m.metric_category\n),\n\n-- Calendar year metrics (need to pivot dynamically based on current year)\ncalendar_year_metrics AS (\n    SELECT\n        m.kmk_hco_id,\n        m.metric_category,\n        COALESCE(MAX(CASE WHEN REGEXP_LIKE(period_key, '^[0-9]{4}$') AND TRY_CAST(period_key AS INTEGER) = ddr.current_year THEN sales_amount END), 0) AS CY_SALES,\n        COALESCE(MAX(CASE WHEN REGEXP_LIKE(period_key, '^[0-9]{4}$') AND TRY_CAST(period_key AS INTEGER) = ddr.current_year - 1 THEN sales_amount END), 0) AS PY_CY_SALES,\n        COALESCE(MAX(CASE WHEN REGEXP_LIKE(period_key, '^[0-9]{4}$') AND TRY_CAST(period_key AS INTEGER) = ddr.current_year - 2 THEN sales_amount END), 0) AS P2Y_CY_SALES,\n        COALESCE(MAX(CASE WHEN REGEXP_LIKE(period_key, '^[0-9]{4}$') AND TRY_CAST(period_key AS INTEGER) = ddr.current_year THEN units_count END), 0) AS CY_UNITS,\n        COALESCE(MAX(CASE WHEN REGEXP_LIKE(period_key, '^[0-9]{4}$') AND TRY_CAST(period_key AS INTEGER) = ddr.current_year - 1 THEN units_count END), 0) AS PY_CY_UNITS,\n        COALESCE(MAX(CASE WHEN REGEXP_LIKE(period_key, '^[0-9]{4}$') AND TRY_CAST(period_key AS INTEGER) = ddr.current_year - 2 THEN units_count END), 0) AS P2Y_CY_UNITS\n    FROM long_metrics m\n    CROSS JOIN data_date_ref ddr\n    WHERE m.period_type = 'CALENDAR_YEAR'\n    GROUP BY m.kmk_hco_id, m.metric_category\n),\n\n-- Join pivoted data with calendar year metrics\ncombined_metrics AS (\n    SELECT\n        p.*,\n        COALESCE(cy.CY_SALES, 0) AS CY_SALES,\n        COALESCE(cy.PY_CY_SALES, 0) AS PY_CY_SALES,\n        COALESCE(cy.P2Y_CY_SALES, 0) AS P2Y_CY_SALES,\n        COALESCE(cy.CY_UNITS, 0) AS CY_UNITS,\n        COALESCE(cy.PY_CY_UNITS, 0) AS PY_CY_UNITS,\n        COALESCE(cy.P2Y_CY_UNITS, 0) AS P2Y_CY_UNITS\n    FROM pivoted_metrics p\n    LEFT JOIN calendar_year_metrics cy\n        ON p.kmk_hco_id = cy.kmk_hco_id\n        AND p.metric_category = cy.metric_category\n)\n\n-- Final output with HCO attributes\nSELECT\n    -- Core HCO columns\n    h.kmk_hco_id,\n    h.dh_id,\n    h.org_name,\n    h.hierarchy_level,\n    h.firm_type,\n    h.hq_state,\n    h.kam_territory,\n    h.kam_region,\n\n    -- Metric category\n    cm.metric_category,\n\n    -- Monthly Sales (M01-M24)\n    cm.M01_SALES,\n    cm.M02_SALES,\n    cm.M03_SALES,\n    cm.M04_SALES,\n    cm.M05_SALES,\n    cm.M06_SALES,\n    cm.M07_SALES,\n    cm.M08_SALES,\n    cm.M09_SALES,\n    cm.M10_SALES,\n    cm.M11_SALES,\n    cm.M12_SALES,\n    cm.M13_SALES,\n    cm.M14_SALES,\n    cm.M15_SALES,\n    cm.M16_SALES,\n    cm.M17_SALES,\n    cm.M18_SALES,\n    cm.M19_SALES,\n    cm.M20_SALES,\n    cm.M21_SALES,\n    cm.M22_SALES,\n    cm.M23_SALES,\n    cm.M24_SALES,\n\n    -- Monthly Units (M01-M24)\n    cm.M01_UNITS,\n    cm.M02_UNITS,\n    cm.M03_UNITS,\n    cm.M04_UNITS,\n    cm.M05_UNITS,\n    cm.M06_UNITS,\n    cm.M07_UNITS,\n    cm.M08_UNITS,\n    cm.M09_UNITS,\n    cm.M10_UNITS,\n    cm.M11_UNITS,\n    cm.M12_UNITS,\n    cm.M13_UNITS,\n    cm.M14_UNITS,\n    cm.M15_UNITS,\n    cm.M16_UNITS,\n    cm.M17_UNITS,\n    cm.M18_UNITS,\n    cm.M19_UNITS,\n    cm.M20_UNITS,\n    cm.M21_UNITS,\n    cm.M22_UNITS,\n    cm.M23_UNITS,\n    cm.M24_UNITS,\n\n    -- Rolling Sales (L3M-L24M)\n    cm.L3M_SALES,\n    cm.L6M_SALES,\n    cm.L12M_SALES,\n    cm.L18M_SALES,\n    cm.L24M_SALES,\n\n    -- Rolling Units (L3M-L24M)\n    cm.L3M_UNITS,\n    cm.L6M_UNITS,\n    cm.L12M_UNITS,\n    cm.L18M_UNITS,\n    cm.L24M_UNITS,\n\n    -- Quarterly Sales (Q01-Q08)\n    cm.Q01_SALES,\n    cm.Q02_SALES,\n    cm.Q03_SALES,\n    cm.Q04_SALES,\n    cm.Q05_SALES,\n    cm.Q06_SALES,\n    cm.Q07_SALES,\n    cm.Q08_SALES,\n\n    -- Quarterly Units (Q01-Q08)\n    cm.Q01_UNITS,\n    cm.Q02_UNITS,\n    cm.Q03_UNITS,\n    cm.Q04_UNITS,\n    cm.Q05_UNITS,\n    cm.Q06_UNITS,\n    cm.Q07_UNITS,\n    cm.Q08_UNITS,\n\n    -- Annual Sales (YTD, PYTD, PY, P2Y, QTD)\n    cm.YTD_SALES,\n    cm.PYTD_SALES,\n    cm.PY_SALES,\n    cm.P2Y_SALES,\n    cm.QTD_SALES,\n\n    -- Annual Units (YTD, PYTD, PY, P2Y, QTD)\n    cm.YTD_UNITS,\n    cm.PYTD_UNITS,\n    cm.PY_UNITS,\n    cm.P2Y_UNITS,\n    cm.QTD_UNITS,\n\n    -- Calendar Year Sales\n    cm.CY_SALES,\n    cm.PY_CY_SALES,\n    cm.P2Y_CY_SALES,\n\n    -- Calendar Year Units\n    cm.CY_UNITS,\n    cm.PY_CY_UNITS,\n    cm.P2Y_CY_UNITS,\n\n    -- Total (All-Time)\n    cm.TOTAL_SALES,\n    cm.TOTAL_UNITS,\n\n    -- Outlet count\n    cm.outlet_count,\n\n    -- Metadata\n    cm.data_date\n\nFROM combined_metrics cm\nLEFT JOIN hco_attributes h ON cm.kmk_hco_id = h.kmk_hco_id", "doc_blocks": [], "language": "sql", "refs": [{"name": "ref_time_periods", "package": null, "version": null}, {"name": "adm_ddd_metrics_long", "package": null, "version": null}, {"name": "adm_hco_hierarchy", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.ref_time_periods", "model.CGOncology_MDM.adm_ddd_metrics_long", "model.CGOncology_MDM.adm_hco_hierarchy"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["kmk_hco_id", "metric_category"], "time_spine": null}, "model.CGOncology_MDM.adm_ddd_metrics_grain": {"database": "CGONCOLOGY_TEST", "schema": "ADM", "name": "adm_ddd_metrics_grain", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "adm/adm_ddd_metrics_grain.sql", "original_file_path": "models/adm/adm_ddd_metrics_grain.sql", "unique_id": "model.CGOncology_MDM.adm_ddd_metrics_grain", "fqn": ["CGOncology_MDM", "adm", "adm_ddd_metrics_grain"], "alias": "adm_ddd_metrics_grain", "checksum": {"name": "sha256", "checksum": "11f5e868e737316a268c00da8f4c72fe79eea8f02361c2b87bc70414c2735796"}, "config": {"enabled": true, "alias": null, "schema": "ADM", "database": null, "tags": ["layer_4_adm", "customer_backbone", "customer_backbone", "adm", "metrics"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_4_adm", "customer_backbone", "adm", "metrics"], "description": "DDD sales grain table - one row per (outlet, product, month).\nBusiness Rules: DDD-GRN-001 to DDD-GRN-005\nIncludes L4 practice location hierarchy via match_ddd_dhc.matched_kmk_pl_id.\nNote: Source std_ddd_sales has known duplicates per (outlet, product), so grain is not strictly unique.\n", "columns": {"outlet_no": {"name": "outlet_no", "description": "DDD outlet number", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "product_group_id": {"name": "product_group_id", "description": "Product group ID", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "kmk_hco_id": {"name": "kmk_hco_id", "description": "KMK HCO ID from XREF (L3 level)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "account_id_l3": {"name": "account_id_l3", "description": "L3 hierarchy level (Physician Group / Hospital) - NULL for unmatched outlets", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "account_id_l4": {"name": "account_id_l4", "description": "L4 practice location level - populated when DDD outlet matched to practice location", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "sales_amount": {"name": "sales_amount", "description": "Sales dollars for the month", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "units_count": {"name": "units_count", "description": "Pack units for the month", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "month_num": {"name": "month_num", "description": "Month number (1-24, where 1=most recent)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/adm/schema.yml", "build_path": null, "unrendered_config": {"schema": "ADM", "materialized": "table", "tags": ["customer_backbone", "adm", "metrics"]}, "created_at": 1770177079.586577, "relation_name": "CGONCOLOGY_TEST.ADM.adm_ddd_metrics_grain", "raw_code": "{{\n    config(\n        schema='ADM',\n        materialized='table',\n        tags=['customer_backbone', 'adm', 'metrics']\n    )\n}}\n\n/*\nADM_DDD_METRICS_GRAIN - DDD Sales Metrics Grain Table (Lowest Level)\nBusiness Rules: MET-060 to MET-074, MET-ROLLUP-004 to MET-ROLLUP-007\n\nGrain: One row per (OUTLET_NO, PRODUCT, DATE)\n\nPurpose: Lowest level grain table for DDD metrics calculation and rollup.\nContains hierarchy columns (ACCOUNT_ID_L1 through ACCOUNT_ID_L4) for rollup calculations.\n\nSource: std_ddd_sales (unpivots monthly columns MONTH_1 through MONTH_12)\nHierarchy: adm_hco_hierarchy (for L1/L2/L3/L4 account IDs)\n\nKey Logic:\n- Unpivots monthly columns (MONTH_1 through MONTH_12) into rows (one row per month)\n- XREF Mapping: std_ddd_sales.ddd_outlet_id \u2192 mdm_customer_xref_hco (SOURCE_CODE='DDD') \u2192 KMK_HCO_ID\n- Hierarchy L1/L2/L3: KMK_HCO_ID \u2192 adm_hco_hierarchy (hierarchy_level != 'L4') \u2192 account_id_l1, account_id_l2, account_id_l3\n- Hierarchy L4: adm_hco_hierarchy (hierarchy_level = 'L4' AND account_id_l3 = KMK_HCO_ID) \u2192 account_id_l4, account_id_l3, account_id_l2, account_id_l1\n- When L4 is populated, also populate L3, L2, L1 from the L4 row's hierarchy (which inherits from parent HCO)\n*/\n\n-- Unpivot monthly columns from std_ddd_sales using UNION ALL\n-- Creates one row per (outlet, product, month)\nWITH ddd_sales_unpivoted AS (\n    SELECT\n        ddd_outlet_id AS outlet_no,\n        product_group_id,\n        product_name,\n        data_date,\n        1 AS month_num,\n        DATEADD(MONTH, 0, DATE_TRUNC('MONTH', data_date)) AS month_date,\n        sales_month_1 AS sales_amount,\n        units_month_1 AS units_count\n    FROM {{ ref('std_ddd_sales') }}\n    WHERE sales_month_1 IS NOT NULL OR units_month_1 IS NOT NULL\n    \n    UNION ALL\n    \n    SELECT\n        ddd_outlet_id AS outlet_no,\n        product_group_id,\n        product_name,\n        data_date,\n        2 AS month_num,\n        DATEADD(MONTH, -1, DATE_TRUNC('MONTH', data_date)) AS month_date,\n        sales_month_2 AS sales_amount,\n        units_month_2 AS units_count\n    FROM {{ ref('std_ddd_sales') }}\n    WHERE sales_month_2 IS NOT NULL OR units_month_2 IS NOT NULL\n    \n    UNION ALL\n    \n    SELECT\n        ddd_outlet_id AS outlet_no,\n        product_group_id,\n        product_name,\n        data_date,\n        3 AS month_num,\n        DATEADD(MONTH, -2, DATE_TRUNC('MONTH', data_date)) AS month_date,\n        sales_month_3 AS sales_amount,\n        units_month_3 AS units_count\n    FROM {{ ref('std_ddd_sales') }}\n    WHERE sales_month_3 IS NOT NULL OR units_month_3 IS NOT NULL\n    \n    UNION ALL\n    \n    SELECT\n        ddd_outlet_id AS outlet_no,\n        product_group_id,\n        product_name,\n        data_date,\n        4 AS month_num,\n        DATEADD(MONTH, -3, DATE_TRUNC('MONTH', data_date)) AS month_date,\n        sales_month_4 AS sales_amount,\n        units_month_4 AS units_count\n    FROM {{ ref('std_ddd_sales') }}\n    WHERE sales_month_4 IS NOT NULL OR units_month_4 IS NOT NULL\n    \n    UNION ALL\n    \n    SELECT\n        ddd_outlet_id AS outlet_no,\n        product_group_id,\n        product_name,\n        data_date,\n        5 AS month_num,\n        DATEADD(MONTH, -4, DATE_TRUNC('MONTH', data_date)) AS month_date,\n        sales_month_5 AS sales_amount,\n        units_month_5 AS units_count\n    FROM {{ ref('std_ddd_sales') }}\n    WHERE sales_month_5 IS NOT NULL OR units_month_5 IS NOT NULL\n    \n    UNION ALL\n    \n    SELECT\n        ddd_outlet_id AS outlet_no,\n        product_group_id,\n        product_name,\n        data_date,\n        6 AS month_num,\n        DATEADD(MONTH, -5, DATE_TRUNC('MONTH', data_date)) AS month_date,\n        sales_month_6 AS sales_amount,\n        units_month_6 AS units_count\n    FROM {{ ref('std_ddd_sales') }}\n    WHERE sales_month_6 IS NOT NULL OR units_month_6 IS NOT NULL\n    \n    UNION ALL\n    \n    SELECT\n        ddd_outlet_id AS outlet_no,\n        product_group_id,\n        product_name,\n        data_date,\n        7 AS month_num,\n        DATEADD(MONTH, -6, DATE_TRUNC('MONTH', data_date)) AS month_date,\n        sales_month_7 AS sales_amount,\n        units_month_7 AS units_count\n    FROM {{ ref('std_ddd_sales') }}\n    WHERE sales_month_7 IS NOT NULL OR units_month_7 IS NOT NULL\n    \n    UNION ALL\n    \n    SELECT\n        ddd_outlet_id AS outlet_no,\n        product_group_id,\n        product_name,\n        data_date,\n        8 AS month_num,\n        DATEADD(MONTH, -7, DATE_TRUNC('MONTH', data_date)) AS month_date,\n        sales_month_8 AS sales_amount,\n        units_month_8 AS units_count\n    FROM {{ ref('std_ddd_sales') }}\n    WHERE sales_month_8 IS NOT NULL OR units_month_8 IS NOT NULL\n    \n    UNION ALL\n    \n    SELECT\n        ddd_outlet_id AS outlet_no,\n        product_group_id,\n        product_name,\n        data_date,\n        9 AS month_num,\n        DATEADD(MONTH, -8, DATE_TRUNC('MONTH', data_date)) AS month_date,\n        sales_month_9 AS sales_amount,\n        units_month_9 AS units_count\n    FROM {{ ref('std_ddd_sales') }}\n    WHERE sales_month_9 IS NOT NULL OR units_month_9 IS NOT NULL\n    \n    UNION ALL\n    \n    SELECT\n        ddd_outlet_id AS outlet_no,\n        product_group_id,\n        product_name,\n        data_date,\n        10 AS month_num,\n        DATEADD(MONTH, -9, DATE_TRUNC('MONTH', data_date)) AS month_date,\n        sales_month_10 AS sales_amount,\n        units_month_10 AS units_count\n    FROM {{ ref('std_ddd_sales') }}\n    WHERE sales_month_10 IS NOT NULL OR units_month_10 IS NOT NULL\n    \n    UNION ALL\n    \n    SELECT\n        ddd_outlet_id AS outlet_no,\n        product_group_id,\n        product_name,\n        data_date,\n        11 AS month_num,\n        DATEADD(MONTH, -10, DATE_TRUNC('MONTH', data_date)) AS month_date,\n        sales_month_11 AS sales_amount,\n        units_month_11 AS units_count\n    FROM {{ ref('std_ddd_sales') }}\n    WHERE sales_month_11 IS NOT NULL OR units_month_11 IS NOT NULL\n    \n    UNION ALL\n\n    SELECT\n        ddd_outlet_id AS outlet_no,\n        product_group_id,\n        product_name,\n        data_date,\n        12 AS month_num,\n        DATEADD(MONTH, -11, DATE_TRUNC('MONTH', data_date)) AS month_date,\n        sales_month_12 AS sales_amount,\n        units_month_12 AS units_count\n    FROM {{ ref('std_ddd_sales') }}\n    WHERE sales_month_12 IS NOT NULL OR units_month_12 IS NOT NULL\n\n    UNION ALL\n\n    SELECT\n        ddd_outlet_id AS outlet_no,\n        product_group_id,\n        product_name,\n        data_date,\n        13 AS month_num,\n        DATEADD(MONTH, -12, DATE_TRUNC('MONTH', data_date)) AS month_date,\n        sales_month_13 AS sales_amount,\n        units_month_13 AS units_count\n    FROM {{ ref('std_ddd_sales') }}\n    WHERE sales_month_13 IS NOT NULL OR units_month_13 IS NOT NULL\n\n    UNION ALL\n\n    SELECT\n        ddd_outlet_id AS outlet_no,\n        product_group_id,\n        product_name,\n        data_date,\n        14 AS month_num,\n        DATEADD(MONTH, -13, DATE_TRUNC('MONTH', data_date)) AS month_date,\n        sales_month_14 AS sales_amount,\n        units_month_14 AS units_count\n    FROM {{ ref('std_ddd_sales') }}\n    WHERE sales_month_14 IS NOT NULL OR units_month_14 IS NOT NULL\n\n    UNION ALL\n\n    SELECT\n        ddd_outlet_id AS outlet_no,\n        product_group_id,\n        product_name,\n        data_date,\n        15 AS month_num,\n        DATEADD(MONTH, -14, DATE_TRUNC('MONTH', data_date)) AS month_date,\n        sales_month_15 AS sales_amount,\n        units_month_15 AS units_count\n    FROM {{ ref('std_ddd_sales') }}\n    WHERE sales_month_15 IS NOT NULL OR units_month_15 IS NOT NULL\n\n    UNION ALL\n\n    SELECT\n        ddd_outlet_id AS outlet_no,\n        product_group_id,\n        product_name,\n        data_date,\n        16 AS month_num,\n        DATEADD(MONTH, -15, DATE_TRUNC('MONTH', data_date)) AS month_date,\n        sales_month_16 AS sales_amount,\n        units_month_16 AS units_count\n    FROM {{ ref('std_ddd_sales') }}\n    WHERE sales_month_16 IS NOT NULL OR units_month_16 IS NOT NULL\n\n    UNION ALL\n\n    SELECT\n        ddd_outlet_id AS outlet_no,\n        product_group_id,\n        product_name,\n        data_date,\n        17 AS month_num,\n        DATEADD(MONTH, -16, DATE_TRUNC('MONTH', data_date)) AS month_date,\n        sales_month_17 AS sales_amount,\n        units_month_17 AS units_count\n    FROM {{ ref('std_ddd_sales') }}\n    WHERE sales_month_17 IS NOT NULL OR units_month_17 IS NOT NULL\n\n    UNION ALL\n\n    SELECT\n        ddd_outlet_id AS outlet_no,\n        product_group_id,\n        product_name,\n        data_date,\n        18 AS month_num,\n        DATEADD(MONTH, -17, DATE_TRUNC('MONTH', data_date)) AS month_date,\n        sales_month_18 AS sales_amount,\n        units_month_18 AS units_count\n    FROM {{ ref('std_ddd_sales') }}\n    WHERE sales_month_18 IS NOT NULL OR units_month_18 IS NOT NULL\n\n    UNION ALL\n\n    SELECT\n        ddd_outlet_id AS outlet_no,\n        product_group_id,\n        product_name,\n        data_date,\n        19 AS month_num,\n        DATEADD(MONTH, -18, DATE_TRUNC('MONTH', data_date)) AS month_date,\n        sales_month_19 AS sales_amount,\n        units_month_19 AS units_count\n    FROM {{ ref('std_ddd_sales') }}\n    WHERE sales_month_19 IS NOT NULL OR units_month_19 IS NOT NULL\n\n    UNION ALL\n\n    SELECT\n        ddd_outlet_id AS outlet_no,\n        product_group_id,\n        product_name,\n        data_date,\n        20 AS month_num,\n        DATEADD(MONTH, -19, DATE_TRUNC('MONTH', data_date)) AS month_date,\n        sales_month_20 AS sales_amount,\n        units_month_20 AS units_count\n    FROM {{ ref('std_ddd_sales') }}\n    WHERE sales_month_20 IS NOT NULL OR units_month_20 IS NOT NULL\n\n    UNION ALL\n\n    SELECT\n        ddd_outlet_id AS outlet_no,\n        product_group_id,\n        product_name,\n        data_date,\n        21 AS month_num,\n        DATEADD(MONTH, -20, DATE_TRUNC('MONTH', data_date)) AS month_date,\n        sales_month_21 AS sales_amount,\n        units_month_21 AS units_count\n    FROM {{ ref('std_ddd_sales') }}\n    WHERE sales_month_21 IS NOT NULL OR units_month_21 IS NOT NULL\n\n    UNION ALL\n\n    SELECT\n        ddd_outlet_id AS outlet_no,\n        product_group_id,\n        product_name,\n        data_date,\n        22 AS month_num,\n        DATEADD(MONTH, -21, DATE_TRUNC('MONTH', data_date)) AS month_date,\n        sales_month_22 AS sales_amount,\n        units_month_22 AS units_count\n    FROM {{ ref('std_ddd_sales') }}\n    WHERE sales_month_22 IS NOT NULL OR units_month_22 IS NOT NULL\n\n    UNION ALL\n\n    SELECT\n        ddd_outlet_id AS outlet_no,\n        product_group_id,\n        product_name,\n        data_date,\n        23 AS month_num,\n        DATEADD(MONTH, -22, DATE_TRUNC('MONTH', data_date)) AS month_date,\n        sales_month_23 AS sales_amount,\n        units_month_23 AS units_count\n    FROM {{ ref('std_ddd_sales') }}\n    WHERE sales_month_23 IS NOT NULL OR units_month_23 IS NOT NULL\n\n    UNION ALL\n\n    SELECT\n        ddd_outlet_id AS outlet_no,\n        product_group_id,\n        product_name,\n        data_date,\n        24 AS month_num,\n        DATEADD(MONTH, -23, DATE_TRUNC('MONTH', data_date)) AS month_date,\n        sales_month_24 AS sales_amount,\n        units_month_24 AS units_count\n    FROM {{ ref('std_ddd_sales') }}\n    WHERE sales_month_24 IS NOT NULL OR units_month_24 IS NOT NULL\n),\n\n-- Get KMK_HCO_ID mapping from MDM cross-reference\n-- Note: Uses SOURCE_CODE = 'DDD' and SOURCE_ID = ddd_outlet_id\n-- MAT-005: Exclude ZIP outlets (is_zip_excluded = TRUE)\n-- MAT-006: Exclude supply chain outlets (is_supply_chain_excluded = TRUE, e.g., S5=mail service)\nxref_mapping AS (\n    SELECT DISTINCT\n        x.SOURCE_ID AS ddd_outlet_no,\n        x.KMK_HCO_ID,\n        x.DH_ID,\n        x.ORG_NAME,\n        m.matched_kmk_pl_id  -- L4 practice location from match table\n    FROM {{ ref('mdm_customer_xref_hco') }} x\n    INNER JOIN {{ ref('std_ddd_hco') }} ddd\n        ON x.SOURCE_ID = ddd.ddd_outlet_id\n    LEFT JOIN {{ ref('match_ddd_dhc') }} m\n        ON x.SOURCE_ID = m.ddd_outlet_id\n    WHERE x.SOURCE_CODE = 'DDD'\n      AND x.SOURCE_ID IS NOT NULL\n      AND x.KMK_HCO_ID IS NOT NULL\n      -- MAT-005: Exclude ZIP outlets (outlets with 'ZIP' in name)\n      AND ddd.is_zip_excluded = FALSE\n      -- MAT-006: Exclude supply chain outlets (S5=mail service, W8=warehouse, A5=Kaiser warehouse)\n      AND ddd.is_supply_chain_excluded = FALSE\n),\n\n-- PHASE 6: Use unified hierarchy (includes practice locations as L4)\n-- Practice locations now have account_id_l1, l2, l3, l4 populated in unified hierarchy\nhierarchy_unified AS (\n    SELECT\n        kmk_hco_id,\n        dh_id,\n        account_id_l1,\n        account_id_l2,\n        account_id_l3,\n        account_id_l4  -- L4 populated for practice locations, NULL for others\n    FROM {{ ref('adm_hco_hierarchy') }}\n),\n\n-- Practice location hierarchy for L4 propagation\n-- When a DDD outlet matched to a practice location, use the PL's hierarchy row\n-- which has L4 populated and L3/L2/L1 inherited from parent PG\npl_hierarchy AS (\n    SELECT\n        kmk_hco_id AS kmk_pl_id,\n        account_id_l1,\n        account_id_l2,\n        account_id_l3,\n        account_id_l4\n    FROM {{ ref('adm_hco_hierarchy') }}\n    WHERE hierarchy_level = 'L4'\n),\n\n-- Join sales with XREF and hierarchy\nsales_with_hierarchy AS (\n    SELECT\n        s.outlet_no,\n        s.product_group_id,\n        s.product_name,\n        s.month_date AS data_date,\n        s.month_num,  -- Month number (1-12) for aggregation\n        s.sales_amount,\n        s.units_count,\n        x.kmk_hco_id,\n        x.dh_id,\n        x.org_name,\n        -- Hierarchy columns: prefer PL hierarchy (has L4 populated) over L3 hierarchy\n        -- PL hierarchy inherits correct L1/L2/L3 from parent PG, so rollup totals are unchanged\n        COALESCE(pl.account_id_l4, h.account_id_l4) AS account_id_l4,\n        COALESCE(pl.account_id_l3, h.account_id_l3) AS account_id_l3,\n        COALESCE(pl.account_id_l2, h.account_id_l2) AS account_id_l2,\n        COALESCE(pl.account_id_l1, h.account_id_l1) AS account_id_l1\n    FROM ddd_sales_unpivoted s\n    LEFT JOIN xref_mapping x ON s.outlet_no = x.ddd_outlet_no\n    LEFT JOIN hierarchy_unified h ON x.kmk_hco_id = h.kmk_hco_id\n    LEFT JOIN pl_hierarchy pl ON x.matched_kmk_pl_id = pl.kmk_pl_id\n)\n\nSELECT\n    outlet_no,\n    product_group_id,\n    product_name,\n    data_date,\n    month_num,  -- Month number (1-24) for aggregation\n    kmk_hco_id,\n    dh_id,\n    org_name,\n    account_id_l4,  -- Direct from adm_hco_hierarchy\n    account_id_l3,  -- Direct from adm_hco_hierarchy\n    account_id_l2,  -- Direct from adm_hco_hierarchy\n    account_id_l1,  -- Direct from adm_hco_hierarchy\n    sales_amount,\n    units_count\nFROM sales_with_hierarchy\nWHERE kmk_hco_id IS NOT NULL  -- Only include rows with valid HCO mapping", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_ddd_sales", "package": null, "version": null}, {"name": "std_ddd_sales", "package": null, "version": null}, {"name": "std_ddd_sales", "package": null, "version": null}, {"name": "std_ddd_sales", "package": null, "version": null}, {"name": "std_ddd_sales", "package": null, "version": null}, {"name": "std_ddd_sales", "package": null, "version": null}, {"name": "std_ddd_sales", "package": null, "version": null}, {"name": "std_ddd_sales", "package": null, "version": null}, {"name": "std_ddd_sales", "package": null, "version": null}, {"name": "std_ddd_sales", "package": null, "version": null}, {"name": "std_ddd_sales", "package": null, "version": null}, {"name": "std_ddd_sales", "package": null, "version": null}, {"name": "std_ddd_sales", "package": null, "version": null}, {"name": "std_ddd_sales", "package": null, "version": null}, {"name": "std_ddd_sales", "package": null, "version": null}, {"name": "std_ddd_sales", "package": null, "version": null}, {"name": "std_ddd_sales", "package": null, "version": null}, {"name": "std_ddd_sales", "package": null, "version": null}, {"name": "std_ddd_sales", "package": null, "version": null}, {"name": "std_ddd_sales", "package": null, "version": null}, {"name": "std_ddd_sales", "package": null, "version": null}, {"name": "std_ddd_sales", "package": null, "version": null}, {"name": "std_ddd_sales", "package": null, "version": null}, {"name": "std_ddd_sales", "package": null, "version": null}, {"name": "mdm_customer_xref_hco", "package": null, "version": null}, {"name": "std_ddd_hco", "package": null, "version": null}, {"name": "match_ddd_dhc", "package": null, "version": null}, {"name": "adm_hco_hierarchy", "package": null, "version": null}, {"name": "adm_hco_hierarchy", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.std_ddd_sales", "model.CGOncology_MDM.mdm_customer_xref_hco", "model.CGOncology_MDM.std_ddd_hco", "model.CGOncology_MDM.match_ddd_dhc", "model.CGOncology_MDM.adm_hco_hierarchy"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}, "model.CGOncology_MDM.adm_hco_claims_wide": {"database": "CGONCOLOGY_TEST", "schema": "ADM", "name": "adm_hco_claims_wide", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "adm/adm_hco_claims_wide.sql", "original_file_path": "models/adm/adm_hco_claims_wide.sql", "unique_id": "model.CGOncology_MDM.adm_hco_claims_wide", "fqn": ["CGOncology_MDM", "adm", "adm_hco_claims_wide"], "alias": "adm_hco_claims_wide", "checksum": {"name": "sha256", "checksum": "994c92706856a3b084348adbd5f99e5e63b9904e223f86f3ef602d02bcee3427"}, "config": {"enabled": true, "alias": null, "schema": "ADM", "database": null, "tags": ["layer_4_adm", "customer_backbone", "customer_backbone", "adm", "metrics"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_4_adm", "customer_backbone", "adm", "metrics"], "description": "HCO claims metrics pivoted to wide format (M01-M24 columns).\nBusiness Rules: MET-050, MET-051\nGrain: (kmk_hco_id, metric_category)\n", "columns": {"kmk_hco_id": {"name": "kmk_hco_id", "description": "KMK HCO identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "metric_category": {"name": "metric_category", "description": "Treatment category", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/adm/schema.yml", "build_path": null, "unrendered_config": {"schema": "ADM", "materialized": "table", "tags": ["customer_backbone", "adm", "metrics"]}, "created_at": 1770177079.585896, "relation_name": "CGONCOLOGY_TEST.ADM.adm_hco_claims_wide", "raw_code": "{{\n    config(\n        schema='ADM',\n        materialized='table',\n        tags=['customer_backbone', 'adm', 'metrics']\n    )\n}}\n\n/*\nADM_HCO_CLAIMS_WIDE - HCO Claims Metrics in Wide Format\nBusiness Rules: MET-010 to MET-015, MET-DATE-001 to MET-DATE-003\n\nGrain: One row per (kmk_hco_id, metric_category)\n\nPivots claims metrics from long to wide format:\n- Source: adm_claims_metrics_long (filtered to entity_type = 'HCO')\n- Columns: M01-M24 for claims and patients per metric category\n- Rolling periods: L3M, L6M, L12M, L18M, L24M\n- Quarterly periods: Q01-Q08\n- Annual periods: YTD, QTD, PY, PYTD, P2Y, Calendar Years (current + prior 2 years)\n- Enriched with HCO hierarchy information\n\nTreatment Categories (from ref_treatment_categories):\n- TURBT: Transurethral Resection of Bladder Tumor\n- TICE_BCG: BCG immunotherapy claims\n- ADSTILADRIN: Adstiladrin claims\n- ANKTIVA: Anktiva claims\n- OTHER_PX: Other procedure claims\n\nPeriod Columns:\n- Monthly: M01-M24 (claims and patients)\n- Rolling: L3M, L6M, L12M, L18M, L24M (claims and patients)\n- Quarterly: Q01-Q08 (claims and patients)\n- Annual: YTD, QTD, PY, PYTD, P2Y (claims and patients)\n- Calendar Years: CY, PY_CY, P2Y_CY (claims and patients)\n- TOTAL: All-time (claims and patients)\n\nData Date (MET-DATE-001 to MET-DATE-003):\n- Uses data_date from ref_time_periods (which reads from dbt_project.yml var)\n- Year calculations use YEAR(data_date) instead of YEAR(CURRENT_DATE())\n- data_date represents the snapshot date when data was processed\n*/\n\n-- Get data_date from ref_time_periods\nWITH data_date_ref AS (\n    SELECT DISTINCT data_date, YEAR(data_date) AS current_year\n    FROM {{ ref('ref_time_periods') }}\n    LIMIT 1\n),\n\n-- Get HCO hierarchy info for enrichment\n-- NOTE: account_type is in adm_hco_master, not adm_hco_hierarchy\nhco_hierarchy AS (\n    SELECT\n        h.kmk_hco_id,\n        h.dh_id,\n        h.org_name,\n        h.hierarchy_level,\n        m.account_type,  -- From adm_hco_master\n        h.firm_type,\n        h.hq_state,\n        h.kam_territory,\n        h.kam_region\n    FROM {{ ref('adm_hco_hierarchy') }} h\n    LEFT JOIN {{ ref('adm_hco_master') }} m ON h.kmk_hco_id = m.kmk_hco_id\n),\n\n-- Filter to HCO metrics only (monthly periods for pivot)\nhco_metrics_long AS (\n    SELECT\n        entity_id AS kmk_hco_id,\n        metric_category,\n        period_key,\n        claim_count,\n        patient_count\n    FROM {{ ref('adm_claims_metrics_long') }}\n    WHERE entity_type = 'HCO'\n      AND period_key LIKE 'M%'  -- Monthly periods only for pivot\n),\n\n-- Get rolling period metrics (L3M, L6M, L12M, L18M, L24M)\nhco_rolling_metrics AS (\n    SELECT\n        entity_id AS kmk_hco_id,\n        metric_category,\n        period_key,\n        claim_count,\n        patient_count\n    FROM {{ ref('adm_claims_metrics_long') }}\n    WHERE entity_type = 'HCO'\n      AND period_key IN ('L3M', 'L6M', 'L12M', 'L18M', 'L24M')\n),\n\n-- Get quarterly period metrics (Q01-Q08)\nhco_quarterly_metrics AS (\n    SELECT\n        entity_id AS kmk_hco_id,\n        metric_category,\n        period_key,\n        claim_count,\n        patient_count\n    FROM {{ ref('adm_claims_metrics_long') }}\n    WHERE entity_type = 'HCO'\n      AND period_key LIKE 'Q%'\n),\n\n-- Get TOTAL and annual period metrics (YTD, QTD, PY, PYTD, P2Y, Calendar Years)\n-- Use period_key patterns to filter dynamically\nhco_annual_metrics AS (\n    SELECT\n        entity_id AS kmk_hco_id,\n        metric_category,\n        period_key,\n        claim_count,\n        patient_count\n    FROM {{ ref('adm_claims_metrics_long') }}\n    CROSS JOIN data_date_ref ddr\n    WHERE entity_type = 'HCO'\n      AND (\n          period_key = 'TOTAL'\n          OR period_key LIKE 'YTD_%'\n          OR period_key LIKE 'QTD_%'\n          OR period_key LIKE 'PY_%'\n          OR period_key LIKE 'PYTD_%'\n          OR period_key LIKE 'P2Y_%'\n          OR (REGEXP_LIKE(period_key, '^[0-9]{4}$') AND TRY_CAST(period_key AS INTEGER) >= ddr.current_year - 2)\n      )\n),\n\n-- Pivot period_key to M01-M24 columns for claims\nclaims_pivoted AS (\n    SELECT\n        kmk_hco_id,\n        metric_category,\n        -- Claims by month (M01-M24)\n        MAX(CASE WHEN period_key = 'M01' THEN claim_count ELSE 0 END) AS M01_CLAIMS,\n        MAX(CASE WHEN period_key = 'M02' THEN claim_count ELSE 0 END) AS M02_CLAIMS,\n        MAX(CASE WHEN period_key = 'M03' THEN claim_count ELSE 0 END) AS M03_CLAIMS,\n        MAX(CASE WHEN period_key = 'M04' THEN claim_count ELSE 0 END) AS M04_CLAIMS,\n        MAX(CASE WHEN period_key = 'M05' THEN claim_count ELSE 0 END) AS M05_CLAIMS,\n        MAX(CASE WHEN period_key = 'M06' THEN claim_count ELSE 0 END) AS M06_CLAIMS,\n        MAX(CASE WHEN period_key = 'M07' THEN claim_count ELSE 0 END) AS M07_CLAIMS,\n        MAX(CASE WHEN period_key = 'M08' THEN claim_count ELSE 0 END) AS M08_CLAIMS,\n        MAX(CASE WHEN period_key = 'M09' THEN claim_count ELSE 0 END) AS M09_CLAIMS,\n        MAX(CASE WHEN period_key = 'M10' THEN claim_count ELSE 0 END) AS M10_CLAIMS,\n        MAX(CASE WHEN period_key = 'M11' THEN claim_count ELSE 0 END) AS M11_CLAIMS,\n        MAX(CASE WHEN period_key = 'M12' THEN claim_count ELSE 0 END) AS M12_CLAIMS,\n        MAX(CASE WHEN period_key = 'M13' THEN claim_count ELSE 0 END) AS M13_CLAIMS,\n        MAX(CASE WHEN period_key = 'M14' THEN claim_count ELSE 0 END) AS M14_CLAIMS,\n        MAX(CASE WHEN period_key = 'M15' THEN claim_count ELSE 0 END) AS M15_CLAIMS,\n        MAX(CASE WHEN period_key = 'M16' THEN claim_count ELSE 0 END) AS M16_CLAIMS,\n        MAX(CASE WHEN period_key = 'M17' THEN claim_count ELSE 0 END) AS M17_CLAIMS,\n        MAX(CASE WHEN period_key = 'M18' THEN claim_count ELSE 0 END) AS M18_CLAIMS,\n        MAX(CASE WHEN period_key = 'M19' THEN claim_count ELSE 0 END) AS M19_CLAIMS,\n        MAX(CASE WHEN period_key = 'M20' THEN claim_count ELSE 0 END) AS M20_CLAIMS,\n        MAX(CASE WHEN period_key = 'M21' THEN claim_count ELSE 0 END) AS M21_CLAIMS,\n        MAX(CASE WHEN period_key = 'M22' THEN claim_count ELSE 0 END) AS M22_CLAIMS,\n        MAX(CASE WHEN period_key = 'M23' THEN claim_count ELSE 0 END) AS M23_CLAIMS,\n        MAX(CASE WHEN period_key = 'M24' THEN claim_count ELSE 0 END) AS M24_CLAIMS,\n        -- Patients by month (M01-M24)\n        MAX(CASE WHEN period_key = 'M01' THEN patient_count ELSE 0 END) AS M01_PATIENTS,\n        MAX(CASE WHEN period_key = 'M02' THEN patient_count ELSE 0 END) AS M02_PATIENTS,\n        MAX(CASE WHEN period_key = 'M03' THEN patient_count ELSE 0 END) AS M03_PATIENTS,\n        MAX(CASE WHEN period_key = 'M04' THEN patient_count ELSE 0 END) AS M04_PATIENTS,\n        MAX(CASE WHEN period_key = 'M05' THEN patient_count ELSE 0 END) AS M05_PATIENTS,\n        MAX(CASE WHEN period_key = 'M06' THEN patient_count ELSE 0 END) AS M06_PATIENTS,\n        MAX(CASE WHEN period_key = 'M07' THEN patient_count ELSE 0 END) AS M07_PATIENTS,\n        MAX(CASE WHEN period_key = 'M08' THEN patient_count ELSE 0 END) AS M08_PATIENTS,\n        MAX(CASE WHEN period_key = 'M09' THEN patient_count ELSE 0 END) AS M09_PATIENTS,\n        MAX(CASE WHEN period_key = 'M10' THEN patient_count ELSE 0 END) AS M10_PATIENTS,\n        MAX(CASE WHEN period_key = 'M11' THEN patient_count ELSE 0 END) AS M11_PATIENTS,\n        MAX(CASE WHEN period_key = 'M12' THEN patient_count ELSE 0 END) AS M12_PATIENTS,\n        MAX(CASE WHEN period_key = 'M13' THEN patient_count ELSE 0 END) AS M13_PATIENTS,\n        MAX(CASE WHEN period_key = 'M14' THEN patient_count ELSE 0 END) AS M14_PATIENTS,\n        MAX(CASE WHEN period_key = 'M15' THEN patient_count ELSE 0 END) AS M15_PATIENTS,\n        MAX(CASE WHEN period_key = 'M16' THEN patient_count ELSE 0 END) AS M16_PATIENTS,\n        MAX(CASE WHEN period_key = 'M17' THEN patient_count ELSE 0 END) AS M17_PATIENTS,\n        MAX(CASE WHEN period_key = 'M18' THEN patient_count ELSE 0 END) AS M18_PATIENTS,\n        MAX(CASE WHEN period_key = 'M19' THEN patient_count ELSE 0 END) AS M19_PATIENTS,\n        MAX(CASE WHEN period_key = 'M20' THEN patient_count ELSE 0 END) AS M20_PATIENTS,\n        MAX(CASE WHEN period_key = 'M21' THEN patient_count ELSE 0 END) AS M21_PATIENTS,\n        MAX(CASE WHEN period_key = 'M22' THEN patient_count ELSE 0 END) AS M22_PATIENTS,\n        MAX(CASE WHEN period_key = 'M23' THEN patient_count ELSE 0 END) AS M23_PATIENTS,\n        MAX(CASE WHEN period_key = 'M24' THEN patient_count ELSE 0 END) AS M24_PATIENTS\n    FROM hco_metrics_long\n    GROUP BY kmk_hco_id, metric_category\n),\n\n-- Pivot rolling metrics to wide format (L3M-L24M)\nrolling_metrics_pivoted AS (\n    SELECT\n        kmk_hco_id,\n        metric_category,\n        -- Rolling Claims (L3M-L24M)\n        MAX(CASE WHEN period_key = 'L3M' THEN claim_count ELSE 0 END) AS L3M_CLAIMS,\n        MAX(CASE WHEN period_key = 'L6M' THEN claim_count ELSE 0 END) AS L6M_CLAIMS,\n        MAX(CASE WHEN period_key = 'L12M' THEN claim_count ELSE 0 END) AS L12M_CLAIMS,\n        MAX(CASE WHEN period_key = 'L18M' THEN claim_count ELSE 0 END) AS L18M_CLAIMS,\n        MAX(CASE WHEN period_key = 'L24M' THEN claim_count ELSE 0 END) AS L24M_CLAIMS,\n        -- Rolling Patients (L3M-L24M)\n        MAX(CASE WHEN period_key = 'L3M' THEN patient_count ELSE 0 END) AS L3M_PATIENTS,\n        MAX(CASE WHEN period_key = 'L6M' THEN patient_count ELSE 0 END) AS L6M_PATIENTS,\n        MAX(CASE WHEN period_key = 'L12M' THEN patient_count ELSE 0 END) AS L12M_PATIENTS,\n        MAX(CASE WHEN period_key = 'L18M' THEN patient_count ELSE 0 END) AS L18M_PATIENTS,\n        MAX(CASE WHEN period_key = 'L24M' THEN patient_count ELSE 0 END) AS L24M_PATIENTS\n    FROM hco_rolling_metrics\n    GROUP BY kmk_hco_id, metric_category\n),\n\n-- Pivot quarterly metrics to wide format (Q01-Q08)\nquarterly_metrics_pivoted AS (\n    SELECT\n        kmk_hco_id,\n        metric_category,\n        -- Quarterly Claims (Q01-Q08)\n        MAX(CASE WHEN period_key = 'Q01' THEN claim_count ELSE 0 END) AS Q01_CLAIMS,\n        MAX(CASE WHEN period_key = 'Q02' THEN claim_count ELSE 0 END) AS Q02_CLAIMS,\n        MAX(CASE WHEN period_key = 'Q03' THEN claim_count ELSE 0 END) AS Q03_CLAIMS,\n        MAX(CASE WHEN period_key = 'Q04' THEN claim_count ELSE 0 END) AS Q04_CLAIMS,\n        MAX(CASE WHEN period_key = 'Q05' THEN claim_count ELSE 0 END) AS Q05_CLAIMS,\n        MAX(CASE WHEN period_key = 'Q06' THEN claim_count ELSE 0 END) AS Q06_CLAIMS,\n        MAX(CASE WHEN period_key = 'Q07' THEN claim_count ELSE 0 END) AS Q07_CLAIMS,\n        MAX(CASE WHEN period_key = 'Q08' THEN claim_count ELSE 0 END) AS Q08_CLAIMS,\n        -- Quarterly Patients (Q01-Q08)\n        MAX(CASE WHEN period_key = 'Q01' THEN patient_count ELSE 0 END) AS Q01_PATIENTS,\n        MAX(CASE WHEN period_key = 'Q02' THEN patient_count ELSE 0 END) AS Q02_PATIENTS,\n        MAX(CASE WHEN period_key = 'Q03' THEN patient_count ELSE 0 END) AS Q03_PATIENTS,\n        MAX(CASE WHEN period_key = 'Q04' THEN patient_count ELSE 0 END) AS Q04_PATIENTS,\n        MAX(CASE WHEN period_key = 'Q05' THEN patient_count ELSE 0 END) AS Q05_PATIENTS,\n        MAX(CASE WHEN period_key = 'Q06' THEN patient_count ELSE 0 END) AS Q06_PATIENTS,\n        MAX(CASE WHEN period_key = 'Q07' THEN patient_count ELSE 0 END) AS Q07_PATIENTS,\n        MAX(CASE WHEN period_key = 'Q08' THEN patient_count ELSE 0 END) AS Q08_PATIENTS\n    FROM hco_quarterly_metrics\n    GROUP BY kmk_hco_id, metric_category\n),\n\n-- Pivot annual metrics to wide format (using pattern matching for dynamic periods)\nannual_metrics_pivoted AS (\n    SELECT\n        am.kmk_hco_id,\n        am.metric_category,\n        -- Annual period claims\n        MAX(CASE WHEN am.period_key = 'TOTAL' THEN am.claim_count ELSE 0 END) AS TOTAL_CLAIMS,\n        MAX(CASE WHEN am.period_key LIKE 'YTD_%' THEN am.claim_count ELSE 0 END) AS YTD_CLAIMS,\n        MAX(CASE WHEN am.period_key LIKE 'QTD_%' THEN am.claim_count ELSE 0 END) AS QTD_CLAIMS,\n        MAX(CASE WHEN am.period_key LIKE 'PY_%' AND am.period_key NOT LIKE 'PYTD_%' AND am.period_key NOT LIKE 'P2Y_%' THEN am.claim_count ELSE 0 END) AS PY_CLAIMS,\n        MAX(CASE WHEN am.period_key LIKE 'PYTD_%' THEN am.claim_count ELSE 0 END) AS PYTD_CLAIMS,\n        MAX(CASE WHEN am.period_key LIKE 'P2Y_%' THEN am.claim_count ELSE 0 END) AS P2Y_CLAIMS,\n        MAX(CASE WHEN REGEXP_LIKE(am.period_key, '^[0-9]{4}$') AND TRY_CAST(am.period_key AS INTEGER) = ddr.current_year THEN am.claim_count ELSE 0 END) AS CY_CLAIMS,\n        MAX(CASE WHEN REGEXP_LIKE(am.period_key, '^[0-9]{4}$') AND TRY_CAST(am.period_key AS INTEGER) = ddr.current_year - 1 THEN am.claim_count ELSE 0 END) AS PY_CY_CLAIMS,\n        MAX(CASE WHEN REGEXP_LIKE(am.period_key, '^[0-9]{4}$') AND TRY_CAST(am.period_key AS INTEGER) = ddr.current_year - 2 THEN am.claim_count ELSE 0 END) AS P2Y_CY_CLAIMS,\n        -- Annual period patients\n        MAX(CASE WHEN am.period_key = 'TOTAL' THEN am.patient_count ELSE 0 END) AS TOTAL_PATIENTS,\n        MAX(CASE WHEN am.period_key LIKE 'YTD_%' THEN am.patient_count ELSE 0 END) AS YTD_PATIENTS,\n        MAX(CASE WHEN am.period_key LIKE 'QTD_%' THEN am.patient_count ELSE 0 END) AS QTD_PATIENTS,\n        MAX(CASE WHEN am.period_key LIKE 'PY_%' AND am.period_key NOT LIKE 'PYTD_%' AND am.period_key NOT LIKE 'P2Y_%' THEN am.patient_count ELSE 0 END) AS PY_PATIENTS,\n        MAX(CASE WHEN am.period_key LIKE 'PYTD_%' THEN am.patient_count ELSE 0 END) AS PYTD_PATIENTS,\n        MAX(CASE WHEN am.period_key LIKE 'P2Y_%' THEN am.patient_count ELSE 0 END) AS P2Y_PATIENTS,\n        MAX(CASE WHEN REGEXP_LIKE(am.period_key, '^[0-9]{4}$') AND TRY_CAST(am.period_key AS INTEGER) = ddr.current_year THEN am.patient_count ELSE 0 END) AS CY_PATIENTS,\n        MAX(CASE WHEN REGEXP_LIKE(am.period_key, '^[0-9]{4}$') AND TRY_CAST(am.period_key AS INTEGER) = ddr.current_year - 1 THEN am.patient_count ELSE 0 END) AS PY_CY_PATIENTS,\n        MAX(CASE WHEN REGEXP_LIKE(am.period_key, '^[0-9]{4}$') AND TRY_CAST(am.period_key AS INTEGER) = ddr.current_year - 2 THEN am.patient_count ELSE 0 END) AS P2Y_CY_PATIENTS\n    FROM hco_annual_metrics am\n    CROSS JOIN data_date_ref ddr\n    GROUP BY am.kmk_hco_id, am.metric_category\n),\n\n-- Join all pivoted data together\nclaims_with_all_periods AS (\n    SELECT\n        cp.kmk_hco_id,\n        cp.metric_category,\n        -- Monthly claims\n        cp.M01_CLAIMS, cp.M02_CLAIMS, cp.M03_CLAIMS, cp.M04_CLAIMS, cp.M05_CLAIMS, cp.M06_CLAIMS,\n        cp.M07_CLAIMS, cp.M08_CLAIMS, cp.M09_CLAIMS, cp.M10_CLAIMS, cp.M11_CLAIMS, cp.M12_CLAIMS,\n        cp.M13_CLAIMS, cp.M14_CLAIMS, cp.M15_CLAIMS, cp.M16_CLAIMS, cp.M17_CLAIMS, cp.M18_CLAIMS,\n        cp.M19_CLAIMS, cp.M20_CLAIMS, cp.M21_CLAIMS, cp.M22_CLAIMS, cp.M23_CLAIMS, cp.M24_CLAIMS,\n        -- Monthly patients\n        cp.M01_PATIENTS, cp.M02_PATIENTS, cp.M03_PATIENTS, cp.M04_PATIENTS, cp.M05_PATIENTS, cp.M06_PATIENTS,\n        cp.M07_PATIENTS, cp.M08_PATIENTS, cp.M09_PATIENTS, cp.M10_PATIENTS, cp.M11_PATIENTS, cp.M12_PATIENTS,\n        cp.M13_PATIENTS, cp.M14_PATIENTS, cp.M15_PATIENTS, cp.M16_PATIENTS, cp.M17_PATIENTS, cp.M18_PATIENTS,\n        cp.M19_PATIENTS, cp.M20_PATIENTS, cp.M21_PATIENTS, cp.M22_PATIENTS, cp.M23_PATIENTS, cp.M24_PATIENTS,\n        -- Rolling claims\n        COALESCE(rmp.L3M_CLAIMS, 0) AS L3M_CLAIMS,\n        COALESCE(rmp.L6M_CLAIMS, 0) AS L6M_CLAIMS,\n        COALESCE(rmp.L12M_CLAIMS, 0) AS L12M_CLAIMS,\n        COALESCE(rmp.L18M_CLAIMS, 0) AS L18M_CLAIMS,\n        COALESCE(rmp.L24M_CLAIMS, 0) AS L24M_CLAIMS,\n        -- Rolling patients\n        COALESCE(rmp.L3M_PATIENTS, 0) AS L3M_PATIENTS,\n        COALESCE(rmp.L6M_PATIENTS, 0) AS L6M_PATIENTS,\n        COALESCE(rmp.L12M_PATIENTS, 0) AS L12M_PATIENTS,\n        COALESCE(rmp.L18M_PATIENTS, 0) AS L18M_PATIENTS,\n        COALESCE(rmp.L24M_PATIENTS, 0) AS L24M_PATIENTS,\n        -- Quarterly claims\n        COALESCE(qmp.Q01_CLAIMS, 0) AS Q01_CLAIMS,\n        COALESCE(qmp.Q02_CLAIMS, 0) AS Q02_CLAIMS,\n        COALESCE(qmp.Q03_CLAIMS, 0) AS Q03_CLAIMS,\n        COALESCE(qmp.Q04_CLAIMS, 0) AS Q04_CLAIMS,\n        COALESCE(qmp.Q05_CLAIMS, 0) AS Q05_CLAIMS,\n        COALESCE(qmp.Q06_CLAIMS, 0) AS Q06_CLAIMS,\n        COALESCE(qmp.Q07_CLAIMS, 0) AS Q07_CLAIMS,\n        COALESCE(qmp.Q08_CLAIMS, 0) AS Q08_CLAIMS,\n        -- Quarterly patients\n        COALESCE(qmp.Q01_PATIENTS, 0) AS Q01_PATIENTS,\n        COALESCE(qmp.Q02_PATIENTS, 0) AS Q02_PATIENTS,\n        COALESCE(qmp.Q03_PATIENTS, 0) AS Q03_PATIENTS,\n        COALESCE(qmp.Q04_PATIENTS, 0) AS Q04_PATIENTS,\n        COALESCE(qmp.Q05_PATIENTS, 0) AS Q05_PATIENTS,\n        COALESCE(qmp.Q06_PATIENTS, 0) AS Q06_PATIENTS,\n        COALESCE(qmp.Q07_PATIENTS, 0) AS Q07_PATIENTS,\n        COALESCE(qmp.Q08_PATIENTS, 0) AS Q08_PATIENTS,\n        -- Annual period metrics\n        COALESCE(amp.TOTAL_CLAIMS, 0) AS TOTAL_CLAIMS,\n        COALESCE(amp.TOTAL_PATIENTS, 0) AS TOTAL_PATIENTS,\n        COALESCE(amp.YTD_CLAIMS, 0) AS YTD_CLAIMS,\n        COALESCE(amp.YTD_PATIENTS, 0) AS YTD_PATIENTS,\n        COALESCE(amp.QTD_CLAIMS, 0) AS QTD_CLAIMS,\n        COALESCE(amp.QTD_PATIENTS, 0) AS QTD_PATIENTS,\n        COALESCE(amp.PY_CLAIMS, 0) AS PY_CLAIMS,\n        COALESCE(amp.PY_PATIENTS, 0) AS PY_PATIENTS,\n        COALESCE(amp.PYTD_CLAIMS, 0) AS PYTD_CLAIMS,\n        COALESCE(amp.PYTD_PATIENTS, 0) AS PYTD_PATIENTS,\n        COALESCE(amp.P2Y_CLAIMS, 0) AS P2Y_CLAIMS,\n        COALESCE(amp.P2Y_PATIENTS, 0) AS P2Y_PATIENTS,\n        COALESCE(amp.CY_CLAIMS, 0) AS CY_CLAIMS,\n        COALESCE(amp.CY_PATIENTS, 0) AS CY_PATIENTS,\n        COALESCE(amp.PY_CY_CLAIMS, 0) AS PY_CY_CLAIMS,\n        COALESCE(amp.PY_CY_PATIENTS, 0) AS PY_CY_PATIENTS,\n        COALESCE(amp.P2Y_CY_CLAIMS, 0) AS P2Y_CY_CLAIMS,\n        COALESCE(amp.P2Y_CY_PATIENTS, 0) AS P2Y_CY_PATIENTS\n    FROM claims_pivoted cp\n    LEFT JOIN rolling_metrics_pivoted rmp\n        ON cp.kmk_hco_id = rmp.kmk_hco_id\n        AND cp.metric_category = rmp.metric_category\n    LEFT JOIN quarterly_metrics_pivoted qmp\n        ON cp.kmk_hco_id = qmp.kmk_hco_id\n        AND cp.metric_category = qmp.metric_category\n    LEFT JOIN annual_metrics_pivoted amp\n        ON cp.kmk_hco_id = amp.kmk_hco_id\n        AND cp.metric_category = amp.metric_category\n),\n\n-- Join with HCO hierarchy for enrichment\nfinal_output AS (\n    SELECT\n        -- Core HCO columns\n        h.kmk_hco_id,\n        h.dh_id,\n        h.org_name,\n        h.hierarchy_level,\n        h.account_type,\n        h.firm_type,\n        h.hq_state,\n        h.kam_territory,\n        h.kam_region,\n\n        -- Metric category\n        ct.metric_category,\n\n        -- Claims by month (M01-M24)\n        ct.M01_CLAIMS,\n        ct.M02_CLAIMS,\n        ct.M03_CLAIMS,\n        ct.M04_CLAIMS,\n        ct.M05_CLAIMS,\n        ct.M06_CLAIMS,\n        ct.M07_CLAIMS,\n        ct.M08_CLAIMS,\n        ct.M09_CLAIMS,\n        ct.M10_CLAIMS,\n        ct.M11_CLAIMS,\n        ct.M12_CLAIMS,\n        ct.M13_CLAIMS,\n        ct.M14_CLAIMS,\n        ct.M15_CLAIMS,\n        ct.M16_CLAIMS,\n        ct.M17_CLAIMS,\n        ct.M18_CLAIMS,\n        ct.M19_CLAIMS,\n        ct.M20_CLAIMS,\n        ct.M21_CLAIMS,\n        ct.M22_CLAIMS,\n        ct.M23_CLAIMS,\n        ct.M24_CLAIMS,\n\n        -- Patients by month (M01-M24)\n        ct.M01_PATIENTS,\n        ct.M02_PATIENTS,\n        ct.M03_PATIENTS,\n        ct.M04_PATIENTS,\n        ct.M05_PATIENTS,\n        ct.M06_PATIENTS,\n        ct.M07_PATIENTS,\n        ct.M08_PATIENTS,\n        ct.M09_PATIENTS,\n        ct.M10_PATIENTS,\n        ct.M11_PATIENTS,\n        ct.M12_PATIENTS,\n        ct.M13_PATIENTS,\n        ct.M14_PATIENTS,\n        ct.M15_PATIENTS,\n        ct.M16_PATIENTS,\n        ct.M17_PATIENTS,\n        ct.M18_PATIENTS,\n        ct.M19_PATIENTS,\n        ct.M20_PATIENTS,\n        ct.M21_PATIENTS,\n        ct.M22_PATIENTS,\n        ct.M23_PATIENTS,\n        ct.M24_PATIENTS,\n\n        -- Rolling Claims (L3M-L24M)\n        ct.L3M_CLAIMS,\n        ct.L6M_CLAIMS,\n        ct.L12M_CLAIMS,\n        ct.L18M_CLAIMS,\n        ct.L24M_CLAIMS,\n\n        -- Rolling Patients (L3M-L24M)\n        ct.L3M_PATIENTS,\n        ct.L6M_PATIENTS,\n        ct.L12M_PATIENTS,\n        ct.L18M_PATIENTS,\n        ct.L24M_PATIENTS,\n\n        -- Quarterly Claims (Q01-Q08)\n        ct.Q01_CLAIMS,\n        ct.Q02_CLAIMS,\n        ct.Q03_CLAIMS,\n        ct.Q04_CLAIMS,\n        ct.Q05_CLAIMS,\n        ct.Q06_CLAIMS,\n        ct.Q07_CLAIMS,\n        ct.Q08_CLAIMS,\n\n        -- Quarterly Patients (Q01-Q08)\n        ct.Q01_PATIENTS,\n        ct.Q02_PATIENTS,\n        ct.Q03_PATIENTS,\n        ct.Q04_PATIENTS,\n        ct.Q05_PATIENTS,\n        ct.Q06_PATIENTS,\n        ct.Q07_PATIENTS,\n        ct.Q08_PATIENTS,\n\n        -- Totals (from pre-computed rolling period - proper distinct counts)\n        ct.TOTAL_CLAIMS,\n        ct.TOTAL_PATIENTS,\n\n        -- Annual Period Metrics (YTD, QTD, PY, PYTD, P2Y, Calendar Years)\n        ct.YTD_CLAIMS,\n        ct.YTD_PATIENTS,\n        ct.QTD_CLAIMS,\n        ct.QTD_PATIENTS,\n        ct.PY_CLAIMS,\n        ct.PY_PATIENTS,\n        ct.PYTD_CLAIMS,\n        ct.PYTD_PATIENTS,\n        ct.P2Y_CLAIMS,\n        ct.P2Y_PATIENTS,\n        ct.CY_CLAIMS,\n        ct.CY_PATIENTS,\n        ct.PY_CY_CLAIMS,\n        ct.PY_CY_PATIENTS,\n        ct.P2Y_CY_CLAIMS,\n        ct.P2Y_CY_PATIENTS,\n\n        -- Metadata\n        ddr.data_date AS data_date\n\n    FROM claims_with_all_periods ct\n    LEFT JOIN hco_hierarchy h ON ct.kmk_hco_id = h.kmk_hco_id\n    CROSS JOIN data_date_ref ddr\n)\n\nSELECT * FROM final_output", "doc_blocks": [], "language": "sql", "refs": [{"name": "ref_time_periods", "package": null, "version": null}, {"name": "adm_hco_hierarchy", "package": null, "version": null}, {"name": "adm_hco_master", "package": null, "version": null}, {"name": "adm_claims_metrics_long", "package": null, "version": null}, {"name": "adm_claims_metrics_long", "package": null, "version": null}, {"name": "adm_claims_metrics_long", "package": null, "version": null}, {"name": "adm_claims_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.ref_time_periods", "model.CGOncology_MDM.adm_hco_hierarchy", "model.CGOncology_MDM.adm_hco_master", "model.CGOncology_MDM.adm_claims_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["kmk_hco_id", "metric_category"], "time_spine": null}, "model.CGOncology_MDM.adm_address_best_hco_metrics_wide": {"database": "CGONCOLOGY_TEST", "schema": "ADM", "name": "adm_address_best_hco_metrics_wide", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "adm/adm_address_best_hco_metrics_wide.sql", "original_file_path": "models/adm/adm_address_best_hco_metrics_wide.sql", "unique_id": "model.CGOncology_MDM.adm_address_best_hco_metrics_wide", "fqn": ["CGOncology_MDM", "adm", "adm_address_best_hco_metrics_wide"], "alias": "adm_address_best_hco_metrics_wide", "checksum": {"name": "sha256", "checksum": "c12f97232c62df8116a0a387e6c22f1927a13479158a3b7c9e704b88cc1196e7"}, "config": {"enabled": true, "alias": null, "schema": "ADM", "database": null, "tags": ["layer_4_adm", "customer_backbone", "customer_backbone", "adm", "metrics", "address_best"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_4_adm", "customer_backbone", "adm", "metrics", "address_best"], "description": "Claims metrics aggregated to address-best HCO level (wide format).\nPivots metrics from long to wide format with M01-M24, rolling, quarterly, annual columns.\nBusiness Rules: ABH-001 to ABH-005, MET-010 to MET-015\nGrain: (kmk_hco_id, metric_category) where kmk_hco_id = address_best_hco_id\n", "columns": {"kmk_hco_id": {"name": "kmk_hco_id", "description": "Address-best HCO identifier (primary key with metric_category)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "metric_category": {"name": "metric_category", "description": "Treatment category", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "address_key": {"name": "address_key", "description": "Composite address key", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "address_group_count": {"name": "address_group_count", "description": "Count of HCOs in address group", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "contributing_hco_count": {"name": "contributing_hco_count", "description": "Count of source HCOs contributing", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/adm/schema.yml", "build_path": null, "unrendered_config": {"schema": "ADM", "materialized": "table", "tags": ["customer_backbone", "adm", "metrics", "address_best"]}, "created_at": 1770177079.587768, "relation_name": "CGONCOLOGY_TEST.ADM.adm_address_best_hco_metrics_wide", "raw_code": "{{\n    config(\n        schema='ADM',\n        materialized='table',\n        tags=['customer_backbone', 'adm', 'metrics', 'address_best']\n    )\n}}\n\n/*\nADM_ADDRESS_BEST_HCO_METRICS_WIDE - Address-Best HCO Claims Metrics in Wide Format\nBusiness Rules: ABH-001 to ABH-005, MET-010 to MET-015\n\nPurpose: Pivots address-best claims metrics from long to wide format, similar to\nadm_hco_claims_wide but aggregated at the address-best level.\n\nGrain: One row per (address_best_hco_id, metric_category)\n\nPeriod Columns:\n- Monthly: M01-M24 (claims and patients)\n- Rolling: L3M, L6M, L12M, L18M, L24M (claims and patients)\n- Quarterly: Q01-Q08 (claims and patients)\n- Annual: YTD, QTD, PY, PYTD, P2Y (claims and patients)\n- Calendar Years: CY, PY_CY, P2Y_CY (claims and patients)\n- TOTAL: All-time (claims and patients)\n\nAdditional Columns:\n- contributing_hco_count: Count of HCOs aggregated to this address_best\n- address_group_count: Count of HCOs sharing this address\n*/\n\n-- Get data_date from ref_time_periods\nWITH data_date_ref AS (\n    SELECT DISTINCT data_date, YEAR(data_date) AS current_year\n    FROM {{ ref('ref_time_periods') }}\n    LIMIT 1\n),\n\n-- Get address_best attributes from bridge table and hierarchy\naddress_best_attributes AS (\n    SELECT\n        ab.kmk_hco_id AS address_best_hco_id,\n        h.dh_id,\n        h.org_name,\n        h.hierarchy_level,\n        m.account_type,\n        h.firm_type,\n        h.hq_state,\n        h.kam_territory,\n        h.kam_region,\n        ab.address_key,\n        ab.address_group_count\n    FROM {{ ref('ref_address_best_hco') }} ab\n    LEFT JOIN {{ ref('adm_hco_hierarchy') }} h ON ab.kmk_hco_id = h.kmk_hco_id\n    LEFT JOIN {{ ref('adm_hco_master') }} m ON ab.kmk_hco_id = m.kmk_hco_id\n    WHERE ab.is_address_best = 'Y'\n),\n\n-- Filter to address_best metrics only (monthly periods for pivot)\nmetrics_long AS (\n    SELECT\n        entity_id AS address_best_hco_id,\n        metric_category,\n        period_key,\n        claim_count,\n        patient_count,\n        contributing_hco_count\n    FROM {{ ref('adm_address_best_hco_metrics_long') }}\n    WHERE entity_type = 'ADDRESS_BEST_HCO'\n      AND period_key LIKE 'M%'  -- Monthly periods only for pivot\n),\n\n-- Get rolling period metrics (L3M, L6M, L12M, L18M, L24M)\nrolling_metrics AS (\n    SELECT\n        entity_id AS address_best_hco_id,\n        metric_category,\n        period_key,\n        claim_count,\n        patient_count,\n        contributing_hco_count\n    FROM {{ ref('adm_address_best_hco_metrics_long') }}\n    WHERE entity_type = 'ADDRESS_BEST_HCO'\n      AND period_key IN ('L3M', 'L6M', 'L12M', 'L18M', 'L24M')\n),\n\n-- Get quarterly period metrics (Q01-Q08)\nquarterly_metrics AS (\n    SELECT\n        entity_id AS address_best_hco_id,\n        metric_category,\n        period_key,\n        claim_count,\n        patient_count,\n        contributing_hco_count\n    FROM {{ ref('adm_address_best_hco_metrics_long') }}\n    WHERE entity_type = 'ADDRESS_BEST_HCO'\n      AND period_key LIKE 'Q%'\n),\n\n-- Get TOTAL and annual period metrics\nannual_metrics AS (\n    SELECT\n        entity_id AS address_best_hco_id,\n        metric_category,\n        period_key,\n        claim_count,\n        patient_count,\n        contributing_hco_count\n    FROM {{ ref('adm_address_best_hco_metrics_long') }}\n    CROSS JOIN data_date_ref ddr\n    WHERE entity_type = 'ADDRESS_BEST_HCO'\n      AND (\n          period_key = 'TOTAL'\n          OR period_key LIKE 'YTD_%'\n          OR period_key LIKE 'QTD_%'\n          OR period_key LIKE 'PY_%'\n          OR period_key LIKE 'PYTD_%'\n          OR period_key LIKE 'P2Y_%'\n          OR (REGEXP_LIKE(period_key, '^[0-9]{4}$') AND TRY_CAST(period_key AS INTEGER) >= ddr.current_year - 2)\n      )\n),\n\n-- Pivot period_key to M01-M24 columns for claims\nclaims_pivoted AS (\n    SELECT\n        address_best_hco_id,\n        metric_category,\n        -- Claims by month (M01-M24)\n        MAX(CASE WHEN period_key = 'M01' THEN claim_count ELSE 0 END) AS M01_CLAIMS,\n        MAX(CASE WHEN period_key = 'M02' THEN claim_count ELSE 0 END) AS M02_CLAIMS,\n        MAX(CASE WHEN period_key = 'M03' THEN claim_count ELSE 0 END) AS M03_CLAIMS,\n        MAX(CASE WHEN period_key = 'M04' THEN claim_count ELSE 0 END) AS M04_CLAIMS,\n        MAX(CASE WHEN period_key = 'M05' THEN claim_count ELSE 0 END) AS M05_CLAIMS,\n        MAX(CASE WHEN period_key = 'M06' THEN claim_count ELSE 0 END) AS M06_CLAIMS,\n        MAX(CASE WHEN period_key = 'M07' THEN claim_count ELSE 0 END) AS M07_CLAIMS,\n        MAX(CASE WHEN period_key = 'M08' THEN claim_count ELSE 0 END) AS M08_CLAIMS,\n        MAX(CASE WHEN period_key = 'M09' THEN claim_count ELSE 0 END) AS M09_CLAIMS,\n        MAX(CASE WHEN period_key = 'M10' THEN claim_count ELSE 0 END) AS M10_CLAIMS,\n        MAX(CASE WHEN period_key = 'M11' THEN claim_count ELSE 0 END) AS M11_CLAIMS,\n        MAX(CASE WHEN period_key = 'M12' THEN claim_count ELSE 0 END) AS M12_CLAIMS,\n        MAX(CASE WHEN period_key = 'M13' THEN claim_count ELSE 0 END) AS M13_CLAIMS,\n        MAX(CASE WHEN period_key = 'M14' THEN claim_count ELSE 0 END) AS M14_CLAIMS,\n        MAX(CASE WHEN period_key = 'M15' THEN claim_count ELSE 0 END) AS M15_CLAIMS,\n        MAX(CASE WHEN period_key = 'M16' THEN claim_count ELSE 0 END) AS M16_CLAIMS,\n        MAX(CASE WHEN period_key = 'M17' THEN claim_count ELSE 0 END) AS M17_CLAIMS,\n        MAX(CASE WHEN period_key = 'M18' THEN claim_count ELSE 0 END) AS M18_CLAIMS,\n        MAX(CASE WHEN period_key = 'M19' THEN claim_count ELSE 0 END) AS M19_CLAIMS,\n        MAX(CASE WHEN period_key = 'M20' THEN claim_count ELSE 0 END) AS M20_CLAIMS,\n        MAX(CASE WHEN period_key = 'M21' THEN claim_count ELSE 0 END) AS M21_CLAIMS,\n        MAX(CASE WHEN period_key = 'M22' THEN claim_count ELSE 0 END) AS M22_CLAIMS,\n        MAX(CASE WHEN period_key = 'M23' THEN claim_count ELSE 0 END) AS M23_CLAIMS,\n        MAX(CASE WHEN period_key = 'M24' THEN claim_count ELSE 0 END) AS M24_CLAIMS,\n        -- Patients by month (M01-M24)\n        MAX(CASE WHEN period_key = 'M01' THEN patient_count ELSE 0 END) AS M01_PATIENTS,\n        MAX(CASE WHEN period_key = 'M02' THEN patient_count ELSE 0 END) AS M02_PATIENTS,\n        MAX(CASE WHEN period_key = 'M03' THEN patient_count ELSE 0 END) AS M03_PATIENTS,\n        MAX(CASE WHEN period_key = 'M04' THEN patient_count ELSE 0 END) AS M04_PATIENTS,\n        MAX(CASE WHEN period_key = 'M05' THEN patient_count ELSE 0 END) AS M05_PATIENTS,\n        MAX(CASE WHEN period_key = 'M06' THEN patient_count ELSE 0 END) AS M06_PATIENTS,\n        MAX(CASE WHEN period_key = 'M07' THEN patient_count ELSE 0 END) AS M07_PATIENTS,\n        MAX(CASE WHEN period_key = 'M08' THEN patient_count ELSE 0 END) AS M08_PATIENTS,\n        MAX(CASE WHEN period_key = 'M09' THEN patient_count ELSE 0 END) AS M09_PATIENTS,\n        MAX(CASE WHEN period_key = 'M10' THEN patient_count ELSE 0 END) AS M10_PATIENTS,\n        MAX(CASE WHEN period_key = 'M11' THEN patient_count ELSE 0 END) AS M11_PATIENTS,\n        MAX(CASE WHEN period_key = 'M12' THEN patient_count ELSE 0 END) AS M12_PATIENTS,\n        MAX(CASE WHEN period_key = 'M13' THEN patient_count ELSE 0 END) AS M13_PATIENTS,\n        MAX(CASE WHEN period_key = 'M14' THEN patient_count ELSE 0 END) AS M14_PATIENTS,\n        MAX(CASE WHEN period_key = 'M15' THEN patient_count ELSE 0 END) AS M15_PATIENTS,\n        MAX(CASE WHEN period_key = 'M16' THEN patient_count ELSE 0 END) AS M16_PATIENTS,\n        MAX(CASE WHEN period_key = 'M17' THEN patient_count ELSE 0 END) AS M17_PATIENTS,\n        MAX(CASE WHEN period_key = 'M18' THEN patient_count ELSE 0 END) AS M18_PATIENTS,\n        MAX(CASE WHEN period_key = 'M19' THEN patient_count ELSE 0 END) AS M19_PATIENTS,\n        MAX(CASE WHEN period_key = 'M20' THEN patient_count ELSE 0 END) AS M20_PATIENTS,\n        MAX(CASE WHEN period_key = 'M21' THEN patient_count ELSE 0 END) AS M21_PATIENTS,\n        MAX(CASE WHEN period_key = 'M22' THEN patient_count ELSE 0 END) AS M22_PATIENTS,\n        MAX(CASE WHEN period_key = 'M23' THEN patient_count ELSE 0 END) AS M23_PATIENTS,\n        MAX(CASE WHEN period_key = 'M24' THEN patient_count ELSE 0 END) AS M24_PATIENTS,\n        -- Contributing HCO count (max across periods)\n        MAX(contributing_hco_count) AS contributing_hco_count\n    FROM metrics_long\n    GROUP BY address_best_hco_id, metric_category\n),\n\n-- Pivot rolling metrics to wide format (L3M-L24M)\nrolling_metrics_pivoted AS (\n    SELECT\n        address_best_hco_id,\n        metric_category,\n        MAX(CASE WHEN period_key = 'L3M' THEN claim_count ELSE 0 END) AS L3M_CLAIMS,\n        MAX(CASE WHEN period_key = 'L6M' THEN claim_count ELSE 0 END) AS L6M_CLAIMS,\n        MAX(CASE WHEN period_key = 'L12M' THEN claim_count ELSE 0 END) AS L12M_CLAIMS,\n        MAX(CASE WHEN period_key = 'L18M' THEN claim_count ELSE 0 END) AS L18M_CLAIMS,\n        MAX(CASE WHEN period_key = 'L24M' THEN claim_count ELSE 0 END) AS L24M_CLAIMS,\n        MAX(CASE WHEN period_key = 'L3M' THEN patient_count ELSE 0 END) AS L3M_PATIENTS,\n        MAX(CASE WHEN period_key = 'L6M' THEN patient_count ELSE 0 END) AS L6M_PATIENTS,\n        MAX(CASE WHEN period_key = 'L12M' THEN patient_count ELSE 0 END) AS L12M_PATIENTS,\n        MAX(CASE WHEN period_key = 'L18M' THEN patient_count ELSE 0 END) AS L18M_PATIENTS,\n        MAX(CASE WHEN period_key = 'L24M' THEN patient_count ELSE 0 END) AS L24M_PATIENTS\n    FROM rolling_metrics\n    GROUP BY address_best_hco_id, metric_category\n),\n\n-- Pivot quarterly metrics to wide format (Q01-Q08)\nquarterly_metrics_pivoted AS (\n    SELECT\n        address_best_hco_id,\n        metric_category,\n        MAX(CASE WHEN period_key = 'Q01' THEN claim_count ELSE 0 END) AS Q01_CLAIMS,\n        MAX(CASE WHEN period_key = 'Q02' THEN claim_count ELSE 0 END) AS Q02_CLAIMS,\n        MAX(CASE WHEN period_key = 'Q03' THEN claim_count ELSE 0 END) AS Q03_CLAIMS,\n        MAX(CASE WHEN period_key = 'Q04' THEN claim_count ELSE 0 END) AS Q04_CLAIMS,\n        MAX(CASE WHEN period_key = 'Q05' THEN claim_count ELSE 0 END) AS Q05_CLAIMS,\n        MAX(CASE WHEN period_key = 'Q06' THEN claim_count ELSE 0 END) AS Q06_CLAIMS,\n        MAX(CASE WHEN period_key = 'Q07' THEN claim_count ELSE 0 END) AS Q07_CLAIMS,\n        MAX(CASE WHEN period_key = 'Q08' THEN claim_count ELSE 0 END) AS Q08_CLAIMS,\n        MAX(CASE WHEN period_key = 'Q01' THEN patient_count ELSE 0 END) AS Q01_PATIENTS,\n        MAX(CASE WHEN period_key = 'Q02' THEN patient_count ELSE 0 END) AS Q02_PATIENTS,\n        MAX(CASE WHEN period_key = 'Q03' THEN patient_count ELSE 0 END) AS Q03_PATIENTS,\n        MAX(CASE WHEN period_key = 'Q04' THEN patient_count ELSE 0 END) AS Q04_PATIENTS,\n        MAX(CASE WHEN period_key = 'Q05' THEN patient_count ELSE 0 END) AS Q05_PATIENTS,\n        MAX(CASE WHEN period_key = 'Q06' THEN patient_count ELSE 0 END) AS Q06_PATIENTS,\n        MAX(CASE WHEN period_key = 'Q07' THEN patient_count ELSE 0 END) AS Q07_PATIENTS,\n        MAX(CASE WHEN period_key = 'Q08' THEN patient_count ELSE 0 END) AS Q08_PATIENTS\n    FROM quarterly_metrics\n    GROUP BY address_best_hco_id, metric_category\n),\n\n-- Pivot annual metrics to wide format\nannual_metrics_pivoted AS (\n    SELECT\n        am.address_best_hco_id,\n        am.metric_category,\n        MAX(CASE WHEN am.period_key = 'TOTAL' THEN am.claim_count ELSE 0 END) AS TOTAL_CLAIMS,\n        MAX(CASE WHEN am.period_key LIKE 'YTD_%' THEN am.claim_count ELSE 0 END) AS YTD_CLAIMS,\n        MAX(CASE WHEN am.period_key LIKE 'QTD_%' THEN am.claim_count ELSE 0 END) AS QTD_CLAIMS,\n        MAX(CASE WHEN am.period_key LIKE 'PY_%' AND am.period_key NOT LIKE 'PYTD_%' AND am.period_key NOT LIKE 'P2Y_%' THEN am.claim_count ELSE 0 END) AS PY_CLAIMS,\n        MAX(CASE WHEN am.period_key LIKE 'PYTD_%' THEN am.claim_count ELSE 0 END) AS PYTD_CLAIMS,\n        MAX(CASE WHEN am.period_key LIKE 'P2Y_%' THEN am.claim_count ELSE 0 END) AS P2Y_CLAIMS,\n        MAX(CASE WHEN REGEXP_LIKE(am.period_key, '^[0-9]{4}$') AND TRY_CAST(am.period_key AS INTEGER) = ddr.current_year THEN am.claim_count ELSE 0 END) AS CY_CLAIMS,\n        MAX(CASE WHEN REGEXP_LIKE(am.period_key, '^[0-9]{4}$') AND TRY_CAST(am.period_key AS INTEGER) = ddr.current_year - 1 THEN am.claim_count ELSE 0 END) AS PY_CY_CLAIMS,\n        MAX(CASE WHEN REGEXP_LIKE(am.period_key, '^[0-9]{4}$') AND TRY_CAST(am.period_key AS INTEGER) = ddr.current_year - 2 THEN am.claim_count ELSE 0 END) AS P2Y_CY_CLAIMS,\n        MAX(CASE WHEN am.period_key = 'TOTAL' THEN am.patient_count ELSE 0 END) AS TOTAL_PATIENTS,\n        MAX(CASE WHEN am.period_key LIKE 'YTD_%' THEN am.patient_count ELSE 0 END) AS YTD_PATIENTS,\n        MAX(CASE WHEN am.period_key LIKE 'QTD_%' THEN am.patient_count ELSE 0 END) AS QTD_PATIENTS,\n        MAX(CASE WHEN am.period_key LIKE 'PY_%' AND am.period_key NOT LIKE 'PYTD_%' AND am.period_key NOT LIKE 'P2Y_%' THEN am.patient_count ELSE 0 END) AS PY_PATIENTS,\n        MAX(CASE WHEN am.period_key LIKE 'PYTD_%' THEN am.patient_count ELSE 0 END) AS PYTD_PATIENTS,\n        MAX(CASE WHEN am.period_key LIKE 'P2Y_%' THEN am.patient_count ELSE 0 END) AS P2Y_PATIENTS,\n        MAX(CASE WHEN REGEXP_LIKE(am.period_key, '^[0-9]{4}$') AND TRY_CAST(am.period_key AS INTEGER) = ddr.current_year THEN am.patient_count ELSE 0 END) AS CY_PATIENTS,\n        MAX(CASE WHEN REGEXP_LIKE(am.period_key, '^[0-9]{4}$') AND TRY_CAST(am.period_key AS INTEGER) = ddr.current_year - 1 THEN am.patient_count ELSE 0 END) AS PY_CY_PATIENTS,\n        MAX(CASE WHEN REGEXP_LIKE(am.period_key, '^[0-9]{4}$') AND TRY_CAST(am.period_key AS INTEGER) = ddr.current_year - 2 THEN am.patient_count ELSE 0 END) AS P2Y_CY_PATIENTS\n    FROM annual_metrics am\n    CROSS JOIN data_date_ref ddr\n    GROUP BY am.address_best_hco_id, am.metric_category\n),\n\n-- Join all pivoted data together\nclaims_with_all_periods AS (\n    SELECT\n        cp.address_best_hco_id,\n        cp.metric_category,\n        -- Monthly claims\n        cp.M01_CLAIMS, cp.M02_CLAIMS, cp.M03_CLAIMS, cp.M04_CLAIMS, cp.M05_CLAIMS, cp.M06_CLAIMS,\n        cp.M07_CLAIMS, cp.M08_CLAIMS, cp.M09_CLAIMS, cp.M10_CLAIMS, cp.M11_CLAIMS, cp.M12_CLAIMS,\n        cp.M13_CLAIMS, cp.M14_CLAIMS, cp.M15_CLAIMS, cp.M16_CLAIMS, cp.M17_CLAIMS, cp.M18_CLAIMS,\n        cp.M19_CLAIMS, cp.M20_CLAIMS, cp.M21_CLAIMS, cp.M22_CLAIMS, cp.M23_CLAIMS, cp.M24_CLAIMS,\n        -- Monthly patients\n        cp.M01_PATIENTS, cp.M02_PATIENTS, cp.M03_PATIENTS, cp.M04_PATIENTS, cp.M05_PATIENTS, cp.M06_PATIENTS,\n        cp.M07_PATIENTS, cp.M08_PATIENTS, cp.M09_PATIENTS, cp.M10_PATIENTS, cp.M11_PATIENTS, cp.M12_PATIENTS,\n        cp.M13_PATIENTS, cp.M14_PATIENTS, cp.M15_PATIENTS, cp.M16_PATIENTS, cp.M17_PATIENTS, cp.M18_PATIENTS,\n        cp.M19_PATIENTS, cp.M20_PATIENTS, cp.M21_PATIENTS, cp.M22_PATIENTS, cp.M23_PATIENTS, cp.M24_PATIENTS,\n        -- Rolling claims\n        COALESCE(rmp.L3M_CLAIMS, 0) AS L3M_CLAIMS,\n        COALESCE(rmp.L6M_CLAIMS, 0) AS L6M_CLAIMS,\n        COALESCE(rmp.L12M_CLAIMS, 0) AS L12M_CLAIMS,\n        COALESCE(rmp.L18M_CLAIMS, 0) AS L18M_CLAIMS,\n        COALESCE(rmp.L24M_CLAIMS, 0) AS L24M_CLAIMS,\n        -- Rolling patients\n        COALESCE(rmp.L3M_PATIENTS, 0) AS L3M_PATIENTS,\n        COALESCE(rmp.L6M_PATIENTS, 0) AS L6M_PATIENTS,\n        COALESCE(rmp.L12M_PATIENTS, 0) AS L12M_PATIENTS,\n        COALESCE(rmp.L18M_PATIENTS, 0) AS L18M_PATIENTS,\n        COALESCE(rmp.L24M_PATIENTS, 0) AS L24M_PATIENTS,\n        -- Quarterly claims\n        COALESCE(qmp.Q01_CLAIMS, 0) AS Q01_CLAIMS,\n        COALESCE(qmp.Q02_CLAIMS, 0) AS Q02_CLAIMS,\n        COALESCE(qmp.Q03_CLAIMS, 0) AS Q03_CLAIMS,\n        COALESCE(qmp.Q04_CLAIMS, 0) AS Q04_CLAIMS,\n        COALESCE(qmp.Q05_CLAIMS, 0) AS Q05_CLAIMS,\n        COALESCE(qmp.Q06_CLAIMS, 0) AS Q06_CLAIMS,\n        COALESCE(qmp.Q07_CLAIMS, 0) AS Q07_CLAIMS,\n        COALESCE(qmp.Q08_CLAIMS, 0) AS Q08_CLAIMS,\n        -- Quarterly patients\n        COALESCE(qmp.Q01_PATIENTS, 0) AS Q01_PATIENTS,\n        COALESCE(qmp.Q02_PATIENTS, 0) AS Q02_PATIENTS,\n        COALESCE(qmp.Q03_PATIENTS, 0) AS Q03_PATIENTS,\n        COALESCE(qmp.Q04_PATIENTS, 0) AS Q04_PATIENTS,\n        COALESCE(qmp.Q05_PATIENTS, 0) AS Q05_PATIENTS,\n        COALESCE(qmp.Q06_PATIENTS, 0) AS Q06_PATIENTS,\n        COALESCE(qmp.Q07_PATIENTS, 0) AS Q07_PATIENTS,\n        COALESCE(qmp.Q08_PATIENTS, 0) AS Q08_PATIENTS,\n        -- Annual period metrics\n        COALESCE(amp.TOTAL_CLAIMS, 0) AS TOTAL_CLAIMS,\n        COALESCE(amp.TOTAL_PATIENTS, 0) AS TOTAL_PATIENTS,\n        COALESCE(amp.YTD_CLAIMS, 0) AS YTD_CLAIMS,\n        COALESCE(amp.YTD_PATIENTS, 0) AS YTD_PATIENTS,\n        COALESCE(amp.QTD_CLAIMS, 0) AS QTD_CLAIMS,\n        COALESCE(amp.QTD_PATIENTS, 0) AS QTD_PATIENTS,\n        COALESCE(amp.PY_CLAIMS, 0) AS PY_CLAIMS,\n        COALESCE(amp.PY_PATIENTS, 0) AS PY_PATIENTS,\n        COALESCE(amp.PYTD_CLAIMS, 0) AS PYTD_CLAIMS,\n        COALESCE(amp.PYTD_PATIENTS, 0) AS PYTD_PATIENTS,\n        COALESCE(amp.P2Y_CLAIMS, 0) AS P2Y_CLAIMS,\n        COALESCE(amp.P2Y_PATIENTS, 0) AS P2Y_PATIENTS,\n        COALESCE(amp.CY_CLAIMS, 0) AS CY_CLAIMS,\n        COALESCE(amp.CY_PATIENTS, 0) AS CY_PATIENTS,\n        COALESCE(amp.PY_CY_CLAIMS, 0) AS PY_CY_CLAIMS,\n        COALESCE(amp.PY_CY_PATIENTS, 0) AS PY_CY_PATIENTS,\n        COALESCE(amp.P2Y_CY_CLAIMS, 0) AS P2Y_CY_CLAIMS,\n        COALESCE(amp.P2Y_CY_PATIENTS, 0) AS P2Y_CY_PATIENTS,\n        -- Contributing HCO count\n        cp.contributing_hco_count\n    FROM claims_pivoted cp\n    LEFT JOIN rolling_metrics_pivoted rmp\n        ON cp.address_best_hco_id = rmp.address_best_hco_id\n        AND cp.metric_category = rmp.metric_category\n    LEFT JOIN quarterly_metrics_pivoted qmp\n        ON cp.address_best_hco_id = qmp.address_best_hco_id\n        AND cp.metric_category = qmp.metric_category\n    LEFT JOIN annual_metrics_pivoted amp\n        ON cp.address_best_hco_id = amp.address_best_hco_id\n        AND cp.metric_category = amp.metric_category\n),\n\n-- Join with address_best attributes for enrichment\nfinal_output AS (\n    SELECT\n        -- Core address_best HCO columns\n        h.address_best_hco_id AS kmk_hco_id,\n        h.dh_id,\n        h.org_name,\n        h.hierarchy_level,\n        h.account_type,\n        h.firm_type,\n        h.hq_state,\n        h.kam_territory,\n        h.kam_region,\n        h.address_key,\n        h.address_group_count,\n\n        -- Metric category\n        ct.metric_category,\n\n        -- Contributing HCO count\n        ct.contributing_hco_count,\n\n        -- Claims by month (M01-M24)\n        ct.M01_CLAIMS, ct.M02_CLAIMS, ct.M03_CLAIMS, ct.M04_CLAIMS, ct.M05_CLAIMS, ct.M06_CLAIMS,\n        ct.M07_CLAIMS, ct.M08_CLAIMS, ct.M09_CLAIMS, ct.M10_CLAIMS, ct.M11_CLAIMS, ct.M12_CLAIMS,\n        ct.M13_CLAIMS, ct.M14_CLAIMS, ct.M15_CLAIMS, ct.M16_CLAIMS, ct.M17_CLAIMS, ct.M18_CLAIMS,\n        ct.M19_CLAIMS, ct.M20_CLAIMS, ct.M21_CLAIMS, ct.M22_CLAIMS, ct.M23_CLAIMS, ct.M24_CLAIMS,\n\n        -- Patients by month (M01-M24)\n        ct.M01_PATIENTS, ct.M02_PATIENTS, ct.M03_PATIENTS, ct.M04_PATIENTS, ct.M05_PATIENTS, ct.M06_PATIENTS,\n        ct.M07_PATIENTS, ct.M08_PATIENTS, ct.M09_PATIENTS, ct.M10_PATIENTS, ct.M11_PATIENTS, ct.M12_PATIENTS,\n        ct.M13_PATIENTS, ct.M14_PATIENTS, ct.M15_PATIENTS, ct.M16_PATIENTS, ct.M17_PATIENTS, ct.M18_PATIENTS,\n        ct.M19_PATIENTS, ct.M20_PATIENTS, ct.M21_PATIENTS, ct.M22_PATIENTS, ct.M23_PATIENTS, ct.M24_PATIENTS,\n\n        -- Rolling Claims (L3M-L24M)\n        ct.L3M_CLAIMS, ct.L6M_CLAIMS, ct.L12M_CLAIMS, ct.L18M_CLAIMS, ct.L24M_CLAIMS,\n\n        -- Rolling Patients (L3M-L24M)\n        ct.L3M_PATIENTS, ct.L6M_PATIENTS, ct.L12M_PATIENTS, ct.L18M_PATIENTS, ct.L24M_PATIENTS,\n\n        -- Quarterly Claims (Q01-Q08)\n        ct.Q01_CLAIMS, ct.Q02_CLAIMS, ct.Q03_CLAIMS, ct.Q04_CLAIMS,\n        ct.Q05_CLAIMS, ct.Q06_CLAIMS, ct.Q07_CLAIMS, ct.Q08_CLAIMS,\n\n        -- Quarterly Patients (Q01-Q08)\n        ct.Q01_PATIENTS, ct.Q02_PATIENTS, ct.Q03_PATIENTS, ct.Q04_PATIENTS,\n        ct.Q05_PATIENTS, ct.Q06_PATIENTS, ct.Q07_PATIENTS, ct.Q08_PATIENTS,\n\n        -- Totals\n        ct.TOTAL_CLAIMS, ct.TOTAL_PATIENTS,\n\n        -- Annual Period Metrics\n        ct.YTD_CLAIMS, ct.YTD_PATIENTS,\n        ct.QTD_CLAIMS, ct.QTD_PATIENTS,\n        ct.PY_CLAIMS, ct.PY_PATIENTS,\n        ct.PYTD_CLAIMS, ct.PYTD_PATIENTS,\n        ct.P2Y_CLAIMS, ct.P2Y_PATIENTS,\n        ct.CY_CLAIMS, ct.CY_PATIENTS,\n        ct.PY_CY_CLAIMS, ct.PY_CY_PATIENTS,\n        ct.P2Y_CY_CLAIMS, ct.P2Y_CY_PATIENTS,\n\n        -- Metadata\n        ddr.data_date AS data_date\n\n    FROM claims_with_all_periods ct\n    LEFT JOIN address_best_attributes h ON ct.address_best_hco_id = h.address_best_hco_id\n    CROSS JOIN data_date_ref ddr\n)\n\nSELECT * FROM final_output", "doc_blocks": [], "language": "sql", "refs": [{"name": "ref_time_periods", "package": null, "version": null}, {"name": "ref_address_best_hco", "package": null, "version": null}, {"name": "adm_hco_hierarchy", "package": null, "version": null}, {"name": "adm_hco_master", "package": null, "version": null}, {"name": "adm_address_best_hco_metrics_long", "package": null, "version": null}, {"name": "adm_address_best_hco_metrics_long", "package": null, "version": null}, {"name": "adm_address_best_hco_metrics_long", "package": null, "version": null}, {"name": "adm_address_best_hco_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.ref_time_periods", "model.CGOncology_MDM.ref_address_best_hco", "model.CGOncology_MDM.adm_hco_hierarchy", "model.CGOncology_MDM.adm_hco_master", "model.CGOncology_MDM.adm_address_best_hco_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}, "model.CGOncology_MDM.adm_pipeline_snapshot": {"database": "CGONCOLOGY_TEST", "schema": "ARCHIVE", "name": "adm_pipeline_snapshot", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "adm/adm_pipeline_snapshot.sql", "original_file_path": "models/adm/adm_pipeline_snapshot.sql", "unique_id": "model.CGOncology_MDM.adm_pipeline_snapshot", "fqn": ["CGOncology_MDM", "adm", "adm_pipeline_snapshot"], "alias": "adm_pipeline_snapshot", "checksum": {"name": "sha256", "checksum": "812385e8b483087dd8d276c636a35422212a0d83ae2bfcfbde978367879af264"}, "config": {"enabled": true, "alias": null, "schema": "ARCHIVE", "database": null, "tags": ["layer_4_adm", "customer_backbone", "pipeline_monitoring"], "meta": {}, "group": null, "materialized": "incremental", "incremental_strategy": "append", "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_4_adm", "customer_backbone", "pipeline_monitoring"], "description": "Pipeline metrics snapshot (append-only incremental).\nCaptures ~300 rows of aggregate metrics per pipeline run for diff/trend analysis.\nUses direct table references (no ref()) to capture pre-refresh state.\nGrain: (run_timestamp, data_date, metric_group, metric_name, dimension_value, entity_id, rank_position)\n", "columns": {"run_timestamp": {"name": "run_timestamp", "description": "Timestamp when snapshot was taken", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "data_date": {"name": "data_date", "description": "Pipeline data_date (from dbt var)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "metric_group": {"name": "metric_group", "description": "Category: ROW_COUNT, DIST_*, CLAIMS_L12M, DDD_SALES_L12M, TOP20_HCO, etc.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "metric_name": {"name": "metric_name", "description": "What is being measured (table name, column name, metric category)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "dimension_value": {"name": "dimension_value", "description": "Category value (e.g., L3, FEDERAL, Y) - nullable", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "entity_id": {"name": "entity_id", "description": "Entity ID for TOP20 metrics - nullable", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "metric_value": {"name": "metric_value", "description": "Primary measure (count, sum)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "metric_value_2": {"name": "metric_value_2", "description": "Secondary measure (patient_count, units_count) - nullable", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "rank_position": {"name": "rank_position", "description": "Rank for TOP20 metrics - nullable", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/adm/schema.yml", "build_path": null, "unrendered_config": {"schema": "ARCHIVE", "materialized": "incremental", "tags": ["pipeline_monitoring"], "incremental_strategy": "append"}, "created_at": 1770177079.5893319, "relation_name": "CGONCOLOGY_TEST.ARCHIVE.adm_pipeline_snapshot", "raw_code": "{{\n    config(\n        schema='ARCHIVE',\n        materialized='incremental',\n        incremental_strategy='append',\n        tags=['pipeline_monitoring']\n    )\n}}\n\n/*\nADM_PIPELINE_SNAPSHOT - Pipeline Metrics Snapshot (Append-Only)\n\nPurpose: Captures aggregate metrics from key MDM/ADM tables before each pipeline refresh.\n         Enables diff reporting, trend analysis, and anomaly detection.\n\nIMPORTANT: Uses direct table references (NOT ref()) so this model has no dbt dependencies\n           and runs FIRST in the DAG, capturing the PRE-refresh state of each table.\n\nGrain: One row per (run_timestamp, data_date, metric_group, metric_name, dimension_value, entity_id, rank_position)\nAppends ~300 rows per pipeline run.\n*/\n\n{% set db = target.database %}\n{% set run_ts = 'CURRENT_TIMESTAMP()' %}\n{% set data_dt = \"'\" ~ var('data_date') ~ \"'\" %}\n\n-- ============================================================\n-- ROW_COUNT: Row counts for 10 core tables\n-- ============================================================\n\nWITH row_counts AS (\n    SELECT {{ run_ts }} AS run_timestamp, {{ data_dt }}::DATE AS data_date,\n           'ROW_COUNT' AS metric_group, 'MDM_CUSTOMER_MASTER_HCO' AS metric_name,\n           NULL AS dimension_value, NULL AS entity_id,\n           COUNT(*)::FLOAT AS metric_value, NULL::FLOAT AS metric_value_2, NULL::INT AS rank_position\n    FROM {{ db }}.MDM.MDM_CUSTOMER_MASTER_HCO\n\n    UNION ALL\n    SELECT {{ run_ts }}, {{ data_dt }}::DATE, 'ROW_COUNT', 'MDM_CUSTOMER_MASTER_HCP',\n           NULL, NULL, COUNT(*)::FLOAT, NULL, NULL\n    FROM {{ db }}.MDM.MDM_CUSTOMER_MASTER_HCP\n\n    UNION ALL\n    SELECT {{ run_ts }}, {{ data_dt }}::DATE, 'ROW_COUNT', 'MDM_BEST_AFFILIATION',\n           NULL, NULL, COUNT(*)::FLOAT, NULL, NULL\n    FROM {{ db }}.MDM.MDM_BEST_AFFILIATION\n\n    UNION ALL\n    SELECT {{ run_ts }}, {{ data_dt }}::DATE, 'ROW_COUNT', 'MDM_CUSTOMER_XREF_HCO',\n           NULL, NULL, COUNT(*)::FLOAT, NULL, NULL\n    FROM {{ db }}.MDM.MDM_CUSTOMER_XREF_HCO\n\n    UNION ALL\n    SELECT {{ run_ts }}, {{ data_dt }}::DATE, 'ROW_COUNT', 'MDM_CUSTOMER_XREF_HCP',\n           NULL, NULL, COUNT(*)::FLOAT, NULL, NULL\n    FROM {{ db }}.MDM.MDM_CUSTOMER_XREF_HCP\n\n    UNION ALL\n    SELECT {{ run_ts }}, {{ data_dt }}::DATE, 'ROW_COUNT', 'ADM_HCO_MASTER',\n           NULL, NULL, COUNT(*)::FLOAT, NULL, NULL\n    FROM {{ db }}.ADM.ADM_HCO_MASTER\n\n    UNION ALL\n    SELECT {{ run_ts }}, {{ data_dt }}::DATE, 'ROW_COUNT', 'ADM_HCP_MASTER',\n           NULL, NULL, COUNT(*)::FLOAT, NULL, NULL\n    FROM {{ db }}.ADM.ADM_HCP_MASTER\n\n    UNION ALL\n    SELECT {{ run_ts }}, {{ data_dt }}::DATE, 'ROW_COUNT', 'ADM_HCO_HIERARCHY',\n           NULL, NULL, COUNT(*)::FLOAT, NULL, NULL\n    FROM {{ db }}.ADM.ADM_HCO_HIERARCHY\n\n    UNION ALL\n    SELECT {{ run_ts }}, {{ data_dt }}::DATE, 'ROW_COUNT', 'ADM_CLAIMS_METRICS_LONG',\n           NULL, NULL, COUNT(*)::FLOAT, NULL, NULL\n    FROM {{ db }}.ADM.ADM_CLAIMS_METRICS_LONG\n\n    UNION ALL\n    SELECT {{ run_ts }}, {{ data_dt }}::DATE, 'ROW_COUNT', 'ADM_DDD_METRICS_LONG',\n           NULL, NULL, COUNT(*)::FLOAT, NULL, NULL\n    FROM {{ db }}.ADM.ADM_DDD_METRICS_LONG\n),\n\n-- ============================================================\n-- DIST_HCO_HIERARCHY: HCO hierarchy_level distribution\n-- ============================================================\n\ndist_hco_hierarchy AS (\n    SELECT {{ run_ts }} AS run_timestamp, {{ data_dt }}::DATE AS data_date,\n           'DIST_HCO_HIERARCHY' AS metric_group,\n           'HIERARCHY_LEVEL' AS metric_name,\n           hierarchy_level AS dimension_value,\n           NULL AS entity_id,\n           COUNT(*)::FLOAT AS metric_value,\n           NULL::FLOAT AS metric_value_2,\n           NULL::INT AS rank_position\n    FROM {{ db }}.ADM.ADM_HCO_MASTER\n    GROUP BY hierarchy_level\n),\n\n-- ============================================================\n-- DIST_ACCOUNT_TYPE: Account type distribution\n-- ============================================================\n\ndist_account_type AS (\n    SELECT {{ run_ts }} AS run_timestamp, {{ data_dt }}::DATE AS data_date,\n           'DIST_ACCOUNT_TYPE' AS metric_group,\n           'ACCOUNT_TYPE' AS metric_name,\n           COALESCE(account_type, 'NULL') AS dimension_value,\n           NULL AS entity_id,\n           COUNT(*)::FLOAT AS metric_value,\n           NULL::FLOAT AS metric_value_2,\n           NULL::INT AS rank_position\n    FROM {{ db }}.ADM.ADM_HCO_MASTER\n    WHERE hierarchy_level = 'L3'\n    GROUP BY account_type\n),\n\n-- ============================================================\n-- ACCT_TYPE_DETAIL: Account type x backbone/target flags crosstab\n-- ============================================================\n\nacct_type_detail AS (\n    SELECT {{ run_ts }} AS run_timestamp, {{ data_dt }}::DATE AS data_date,\n           'ACCT_TYPE_DETAIL' AS metric_group,\n           COALESCE(account_type, 'NULL') AS metric_name,\n           'BACKBONE_Y' AS dimension_value,\n           NULL AS entity_id,\n           COUNT(CASE WHEN cust_backbone_flag = 'Y' THEN 1 END)::FLOAT AS metric_value,\n           NULL::FLOAT AS metric_value_2,\n           NULL::INT AS rank_position\n    FROM {{ db }}.ADM.ADM_HCO_MASTER\n    WHERE hierarchy_level = 'L3'\n    GROUP BY account_type\n\n    UNION ALL\n\n    SELECT {{ run_ts }}, {{ data_dt }}::DATE,\n           'ACCT_TYPE_DETAIL',\n           COALESCE(account_type, 'NULL'),\n           'KAM_TARGET_Y',\n           NULL,\n           COUNT(CASE WHEN kam_target_flag = 'Y' THEN 1 END)::FLOAT,\n           NULL::FLOAT,\n           NULL::INT\n    FROM {{ db }}.ADM.ADM_HCO_MASTER\n    WHERE hierarchy_level = 'L3'\n    GROUP BY account_type\n\n    UNION ALL\n\n    SELECT {{ run_ts }}, {{ data_dt }}::DATE,\n           'ACCT_TYPE_DETAIL',\n           COALESCE(account_type, 'NULL'),\n           'HSD_TARGET_Y',\n           NULL,\n           COUNT(CASE WHEN hsd_target_flag = 'Y' THEN 1 END)::FLOAT,\n           NULL::FLOAT,\n           NULL::INT\n    FROM {{ db }}.ADM.ADM_HCO_MASTER\n    WHERE hierarchy_level = 'L3'\n    GROUP BY account_type\n),\n\n-- ============================================================\n-- DIST_HCO_FIRM_TYPE: firm_type distribution\n-- ============================================================\n\ndist_hco_firm_type AS (\n    SELECT {{ run_ts }} AS run_timestamp, {{ data_dt }}::DATE AS data_date,\n           'DIST_HCO_FIRM_TYPE' AS metric_group,\n           'FIRM_TYPE' AS metric_name,\n           COALESCE(firm_type, 'NULL') AS dimension_value,\n           NULL AS entity_id,\n           COUNT(*)::FLOAT AS metric_value,\n           NULL::FLOAT AS metric_value_2,\n           NULL::INT AS rank_position\n    FROM {{ db }}.ADM.ADM_HCO_MASTER\n    GROUP BY firm_type\n),\n\n-- ============================================================\n-- DIST_HCO_SOURCE: HCO primary_source distribution\n-- ============================================================\n\ndist_hco_source AS (\n    SELECT {{ run_ts }} AS run_timestamp, {{ data_dt }}::DATE AS data_date,\n           'DIST_HCO_SOURCE' AS metric_group,\n           'PRIMARY_SOURCE' AS metric_name,\n           COALESCE(primary_source, 'NULL') AS dimension_value,\n           NULL AS entity_id,\n           COUNT(*)::FLOAT AS metric_value,\n           NULL::FLOAT AS metric_value_2,\n           NULL::INT AS rank_position\n    FROM {{ db }}.MDM.MDM_CUSTOMER_MASTER_HCO\n    GROUP BY primary_source\n),\n\n-- ============================================================\n-- DIST_HCP_SOURCE: HCP primary_source distribution\n-- ============================================================\n\ndist_hcp_source AS (\n    SELECT {{ run_ts }} AS run_timestamp, {{ data_dt }}::DATE AS data_date,\n           'DIST_HCP_SOURCE' AS metric_group,\n           'PRIMARY_SOURCE' AS metric_name,\n           COALESCE(primary_source, 'NULL') AS dimension_value,\n           NULL AS entity_id,\n           COUNT(*)::FLOAT AS metric_value,\n           NULL::FLOAT AS metric_value_2,\n           NULL::INT AS rank_position\n    FROM {{ db }}.MDM.MDM_CUSTOMER_MASTER_HCP\n    GROUP BY primary_source\n),\n\n-- ============================================================\n-- DIST_HCP_SPECIALTY: Top 20 HCP specialties\n-- ============================================================\n\ndist_hcp_specialty AS (\n    SELECT {{ run_ts }} AS run_timestamp, {{ data_dt }}::DATE AS data_date,\n           'DIST_HCP_SPECIALTY' AS metric_group,\n           'SPECIALTY' AS metric_name,\n           dimension_value,\n           NULL AS entity_id,\n           metric_value,\n           NULL::FLOAT AS metric_value_2,\n           rank_position\n    FROM (\n        SELECT COALESCE(primary_specialty, 'NULL') AS dimension_value,\n               COUNT(*)::FLOAT AS metric_value,\n               ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rank_position\n        FROM {{ db }}.ADM.ADM_HCP_MASTER\n        GROUP BY primary_specialty\n    )\n    WHERE rank_position <= 20\n),\n\n-- ============================================================\n-- DIST_HCP_BACKBONE: HCP backbone flag distribution\n-- ============================================================\n\ndist_hcp_backbone AS (\n    SELECT {{ run_ts }} AS run_timestamp, {{ data_dt }}::DATE AS data_date,\n           'DIST_HCP_BACKBONE' AS metric_group,\n           'CUST_BACKBONE_FLAG' AS metric_name,\n           'BACKBONE_' || COALESCE(cust_backbone_flag, 'NULL') AS dimension_value,\n           NULL AS entity_id,\n           COUNT(*)::FLOAT AS metric_value,\n           NULL::FLOAT AS metric_value_2,\n           NULL::INT AS rank_position\n    FROM {{ db }}.ADM.ADM_HCP_MASTER\n    GROUP BY cust_backbone_flag\n),\n\n-- ============================================================\n-- DIST_HCP_KAM_DECILE: KAM decile distribution (1-10)\n-- ============================================================\n\ndist_hcp_kam_decile AS (\n    SELECT {{ run_ts }} AS run_timestamp, {{ data_dt }}::DATE AS data_date,\n           'DIST_HCP_KAM_DECILE' AS metric_group,\n           'KAM_DECILE' AS metric_name,\n           COALESCE(kam_decile::VARCHAR, 'NULL') AS dimension_value,\n           NULL AS entity_id,\n           COUNT(*)::FLOAT AS metric_value,\n           NULL::FLOAT AS metric_value_2,\n           NULL::INT AS rank_position\n    FROM {{ db }}.ADM.ADM_HCP_MASTER\n    GROUP BY kam_decile\n),\n\n-- ============================================================\n-- DIST_AFFILIATION: Mapping rule distribution + unmapped %\n-- ============================================================\n\ndist_affiliation AS (\n    SELECT {{ run_ts }} AS run_timestamp, {{ data_dt }}::DATE AS data_date,\n           'DIST_AFFILIATION' AS metric_group,\n           'MAPPING_RULE' AS metric_name,\n           COALESCE(mapping_rule, 'NULL') AS dimension_value,\n           NULL AS entity_id,\n           COUNT(*)::FLOAT AS metric_value,\n           NULL::FLOAT AS metric_value_2,\n           NULL::INT AS rank_position\n    FROM {{ db }}.MDM.MDM_BEST_AFFILIATION\n    GROUP BY mapping_rule\n),\n\n-- ============================================================\n-- DIST_XREF_HCO: HCO XREF source_code distribution\n-- ============================================================\n\ndist_xref_hco AS (\n    SELECT {{ run_ts }} AS run_timestamp, {{ data_dt }}::DATE AS data_date,\n           'DIST_XREF_HCO' AS metric_group,\n           'SOURCE_CODE' AS metric_name,\n           source_code AS dimension_value,\n           NULL AS entity_id,\n           COUNT(*)::FLOAT AS metric_value,\n           NULL::FLOAT AS metric_value_2,\n           NULL::INT AS rank_position\n    FROM {{ db }}.MDM.MDM_CUSTOMER_XREF_HCO\n    GROUP BY source_code\n),\n\n-- ============================================================\n-- DIST_XREF_HCP: HCP XREF source_code distribution\n-- ============================================================\n\ndist_xref_hcp AS (\n    SELECT {{ run_ts }} AS run_timestamp, {{ data_dt }}::DATE AS data_date,\n           'DIST_XREF_HCP' AS metric_group,\n           'SOURCE_CODE' AS metric_name,\n           source_code AS dimension_value,\n           NULL AS entity_id,\n           COUNT(*)::FLOAT AS metric_value,\n           NULL::FLOAT AS metric_value_2,\n           NULL::INT AS rank_position\n    FROM {{ db }}.MDM.MDM_CUSTOMER_XREF_HCP\n    GROUP BY source_code\n),\n\n-- ============================================================\n-- CLAIMS_L12M: Claims by metric_category (L12M totals)\n-- ============================================================\n\nclaims_l12m AS (\n    -- Sums across all entity_ids as-is from the long table (already rolled up per level)\n    SELECT {{ run_ts }} AS run_timestamp, {{ data_dt }}::DATE AS data_date,\n           'CLAIMS_L12M' AS metric_group,\n           metric_category AS metric_name,\n           entity_type AS dimension_value,\n           NULL AS entity_id,\n           SUM(claim_count)::FLOAT AS metric_value,\n           SUM(patient_count)::FLOAT AS metric_value_2,\n           NULL::INT AS rank_position\n    FROM {{ db }}.ADM.ADM_CLAIMS_METRICS_LONG\n    WHERE period_key = 'L12M'\n    GROUP BY metric_category, entity_type\n),\n\n-- ============================================================\n-- DDD_SALES_L12M: DDD sales by metric_category (L12M totals)\n-- ============================================================\n\nddd_sales_l12m AS (\n    -- Sums across all entity_ids as-is from the long table (already rolled up per level)\n    SELECT {{ run_ts }} AS run_timestamp, {{ data_dt }}::DATE AS data_date,\n           'DDD_SALES_L12M' AS metric_group,\n           metric_category AS metric_name,\n           NULL AS dimension_value,\n           NULL AS entity_id,\n           SUM(sales_amount)::FLOAT AS metric_value,\n           SUM(units_count)::FLOAT AS metric_value_2,\n           NULL::INT AS rank_position\n    FROM {{ db }}.ADM.ADM_DDD_METRICS_LONG\n    WHERE period_key = 'L12M'\n    GROUP BY metric_category\n),\n\n-- ============================================================\n-- TOP20_HCO: Top 20 HCOs per metric (5 metrics x 20 = 100 rows)\n-- ============================================================\n\n-- Top 20 by TICE_BCG claims\ntop20_tice_bcg_claims AS (\n    SELECT {{ run_ts }} AS run_timestamp, {{ data_dt }}::DATE AS data_date,\n           'TOP20_HCO' AS metric_group,\n           'TICE_BCG_CLAIMS' AS metric_name,\n           NULL AS dimension_value,\n           entity_id,\n           SUM(claim_count)::FLOAT AS metric_value,\n           NULL::FLOAT AS metric_value_2,\n           ROW_NUMBER() OVER (ORDER BY SUM(claim_count) DESC) AS rank_position\n    FROM {{ db }}.ADM.ADM_CLAIMS_METRICS_LONG\n    WHERE entity_type = 'HCO'\n      AND period_key = 'L12M'\n      AND metric_category = 'TICE_BCG'\n    GROUP BY entity_id\n    QUALIFY ROW_NUMBER() OVER (ORDER BY SUM(claim_count) DESC) <= 20\n),\n\n-- Top 20 by TURBT claims\ntop20_turbt_claims AS (\n    SELECT {{ run_ts }} AS run_timestamp, {{ data_dt }}::DATE AS data_date,\n           'TOP20_HCO' AS metric_group,\n           'TURBT_CLAIMS' AS metric_name,\n           NULL AS dimension_value,\n           entity_id,\n           SUM(claim_count)::FLOAT AS metric_value,\n           NULL::FLOAT AS metric_value_2,\n           ROW_NUMBER() OVER (ORDER BY SUM(claim_count) DESC) AS rank_position\n    FROM {{ db }}.ADM.ADM_CLAIMS_METRICS_LONG\n    WHERE entity_type = 'HCO'\n      AND period_key = 'L12M'\n      AND metric_category = 'TURBT'\n    GROUP BY entity_id\n    QUALIFY ROW_NUMBER() OVER (ORDER BY SUM(claim_count) DESC) <= 20\n),\n\n-- Top 20 by BC patient count\ntop20_bc_patients AS (\n    SELECT {{ run_ts }} AS run_timestamp, {{ data_dt }}::DATE AS data_date,\n           'TOP20_HCO' AS metric_group,\n           'BC_PATIENTS' AS metric_name,\n           NULL AS dimension_value,\n           entity_id,\n           SUM(patient_count)::FLOAT AS metric_value,\n           NULL::FLOAT AS metric_value_2,\n           ROW_NUMBER() OVER (ORDER BY SUM(patient_count) DESC) AS rank_position\n    FROM {{ db }}.ADM.ADM_CLAIMS_METRICS_LONG\n    WHERE entity_type = 'HCO'\n      AND period_key = 'L12M'\n      AND metric_category = 'BC_DIAGNOSIS'\n    GROUP BY entity_id\n    QUALIFY ROW_NUMBER() OVER (ORDER BY SUM(patient_count) DESC) <= 20\n),\n\n-- Top 20 by branded sales\ntop20_branded_sales AS (\n    SELECT {{ run_ts }} AS run_timestamp, {{ data_dt }}::DATE AS data_date,\n           'TOP20_HCO' AS metric_group,\n           'BRANDED_SALES' AS metric_name,\n           NULL AS dimension_value,\n           entity_id,\n           SUM(sales_amount)::FLOAT AS metric_value,\n           NULL::FLOAT AS metric_value_2,\n           ROW_NUMBER() OVER (ORDER BY SUM(sales_amount) DESC) AS rank_position\n    FROM {{ db }}.ADM.ADM_DDD_METRICS_LONG\n    WHERE period_key = 'L12M'\n      AND metric_category = 'TOTAL_BRANDED'\n    GROUP BY entity_id\n    QUALIFY ROW_NUMBER() OVER (ORDER BY SUM(sales_amount) DESC) <= 20\n),\n\n-- Top 20 by TICE BCG sales\ntop20_tice_bcg_sales AS (\n    SELECT {{ run_ts }} AS run_timestamp, {{ data_dt }}::DATE AS data_date,\n           'TOP20_HCO' AS metric_group,\n           'TICE_BCG_SALES' AS metric_name,\n           NULL AS dimension_value,\n           entity_id,\n           SUM(sales_amount)::FLOAT AS metric_value,\n           NULL::FLOAT AS metric_value_2,\n           ROW_NUMBER() OVER (ORDER BY SUM(sales_amount) DESC) AS rank_position\n    FROM {{ db }}.ADM.ADM_DDD_METRICS_LONG\n    WHERE period_key = 'L12M'\n      AND metric_category = 'TICE_BCG'\n    GROUP BY entity_id\n    QUALIFY ROW_NUMBER() OVER (ORDER BY SUM(sales_amount) DESC) <= 20\n)\n\n-- ============================================================\n-- UNION ALL: Combine all metric groups\n-- ============================================================\n\nSELECT * FROM row_counts\nUNION ALL SELECT * FROM dist_hco_hierarchy\nUNION ALL SELECT * FROM dist_account_type\nUNION ALL SELECT * FROM acct_type_detail\nUNION ALL SELECT * FROM dist_hco_firm_type\nUNION ALL SELECT * FROM dist_hco_source\nUNION ALL SELECT * FROM dist_hcp_source\nUNION ALL SELECT * FROM dist_hcp_specialty\nUNION ALL SELECT * FROM dist_hcp_backbone\nUNION ALL SELECT * FROM dist_hcp_kam_decile\nUNION ALL SELECT * FROM dist_affiliation\nUNION ALL SELECT * FROM dist_xref_hco\nUNION ALL SELECT * FROM dist_xref_hcp\nUNION ALL SELECT * FROM claims_l12m\nUNION ALL SELECT * FROM ddd_sales_l12m\nUNION ALL SELECT * FROM top20_tice_bcg_claims\nUNION ALL SELECT * FROM top20_turbt_claims\nUNION ALL SELECT * FROM top20_bc_patients\nUNION ALL SELECT * FROM top20_branded_sales\nUNION ALL SELECT * FROM top20_tice_bcg_sales", "doc_blocks": [], "language": "sql", "refs": [], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}, "model.CGOncology_MDM.ref_address_best_hco": {"database": "CGONCOLOGY_TEST", "schema": "ADM", "name": "ref_address_best_hco", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "adm/ref_address_best_hco.sql", "original_file_path": "models/adm/ref_address_best_hco.sql", "unique_id": "model.CGOncology_MDM.ref_address_best_hco", "fqn": ["CGOncology_MDM", "adm", "ref_address_best_hco"], "alias": "ref_address_best_hco", "checksum": {"name": "sha256", "checksum": "2726ea19e4fad5c894224f25223716ef1f3dfa23d344978003ca7867d36c4c9d"}, "config": {"enabled": true, "alias": null, "schema": "ADM", "database": null, "tags": ["layer_4_adm", "customer_backbone", "customer_backbone", "adm", "address_best"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_4_adm", "customer_backbone", "adm", "address_best"], "description": "Address-Based HCO Grouping Bridge Table.\nGroups HCOs sharing the same physical address AND same ultimate parent,\nidentifies the \"best\" HCO within each group for metrics aggregation.\nBusiness Rules: ABH-001 to ABH-005\nGrain: One row per kmk_hco_id\n", "columns": {"kmk_hco_id": {"name": "kmk_hco_id", "description": "Source HCO identifier (primary key)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "address_key": {"name": "address_key", "description": "Composite address key (UPPER(addr1)|ZIP5|CITY|STATE)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "ultimate_parent_id": {"name": "ultimate_parent_id", "description": "Ultimate parent HCO ID from hierarchy", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "address_group_id": {"name": "address_group_id", "description": "Combined address_key|ultimate_parent_id for grouping", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "address_best_hco_id": {"name": "address_best_hco_id", "description": "Best HCO for this address group", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "is_address_best": {"name": "is_address_best", "description": "Y if this HCO is the best for its group", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "address_group_count": {"name": "address_group_count", "description": "Count of HCOs in same address group", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/adm/schema.yml", "build_path": null, "unrendered_config": {"schema": "ADM", "materialized": "table", "tags": ["customer_backbone", "adm", "address_best"]}, "created_at": 1770177079.587404, "relation_name": "CGONCOLOGY_TEST.ADM.ref_address_best_hco", "raw_code": "{{\n    config(\n        schema='ADM',\n        materialized='table',\n        tags=['customer_backbone', 'adm', 'address_best']\n    )\n}}\n\n/*\nREF_ADDRESS_BEST_HCO - Address-Based HCO Grouping Bridge Table\nBusiness Rules: ABH-001 to ABH-005\n\nPurpose: Creates address groups for HCOs sharing the same physical address AND same\nultimate parent, then identifies the \"best\" HCO within each group for metrics aggregation.\n\nUse Case: Consolidate metrics for healthcare organizations operating at the same location\nunder the same ownership.\n\nGrain: One row per KMK_HCO_ID (bridge table)\n\nBusiness Rules:\n- ABH-001: Address Key = UPPER(addr1) || '|' || ZIP5 || '|' || CITY || '|' || STATE\n- ABH-002: Address groups require same ultimate_parent_id AND same address_key\n- ABH-003: Best HCO selection: hierarchy_level ASC, firm_type priority, has_ddd_match DESC, org_name\n- ABH-004: NULL address HCOs \u2192 self-reference (address_best_hco_id = kmk_hco_id)\n- ABH-005: Single HCO at address \u2192 self-reference\n\nAddress Key Construction (ABH-001):\n- Standardizes to uppercase and trims whitespace\n- Uses 5-digit ZIP for consistency\n- Null-safe: NULLs result in empty address_key components\n\nBest HCO Selection Priority (ABH-003):\n1. hierarchy_level ASC: L1 > L2 > L3 > L4 (top-of-hierarchy preferred)\n2. firm_type priority: Hospital (1) > Physician Group (2) > Other (3)\n3. has_ddd_match DESC: Y before N (DDD-matched preferred)\n4. org_name ASC: Alphabetical (deterministic tie-breaker)\n*/\n\n-- Get HCO master data with address fields\nWITH hco_base AS (\n    SELECT\n        m.kmk_hco_id,\n        m.dh_id,\n        m.org_name,\n        m.firm_type,\n        m.hq_address_line_1,\n        m.hq_city,\n        m.hq_state,\n        m.hq_zip_code,\n        -- Convert DDD_OUTLET_COUNT to Y/N flag for priority sorting\n        CASE WHEN COALESCE(m.ddd_outlet_count, 0) > 0 THEN 'Y' ELSE 'N' END AS has_ddd_match,\n        -- Get hierarchy info\n        h.hierarchy_level,\n        h.ultimate_parent_id\n    FROM {{ ref('mdm_customer_master_hco') }} m\n    LEFT JOIN {{ ref('adm_hco_hierarchy') }} h ON m.kmk_hco_id = h.kmk_hco_id\n),\n\n-- Calculate address key (ABH-001)\n-- Handle NULLs: If any component is NULL, treat as incomplete address\naddress_key_calc AS (\n    SELECT\n        *,\n        -- ABH-001: Address Key = UPPER(addr1) || '|' || ZIP5 || '|' || CITY || '|' || STATE\n        CASE\n            WHEN hq_address_line_1 IS NULL\n                 OR hq_city IS NULL\n                 OR hq_state IS NULL\n                 OR hq_zip_code IS NULL\n            THEN NULL  -- Incomplete address -> NULL key -> self-reference\n            ELSE UPPER(TRIM(hq_address_line_1)) || '|'\n                 || LEFT(COALESCE(hq_zip_code, ''), 5) || '|'\n                 || UPPER(TRIM(hq_city)) || '|'\n                 || UPPER(TRIM(hq_state))\n        END AS address_key\n    FROM hco_base\n),\n\n-- Create address group ID by combining address_key and ultimate_parent_id (ABH-002)\naddress_groups AS (\n    SELECT\n        *,\n        -- ABH-002: Group by address_key + ultimate_parent_id\n        -- If address_key is NULL, use kmk_hco_id to make each a unique group (self-reference)\n        CASE\n            WHEN address_key IS NULL THEN 'NULL_ADDR_' || kmk_hco_id\n            WHEN ultimate_parent_id IS NULL THEN address_key || '|NULL_PARENT'\n            ELSE address_key || '|' || ultimate_parent_id\n        END AS address_group_id\n    FROM address_key_calc\n),\n\n-- Rank HCOs within each address group to find the \"best\" one (ABH-003)\nbest_hco_ranked AS (\n    SELECT\n        *,\n        ROW_NUMBER() OVER (\n            PARTITION BY address_group_id\n            ORDER BY\n                -- 1. Hierarchy level ASC: L1 > L2 > L3 > L4 (prefer top of hierarchy)\n                CASE hierarchy_level\n                    WHEN 'L1' THEN 1\n                    WHEN 'L2' THEN 2\n                    WHEN 'L3' THEN 3\n                    WHEN 'L4' THEN 4\n                    ELSE 5\n                END ASC,\n                -- 2. Firm type priority: Hospital (1) > Physician Group (2) > Other (3)\n                CASE\n                    WHEN firm_type = 'Hospital' THEN 1\n                    WHEN firm_type = 'Physician Group' THEN 2\n                    ELSE 3\n                END ASC,\n                -- 3. has_ddd_match DESC: Y before N\n                has_ddd_match DESC,\n                -- 4. org_name ASC: Alphabetical tie-breaker (deterministic)\n                COALESCE(org_name, 'ZZZZZ') ASC\n        ) AS rank_in_group\n    FROM address_groups\n),\n\n-- Get the best HCO per group (rank = 1)\naddress_best_lookup AS (\n    SELECT\n        address_group_id,\n        kmk_hco_id AS address_best_hco_id\n    FROM best_hco_ranked\n    WHERE rank_in_group = 1\n),\n\n-- Count HCOs per address group\ngroup_counts AS (\n    SELECT\n        address_group_id,\n        COUNT(*) AS address_group_count\n    FROM address_groups\n    GROUP BY address_group_id\n),\n\n-- Final output: Join all HCOs with their address_best_hco_id\nfinal_output AS (\n    SELECT\n        ag.kmk_hco_id,\n        ag.address_key,\n        ag.ultimate_parent_id,\n        ag.address_group_id,\n        abl.address_best_hco_id,\n        CASE WHEN ag.kmk_hco_id = abl.address_best_hco_id THEN 'Y' ELSE 'N' END AS is_address_best,\n        gc.address_group_count,\n        -- Include key attributes for validation/debugging\n        ag.dh_id,\n        ag.org_name,\n        ag.firm_type,\n        ag.hierarchy_level,\n        ag.has_ddd_match,\n        ag.hq_address_line_1,\n        ag.hq_city,\n        ag.hq_state,\n        ag.hq_zip_code\n    FROM address_groups ag\n    LEFT JOIN address_best_lookup abl ON ag.address_group_id = abl.address_group_id\n    LEFT JOIN group_counts gc ON ag.address_group_id = gc.address_group_id\n)\n\nSELECT * FROM final_output", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hco", "package": null, "version": null}, {"name": "adm_hco_hierarchy", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.adm_hco_hierarchy"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["kmk_hco_id"], "time_spine": null}, "model.CGOncology_MDM.adm_address_best_hco_metrics_long": {"database": "CGONCOLOGY_TEST", "schema": "ADM", "name": "adm_address_best_hco_metrics_long", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "adm/adm_address_best_hco_metrics_long.sql", "original_file_path": "models/adm/adm_address_best_hco_metrics_long.sql", "unique_id": "model.CGOncology_MDM.adm_address_best_hco_metrics_long", "fqn": ["CGOncology_MDM", "adm", "adm_address_best_hco_metrics_long"], "alias": "adm_address_best_hco_metrics_long", "checksum": {"name": "sha256", "checksum": "b08b234eeb461f15b9dfcc4e9d289809df0795b56212543edd9657b7a760f47e"}, "config": {"enabled": true, "alias": null, "schema": "ADM", "database": null, "tags": ["layer_4_adm", "customer_backbone", "customer_backbone", "adm", "metrics", "address_best"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_4_adm", "customer_backbone", "adm", "metrics", "address_best"], "description": "Claims metrics aggregated to address-best HCO level (long format).\nClaims are remapped from original HCO to best HCO sharing same address and parent.\nBusiness Rules: ABH-001 to ABH-005, MET-001 to MET-003\nGrain: (entity_id, metric_category, period_key) where entity_id = address_best_hco_id\n", "columns": {"entity_type": {"name": "entity_type", "description": "Always 'ADDRESS_BEST_HCO'", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "entity_id": {"name": "entity_id", "description": "Address-best HCO identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "metric_category": {"name": "metric_category", "description": "Treatment category", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "period_key": {"name": "period_key", "description": "Time period key", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "claim_count": {"name": "claim_count", "description": "Distinct claim count", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "patient_count": {"name": "patient_count", "description": "Distinct patient count", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "contributing_hco_count": {"name": "contributing_hco_count", "description": "Count of source HCOs contributing to this address_best", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/adm/schema.yml", "build_path": null, "unrendered_config": {"schema": "ADM", "materialized": "table", "tags": ["customer_backbone", "adm", "metrics", "address_best"]}, "created_at": 1770177079.5876322, "relation_name": "CGONCOLOGY_TEST.ADM.adm_address_best_hco_metrics_long", "raw_code": "{{\n    config(\n        schema='ADM',\n        materialized='table',\n        tags=['customer_backbone', 'adm', 'metrics', 'address_best']\n    )\n}}\n\n/*\nADM_ADDRESS_BEST_HCO_METRICS_LONG - Claims Metrics Aggregated to Address-Best HCO\nBusiness Rules: ABH-001 to ABH-005, MET-001 to MET-003\n\nPurpose: Aggregates claims metrics to the address-best HCO level. Claims are remapped\nfrom their original HCO to the \"best\" HCO sharing the same address and ultimate parent.\n\nUse Case: Consolidate claims metrics for healthcare organizations operating at the same\nphysical location under the same ownership.\n\nGrain: One row per (entity_id, metric_category, period_key) where entity_id = address_best_hco_id\n\nLogic:\n1. Join grain table with address_best bridge on KMK_HCO_ID (the actual HCO that filed the claim)\n2. Remap the claim's HCO to its address_best_hco_id\n3. Aggregate by (address_best_hco_id, metric_category, period_key)\n\nMetrics:\n- claim_count: COUNT DISTINCT of claim_id\n- patient_count: COUNT DISTINCT of patients\n- contributing_hco_count: COUNT DISTINCT of source kmk_hco_ids contributing to this address_best\n*/\n\n-- Get all time periods from ref_time_periods\nWITH all_time_periods AS (\n    SELECT\n        period_type,\n        period_key,\n        period_start_date,\n        period_end_date,\n        period_display_name,\n        data_date\n    FROM {{ ref('ref_time_periods') }}\n),\n\n-- Get data_date for output column\ndata_date_ref AS (\n    SELECT DISTINCT data_date\n    FROM all_time_periods\n    LIMIT 1\n),\n\n-- Address best bridge table\naddress_best_bridge AS (\n    SELECT\n        kmk_hco_id,\n        address_best_hco_id,\n        address_group_id,\n        is_address_best\n    FROM {{ ref('ref_address_best_hco') }}\n),\n\n-- ============================================================\n-- REMAP CLAIMS TO ADDRESS_BEST BY KMK_HCO_ID\n-- Join on the actual HCO that filed the claim, not hierarchy levels\n-- ============================================================\n\n-- Claims remapped to address_best via KMK_HCO_ID\nall_remapped_claims AS (\n    SELECT\n        ab.address_best_hco_id AS entity_id,\n        g.kmk_hco_id AS source_hco_id,\n        g.metric_category,\n        g.claim_id,\n        g.patient_id,\n        g.service_date\n    FROM {{ ref('adm_dh_metrics_grain') }} g\n    INNER JOIN address_best_bridge ab ON g.kmk_hco_id = ab.kmk_hco_id\n    WHERE g.kmk_hco_id IS NOT NULL\n),\n\n-- ============================================================\n-- AGGREGATE BY ADDRESS_BEST + CATEGORY + TIME PERIOD\n-- ============================================================\n\n-- Metrics by category\nmetrics_by_category AS (\n    SELECT\n        'ADDRESS_BEST_HCO' AS entity_type,\n        c.entity_id,\n        c.metric_category,\n        tp.period_key,\n        tp.period_display_name,\n        tp.period_start_date,\n        tp.period_end_date,\n        COUNT(DISTINCT c.claim_id) AS claim_count,\n        COUNT(DISTINCT c.patient_id) AS patient_count,\n        COUNT(DISTINCT c.source_hco_id) AS contributing_hco_count\n    FROM all_remapped_claims c\n    INNER JOIN all_time_periods tp\n        ON c.service_date >= tp.period_start_date\n        AND c.service_date <= tp.period_end_date\n    GROUP BY 1, 2, 3, 4, 5, 6, 7\n),\n\n-- Total claims (all categories combined)\nmetrics_total AS (\n    SELECT\n        'ADDRESS_BEST_HCO' AS entity_type,\n        c.entity_id,\n        'Total Claims' AS metric_category,\n        tp.period_key,\n        tp.period_display_name,\n        tp.period_start_date,\n        tp.period_end_date,\n        COUNT(DISTINCT c.claim_id) AS claim_count,\n        COUNT(DISTINCT c.patient_id) AS patient_count,\n        COUNT(DISTINCT c.source_hco_id) AS contributing_hco_count\n    FROM all_remapped_claims c\n    INNER JOIN all_time_periods tp\n        ON c.service_date >= tp.period_start_date\n        AND c.service_date <= tp.period_end_date\n    GROUP BY 1, 2, 3, 4, 5, 6, 7\n),\n\n-- Combine all metrics\nall_metrics AS (\n    SELECT * FROM metrics_by_category\n    UNION ALL\n    SELECT * FROM metrics_total\n)\n\n-- Final output\nSELECT\n    entity_type,\n    entity_id,\n    metric_category,\n    period_key,\n    period_display_name,\n    period_start_date,\n    period_end_date,\n    claim_count,\n    patient_count,\n    contributing_hco_count,\n    -- Metric codes for pivoting\n    metric_category || '_CLAIMS' AS claims_metric_code,\n    metric_category || '_PATIENTS' AS patients_metric_code,\n    (SELECT data_date FROM data_date_ref) AS data_date\nFROM all_metrics", "doc_blocks": [], "language": "sql", "refs": [{"name": "ref_time_periods", "package": null, "version": null}, {"name": "ref_address_best_hco", "package": null, "version": null}, {"name": "adm_dh_metrics_grain", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.ref_time_periods", "model.CGOncology_MDM.ref_address_best_hco", "model.CGOncology_MDM.adm_dh_metrics_grain"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}, "model.CGOncology_MDM.adm_ddd_metrics_long": {"database": "CGONCOLOGY_TEST", "schema": "ADM", "name": "adm_ddd_metrics_long", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "adm/adm_ddd_metrics_long.sql", "original_file_path": "models/adm/adm_ddd_metrics_long.sql", "unique_id": "model.CGOncology_MDM.adm_ddd_metrics_long", "fqn": ["CGOncology_MDM", "adm", "adm_ddd_metrics_long"], "alias": "adm_ddd_metrics_long", "checksum": {"name": "sha256", "checksum": "64060f1cedba77d0e9d813fa32424177d5c768843629f0eceec3f32b950d24a8"}, "config": {"enabled": true, "alias": null, "schema": "ADM", "database": null, "tags": ["layer_4_adm", "customer_backbone", "customer_backbone", "adm", "metrics", "ddd"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_4_adm", "customer_backbone", "adm", "metrics", "ddd"], "description": "DDD sales metrics in claims-aligned long format.\nGrain: (entity_type, entity_id, metric_category, period_key)\nBusiness Rules: DDD-001 to DDD-005, DDD-REC-001 to DDD-REC-005\nMatches adm_claims_metrics_long structure for consistent analytics.\nIncludes L4 practice location entities (4-prefix) from grain table L4 propagation.\n", "columns": {"entity_type": {"name": "entity_type", "description": "Entity type (always 'HCO' for DDD)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "entity_id": {"name": "entity_id", "description": "KMK HCO ID", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "metric_category": {"name": "metric_category", "description": "Product category (TICE_BCG, ADSTILADRIN, ANKTIVA, INLEXZO, TOTAL_BRANDED, TOTAL)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "period_key": {"name": "period_key", "description": "Time period key (M01-M24, L3M, L6M, L12M, L18M, L24M)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "period_type": {"name": "period_type", "description": "Period type (MONTHLY, QUARTERLY, ROLLING, YTD, QTD, PY, PYTD, P2Y, CALENDAR_YEAR, LTD, TOTAL)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "sales_amount": {"name": "sales_amount", "description": "Total sales dollars for the period", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "units_count": {"name": "units_count", "description": "Total pack units for the period", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "outlet_count": {"name": "outlet_count", "description": "Count of distinct DDD outlets", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "data_date": {"name": "data_date", "description": "Data snapshot date", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/adm/schema.yml", "build_path": null, "unrendered_config": {"schema": "ADM", "materialized": "table", "tags": ["customer_backbone", "adm", "metrics", "ddd"]}, "created_at": 1770177079.587014, "relation_name": "CGONCOLOGY_TEST.ADM.adm_ddd_metrics_long", "raw_code": "{{\n    config(\n        schema='ADM',\n        materialized='table',\n        tags=['customer_backbone', 'adm', 'metrics', 'ddd']\n    )\n}}\n\n/*\nADM_DDD_METRICS_LONG - DDD Sales Metrics in Long Format\nBusiness Rules: DDD-001 to DDD-005, MET-ROLLUP-004 to MET-ROLLUP-007\n\nGrain: One row per (entity_type, entity_id, metric_category, period_key)\n\nSIMPLIFIED ARCHITECTURE (Jan 2026 Refactor):\n- Source: adm_ddd_metrics_grain (pre-computed hierarchy columns)\n- Logic: Direct GROUP BY with hierarchy levels L1-L4 and proper exclusion filters\n- No MAX() deduplication needed - exclusion filters prevent duplicates\n- Matches adm_claims_metrics_long pattern for consistency\n\nHierarchy Level Rollups (each level aggregates ALL data for that level):\n- L1: All sales grouped by account_id_l1 (top-level parent totals)\n- L2: All sales grouped by account_id_l2 (sub-parent totals)\n- L3: All sales grouped by account_id_l3 (child account totals)\n- L4: All sales grouped by account_id_l4 (practice location totals)\n- No HCP level (DDD is HCO-only)\n\nNOTE: Same grain data appears at multiple levels (L1 shows total of all children).\nTo get grand total without double-counting, query grain table directly or filter to one level.\n\nMetrics:\n- sales_amount: SUM of dollar sales\n- units_count: SUM of pack units\n- outlet_count: COUNT DISTINCT outlets\n\nPeriod Types:\n- MONTHLY: M01-M24 (month_num 1-24)\n- ROLLING: L3M, L6M, L12M, L18M, L24M\n- QUARTERLY: Q01-Q08 (from ref_time_periods)\n- YTD: Year-to-date (e.g., YTD_2025)\n- PYTD: Prior year-to-date (e.g., PYTD_2024)\n- PY: Prior year full (e.g., PY_2024)\n- P2Y: Prior 2 years (e.g., P2Y_2023)\n- QTD: Quarter-to-date (e.g., QTD_2025_Q4)\n- CALENDAR_YEAR: Calendar years (e.g., 2024, 2025)\n- TOTAL: All-time total\n*/\n\n-- Get data_date from grain table\nWITH data_date_ref AS (\n    SELECT MAX(data_date) AS data_date\n    FROM {{ ref('adm_ddd_metrics_grain') }}\n),\n\n-- Rolling period definitions (month_num based)\nrolling_periods AS (\n    SELECT 'L3M' AS period_key, 3 AS max_month_num, 'ROLLING' AS period_type UNION ALL\n    SELECT 'L6M', 6, 'ROLLING' UNION ALL\n    SELECT 'L12M', 12, 'ROLLING' UNION ALL\n    SELECT 'L18M', 18, 'ROLLING' UNION ALL\n    SELECT 'L24M', 24, 'ROLLING'\n),\n\n-- Get time periods for date-based joins (Quarterly, YTD, PYTD, PY, P2Y, QTD, Calendar Years, TOTAL)\ntime_periods AS (\n    SELECT\n        period_type,\n        period_key,\n        period_start_date,\n        period_end_date\n    FROM {{ ref('ref_time_periods') }}\n    WHERE period_type IN ('QUARTERLY', 'YTD', 'PYTD', 'PY', 'P2Y', 'QTD', 'CALENDAR_YEAR', 'TOTAL')\n),\n\n-- Source grain data with metric_category and sale_date for period joins\ngrain_with_category AS (\n    SELECT\n        g.outlet_no,\n        g.kmk_hco_id,\n        g.account_id_l1,\n        g.account_id_l2,\n        g.account_id_l3,\n        g.account_id_l4,\n        g.month_num,\n        g.data_date AS sale_date,  -- Actual calendar date of the sale\n        -- Map product to metric_category\n        CASE\n            WHEN g.product_group_id IN (3, 4) THEN 'TICE_BCG'\n            WHEN g.product_group_id = 1 THEN 'ADSTILADRIN'\n            WHEN g.product_group_id = 2 THEN 'ANKTIVA'\n            WHEN g.product_group_id = 7 THEN 'INLEXZO'\n            ELSE 'OTHER'\n        END AS metric_category,\n        -- Is branded product (for TOTAL_BRANDED aggregate)\n        CASE WHEN g.product_group_id IN (1, 2) THEN TRUE ELSE FALSE END AS is_branded,\n        g.sales_amount,\n        g.units_count\n    FROM {{ ref('adm_ddd_metrics_grain') }} g\n    WHERE g.kmk_hco_id IS NOT NULL\n      AND g.kmk_hco_id NOT IN ('UNASSIGNED', 'INDEPENDENT')\n),\n\n-- ============================================================\n-- L1 ROLLUP - MONTHLY (month_num based)\n-- ============================================================\nl1_monthly_by_category AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l1 AS entity_id,\n        g.metric_category,\n        'M' || LPAD(g.month_num::VARCHAR, 2, '0') AS period_key,\n        'MONTHLY' AS period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    WHERE g.account_id_l1 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5\n),\n\nl1_monthly_branded AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l1 AS entity_id,\n        'TOTAL_BRANDED' AS metric_category,\n        'M' || LPAD(g.month_num::VARCHAR, 2, '0') AS period_key,\n        'MONTHLY' AS period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    WHERE g.account_id_l1 IS NOT NULL AND g.is_branded = TRUE\n    GROUP BY 1, 2, 3, 4, 5\n),\n\nl1_monthly_total AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l1 AS entity_id,\n        'TOTAL' AS metric_category,\n        'M' || LPAD(g.month_num::VARCHAR, 2, '0') AS period_key,\n        'MONTHLY' AS period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    WHERE g.account_id_l1 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5\n),\n\n-- ============================================================\n-- L1 ROLLUP - ROLLING (month_num based)\n-- ============================================================\nl1_rolling_by_category AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l1 AS entity_id,\n        g.metric_category,\n        rp.period_key,\n        rp.period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    CROSS JOIN rolling_periods rp\n    WHERE g.account_id_l1 IS NOT NULL\n      AND g.month_num <= rp.max_month_num\n    GROUP BY 1, 2, 3, 4, 5\n),\n\nl1_rolling_branded AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l1 AS entity_id,\n        'TOTAL_BRANDED' AS metric_category,\n        rp.period_key,\n        rp.period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    CROSS JOIN rolling_periods rp\n    WHERE g.account_id_l1 IS NOT NULL\n      AND g.is_branded = TRUE\n      AND g.month_num <= rp.max_month_num\n    GROUP BY 1, 2, 3, 4, 5\n),\n\nl1_rolling_total AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l1 AS entity_id,\n        'TOTAL' AS metric_category,\n        rp.period_key,\n        rp.period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    CROSS JOIN rolling_periods rp\n    WHERE g.account_id_l1 IS NOT NULL\n      AND g.month_num <= rp.max_month_num\n    GROUP BY 1, 2, 3, 4, 5\n),\n\n-- ============================================================\n-- L1 ROLLUP - DATE-BASED PERIODS (Quarterly, YTD, etc.)\n-- ============================================================\nl1_date_based_by_category AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l1 AS entity_id,\n        g.metric_category,\n        tp.period_key,\n        tp.period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    INNER JOIN time_periods tp\n        ON g.sale_date >= tp.period_start_date\n        AND g.sale_date <= tp.period_end_date\n    WHERE g.account_id_l1 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5\n),\n\nl1_date_based_branded AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l1 AS entity_id,\n        'TOTAL_BRANDED' AS metric_category,\n        tp.period_key,\n        tp.period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    INNER JOIN time_periods tp\n        ON g.sale_date >= tp.period_start_date\n        AND g.sale_date <= tp.period_end_date\n    WHERE g.account_id_l1 IS NOT NULL\n      AND g.is_branded = TRUE\n    GROUP BY 1, 2, 3, 4, 5\n),\n\nl1_date_based_total AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l1 AS entity_id,\n        'TOTAL' AS metric_category,\n        tp.period_key,\n        tp.period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    INNER JOIN time_periods tp\n        ON g.sale_date >= tp.period_start_date\n        AND g.sale_date <= tp.period_end_date\n    WHERE g.account_id_l1 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5\n),\n\n-- ============================================================\n-- L2 ROLLUP - MONTHLY\n-- ============================================================\nl2_monthly_by_category AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l2 AS entity_id,\n        g.metric_category,\n        'M' || LPAD(g.month_num::VARCHAR, 2, '0') AS period_key,\n        'MONTHLY' AS period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    WHERE g.account_id_l2 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5\n),\n\nl2_monthly_branded AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l2 AS entity_id,\n        'TOTAL_BRANDED' AS metric_category,\n        'M' || LPAD(g.month_num::VARCHAR, 2, '0') AS period_key,\n        'MONTHLY' AS period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    WHERE g.account_id_l2 IS NOT NULL\n      AND g.is_branded = TRUE\n    GROUP BY 1, 2, 3, 4, 5\n),\n\nl2_monthly_total AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l2 AS entity_id,\n        'TOTAL' AS metric_category,\n        'M' || LPAD(g.month_num::VARCHAR, 2, '0') AS period_key,\n        'MONTHLY' AS period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    WHERE g.account_id_l2 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5\n),\n\n-- ============================================================\n-- L2 ROLLUP - ROLLING\n-- ============================================================\nl2_rolling_by_category AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l2 AS entity_id,\n        g.metric_category,\n        rp.period_key,\n        rp.period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    CROSS JOIN rolling_periods rp\n    WHERE g.account_id_l2 IS NOT NULL\n      AND g.month_num <= rp.max_month_num\n    GROUP BY 1, 2, 3, 4, 5\n),\n\nl2_rolling_branded AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l2 AS entity_id,\n        'TOTAL_BRANDED' AS metric_category,\n        rp.period_key,\n        rp.period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    CROSS JOIN rolling_periods rp\n    WHERE g.account_id_l2 IS NOT NULL\n      AND g.is_branded = TRUE\n      AND g.month_num <= rp.max_month_num\n    GROUP BY 1, 2, 3, 4, 5\n),\n\nl2_rolling_total AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l2 AS entity_id,\n        'TOTAL' AS metric_category,\n        rp.period_key,\n        rp.period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    CROSS JOIN rolling_periods rp\n    WHERE g.account_id_l2 IS NOT NULL\n      AND g.month_num <= rp.max_month_num\n    GROUP BY 1, 2, 3, 4, 5\n),\n\n-- ============================================================\n-- L2 ROLLUP - DATE-BASED PERIODS\n-- ============================================================\nl2_date_based_by_category AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l2 AS entity_id,\n        g.metric_category,\n        tp.period_key,\n        tp.period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    INNER JOIN time_periods tp\n        ON g.sale_date >= tp.period_start_date\n        AND g.sale_date <= tp.period_end_date\n    WHERE g.account_id_l2 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5\n),\n\nl2_date_based_branded AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l2 AS entity_id,\n        'TOTAL_BRANDED' AS metric_category,\n        tp.period_key,\n        tp.period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    INNER JOIN time_periods tp\n        ON g.sale_date >= tp.period_start_date\n        AND g.sale_date <= tp.period_end_date\n    WHERE g.account_id_l2 IS NOT NULL\n      AND g.is_branded = TRUE\n    GROUP BY 1, 2, 3, 4, 5\n),\n\nl2_date_based_total AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l2 AS entity_id,\n        'TOTAL' AS metric_category,\n        tp.period_key,\n        tp.period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    INNER JOIN time_periods tp\n        ON g.sale_date >= tp.period_start_date\n        AND g.sale_date <= tp.period_end_date\n    WHERE g.account_id_l2 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5\n),\n\n-- ============================================================\n-- L3 ROLLUP - MONTHLY\n-- ============================================================\nl3_monthly_by_category AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l3 AS entity_id,\n        g.metric_category,\n        'M' || LPAD(g.month_num::VARCHAR, 2, '0') AS period_key,\n        'MONTHLY' AS period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    WHERE g.account_id_l3 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5\n),\n\nl3_monthly_branded AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l3 AS entity_id,\n        'TOTAL_BRANDED' AS metric_category,\n        'M' || LPAD(g.month_num::VARCHAR, 2, '0') AS period_key,\n        'MONTHLY' AS period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    WHERE g.account_id_l3 IS NOT NULL\n      AND g.is_branded = TRUE\n    GROUP BY 1, 2, 3, 4, 5\n),\n\nl3_monthly_total AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l3 AS entity_id,\n        'TOTAL' AS metric_category,\n        'M' || LPAD(g.month_num::VARCHAR, 2, '0') AS period_key,\n        'MONTHLY' AS period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    WHERE g.account_id_l3 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5\n),\n\n-- ============================================================\n-- L3 ROLLUP - ROLLING\n-- ============================================================\nl3_rolling_by_category AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l3 AS entity_id,\n        g.metric_category,\n        rp.period_key,\n        rp.period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    CROSS JOIN rolling_periods rp\n    WHERE g.account_id_l3 IS NOT NULL\n      AND g.month_num <= rp.max_month_num\n    GROUP BY 1, 2, 3, 4, 5\n),\n\nl3_rolling_branded AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l3 AS entity_id,\n        'TOTAL_BRANDED' AS metric_category,\n        rp.period_key,\n        rp.period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    CROSS JOIN rolling_periods rp\n    WHERE g.account_id_l3 IS NOT NULL\n      AND g.is_branded = TRUE\n      AND g.month_num <= rp.max_month_num\n    GROUP BY 1, 2, 3, 4, 5\n),\n\nl3_rolling_total AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l3 AS entity_id,\n        'TOTAL' AS metric_category,\n        rp.period_key,\n        rp.period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    CROSS JOIN rolling_periods rp\n    WHERE g.account_id_l3 IS NOT NULL\n      AND g.month_num <= rp.max_month_num\n    GROUP BY 1, 2, 3, 4, 5\n),\n\n-- ============================================================\n-- L3 ROLLUP - DATE-BASED PERIODS\n-- ============================================================\nl3_date_based_by_category AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l3 AS entity_id,\n        g.metric_category,\n        tp.period_key,\n        tp.period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    INNER JOIN time_periods tp\n        ON g.sale_date >= tp.period_start_date\n        AND g.sale_date <= tp.period_end_date\n    WHERE g.account_id_l3 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5\n),\n\nl3_date_based_branded AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l3 AS entity_id,\n        'TOTAL_BRANDED' AS metric_category,\n        tp.period_key,\n        tp.period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    INNER JOIN time_periods tp\n        ON g.sale_date >= tp.period_start_date\n        AND g.sale_date <= tp.period_end_date\n    WHERE g.account_id_l3 IS NOT NULL\n      AND g.is_branded = TRUE\n    GROUP BY 1, 2, 3, 4, 5\n),\n\nl3_date_based_total AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l3 AS entity_id,\n        'TOTAL' AS metric_category,\n        tp.period_key,\n        tp.period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    INNER JOIN time_periods tp\n        ON g.sale_date >= tp.period_start_date\n        AND g.sale_date <= tp.period_end_date\n    WHERE g.account_id_l3 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5\n),\n\n-- ============================================================\n-- L4 ROLLUP - MONTHLY (Practice Locations)\n-- ============================================================\nl4_monthly_by_category AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l4 AS entity_id,\n        g.metric_category,\n        'M' || LPAD(g.month_num::VARCHAR, 2, '0') AS period_key,\n        'MONTHLY' AS period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    WHERE g.account_id_l4 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5\n),\n\nl4_monthly_branded AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l4 AS entity_id,\n        'TOTAL_BRANDED' AS metric_category,\n        'M' || LPAD(g.month_num::VARCHAR, 2, '0') AS period_key,\n        'MONTHLY' AS period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    WHERE g.account_id_l4 IS NOT NULL\n      AND g.is_branded = TRUE\n    GROUP BY 1, 2, 3, 4, 5\n),\n\nl4_monthly_total AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l4 AS entity_id,\n        'TOTAL' AS metric_category,\n        'M' || LPAD(g.month_num::VARCHAR, 2, '0') AS period_key,\n        'MONTHLY' AS period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    WHERE g.account_id_l4 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5\n),\n\n-- ============================================================\n-- L4 ROLLUP - ROLLING\n-- ============================================================\nl4_rolling_by_category AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l4 AS entity_id,\n        g.metric_category,\n        rp.period_key,\n        rp.period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    CROSS JOIN rolling_periods rp\n    WHERE g.account_id_l4 IS NOT NULL\n      AND g.month_num <= rp.max_month_num\n    GROUP BY 1, 2, 3, 4, 5\n),\n\nl4_rolling_branded AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l4 AS entity_id,\n        'TOTAL_BRANDED' AS metric_category,\n        rp.period_key,\n        rp.period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    CROSS JOIN rolling_periods rp\n    WHERE g.account_id_l4 IS NOT NULL\n      AND g.is_branded = TRUE\n      AND g.month_num <= rp.max_month_num\n    GROUP BY 1, 2, 3, 4, 5\n),\n\nl4_rolling_total AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l4 AS entity_id,\n        'TOTAL' AS metric_category,\n        rp.period_key,\n        rp.period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    CROSS JOIN rolling_periods rp\n    WHERE g.account_id_l4 IS NOT NULL\n      AND g.month_num <= rp.max_month_num\n    GROUP BY 1, 2, 3, 4, 5\n),\n\n-- ============================================================\n-- L4 ROLLUP - DATE-BASED PERIODS\n-- ============================================================\nl4_date_based_by_category AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l4 AS entity_id,\n        g.metric_category,\n        tp.period_key,\n        tp.period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    INNER JOIN time_periods tp\n        ON g.sale_date >= tp.period_start_date\n        AND g.sale_date <= tp.period_end_date\n    WHERE g.account_id_l4 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5\n),\n\nl4_date_based_branded AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l4 AS entity_id,\n        'TOTAL_BRANDED' AS metric_category,\n        tp.period_key,\n        tp.period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    INNER JOIN time_periods tp\n        ON g.sale_date >= tp.period_start_date\n        AND g.sale_date <= tp.period_end_date\n    WHERE g.account_id_l4 IS NOT NULL\n      AND g.is_branded = TRUE\n    GROUP BY 1, 2, 3, 4, 5\n),\n\nl4_date_based_total AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l4 AS entity_id,\n        'TOTAL' AS metric_category,\n        tp.period_key,\n        tp.period_type,\n        SUM(g.sales_amount) AS sales_amount,\n        SUM(g.units_count) AS units_count,\n        COUNT(DISTINCT g.outlet_no) AS outlet_count\n    FROM grain_with_category g\n    INNER JOIN time_periods tp\n        ON g.sale_date >= tp.period_start_date\n        AND g.sale_date <= tp.period_end_date\n    WHERE g.account_id_l4 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5\n),\n\n-- ============================================================\n-- COMBINE ALL METRICS\n-- No deduplication needed - exclusion filters prevent overlaps\n-- ============================================================\nall_metrics AS (\n    -- L1 MONTHLY\n    SELECT * FROM l1_monthly_by_category UNION ALL\n    SELECT * FROM l1_monthly_branded UNION ALL\n    SELECT * FROM l1_monthly_total UNION ALL\n    -- L1 ROLLING\n    SELECT * FROM l1_rolling_by_category UNION ALL\n    SELECT * FROM l1_rolling_branded UNION ALL\n    SELECT * FROM l1_rolling_total UNION ALL\n    -- L1 DATE-BASED\n    SELECT * FROM l1_date_based_by_category UNION ALL\n    SELECT * FROM l1_date_based_branded UNION ALL\n    SELECT * FROM l1_date_based_total UNION ALL\n    -- L2 MONTHLY\n    SELECT * FROM l2_monthly_by_category UNION ALL\n    SELECT * FROM l2_monthly_branded UNION ALL\n    SELECT * FROM l2_monthly_total UNION ALL\n    -- L2 ROLLING\n    SELECT * FROM l2_rolling_by_category UNION ALL\n    SELECT * FROM l2_rolling_branded UNION ALL\n    SELECT * FROM l2_rolling_total UNION ALL\n    -- L2 DATE-BASED\n    SELECT * FROM l2_date_based_by_category UNION ALL\n    SELECT * FROM l2_date_based_branded UNION ALL\n    SELECT * FROM l2_date_based_total UNION ALL\n    -- L3 MONTHLY\n    SELECT * FROM l3_monthly_by_category UNION ALL\n    SELECT * FROM l3_monthly_branded UNION ALL\n    SELECT * FROM l3_monthly_total UNION ALL\n    -- L3 ROLLING\n    SELECT * FROM l3_rolling_by_category UNION ALL\n    SELECT * FROM l3_rolling_branded UNION ALL\n    SELECT * FROM l3_rolling_total UNION ALL\n    -- L3 DATE-BASED\n    SELECT * FROM l3_date_based_by_category UNION ALL\n    SELECT * FROM l3_date_based_branded UNION ALL\n    SELECT * FROM l3_date_based_total UNION ALL\n    -- L4 MONTHLY\n    SELECT * FROM l4_monthly_by_category UNION ALL\n    SELECT * FROM l4_monthly_branded UNION ALL\n    SELECT * FROM l4_monthly_total UNION ALL\n    -- L4 ROLLING\n    SELECT * FROM l4_rolling_by_category UNION ALL\n    SELECT * FROM l4_rolling_branded UNION ALL\n    SELECT * FROM l4_rolling_total UNION ALL\n    -- L4 DATE-BASED\n    SELECT * FROM l4_date_based_by_category UNION ALL\n    SELECT * FROM l4_date_based_branded UNION ALL\n    SELECT * FROM l4_date_based_total\n)\n\n-- Final output - simple pass-through\nSELECT\n    entity_type,\n    entity_id,\n    metric_category,\n    period_key,\n    period_type,\n    sales_amount,\n    units_count,\n    outlet_count,\n    (SELECT data_date FROM data_date_ref) AS data_date\nFROM all_metrics\nWHERE (sales_amount <> 0 OR units_count <> 0)  -- Allow negative values (returns/credits)\n  AND entity_id IS NOT NULL", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_ddd_metrics_grain", "package": null, "version": null}, {"name": "ref_time_periods", "package": null, "version": null}, {"name": "adm_ddd_metrics_grain", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.adm_ddd_metrics_grain", "model.CGOncology_MDM.ref_time_periods"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}, "model.CGOncology_MDM.adm_hco_nmibc_metrics": {"database": "CGONCOLOGY_TEST", "schema": "ADM", "name": "adm_hco_nmibc_metrics", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "adm/adm_hco_nmibc_metrics.sql", "original_file_path": "models/adm/adm_hco_nmibc_metrics.sql", "unique_id": "model.CGOncology_MDM.adm_hco_nmibc_metrics", "fqn": ["CGOncology_MDM", "adm", "adm_hco_nmibc_metrics"], "alias": "adm_hco_nmibc_metrics", "checksum": {"name": "sha256", "checksum": "0a7fc96c64f5268c2357af93e05eeda992d37b4a19cf62ff71517191bac9fce0"}, "config": {"enabled": true, "alias": null, "schema": "ADM", "database": null, "tags": ["layer_4_adm", "customer_backbone", "customer_backbone", "adm", "nmibc", "metrics"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_4_adm", "customer_backbone", "adm", "nmibc", "metrics"], "description": "HCO-level NMIBC patient metrics.\nBusiness Rules: MET-043 to MET-045\n", "columns": {"kmk_hco_id": {"name": "kmk_hco_id", "description": "KMK HCO identifier (primary key)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "total_nmibc_patients": {"name": "total_nmibc_patients", "description": "Total NMIBC patients", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "high_risk_nmibc_patients": {"name": "high_risk_nmibc_patients", "description": "High risk NMIBC patients", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "mid_risk_nmibc_patients": {"name": "mid_risk_nmibc_patients", "description": "Mid risk NMIBC patients", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "low_risk_nmibc_patients": {"name": "low_risk_nmibc_patients", "description": "Low risk NMIBC patients", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/adm/schema.yml", "build_path": null, "unrendered_config": {"schema": "ADM", "materialized": "table", "tags": ["customer_backbone", "adm", "nmibc", "metrics"]}, "created_at": 1770177079.5863218, "relation_name": "CGONCOLOGY_TEST.ADM.adm_hco_nmibc_metrics", "raw_code": "{{\n    config(\n        schema='ADM',\n        materialized='table',\n        tags=['customer_backbone', 'adm', 'nmibc', 'metrics']\n    )\n}}\n\n/*\nADM_HCO_NMIBC_METRICS - NMIBC Patient Counts by HCO and Risk Tier\nBusiness Rules: NMI-001 to NMI-021, RSK-001 to RSK-022\n\nAggregates NMIBC patients from adm_nmibc_risk by HCO (via facility NPI from claims)\nProvides HIGH_RISK, MID_RISK, LOW_RISK patient counts per HCO for apt_accounts\n\nTime Period: L12M (Last 12 Months) - filters claims to most recent 12 months\nGrain: One row per KMK_HCO_ID\n*/\n\n-- Get L12M time period from ref_time_periods\nWITH time_period AS (\n    SELECT\n        period_key,\n        period_type,\n        period_start_date,\n        period_end_date,\n        data_date\n    FROM {{ ref('ref_time_periods') }}\n    WHERE period_key = 'L12M'\n),\n\n-- Step 1: Get NMIBC patients with their risk tier\nnmibc_patients AS (\n    SELECT\n        PATIENT_ID,\n        nmibc_risk_tier\n    FROM {{ ref('adm_nmibc_risk') }}\n),\n\n-- Step 2: Link NMIBC patients to HCOs via facility NPI from claims (filtered to L12M)\nnmibc_claims_with_facility AS (\n    SELECT DISTINCT\n        n.PATIENT_ID,\n        n.nmibc_risk_tier,\n        dx.PROVIDER_FACILITY_NPI AS NPI\n    FROM nmibc_patients n\n    INNER JOIN {{ ref('std_dx_claims') }} dx ON n.PATIENT_ID = dx.PATIENT_ID\n    CROSS JOIN time_period tp\n    WHERE dx.PROVIDER_FACILITY_NPI IS NOT NULL\n      AND dx.SERVICE_DATE BETWEEN tp.period_start_date AND tp.period_end_date\n\n    UNION\n\n    SELECT DISTINCT\n        n.PATIENT_ID,\n        n.nmibc_risk_tier,\n        px.PROVIDER_FACILITY_NPI AS NPI\n    FROM nmibc_patients n\n    INNER JOIN {{ ref('std_px_claims') }} px ON n.PATIENT_ID = px.PATIENT_ID\n    CROSS JOIN time_period tp\n    WHERE px.PROVIDER_FACILITY_NPI IS NOT NULL\n      AND px.SERVICE_DATE BETWEEN tp.period_start_date AND tp.period_end_date\n),\n\n-- Step 3: Aggregate by HCO (via NPI -> KMK_HCO_ID)\nhco_nmibc_metrics AS (\n    SELECT\n        h.KMK_HCO_ID,\n        COUNT(DISTINCT c.PATIENT_ID) AS total_nmibc_patients,\n        COUNT(DISTINCT CASE WHEN c.nmibc_risk_tier = 'HIGH' THEN c.PATIENT_ID END) AS high_risk_nmibc_patients,\n        COUNT(DISTINCT CASE WHEN c.nmibc_risk_tier = 'INTERMEDIATE' THEN c.PATIENT_ID END) AS mid_risk_nmibc_patients,\n        COUNT(DISTINCT CASE WHEN c.nmibc_risk_tier = 'LOW' THEN c.PATIENT_ID END) AS low_risk_nmibc_patients\n    FROM nmibc_claims_with_facility c\n    INNER JOIN {{ ref('mdm_customer_master_hco') }} h ON c.NPI = h.npi\n    GROUP BY h.KMK_HCO_ID\n),\n\n-- ============================================================\n-- Parent Account Rollup (L1/L2) - MET-ROLLUP-008 to MET-ROLLUP-009\n-- Roll up child (L3) NMIBC metrics to parent (L1/L2) accounts\n-- Uses COUNT DISTINCT to ensure unique patients\n-- ============================================================\n\nhierarchy_lookup AS (\n    -- Get hierarchy relationships for rollup\n    SELECT\n        kmk_hco_id,\n        account_id_l1,\n        account_id_l2,\n        hierarchy_level\n    FROM {{ ref('adm_hco_hierarchy') }}\n),\n\n-- Roll up to L2 (Sub-IDN, Corporations) - only if L2 exists and differs from L1\nparent_l2_nmibc AS (\n    SELECT\n        h.account_id_l2 AS KMK_HCO_ID,\n        COUNT(DISTINCT c.PATIENT_ID) AS total_nmibc_patients,\n        COUNT(DISTINCT CASE WHEN c.nmibc_risk_tier = 'HIGH' THEN c.PATIENT_ID END) AS high_risk_nmibc_patients,\n        COUNT(DISTINCT CASE WHEN c.nmibc_risk_tier = 'INTERMEDIATE' THEN c.PATIENT_ID END) AS mid_risk_nmibc_patients,\n        COUNT(DISTINCT CASE WHEN c.nmibc_risk_tier = 'LOW' THEN c.PATIENT_ID END) AS low_risk_nmibc_patients\n    FROM nmibc_claims_with_facility c\n    INNER JOIN {{ ref('mdm_customer_master_hco') }} h_child ON c.NPI = h_child.npi\n    INNER JOIN hierarchy_lookup h ON h_child.KMK_HCO_ID = h.kmk_hco_id\n    WHERE h.account_id_l2 IS NOT NULL\n      AND h.account_id_l2 != h.account_id_l1  -- Only roll up if L2 differs from L1\n      AND h.hierarchy_level = 'L3_CHILD_ACCOUNT'  -- Only roll up from child accounts\n    GROUP BY h.account_id_l2\n),\n\n-- Roll up to L1 (PE, IDN) - ultimate parent\nparent_l1_nmibc AS (\n    SELECT\n        h.account_id_l1 AS KMK_HCO_ID,\n        COUNT(DISTINCT c.PATIENT_ID) AS total_nmibc_patients,\n        COUNT(DISTINCT CASE WHEN c.nmibc_risk_tier = 'HIGH' THEN c.PATIENT_ID END) AS high_risk_nmibc_patients,\n        COUNT(DISTINCT CASE WHEN c.nmibc_risk_tier = 'INTERMEDIATE' THEN c.PATIENT_ID END) AS mid_risk_nmibc_patients,\n        COUNT(DISTINCT CASE WHEN c.nmibc_risk_tier = 'LOW' THEN c.PATIENT_ID END) AS low_risk_nmibc_patients\n    FROM nmibc_claims_with_facility c\n    INNER JOIN {{ ref('mdm_customer_master_hco') }} h_child ON c.NPI = h_child.npi\n    INNER JOIN hierarchy_lookup h ON h_child.KMK_HCO_ID = h.kmk_hco_id\n    WHERE h.account_id_l1 IS NOT NULL\n      AND h.hierarchy_level = 'L3_CHILD_ACCOUNT'  -- Only roll up from child accounts\n    GROUP BY h.account_id_l1\n),\n\n-- Combine child metrics with parent rollups\nall_nmibc_metrics AS (\n    SELECT * FROM hco_nmibc_metrics\n    UNION ALL\n    SELECT * FROM parent_l2_nmibc\n    UNION ALL\n    SELECT * FROM parent_l1_nmibc\n)\n\nSELECT\n    KMK_HCO_ID,\n    total_nmibc_patients,\n    high_risk_nmibc_patients,\n    mid_risk_nmibc_patients,\n    low_risk_nmibc_patients,\n    CASE WHEN total_nmibc_patients > 0 THEN 'Y' ELSE 'N' END AS has_nmibc_patients,\n    tp.period_key,\n    tp.period_type,\n    tp.data_date\nFROM all_nmibc_metrics\nCROSS JOIN time_period tp", "doc_blocks": [], "language": "sql", "refs": [{"name": "ref_time_periods", "package": null, "version": null}, {"name": "adm_nmibc_risk", "package": null, "version": null}, {"name": "std_dx_claims", "package": null, "version": null}, {"name": "std_px_claims", "package": null, "version": null}, {"name": "mdm_customer_master_hco", "package": null, "version": null}, {"name": "adm_hco_hierarchy", "package": null, "version": null}, {"name": "mdm_customer_master_hco", "package": null, "version": null}, {"name": "mdm_customer_master_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.ref_time_periods", "model.CGOncology_MDM.adm_nmibc_risk", "model.CGOncology_MDM.std_dx_claims", "model.CGOncology_MDM.std_px_claims", "model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.adm_hco_hierarchy"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["kmk_hco_id"], "time_spine": null}, "model.CGOncology_MDM.adm_claims_metrics_long": {"database": "CGONCOLOGY_TEST", "schema": "ADM", "name": "adm_claims_metrics_long", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "adm/adm_claims_metrics_long.sql", "original_file_path": "models/adm/adm_claims_metrics_long.sql", "unique_id": "model.CGOncology_MDM.adm_claims_metrics_long", "fqn": ["CGOncology_MDM", "adm", "adm_claims_metrics_long"], "alias": "adm_claims_metrics_long", "checksum": {"name": "sha256", "checksum": "472a34f62090077a18f49f83927b75ff74eef26954f9d8f90f194609e7872496"}, "config": {"enabled": true, "alias": null, "schema": "ADM", "database": null, "tags": ["layer_4_adm", "customer_backbone", "customer_backbone", "adm", "metrics"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_4_adm", "customer_backbone", "adm", "metrics"], "description": "Claims metrics in long format: entity + category + time period.\nBusiness Rules: MET-001 to MET-003\nGrain: (entity_type, entity_id, metric_category, period_key)\n", "columns": {"entity_type": {"name": "entity_type", "description": "Entity type (HCO or HCP)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "entity_id": {"name": "entity_id", "description": "Entity identifier (kmk_hco_id or kmk_hcp_id)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "metric_category": {"name": "metric_category", "description": "Treatment category", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "period_key": {"name": "period_key", "description": "Time period key", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "claim_count": {"name": "claim_count", "description": "Claim count for this entity+category+period", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "patient_count": {"name": "patient_count", "description": "Distinct patient count", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/adm/schema.yml", "build_path": null, "unrendered_config": {"schema": "ADM", "materialized": "table", "tags": ["customer_backbone", "adm", "metrics"]}, "created_at": 1770177079.585541, "relation_name": "CGONCOLOGY_TEST.ADM.adm_claims_metrics_long", "raw_code": "{{\n    config(\n        schema='ADM',\n        materialized='table',\n        tags=['customer_backbone', 'adm', 'metrics']\n    )\n}}\n\n/*\nADM_CLAIMS_METRICS_LONG - Claims Aggregation by Entity + Category + Time Period\nBusiness Rules: MET-001 to MET-003, MET-008, MET-050, MET-051, PAT-010, PAT-011, PAT-012\n\nGrain: One row per (entity_type, entity_id, metric_category, period_key)\n\nSIMPLIFIED ARCHITECTURE (Jan 2026 Refactor):\n- Source: adm_dh_metrics_grain (pre-computed attribution + hierarchy + BC patient pool filter)\n- Logic: Direct GROUP BY with hierarchy levels and proper exclusion filters\n- No MAX() deduplication needed - exclusion filters prevent duplicates\n\nHierarchy Level Rollups:\n- L1: All claims grouped by account_id_l1 (top-level rollup)\n- L2: Claims where L2 != L1 (distinct L2s)\n- L3: Claims where L3 != L2 (distinct L3s)\n- L4: Claims where L4 != L3 (distinct L4s / practice locations)\n- HCP: Claims grouped by kmk_hcp_id (excluding Federal)\n\nMetrics:\n- claim_count: COUNT DISTINCT of claim_id\n- patient_count: COUNT DISTINCT of patients\n\nBC Patient Pool (PAT-010, PAT-011, PAT-012): Already filtered in adm_dh_metrics_grain\nFederal Claims (MET-FED-002, MET-FED-003): federal_claim flag in grain table; HCP metrics exclude Federal\n*/\n\n-- Get all time periods from ref_time_periods\nWITH all_time_periods AS (\n    SELECT\n        period_type,\n        period_key,\n        period_start_date,\n        period_end_date,\n        period_display_name,\n        data_date\n    FROM {{ ref('ref_time_periods') }}\n),\n\n-- Get data_date for output column\ndata_date_ref AS (\n    SELECT DISTINCT data_date\n    FROM all_time_periods\n    LIMIT 1\n),\n\n-- ============================================================\n-- DIRECT LEVEL ROLLUPS WITH EXCLUSION FILTERS\n-- Each level only includes claims where that level is distinct\n-- ============================================================\n\n-- L1 Rollup (all L1s) - Top level always included\nl1_by_category AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l1 AS entity_id,\n        g.metric_category,\n        tp.period_key,\n        tp.period_display_name,\n        tp.period_start_date,\n        tp.period_end_date,\n        COUNT(DISTINCT g.claim_id) AS claim_count,\n        COUNT(DISTINCT g.patient_id) AS patient_count\n    FROM {{ ref('adm_dh_metrics_grain') }} g\n    INNER JOIN all_time_periods tp\n        ON g.service_date >= tp.period_start_date\n        AND g.service_date <= tp.period_end_date\n    WHERE g.account_id_l1 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5, 6, 7\n),\n\nl1_total AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l1 AS entity_id,\n        'Total Claims' AS metric_category,\n        tp.period_key,\n        tp.period_display_name,\n        tp.period_start_date,\n        tp.period_end_date,\n        COUNT(DISTINCT g.claim_id) AS claim_count,\n        COUNT(DISTINCT g.patient_id) AS patient_count\n    FROM {{ ref('adm_dh_metrics_grain') }} g\n    INNER JOIN all_time_periods tp\n        ON g.service_date >= tp.period_start_date\n        AND g.service_date <= tp.period_end_date\n    WHERE g.account_id_l1 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5, 6, 7\n),\n\n-- L2 Rollup (L2 != L1) - Only distinct L2s\nl2_by_category AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l2 AS entity_id,\n        g.metric_category,\n        tp.period_key,\n        tp.period_display_name,\n        tp.period_start_date,\n        tp.period_end_date,\n        COUNT(DISTINCT g.claim_id) AS claim_count,\n        COUNT(DISTINCT g.patient_id) AS patient_count\n    FROM {{ ref('adm_dh_metrics_grain') }} g\n    INNER JOIN all_time_periods tp\n        ON g.service_date >= tp.period_start_date\n        AND g.service_date <= tp.period_end_date\n    WHERE g.account_id_l2 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5, 6, 7\n),\n\nl2_total AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l2 AS entity_id,\n        'Total Claims' AS metric_category,\n        tp.period_key,\n        tp.period_display_name,\n        tp.period_start_date,\n        tp.period_end_date,\n        COUNT(DISTINCT g.claim_id) AS claim_count,\n        COUNT(DISTINCT g.patient_id) AS patient_count\n    FROM {{ ref('adm_dh_metrics_grain') }} g\n    INNER JOIN all_time_periods tp\n        ON g.service_date >= tp.period_start_date\n        AND g.service_date <= tp.period_end_date\n    WHERE g.account_id_l2 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5, 6, 7\n),\n\n-- L3 Rollup (L3 != L2) - Only distinct L3s\nl3_by_category AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l3 AS entity_id,\n        g.metric_category,\n        tp.period_key,\n        tp.period_display_name,\n        tp.period_start_date,\n        tp.period_end_date,\n        COUNT(DISTINCT g.claim_id) AS claim_count,\n        COUNT(DISTINCT g.patient_id) AS patient_count\n    FROM {{ ref('adm_dh_metrics_grain') }} g\n    INNER JOIN all_time_periods tp\n        ON g.service_date >= tp.period_start_date\n        AND g.service_date <= tp.period_end_date\n    WHERE g.account_id_l3 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5, 6, 7\n),\n\nl3_total AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l3 AS entity_id,\n        'Total Claims' AS metric_category,\n        tp.period_key,\n        tp.period_display_name,\n        tp.period_start_date,\n        tp.period_end_date,\n        COUNT(DISTINCT g.claim_id) AS claim_count,\n        COUNT(DISTINCT g.patient_id) AS patient_count\n    FROM {{ ref('adm_dh_metrics_grain') }} g\n    INNER JOIN all_time_periods tp\n        ON g.service_date >= tp.period_start_date\n        AND g.service_date <= tp.period_end_date\n    WHERE g.account_id_l3 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5, 6, 7\n),\n\n-- L4 Rollup (L4 != L3) - Only distinct L4s (practice locations)\nl4_by_category AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l4 AS entity_id,\n        g.metric_category,\n        tp.period_key,\n        tp.period_display_name,\n        tp.period_start_date,\n        tp.period_end_date,\n        COUNT(DISTINCT g.claim_id) AS claim_count,\n        COUNT(DISTINCT g.patient_id) AS patient_count\n    FROM {{ ref('adm_dh_metrics_grain') }} g\n    INNER JOIN all_time_periods tp\n        ON g.service_date >= tp.period_start_date\n        AND g.service_date <= tp.period_end_date\n    WHERE g.account_id_l4 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5, 6, 7\n),\n\nl4_total AS (\n    SELECT\n        'HCO' AS entity_type,\n        g.account_id_l4 AS entity_id,\n        'Total Claims' AS metric_category,\n        tp.period_key,\n        tp.period_display_name,\n        tp.period_start_date,\n        tp.period_end_date,\n        COUNT(DISTINCT g.claim_id) AS claim_count,\n        COUNT(DISTINCT g.patient_id) AS patient_count\n    FROM {{ ref('adm_dh_metrics_grain') }} g\n    INNER JOIN all_time_periods tp\n        ON g.service_date >= tp.period_start_date\n        AND g.service_date <= tp.period_end_date\n    WHERE g.account_id_l4 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5, 6, 7\n),\n\n-- HCP Rollup (exclude Federal claims - MET-FED-003)\nhcp_by_category AS (\n    SELECT\n        'HCP' AS entity_type,\n        g.kmk_hcp_id AS entity_id,\n        g.metric_category,\n        tp.period_key,\n        tp.period_display_name,\n        tp.period_start_date,\n        tp.period_end_date,\n        COUNT(DISTINCT g.claim_id) AS claim_count,\n        COUNT(DISTINCT g.patient_id) AS patient_count\n    FROM {{ ref('adm_dh_metrics_grain') }} g\n    INNER JOIN all_time_periods tp\n        ON g.service_date >= tp.period_start_date\n        AND g.service_date <= tp.period_end_date\n    WHERE g.kmk_hcp_id IS NOT NULL\n      AND COALESCE(g.federal_claim, 'N') != 'Y'\n    GROUP BY 1, 2, 3, 4, 5, 6, 7\n),\n\nhcp_total AS (\n    SELECT\n        'HCP' AS entity_type,\n        g.kmk_hcp_id AS entity_id,\n        'Total Claims' AS metric_category,\n        tp.period_key,\n        tp.period_display_name,\n        tp.period_start_date,\n        tp.period_end_date,\n        COUNT(DISTINCT g.claim_id) AS claim_count,\n        COUNT(DISTINCT g.patient_id) AS patient_count\n    FROM {{ ref('adm_dh_metrics_grain') }} g\n    INNER JOIN all_time_periods tp\n        ON g.service_date >= tp.period_start_date\n        AND g.service_date <= tp.period_end_date\n    WHERE g.kmk_hcp_id IS NOT NULL\n      AND COALESCE(g.federal_claim, 'N') != 'Y'\n    GROUP BY 1, 2, 3, 4, 5, 6, 7\n),\n\n-- ============================================================\n-- COMBINE ALL METRICS\n-- No deduplication needed - exclusion filters prevent overlaps\n-- ============================================================\nall_metrics AS (\n    SELECT * FROM l1_by_category\n    UNION ALL\n    SELECT * FROM l1_total\n    UNION ALL\n    SELECT * FROM l2_by_category\n    UNION ALL\n    SELECT * FROM l2_total\n    UNION ALL\n    SELECT * FROM l3_by_category\n    UNION ALL\n    SELECT * FROM l3_total\n    UNION ALL\n    SELECT * FROM l4_by_category\n    UNION ALL\n    SELECT * FROM l4_total\n    UNION ALL\n    SELECT * FROM hcp_by_category\n    UNION ALL\n    SELECT * FROM hcp_total\n)\n\n-- Final output - simple pass-through with metric codes\nSELECT\n    entity_type,\n    entity_id,\n    metric_category,\n    period_key,\n    period_display_name,\n    period_start_date,\n    period_end_date,\n    claim_count,\n    patient_count,\n    -- Metric codes for pivoting\n    metric_category || '_CLAIMS' AS claims_metric_code,\n    metric_category || '_PATIENTS' AS patients_metric_code,\n    (SELECT data_date FROM data_date_ref) AS data_date\nFROM all_metrics", "doc_blocks": [], "language": "sql", "refs": [{"name": "ref_time_periods", "package": null, "version": null}, {"name": "adm_dh_metrics_grain", "package": null, "version": null}, {"name": "adm_dh_metrics_grain", "package": null, "version": null}, {"name": "adm_dh_metrics_grain", "package": null, "version": null}, {"name": "adm_dh_metrics_grain", "package": null, "version": null}, {"name": "adm_dh_metrics_grain", "package": null, "version": null}, {"name": "adm_dh_metrics_grain", "package": null, "version": null}, {"name": "adm_dh_metrics_grain", "package": null, "version": null}, {"name": "adm_dh_metrics_grain", "package": null, "version": null}, {"name": "adm_dh_metrics_grain", "package": null, "version": null}, {"name": "adm_dh_metrics_grain", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.ref_time_periods", "model.CGOncology_MDM.adm_dh_metrics_grain"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["entity_id", "entity_type", "metric_category", "period_key"], "time_spine": null}, "model.CGOncology_MDM.ref_treatment_categories": {"database": "CGONCOLOGY_TEST", "schema": "ADM", "name": "ref_treatment_categories", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "adm/ref_treatment_categories.sql", "original_file_path": "models/adm/ref_treatment_categories.sql", "unique_id": "model.CGOncology_MDM.ref_treatment_categories", "fqn": ["CGOncology_MDM", "adm", "ref_treatment_categories"], "alias": "ref_treatment_categories", "checksum": {"name": "sha256", "checksum": "bbb968f3c11d98330dabd3c236ec7762c03271a62c26b782f48f024e674abc83"}, "config": {"enabled": true, "alias": null, "schema": "ADM", "database": null, "tags": ["layer_4_adm", "customer_backbone", "customer_backbone", "adm", "reference"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_4_adm", "customer_backbone", "adm", "reference"], "description": "Treatment category reference table consolidating DX, PX, and RX code mappings.\nBusiness Rules: MET-030 to MET-037\n", "columns": {"code": {"name": "code", "description": "Procedure/diagnosis/NDC code", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "code_type": {"name": "code_type", "description": "Code type (DX, CPT, HCPCS, ICD10PCS, ICD9, NDC)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "TREATMENT_CATEGORY": {"name": "TREATMENT_CATEGORY", "description": "Treatment category name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "metric_category": {"name": "metric_category", "description": "Normalized metric category for aggregation", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/adm/schema.yml", "build_path": null, "unrendered_config": {"schema": "ADM", "materialized": "table", "tags": ["customer_backbone", "adm", "reference"]}, "created_at": 1770177079.5842009, "relation_name": "CGONCOLOGY_TEST.ADM.ref_treatment_categories", "raw_code": "{{\n    config(\n        schema='ADM',\n        materialized='table',\n        tags=['customer_backbone', 'adm', 'reference']\n    )\n}}\n\n/*\nREF_TREATMENT_CATEGORIES - Treatment Category Reference Table\nBusiness Rules: MET-030 to MET-037\n\nConsolidates treatment code mappings from seed files for:\n- DX codes (BC diagnosis)\n- PX codes (procedures: TURBT, BCG, etc.)\n- RX NDC codes (medications)\n\nUsed by adm_claims_metrics_long for treatment category assignment.\n*/\n\n-- DX codes from seed\nWITH dx_codes AS (\n    SELECT\n        DIAGNOSIS_CODE AS code,\n        'DX' AS code_type,\n        BC_PATIENT_POOL_FLAG,\n        TREATMENT_CATEGORY,\n        CODE_DESCRIPTION AS description\n    FROM {{ ref('seed_bc_dx_code_mapping') }}\n),\n\n-- PX codes from seed (only BC_PATIENT_POOL_FLAG = 'Y' for metrics)\npx_codes AS (\n    SELECT\n        PROCEDURE_CODE AS code,\n        CODE_TYPE AS code_type,\n        BC_PATIENT_POOL_FLAG,\n        TREATMENT_CATEGORY,\n        CODE_DESCRIPTION AS description\n    FROM {{ ref('seed_bc_px_code_mapping') }}\n),\n\n-- RX NDC codes from seed\nrx_codes AS (\n    SELECT\n        LPAD(NDC11::VARCHAR, 11, '0') AS code,  -- Cast to VARCHAR and pad to 11 digits\n        'NDC' AS code_type,\n        BC_PATIENT_POOL_FLAG,\n        TREATMENT_CATEGORY,\n        PRODUCT_NAME_REFERENCE AS description\n    FROM {{ ref('seed_bc_rx_ndc_mapping') }}\n),\n\n-- Combine all codes\nall_codes AS (\n    SELECT * FROM dx_codes\n    UNION ALL\n    SELECT * FROM px_codes\n    UNION ALL\n    SELECT * FROM rx_codes\n)\n\nSELECT\n    code,\n    code_type,\n    TREATMENT_CATEGORY,\n    BC_PATIENT_POOL_FLAG,\n    description,\n    -- Category grouping for metrics\n    CASE\n        WHEN TREATMENT_CATEGORY = 'BC DIAGNOSIS' THEN 'BC_DIAGNOSIS'\n        WHEN TREATMENT_CATEGORY = 'TURBT' THEN 'TURBT'\n        WHEN TREATMENT_CATEGORY = 'TICE BCG' THEN 'TICE_BCG'\n        WHEN TREATMENT_CATEGORY = 'ADSTILADRIN' THEN 'ADSTILADRIN'\n        WHEN TREATMENT_CATEGORY = 'ANKTIVA' THEN 'ANKTIVA'\n        WHEN TREATMENT_CATEGORY = 'KEYTRUDA' THEN 'KEYTRUDA'\n        WHEN TREATMENT_CATEGORY = 'CYSTOSCOPY' THEN 'CYSTOSCOPY'\n        WHEN TREATMENT_CATEGORY = 'OTHER PROCEDURES' THEN 'OTHER_PX'\n        ELSE 'OTHER'\n    END AS metric_category,\n    -- Metric code prefix\n    CASE\n        WHEN TREATMENT_CATEGORY = 'BC DIAGNOSIS' THEN 'DX'\n        WHEN TREATMENT_CATEGORY = 'TURBT' THEN 'TURBT'\n        WHEN TREATMENT_CATEGORY = 'TICE BCG' THEN 'BCG'\n        WHEN TREATMENT_CATEGORY = 'ADSTILADRIN' THEN 'ADS'\n        WHEN TREATMENT_CATEGORY = 'ANKTIVA' THEN 'ANK'\n        WHEN TREATMENT_CATEGORY = 'KEYTRUDA' THEN 'KEY'\n        WHEN TREATMENT_CATEGORY = 'CYSTOSCOPY' THEN 'CYS'\n        WHEN TREATMENT_CATEGORY = 'OTHER PROCEDURES' THEN 'OTH'\n        ELSE 'OTH'\n    END AS metric_prefix,\n    CURRENT_DATE() AS data_date\nFROM all_codes", "doc_blocks": [], "language": "sql", "refs": [{"name": "seed_bc_dx_code_mapping", "package": null, "version": null}, {"name": "seed_bc_px_code_mapping", "package": null, "version": null}, {"name": "seed_bc_rx_ndc_mapping", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["seed.CGOncology_MDM.seed_bc_dx_code_mapping", "seed.CGOncology_MDM.seed_bc_px_code_mapping", "seed.CGOncology_MDM.seed_bc_rx_ndc_mapping"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}, "model.CGOncology_MDM.adm_hcp_claims_wide": {"database": "CGONCOLOGY_TEST", "schema": "ADM", "name": "adm_hcp_claims_wide", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "adm/adm_hcp_claims_wide.sql", "original_file_path": "models/adm/adm_hcp_claims_wide.sql", "unique_id": "model.CGOncology_MDM.adm_hcp_claims_wide", "fqn": ["CGOncology_MDM", "adm", "adm_hcp_claims_wide"], "alias": "adm_hcp_claims_wide", "checksum": {"name": "sha256", "checksum": "656104cf2ae03cb5de5e39d21a810a33130f20101509e7442317d6eb327b6560"}, "config": {"enabled": true, "alias": null, "schema": "ADM", "database": null, "tags": ["layer_4_adm", "customer_backbone", "customer_backbone", "adm", "metrics"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_4_adm", "customer_backbone", "adm", "metrics"], "description": "HCP claims metrics pivoted to wide format (M01-M24 columns).\nBusiness Rules: MET-050, MET-051\nGrain: (kmk_hcp_id, metric_category)\n", "columns": {"kmk_hcp_id": {"name": "kmk_hcp_id", "description": "KMK HCP identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "metric_category": {"name": "metric_category", "description": "Treatment category", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/adm/schema.yml", "build_path": null, "unrendered_config": {"schema": "ADM", "materialized": "table", "tags": ["customer_backbone", "adm", "metrics"]}, "created_at": 1770177079.586016, "relation_name": "CGONCOLOGY_TEST.ADM.adm_hcp_claims_wide", "raw_code": "{{\n    config(\n        schema='ADM',\n        materialized='table',\n        tags=['customer_backbone', 'adm', 'metrics']\n    )\n}}\n\n/*\nADM_HCP_CLAIMS_WIDE - HCP Claims Metrics in Wide Format\nBusiness Rules: MET-001 to MET-003, MET-050, MET-051, MET-DATE-001 to MET-DATE-003\n\nGrain: One row per (kmk_hcp_id, metric_category)\n\nPivots claims metrics from adm_claims_metrics_long to wide format with:\n- Core HCP attributes from mdm_customer_master_hcp\n- Best HCO affiliation from mdm_best_affiliation_hist (current records only)\n- Monthly columns M01-M24 for claim_count and patient_count\n- Annual periods: YTD, QTD, PY, PYTD, P2Y, Calendar Years (current + prior 2 years)\n\nMetric Categories:\n- TURBT: Transurethral Resection procedures\n- TICE_BCG: BCG immunotherapy\n- ADSTILADRIN: Adstiladrin treatments\n- ANKTIVA: Anktiva treatments\n- CYSTOSCOPY: Cystoscopy procedures\n- OTHER_PX: Other procedures\n\nAnnual Period Columns (Dynamic - no hardcoded years):\n- ytd_claims, ytd_patients: Year-to-date (current year)\n- qtd_claims, qtd_patients: Quarter-to-date (current quarter)\n- py_claims, py_patients: Prior year full year\n- pytd_claims, pytd_patients: Prior year-to-date (same period last year)\n- p2y_claims, p2y_patients: Prior 2 years full year\n- cy_claims, cy_patients: Current calendar year\n- py_cy_claims, py_cy_patients: Prior calendar year\n- p2y_cy_claims, p2y_cy_patients: Prior 2 calendar years\n\nData Date (MET-DATE-001 to MET-DATE-003):\n- Uses data_date from ref_time_periods (which reads from dbt_project.yml var)\n- Year calculations use YEAR(data_date) instead of YEAR(CURRENT_DATE())\n- data_date represents the snapshot date when data was processed\n*/\n\n-- Get data_date from ref_time_periods\nWITH data_date_ref AS (\n    SELECT DISTINCT data_date, YEAR(data_date) AS current_year\n    FROM {{ ref('ref_time_periods') }}\n    LIMIT 1\n),\n\n-- Get HCP attributes from master\nhcp_master AS (\n    SELECT\n        kmk_hcp_id,\n        npi,\n        first_name,\n        last_name,\n        primary_specialty,\n        practice_state\n    FROM {{ ref('mdm_customer_master_hcp') }}\n),\n\n-- Get best HCO affiliation for each HCP (using mdm_best_affiliation_hist current records)\nbest_affiliation AS (\n    SELECT\n        kmk_hcp_id,\n        best_kmk_hco_id,\n        best_hco_name\n        -- mapping_rule, match_tier removed - not needed in output\n    FROM {{ ref('mdm_best_affiliation_hist') }}\n    WHERE is_current = 'Y'\n),\n\n-- Filter claims metrics to HCP only (monthly for pivot)\nhcp_metrics_long AS (\n    SELECT\n        entity_id AS kmk_hcp_id,\n        metric_category,\n        period_key,\n        claim_count,\n        patient_count\n    FROM {{ ref('adm_claims_metrics_long') }}\n    WHERE entity_type = 'HCP'\n      AND period_key LIKE 'M%'  -- Monthly periods only for pivot\n),\n\n-- Get rolling period totals and annual metrics (properly computed distinct counts)\nhcp_rolling_totals AS (\n    SELECT\n        entity_id AS kmk_hcp_id,\n        metric_category,\n        MAX(CASE WHEN period_key = 'TOTAL' THEN claim_count END) AS claims_total,\n        MAX(CASE WHEN period_key = 'TOTAL' THEN patient_count END) AS patients_total,\n        -- Claims rolling periods (COUNT DISTINCT from Long - NOT sum of monthly)\n        MAX(CASE WHEN period_key = 'L3M' THEN claim_count END) AS claims_l3m,\n        MAX(CASE WHEN period_key = 'L6M' THEN claim_count END) AS claims_l6m,\n        MAX(CASE WHEN period_key = 'L12M' THEN claim_count END) AS claims_l12m,\n        -- Patients rolling periods (COUNT DISTINCT from Long)\n        MAX(CASE WHEN period_key = 'L3M' THEN patient_count END) AS patients_l3m,\n        MAX(CASE WHEN period_key = 'L6M' THEN patient_count END) AS patients_l6m,\n        MAX(CASE WHEN period_key = 'L12M' THEN patient_count END) AS patients_l12m\n    FROM {{ ref('adm_claims_metrics_long') }}\n    WHERE entity_type = 'HCP'\n      AND period_key IN ('TOTAL', 'L3M', 'L6M', 'L12M')\n    GROUP BY entity_id, metric_category\n),\n\n-- Get annual period metrics (YTD, QTD, PY, PYTD, P2Y, Calendar Years)\n-- Use pattern matching to filter dynamically\nhcp_annual_metrics AS (\n    SELECT\n        entity_id AS kmk_hcp_id,\n        metric_category,\n        period_key,\n        claim_count,\n        patient_count\n    FROM {{ ref('adm_claims_metrics_long') }}\n    CROSS JOIN data_date_ref ddr\n    WHERE entity_type = 'HCP'\n      AND (\n          period_key LIKE 'YTD_%'\n          OR period_key LIKE 'QTD_%'\n          OR period_key LIKE 'PY_%'\n          OR period_key LIKE 'PYTD_%'\n          OR period_key LIKE 'P2Y_%'\n          OR (REGEXP_LIKE(period_key, '^[0-9]{4}$') AND TRY_CAST(period_key AS INTEGER) >= ddr.current_year - 2)\n      )\n),\n\n-- Pivot claim_count to wide format (M01-M24)\nclaims_pivot AS (\n    SELECT\n        kmk_hcp_id,\n        metric_category,\n        MAX(CASE WHEN period_key = 'M01' THEN claim_count END) AS claims_m01,\n        MAX(CASE WHEN period_key = 'M02' THEN claim_count END) AS claims_m02,\n        MAX(CASE WHEN period_key = 'M03' THEN claim_count END) AS claims_m03,\n        MAX(CASE WHEN period_key = 'M04' THEN claim_count END) AS claims_m04,\n        MAX(CASE WHEN period_key = 'M05' THEN claim_count END) AS claims_m05,\n        MAX(CASE WHEN period_key = 'M06' THEN claim_count END) AS claims_m06,\n        MAX(CASE WHEN period_key = 'M07' THEN claim_count END) AS claims_m07,\n        MAX(CASE WHEN period_key = 'M08' THEN claim_count END) AS claims_m08,\n        MAX(CASE WHEN period_key = 'M09' THEN claim_count END) AS claims_m09,\n        MAX(CASE WHEN period_key = 'M10' THEN claim_count END) AS claims_m10,\n        MAX(CASE WHEN period_key = 'M11' THEN claim_count END) AS claims_m11,\n        MAX(CASE WHEN period_key = 'M12' THEN claim_count END) AS claims_m12,\n        MAX(CASE WHEN period_key = 'M13' THEN claim_count END) AS claims_m13,\n        MAX(CASE WHEN period_key = 'M14' THEN claim_count END) AS claims_m14,\n        MAX(CASE WHEN period_key = 'M15' THEN claim_count END) AS claims_m15,\n        MAX(CASE WHEN period_key = 'M16' THEN claim_count END) AS claims_m16,\n        MAX(CASE WHEN period_key = 'M17' THEN claim_count END) AS claims_m17,\n        MAX(CASE WHEN period_key = 'M18' THEN claim_count END) AS claims_m18,\n        MAX(CASE WHEN period_key = 'M19' THEN claim_count END) AS claims_m19,\n        MAX(CASE WHEN period_key = 'M20' THEN claim_count END) AS claims_m20,\n        MAX(CASE WHEN period_key = 'M21' THEN claim_count END) AS claims_m21,\n        MAX(CASE WHEN period_key = 'M22' THEN claim_count END) AS claims_m22,\n        MAX(CASE WHEN period_key = 'M23' THEN claim_count END) AS claims_m23,\n        MAX(CASE WHEN period_key = 'M24' THEN claim_count END) AS claims_m24\n    FROM hcp_metrics_long\n    GROUP BY kmk_hcp_id, metric_category\n),\n\n-- Pivot patient_count to wide format (M01-M24)\npatients_pivot AS (\n    SELECT\n        kmk_hcp_id,\n        metric_category,\n        MAX(CASE WHEN period_key = 'M01' THEN patient_count END) AS patients_m01,\n        MAX(CASE WHEN period_key = 'M02' THEN patient_count END) AS patients_m02,\n        MAX(CASE WHEN period_key = 'M03' THEN patient_count END) AS patients_m03,\n        MAX(CASE WHEN period_key = 'M04' THEN patient_count END) AS patients_m04,\n        MAX(CASE WHEN period_key = 'M05' THEN patient_count END) AS patients_m05,\n        MAX(CASE WHEN period_key = 'M06' THEN patient_count END) AS patients_m06,\n        MAX(CASE WHEN period_key = 'M07' THEN patient_count END) AS patients_m07,\n        MAX(CASE WHEN period_key = 'M08' THEN patient_count END) AS patients_m08,\n        MAX(CASE WHEN period_key = 'M09' THEN patient_count END) AS patients_m09,\n        MAX(CASE WHEN period_key = 'M10' THEN patient_count END) AS patients_m10,\n        MAX(CASE WHEN period_key = 'M11' THEN patient_count END) AS patients_m11,\n        MAX(CASE WHEN period_key = 'M12' THEN patient_count END) AS patients_m12,\n        MAX(CASE WHEN period_key = 'M13' THEN patient_count END) AS patients_m13,\n        MAX(CASE WHEN period_key = 'M14' THEN patient_count END) AS patients_m14,\n        MAX(CASE WHEN period_key = 'M15' THEN patient_count END) AS patients_m15,\n        MAX(CASE WHEN period_key = 'M16' THEN patient_count END) AS patients_m16,\n        MAX(CASE WHEN period_key = 'M17' THEN patient_count END) AS patients_m17,\n        MAX(CASE WHEN period_key = 'M18' THEN patient_count END) AS patients_m18,\n        MAX(CASE WHEN period_key = 'M19' THEN patient_count END) AS patients_m19,\n        MAX(CASE WHEN period_key = 'M20' THEN patient_count END) AS patients_m20,\n        MAX(CASE WHEN period_key = 'M21' THEN patient_count END) AS patients_m21,\n        MAX(CASE WHEN period_key = 'M22' THEN patient_count END) AS patients_m22,\n        MAX(CASE WHEN period_key = 'M23' THEN patient_count END) AS patients_m23,\n        MAX(CASE WHEN period_key = 'M24' THEN patient_count END) AS patients_m24\n    FROM hcp_metrics_long\n    GROUP BY kmk_hcp_id, metric_category\n),\n\n-- Pivot annual metrics to wide format (using pattern matching for dynamic periods)\nannual_metrics_pivoted AS (\n    SELECT\n        am.kmk_hcp_id,\n        am.metric_category,\n        -- Annual period claims\n        MAX(CASE WHEN am.period_key LIKE 'YTD_%' THEN am.claim_count ELSE 0 END) AS ytd_claims,\n        MAX(CASE WHEN am.period_key LIKE 'QTD_%' THEN am.claim_count ELSE 0 END) AS qtd_claims,\n        MAX(CASE WHEN am.period_key LIKE 'PY_%' AND am.period_key NOT LIKE 'PYTD_%' AND am.period_key NOT LIKE 'P2Y_%' THEN am.claim_count ELSE 0 END) AS py_claims,\n        MAX(CASE WHEN am.period_key LIKE 'PYTD_%' THEN am.claim_count ELSE 0 END) AS pytd_claims,\n        MAX(CASE WHEN am.period_key LIKE 'P2Y_%' THEN am.claim_count ELSE 0 END) AS p2y_claims,\n        MAX(CASE WHEN REGEXP_LIKE(am.period_key, '^[0-9]{4}$') AND TRY_CAST(am.period_key AS INTEGER) = ddr.current_year THEN am.claim_count ELSE 0 END) AS cy_claims,\n        MAX(CASE WHEN REGEXP_LIKE(am.period_key, '^[0-9]{4}$') AND TRY_CAST(am.period_key AS INTEGER) = ddr.current_year - 1 THEN am.claim_count ELSE 0 END) AS py_cy_claims,\n        MAX(CASE WHEN REGEXP_LIKE(am.period_key, '^[0-9]{4}$') AND TRY_CAST(am.period_key AS INTEGER) = ddr.current_year - 2 THEN am.claim_count ELSE 0 END) AS p2y_cy_claims,\n        -- Annual period patients\n        MAX(CASE WHEN am.period_key LIKE 'YTD_%' THEN am.patient_count ELSE 0 END) AS ytd_patients,\n        MAX(CASE WHEN am.period_key LIKE 'QTD_%' THEN am.patient_count ELSE 0 END) AS qtd_patients,\n        MAX(CASE WHEN am.period_key LIKE 'PY_%' AND am.period_key NOT LIKE 'PYTD_%' AND am.period_key NOT LIKE 'P2Y_%' THEN am.patient_count ELSE 0 END) AS py_patients,\n        MAX(CASE WHEN am.period_key LIKE 'PYTD_%' THEN am.patient_count ELSE 0 END) AS pytd_patients,\n        MAX(CASE WHEN am.period_key LIKE 'P2Y_%' THEN am.patient_count ELSE 0 END) AS p2y_patients,\n        MAX(CASE WHEN REGEXP_LIKE(am.period_key, '^[0-9]{4}$') AND TRY_CAST(am.period_key AS INTEGER) = ddr.current_year THEN am.patient_count ELSE 0 END) AS cy_patients,\n        MAX(CASE WHEN REGEXP_LIKE(am.period_key, '^[0-9]{4}$') AND TRY_CAST(am.period_key AS INTEGER) = ddr.current_year - 1 THEN am.patient_count ELSE 0 END) AS py_cy_patients,\n        MAX(CASE WHEN REGEXP_LIKE(am.period_key, '^[0-9]{4}$') AND TRY_CAST(am.period_key AS INTEGER) = ddr.current_year - 2 THEN am.patient_count ELSE 0 END) AS p2y_cy_patients\n    FROM hcp_annual_metrics am\n    CROSS JOIN data_date_ref ddr\n    GROUP BY am.kmk_hcp_id, am.metric_category\n),\n\n-- Combine claims and patients pivots with rolling totals and annual metrics\ncombined_metrics AS (\n    SELECT\n        c.kmk_hcp_id,\n        c.metric_category,\n        -- Claims columns M01-M24\n        COALESCE(c.claims_m01, 0) AS claims_m01,\n        COALESCE(c.claims_m02, 0) AS claims_m02,\n        COALESCE(c.claims_m03, 0) AS claims_m03,\n        COALESCE(c.claims_m04, 0) AS claims_m04,\n        COALESCE(c.claims_m05, 0) AS claims_m05,\n        COALESCE(c.claims_m06, 0) AS claims_m06,\n        COALESCE(c.claims_m07, 0) AS claims_m07,\n        COALESCE(c.claims_m08, 0) AS claims_m08,\n        COALESCE(c.claims_m09, 0) AS claims_m09,\n        COALESCE(c.claims_m10, 0) AS claims_m10,\n        COALESCE(c.claims_m11, 0) AS claims_m11,\n        COALESCE(c.claims_m12, 0) AS claims_m12,\n        COALESCE(c.claims_m13, 0) AS claims_m13,\n        COALESCE(c.claims_m14, 0) AS claims_m14,\n        COALESCE(c.claims_m15, 0) AS claims_m15,\n        COALESCE(c.claims_m16, 0) AS claims_m16,\n        COALESCE(c.claims_m17, 0) AS claims_m17,\n        COALESCE(c.claims_m18, 0) AS claims_m18,\n        COALESCE(c.claims_m19, 0) AS claims_m19,\n        COALESCE(c.claims_m20, 0) AS claims_m20,\n        COALESCE(c.claims_m21, 0) AS claims_m21,\n        COALESCE(c.claims_m22, 0) AS claims_m22,\n        COALESCE(c.claims_m23, 0) AS claims_m23,\n        COALESCE(c.claims_m24, 0) AS claims_m24,\n        -- Total claims from rolling period (proper sum)\n        COALESCE(rt.claims_total, 0) AS claims_total,\n        -- Patients columns M01-M24\n        COALESCE(p.patients_m01, 0) AS patients_m01,\n        COALESCE(p.patients_m02, 0) AS patients_m02,\n        COALESCE(p.patients_m03, 0) AS patients_m03,\n        COALESCE(p.patients_m04, 0) AS patients_m04,\n        COALESCE(p.patients_m05, 0) AS patients_m05,\n        COALESCE(p.patients_m06, 0) AS patients_m06,\n        COALESCE(p.patients_m07, 0) AS patients_m07,\n        COALESCE(p.patients_m08, 0) AS patients_m08,\n        COALESCE(p.patients_m09, 0) AS patients_m09,\n        COALESCE(p.patients_m10, 0) AS patients_m10,\n        COALESCE(p.patients_m11, 0) AS patients_m11,\n        COALESCE(p.patients_m12, 0) AS patients_m12,\n        COALESCE(p.patients_m13, 0) AS patients_m13,\n        COALESCE(p.patients_m14, 0) AS patients_m14,\n        COALESCE(p.patients_m15, 0) AS patients_m15,\n        COALESCE(p.patients_m16, 0) AS patients_m16,\n        COALESCE(p.patients_m17, 0) AS patients_m17,\n        COALESCE(p.patients_m18, 0) AS patients_m18,\n        COALESCE(p.patients_m19, 0) AS patients_m19,\n        COALESCE(p.patients_m20, 0) AS patients_m20,\n        COALESCE(p.patients_m21, 0) AS patients_m21,\n        COALESCE(p.patients_m22, 0) AS patients_m22,\n        COALESCE(p.patients_m23, 0) AS patients_m23,\n        COALESCE(p.patients_m24, 0) AS patients_m24,\n        -- Total patients from rolling period (proper distinct count)\n        COALESCE(rt.patients_total, 0) AS patients_total,\n        -- Rolling period claims (L3M, L6M, L12M) - proper distinct counts from Long\n        COALESCE(rt.claims_l3m, 0) AS claims_l3m,\n        COALESCE(rt.claims_l6m, 0) AS claims_l6m,\n        COALESCE(rt.claims_l12m, 0) AS claims_l12m,\n        -- Rolling period patients (L3M, L6M, L12M) - proper distinct counts\n        COALESCE(rt.patients_l3m, 0) AS patients_l3m,\n        COALESCE(rt.patients_l6m, 0) AS patients_l6m,\n        COALESCE(rt.patients_l12m, 0) AS patients_l12m,\n        -- Annual period metrics\n        COALESCE(amp.ytd_claims, 0) AS ytd_claims,\n        COALESCE(amp.ytd_patients, 0) AS ytd_patients,\n        COALESCE(amp.qtd_claims, 0) AS qtd_claims,\n        COALESCE(amp.qtd_patients, 0) AS qtd_patients,\n        COALESCE(amp.py_claims, 0) AS py_claims,\n        COALESCE(amp.py_patients, 0) AS py_patients,\n        COALESCE(amp.pytd_claims, 0) AS pytd_claims,\n        COALESCE(amp.pytd_patients, 0) AS pytd_patients,\n        COALESCE(amp.p2y_claims, 0) AS p2y_claims,\n        COALESCE(amp.p2y_patients, 0) AS p2y_patients,\n        COALESCE(amp.cy_claims, 0) AS cy_claims,\n        COALESCE(amp.cy_patients, 0) AS cy_patients,\n        COALESCE(amp.py_cy_claims, 0) AS py_cy_claims,\n        COALESCE(amp.py_cy_patients, 0) AS py_cy_patients,\n        COALESCE(amp.p2y_cy_claims, 0) AS p2y_cy_claims,\n        COALESCE(amp.p2y_cy_patients, 0) AS p2y_cy_patients\n    FROM claims_pivot c\n    LEFT JOIN patients_pivot p\n        ON c.kmk_hcp_id = p.kmk_hcp_id\n        AND c.metric_category = p.metric_category\n    LEFT JOIN hcp_rolling_totals rt\n        ON c.kmk_hcp_id = rt.kmk_hcp_id\n        AND c.metric_category = rt.metric_category\n    LEFT JOIN annual_metrics_pivoted amp\n        ON c.kmk_hcp_id = amp.kmk_hcp_id\n        AND c.metric_category = amp.metric_category\n),\n\n-- Final output with HCP attributes and best affiliation\nfinal_output AS (\n    SELECT\n        -- HCP Core Columns\n        hcp.kmk_hcp_id,\n        hcp.npi,\n        hcp.first_name,\n        hcp.last_name,\n        hcp.primary_specialty,\n        hcp.practice_state,\n\n        -- Best HCO Affiliation\n        ba.best_kmk_hco_id,\n        ba.best_hco_name,\n\n        -- Metric Category\n        cm.metric_category,\n\n        -- Claims Columns M01-M24\n        cm.claims_m01,\n        cm.claims_m02,\n        cm.claims_m03,\n        cm.claims_m04,\n        cm.claims_m05,\n        cm.claims_m06,\n        cm.claims_m07,\n        cm.claims_m08,\n        cm.claims_m09,\n        cm.claims_m10,\n        cm.claims_m11,\n        cm.claims_m12,\n        cm.claims_m13,\n        cm.claims_m14,\n        cm.claims_m15,\n        cm.claims_m16,\n        cm.claims_m17,\n        cm.claims_m18,\n        cm.claims_m19,\n        cm.claims_m20,\n        cm.claims_m21,\n        cm.claims_m22,\n        cm.claims_m23,\n        cm.claims_m24,\n        cm.claims_total,\n\n        -- Patients Columns M01-M24\n        cm.patients_m01,\n        cm.patients_m02,\n        cm.patients_m03,\n        cm.patients_m04,\n        cm.patients_m05,\n        cm.patients_m06,\n        cm.patients_m07,\n        cm.patients_m08,\n        cm.patients_m09,\n        cm.patients_m10,\n        cm.patients_m11,\n        cm.patients_m12,\n        cm.patients_m13,\n        cm.patients_m14,\n        cm.patients_m15,\n        cm.patients_m16,\n        cm.patients_m17,\n        cm.patients_m18,\n        cm.patients_m19,\n        cm.patients_m20,\n        cm.patients_m21,\n        cm.patients_m22,\n        cm.patients_m23,\n        cm.patients_m24,\n\n        -- Total patients (proper distinct count from TOTAL rolling period)\n        cm.patients_total,\n\n        -- Rolling Period Totals - Claims (proper distinct counts from Long table)\n        cm.claims_l3m,\n        cm.claims_l6m,\n        cm.claims_l12m,\n\n        -- Rolling Period Totals - Patients (proper distinct counts from Long table)\n        cm.patients_l3m,\n        cm.patients_l6m,\n        cm.patients_l12m,\n\n        -- Annual Period Metrics (YTD, QTD, PY, PYTD, P2Y, Calendar Years)\n        cm.ytd_claims,\n        cm.ytd_patients,\n        cm.qtd_claims,\n        cm.qtd_patients,\n        cm.py_claims,\n        cm.py_patients,\n        cm.pytd_claims,\n        cm.pytd_patients,\n        cm.p2y_claims,\n        cm.p2y_patients,\n        cm.cy_claims,\n        cm.cy_patients,\n        cm.py_cy_claims,\n        cm.py_cy_patients,\n        cm.p2y_cy_claims,\n        cm.p2y_cy_patients,\n\n        -- Metadata\n        ddr.data_date AS data_date\n\n    FROM combined_metrics cm\n    CROSS JOIN data_date_ref ddr\n    INNER JOIN hcp_master hcp ON cm.kmk_hcp_id = hcp.kmk_hcp_id\n    LEFT JOIN best_affiliation ba ON cm.kmk_hcp_id = ba.kmk_hcp_id\n)\n\nSELECT * FROM final_output", "doc_blocks": [], "language": "sql", "refs": [{"name": "ref_time_periods", "package": null, "version": null}, {"name": "mdm_customer_master_hcp", "package": null, "version": null}, {"name": "mdm_best_affiliation_hist", "package": null, "version": null}, {"name": "adm_claims_metrics_long", "package": null, "version": null}, {"name": "adm_claims_metrics_long", "package": null, "version": null}, {"name": "adm_claims_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.ref_time_periods", "model.CGOncology_MDM.mdm_customer_master_hcp", "model.CGOncology_MDM.mdm_best_affiliation_hist", "model.CGOncology_MDM.adm_claims_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["kmk_hcp_id", "metric_category"], "time_spine": null}, "model.CGOncology_MDM.adm_dh_metrics_grain": {"database": "CGONCOLOGY_TEST", "schema": "ADM", "name": "adm_dh_metrics_grain", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "adm/adm_dh_metrics_grain.sql", "original_file_path": "models/adm/adm_dh_metrics_grain.sql", "unique_id": "model.CGOncology_MDM.adm_dh_metrics_grain", "fqn": ["CGOncology_MDM", "adm", "adm_dh_metrics_grain"], "alias": "adm_dh_metrics_grain", "checksum": {"name": "sha256", "checksum": "1104733e2ad73d8e7131f441110925813cc08c070f500e460bd64969e0048351"}, "config": {"enabled": true, "alias": null, "schema": "ADM", "database": null, "tags": ["layer_4_adm", "customer_backbone", "customer_backbone", "adm", "metrics"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_4_adm", "customer_backbone", "adm", "metrics"], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"schema": "ADM", "materialized": "table", "tags": ["customer_backbone", "adm", "metrics"]}, "created_at": 1770177078.9385998, "relation_name": "CGONCOLOGY_TEST.ADM.adm_dh_metrics_grain", "raw_code": "{{\n    config(\n        schema='ADM',\n        materialized='table',\n        tags=['customer_backbone', 'adm', 'metrics']\n    )\n}}\n\n/*\nADM_DH_METRICS_GRAIN - Claims Metrics Grain Table (Lowest Level)\nBusiness Rules: MET-001 to MET-003, MET-008, MET-009, MET-050, MET-051, MET-FED-001 to MET-FED-003, PAT-010, PAT-011, PAT-012\n\nGrain: One row per (CLAIM_ID, DATE, CLAIM_TYPE, PATIENT_ID, TREATMENT)\n\nPurpose: Lowest level grain table for claims metrics calculation and rollup.\nContains hierarchy columns (ACCOUNT_ID_L1 through ACCOUNT_ID_L4) for rollup calculations.\n\nSource: std_dx_claims, std_px_claims, std_rx_claims\nAttribution: Single-pass enrichment with CASE-based logic (REFACTORED Jan 2026)\nHierarchy: adm_hco_hierarchy (for L1/L2/L3/L4 account IDs)\n\nKey Logic (SIMPLIFIED):\n1. Filter to BC Patient Pool (PAT-010, PAT-011, PAT-012)\n2. Single-pass enrichment: Join HCP, Best Affiliation, HCO, Federal check in ONE pass\n3. CASE-based attribution:\n   - Federal (billing NPI \u2192 Federal HCO): kmk_hcp_id=NULL, use billing HCO (MET-FED-001 to MET-FED-003)\n   - HCP Path (rendering NPI \u2192 HCP): Use best affiliation HCO for hierarchy (MET-008)\n   - HCO Path (rendering NPI \u2192 HCO, when not HCP): Direct HCO attribution\n   - Billing NPI Fallback (MET-009): When rendering NPI has no attribution, use billing NPI \u2192 HCO\n4. Join hierarchy ONCE on final kmk_hco_id\n\nAttribution Priority: Federal > HCP (with best affiliation) > Direct Render HCO > Billing HCO Fallback\n\nFIX 2026-01-31: Added billing NPI fallback path (MET-009) to recover ~17.8K PX claims\nwhere rendering NPI is not in any master but billing NPI maps to a valid HCO.\n*/\n\n-- BC Patient Pool Filter (PAT-010, PAT-011, PAT-012)\nWITH bc_patient_pool AS (\n    SELECT PATIENT_ID\n    FROM {{ ref('stg_bc_patient_pool') }}\n),\n\n-- Combine all claim types into unified grain\n-- Dedup to (claim_id, treatment_category) since multiple codes can map to same category\nall_claims AS (\n    -- PX claims (GROUP BY to dedup multiple procedure codes \u2192 same treatment category)\n    SELECT\n        PX_CLAIM_ID AS claim_id,\n        'PX' AS claim_type,\n        PATIENT_ID,\n        SERVICE_DATE AS service_date,\n        SERVICE_YEAR,\n        SERVICE_MONTH,\n        COALESCE(UPPER(REPLACE(TREATMENT_CATEGORY, ' ', '_')), 'OTHER_PX') AS metric_category,\n        PROVIDER_RENDERING_NPI,\n        PROVIDER_BILLING_NPI,\n        PATIENT_PRIMARY_PAYOR_TYPE AS payor_type,\n        PATIENT_PRIMARY_PAYOR_NAME AS payor_name,\n        PATIENT_PRIMARY_PAYOR_DH_ID AS payor_dh_id\n    FROM {{ ref('std_px_claims') }}\n    WHERE SERVICE_DATE IS NOT NULL\n      AND TREATMENT_CATEGORY IS NOT NULL\n    GROUP BY 1,2,3,4,5,6,7,8,9,10,11,12\n\n    UNION ALL\n\n    -- DX claims (GROUP BY to dedup multiple diagnosis codes \u2192 same treatment category)\n    SELECT\n        MX_CLAIM_ID AS claim_id,\n        'DX' AS claim_type,\n        PATIENT_ID,\n        SERVICE_DATE AS service_date,\n        SERVICE_YEAR,\n        SERVICE_MONTH,\n        COALESCE(UPPER(REPLACE(TREATMENT_CATEGORY, ' ', '_')), 'OTHER_DX') AS metric_category,\n        PROVIDER_RENDERING_NPI,\n        PROVIDER_BILLING_NPI,\n        PATIENT_PRIMARY_PAYOR_TYPE AS payor_type,\n        PATIENT_PRIMARY_PAYOR_NAME AS payor_name,\n        PATIENT_PRIMARY_PAYOR_DH_ID AS payor_dh_id\n    FROM {{ ref('std_dx_claims') }}\n    WHERE SERVICE_DATE IS NOT NULL\n      AND TREATMENT_CATEGORY IS NOT NULL\n    GROUP BY 1,2,3,4,5,6,7,8,9,10,11,12\n\n    UNION ALL\n\n    -- RX claims (GROUP BY to dedup multiple NDCs \u2192 same treatment category)\n    SELECT\n        RX_CLAIM_ID AS claim_id,\n        'RX' AS claim_type,\n        PATIENT_ID,\n        FILL_DATE AS service_date,\n        FILL_YEAR AS SERVICE_YEAR,\n        FILL_MONTH AS SERVICE_MONTH,\n        COALESCE(UPPER(REPLACE(TREATMENT_CATEGORY, ' ', '_')), 'OTHER_RX') AS metric_category,\n        PROVIDER_PRESCRIBING_NPI AS PROVIDER_RENDERING_NPI,\n        NULL AS PROVIDER_BILLING_NPI,\n        PATIENT_PRIMARY_PAYOR_TYPE AS payor_type,\n        PATIENT_PRIMARY_PAYOR_NAME AS payor_name,\n        PATIENT_PRIMARY_PAYOR_DH_ID AS payor_dh_id\n    FROM {{ ref('std_rx_claims') }}\n    WHERE FILL_DATE IS NOT NULL\n      AND TREATMENT_CATEGORY IS NOT NULL\n    GROUP BY 1,2,3,4,5,6,7,8,9,10,11,12\n),\n\n-- Filter to BC Patient Pool\nclaims_filtered AS (\n    SELECT c.*\n    FROM all_claims c\n    INNER JOIN bc_patient_pool pool ON c.PATIENT_ID = pool.PATIENT_ID\n),\n\n-- =============================================================================\n-- DEDUPLICATED HCO LOOKUPS\n-- Some NPIs map to multiple HCOs in source (e.g., hospital systems with shared NPI)\n-- Pick ONE HCO per NPI with priority:\n--   1. Hierarchy level: L4 > L3 > L2 > L1 (higher number = lower/more granular = preferred)\n--   2. Firm type: PG > Hospital > Other\n--   3. KMK_HCO_ID for consistency\n-- NOTE: Practice locations don't have NPIs, so they're not included here\n-- Practice locations receive claims via Path 1 (HCP \u2192 best affiliation) only\n-- =============================================================================\nhco_by_npi AS (\n    SELECT\n        hco.npi,\n        hco.KMK_HCO_ID,\n        abi.account_type,\n        hco.firm_type,\n        -- Determine hierarchy level (4=L4 lowest/more granular, 1=L1 top)\n        CASE\n            WHEN h.kmk_hco_id = h.account_id_l4 THEN 4\n            WHEN h.kmk_hco_id = h.account_id_l3 THEN 3\n            WHEN h.kmk_hco_id = h.account_id_l2 THEN 2\n            WHEN h.kmk_hco_id = h.account_id_l1 THEN 1\n            ELSE 0\n        END AS hco_level\n    FROM {{ ref('mdm_customer_master_hco') }} hco\n    LEFT JOIN {{ ref('adm_hco_hierarchy') }} h ON hco.KMK_HCO_ID = h.kmk_hco_id\n    LEFT JOIN {{ ref('account_type_business_input') }} abi ON CAST(hco.dh_id AS VARCHAR) = abi.dh_id\n    WHERE hco.npi IS NOT NULL\n      -- Practice locations don't have NPIs, so they're excluded from direct HCO path\n      -- They receive claims via Path 1 (HCP \u2192 best affiliation) only\n      AND (hco.firm_type IS NULL OR hco.firm_type != 'Practice Location')\n    QUALIFY ROW_NUMBER() OVER (\n        PARTITION BY hco.npi\n        ORDER BY\n            hco_level DESC,  -- L4 first (most granular)\n            CASE\n                WHEN hco.firm_type = 'Physician Group' THEN 1\n                WHEN hco.firm_type = 'Hospital' THEN 2\n                ELSE 3\n            END,\n            hco.KMK_HCO_ID\n    ) = 1\n),\n\n-- =============================================================================\n-- SINGLE-PASS ENRICHMENT\n-- All lookups in ONE pass: HCP, Best Affiliation, Direct HCO, Federal HCO\n-- Priority: Federal > HCP (best affiliation) > Direct HCO\n-- =============================================================================\nclaims_enriched AS (\n    SELECT\n        c.claim_id,\n        c.claim_type,\n        c.PATIENT_ID,\n        c.service_date,\n        c.SERVICE_YEAR,\n        c.SERVICE_MONTH,\n        c.metric_category,\n        c.PROVIDER_RENDERING_NPI,\n        c.PROVIDER_BILLING_NPI,\n        c.payor_type,\n        c.payor_name,\n        c.payor_dh_id,\n\n        -- HCP from rendering NPI\n        hcp.KMK_HCP_ID,\n\n        -- Best affiliation HCO for HCP (NULL if no affiliation OR if HCO doesn't exist in master)\n        CASE WHEN ba_hco.KMK_HCO_ID IS NOT NULL THEN ba.BEST_KMK_HCO_ID ELSE NULL END AS hcp_aff_hco_id,\n\n        -- Direct HCO from rendering NPI (for fallback when not HCP)\n        hco_render.KMK_HCO_ID AS render_hco_id,\n\n        -- Federal HCO from billing NPI\n        hco_billing.KMK_HCO_ID AS billing_hco_id,\n\n        -- Is Federal? (billing HCO has Federal account type)\n        CASE WHEN hco_billing.account_type ILIKE '%FEDERAL%' THEN 'Y' ELSE 'N' END AS is_federal\n\n    FROM claims_filtered c\n\n    -- HCP lookup (rendering NPI \u2192 HCP)\n    LEFT JOIN {{ ref('mdm_customer_master_hcp') }} hcp\n        ON c.PROVIDER_RENDERING_NPI = hcp.npi\n\n    -- Best affiliation for HCP \u2192 HCO\n    LEFT JOIN {{ ref('mdm_best_affiliation_hist') }} ba\n        ON hcp.KMK_HCP_ID = ba.KMK_HCP_ID\n        AND ba.is_current = 'Y'\n\n    -- Validate best_affiliation HCO exists in master (filter out orphan practice locations)\n    LEFT JOIN {{ ref('mdm_customer_master_hco') }} ba_hco\n        ON ba.BEST_KMK_HCO_ID = ba_hco.KMK_HCO_ID\n\n    -- Direct HCO from rendering NPI (deduplicated - one HCO per NPI)\n    LEFT JOIN hco_by_npi hco_render\n        ON c.PROVIDER_RENDERING_NPI = hco_render.npi\n\n    -- Federal HCO from billing NPI (deduplicated - one HCO per NPI)\n    LEFT JOIN hco_by_npi hco_billing\n        ON c.PROVIDER_BILLING_NPI = hco_billing.npi\n),\n\n-- =============================================================================\n-- ATTRIBUTION LOGIC (CASE-based, no UNION needed)\n-- Priority: Federal > HCP (with best affiliation) > Direct HCO\n-- =============================================================================\nclaims_attributed AS (\n    SELECT\n        claim_id,\n        claim_type,\n        PATIENT_ID,\n        service_date,\n        SERVICE_YEAR,\n        SERVICE_MONTH,\n        metric_category,\n        PROVIDER_RENDERING_NPI,\n        payor_type,\n        payor_name,\n        payor_dh_id,\n\n        -- Federal claim flag (MET-FED-002)\n        is_federal AS federal_claim,\n\n        -- Filed at HCO flag (includes billing NPI fallback - MET-009)\n        CASE\n            WHEN is_federal = 'Y' THEN 'Y'\n            WHEN KMK_HCP_ID IS NULL AND render_hco_id IS NOT NULL THEN 'Y'\n            WHEN KMK_HCP_ID IS NULL AND render_hco_id IS NULL AND billing_hco_id IS NOT NULL THEN 'Y'\n            ELSE 'N'\n        END AS filed_at_hco,\n\n        -- HCP: NULL for Federal claims (MET-FED-003), otherwise from rendering NPI\n        CASE\n            WHEN is_federal = 'Y' THEN NULL\n            ELSE KMK_HCP_ID\n        END AS kmk_hcp_id,\n\n        -- HCO: Priority = Federal billing HCO > HCP's best affiliation > Direct render HCO > Billing HCO fallback\n        -- MET-009: Added billing_hco_id fallback for HCO-filed claims where rendering NPI has no attribution\n        CASE\n            WHEN is_federal = 'Y' THEN billing_hco_id\n            WHEN KMK_HCP_ID IS NOT NULL THEN hcp_aff_hco_id  -- HCP path: use best affiliation (may be NULL)\n            WHEN render_hco_id IS NOT NULL THEN render_hco_id  -- Direct HCO path\n            ELSE billing_hco_id  -- Billing NPI fallback (MET-009)\n        END AS kmk_hco_id\n\n    FROM claims_enriched\n    -- Filter: Must have at least one valid attribution\n    WHERE is_federal = 'Y'  -- Federal claims\n       OR KMK_HCP_ID IS NOT NULL  -- HCP claims (with or without affiliation)\n       OR render_hco_id IS NOT NULL  -- Direct HCO claims\n       OR billing_hco_id IS NOT NULL  -- Billing NPI fallback (MET-009)\n),\n\n-- =============================================================================\n-- JOIN HIERARCHY (ONCE, on final kmk_hco_id)\n-- =============================================================================\nclaims_with_hierarchy AS (\n    SELECT\n        c.claim_id,\n        c.claim_type,\n        c.PATIENT_ID,\n        c.service_date,\n        c.SERVICE_YEAR,\n        c.SERVICE_MONTH,\n        c.metric_category,\n        c.PROVIDER_RENDERING_NPI AS provider_rendering_npi,\n        c.kmk_hcp_id,\n        c.kmk_hco_id,\n        -- Hierarchy columns (NULL when kmk_hco_id is NULL, e.g., HCPs without affiliation)\n        h.account_id_l4,\n        h.account_id_l3,\n        h.account_id_l2,\n        h.account_id_l1,\n        c.payor_type,\n        c.payor_name,\n        c.payor_dh_id,\n        c.federal_claim,\n        c.filed_at_hco\n    FROM claims_attributed c\n    LEFT JOIN {{ ref('adm_hco_hierarchy') }} h\n        ON c.kmk_hco_id = h.kmk_hco_id\n)\n\n-- Final output\nSELECT * FROM claims_with_hierarchy", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_bc_patient_pool", "package": null, "version": null}, {"name": "std_px_claims", "package": null, "version": null}, {"name": "std_dx_claims", "package": null, "version": null}, {"name": "std_rx_claims", "package": null, "version": null}, {"name": "mdm_customer_master_hco", "package": null, "version": null}, {"name": "adm_hco_hierarchy", "package": null, "version": null}, {"name": "account_type_business_input", "package": null, "version": null}, {"name": "mdm_customer_master_hcp", "package": null, "version": null}, {"name": "mdm_best_affiliation_hist", "package": null, "version": null}, {"name": "mdm_customer_master_hco", "package": null, "version": null}, {"name": "adm_hco_hierarchy", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.stg_bc_patient_pool", "model.CGOncology_MDM.std_px_claims", "model.CGOncology_MDM.std_dx_claims", "model.CGOncology_MDM.std_rx_claims", "model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.adm_hco_hierarchy", "seed.CGOncology_MDM.account_type_business_input", "model.CGOncology_MDM.mdm_customer_master_hcp", "model.CGOncology_MDM.mdm_best_affiliation_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}, "model.CGOncology_MDM.adm_claims_metrics_by_payor": {"database": "CGONCOLOGY_TEST", "schema": "ADM", "name": "adm_claims_metrics_by_payor", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "adm/adm_claims_metrics_by_payor.sql", "original_file_path": "models/adm/adm_claims_metrics_by_payor.sql", "unique_id": "model.CGOncology_MDM.adm_claims_metrics_by_payor", "fqn": ["CGOncology_MDM", "adm", "adm_claims_metrics_by_payor"], "alias": "adm_claims_metrics_by_payor", "checksum": {"name": "sha256", "checksum": "5d7254be59a7277cbea7d8c9a5cc26a65b398b02ad5fab61c0a8940e5715fc9b"}, "config": {"enabled": true, "alias": null, "schema": "ADM", "database": null, "tags": ["layer_4_adm", "customer_backbone", "customer_backbone", "adm", "metrics"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_4_adm", "customer_backbone", "adm", "metrics"], "description": "Claims metrics broken down by payor type.\nBusiness Rules: MET-080 to MET-091\n", "columns": {"entity_type": {"name": "entity_type", "description": "Entity type (HCO or HCP)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "entity_id": {"name": "entity_id", "description": "Entity identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "metric_category": {"name": "metric_category", "description": "Treatment category", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "payor_type": {"name": "payor_type", "description": "Payor type (includes ALL for aggregate rows)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/adm/schema.yml", "build_path": null, "unrendered_config": {"schema": "ADM", "materialized": "table", "tags": ["customer_backbone", "adm", "metrics"]}, "created_at": 1770177079.585757, "relation_name": "CGONCOLOGY_TEST.ADM.adm_claims_metrics_by_payor", "raw_code": "{{\n    config(\n        schema='ADM',\n        materialized='table',\n        tags=['customer_backbone', 'adm', 'metrics']\n    )\n}}\n\n/*\nADM_CLAIMS_METRICS_BY_PAYOR - Claims Aggregation by Entity + Category + Payor Type + Time Period\nBusiness Rules: MET-008, MET-080 to MET-091, PAT-010, PAT-011, PAT-012\n\nGrain: One row per (entity_type, entity_id, metric_category, payor_type, period_key)\n\nSIMPLIFIED ARCHITECTURE (Jan 2026 Refactor):\n- Source: adm_dh_metrics_grain (pre-computed attribution + hierarchy)\n- Logic: Direct GROUP BY on hierarchy columns - no rollup logic needed\n- Grain table already has account_id_l1/l2/l3/l4 pre-computed for each claim\n\nAggregates by:\n- Entity: HCO (L1, L2, L3, L4) and HCP\n- Treatment Category: metric_category from grain + TOTAL (all categories combined)\n- Payor Type: Canonical payor types from ref_payor_types + ALL (all payors combined)\n- Time Period: All periods from ref_time_periods\n\nNOTE: TOTAL metric_category is calculated from COUNT(DISTINCT claim_id/patient_id) at grain level,\n      NOT by summing individual categories (which would double-count overlapping claims/patients).\n*/\n\nWITH all_time_periods AS (\n    SELECT period_key, period_type, period_start_date, period_end_date\n    FROM {{ ref('ref_time_periods') }}\n),\n\ndata_date_ref AS (\n    SELECT DISTINCT data_date FROM {{ ref('ref_time_periods') }} LIMIT 1\n),\n\npayor_types AS (\n    SELECT raw_payor_type, canonical_payor_type FROM {{ ref('ref_payor_types') }}\n),\n\ngrain AS (\n    SELECT\n        g.claim_id, g.PATIENT_ID, g.metric_category, g.service_date,\n        g.kmk_hcp_id, g.kmk_hco_id, g.federal_claim,\n        g.account_id_l1, g.account_id_l2, g.account_id_l3, g.account_id_l4,\n        COALESCE(pt.canonical_payor_type, 'OTHER') AS payor_type\n    FROM {{ ref('adm_dh_metrics_grain') }} g\n    LEFT JOIN payor_types pt ON g.payor_type = pt.raw_payor_type\n),\n\n-- ============================================================\n-- ALL HCO LEVELS + HCP - Direct GROUP BY on hierarchy columns\n-- Includes both per-category metrics and TOTAL (all categories)\n-- ============================================================\nall_metrics AS (\n    -- ===================\n    -- L1 METRICS\n    -- ===================\n    -- L1 by payor\n    SELECT 'HCO' AS entity_type, g.account_id_l1 AS entity_id, g.metric_category, g.payor_type,\n           tp.period_key, tp.period_type,\n           COUNT(DISTINCT g.claim_id) AS claim_count, COUNT(DISTINCT g.PATIENT_ID) AS patient_count\n    FROM grain g\n    INNER JOIN all_time_periods tp ON g.service_date BETWEEN tp.period_start_date AND tp.period_end_date\n    WHERE g.account_id_l1 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5, 6\n\n    UNION ALL\n\n    -- L1 ALL payors\n    SELECT 'HCO', g.account_id_l1, g.metric_category, 'ALL',\n           tp.period_key, tp.period_type,\n           COUNT(DISTINCT g.claim_id), COUNT(DISTINCT g.PATIENT_ID)\n    FROM grain g\n    INNER JOIN all_time_periods tp ON g.service_date BETWEEN tp.period_start_date AND tp.period_end_date\n    WHERE g.account_id_l1 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5, 6\n\n    UNION ALL\n\n    -- L1 TOTAL by payor (all categories combined)\n    SELECT 'HCO', g.account_id_l1, 'TOTAL', g.payor_type,\n           tp.period_key, tp.period_type,\n           COUNT(DISTINCT g.claim_id), COUNT(DISTINCT g.PATIENT_ID)\n    FROM grain g\n    INNER JOIN all_time_periods tp ON g.service_date BETWEEN tp.period_start_date AND tp.period_end_date\n    WHERE g.account_id_l1 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5, 6\n\n    UNION ALL\n\n    -- L1 TOTAL ALL payors (grand total)\n    SELECT 'HCO', g.account_id_l1, 'TOTAL', 'ALL',\n           tp.period_key, tp.period_type,\n           COUNT(DISTINCT g.claim_id), COUNT(DISTINCT g.PATIENT_ID)\n    FROM grain g\n    INNER JOIN all_time_periods tp ON g.service_date BETWEEN tp.period_start_date AND tp.period_end_date\n    WHERE g.account_id_l1 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5, 6\n\n    UNION ALL\n\n    -- ===================\n    -- L2 METRICS\n    -- ===================\n    -- L2 by payor\n    SELECT 'HCO', g.account_id_l2, g.metric_category, g.payor_type,\n           tp.period_key, tp.period_type,\n           COUNT(DISTINCT g.claim_id), COUNT(DISTINCT g.PATIENT_ID)\n    FROM grain g\n    INNER JOIN all_time_periods tp ON g.service_date BETWEEN tp.period_start_date AND tp.period_end_date\n    WHERE g.account_id_l2 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5, 6\n\n    UNION ALL\n\n    -- L2 ALL payors\n    SELECT 'HCO', g.account_id_l2, g.metric_category, 'ALL',\n           tp.period_key, tp.period_type,\n           COUNT(DISTINCT g.claim_id), COUNT(DISTINCT g.PATIENT_ID)\n    FROM grain g\n    INNER JOIN all_time_periods tp ON g.service_date BETWEEN tp.period_start_date AND tp.period_end_date\n    WHERE g.account_id_l2 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5, 6\n\n    UNION ALL\n\n    -- L2 TOTAL by payor\n    SELECT 'HCO', g.account_id_l2, 'TOTAL', g.payor_type,\n           tp.period_key, tp.period_type,\n           COUNT(DISTINCT g.claim_id), COUNT(DISTINCT g.PATIENT_ID)\n    FROM grain g\n    INNER JOIN all_time_periods tp ON g.service_date BETWEEN tp.period_start_date AND tp.period_end_date\n    WHERE g.account_id_l2 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5, 6\n\n    UNION ALL\n\n    -- L2 TOTAL ALL payors\n    SELECT 'HCO', g.account_id_l2, 'TOTAL', 'ALL',\n           tp.period_key, tp.period_type,\n           COUNT(DISTINCT g.claim_id), COUNT(DISTINCT g.PATIENT_ID)\n    FROM grain g\n    INNER JOIN all_time_periods tp ON g.service_date BETWEEN tp.period_start_date AND tp.period_end_date\n    WHERE g.account_id_l2 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5, 6\n\n    UNION ALL\n\n    -- ===================\n    -- L3 METRICS\n    -- ===================\n    -- L3 by payor\n    SELECT 'HCO', g.account_id_l3, g.metric_category, g.payor_type,\n           tp.period_key, tp.period_type,\n           COUNT(DISTINCT g.claim_id), COUNT(DISTINCT g.PATIENT_ID)\n    FROM grain g\n    INNER JOIN all_time_periods tp ON g.service_date BETWEEN tp.period_start_date AND tp.period_end_date\n    WHERE g.account_id_l3 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5, 6\n\n    UNION ALL\n\n    -- L3 ALL payors\n    SELECT 'HCO', g.account_id_l3, g.metric_category, 'ALL',\n           tp.period_key, tp.period_type,\n           COUNT(DISTINCT g.claim_id), COUNT(DISTINCT g.PATIENT_ID)\n    FROM grain g\n    INNER JOIN all_time_periods tp ON g.service_date BETWEEN tp.period_start_date AND tp.period_end_date\n    WHERE g.account_id_l3 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5, 6\n\n    UNION ALL\n\n    -- L3 TOTAL by payor\n    SELECT 'HCO', g.account_id_l3, 'TOTAL', g.payor_type,\n           tp.period_key, tp.period_type,\n           COUNT(DISTINCT g.claim_id), COUNT(DISTINCT g.PATIENT_ID)\n    FROM grain g\n    INNER JOIN all_time_periods tp ON g.service_date BETWEEN tp.period_start_date AND tp.period_end_date\n    WHERE g.account_id_l3 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5, 6\n\n    UNION ALL\n\n    -- L3 TOTAL ALL payors\n    SELECT 'HCO', g.account_id_l3, 'TOTAL', 'ALL',\n           tp.period_key, tp.period_type,\n           COUNT(DISTINCT g.claim_id), COUNT(DISTINCT g.PATIENT_ID)\n    FROM grain g\n    INNER JOIN all_time_periods tp ON g.service_date BETWEEN tp.period_start_date AND tp.period_end_date\n    WHERE g.account_id_l3 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5, 6\n\n    UNION ALL\n\n    -- ===================\n    -- L4 METRICS\n    -- ===================\n    -- L4 by payor\n    SELECT 'HCO', g.account_id_l4, g.metric_category, g.payor_type,\n           tp.period_key, tp.period_type,\n           COUNT(DISTINCT g.claim_id), COUNT(DISTINCT g.PATIENT_ID)\n    FROM grain g\n    INNER JOIN all_time_periods tp ON g.service_date BETWEEN tp.period_start_date AND tp.period_end_date\n    WHERE g.account_id_l4 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5, 6\n\n    UNION ALL\n\n    -- L4 ALL payors\n    SELECT 'HCO', g.account_id_l4, g.metric_category, 'ALL',\n           tp.period_key, tp.period_type,\n           COUNT(DISTINCT g.claim_id), COUNT(DISTINCT g.PATIENT_ID)\n    FROM grain g\n    INNER JOIN all_time_periods tp ON g.service_date BETWEEN tp.period_start_date AND tp.period_end_date\n    WHERE g.account_id_l4 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5, 6\n\n    UNION ALL\n\n    -- L4 TOTAL by payor\n    SELECT 'HCO', g.account_id_l4, 'TOTAL', g.payor_type,\n           tp.period_key, tp.period_type,\n           COUNT(DISTINCT g.claim_id), COUNT(DISTINCT g.PATIENT_ID)\n    FROM grain g\n    INNER JOIN all_time_periods tp ON g.service_date BETWEEN tp.period_start_date AND tp.period_end_date\n    WHERE g.account_id_l4 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5, 6\n\n    UNION ALL\n\n    -- L4 TOTAL ALL payors\n    SELECT 'HCO', g.account_id_l4, 'TOTAL', 'ALL',\n           tp.period_key, tp.period_type,\n           COUNT(DISTINCT g.claim_id), COUNT(DISTINCT g.PATIENT_ID)\n    FROM grain g\n    INNER JOIN all_time_periods tp ON g.service_date BETWEEN tp.period_start_date AND tp.period_end_date\n    WHERE g.account_id_l4 IS NOT NULL\n    GROUP BY 1, 2, 3, 4, 5, 6\n\n    UNION ALL\n\n    -- ===================\n    -- HCP METRICS (exclude Federal)\n    -- ===================\n    -- HCP by payor\n    SELECT 'HCP', g.kmk_hcp_id, g.metric_category, g.payor_type,\n           tp.period_key, tp.period_type,\n           COUNT(DISTINCT g.claim_id), COUNT(DISTINCT g.PATIENT_ID)\n    FROM grain g\n    INNER JOIN all_time_periods tp ON g.service_date BETWEEN tp.period_start_date AND tp.period_end_date\n    WHERE g.kmk_hcp_id IS NOT NULL AND COALESCE(g.federal_claim, 'N') != 'Y'\n    GROUP BY 1, 2, 3, 4, 5, 6\n\n    UNION ALL\n\n    -- HCP ALL payors\n    SELECT 'HCP', g.kmk_hcp_id, g.metric_category, 'ALL',\n           tp.period_key, tp.period_type,\n           COUNT(DISTINCT g.claim_id), COUNT(DISTINCT g.PATIENT_ID)\n    FROM grain g\n    INNER JOIN all_time_periods tp ON g.service_date BETWEEN tp.period_start_date AND tp.period_end_date\n    WHERE g.kmk_hcp_id IS NOT NULL AND COALESCE(g.federal_claim, 'N') != 'Y'\n    GROUP BY 1, 2, 3, 4, 5, 6\n\n    UNION ALL\n\n    -- HCP TOTAL by payor\n    SELECT 'HCP', g.kmk_hcp_id, 'TOTAL', g.payor_type,\n           tp.period_key, tp.period_type,\n           COUNT(DISTINCT g.claim_id), COUNT(DISTINCT g.PATIENT_ID)\n    FROM grain g\n    INNER JOIN all_time_periods tp ON g.service_date BETWEEN tp.period_start_date AND tp.period_end_date\n    WHERE g.kmk_hcp_id IS NOT NULL AND COALESCE(g.federal_claim, 'N') != 'Y'\n    GROUP BY 1, 2, 3, 4, 5, 6\n\n    UNION ALL\n\n    -- HCP TOTAL ALL payors\n    SELECT 'HCP', g.kmk_hcp_id, 'TOTAL', 'ALL',\n           tp.period_key, tp.period_type,\n           COUNT(DISTINCT g.claim_id), COUNT(DISTINCT g.PATIENT_ID)\n    FROM grain g\n    INNER JOIN all_time_periods tp ON g.service_date BETWEEN tp.period_start_date AND tp.period_end_date\n    WHERE g.kmk_hcp_id IS NOT NULL AND COALESCE(g.federal_claim, 'N') != 'Y'\n    GROUP BY 1, 2, 3, 4, 5, 6\n)\n\n-- Final output with deduplication (handles overlapping hierarchy levels)\nSELECT\n    entity_type, entity_id, metric_category, payor_type, period_key,\n    MAX(period_type) AS period_type,\n    MAX(claim_count) AS claim_count,\n    MAX(patient_count) AS patient_count,\n    CASE WHEN payor_type = 'ALL' THEN metric_category || '_CLAIMS'\n         ELSE metric_category || '_CLAIMS_' || payor_type END AS claims_metric_code,\n    CASE WHEN payor_type = 'ALL' THEN metric_category || '_PATIENTS'\n         ELSE metric_category || '_PATIENTS_' || payor_type END AS patients_metric_code,\n    (SELECT data_date FROM data_date_ref) AS data_date\nFROM all_metrics\nGROUP BY entity_type, entity_id, metric_category, payor_type, period_key", "doc_blocks": [], "language": "sql", "refs": [{"name": "ref_time_periods", "package": null, "version": null}, {"name": "ref_time_periods", "package": null, "version": null}, {"name": "ref_payor_types", "package": null, "version": null}, {"name": "adm_dh_metrics_grain", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.ref_time_periods", "model.CGOncology_MDM.ref_payor_types", "model.CGOncology_MDM.adm_dh_metrics_grain"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}, "model.CGOncology_MDM.adm_hco_master": {"database": "CGONCOLOGY_TEST", "schema": "ADM", "name": "adm_hco_master", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "adm/adm_hco_master.sql", "original_file_path": "models/adm/adm_hco_master.sql", "unique_id": "model.CGOncology_MDM.adm_hco_master", "fqn": ["CGOncology_MDM", "adm", "adm_hco_master"], "alias": "adm_hco_master", "checksum": {"name": "sha256", "checksum": "c110d46d2055851b9d49a8f0569a943650f9952f7fd4f22c1f1fed987f42277d"}, "config": {"enabled": true, "alias": null, "schema": "ADM", "database": null, "tags": ["layer_4_adm", "customer_backbone", "customer_backbone", "adm"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_4_adm", "customer_backbone", "adm"], "description": "Comprehensive HCO master with hierarchy, targets, territories, and metrics.\nBusiness Rules: HIR-001/002, SRV-003, BBN-001/002, TGT-003/010/011/020\nGrain: One row per kmk_hco_id\n", "columns": {"kmk_hco_id": {"name": "kmk_hco_id", "description": "KMK HCO identifier (primary key)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "dh_id": {"name": "dh_id", "description": "DHC organization ID (NULL for non-DHC sources)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "account_id": {"name": "account_id", "description": "Account identifier (same as kmk_hco_id for most)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "org_name": {"name": "org_name", "description": "Organization name (NULL for some edge cases)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "account_type": {"name": "account_type", "description": "Account type classification in P-priority format (quarterly frozen via adm_frozen_account_type)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "account_type_priority": {"name": "account_type_priority", "description": "Account type priority tier (P1=highest, P4=lowest; quarterly frozen via adm_frozen_account_type)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "hierarchy_level": {"name": "hierarchy_level", "description": "Hierarchy level (L1=Network Parent, L2=Network, L3=Account, L4=Practice Location)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "cust_backbone_flag": {"name": "cust_backbone_flag", "description": "Customer backbone flag (Y/N)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "network_target_flag": {"name": "network_target_flag", "description": "KAM Network target flag (1/0)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "child_target_flag": {"name": "child_target_flag", "description": "KAM Child target flag (1/0)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "kam_target_flag": {"name": "kam_target_flag", "description": "KAM target flag (Y/N)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "hsd_target_flag": {"name": "hsd_target_flag", "description": "HSD target flag (Y/N)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "msl_target_flag": {"name": "msl_target_flag", "description": "MSL target flag (Y/N)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/adm/schema.yml", "build_path": null, "unrendered_config": {"schema": "ADM", "materialized": "table", "tags": ["customer_backbone", "adm"]}, "created_at": 1770177079.584699, "relation_name": "CGONCOLOGY_TEST.ADM.adm_hco_master", "raw_code": "{{\n    config(\n        schema='ADM',\n        materialized='table',\n        tags=['customer_backbone', 'adm']\n    )\n}}\n\n/*\nPROC-ADM-003: adm_hco_master - Comprehensive HCO Master\nBusiness Rules: HIR-001/002, BBN-001/002/005, TGT-003/010/011/020\n\nSingle comprehensive view of all HCOs with:\n- Core identity and address from MDM\n- Hierarchy structure (L1-L4, parent relationships)\n- Backbone flag (BBN-005: parent propagation implemented)\n- Target flags (KAM, HSD, MSL) - Sourced from adm_sfe_hco_targets\n- PE/Network information\n- Enhanced dh_id inheritance: Practice locations without dh_id inherit from parent account\n\nGrain: One row per kmk_hco_id (~53 columns after 2026-02-02 cleanup)\n\nCOLUMNS REMOVED (2026-02-02 cleanup - denormalized/debug columns):\n- Source flags: source_dh, source_ddd, source_medscout, source_claims \u2192 get from mdm_customer_xref_hco\n- Account debug: account_type_source, primary_source\n- Territory: kam_territory/region, hsd_territory, msl_territory \u2192 APT joins std_zip_territory via ZIP\n- Metrics: bc_patient_count, target_version \u2192 get from source tables\n- HCP extra: total_hcp_count, backbone_hcp_count \u2192 get from mdm_best_affiliation\n- PE detail: pe_dh_id, pe_name \u2192 get from adm_hco_hierarchy\n\nQUARTERLY FREEZE (Jan 2026):\n  Normal runs: account_type and account_type_priority are frozen at the ACCOUNT LEVEL\n  from adm_frozen_account_type table (no family propagation - each account frozen individually).\n  Full refresh (--full-refresh): table join is skipped, all values computed fresh.\n*/\n\n-- Get data_date from ref_time_periods (single source of truth)\nWITH data_date_ref AS (\n    SELECT DISTINCT data_date\n    FROM {{ ref('ref_time_periods') }}\n    LIMIT 1\n),\n\nmaster AS (\n    -- Core HCO attributes from MDM, with NAE-enhanced network columns from ADM_HCO_HIERARCHY\n    -- NOTE: Includes both child accounts (L3/L4) and parent accounts (L1/L2) that are in MDM\n    -- NOTE: account_type is calculated later in automated_classification CTE, not from MDM\n    -- FIX 2026-01-16: Get network columns from adm_hco_hierarchy (has NAE enhancements) instead of MDM\n    SELECT\n        m.kmk_hco_id,\n        m.dh_id,\n        m.org_name,\n        m.firm_type,\n        m.hq_address_line_1,\n        m.hq_address_line_2,\n        m.hq_city,\n        m.hq_state,\n        m.hq_zip_code,\n        CASE WHEN m.ddd_outlet_count > 0 THEN 'Y' ELSE 'N' END AS has_ddd_match,  -- Derived from DDD_OUTLET_COUNT\n        -- Network columns from hierarchy (NAE-enhanced) with fallback to MDM\n        COALESCE(h.network_id, m.network_id) AS network_id,\n        COALESCE(h.network_name, m.network_name) AS network_name,\n        COALESCE(h.network_firm_type, m.network_firm_type) AS network_firm_type,\n        COALESCE(h.network_parent_id, m.network_parent_id) AS network_parent_id,\n        COALESCE(h.network_parent_name, m.network_parent_name) AS network_parent_name,\n        COALESCE(h.network_parent_firm_type, m.network_parent_firm_type) AS network_parent_firm_type,\n        m.hospital_type,  -- Used in account type classification (ACD-005, CCC)\n        m.primary_source,\n        m.primary_specialty\n    FROM {{ ref('mdm_customer_master_hco') }} m\n    LEFT JOIN {{ ref('adm_hco_hierarchy') }} h ON m.kmk_hco_id = h.kmk_hco_id\n),\n\n-- Parent accounts from hierarchy that are NOT in MDM (explicit inclusion)\nparent_accounts_from_hierarchy AS (\n    SELECT\n        h.kmk_hco_id,\n        h.dh_id,\n        h.org_name,\n        h.firm_type,\n        NULL AS hq_address_line_1,\n        NULL AS hq_address_line_2,\n        NULL AS hq_city,\n        h.hq_state,\n        h.hq_zip_code,\n        h.has_ddd_match,\n        h.network_id,\n        h.network_name,\n        h.network_firm_type,\n        h.network_parent_id,\n        h.network_parent_name,\n        h.network_parent_firm_type,\n        NULL AS hospital_type,  -- Used in account type classification (ACD-005, CCC)\n        'HIERARCHY' AS primary_source,\n        NULL AS primary_specialty\n    FROM {{ ref('adm_hco_hierarchy') }} h\n    WHERE h.hierarchy_level IN ('L1', 'L2')\n      AND NOT EXISTS (\n          SELECT 1 FROM {{ ref('mdm_customer_master_hco') }} m\n          WHERE m.kmk_hco_id = h.kmk_hco_id\n      )\n),\n\n-- Combine MDM accounts with any parent accounts from hierarchy not in MDM\nall_accounts AS (\n    SELECT * FROM master\n    UNION ALL\n    SELECT * FROM parent_accounts_from_hierarchy\n),\n\nhierarchy AS (\n    -- Use pre-computed columns from adm_hco_hierarchy (2026-01-18 Simplification)\n    -- parent_account_id and ultimate_parent_id are now computed in the hierarchy model\n    SELECT\n        h.kmk_hco_id,\n        h.account_id,\n        h.hierarchy_level,\n        h.account_id_l1,\n        h.account_id_l2,\n        h.account_id_l3,\n        h.account_id_l4,\n        h.pe_dh_id,\n        h.pe_name,\n        h.pe_flag,\n        h.parent_account_id,      -- Pre-computed in hierarchy\n        h.ultimate_parent_id      -- Pre-computed in hierarchy (family_key)\n    FROM {{ ref('adm_hco_hierarchy') }} h\n),\n\n-- source_flags CTE removed (2026-02-02 cleanup) - get from mdm_customer_xref_hco if needed\n\nbc_metrics AS (\n    -- BC patient metrics from ADM claims metrics (aggregated by kmk_hco_id)\n    -- UPDATED: Now sourced from adm_claims_metrics_long instead of stg_hco_bc_metrics\n    -- Uses BC_DIAGNOSIS category from adm_claims_metrics_long (TOTAL period)\n    -- Aggregated by kmk_hco_id (entity_id) for each account\n    SELECT\n        entity_id AS kmk_hco_id,\n        MAX(CASE WHEN metric_category = 'BC_DIAGNOSIS' AND period_key = 'TOTAL' THEN patient_count ELSE 0 END) AS bc_patient_count,\n        MAX(CASE WHEN metric_category = 'BC_DIAGNOSIS' AND period_key = 'TOTAL' THEN claim_count ELSE 0 END) AS bc_claim_count,  -- Used in account_ranking for tie-breaking\n        CASE \n            WHEN MAX(CASE WHEN metric_category = 'BC_DIAGNOSIS' AND period_key = 'TOTAL' THEN claim_count ELSE 0 END) > 0 THEN 'Y'\n            ELSE 'N'\n        END AS source_claims\n    FROM {{ ref('adm_claims_metrics_long') }}\n    WHERE entity_type = 'HCO'\n      AND metric_category = 'BC_DIAGNOSIS'\n      AND period_key = 'TOTAL'\n    GROUP BY entity_id\n),\n\nnetwork_bc_metrics AS (\n    -- Aggregate BC patients at network level for NAC-004\n    -- If ANY HCO in network has BC patients, all members qualify\n    SELECT\n        m.network_id,\n        SUM(COALESCE(bc.bc_patient_count, 0)) AS network_bc_patient_count\n    FROM all_accounts m\n    LEFT JOIN bc_metrics bc ON m.kmk_hco_id = bc.kmk_hco_id\n    WHERE m.network_id IS NOT NULL\n    GROUP BY m.network_id\n),\n\n-- NMIBC Risk Tier Metrics removed - not used in final output\n-- Get from adm_hco_nmibc_metrics if needed\n\n-- SFE: Targets (Consolidated Source)\n-- NOTE: Hardcoded reference to existing ADM table (SFE models disabled in dbt_project.yml)\nsfe_targets AS (\n    SELECT\n        kmk_hco_id,\n        kam_network_target_flag,\n        kam_network_decile,\n        kam_child_target_flag,\n        kam_child_decile,\n        hsd_target_flag,\n        hsd_rank,\n        msl_target_flag\n        -- target_version removed (2026-02-02 cleanup)\n        -- kam_network_composite_score, kam_child_composite_score not in source table\n    FROM {{ target.database }}.ADM.adm_sfe_hco_targets\n    WHERE target_version = '{{ var(\"sfe_version\") }}'\n),\n\n-- sfe_territory CTE removed (2026-02-02 cleanup) - APT joins std_zip_territory directly via ZIP\n\ntreatment_metrics AS (\n    -- Treatment claims metrics from ADM using pre-computed rolling periods\n    -- NOTE: Parent account metrics use account_id_l1/account_id_l2 as entity_id in adm_claims_metrics_long\n    -- For parent accounts, account_id_l1/account_id_l2 = kmk_hco_id, so the join works correctly\n    -- UPDATED: Only pull L24M metrics (24-month period) - used for backbone flag and source_claims\n    SELECT\n        entity_id AS kmk_hco_id,\n        -- L24M for backbone flag (24-month period, consistent with DDD sales 24mo)\n        MAX(CASE WHEN metric_category = 'TURBT' AND period_key = 'L24M' THEN claim_count ELSE 0 END) AS l24m_turbt_claims,\n        MAX(CASE WHEN metric_category = 'TICE_BCG' AND period_key = 'L24M' THEN claim_count ELSE 0 END) AS l24m_tice_bcg_claims,\n        MAX(CASE WHEN metric_category = 'ADSTILADRIN' AND period_key = 'L24M' THEN claim_count ELSE 0 END) AS l24m_adstiladrin_claims,\n        MAX(CASE WHEN metric_category = 'ANKTIVA' AND period_key = 'L24M' THEN claim_count ELSE 0 END) AS l24m_anktiva_claims,\n        MAX(CASE WHEN metric_category = 'KEYTRUDA' AND period_key = 'L24M' THEN claim_count ELSE 0 END) AS l24m_keytruda_claims\n    FROM {{ ref('adm_claims_metrics_long') }}\n    WHERE entity_type = 'HCO'\n      AND period_key = 'L24M'\n    GROUP BY entity_id\n),\n\nddd_sales AS (\n    -- DDD sales metrics (only used column: total_branded_sales_24mo for backbone flag)\n    -- FIX 2026-01-19: Use L24M_SALES from TOTAL_BRANDED metric_category (LTD columns removed)\n    SELECT\n        kmk_hco_id,\n        L24M_SALES AS total_branded_sales_24mo\n    FROM {{ ref('adm_ddd_metrics_wide') }}\n    WHERE metric_category = 'TOTAL_BRANDED'\n),\n\n-- =============================================================================\n-- COMPOSITE SCORE for Account Ranking (mirrors hcp_decile.sql methodology)\n-- Min-max standardization + weighted composite: internal to ranking only\n-- Formula: (std_bc_patients * 0.10) + (std_bcg_claims * 0.45) + (std_turbt_claims * 0.45)\n-- =============================================================================\nmetrics_stats AS (\n    -- Min/max of the 3 metrics across all HCOs for min-max standardization\n    SELECT\n        MIN(COALESCE(bc.bc_patient_count, 0)) AS min_bc_patients,\n        MAX(COALESCE(bc.bc_patient_count, 0)) AS max_bc_patients,\n        MIN(COALESCE(tm.l24m_tice_bcg_claims, 0)) AS min_bcg_claims,\n        MAX(COALESCE(tm.l24m_tice_bcg_claims, 0)) AS max_bcg_claims,\n        MIN(COALESCE(tm.l24m_turbt_claims, 0)) AS min_turbt_claims,\n        MAX(COALESCE(tm.l24m_turbt_claims, 0)) AS max_turbt_claims\n    FROM all_accounts a\n    LEFT JOIN bc_metrics bc ON a.kmk_hco_id = bc.kmk_hco_id\n    LEFT JOIN treatment_metrics tm ON a.kmk_hco_id = tm.kmk_hco_id\n),\n\ncomposite_scores AS (\n    -- Per-HCO composite score using min-max standardized metrics\n    SELECT\n        a.kmk_hco_id,\n        (\n            -- Standardized BC patients (weight 0.10)\n            CASE\n                WHEN s.max_bc_patients = s.min_bc_patients THEN 0\n                ELSE (COALESCE(bc.bc_patient_count, 0) - s.min_bc_patients)::FLOAT\n                     / (s.max_bc_patients - s.min_bc_patients)\n            END * 0.10\n            +\n            -- Standardized BCG claims (weight 0.45)\n            CASE\n                WHEN s.max_bcg_claims = s.min_bcg_claims THEN 0\n                ELSE (COALESCE(tm.l24m_tice_bcg_claims, 0) - s.min_bcg_claims)::FLOAT\n                     / (s.max_bcg_claims - s.min_bcg_claims)\n            END * 0.45\n            +\n            -- Standardized TURBT claims (weight 0.45)\n            CASE\n                WHEN s.max_turbt_claims = s.min_turbt_claims THEN 0\n                ELSE (COALESCE(tm.l24m_turbt_claims, 0) - s.min_turbt_claims)::FLOAT\n                     / (s.max_turbt_claims - s.min_turbt_claims)\n            END * 0.45\n        ) AS composite_score\n    FROM all_accounts a\n    CROSS JOIN metrics_stats s\n    LEFT JOIN bc_metrics bc ON a.kmk_hco_id = bc.kmk_hco_id\n    LEFT JOIN treatment_metrics tm ON a.kmk_hco_id = tm.kmk_hco_id\n),\n\n-- BBN-012: Accounts with activity data (account updates/profile data)\n-- FIX 2026-01-31: Include accounts that have sales activity or profile assessment records\n-- These accounts are being actively worked by sales team and should be in the backbone\n-- NOTE: 7000000xxx manual accounts are excluded here (handled separately via seed_manual_hco_accounts in APT)\n-- SOURCE: Using PROD directly for activity data (live data from APT application)\naccount_activity AS (\n    -- Account updates (daily activity tracking)\n    SELECT DISTINCT\n        account_kmk_id AS kmk_hco_id,\n        'Y' AS has_activity\n    FROM CGONCOLOGY_PROD.REVERSE_APT.DAILY_ACCOUNT_UPDATES\n    WHERE account_kmk_id IS NOT NULL\n      AND account_kmk_id NOT LIKE '7%'  -- Manual accounts handled separately in APT\n\n    UNION\n\n    -- Account profile assessments (HSD profiling)\n    -- Note: PROD table name is AP_ASSESSMENT_RESPONSES (different from DEV naming)\n    SELECT DISTINCT\n        kmk_id AS kmk_hco_id,\n        'Y' AS has_activity\n    FROM CGONCOLOGY_PROD.REPORTING.AP_ASSESSMENT_RESPONSES\n    WHERE kmk_id IS NOT NULL\n      AND kmk_id NOT LIKE '7%'  -- Manual accounts handled separately in APT\n),\n\nhcp_profile AS (\n    -- HCP-based profile metrics (merged from adm_hco_profile)\n    -- FIX 2026-01-12 (BBN-010): Use CUST_BACKBONE_FLAG from ADM_HCP_MASTER instead of BC_BACKBONE_FLAG\n    -- CUST_BACKBONE_FLAG requires affiliation, which matches the business rule for HCO backbone propagation\n    -- PRF-001: urologist_count uses IS_UROLOGIST flag (excludes Neurology false positives per BBN-011)\n    -- FIX 2026-02-02: urologist_w_claims changed from lifetime to L12M timeframe\n    SELECT\n        aff.best_kmk_hco_id AS kmk_hco_id,\n        COUNT(DISTINCT CASE WHEN bcm.IS_UROLOGIST = 'Y' THEN hcp.npi END) AS urologist_count,\n        COUNT(DISTINCT CASE WHEN bcm.IS_UROLOGIST = 'Y' AND l12m.entity_id IS NOT NULL THEN hcp.npi END) AS urologist_w_claims,\n        COUNT(DISTINCT hcp.npi) AS total_hcp_count,\n        COUNT(DISTINCT CASE WHEN hcp.cust_backbone_flag = 'Y' THEN hcp.npi END) AS backbone_hcp_count\n    FROM {{ ref('mdm_best_affiliation_hist') }} aff\n    LEFT JOIN {{ ref('adm_hcp_master') }} hcp ON aff.kmk_hcp_id = hcp.kmk_hcp_id\n    LEFT JOIN {{ ref('stg_hcp_bc_metrics') }} bcm ON hcp.npi = bcm.npi\n    LEFT JOIN (\n        SELECT DISTINCT entity_id\n        FROM {{ ref('adm_claims_metrics_long') }}\n        WHERE entity_type = 'HCP'\n          AND period_key = 'L12M'\n          AND patient_count > 0\n    ) l12m ON hcp.kmk_hcp_id = l12m.entity_id\n    WHERE aff.is_current = 'Y'\n      AND aff.best_kmk_hco_id IS NOT NULL\n    GROUP BY aff.best_kmk_hco_id\n),\n\n-- Rollup urologists including all descendant HCOs in hierarchy\n-- Used for Physician Group LUGPA classification (LUG-001)\n-- OPTIMIZED: Uses UNION ALL instead of OR join for better Snowflake performance\nhcp_profile_rollup AS (\n    SELECT\n        parent_id AS kmk_hco_id,\n        SUM(COALESCE(urologist_count, 0)) AS urologist_count_total,\n        SUM(COALESCE(urologist_w_claims, 0)) AS urologist_w_claims_total\n    FROM (\n        -- L1 aggregation: All HCOs that have this as L1 parent\n        SELECT h.account_id_l1 AS parent_id, hp.urologist_count, hp.urologist_w_claims\n        FROM {{ ref('adm_hco_hierarchy') }} h\n        LEFT JOIN hcp_profile hp ON h.kmk_hco_id = hp.kmk_hco_id\n        WHERE h.account_id_l1 IS NOT NULL\n\n        UNION ALL\n\n        -- L2 aggregation: All HCOs that have this as L2 parent (excluding L1 self-refs)\n        SELECT h.account_id_l2 AS parent_id, hp.urologist_count, hp.urologist_w_claims\n        FROM {{ ref('adm_hco_hierarchy') }} h\n        LEFT JOIN hcp_profile hp ON h.kmk_hco_id = hp.kmk_hco_id\n        WHERE h.account_id_l2 IS NOT NULL\n          AND h.account_id_l2 != h.account_id_l1\n\n        UNION ALL\n\n        -- L3 aggregation: All HCOs that have this as L3 parent (excluding L1/L2 self-refs)\n        SELECT h.account_id_l3 AS parent_id, hp.urologist_count, hp.urologist_w_claims\n        FROM {{ ref('adm_hco_hierarchy') }} h\n        LEFT JOIN hcp_profile hp ON h.kmk_hco_id = hp.kmk_hco_id\n        WHERE h.account_id_l3 IS NOT NULL\n          AND h.account_id_l3 != COALESCE(h.account_id_l2, h.account_id_l1)\n    ) rolled_up\n    GROUP BY parent_id\n),\n\n-- network_urologist_metrics removed - redundant with hcp_profile_rollup (L1-L4 rollup covers network aggregation)\n-- mso_affiliation_metrics removed - redundant with hcp_profile_rollup (L1-L4 rollup covers hierarchy aggregation)\n\n-- =============================================================================\n-- ACCOUNT TYPE CLASSIFICATION (Section 5.8 Business Rules)\n-- NO NULL VALUES - every HCO gets classified\n-- =============================================================================\n\n-- Step 1: Automated classification (default = SMALL INDEPENDENT CENTER)\nautomated_classification AS (\n    SELECT\n        m.kmk_hco_id,\n        m.dh_id,\n        m.network_id,\n        m.network_parent_id,\n        m.org_name,\n        m.network_name,\n        CASE\n            -- FEDERAL (Order 1)\n            WHEN m.network_parent_name IN ('Defense Health Agency', 'Department of Veterans Affairs')\n            THEN 'FEDERAL'\n            -- LUGPA (Order 2) - LUG-001: Physician Group + Urology specialty + 10+ urologists (total including children)\n            -- Requires primary_specialty = 'Urology' to exclude multi-specialty groups like Mayo/Cleveland Clinic\n            -- Uses urologist_count_total (rollup) for PG since they often have multiple practice locations\n            WHEN m.firm_type = 'Physician Group'\n                 AND m.primary_specialty = 'Urology'\n                 AND COALESCE(hp_rollup.urologist_count_total, hp.urologist_count, 0) >= 10\n            THEN 'LUGPA'\n            -- LUGPA (Order 2) - LUG-004: MSO with urology indicator + 10+ urologists (direct count only)\n            WHEN m.firm_type = 'Management Services Organization'\n                 AND ((m.org_name ILIKE '%urology%' AND m.org_name NOT ILIKE '%neurology%')\n                      OR m.primary_specialty = 'Urology')\n                 AND COALESCE(hp.urologist_count, 0) >= 10\n            THEN 'LUGPA'\n            -- LUGPA (Order 2) - LUG-002: Org name contains 'urology' + specialty = 'Urology' + 10+ urologists (direct count only)\n            -- Per original spec: name 'Urology' AND (main specialty OR other specialty = 'Urology')\n            WHEN m.org_name ILIKE '%urology%' AND m.org_name NOT ILIKE '%neurology%'\n                 AND m.primary_specialty = 'Urology'\n                 AND COALESCE(hp.urologist_count, 0) >= 10\n            THEN 'LUGPA'\n            -- LUGPA (Order 2) - LUG-003: Urology indicator + 5-9 urologists + BC volume > 100 (direct count only)\n            WHEN ((m.org_name ILIKE '%urology%' AND m.org_name NOT ILIKE '%neurology%')\n                  OR m.primary_specialty = 'Urology')\n                 AND COALESCE(hp.urologist_count, 0) BETWEEN 5 AND 9\n                 AND COALESCE(bc.bc_patient_count, 0) > 100\n            THEN 'LUGPA'\n            -- ACADEMIC (Order 3) - ACD-001 through ACD-005\n            WHEN (\n                -- Original logic (ACD-001/002/003): org_name OR network_name keywords + firm_type\n                ((m.org_name ILIKE ANY ('%University%', '%School%', '%College%', '%Institute%', '%Research%')\n                  OR m.network_name ILIKE ANY ('%University%', '%School%', '%College%', '%Institute%', '%Research%'))\n                 AND m.firm_type IN ('Hospital', 'Health System'))\n                -- ACD-004: network_parent_name check\n                OR (m.network_parent_name ILIKE ANY ('%University%', '%School%', '%College%', '%Institute%', '%Research%')\n                    AND m.firm_type IN ('Hospital', 'Health System'))\n                -- ACD-005: hospital_type academic indicator\n                OR m.hospital_type ILIKE ANY ('%Academic%', '%Faculty Practice%')\n            )\n            THEN 'ACADEMIC HEALTH SYSTEM'\n            -- CCC (Order 4)\n            WHEN (m.firm_type ILIKE '%Payor%' OR m.hospital_type ILIKE '%Payor%')\n                 AND (m.network_firm_type = 'Health System' OR m.network_parent_firm_type = 'Health System')\n            THEN 'COMPREHENSIVE CARE CENTER'\n            -- NON-ACADEMIC (Order 5) - NAC-001 + NAC-004 (network-level)\n            WHEN (m.firm_type = 'Health System'\n                  OR m.network_firm_type = 'Health System'\n                  OR m.network_parent_firm_type = 'Health System')\n                 AND (COALESCE(bc.bc_patient_count, 0) > 0\n                      OR COALESCE(nbc.network_bc_patient_count, 0) > 0)  -- NAC-004: Individual OR network BC\n            THEN 'NON ACADEMIC HEALTH SYSTEM'\n            -- SMALL INDEPENDENT (Order 6 - DEFAULT, never NULL)\n            ELSE 'SMALL INDEPENDENT CENTER'\n        END AS account_type_auto\n    FROM all_accounts m\n    LEFT JOIN hcp_profile hp ON m.kmk_hco_id = hp.kmk_hco_id\n    LEFT JOIN hcp_profile_rollup hp_rollup ON m.kmk_hco_id = hp_rollup.kmk_hco_id\n    LEFT JOIN bc_metrics bc ON m.kmk_hco_id = bc.kmk_hco_id\n    LEFT JOIN network_bc_metrics nbc ON m.network_id = nbc.network_id\n),\n\n-- =============================================================================\n-- ACCOUNT TYPE CLASSIFICATION - SIMPLIFIED CASCADE APPROACH (2026-01-18 Refactor)\n-- =============================================================================\n-- DESIGN: Use single family_key to propagate account types\n-- family_key = COALESCE(account_id_l1, account_id_l2, account_id_l3, account_id)\n-- This groups accounts by their highest common ancestor for propagation\n--\n-- FLOW:\n-- 1. Base classification (identify direct types from rules)\n-- 2. Manual overrides (apply business input overrides)\n-- 3. Family propagation (propagate best type to entire family)\n-- 4. Derive business priority (P1-P4)\n-- =============================================================================\n\n-- Step 1: Add priority to base classification\nautomated_with_priority AS (\n    SELECT\n        ac.*,\n        CASE ac.account_type_auto\n            WHEN 'FEDERAL' THEN 1\n            WHEN 'LUGPA' THEN 2\n            WHEN 'ACADEMIC HEALTH SYSTEM' THEN 3\n            WHEN 'COMPREHENSIVE CARE CENTER' THEN 4\n            WHEN 'NON ACADEMIC HEALTH SYSTEM' THEN 5\n            ELSE 6\n        END AS account_type_auto_priority\n    FROM automated_classification ac\n),\n\n-- Step 2: Manual override table (deduplicated)\naccount_type_override_dedup AS (\n    SELECT\n        CAST(dh_id AS VARCHAR) AS dh_id,\n        account_type,\n        CASE account_type\n            WHEN 'FEDERAL' THEN 1\n            WHEN 'LUGPA' THEN 2\n            WHEN 'ACADEMIC HEALTH SYSTEM' THEN 3\n            WHEN 'COMPREHENSIVE CARE CENTER' THEN 4\n            WHEN 'NON ACADEMIC HEALTH SYSTEM' THEN 5\n            ELSE 6\n        END AS account_type_priority\n    FROM {{ ref('account_type_business_input') }}\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY dh_id ORDER BY account_type) = 1\n),\n\n-- Step 3: Apply manual overrides (only upgrades)\nwith_manual_override AS (\n    SELECT\n        ac.kmk_hco_id,\n        ac.dh_id,\n        ac.network_id,\n        ac.network_parent_id,\n        -- Apply manual override if it's an UPGRADE (lower priority = higher)\n        CASE\n            WHEN ao_direct.account_type IS NOT NULL AND ao_direct.account_type_priority < ac.account_type_auto_priority\n            THEN ao_direct.account_type\n            WHEN ao_network.account_type IS NOT NULL AND ao_network.account_type_priority < ac.account_type_auto_priority\n            THEN ao_network.account_type\n            WHEN ao_parent.account_type IS NOT NULL AND ao_parent.account_type_priority < ac.account_type_auto_priority\n            THEN ao_parent.account_type\n            ELSE ac.account_type_auto\n        END AS base_account_type,\n        CASE\n            WHEN ao_direct.account_type IS NOT NULL AND ao_direct.account_type_priority < ac.account_type_auto_priority\n            THEN 'MANUAL_DIRECT'\n            WHEN ao_network.account_type IS NOT NULL AND ao_network.account_type_priority < ac.account_type_auto_priority\n            THEN 'MANUAL_NETWORK'\n            WHEN ao_parent.account_type IS NOT NULL AND ao_parent.account_type_priority < ac.account_type_auto_priority\n            THEN 'MANUAL_PARENT'\n            ELSE 'AUTOMATED'\n        END AS base_type_source,\n        CASE\n            WHEN ao_direct.account_type IS NOT NULL AND ao_direct.account_type_priority < ac.account_type_auto_priority\n            THEN ao_direct.account_type_priority\n            WHEN ao_network.account_type IS NOT NULL AND ao_network.account_type_priority < ac.account_type_auto_priority\n            THEN ao_network.account_type_priority\n            WHEN ao_parent.account_type IS NOT NULL AND ao_parent.account_type_priority < ac.account_type_auto_priority\n            THEN ao_parent.account_type_priority\n            ELSE ac.account_type_auto_priority\n        END AS base_priority\n    FROM automated_with_priority ac\n    LEFT JOIN account_type_override_dedup ao_direct ON CAST(ac.dh_id AS VARCHAR) = ao_direct.dh_id\n    LEFT JOIN account_type_override_dedup ao_network ON CAST(ac.network_id AS VARCHAR) = ao_network.dh_id\n    LEFT JOIN account_type_override_dedup ao_parent ON CAST(ac.network_parent_id AS VARCHAR) = ao_parent.dh_id\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY ac.kmk_hco_id ORDER BY\n        CASE\n            WHEN ao_direct.account_type IS NOT NULL THEN 1\n            WHEN ao_network.account_type IS NOT NULL THEN 2\n            WHEN ao_parent.account_type IS NOT NULL THEN 3\n            ELSE 4\n        END\n    ) = 1\n),\n\n-- =============================================================================\n-- FAMILY PROPAGATION (2026-01-18 Simplification)\n-- =============================================================================\n-- Uses pre-computed ultimate_parent_id from adm_hco_hierarchy (no recursive CTE needed)\n-- ultimate_parent_id = COALESCE(account_id_l1, account_id_l2, account_id_l3, account_id)\n-- This groups accounts by their highest common ancestor for type propagation\n-- =============================================================================\n\n-- Step 4: Find best type in each family (using pre-computed ultimate_parent_id)\nfamily_best AS (\n    SELECT\n        h.ultimate_parent_id AS family_id,\n        wmo.base_account_type AS best_type,\n        MIN(wmo.base_priority) AS best_priority\n    FROM with_manual_override wmo\n    LEFT JOIN {{ ref('adm_hco_hierarchy') }} h ON wmo.kmk_hco_id = h.kmk_hco_id\n    WHERE wmo.base_account_type != 'SMALL INDEPENDENT CENTER'\n      AND h.ultimate_parent_id IS NOT NULL\n    GROUP BY h.ultimate_parent_id, wmo.base_account_type\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY h.ultimate_parent_id ORDER BY MIN(wmo.base_priority)) = 1\n),\n\n-- Step 5: Apply family propagation (single step - all accounts in same tree get same type)\nfinal_classification AS (\n    SELECT\n        wmo.kmk_hco_id,\n        CASE\n            WHEN fb.best_type IS NOT NULL AND fb.best_priority < wmo.base_priority\n            THEN fb.best_type\n            ELSE wmo.base_account_type\n        END AS account_type,\n        CASE\n            WHEN fb.best_type IS NOT NULL AND fb.best_priority < wmo.base_priority\n            THEN 'FAMILY_PROP'\n            ELSE wmo.base_type_source\n        END AS account_type_source\n    FROM with_manual_override wmo\n    LEFT JOIN {{ ref('adm_hco_hierarchy') }} h ON wmo.kmk_hco_id = h.kmk_hco_id\n    LEFT JOIN family_best fb ON h.ultimate_parent_id = fb.family_id\n),\n\n-- Step 7: Derive business priority (P1-P4)\nwith_priority AS (\n    SELECT\n        fc.kmk_hco_id,\n        fc.account_type,\n        fc.account_type_source,\n        CASE fc.account_type\n            WHEN 'LUGPA' THEN 'P1'\n            WHEN 'ACADEMIC HEALTH SYSTEM' THEN 'P2'\n            WHEN 'NON ACADEMIC HEALTH SYSTEM' THEN 'P2'\n            WHEN 'FEDERAL' THEN 'P3'\n            WHEN 'COMPREHENSIVE CARE CENTER' THEN 'P3'\n            ELSE 'P4'  -- SMALL INDEPENDENT CENTER\n        END AS account_type_priority\n    FROM final_classification fc\n),\n\n-- =============================================================================\n-- ACCOUNT RANKING (Based on APT_V2.sql logic)\n-- Step 1: Define NETWORK_ACCOUNT vs CHILD_SITE based on hierarchy level + account type\n-- Step 2: Calculate ranks within each universe\n-- =============================================================================\naccount_ranking AS (\n    SELECT\n        m.kmk_hco_id,\n        h.hierarchy_level,\n        h.account_id_l1,\n        wp.account_type,\n        wp.account_type_priority,\n        m.firm_type,\n        -- Composite score from min-max standardization (used as primary ranking key)\n        COALESCE(cs.composite_score, 0) AS composite_score,\n        tgt.kam_network_decile,\n        tgt.kam_child_decile,\n\n        -- NETWORK_ACCOUNT flag (APT_V2 t5 logic):\n        -- L2 = Network Account\n        -- L3 + P1_LUGPA = Network Account (LUGPA at L3 is still network-level)\n       CASE\n        WHEN tgt.kam_network_target_flag = 'Y' THEN 'Y'\n        WHEN h.hierarchy_level = 'L2' THEN 'Y'\n        WHEN h.hierarchy_level = 'L3' AND wp.account_type = 'LUGPA' THEN 'Y'\n        ELSE 'N'\n        END AS network_account_flag,\n\n        CASE\n            WHEN tgt.kam_child_target_flag = 'Y' THEN 'Y'\n            WHEN h.hierarchy_level = 'L4' THEN 'Y'\n            WHEN h.hierarchy_level = 'L3' AND wp.account_type != 'LUGPA' THEN 'Y'\n            ELSE 'N'\n        END AS child_site_flag,\n\n        -- Metrics for tie-breaking (same approach as APT_V2)\n        -- UPDATED: Use L24M for consistency\n        COALESCE(tm.l24m_tice_bcg_claims, 0) AS tice_bcg_claims,\n        COALESCE(tm.l24m_turbt_claims, 0) AS turbt_claims,\n        COALESCE(bc.bc_claim_count, 0) AS bc_diagnosis_claims,\n        COALESCE(bc.bc_patient_count, 0) AS bc_diagnosis_patients,\n        COALESCE(ds.total_branded_sales_24mo, 0) AS ddd_tice_bcg_sales,\n\n        -- OTHER_SCORE: Weighted composite for tie-breaking (APT_V2 t2)\n        -- Federal: 0.5*TURBT + 0.5*BC_CLAIMS; Non-Federal: 0.8*DDD + 0.1*TURBT + 0.1*BC_PTS\n        CASE\n            WHEN wp.account_type = 'P3_ FEDERAL' THEN\n                (0.5 * COALESCE(tm.l24m_turbt_claims, 0)) +\n                (0.5 * COALESCE(bc.bc_claim_count, 0))\n            ELSE\n                (0.8 * COALESCE(ds.total_branded_sales_24mo, 0)) +\n                (0.1 * COALESCE(tm.l24m_turbt_claims, 0)) +\n                (0.1 * COALESCE(bc.bc_patient_count, 0))\n        END AS other_score,\n\n        -- TARGET_PRIORITY: 1 if KAM target, else 2 (APT_V2 t5)\n        CASE\n            WHEN tgt.kam_network_target_flag = 'Y' OR tgt.kam_child_target_flag = 'Y'\n            THEN 1 ELSE 2\n        END AS target_priority,\n\n        -- TARGETABLE_ACCOUNT_PRIORITY: 1 if in any target list, else 2 (APT_V2 t4/t5)\n        CASE\n            WHEN tgt.kam_network_target_flag = 'Y'\n              OR tgt.kam_child_target_flag = 'Y'\n              OR tgt.hsd_target_flag = 'Y'\n              OR tgt.msl_target_flag = 'Y'\n            THEN 1 ELSE 2\n        END AS targetable_account_priority,\n\n        -- Numeric account type priority (APT_V2 t5)\n        CASE wp.account_type\n            WHEN 'P1_LUGPA' THEN 1\n            WHEN 'P2_ACADEMIC' THEN 2\n            WHEN 'P2_NON-ACADEMIC' THEN 2\n            WHEN 'P3_CCS' THEN 3\n            WHEN 'P3_ FEDERAL' THEN 3\n            ELSE 4\n        END AS acct_type_priority_num,\n\n        -- Numeric firm type priority (APT_V2 t5)\n        CASE m.firm_type\n            WHEN 'HOSPITAL' THEN 1\n            WHEN 'PHYSICIAN_GROUP' THEN 2\n            ELSE 3\n        END AS firm_type_priority_num\n\n    FROM all_accounts m\n    LEFT JOIN hierarchy h ON m.kmk_hco_id = h.kmk_hco_id\n    LEFT JOIN with_priority wp ON m.kmk_hco_id = wp.kmk_hco_id\n    LEFT JOIN sfe_targets tgt ON m.kmk_hco_id = tgt.kmk_hco_id\n    LEFT JOIN treatment_metrics tm ON m.kmk_hco_id = tm.kmk_hco_id\n    LEFT JOIN bc_metrics bc ON m.kmk_hco_id = bc.kmk_hco_id\n    LEFT JOIN ddd_sales ds ON m.kmk_hco_id = ds.kmk_hco_id\n    LEFT JOIN composite_scores cs ON m.kmk_hco_id = cs.kmk_hco_id\n),\n\n-- Step 2: Calculate ranks within each universe\naccount_ranking_final AS (\n    SELECT\n        ar.kmk_hco_id,\n        ar.network_account_flag,\n        ar.child_site_flag,\n        ar.account_id_l1,\n\n        -- Network Rank: Calculated ONLY for network accounts (NETWORK_ACCOUNT='Y')\n        -- ORDER BY aligned with APT_V2 t7 logic: composite_score first, then decile\n        CASE\n            WHEN ar.network_account_flag = 'Y'\n            THEN DENSE_RANK() OVER (\n                PARTITION BY (CASE WHEN ar.network_account_flag = 'Y' THEN 1 ELSE 0 END)\n                ORDER BY\n                    ar.composite_score DESC NULLS LAST,    -- Primary: min-max standardized composite\n                    ar.kam_network_decile DESC NULLS LAST,\n                    ar.target_priority,                    -- APT_V2: target sites rank higher\n                    ar.targetable_account_priority,        -- APT_V2: targetable accounts rank higher\n                    ar.other_score DESC,                   -- APT_V2: weighted composite score\n                    ar.ddd_tice_bcg_sales DESC,\n                    ar.turbt_claims DESC,\n                    ar.bc_diagnosis_claims DESC,\n                    ar.acct_type_priority_num,             -- APT_V2: P1 > P2 > P3 > P4\n                    ar.firm_type_priority_num,             -- APT_V2: Hospital > PG > Other\n                    ar.kmk_hco_id\n            )\n            ELSE NULL\n        END AS network_rank,\n\n        -- Child Rank: Calculated ONLY for child sites (CHILD_SITE='Y')\n        -- ORDER BY aligned with APT_V2 t14 logic: composite_score first, then decile\n        CASE\n            WHEN ar.child_site_flag = 'Y'\n            THEN DENSE_RANK() OVER (\n                PARTITION BY ar.account_id_l1, (CASE WHEN ar.child_site_flag = 'Y' THEN 1 ELSE 0 END)\n                ORDER BY\n                    ar.composite_score DESC NULLS LAST,    -- Primary: min-max standardized composite\n                    ar.kam_child_decile DESC NULLS LAST,\n                    ar.target_priority,                    -- APT_V2: target sites rank higher\n                    ar.targetable_account_priority,        -- APT_V2: targetable accounts rank higher\n                    ar.other_score DESC,                   -- APT_V2: weighted composite score\n                    ar.ddd_tice_bcg_sales DESC,\n                    ar.turbt_claims DESC,\n                    ar.bc_diagnosis_claims DESC,\n                    ar.acct_type_priority_num,             -- APT_V2: P1 > P2 > P3 > P4\n                    ar.firm_type_priority_num,             -- APT_V2: Hospital > PG > Other\n                    ar.kmk_hco_id\n            )\n            ELSE NULL\n        END AS child_rank\n\n    FROM account_ranking ar\n),\n\n-- Parent address lookup: Get addresses from parent or ultimate parent accounts for fallback\n-- Try parent first, then ultimate parent if parent doesn't have address\n-- Also get parent's dh_id for practice location inheritance\nparent_addresses AS (\n    SELECT\n        h.kmk_hco_id,\n        COALESCE(parent.hq_address_line_1, ultimate_parent.hq_address_line_1) AS parent_hq_address_line_1,\n        COALESCE(parent.hq_address_line_2, ultimate_parent.hq_address_line_2) AS parent_hq_address_line_2,\n        COALESCE(parent.hq_city, ultimate_parent.hq_city) AS parent_hq_city,\n        COALESCE(parent.hq_state, ultimate_parent.hq_state) AS parent_hq_state,\n        COALESCE(parent.hq_zip_code, ultimate_parent.hq_zip_code) AS parent_hq_zip_code,\n        -- Parent's dh_id for practice location inheritance\n        COALESCE(parent.dh_id, ultimate_parent.dh_id) AS parent_dh_id\n    FROM hierarchy h\n    LEFT JOIN all_accounts parent\n        ON h.parent_account_id = parent.kmk_hco_id\n        AND h.parent_account_id != h.kmk_hco_id  -- Exclude self-referencing\n    LEFT JOIN all_accounts ultimate_parent\n        ON h.ultimate_parent_id = ultimate_parent.kmk_hco_id\n        AND h.ultimate_parent_id != h.kmk_hco_id  -- Exclude self-referencing\n    WHERE (h.parent_account_id IS NOT NULL OR h.ultimate_parent_id IS NOT NULL)\n),\n\n-- =============================================================================\n-- BBN-005: Backbone Flag Propagation (Children \u2192 Parents)\n-- If any child account has backbone flag, all parent accounts (L1, L2, L3) should also be backbone\n-- =============================================================================\n-- Step 1: Calculate initial backbone flags (without parent propagation)\ninitial_backbone_flags AS (\n    SELECT\n        m.kmk_hco_id,\n        m.firm_type,\n        CASE\n            -- Practice locations (L4) should ONLY be backbone if they meet criteria directly\n            -- NO parent propagation, NO HCP affiliation propagation for practice locations\n            WHEN m.firm_type = 'Practice Location' THEN\n                CASE\n                    WHEN tgt.kam_network_target_flag = 'Y' OR tgt.kam_child_target_flag = 'Y' OR tgt.hsd_target_flag = 'Y' THEN 'Y'\n                    -- UPDATED: Use L24M consistently (24-month period)\n                    WHEN COALESCE(tm.l24m_turbt_claims, 0) > 0 OR COALESCE(tm.l24m_tice_bcg_claims, 0) > 0 THEN 'Y'\n                    -- BBN-013: Any BC claims (including BC_DIAGNOSIS) qualify PLs for backbone\n                    -- PLs primarily receive diagnostic claims (pathology/radiology); treatment claims go to L3 parent\n                    WHEN COALESCE(bc.bc_claim_count, 0) > 0 THEN 'Y'\n                    WHEN COALESCE(ds.total_branded_sales_24mo, 0) > 0 THEN 'Y'\n                    WHEN COALESCE(hp.backbone_hcp_count, 0) > 0 THEN 'Y'\n                    -- BBN-012: Include accounts with sales activity data\n                    WHEN aa.has_activity = 'Y' THEN 'Y'\n                    ELSE 'N'\n                END\n            -- Regular HCOs (non-practice locations) follow standard backbone logic\n            ELSE\n                CASE\n                    WHEN wp.account_type = 'LUGPA' THEN 'Y'\n                    WHEN wp.account_type IN ('ACADEMIC HEALTH SYSTEM', 'NON ACADEMIC HEALTH SYSTEM') THEN 'Y'\n                    WHEN wp.account_type IN ('FEDERAL', 'COMPREHENSIVE CARE CENTER') THEN 'Y'\n                    WHEN tgt.kam_network_target_flag = 'Y' OR tgt.kam_child_target_flag = 'Y' OR tgt.hsd_target_flag = 'Y' THEN 'Y'\n                    WHEN COALESCE(hp.backbone_hcp_count, 0) > 0 THEN 'Y'\n                    -- UPDATED: Use L24M consistently (24-month period)\n                    WHEN COALESCE(tm.l24m_turbt_claims, 0) > 0\n                      OR COALESCE(tm.l24m_tice_bcg_claims, 0) > 0 THEN 'Y'\n                    WHEN COALESCE(ds.total_branded_sales_24mo, 0) > 0 THEN 'Y'\n                    -- BBN-012: Include accounts with sales activity data\n                    WHEN aa.has_activity = 'Y' THEN 'Y'\n                    ELSE 'N'\n                END\n        END AS initial_backbone_flag\n    FROM all_accounts m\n    LEFT JOIN hierarchy h ON m.kmk_hco_id = h.kmk_hco_id\n    LEFT JOIN with_priority wp ON m.kmk_hco_id = wp.kmk_hco_id\n    LEFT JOIN sfe_targets tgt ON m.kmk_hco_id = tgt.kmk_hco_id\n    LEFT JOIN hcp_profile hp ON m.kmk_hco_id = hp.kmk_hco_id\n    LEFT JOIN treatment_metrics tm ON m.kmk_hco_id = tm.kmk_hco_id\n    LEFT JOIN bc_metrics bc ON m.kmk_hco_id = bc.kmk_hco_id\n    LEFT JOIN ddd_sales ds ON m.kmk_hco_id = ds.kmk_hco_id\n    LEFT JOIN account_activity aa ON m.kmk_hco_id = aa.kmk_hco_id\n),\n\n-- Step 2: Identify parents with backbone children\n-- Find all parent accounts (L1, L2, L3) that have at least one child with backbone flag\n-- OPTIMIZED: Uses UNION ALL instead of OR joins for better Snowflake performance\nparents_with_backbone_children AS (\n    -- FIX 2026-01-15 (BBN-005): Remove hierarchy_level restriction to match test logic\n    -- Test matches by account_id only, not by hierarchy_level\n    -- L1 parents: children with backbone flag where account_id_l1 is not NULL\n    SELECT DISTINCT\n        parent_h.kmk_hco_id AS parent_kmk_hco_id\n    FROM hierarchy child_h\n    INNER JOIN initial_backbone_flags ibf ON child_h.kmk_hco_id = ibf.kmk_hco_id\n    INNER JOIN hierarchy parent_h ON child_h.account_id_l1 = parent_h.account_id\n    WHERE ibf.initial_backbone_flag = 'Y'\n      AND child_h.account_id_l1 IS NOT NULL\n      -- REMOVED: AND parent_h.hierarchy_level = 'L1'  -- Too restrictive, test doesn't check this\n      AND child_h.kmk_hco_id != parent_h.kmk_hco_id  -- Exclude self-references\n    \n    UNION\n    \n    -- L2 parents: children with backbone flag where account_id_l2 is not NULL and different from L1\n    SELECT DISTINCT\n        parent_h.kmk_hco_id AS parent_kmk_hco_id\n    FROM hierarchy child_h\n    INNER JOIN initial_backbone_flags ibf ON child_h.kmk_hco_id = ibf.kmk_hco_id\n    INNER JOIN hierarchy parent_h ON child_h.account_id_l2 = parent_h.account_id\n    WHERE ibf.initial_backbone_flag = 'Y'\n      AND child_h.account_id_l2 IS NOT NULL\n      -- FIX 2026-01-16: Use COALESCE to handle NULL comparison (NULL != X returns NULL, not TRUE)\n      AND COALESCE(child_h.account_id_l2 != child_h.account_id_l1, TRUE)  -- Exclude if L2 is same as L1\n      AND child_h.kmk_hco_id != parent_h.kmk_hco_id  -- Exclude self-references\n    \n    UNION\n    \n    -- L3 parents: children with backbone flag where account_id_l3 is not NULL and different from L1/L2\n    SELECT DISTINCT\n        parent_h.kmk_hco_id AS parent_kmk_hco_id\n    FROM hierarchy child_h\n    INNER JOIN initial_backbone_flags ibf ON child_h.kmk_hco_id = ibf.kmk_hco_id\n    INNER JOIN hierarchy parent_h ON child_h.account_id_l3 = parent_h.account_id\n    WHERE ibf.initial_backbone_flag = 'Y'\n      AND child_h.account_id_l3 IS NOT NULL\n      -- FIX 2026-01-16: Use COALESCE to handle NULL comparison (NULL != X returns NULL, not TRUE)\n      AND COALESCE(child_h.account_id_l3 != COALESCE(child_h.account_id_l2, child_h.account_id_l1), TRUE)  -- Exclude if L3 is same as L1/L2\n      AND child_h.kmk_hco_id != parent_h.kmk_hco_id  -- Exclude self-references\n    -- Note: Practice locations CAN propagate backbone to parents (if PL is backbone, parent should be too)\n),\n\n{% if not flags.FULL_REFRESH %}\n-- Account-level frozen account type (quarterly freeze - no family propagation)\n-- Each account's frozen type only applies to that specific account\naccount_frozen AS (\n    SELECT\n        KMK_HCO_ID,\n        ACCOUNT_TYPE AS frozen_account_type,\n        CASE ACCOUNT_TYPE\n            WHEN 'P1_LUGPA' THEN 1\n            WHEN 'P2_ACADEMIC' THEN 2\n            WHEN 'P2_NON-ACADEMIC' THEN 3\n            WHEN 'P3_ FEDERAL' THEN 4\n            WHEN 'P3_CCS' THEN 5\n            WHEN 'P4_SMALL_INDEP_Ctr' THEN 6\n            ELSE 99\n        END AS frozen_rank\n    FROM {{ target.database }}.ADM.adm_frozen_account_type\n),\n{% endif %}\n\nfinal_output AS (\n    SELECT\n        -- ============================================================\n        -- Core Identity (4 columns)\n        -- ============================================================\n        m.kmk_hco_id,\n        -- Enhanced: Inherit dh_id from parent for practice locations without their own dh_id\n        -- This addresses DV_036 validation issue for practice locations\n        CASE \n            WHEN m.firm_type = 'Practice Location' \n                 AND m.dh_id IS NULL \n                 AND pa.parent_dh_id IS NOT NULL\n            THEN pa.parent_dh_id\n            ELSE m.dh_id\n        END AS dh_id,\n        h.account_id,\n        m.org_name,\n\n        -- ============================================================\n        -- Organization Information (4 columns) - Section 5.8 Classification\n        -- ============================================================\n        m.firm_type,\n        -- Transform account_type to P1-P4 format (matching DEV APT format)\n        -- Quarterly freeze: account-level only (skipped on --full-refresh)\n        -- Uses LEAST(frozen_rank, computed_rank) to only upgrade, never downgrade\n        {% if not flags.FULL_REFRESH %}\n        CASE LEAST(\n            COALESCE(af.frozen_rank, 99),\n            CASE wp.account_type\n                WHEN 'LUGPA' THEN 1\n                WHEN 'ACADEMIC HEALTH SYSTEM' THEN 2\n                WHEN 'NON ACADEMIC HEALTH SYSTEM' THEN 3\n                WHEN 'FEDERAL' THEN 4\n                WHEN 'COMPREHENSIVE CARE CENTER' THEN 5\n                WHEN 'SMALL INDEPENDENT CENTER' THEN 6\n                ELSE 99\n            END\n        )\n            WHEN 1 THEN 'P1_LUGPA'\n            WHEN 2 THEN 'P2_ACADEMIC'\n            WHEN 3 THEN 'P2_NON-ACADEMIC'\n            WHEN 4 THEN 'P3_ FEDERAL'\n            WHEN 5 THEN 'P3_CCS'\n            WHEN 6 THEN 'P4_SMALL_INDEP_Ctr'\n            ELSE wp.account_type  -- Preserve Payor and any other types\n        END AS account_type,\n        CASE LEAST(\n            COALESCE(af.frozen_rank, 99),\n            CASE wp.account_type\n                WHEN 'LUGPA' THEN 1\n                WHEN 'ACADEMIC HEALTH SYSTEM' THEN 2\n                WHEN 'NON ACADEMIC HEALTH SYSTEM' THEN 3\n                WHEN 'FEDERAL' THEN 4\n                WHEN 'COMPREHENSIVE CARE CENTER' THEN 5\n                WHEN 'SMALL INDEPENDENT CENTER' THEN 6\n                ELSE 99\n            END\n        )\n            WHEN 1 THEN 'P1'\n            WHEN 2 THEN 'P2'\n            WHEN 3 THEN 'P2'\n            WHEN 4 THEN 'P3'\n            WHEN 5 THEN 'P3'\n            WHEN 6 THEN 'P4'\n            ELSE wp.account_type_priority\n        END AS account_type_priority,\n        {% else %}\n        CASE wp.account_type\n            WHEN 'LUGPA' THEN 'P1_LUGPA'\n            WHEN 'ACADEMIC HEALTH SYSTEM' THEN 'P2_ACADEMIC'\n            WHEN 'NON ACADEMIC HEALTH SYSTEM' THEN 'P2_NON-ACADEMIC'\n            WHEN 'FEDERAL' THEN 'P3_ FEDERAL'\n            WHEN 'COMPREHENSIVE CARE CENTER' THEN 'P3_CCS'\n            WHEN 'SMALL INDEPENDENT CENTER' THEN 'P4_SMALL_INDEP_Ctr'\n            ELSE wp.account_type\n        END AS account_type,\n        wp.account_type_priority,\n        {% endif %}\n        -- account_type_source removed (2026-02-02 cleanup) - debug info only\n\n        -- ============================================================\n        -- Headquarters Address (5 columns)\n        -- Use parent/ultimate parent address as fallback if account address is NULL\n        -- If still NULL, construct minimal address from city/state/zip\n        -- ============================================================\n        COALESCE(\n            m.hq_address_line_1, \n            pa.parent_hq_address_line_1,\n            CASE \n                WHEN m.hq_city IS NOT NULL AND m.hq_state IS NOT NULL \n                THEN m.hq_city || ', ' || m.hq_state || ' ' || COALESCE(m.hq_zip_code, '')\n                ELSE NULL\n            END\n        ) AS hq_address_line_1,\n        COALESCE(m.hq_address_line_2, pa.parent_hq_address_line_2) AS hq_address_line_2,\n        COALESCE(m.hq_city, pa.parent_hq_city) AS hq_city,\n        COALESCE(m.hq_state, pa.parent_hq_state) AS hq_state,\n        COALESCE(m.hq_zip_code, pa.parent_hq_zip_code) AS hq_zip_code,\n\n        -- ============================================================\n        -- Hierarchy & Structure - HIR-001, HIR-002\n        -- ============================================================\n        h.hierarchy_level,\n        h.parent_account_id,\n        h.ultimate_parent_id,\n        m.network_id,\n        m.network_name,\n        COALESCE(h.pe_flag, 'N') AS pe_flag,\n\n        -- ============================================================\n        -- Hierarchy Parent IDs (4 columns)\n        -- ============================================================\n        h.account_id_l1,\n        h.account_id_l2,\n        h.account_id_l3,\n        h.account_id_l4,\n\n        -- Source flags removed (2026-02-02 cleanup) - get from mdm_customer_xref_hco if needed\n        -- Removed: source_dh, source_ddd, source_medscout, source_claims\n\n        -- ============================================================\n        -- Backbone Flag - BBN-001, BBN-002, BBN-005\n        -- BBN-005: Parent accounts get backbone flag if any child has backbone flag\n        -- bc_patient_count removed (2026-02-02 cleanup) - get from adm_claims_metrics_long\n        -- ============================================================\n        CASE\n            -- Practice locations use their initial flag directly (no parent propagation)\n            WHEN m.firm_type = 'Practice Location' THEN ibf.initial_backbone_flag\n            -- Non-practice locations: 'Y' if parent propagation OR initial criteria met\n            ELSE\n                CASE\n                    WHEN pbc.parent_kmk_hco_id IS NOT NULL THEN 'Y'  -- BBN-005: parent propagation\n                    WHEN ibf.initial_backbone_flag = 'Y' THEN 'Y'   -- Own criteria met\n                    ELSE 'N'\n                END\n        END AS cust_backbone_flag,\n\n        -- ============================================================\n        -- KAM Target Flags - TGT-003, TGT-010, TGT-011, TGT-012\n        -- Sourced from adm_sfe_hco_targets\n        -- target_version removed (2026-02-02 cleanup) - get from adm_sfe_hco_targets if needed\n        -- ============================================================\n        CASE WHEN tgt.kam_network_target_flag = 'Y' THEN 1 ELSE 0 END AS network_target_flag,\n        tgt.kam_network_decile AS network_decile,\n        CASE WHEN tgt.kam_child_target_flag = 'Y' THEN 1 ELSE 0 END AS child_target_flag,\n        tgt.kam_child_decile AS child_decile,\n        -- NETWORK_ACCOUNT and CHILD_SITE flags (APT_V2 logic)\n        -- Post-freeze override: If freeze upgraded account to LUGPA, fix the flags\n        -- (network_account_flag is computed pre-freeze in account_ranking CTE)\n        {% if not flags.FULL_REFRESH %}\n        CASE\n            WHEN ar.network_account_flag = 'Y' THEN 'Y'\n            WHEN h.hierarchy_level = 'L3' AND af.frozen_rank = 1 THEN 'Y'\n            ELSE ar.network_account_flag\n        END AS network_account_flag,\n        CASE\n            WHEN h.hierarchy_level = 'L3' AND af.frozen_rank = 1 THEN 'N'\n            ELSE ar.child_site_flag\n        END AS child_site_flag,\n        {% else %}\n        ar.network_account_flag AS network_account_flag,\n        ar.child_site_flag AS child_site_flag,\n        {% endif %}\n        -- NETWORK_RANK and CHILD_RANK (APT_V2 logic - Phase 5)\n        ar.network_rank AS network_rank,\n        ar.child_rank AS child_rank,\n        CASE\n            WHEN tgt.kam_network_target_flag = 'Y' OR tgt.kam_child_target_flag = 'Y' THEN 'Y'\n            ELSE 'N'\n        END AS kam_target_flag,\n\n        -- ============================================================\n        -- HSD Target Flag (1 column) - TGT-020\n        -- ============================================================\n        COALESCE(tgt.hsd_target_flag, 'N') AS hsd_target_flag,\n        tgt.hsd_rank,\n\n        -- ============================================================\n        -- MSL Target Flag\n        -- ============================================================\n        COALESCE(tgt.msl_target_flag, 'N') AS msl_target_flag,\n\n        -- Territory Assignments removed (2026-02-02 cleanup) - APT joins std_zip_territory directly via ZIP\n        -- Removed: kam_territory, kam_territory_name, kam_region, kam_region_name,\n        --          hsd_territory, hsd_territory_name, msl_territory, msl_territory_name\n\n        -- ============================================================\n        -- Network Parent Information (3 columns)\n        -- ============================================================\n        m.network_parent_id,\n        m.network_parent_name,\n        m.network_parent_firm_type,\n\n        -- primary_source removed (2026-02-02 cleanup) - debug/lineage info only\n\n        -- ============================================================\n        -- HCP Profile Metrics (4 columns) - PRF-001 to PRF-004\n        -- total_hcp_count, backbone_hcp_count removed (2026-02-02 cleanup) - get from mdm_best_affiliation\n        -- ============================================================\n        COALESCE(hp.urologist_count, 0) AS urologist_count,\n        COALESCE(hp.urologist_w_claims, 0) AS urologist_w_claims,\n        -- Rollup metrics (including all descendant HCOs in hierarchy)\n        COALESCE(hp_rollup.urologist_count_total, hp.urologist_count, 0) AS urologist_count_total,\n        COALESCE(hp_rollup.urologist_w_claims_total, hp.urologist_w_claims, 0) AS urologist_w_claims_total,\n\n        -- ============================================================\n        -- SFE Output logic (Restored from legacy logic)\n        -- ============================================================\n        CASE \n            WHEN tgt.kam_network_target_flag = 'Y' AND tgt.kam_child_target_flag = 'Y' THEN 'Admin & Sales' \n            WHEN tgt.kam_network_target_flag = 'Y' AND (tgt.kam_child_target_flag = 'N' OR tgt.kam_child_target_flag IS NULL) THEN 'Admin' \n            WHEN (tgt.kam_network_target_flag = 'N' OR tgt.kam_network_target_flag IS NULL) AND tgt.kam_child_target_flag = 'Y' THEN 'Sales' \n            ELSE NULL \n        END AS recommended_engagement_type,\n        CASE WHEN (tgt.kam_network_target_flag = 'Y' OR tgt.kam_child_target_flag = 'Y' OR tgt.hsd_target_flag = 'Y') THEN 'Y' ELSE 'N' END AS display_abr,\n\n        -- ============================================================\n        -- Metadata (2 columns)\n        -- ============================================================\n        CURRENT_TIMESTAMP() AS modified_date,\n        (SELECT data_date FROM data_date_ref) AS data_date\n\n    FROM all_accounts m\n    LEFT JOIN hierarchy h ON m.kmk_hco_id = h.kmk_hco_id\n    -- parent_addresses: Only used for practice location dh_id inheritance and address fallback\n    LEFT JOIN parent_addresses pa ON m.kmk_hco_id = pa.kmk_hco_id\n    -- source_flags removed (2026-02-02 cleanup)\n    LEFT JOIN bc_metrics bc ON m.kmk_hco_id = bc.kmk_hco_id\n    LEFT JOIN treatment_metrics tm ON m.kmk_hco_id = tm.kmk_hco_id\n    LEFT JOIN ddd_sales ds ON m.kmk_hco_id = ds.kmk_hco_id\n    LEFT JOIN hcp_profile hp ON m.kmk_hco_id = hp.kmk_hco_id\n    LEFT JOIN hcp_profile_rollup hp_rollup ON m.kmk_hco_id = hp_rollup.kmk_hco_id\n\n    -- Account Type Classification (Section 5.8)\n    LEFT JOIN with_priority wp ON m.kmk_hco_id = wp.kmk_hco_id\n\n    -- SFE Targets\n    LEFT JOIN sfe_targets tgt ON m.kmk_hco_id = tgt.kmk_hco_id\n    -- sfe_territory removed (2026-02-02 cleanup) - APT joins directly via ZIP\n\n    -- Account Ranking (APT_V2 logic)\n    LEFT JOIN account_ranking_final ar ON m.kmk_hco_id = ar.kmk_hco_id\n\n    -- BBN-005: Parent backbone propagation\n    LEFT JOIN parents_with_backbone_children pbc ON m.kmk_hco_id = pbc.parent_kmk_hco_id\n\n    -- Backbone flag (DRY refactor): reuse initial_backbone_flags instead of duplicating logic\n    LEFT JOIN initial_backbone_flags ibf ON m.kmk_hco_id = ibf.kmk_hco_id\n\n    {% if not flags.FULL_REFRESH %}\n    -- Account-level frozen type (no family propagation)\n    LEFT JOIN account_frozen af ON m.kmk_hco_id = af.KMK_HCO_ID\n    {% endif %}\n)\n-- Deduplicate: Ensure one row per kmk_hco_id\n-- If duplicates exist, prioritize by account_type_priority (P1 > P2 > P3 > P4)\nSELECT * FROM final_output\nQUALIFY ROW_NUMBER() OVER (PARTITION BY kmk_hco_id ORDER BY\n    account_type_priority,\n    account_type,\n    modified_date DESC\n) = 1", "doc_blocks": [], "language": "sql", "refs": [{"name": "ref_time_periods", "package": null, "version": null}, {"name": "mdm_customer_master_hco", "package": null, "version": null}, {"name": "adm_hco_hierarchy", "package": null, "version": null}, {"name": "adm_hco_hierarchy", "package": null, "version": null}, {"name": "mdm_customer_master_hco", "package": null, "version": null}, {"name": "adm_hco_hierarchy", "package": null, "version": null}, {"name": "adm_claims_metrics_long", "package": null, "version": null}, {"name": "adm_claims_metrics_long", "package": null, "version": null}, {"name": "adm_ddd_metrics_wide", "package": null, "version": null}, {"name": "mdm_best_affiliation_hist", "package": null, "version": null}, {"name": "adm_hcp_master", "package": null, "version": null}, {"name": "stg_hcp_bc_metrics", "package": null, "version": null}, {"name": "adm_claims_metrics_long", "package": null, "version": null}, {"name": "adm_hco_hierarchy", "package": null, "version": null}, {"name": "adm_hco_hierarchy", "package": null, "version": null}, {"name": "adm_hco_hierarchy", "package": null, "version": null}, {"name": "account_type_business_input", "package": null, "version": null}, {"name": "adm_hco_hierarchy", "package": null, "version": null}, {"name": "adm_hco_hierarchy", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.ref_time_periods", "model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.adm_hco_hierarchy", "model.CGOncology_MDM.adm_claims_metrics_long", "model.CGOncology_MDM.adm_ddd_metrics_wide", "model.CGOncology_MDM.mdm_best_affiliation_hist", "model.CGOncology_MDM.adm_hcp_master", "model.CGOncology_MDM.stg_hcp_bc_metrics", "seed.CGOncology_MDM.account_type_business_input"]}, "compiled_path": "target/compiled/CGOncology_MDM/models/adm/adm_hco_master.sql", "compiled": true, "compiled_code": "\n\n/*\nPROC-ADM-003: adm_hco_master - Comprehensive HCO Master\nBusiness Rules: HIR-001/002, BBN-001/002/005, TGT-003/010/011/020\n\nSingle comprehensive view of all HCOs with:\n- Core identity and address from MDM\n- Hierarchy structure (L1-L4, parent relationships)\n- Backbone flag (BBN-005: parent propagation implemented)\n- Target flags (KAM, HSD, MSL) - Sourced from adm_sfe_hco_targets\n- PE/Network information\n- Enhanced dh_id inheritance: Practice locations without dh_id inherit from parent account\n\nGrain: One row per kmk_hco_id (~53 columns after 2026-02-02 cleanup)\n\nCOLUMNS REMOVED (2026-02-02 cleanup - denormalized/debug columns):\n- Source flags: source_dh, source_ddd, source_medscout, source_claims \u2192 get from mdm_customer_xref_hco\n- Account debug: account_type_source, primary_source\n- Territory: kam_territory/region, hsd_territory, msl_territory \u2192 APT joins std_zip_territory via ZIP\n- Metrics: bc_patient_count, target_version \u2192 get from source tables\n- HCP extra: total_hcp_count, backbone_hcp_count \u2192 get from mdm_best_affiliation\n- PE detail: pe_dh_id, pe_name \u2192 get from adm_hco_hierarchy\n\nQUARTERLY FREEZE (Jan 2026):\n  Normal runs: account_type and account_type_priority are frozen at the ACCOUNT LEVEL\n  from adm_frozen_account_type table (no family propagation - each account frozen individually).\n  Full refresh (--full-refresh): table join is skipped, all values computed fresh.\n*/\n\n-- Get data_date from ref_time_periods (single source of truth)\nWITH data_date_ref AS (\n    SELECT DISTINCT data_date\n    FROM CGONCOLOGY_TEST.ADM.ref_time_periods\n    LIMIT 1\n),\n\nmaster AS (\n    -- Core HCO attributes from MDM, with NAE-enhanced network columns from ADM_HCO_HIERARCHY\n    -- NOTE: Includes both child accounts (L3/L4) and parent accounts (L1/L2) that are in MDM\n    -- NOTE: account_type is calculated later in automated_classification CTE, not from MDM\n    -- FIX 2026-01-16: Get network columns from adm_hco_hierarchy (has NAE enhancements) instead of MDM\n    SELECT\n        m.kmk_hco_id,\n        m.dh_id,\n        m.org_name,\n        m.firm_type,\n        m.hq_address_line_1,\n        m.hq_address_line_2,\n        m.hq_city,\n        m.hq_state,\n        m.hq_zip_code,\n        CASE WHEN m.ddd_outlet_count > 0 THEN 'Y' ELSE 'N' END AS has_ddd_match,  -- Derived from DDD_OUTLET_COUNT\n        -- Network columns from hierarchy (NAE-enhanced) with fallback to MDM\n        COALESCE(h.network_id, m.network_id) AS network_id,\n        COALESCE(h.network_name, m.network_name) AS network_name,\n        COALESCE(h.network_firm_type, m.network_firm_type) AS network_firm_type,\n        COALESCE(h.network_parent_id, m.network_parent_id) AS network_parent_id,\n        COALESCE(h.network_parent_name, m.network_parent_name) AS network_parent_name,\n        COALESCE(h.network_parent_firm_type, m.network_parent_firm_type) AS network_parent_firm_type,\n        m.hospital_type,  -- Used in account type classification (ACD-005, CCC)\n        m.primary_source,\n        m.primary_specialty\n    FROM CGONCOLOGY_TEST.MDM.mdm_customer_master_hco m\n    LEFT JOIN CGONCOLOGY_TEST.ADM.adm_hco_hierarchy h ON m.kmk_hco_id = h.kmk_hco_id\n),\n\n-- Parent accounts from hierarchy that are NOT in MDM (explicit inclusion)\nparent_accounts_from_hierarchy AS (\n    SELECT\n        h.kmk_hco_id,\n        h.dh_id,\n        h.org_name,\n        h.firm_type,\n        NULL AS hq_address_line_1,\n        NULL AS hq_address_line_2,\n        NULL AS hq_city,\n        h.hq_state,\n        h.hq_zip_code,\n        h.has_ddd_match,\n        h.network_id,\n        h.network_name,\n        h.network_firm_type,\n        h.network_parent_id,\n        h.network_parent_name,\n        h.network_parent_firm_type,\n        NULL AS hospital_type,  -- Used in account type classification (ACD-005, CCC)\n        'HIERARCHY' AS primary_source,\n        NULL AS primary_specialty\n    FROM CGONCOLOGY_TEST.ADM.adm_hco_hierarchy h\n    WHERE h.hierarchy_level IN ('L1', 'L2')\n      AND NOT EXISTS (\n          SELECT 1 FROM CGONCOLOGY_TEST.MDM.mdm_customer_master_hco m\n          WHERE m.kmk_hco_id = h.kmk_hco_id\n      )\n),\n\n-- Combine MDM accounts with any parent accounts from hierarchy not in MDM\nall_accounts AS (\n    SELECT * FROM master\n    UNION ALL\n    SELECT * FROM parent_accounts_from_hierarchy\n),\n\nhierarchy AS (\n    -- Use pre-computed columns from adm_hco_hierarchy (2026-01-18 Simplification)\n    -- parent_account_id and ultimate_parent_id are now computed in the hierarchy model\n    SELECT\n        h.kmk_hco_id,\n        h.account_id,\n        h.hierarchy_level,\n        h.account_id_l1,\n        h.account_id_l2,\n        h.account_id_l3,\n        h.account_id_l4,\n        h.pe_dh_id,\n        h.pe_name,\n        h.pe_flag,\n        h.parent_account_id,      -- Pre-computed in hierarchy\n        h.ultimate_parent_id      -- Pre-computed in hierarchy (family_key)\n    FROM CGONCOLOGY_TEST.ADM.adm_hco_hierarchy h\n),\n\n-- source_flags CTE removed (2026-02-02 cleanup) - get from mdm_customer_xref_hco if needed\n\nbc_metrics AS (\n    -- BC patient metrics from ADM claims metrics (aggregated by kmk_hco_id)\n    -- UPDATED: Now sourced from adm_claims_metrics_long instead of stg_hco_bc_metrics\n    -- Uses BC_DIAGNOSIS category from adm_claims_metrics_long (TOTAL period)\n    -- Aggregated by kmk_hco_id (entity_id) for each account\n    SELECT\n        entity_id AS kmk_hco_id,\n        MAX(CASE WHEN metric_category = 'BC_DIAGNOSIS' AND period_key = 'TOTAL' THEN patient_count ELSE 0 END) AS bc_patient_count,\n        MAX(CASE WHEN metric_category = 'BC_DIAGNOSIS' AND period_key = 'TOTAL' THEN claim_count ELSE 0 END) AS bc_claim_count,  -- Used in account_ranking for tie-breaking\n        CASE \n            WHEN MAX(CASE WHEN metric_category = 'BC_DIAGNOSIS' AND period_key = 'TOTAL' THEN claim_count ELSE 0 END) > 0 THEN 'Y'\n            ELSE 'N'\n        END AS source_claims\n    FROM CGONCOLOGY_TEST.ADM.adm_claims_metrics_long\n    WHERE entity_type = 'HCO'\n      AND metric_category = 'BC_DIAGNOSIS'\n      AND period_key = 'TOTAL'\n    GROUP BY entity_id\n),\n\nnetwork_bc_metrics AS (\n    -- Aggregate BC patients at network level for NAC-004\n    -- If ANY HCO in network has BC patients, all members qualify\n    SELECT\n        m.network_id,\n        SUM(COALESCE(bc.bc_patient_count, 0)) AS network_bc_patient_count\n    FROM all_accounts m\n    LEFT JOIN bc_metrics bc ON m.kmk_hco_id = bc.kmk_hco_id\n    WHERE m.network_id IS NOT NULL\n    GROUP BY m.network_id\n),\n\n-- NMIBC Risk Tier Metrics removed - not used in final output\n-- Get from adm_hco_nmibc_metrics if needed\n\n-- SFE: Targets (Consolidated Source)\n-- NOTE: Hardcoded reference to existing ADM table (SFE models disabled in dbt_project.yml)\nsfe_targets AS (\n    SELECT\n        kmk_hco_id,\n        kam_network_target_flag,\n        kam_network_decile,\n        kam_child_target_flag,\n        kam_child_decile,\n        hsd_target_flag,\n        hsd_rank,\n        msl_target_flag\n        -- target_version removed (2026-02-02 cleanup)\n        -- kam_network_composite_score, kam_child_composite_score not in source table\n    FROM CGONCOLOGY_TEST.ADM.adm_sfe_hco_targets\n    WHERE target_version = '2025'\n),\n\n-- sfe_territory CTE removed (2026-02-02 cleanup) - APT joins std_zip_territory directly via ZIP\n\ntreatment_metrics AS (\n    -- Treatment claims metrics from ADM using pre-computed rolling periods\n    -- NOTE: Parent account metrics use account_id_l1/account_id_l2 as entity_id in adm_claims_metrics_long\n    -- For parent accounts, account_id_l1/account_id_l2 = kmk_hco_id, so the join works correctly\n    -- UPDATED: Only pull L24M metrics (24-month period) - used for backbone flag and source_claims\n    SELECT\n        entity_id AS kmk_hco_id,\n        -- L24M for backbone flag (24-month period, consistent with DDD sales 24mo)\n        MAX(CASE WHEN metric_category = 'TURBT' AND period_key = 'L24M' THEN claim_count ELSE 0 END) AS l24m_turbt_claims,\n        MAX(CASE WHEN metric_category = 'TICE_BCG' AND period_key = 'L24M' THEN claim_count ELSE 0 END) AS l24m_tice_bcg_claims,\n        MAX(CASE WHEN metric_category = 'ADSTILADRIN' AND period_key = 'L24M' THEN claim_count ELSE 0 END) AS l24m_adstiladrin_claims,\n        MAX(CASE WHEN metric_category = 'ANKTIVA' AND period_key = 'L24M' THEN claim_count ELSE 0 END) AS l24m_anktiva_claims,\n        MAX(CASE WHEN metric_category = 'KEYTRUDA' AND period_key = 'L24M' THEN claim_count ELSE 0 END) AS l24m_keytruda_claims\n    FROM CGONCOLOGY_TEST.ADM.adm_claims_metrics_long\n    WHERE entity_type = 'HCO'\n      AND period_key = 'L24M'\n    GROUP BY entity_id\n),\n\nddd_sales AS (\n    -- DDD sales metrics (only used column: total_branded_sales_24mo for backbone flag)\n    -- FIX 2026-01-19: Use L24M_SALES from TOTAL_BRANDED metric_category (LTD columns removed)\n    SELECT\n        kmk_hco_id,\n        L24M_SALES AS total_branded_sales_24mo\n    FROM CGONCOLOGY_TEST.ADM.adm_ddd_metrics_wide\n    WHERE metric_category = 'TOTAL_BRANDED'\n),\n\n-- =============================================================================\n-- COMPOSITE SCORE for Account Ranking (mirrors hcp_decile.sql methodology)\n-- Min-max standardization + weighted composite: internal to ranking only\n-- Formula: (std_bc_patients * 0.10) + (std_bcg_claims * 0.45) + (std_turbt_claims * 0.45)\n-- =============================================================================\nmetrics_stats AS (\n    -- Min/max of the 3 metrics across all HCOs for min-max standardization\n    SELECT\n        MIN(COALESCE(bc.bc_patient_count, 0)) AS min_bc_patients,\n        MAX(COALESCE(bc.bc_patient_count, 0)) AS max_bc_patients,\n        MIN(COALESCE(tm.l24m_tice_bcg_claims, 0)) AS min_bcg_claims,\n        MAX(COALESCE(tm.l24m_tice_bcg_claims, 0)) AS max_bcg_claims,\n        MIN(COALESCE(tm.l24m_turbt_claims, 0)) AS min_turbt_claims,\n        MAX(COALESCE(tm.l24m_turbt_claims, 0)) AS max_turbt_claims\n    FROM all_accounts a\n    LEFT JOIN bc_metrics bc ON a.kmk_hco_id = bc.kmk_hco_id\n    LEFT JOIN treatment_metrics tm ON a.kmk_hco_id = tm.kmk_hco_id\n),\n\ncomposite_scores AS (\n    -- Per-HCO composite score using min-max standardized metrics\n    SELECT\n        a.kmk_hco_id,\n        (\n            -- Standardized BC patients (weight 0.10)\n            CASE\n                WHEN s.max_bc_patients = s.min_bc_patients THEN 0\n                ELSE (COALESCE(bc.bc_patient_count, 0) - s.min_bc_patients)::FLOAT\n                     / (s.max_bc_patients - s.min_bc_patients)\n            END * 0.10\n            +\n            -- Standardized BCG claims (weight 0.45)\n            CASE\n                WHEN s.max_bcg_claims = s.min_bcg_claims THEN 0\n                ELSE (COALESCE(tm.l24m_tice_bcg_claims, 0) - s.min_bcg_claims)::FLOAT\n                     / (s.max_bcg_claims - s.min_bcg_claims)\n            END * 0.45\n            +\n            -- Standardized TURBT claims (weight 0.45)\n            CASE\n                WHEN s.max_turbt_claims = s.min_turbt_claims THEN 0\n                ELSE (COALESCE(tm.l24m_turbt_claims, 0) - s.min_turbt_claims)::FLOAT\n                     / (s.max_turbt_claims - s.min_turbt_claims)\n            END * 0.45\n        ) AS composite_score\n    FROM all_accounts a\n    CROSS JOIN metrics_stats s\n    LEFT JOIN bc_metrics bc ON a.kmk_hco_id = bc.kmk_hco_id\n    LEFT JOIN treatment_metrics tm ON a.kmk_hco_id = tm.kmk_hco_id\n),\n\n-- BBN-012: Accounts with activity data (account updates/profile data)\n-- FIX 2026-01-31: Include accounts that have sales activity or profile assessment records\n-- These accounts are being actively worked by sales team and should be in the backbone\n-- NOTE: 7000000xxx manual accounts are excluded here (handled separately via seed_manual_hco_accounts in APT)\n-- SOURCE: Using PROD directly for activity data (live data from APT application)\naccount_activity AS (\n    -- Account updates (daily activity tracking)\n    SELECT DISTINCT\n        account_kmk_id AS kmk_hco_id,\n        'Y' AS has_activity\n    FROM CGONCOLOGY_PROD.REVERSE_APT.DAILY_ACCOUNT_UPDATES\n    WHERE account_kmk_id IS NOT NULL\n      AND account_kmk_id NOT LIKE '7%'  -- Manual accounts handled separately in APT\n\n    UNION\n\n    -- Account profile assessments (HSD profiling)\n    -- Note: PROD table name is AP_ASSESSMENT_RESPONSES (different from DEV naming)\n    SELECT DISTINCT\n        kmk_id AS kmk_hco_id,\n        'Y' AS has_activity\n    FROM CGONCOLOGY_PROD.REPORTING.AP_ASSESSMENT_RESPONSES\n    WHERE kmk_id IS NOT NULL\n      AND kmk_id NOT LIKE '7%'  -- Manual accounts handled separately in APT\n),\n\nhcp_profile AS (\n    -- HCP-based profile metrics (merged from adm_hco_profile)\n    -- FIX 2026-01-12 (BBN-010): Use CUST_BACKBONE_FLAG from ADM_HCP_MASTER instead of BC_BACKBONE_FLAG\n    -- CUST_BACKBONE_FLAG requires affiliation, which matches the business rule for HCO backbone propagation\n    -- PRF-001: urologist_count uses IS_UROLOGIST flag (excludes Neurology false positives per BBN-011)\n    -- FIX 2026-02-02: urologist_w_claims changed from lifetime to L12M timeframe\n    SELECT\n        aff.best_kmk_hco_id AS kmk_hco_id,\n        COUNT(DISTINCT CASE WHEN bcm.IS_UROLOGIST = 'Y' THEN hcp.npi END) AS urologist_count,\n        COUNT(DISTINCT CASE WHEN bcm.IS_UROLOGIST = 'Y' AND l12m.entity_id IS NOT NULL THEN hcp.npi END) AS urologist_w_claims,\n        COUNT(DISTINCT hcp.npi) AS total_hcp_count,\n        COUNT(DISTINCT CASE WHEN hcp.cust_backbone_flag = 'Y' THEN hcp.npi END) AS backbone_hcp_count\n    FROM CGONCOLOGY_TEST.MDM.mdm_best_affiliation_hist aff\n    LEFT JOIN CGONCOLOGY_TEST.ADM.adm_hcp_master hcp ON aff.kmk_hcp_id = hcp.kmk_hcp_id\n    LEFT JOIN CGONCOLOGY_TEST.STAGING.stg_hcp_bc_metrics bcm ON hcp.npi = bcm.npi\n    LEFT JOIN (\n        SELECT DISTINCT entity_id\n        FROM CGONCOLOGY_TEST.ADM.adm_claims_metrics_long\n        WHERE entity_type = 'HCP'\n          AND period_key = 'L12M'\n          AND patient_count > 0\n    ) l12m ON hcp.kmk_hcp_id = l12m.entity_id\n    WHERE aff.is_current = 'Y'\n      AND aff.best_kmk_hco_id IS NOT NULL\n    GROUP BY aff.best_kmk_hco_id\n),\n\n-- Rollup urologists including all descendant HCOs in hierarchy\n-- Used for Physician Group LUGPA classification (LUG-001)\n-- OPTIMIZED: Uses UNION ALL instead of OR join for better Snowflake performance\nhcp_profile_rollup AS (\n    SELECT\n        parent_id AS kmk_hco_id,\n        SUM(COALESCE(urologist_count, 0)) AS urologist_count_total,\n        SUM(COALESCE(urologist_w_claims, 0)) AS urologist_w_claims_total\n    FROM (\n        -- L1 aggregation: All HCOs that have this as L1 parent\n        SELECT h.account_id_l1 AS parent_id, hp.urologist_count, hp.urologist_w_claims\n        FROM CGONCOLOGY_TEST.ADM.adm_hco_hierarchy h\n        LEFT JOIN hcp_profile hp ON h.kmk_hco_id = hp.kmk_hco_id\n        WHERE h.account_id_l1 IS NOT NULL\n\n        UNION ALL\n\n        -- L2 aggregation: All HCOs that have this as L2 parent (excluding L1 self-refs)\n        SELECT h.account_id_l2 AS parent_id, hp.urologist_count, hp.urologist_w_claims\n        FROM CGONCOLOGY_TEST.ADM.adm_hco_hierarchy h\n        LEFT JOIN hcp_profile hp ON h.kmk_hco_id = hp.kmk_hco_id\n        WHERE h.account_id_l2 IS NOT NULL\n          AND h.account_id_l2 != h.account_id_l1\n\n        UNION ALL\n\n        -- L3 aggregation: All HCOs that have this as L3 parent (excluding L1/L2 self-refs)\n        SELECT h.account_id_l3 AS parent_id, hp.urologist_count, hp.urologist_w_claims\n        FROM CGONCOLOGY_TEST.ADM.adm_hco_hierarchy h\n        LEFT JOIN hcp_profile hp ON h.kmk_hco_id = hp.kmk_hco_id\n        WHERE h.account_id_l3 IS NOT NULL\n          AND h.account_id_l3 != COALESCE(h.account_id_l2, h.account_id_l1)\n    ) rolled_up\n    GROUP BY parent_id\n),\n\n-- network_urologist_metrics removed - redundant with hcp_profile_rollup (L1-L4 rollup covers network aggregation)\n-- mso_affiliation_metrics removed - redundant with hcp_profile_rollup (L1-L4 rollup covers hierarchy aggregation)\n\n-- =============================================================================\n-- ACCOUNT TYPE CLASSIFICATION (Section 5.8 Business Rules)\n-- NO NULL VALUES - every HCO gets classified\n-- =============================================================================\n\n-- Step 1: Automated classification (default = SMALL INDEPENDENT CENTER)\nautomated_classification AS (\n    SELECT\n        m.kmk_hco_id,\n        m.dh_id,\n        m.network_id,\n        m.network_parent_id,\n        m.org_name,\n        m.network_name,\n        CASE\n            -- FEDERAL (Order 1)\n            WHEN m.network_parent_name IN ('Defense Health Agency', 'Department of Veterans Affairs')\n            THEN 'FEDERAL'\n            -- LUGPA (Order 2) - LUG-001: Physician Group + Urology specialty + 10+ urologists (total including children)\n            -- Requires primary_specialty = 'Urology' to exclude multi-specialty groups like Mayo/Cleveland Clinic\n            -- Uses urologist_count_total (rollup) for PG since they often have multiple practice locations\n            WHEN m.firm_type = 'Physician Group'\n                 AND m.primary_specialty = 'Urology'\n                 AND COALESCE(hp_rollup.urologist_count_total, hp.urologist_count, 0) >= 10\n            THEN 'LUGPA'\n            -- LUGPA (Order 2) - LUG-004: MSO with urology indicator + 10+ urologists (direct count only)\n            WHEN m.firm_type = 'Management Services Organization'\n                 AND ((m.org_name ILIKE '%urology%' AND m.org_name NOT ILIKE '%neurology%')\n                      OR m.primary_specialty = 'Urology')\n                 AND COALESCE(hp.urologist_count, 0) >= 10\n            THEN 'LUGPA'\n            -- LUGPA (Order 2) - LUG-002: Org name contains 'urology' + specialty = 'Urology' + 10+ urologists (direct count only)\n            -- Per original spec: name 'Urology' AND (main specialty OR other specialty = 'Urology')\n            WHEN m.org_name ILIKE '%urology%' AND m.org_name NOT ILIKE '%neurology%'\n                 AND m.primary_specialty = 'Urology'\n                 AND COALESCE(hp.urologist_count, 0) >= 10\n            THEN 'LUGPA'\n            -- LUGPA (Order 2) - LUG-003: Urology indicator + 5-9 urologists + BC volume > 100 (direct count only)\n            WHEN ((m.org_name ILIKE '%urology%' AND m.org_name NOT ILIKE '%neurology%')\n                  OR m.primary_specialty = 'Urology')\n                 AND COALESCE(hp.urologist_count, 0) BETWEEN 5 AND 9\n                 AND COALESCE(bc.bc_patient_count, 0) > 100\n            THEN 'LUGPA'\n            -- ACADEMIC (Order 3) - ACD-001 through ACD-005\n            WHEN (\n                -- Original logic (ACD-001/002/003): org_name OR network_name keywords + firm_type\n                ((m.org_name ILIKE ANY ('%University%', '%School%', '%College%', '%Institute%', '%Research%')\n                  OR m.network_name ILIKE ANY ('%University%', '%School%', '%College%', '%Institute%', '%Research%'))\n                 AND m.firm_type IN ('Hospital', 'Health System'))\n                -- ACD-004: network_parent_name check\n                OR (m.network_parent_name ILIKE ANY ('%University%', '%School%', '%College%', '%Institute%', '%Research%')\n                    AND m.firm_type IN ('Hospital', 'Health System'))\n                -- ACD-005: hospital_type academic indicator\n                OR m.hospital_type ILIKE ANY ('%Academic%', '%Faculty Practice%')\n            )\n            THEN 'ACADEMIC HEALTH SYSTEM'\n            -- CCC (Order 4)\n            WHEN (m.firm_type ILIKE '%Payor%' OR m.hospital_type ILIKE '%Payor%')\n                 AND (m.network_firm_type = 'Health System' OR m.network_parent_firm_type = 'Health System')\n            THEN 'COMPREHENSIVE CARE CENTER'\n            -- NON-ACADEMIC (Order 5) - NAC-001 + NAC-004 (network-level)\n            WHEN (m.firm_type = 'Health System'\n                  OR m.network_firm_type = 'Health System'\n                  OR m.network_parent_firm_type = 'Health System')\n                 AND (COALESCE(bc.bc_patient_count, 0) > 0\n                      OR COALESCE(nbc.network_bc_patient_count, 0) > 0)  -- NAC-004: Individual OR network BC\n            THEN 'NON ACADEMIC HEALTH SYSTEM'\n            -- SMALL INDEPENDENT (Order 6 - DEFAULT, never NULL)\n            ELSE 'SMALL INDEPENDENT CENTER'\n        END AS account_type_auto\n    FROM all_accounts m\n    LEFT JOIN hcp_profile hp ON m.kmk_hco_id = hp.kmk_hco_id\n    LEFT JOIN hcp_profile_rollup hp_rollup ON m.kmk_hco_id = hp_rollup.kmk_hco_id\n    LEFT JOIN bc_metrics bc ON m.kmk_hco_id = bc.kmk_hco_id\n    LEFT JOIN network_bc_metrics nbc ON m.network_id = nbc.network_id\n),\n\n-- =============================================================================\n-- ACCOUNT TYPE CLASSIFICATION - SIMPLIFIED CASCADE APPROACH (2026-01-18 Refactor)\n-- =============================================================================\n-- DESIGN: Use single family_key to propagate account types\n-- family_key = COALESCE(account_id_l1, account_id_l2, account_id_l3, account_id)\n-- This groups accounts by their highest common ancestor for propagation\n--\n-- FLOW:\n-- 1. Base classification (identify direct types from rules)\n-- 2. Manual overrides (apply business input overrides)\n-- 3. Family propagation (propagate best type to entire family)\n-- 4. Derive business priority (P1-P4)\n-- =============================================================================\n\n-- Step 1: Add priority to base classification\nautomated_with_priority AS (\n    SELECT\n        ac.*,\n        CASE ac.account_type_auto\n            WHEN 'FEDERAL' THEN 1\n            WHEN 'LUGPA' THEN 2\n            WHEN 'ACADEMIC HEALTH SYSTEM' THEN 3\n            WHEN 'COMPREHENSIVE CARE CENTER' THEN 4\n            WHEN 'NON ACADEMIC HEALTH SYSTEM' THEN 5\n            ELSE 6\n        END AS account_type_auto_priority\n    FROM automated_classification ac\n),\n\n-- Step 2: Manual override table (deduplicated)\naccount_type_override_dedup AS (\n    SELECT\n        CAST(dh_id AS VARCHAR) AS dh_id,\n        account_type,\n        CASE account_type\n            WHEN 'FEDERAL' THEN 1\n            WHEN 'LUGPA' THEN 2\n            WHEN 'ACADEMIC HEALTH SYSTEM' THEN 3\n            WHEN 'COMPREHENSIVE CARE CENTER' THEN 4\n            WHEN 'NON ACADEMIC HEALTH SYSTEM' THEN 5\n            ELSE 6\n        END AS account_type_priority\n    FROM CGONCOLOGY_TEST.project.account_type_business_input\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY dh_id ORDER BY account_type) = 1\n),\n\n-- Step 3: Apply manual overrides (only upgrades)\nwith_manual_override AS (\n    SELECT\n        ac.kmk_hco_id,\n        ac.dh_id,\n        ac.network_id,\n        ac.network_parent_id,\n        -- Apply manual override if it's an UPGRADE (lower priority = higher)\n        CASE\n            WHEN ao_direct.account_type IS NOT NULL AND ao_direct.account_type_priority < ac.account_type_auto_priority\n            THEN ao_direct.account_type\n            WHEN ao_network.account_type IS NOT NULL AND ao_network.account_type_priority < ac.account_type_auto_priority\n            THEN ao_network.account_type\n            WHEN ao_parent.account_type IS NOT NULL AND ao_parent.account_type_priority < ac.account_type_auto_priority\n            THEN ao_parent.account_type\n            ELSE ac.account_type_auto\n        END AS base_account_type,\n        CASE\n            WHEN ao_direct.account_type IS NOT NULL AND ao_direct.account_type_priority < ac.account_type_auto_priority\n            THEN 'MANUAL_DIRECT'\n            WHEN ao_network.account_type IS NOT NULL AND ao_network.account_type_priority < ac.account_type_auto_priority\n            THEN 'MANUAL_NETWORK'\n            WHEN ao_parent.account_type IS NOT NULL AND ao_parent.account_type_priority < ac.account_type_auto_priority\n            THEN 'MANUAL_PARENT'\n            ELSE 'AUTOMATED'\n        END AS base_type_source,\n        CASE\n            WHEN ao_direct.account_type IS NOT NULL AND ao_direct.account_type_priority < ac.account_type_auto_priority\n            THEN ao_direct.account_type_priority\n            WHEN ao_network.account_type IS NOT NULL AND ao_network.account_type_priority < ac.account_type_auto_priority\n            THEN ao_network.account_type_priority\n            WHEN ao_parent.account_type IS NOT NULL AND ao_parent.account_type_priority < ac.account_type_auto_priority\n            THEN ao_parent.account_type_priority\n            ELSE ac.account_type_auto_priority\n        END AS base_priority\n    FROM automated_with_priority ac\n    LEFT JOIN account_type_override_dedup ao_direct ON CAST(ac.dh_id AS VARCHAR) = ao_direct.dh_id\n    LEFT JOIN account_type_override_dedup ao_network ON CAST(ac.network_id AS VARCHAR) = ao_network.dh_id\n    LEFT JOIN account_type_override_dedup ao_parent ON CAST(ac.network_parent_id AS VARCHAR) = ao_parent.dh_id\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY ac.kmk_hco_id ORDER BY\n        CASE\n            WHEN ao_direct.account_type IS NOT NULL THEN 1\n            WHEN ao_network.account_type IS NOT NULL THEN 2\n            WHEN ao_parent.account_type IS NOT NULL THEN 3\n            ELSE 4\n        END\n    ) = 1\n),\n\n-- =============================================================================\n-- FAMILY PROPAGATION (2026-01-18 Simplification)\n-- =============================================================================\n-- Uses pre-computed ultimate_parent_id from adm_hco_hierarchy (no recursive CTE needed)\n-- ultimate_parent_id = COALESCE(account_id_l1, account_id_l2, account_id_l3, account_id)\n-- This groups accounts by their highest common ancestor for type propagation\n-- =============================================================================\n\n-- Step 4: Find best type in each family (using pre-computed ultimate_parent_id)\nfamily_best AS (\n    SELECT\n        h.ultimate_parent_id AS family_id,\n        wmo.base_account_type AS best_type,\n        MIN(wmo.base_priority) AS best_priority\n    FROM with_manual_override wmo\n    LEFT JOIN CGONCOLOGY_TEST.ADM.adm_hco_hierarchy h ON wmo.kmk_hco_id = h.kmk_hco_id\n    WHERE wmo.base_account_type != 'SMALL INDEPENDENT CENTER'\n      AND h.ultimate_parent_id IS NOT NULL\n    GROUP BY h.ultimate_parent_id, wmo.base_account_type\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY h.ultimate_parent_id ORDER BY MIN(wmo.base_priority)) = 1\n),\n\n-- Step 5: Apply family propagation (single step - all accounts in same tree get same type)\nfinal_classification AS (\n    SELECT\n        wmo.kmk_hco_id,\n        CASE\n            WHEN fb.best_type IS NOT NULL AND fb.best_priority < wmo.base_priority\n            THEN fb.best_type\n            ELSE wmo.base_account_type\n        END AS account_type,\n        CASE\n            WHEN fb.best_type IS NOT NULL AND fb.best_priority < wmo.base_priority\n            THEN 'FAMILY_PROP'\n            ELSE wmo.base_type_source\n        END AS account_type_source\n    FROM with_manual_override wmo\n    LEFT JOIN CGONCOLOGY_TEST.ADM.adm_hco_hierarchy h ON wmo.kmk_hco_id = h.kmk_hco_id\n    LEFT JOIN family_best fb ON h.ultimate_parent_id = fb.family_id\n),\n\n-- Step 7: Derive business priority (P1-P4)\nwith_priority AS (\n    SELECT\n        fc.kmk_hco_id,\n        fc.account_type,\n        fc.account_type_source,\n        CASE fc.account_type\n            WHEN 'LUGPA' THEN 'P1'\n            WHEN 'ACADEMIC HEALTH SYSTEM' THEN 'P2'\n            WHEN 'NON ACADEMIC HEALTH SYSTEM' THEN 'P2'\n            WHEN 'FEDERAL' THEN 'P3'\n            WHEN 'COMPREHENSIVE CARE CENTER' THEN 'P3'\n            ELSE 'P4'  -- SMALL INDEPENDENT CENTER\n        END AS account_type_priority\n    FROM final_classification fc\n),\n\n-- =============================================================================\n-- ACCOUNT RANKING (Based on APT_V2.sql logic)\n-- Step 1: Define NETWORK_ACCOUNT vs CHILD_SITE based on hierarchy level + account type\n-- Step 2: Calculate ranks within each universe\n-- =============================================================================\naccount_ranking AS (\n    SELECT\n        m.kmk_hco_id,\n        h.hierarchy_level,\n        h.account_id_l1,\n        wp.account_type,\n        wp.account_type_priority,\n        m.firm_type,\n        -- Composite score from min-max standardization (used as primary ranking key)\n        COALESCE(cs.composite_score, 0) AS composite_score,\n        tgt.kam_network_decile,\n        tgt.kam_child_decile,\n\n        -- NETWORK_ACCOUNT flag (APT_V2 t5 logic):\n        -- L2 = Network Account\n        -- L3 + P1_LUGPA = Network Account (LUGPA at L3 is still network-level)\n       CASE\n        WHEN tgt.kam_network_target_flag = 'Y' THEN 'Y'\n        WHEN h.hierarchy_level = 'L2' THEN 'Y'\n        WHEN h.hierarchy_level = 'L3' AND wp.account_type = 'LUGPA' THEN 'Y'\n        ELSE 'N'\n        END AS network_account_flag,\n\n        CASE\n            WHEN tgt.kam_child_target_flag = 'Y' THEN 'Y'\n            WHEN h.hierarchy_level = 'L4' THEN 'Y'\n            WHEN h.hierarchy_level = 'L3' AND wp.account_type != 'LUGPA' THEN 'Y'\n            ELSE 'N'\n        END AS child_site_flag,\n\n        -- Metrics for tie-breaking (same approach as APT_V2)\n        -- UPDATED: Use L24M for consistency\n        COALESCE(tm.l24m_tice_bcg_claims, 0) AS tice_bcg_claims,\n        COALESCE(tm.l24m_turbt_claims, 0) AS turbt_claims,\n        COALESCE(bc.bc_claim_count, 0) AS bc_diagnosis_claims,\n        COALESCE(bc.bc_patient_count, 0) AS bc_diagnosis_patients,\n        COALESCE(ds.total_branded_sales_24mo, 0) AS ddd_tice_bcg_sales,\n\n        -- OTHER_SCORE: Weighted composite for tie-breaking (APT_V2 t2)\n        -- Federal: 0.5*TURBT + 0.5*BC_CLAIMS; Non-Federal: 0.8*DDD + 0.1*TURBT + 0.1*BC_PTS\n        CASE\n            WHEN wp.account_type = 'P3_ FEDERAL' THEN\n                (0.5 * COALESCE(tm.l24m_turbt_claims, 0)) +\n                (0.5 * COALESCE(bc.bc_claim_count, 0))\n            ELSE\n                (0.8 * COALESCE(ds.total_branded_sales_24mo, 0)) +\n                (0.1 * COALESCE(tm.l24m_turbt_claims, 0)) +\n                (0.1 * COALESCE(bc.bc_patient_count, 0))\n        END AS other_score,\n\n        -- TARGET_PRIORITY: 1 if KAM target, else 2 (APT_V2 t5)\n        CASE\n            WHEN tgt.kam_network_target_flag = 'Y' OR tgt.kam_child_target_flag = 'Y'\n            THEN 1 ELSE 2\n        END AS target_priority,\n\n        -- TARGETABLE_ACCOUNT_PRIORITY: 1 if in any target list, else 2 (APT_V2 t4/t5)\n        CASE\n            WHEN tgt.kam_network_target_flag = 'Y'\n              OR tgt.kam_child_target_flag = 'Y'\n              OR tgt.hsd_target_flag = 'Y'\n              OR tgt.msl_target_flag = 'Y'\n            THEN 1 ELSE 2\n        END AS targetable_account_priority,\n\n        -- Numeric account type priority (APT_V2 t5)\n        CASE wp.account_type\n            WHEN 'P1_LUGPA' THEN 1\n            WHEN 'P2_ACADEMIC' THEN 2\n            WHEN 'P2_NON-ACADEMIC' THEN 2\n            WHEN 'P3_CCS' THEN 3\n            WHEN 'P3_ FEDERAL' THEN 3\n            ELSE 4\n        END AS acct_type_priority_num,\n\n        -- Numeric firm type priority (APT_V2 t5)\n        CASE m.firm_type\n            WHEN 'HOSPITAL' THEN 1\n            WHEN 'PHYSICIAN_GROUP' THEN 2\n            ELSE 3\n        END AS firm_type_priority_num\n\n    FROM all_accounts m\n    LEFT JOIN hierarchy h ON m.kmk_hco_id = h.kmk_hco_id\n    LEFT JOIN with_priority wp ON m.kmk_hco_id = wp.kmk_hco_id\n    LEFT JOIN sfe_targets tgt ON m.kmk_hco_id = tgt.kmk_hco_id\n    LEFT JOIN treatment_metrics tm ON m.kmk_hco_id = tm.kmk_hco_id\n    LEFT JOIN bc_metrics bc ON m.kmk_hco_id = bc.kmk_hco_id\n    LEFT JOIN ddd_sales ds ON m.kmk_hco_id = ds.kmk_hco_id\n    LEFT JOIN composite_scores cs ON m.kmk_hco_id = cs.kmk_hco_id\n),\n\n-- Step 2: Calculate ranks within each universe\naccount_ranking_final AS (\n    SELECT\n        ar.kmk_hco_id,\n        ar.network_account_flag,\n        ar.child_site_flag,\n        ar.account_id_l1,\n\n        -- Network Rank: Calculated ONLY for network accounts (NETWORK_ACCOUNT='Y')\n        -- ORDER BY aligned with APT_V2 t7 logic: composite_score first, then decile\n        CASE\n            WHEN ar.network_account_flag = 'Y'\n            THEN DENSE_RANK() OVER (\n                PARTITION BY (CASE WHEN ar.network_account_flag = 'Y' THEN 1 ELSE 0 END)\n                ORDER BY\n                    ar.composite_score DESC NULLS LAST,    -- Primary: min-max standardized composite\n                    ar.kam_network_decile DESC NULLS LAST,\n                    ar.target_priority,                    -- APT_V2: target sites rank higher\n                    ar.targetable_account_priority,        -- APT_V2: targetable accounts rank higher\n                    ar.other_score DESC,                   -- APT_V2: weighted composite score\n                    ar.ddd_tice_bcg_sales DESC,\n                    ar.turbt_claims DESC,\n                    ar.bc_diagnosis_claims DESC,\n                    ar.acct_type_priority_num,             -- APT_V2: P1 > P2 > P3 > P4\n                    ar.firm_type_priority_num,             -- APT_V2: Hospital > PG > Other\n                    ar.kmk_hco_id\n            )\n            ELSE NULL\n        END AS network_rank,\n\n        -- Child Rank: Calculated ONLY for child sites (CHILD_SITE='Y')\n        -- ORDER BY aligned with APT_V2 t14 logic: composite_score first, then decile\n        CASE\n            WHEN ar.child_site_flag = 'Y'\n            THEN DENSE_RANK() OVER (\n                PARTITION BY ar.account_id_l1, (CASE WHEN ar.child_site_flag = 'Y' THEN 1 ELSE 0 END)\n                ORDER BY\n                    ar.composite_score DESC NULLS LAST,    -- Primary: min-max standardized composite\n                    ar.kam_child_decile DESC NULLS LAST,\n                    ar.target_priority,                    -- APT_V2: target sites rank higher\n                    ar.targetable_account_priority,        -- APT_V2: targetable accounts rank higher\n                    ar.other_score DESC,                   -- APT_V2: weighted composite score\n                    ar.ddd_tice_bcg_sales DESC,\n                    ar.turbt_claims DESC,\n                    ar.bc_diagnosis_claims DESC,\n                    ar.acct_type_priority_num,             -- APT_V2: P1 > P2 > P3 > P4\n                    ar.firm_type_priority_num,             -- APT_V2: Hospital > PG > Other\n                    ar.kmk_hco_id\n            )\n            ELSE NULL\n        END AS child_rank\n\n    FROM account_ranking ar\n),\n\n-- Parent address lookup: Get addresses from parent or ultimate parent accounts for fallback\n-- Try parent first, then ultimate parent if parent doesn't have address\n-- Also get parent's dh_id for practice location inheritance\nparent_addresses AS (\n    SELECT\n        h.kmk_hco_id,\n        COALESCE(parent.hq_address_line_1, ultimate_parent.hq_address_line_1) AS parent_hq_address_line_1,\n        COALESCE(parent.hq_address_line_2, ultimate_parent.hq_address_line_2) AS parent_hq_address_line_2,\n        COALESCE(parent.hq_city, ultimate_parent.hq_city) AS parent_hq_city,\n        COALESCE(parent.hq_state, ultimate_parent.hq_state) AS parent_hq_state,\n        COALESCE(parent.hq_zip_code, ultimate_parent.hq_zip_code) AS parent_hq_zip_code,\n        -- Parent's dh_id for practice location inheritance\n        COALESCE(parent.dh_id, ultimate_parent.dh_id) AS parent_dh_id\n    FROM hierarchy h\n    LEFT JOIN all_accounts parent\n        ON h.parent_account_id = parent.kmk_hco_id\n        AND h.parent_account_id != h.kmk_hco_id  -- Exclude self-referencing\n    LEFT JOIN all_accounts ultimate_parent\n        ON h.ultimate_parent_id = ultimate_parent.kmk_hco_id\n        AND h.ultimate_parent_id != h.kmk_hco_id  -- Exclude self-referencing\n    WHERE (h.parent_account_id IS NOT NULL OR h.ultimate_parent_id IS NOT NULL)\n),\n\n-- =============================================================================\n-- BBN-005: Backbone Flag Propagation (Children \u2192 Parents)\n-- If any child account has backbone flag, all parent accounts (L1, L2, L3) should also be backbone\n-- =============================================================================\n-- Step 1: Calculate initial backbone flags (without parent propagation)\ninitial_backbone_flags AS (\n    SELECT\n        m.kmk_hco_id,\n        m.firm_type,\n        CASE\n            -- Practice locations (L4) should ONLY be backbone if they meet criteria directly\n            -- NO parent propagation, NO HCP affiliation propagation for practice locations\n            WHEN m.firm_type = 'Practice Location' THEN\n                CASE\n                    WHEN tgt.kam_network_target_flag = 'Y' OR tgt.kam_child_target_flag = 'Y' OR tgt.hsd_target_flag = 'Y' THEN 'Y'\n                    -- UPDATED: Use L24M consistently (24-month period)\n                    WHEN COALESCE(tm.l24m_turbt_claims, 0) > 0 OR COALESCE(tm.l24m_tice_bcg_claims, 0) > 0 THEN 'Y'\n                    -- BBN-013: Any BC claims (including BC_DIAGNOSIS) qualify PLs for backbone\n                    -- PLs primarily receive diagnostic claims (pathology/radiology); treatment claims go to L3 parent\n                    WHEN COALESCE(bc.bc_claim_count, 0) > 0 THEN 'Y'\n                    WHEN COALESCE(ds.total_branded_sales_24mo, 0) > 0 THEN 'Y'\n                    WHEN COALESCE(hp.backbone_hcp_count, 0) > 0 THEN 'Y'\n                    -- BBN-012: Include accounts with sales activity data\n                    WHEN aa.has_activity = 'Y' THEN 'Y'\n                    ELSE 'N'\n                END\n            -- Regular HCOs (non-practice locations) follow standard backbone logic\n            ELSE\n                CASE\n                    WHEN wp.account_type = 'LUGPA' THEN 'Y'\n                    WHEN wp.account_type IN ('ACADEMIC HEALTH SYSTEM', 'NON ACADEMIC HEALTH SYSTEM') THEN 'Y'\n                    WHEN wp.account_type IN ('FEDERAL', 'COMPREHENSIVE CARE CENTER') THEN 'Y'\n                    WHEN tgt.kam_network_target_flag = 'Y' OR tgt.kam_child_target_flag = 'Y' OR tgt.hsd_target_flag = 'Y' THEN 'Y'\n                    WHEN COALESCE(hp.backbone_hcp_count, 0) > 0 THEN 'Y'\n                    -- UPDATED: Use L24M consistently (24-month period)\n                    WHEN COALESCE(tm.l24m_turbt_claims, 0) > 0\n                      OR COALESCE(tm.l24m_tice_bcg_claims, 0) > 0 THEN 'Y'\n                    WHEN COALESCE(ds.total_branded_sales_24mo, 0) > 0 THEN 'Y'\n                    -- BBN-012: Include accounts with sales activity data\n                    WHEN aa.has_activity = 'Y' THEN 'Y'\n                    ELSE 'N'\n                END\n        END AS initial_backbone_flag\n    FROM all_accounts m\n    LEFT JOIN hierarchy h ON m.kmk_hco_id = h.kmk_hco_id\n    LEFT JOIN with_priority wp ON m.kmk_hco_id = wp.kmk_hco_id\n    LEFT JOIN sfe_targets tgt ON m.kmk_hco_id = tgt.kmk_hco_id\n    LEFT JOIN hcp_profile hp ON m.kmk_hco_id = hp.kmk_hco_id\n    LEFT JOIN treatment_metrics tm ON m.kmk_hco_id = tm.kmk_hco_id\n    LEFT JOIN bc_metrics bc ON m.kmk_hco_id = bc.kmk_hco_id\n    LEFT JOIN ddd_sales ds ON m.kmk_hco_id = ds.kmk_hco_id\n    LEFT JOIN account_activity aa ON m.kmk_hco_id = aa.kmk_hco_id\n),\n\n-- Step 2: Identify parents with backbone children\n-- Find all parent accounts (L1, L2, L3) that have at least one child with backbone flag\n-- OPTIMIZED: Uses UNION ALL instead of OR joins for better Snowflake performance\nparents_with_backbone_children AS (\n    -- FIX 2026-01-15 (BBN-005): Remove hierarchy_level restriction to match test logic\n    -- Test matches by account_id only, not by hierarchy_level\n    -- L1 parents: children with backbone flag where account_id_l1 is not NULL\n    SELECT DISTINCT\n        parent_h.kmk_hco_id AS parent_kmk_hco_id\n    FROM hierarchy child_h\n    INNER JOIN initial_backbone_flags ibf ON child_h.kmk_hco_id = ibf.kmk_hco_id\n    INNER JOIN hierarchy parent_h ON child_h.account_id_l1 = parent_h.account_id\n    WHERE ibf.initial_backbone_flag = 'Y'\n      AND child_h.account_id_l1 IS NOT NULL\n      -- REMOVED: AND parent_h.hierarchy_level = 'L1'  -- Too restrictive, test doesn't check this\n      AND child_h.kmk_hco_id != parent_h.kmk_hco_id  -- Exclude self-references\n    \n    UNION\n    \n    -- L2 parents: children with backbone flag where account_id_l2 is not NULL and different from L1\n    SELECT DISTINCT\n        parent_h.kmk_hco_id AS parent_kmk_hco_id\n    FROM hierarchy child_h\n    INNER JOIN initial_backbone_flags ibf ON child_h.kmk_hco_id = ibf.kmk_hco_id\n    INNER JOIN hierarchy parent_h ON child_h.account_id_l2 = parent_h.account_id\n    WHERE ibf.initial_backbone_flag = 'Y'\n      AND child_h.account_id_l2 IS NOT NULL\n      -- FIX 2026-01-16: Use COALESCE to handle NULL comparison (NULL != X returns NULL, not TRUE)\n      AND COALESCE(child_h.account_id_l2 != child_h.account_id_l1, TRUE)  -- Exclude if L2 is same as L1\n      AND child_h.kmk_hco_id != parent_h.kmk_hco_id  -- Exclude self-references\n    \n    UNION\n    \n    -- L3 parents: children with backbone flag where account_id_l3 is not NULL and different from L1/L2\n    SELECT DISTINCT\n        parent_h.kmk_hco_id AS parent_kmk_hco_id\n    FROM hierarchy child_h\n    INNER JOIN initial_backbone_flags ibf ON child_h.kmk_hco_id = ibf.kmk_hco_id\n    INNER JOIN hierarchy parent_h ON child_h.account_id_l3 = parent_h.account_id\n    WHERE ibf.initial_backbone_flag = 'Y'\n      AND child_h.account_id_l3 IS NOT NULL\n      -- FIX 2026-01-16: Use COALESCE to handle NULL comparison (NULL != X returns NULL, not TRUE)\n      AND COALESCE(child_h.account_id_l3 != COALESCE(child_h.account_id_l2, child_h.account_id_l1), TRUE)  -- Exclude if L3 is same as L1/L2\n      AND child_h.kmk_hco_id != parent_h.kmk_hco_id  -- Exclude self-references\n    -- Note: Practice locations CAN propagate backbone to parents (if PL is backbone, parent should be too)\n),\n\n\n\nfinal_output AS (\n    SELECT\n        -- ============================================================\n        -- Core Identity (4 columns)\n        -- ============================================================\n        m.kmk_hco_id,\n        -- Enhanced: Inherit dh_id from parent for practice locations without their own dh_id\n        -- This addresses DV_036 validation issue for practice locations\n        CASE \n            WHEN m.firm_type = 'Practice Location' \n                 AND m.dh_id IS NULL \n                 AND pa.parent_dh_id IS NOT NULL\n            THEN pa.parent_dh_id\n            ELSE m.dh_id\n        END AS dh_id,\n        h.account_id,\n        m.org_name,\n\n        -- ============================================================\n        -- Organization Information (4 columns) - Section 5.8 Classification\n        -- ============================================================\n        m.firm_type,\n        -- Transform account_type to P1-P4 format (matching DEV APT format)\n        -- Quarterly freeze: account-level only (skipped on --full-refresh)\n        -- Uses LEAST(frozen_rank, computed_rank) to only upgrade, never downgrade\n        \n        CASE wp.account_type\n            WHEN 'LUGPA' THEN 'P1_LUGPA'\n            WHEN 'ACADEMIC HEALTH SYSTEM' THEN 'P2_ACADEMIC'\n            WHEN 'NON ACADEMIC HEALTH SYSTEM' THEN 'P2_NON-ACADEMIC'\n            WHEN 'FEDERAL' THEN 'P3_ FEDERAL'\n            WHEN 'COMPREHENSIVE CARE CENTER' THEN 'P3_CCS'\n            WHEN 'SMALL INDEPENDENT CENTER' THEN 'P4_SMALL_INDEP_Ctr'\n            ELSE wp.account_type\n        END AS account_type,\n        wp.account_type_priority,\n        \n        -- account_type_source removed (2026-02-02 cleanup) - debug info only\n\n        -- ============================================================\n        -- Headquarters Address (5 columns)\n        -- Use parent/ultimate parent address as fallback if account address is NULL\n        -- If still NULL, construct minimal address from city/state/zip\n        -- ============================================================\n        COALESCE(\n            m.hq_address_line_1, \n            pa.parent_hq_address_line_1,\n            CASE \n                WHEN m.hq_city IS NOT NULL AND m.hq_state IS NOT NULL \n                THEN m.hq_city || ', ' || m.hq_state || ' ' || COALESCE(m.hq_zip_code, '')\n                ELSE NULL\n            END\n        ) AS hq_address_line_1,\n        COALESCE(m.hq_address_line_2, pa.parent_hq_address_line_2) AS hq_address_line_2,\n        COALESCE(m.hq_city, pa.parent_hq_city) AS hq_city,\n        COALESCE(m.hq_state, pa.parent_hq_state) AS hq_state,\n        COALESCE(m.hq_zip_code, pa.parent_hq_zip_code) AS hq_zip_code,\n\n        -- ============================================================\n        -- Hierarchy & Structure - HIR-001, HIR-002\n        -- ============================================================\n        h.hierarchy_level,\n        h.parent_account_id,\n        h.ultimate_parent_id,\n        m.network_id,\n        m.network_name,\n        COALESCE(h.pe_flag, 'N') AS pe_flag,\n\n        -- ============================================================\n        -- Hierarchy Parent IDs (4 columns)\n        -- ============================================================\n        h.account_id_l1,\n        h.account_id_l2,\n        h.account_id_l3,\n        h.account_id_l4,\n\n        -- Source flags removed (2026-02-02 cleanup) - get from mdm_customer_xref_hco if needed\n        -- Removed: source_dh, source_ddd, source_medscout, source_claims\n\n        -- ============================================================\n        -- Backbone Flag - BBN-001, BBN-002, BBN-005\n        -- BBN-005: Parent accounts get backbone flag if any child has backbone flag\n        -- bc_patient_count removed (2026-02-02 cleanup) - get from adm_claims_metrics_long\n        -- ============================================================\n        CASE\n            -- Practice locations use their initial flag directly (no parent propagation)\n            WHEN m.firm_type = 'Practice Location' THEN ibf.initial_backbone_flag\n            -- Non-practice locations: 'Y' if parent propagation OR initial criteria met\n            ELSE\n                CASE\n                    WHEN pbc.parent_kmk_hco_id IS NOT NULL THEN 'Y'  -- BBN-005: parent propagation\n                    WHEN ibf.initial_backbone_flag = 'Y' THEN 'Y'   -- Own criteria met\n                    ELSE 'N'\n                END\n        END AS cust_backbone_flag,\n\n        -- ============================================================\n        -- KAM Target Flags - TGT-003, TGT-010, TGT-011, TGT-012\n        -- Sourced from adm_sfe_hco_targets\n        -- target_version removed (2026-02-02 cleanup) - get from adm_sfe_hco_targets if needed\n        -- ============================================================\n        CASE WHEN tgt.kam_network_target_flag = 'Y' THEN 1 ELSE 0 END AS network_target_flag,\n        tgt.kam_network_decile AS network_decile,\n        CASE WHEN tgt.kam_child_target_flag = 'Y' THEN 1 ELSE 0 END AS child_target_flag,\n        tgt.kam_child_decile AS child_decile,\n        -- NETWORK_ACCOUNT and CHILD_SITE flags (APT_V2 logic)\n        -- Post-freeze override: If freeze upgraded account to LUGPA, fix the flags\n        -- (network_account_flag is computed pre-freeze in account_ranking CTE)\n        \n        ar.network_account_flag AS network_account_flag,\n        ar.child_site_flag AS child_site_flag,\n        \n        -- NETWORK_RANK and CHILD_RANK (APT_V2 logic - Phase 5)\n        ar.network_rank AS network_rank,\n        ar.child_rank AS child_rank,\n        CASE\n            WHEN tgt.kam_network_target_flag = 'Y' OR tgt.kam_child_target_flag = 'Y' THEN 'Y'\n            ELSE 'N'\n        END AS kam_target_flag,\n\n        -- ============================================================\n        -- HSD Target Flag (1 column) - TGT-020\n        -- ============================================================\n        COALESCE(tgt.hsd_target_flag, 'N') AS hsd_target_flag,\n        tgt.hsd_rank,\n\n        -- ============================================================\n        -- MSL Target Flag\n        -- ============================================================\n        COALESCE(tgt.msl_target_flag, 'N') AS msl_target_flag,\n\n        -- Territory Assignments removed (2026-02-02 cleanup) - APT joins std_zip_territory directly via ZIP\n        -- Removed: kam_territory, kam_territory_name, kam_region, kam_region_name,\n        --          hsd_territory, hsd_territory_name, msl_territory, msl_territory_name\n\n        -- ============================================================\n        -- Network Parent Information (3 columns)\n        -- ============================================================\n        m.network_parent_id,\n        m.network_parent_name,\n        m.network_parent_firm_type,\n\n        -- primary_source removed (2026-02-02 cleanup) - debug/lineage info only\n\n        -- ============================================================\n        -- HCP Profile Metrics (4 columns) - PRF-001 to PRF-004\n        -- total_hcp_count, backbone_hcp_count removed (2026-02-02 cleanup) - get from mdm_best_affiliation\n        -- ============================================================\n        COALESCE(hp.urologist_count, 0) AS urologist_count,\n        COALESCE(hp.urologist_w_claims, 0) AS urologist_w_claims,\n        -- Rollup metrics (including all descendant HCOs in hierarchy)\n        COALESCE(hp_rollup.urologist_count_total, hp.urologist_count, 0) AS urologist_count_total,\n        COALESCE(hp_rollup.urologist_w_claims_total, hp.urologist_w_claims, 0) AS urologist_w_claims_total,\n\n        -- ============================================================\n        -- SFE Output logic (Restored from legacy logic)\n        -- ============================================================\n        CASE \n            WHEN tgt.kam_network_target_flag = 'Y' AND tgt.kam_child_target_flag = 'Y' THEN 'Admin & Sales' \n            WHEN tgt.kam_network_target_flag = 'Y' AND (tgt.kam_child_target_flag = 'N' OR tgt.kam_child_target_flag IS NULL) THEN 'Admin' \n            WHEN (tgt.kam_network_target_flag = 'N' OR tgt.kam_network_target_flag IS NULL) AND tgt.kam_child_target_flag = 'Y' THEN 'Sales' \n            ELSE NULL \n        END AS recommended_engagement_type,\n        CASE WHEN (tgt.kam_network_target_flag = 'Y' OR tgt.kam_child_target_flag = 'Y' OR tgt.hsd_target_flag = 'Y') THEN 'Y' ELSE 'N' END AS display_abr,\n\n        -- ============================================================\n        -- Metadata (2 columns)\n        -- ============================================================\n        CURRENT_TIMESTAMP() AS modified_date,\n        (SELECT data_date FROM data_date_ref) AS data_date\n\n    FROM all_accounts m\n    LEFT JOIN hierarchy h ON m.kmk_hco_id = h.kmk_hco_id\n    -- parent_addresses: Only used for practice location dh_id inheritance and address fallback\n    LEFT JOIN parent_addresses pa ON m.kmk_hco_id = pa.kmk_hco_id\n    -- source_flags removed (2026-02-02 cleanup)\n    LEFT JOIN bc_metrics bc ON m.kmk_hco_id = bc.kmk_hco_id\n    LEFT JOIN treatment_metrics tm ON m.kmk_hco_id = tm.kmk_hco_id\n    LEFT JOIN ddd_sales ds ON m.kmk_hco_id = ds.kmk_hco_id\n    LEFT JOIN hcp_profile hp ON m.kmk_hco_id = hp.kmk_hco_id\n    LEFT JOIN hcp_profile_rollup hp_rollup ON m.kmk_hco_id = hp_rollup.kmk_hco_id\n\n    -- Account Type Classification (Section 5.8)\n    LEFT JOIN with_priority wp ON m.kmk_hco_id = wp.kmk_hco_id\n\n    -- SFE Targets\n    LEFT JOIN sfe_targets tgt ON m.kmk_hco_id = tgt.kmk_hco_id\n    -- sfe_territory removed (2026-02-02 cleanup) - APT joins directly via ZIP\n\n    -- Account Ranking (APT_V2 logic)\n    LEFT JOIN account_ranking_final ar ON m.kmk_hco_id = ar.kmk_hco_id\n\n    -- BBN-005: Parent backbone propagation\n    LEFT JOIN parents_with_backbone_children pbc ON m.kmk_hco_id = pbc.parent_kmk_hco_id\n\n    -- Backbone flag (DRY refactor): reuse initial_backbone_flags instead of duplicating logic\n    LEFT JOIN initial_backbone_flags ibf ON m.kmk_hco_id = ibf.kmk_hco_id\n\n    \n)\n-- Deduplicate: Ensure one row per kmk_hco_id\n-- If duplicates exist, prioritize by account_type_priority (P1 > P2 > P3 > P4)\nSELECT * FROM final_output\nQUALIFY ROW_NUMBER() OVER (PARTITION BY kmk_hco_id ORDER BY\n    account_type_priority,\n    account_type,\n    modified_date DESC\n) = 1", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["kmk_hco_id"], "time_spine": null}, "model.CGOncology_MDM.adm_pipeline_trend": {"database": "CGONCOLOGY_TEST", "schema": "ARCHIVE", "name": "adm_pipeline_trend", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "adm/adm_pipeline_trend.sql", "original_file_path": "models/adm/adm_pipeline_trend.sql", "unique_id": "model.CGOncology_MDM.adm_pipeline_trend", "fqn": ["CGOncology_MDM", "adm", "adm_pipeline_trend"], "alias": "adm_pipeline_trend", "checksum": {"name": "sha256", "checksum": "f20081f878bdb378531341eff541b5568953c59d93102c0a5a60708ce985e818"}, "config": {"enabled": true, "alias": null, "schema": "ARCHIVE", "database": null, "tags": ["layer_4_adm", "customer_backbone", "pipeline_monitoring"], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_4_adm", "customer_backbone", "pipeline_monitoring"], "description": "Pipeline metrics 12-month trend view.\nShows all historical snapshots with MoM change calculation.\nTOP20 traces current top-20 entities backward through all snapshots.\n", "columns": {"data_date": {"name": "data_date", "description": "Pipeline data date", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "metric_group": {"name": "metric_group", "description": "Category of metric", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "metric_name": {"name": "metric_name", "description": "What is being measured", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "mom_change": {"name": "mom_change", "description": "Month-over-month absolute change", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "mom_change_pct": {"name": "mom_change_pct", "description": "Month-over-month percentage change", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/adm/schema.yml", "build_path": null, "unrendered_config": {"schema": "ARCHIVE", "materialized": "view", "tags": ["pipeline_monitoring"]}, "created_at": 1770177079.5896199, "relation_name": "CGONCOLOGY_TEST.ARCHIVE.adm_pipeline_trend", "raw_code": "{{\n    config(\n        schema='ARCHIVE',\n        materialized='view',\n        tags=['pipeline_monitoring']\n    )\n}}\n\n/*\nADM_PIPELINE_TREND - Pipeline Metrics Trend View (12-Month)\n\nPurpose: Shows all historical snapshots with MoM change calculation.\n         Use for trend analysis, seasonal pattern detection, and\n         tracking top-20 account history over time.\n\nTop 20 Account History:\n  Takes the CURRENT top 20 (latest snapshot) and traces their values\n  backward through all historical snapshots to show 12-month trends.\n\nGrain: One row per (data_date, metric_group, metric_name, dimension_value, entity_id, rank_position)\n*/\n\nWITH deduped_dates AS (\n    -- Keep only the latest run for each data_date (handles re-runs)\n    SELECT data_date,\n           MAX(run_timestamp) AS latest_run\n    FROM {{ ref('adm_pipeline_snapshot') }}\n    GROUP BY data_date\n),\n\nall_snapshots AS (\n    SELECT\n        s.data_date,\n        s.run_timestamp,\n        s.metric_group,\n        s.metric_name,\n        s.dimension_value,\n        s.entity_id,\n        s.metric_value,\n        s.metric_value_2,\n        s.rank_position\n    FROM {{ ref('adm_pipeline_snapshot') }} s\n    INNER JOIN deduped_dates d\n        ON s.data_date = d.data_date\n        AND s.run_timestamp = d.latest_run\n),\n\n-- For non-TOP20 metrics: standard LAG-based trend\nstandard_trend AS (\n    SELECT\n        data_date,\n        run_timestamp,\n        metric_group,\n        metric_name,\n        dimension_value,\n        entity_id,\n        metric_value,\n        metric_value_2,\n        rank_position,\n        LAG(metric_value) OVER (\n            PARTITION BY metric_group, metric_name,\n                         COALESCE(dimension_value, '___NULL___'),\n                         COALESCE(entity_id, '___NULL___')\n            ORDER BY data_date\n        ) AS prev_value\n    FROM all_snapshots\n    WHERE metric_group != 'TOP20_HCO'\n),\n\n-- For TOP20: trace current top 20 entities backward through history\nlatest_date AS (\n    SELECT MAX(data_date) AS max_date\n    FROM all_snapshots\n),\n\ncurrent_top20_entities AS (\n    -- Get the entity_ids that are in the TOP20 in the latest snapshot\n    SELECT DISTINCT entity_id, metric_name\n    FROM all_snapshots s\n    INNER JOIN latest_date ld ON s.data_date = ld.max_date\n    WHERE s.metric_group = 'TOP20_HCO'\n),\n\ntop20_history AS (\n    -- Trace these entities through all historical snapshots\n    SELECT\n        s.data_date,\n        s.run_timestamp,\n        s.metric_group,\n        s.metric_name,\n        s.dimension_value,\n        s.entity_id,\n        s.metric_value,\n        s.metric_value_2,\n        s.rank_position,\n        LAG(s.metric_value) OVER (\n            PARTITION BY s.metric_name, s.entity_id\n            ORDER BY s.data_date\n        ) AS prev_value\n    FROM all_snapshots s\n    INNER JOIN current_top20_entities t\n        ON s.entity_id = t.entity_id\n        AND s.metric_name = t.metric_name\n    WHERE s.metric_group = 'TOP20_HCO'\n),\n\ncombined AS (\n    SELECT * FROM standard_trend\n    UNION ALL\n    SELECT * FROM top20_history\n)\n\nSELECT\n    data_date,\n    run_timestamp,\n    metric_group,\n    metric_name,\n    dimension_value,\n    entity_id,\n    metric_value,\n    metric_value_2,\n    rank_position,\n    prev_value,\n    (metric_value - prev_value) AS mom_change,\n    CASE\n        WHEN prev_value IS NULL OR prev_value = 0 THEN NULL\n        ELSE ROUND(((metric_value - prev_value) / prev_value) * 100, 2)\n    END AS mom_change_pct\nFROM combined", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_pipeline_snapshot", "package": null, "version": null}, {"name": "adm_pipeline_snapshot", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.adm_pipeline_snapshot"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}, "model.CGOncology_MDM.adm_address_best_ddd_metrics_wide": {"database": "CGONCOLOGY_TEST", "schema": "ADM", "name": "adm_address_best_ddd_metrics_wide", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "adm/adm_address_best_ddd_metrics_wide.sql", "original_file_path": "models/adm/adm_address_best_ddd_metrics_wide.sql", "unique_id": "model.CGOncology_MDM.adm_address_best_ddd_metrics_wide", "fqn": ["CGOncology_MDM", "adm", "adm_address_best_ddd_metrics_wide"], "alias": "adm_address_best_ddd_metrics_wide", "checksum": {"name": "sha256", "checksum": "aec57bb7e0870fcf26395159bf59886a453eb23517f34073a3bf39cfdfa52c95"}, "config": {"enabled": true, "alias": null, "schema": "ADM", "database": null, "tags": ["layer_4_adm", "customer_backbone", "customer_backbone", "adm", "metrics", "ddd", "address_best"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_4_adm", "customer_backbone", "adm", "metrics", "ddd", "address_best"], "description": "DDD sales metrics aggregated to address-best HCO level (wide format).\nPivots metrics from long to wide format with M01-M24, rolling, quarterly, annual columns.\nBusiness Rules: ABH-001 to ABH-005, DDD-001 to DDD-005\nGrain: (kmk_hco_id, metric_category) where kmk_hco_id = address_best_hco_id\n", "columns": {"kmk_hco_id": {"name": "kmk_hco_id", "description": "Address-best HCO identifier (primary key with metric_category)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "metric_category": {"name": "metric_category", "description": "Product category", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "address_key": {"name": "address_key", "description": "Composite address key", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "address_group_count": {"name": "address_group_count", "description": "Count of HCOs in address group", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "contributing_hco_count": {"name": "contributing_hco_count", "description": "Count of source HCOs contributing", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "outlet_count": {"name": "outlet_count", "description": "Distinct outlet count", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/adm/schema.yml", "build_path": null, "unrendered_config": {"schema": "ADM", "materialized": "table", "tags": ["customer_backbone", "adm", "metrics", "ddd", "address_best"]}, "created_at": 1770177079.589108, "relation_name": "CGONCOLOGY_TEST.ADM.adm_address_best_ddd_metrics_wide", "raw_code": "{{\n    config(\n        schema='ADM',\n        materialized='table',\n        tags=['customer_backbone', 'adm', 'metrics', 'ddd', 'address_best']\n    )\n}}\n\n/*\nADM_ADDRESS_BEST_DDD_METRICS_WIDE - Address-Best HCO DDD Metrics in Wide Format\nBusiness Rules: ABH-001 to ABH-005, DDD-001 to DDD-005\n\nPurpose: Pivots address-best DDD metrics from long to wide format, similar to\nadm_ddd_metrics_wide but aggregated at the address-best level.\n\nGrain: One row per (address_best_hco_id, metric_category)\n\nPeriod Columns:\n- Monthly: M01-M24 (sales and units)\n- Rolling: L3M, L6M, L12M, L18M, L24M (sales and units)\n- Quarterly: Q01-Q08 (sales and units)\n- Annual: YTD, PYTD, PY, P2Y, QTD (sales and units)\n- Calendar Years: CY, PY_CY, P2Y_CY (sales and units)\n- TOTAL: All-time (sales and units)\n\nAdditional Columns:\n- outlet_count: Count of distinct DDD outlets\n- contributing_hco_count: Count of HCOs aggregated to this address_best\n- address_group_count: Count of HCOs sharing this address\n*/\n\n-- Get data_date reference\nWITH data_date_ref AS (\n    SELECT DISTINCT data_date, YEAR(data_date) AS current_year\n    FROM {{ ref('ref_time_periods') }}\n    LIMIT 1\n),\n\n-- Get address_best attributes from bridge table and hierarchy\naddress_best_attributes AS (\n    SELECT\n        ab.kmk_hco_id AS address_best_hco_id,\n        h.dh_id,\n        h.org_name,\n        h.hierarchy_level,\n        m.account_type,\n        h.firm_type,\n        h.hq_state,\n        h.kam_territory,\n        h.kam_region,\n        ab.address_key,\n        ab.address_group_count\n    FROM {{ ref('ref_address_best_hco') }} ab\n    LEFT JOIN {{ ref('adm_hco_hierarchy') }} h ON ab.kmk_hco_id = h.kmk_hco_id\n    LEFT JOIN {{ ref('adm_hco_master') }} m ON ab.kmk_hco_id = m.kmk_hco_id\n    WHERE ab.is_address_best = 'Y'\n),\n\n-- Long metrics filtered to address_best only\nlong_metrics AS (\n    SELECT\n        entity_id AS address_best_hco_id,\n        metric_category,\n        period_key,\n        period_type,\n        sales_amount,\n        units_count,\n        outlet_count,\n        contributing_hco_count,\n        data_date\n    FROM {{ ref('adm_address_best_ddd_metrics_long') }}\n    WHERE entity_type = 'ADDRESS_BEST_HCO'\n),\n\n-- Pivot to wide format - GROUP BY (address_best_hco_id, metric_category)\npivoted_metrics AS (\n    SELECT\n        m.address_best_hco_id,\n        m.metric_category,\n        MAX(m.data_date) AS data_date,\n\n        -- MONTHLY SALES (M01-M24)\n        COALESCE(MAX(CASE WHEN period_key = 'M01' THEN sales_amount END), 0) AS M01_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M02' THEN sales_amount END), 0) AS M02_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M03' THEN sales_amount END), 0) AS M03_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M04' THEN sales_amount END), 0) AS M04_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M05' THEN sales_amount END), 0) AS M05_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M06' THEN sales_amount END), 0) AS M06_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M07' THEN sales_amount END), 0) AS M07_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M08' THEN sales_amount END), 0) AS M08_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M09' THEN sales_amount END), 0) AS M09_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M10' THEN sales_amount END), 0) AS M10_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M11' THEN sales_amount END), 0) AS M11_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M12' THEN sales_amount END), 0) AS M12_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M13' THEN sales_amount END), 0) AS M13_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M14' THEN sales_amount END), 0) AS M14_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M15' THEN sales_amount END), 0) AS M15_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M16' THEN sales_amount END), 0) AS M16_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M17' THEN sales_amount END), 0) AS M17_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M18' THEN sales_amount END), 0) AS M18_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M19' THEN sales_amount END), 0) AS M19_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M20' THEN sales_amount END), 0) AS M20_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M21' THEN sales_amount END), 0) AS M21_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M22' THEN sales_amount END), 0) AS M22_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M23' THEN sales_amount END), 0) AS M23_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'M24' THEN sales_amount END), 0) AS M24_SALES,\n\n        -- MONTHLY UNITS (M01-M24)\n        COALESCE(MAX(CASE WHEN period_key = 'M01' THEN units_count END), 0) AS M01_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M02' THEN units_count END), 0) AS M02_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M03' THEN units_count END), 0) AS M03_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M04' THEN units_count END), 0) AS M04_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M05' THEN units_count END), 0) AS M05_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M06' THEN units_count END), 0) AS M06_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M07' THEN units_count END), 0) AS M07_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M08' THEN units_count END), 0) AS M08_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M09' THEN units_count END), 0) AS M09_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M10' THEN units_count END), 0) AS M10_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M11' THEN units_count END), 0) AS M11_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M12' THEN units_count END), 0) AS M12_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M13' THEN units_count END), 0) AS M13_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M14' THEN units_count END), 0) AS M14_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M15' THEN units_count END), 0) AS M15_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M16' THEN units_count END), 0) AS M16_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M17' THEN units_count END), 0) AS M17_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M18' THEN units_count END), 0) AS M18_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M19' THEN units_count END), 0) AS M19_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M20' THEN units_count END), 0) AS M20_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M21' THEN units_count END), 0) AS M21_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M22' THEN units_count END), 0) AS M22_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M23' THEN units_count END), 0) AS M23_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'M24' THEN units_count END), 0) AS M24_UNITS,\n\n        -- ROLLING SALES (L3M-L24M)\n        COALESCE(MAX(CASE WHEN period_key = 'L3M' THEN sales_amount END), 0) AS L3M_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'L6M' THEN sales_amount END), 0) AS L6M_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'L12M' THEN sales_amount END), 0) AS L12M_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'L18M' THEN sales_amount END), 0) AS L18M_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'L24M' THEN sales_amount END), 0) AS L24M_SALES,\n\n        -- ROLLING UNITS (L3M-L24M)\n        COALESCE(MAX(CASE WHEN period_key = 'L3M' THEN units_count END), 0) AS L3M_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'L6M' THEN units_count END), 0) AS L6M_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'L12M' THEN units_count END), 0) AS L12M_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'L18M' THEN units_count END), 0) AS L18M_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'L24M' THEN units_count END), 0) AS L24M_UNITS,\n\n        -- QUARTERLY SALES (Q01-Q08)\n        COALESCE(MAX(CASE WHEN period_key = 'Q01' THEN sales_amount END), 0) AS Q01_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'Q02' THEN sales_amount END), 0) AS Q02_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'Q03' THEN sales_amount END), 0) AS Q03_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'Q04' THEN sales_amount END), 0) AS Q04_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'Q05' THEN sales_amount END), 0) AS Q05_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'Q06' THEN sales_amount END), 0) AS Q06_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'Q07' THEN sales_amount END), 0) AS Q07_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'Q08' THEN sales_amount END), 0) AS Q08_SALES,\n\n        -- QUARTERLY UNITS (Q01-Q08)\n        COALESCE(MAX(CASE WHEN period_key = 'Q01' THEN units_count END), 0) AS Q01_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'Q02' THEN units_count END), 0) AS Q02_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'Q03' THEN units_count END), 0) AS Q03_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'Q04' THEN units_count END), 0) AS Q04_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'Q05' THEN units_count END), 0) AS Q05_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'Q06' THEN units_count END), 0) AS Q06_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'Q07' THEN units_count END), 0) AS Q07_UNITS,\n        COALESCE(MAX(CASE WHEN period_key = 'Q08' THEN units_count END), 0) AS Q08_UNITS,\n\n        -- ANNUAL SALES (YTD, PYTD, PY, P2Y, QTD)\n        COALESCE(MAX(CASE WHEN period_type = 'YTD' THEN sales_amount END), 0) AS YTD_SALES,\n        COALESCE(MAX(CASE WHEN period_type = 'PYTD' THEN sales_amount END), 0) AS PYTD_SALES,\n        COALESCE(MAX(CASE WHEN period_type = 'PY' THEN sales_amount END), 0) AS PY_SALES,\n        COALESCE(MAX(CASE WHEN period_type = 'P2Y' THEN sales_amount END), 0) AS P2Y_SALES,\n        COALESCE(MAX(CASE WHEN period_type = 'QTD' THEN sales_amount END), 0) AS QTD_SALES,\n\n        -- ANNUAL UNITS (YTD, PYTD, PY, P2Y, QTD)\n        COALESCE(MAX(CASE WHEN period_type = 'YTD' THEN units_count END), 0) AS YTD_UNITS,\n        COALESCE(MAX(CASE WHEN period_type = 'PYTD' THEN units_count END), 0) AS PYTD_UNITS,\n        COALESCE(MAX(CASE WHEN period_type = 'PY' THEN units_count END), 0) AS PY_UNITS,\n        COALESCE(MAX(CASE WHEN period_type = 'P2Y' THEN units_count END), 0) AS P2Y_UNITS,\n        COALESCE(MAX(CASE WHEN period_type = 'QTD' THEN units_count END), 0) AS QTD_UNITS,\n\n        -- TOTAL (All-Time)\n        COALESCE(MAX(CASE WHEN period_key = 'TOTAL' THEN sales_amount END), 0) AS TOTAL_SALES,\n        COALESCE(MAX(CASE WHEN period_key = 'TOTAL' THEN units_count END), 0) AS TOTAL_UNITS,\n\n        -- OUTLET COUNT (from L12M rolling period)\n        COALESCE(MAX(CASE WHEN period_key = 'L12M' THEN outlet_count END), 0) AS outlet_count,\n\n        -- CONTRIBUTING HCO COUNT (max across periods)\n        MAX(contributing_hco_count) AS contributing_hco_count\n\n    FROM long_metrics m\n    GROUP BY m.address_best_hco_id, m.metric_category\n),\n\n-- Calendar year metrics (need to pivot dynamically based on current year)\ncalendar_year_metrics AS (\n    SELECT\n        m.address_best_hco_id,\n        m.metric_category,\n        COALESCE(MAX(CASE WHEN REGEXP_LIKE(period_key, '^[0-9]{4}$') AND TRY_CAST(period_key AS INTEGER) = ddr.current_year THEN sales_amount END), 0) AS CY_SALES,\n        COALESCE(MAX(CASE WHEN REGEXP_LIKE(period_key, '^[0-9]{4}$') AND TRY_CAST(period_key AS INTEGER) = ddr.current_year - 1 THEN sales_amount END), 0) AS PY_CY_SALES,\n        COALESCE(MAX(CASE WHEN REGEXP_LIKE(period_key, '^[0-9]{4}$') AND TRY_CAST(period_key AS INTEGER) = ddr.current_year - 2 THEN sales_amount END), 0) AS P2Y_CY_SALES,\n        COALESCE(MAX(CASE WHEN REGEXP_LIKE(period_key, '^[0-9]{4}$') AND TRY_CAST(period_key AS INTEGER) = ddr.current_year THEN units_count END), 0) AS CY_UNITS,\n        COALESCE(MAX(CASE WHEN REGEXP_LIKE(period_key, '^[0-9]{4}$') AND TRY_CAST(period_key AS INTEGER) = ddr.current_year - 1 THEN units_count END), 0) AS PY_CY_UNITS,\n        COALESCE(MAX(CASE WHEN REGEXP_LIKE(period_key, '^[0-9]{4}$') AND TRY_CAST(period_key AS INTEGER) = ddr.current_year - 2 THEN units_count END), 0) AS P2Y_CY_UNITS\n    FROM long_metrics m\n    CROSS JOIN data_date_ref ddr\n    WHERE m.period_type = 'CALENDAR_YEAR'\n    GROUP BY m.address_best_hco_id, m.metric_category\n),\n\n-- Join pivoted data with calendar year metrics\ncombined_metrics AS (\n    SELECT\n        p.*,\n        COALESCE(cy.CY_SALES, 0) AS CY_SALES,\n        COALESCE(cy.PY_CY_SALES, 0) AS PY_CY_SALES,\n        COALESCE(cy.P2Y_CY_SALES, 0) AS P2Y_CY_SALES,\n        COALESCE(cy.CY_UNITS, 0) AS CY_UNITS,\n        COALESCE(cy.PY_CY_UNITS, 0) AS PY_CY_UNITS,\n        COALESCE(cy.P2Y_CY_UNITS, 0) AS P2Y_CY_UNITS\n    FROM pivoted_metrics p\n    LEFT JOIN calendar_year_metrics cy\n        ON p.address_best_hco_id = cy.address_best_hco_id\n        AND p.metric_category = cy.metric_category\n)\n\n-- Final output with address_best attributes\nSELECT\n    -- Core address_best HCO columns\n    h.address_best_hco_id AS kmk_hco_id,\n    h.dh_id,\n    h.org_name,\n    h.hierarchy_level,\n    COALESCE(h.account_type, 'SMALL INDEPENDENT CENTER') AS account_type,\n    h.firm_type,\n    h.hq_state,\n    h.kam_territory,\n    h.kam_region,\n    h.address_key,\n    h.address_group_count,\n\n    -- Metric category\n    cm.metric_category,\n\n    -- Contributing HCO count and outlet count\n    cm.contributing_hco_count,\n    cm.outlet_count,\n\n    -- Monthly Sales (M01-M24)\n    cm.M01_SALES, cm.M02_SALES, cm.M03_SALES, cm.M04_SALES, cm.M05_SALES, cm.M06_SALES,\n    cm.M07_SALES, cm.M08_SALES, cm.M09_SALES, cm.M10_SALES, cm.M11_SALES, cm.M12_SALES,\n    cm.M13_SALES, cm.M14_SALES, cm.M15_SALES, cm.M16_SALES, cm.M17_SALES, cm.M18_SALES,\n    cm.M19_SALES, cm.M20_SALES, cm.M21_SALES, cm.M22_SALES, cm.M23_SALES, cm.M24_SALES,\n\n    -- Monthly Units (M01-M24)\n    cm.M01_UNITS, cm.M02_UNITS, cm.M03_UNITS, cm.M04_UNITS, cm.M05_UNITS, cm.M06_UNITS,\n    cm.M07_UNITS, cm.M08_UNITS, cm.M09_UNITS, cm.M10_UNITS, cm.M11_UNITS, cm.M12_UNITS,\n    cm.M13_UNITS, cm.M14_UNITS, cm.M15_UNITS, cm.M16_UNITS, cm.M17_UNITS, cm.M18_UNITS,\n    cm.M19_UNITS, cm.M20_UNITS, cm.M21_UNITS, cm.M22_UNITS, cm.M23_UNITS, cm.M24_UNITS,\n\n    -- Rolling Sales (L3M-L24M)\n    cm.L3M_SALES, cm.L6M_SALES, cm.L12M_SALES, cm.L18M_SALES, cm.L24M_SALES,\n\n    -- Rolling Units (L3M-L24M)\n    cm.L3M_UNITS, cm.L6M_UNITS, cm.L12M_UNITS, cm.L18M_UNITS, cm.L24M_UNITS,\n\n    -- Quarterly Sales (Q01-Q08)\n    cm.Q01_SALES, cm.Q02_SALES, cm.Q03_SALES, cm.Q04_SALES,\n    cm.Q05_SALES, cm.Q06_SALES, cm.Q07_SALES, cm.Q08_SALES,\n\n    -- Quarterly Units (Q01-Q08)\n    cm.Q01_UNITS, cm.Q02_UNITS, cm.Q03_UNITS, cm.Q04_UNITS,\n    cm.Q05_UNITS, cm.Q06_UNITS, cm.Q07_UNITS, cm.Q08_UNITS,\n\n    -- Annual Sales (YTD, PYTD, PY, P2Y, QTD)\n    cm.YTD_SALES, cm.PYTD_SALES, cm.PY_SALES, cm.P2Y_SALES, cm.QTD_SALES,\n\n    -- Annual Units (YTD, PYTD, PY, P2Y, QTD)\n    cm.YTD_UNITS, cm.PYTD_UNITS, cm.PY_UNITS, cm.P2Y_UNITS, cm.QTD_UNITS,\n\n    -- Calendar Year Sales\n    cm.CY_SALES, cm.PY_CY_SALES, cm.P2Y_CY_SALES,\n\n    -- Calendar Year Units\n    cm.CY_UNITS, cm.PY_CY_UNITS, cm.P2Y_CY_UNITS,\n\n    -- Total (All-Time)\n    cm.TOTAL_SALES, cm.TOTAL_UNITS,\n\n    -- Metadata\n    cm.data_date\n\nFROM combined_metrics cm\nLEFT JOIN address_best_attributes h ON cm.address_best_hco_id = h.address_best_hco_id", "doc_blocks": [], "language": "sql", "refs": [{"name": "ref_time_periods", "package": null, "version": null}, {"name": "ref_address_best_hco", "package": null, "version": null}, {"name": "adm_hco_hierarchy", "package": null, "version": null}, {"name": "adm_hco_master", "package": null, "version": null}, {"name": "adm_address_best_ddd_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.ref_time_periods", "model.CGOncology_MDM.ref_address_best_hco", "model.CGOncology_MDM.adm_hco_hierarchy", "model.CGOncology_MDM.adm_hco_master", "model.CGOncology_MDM.adm_address_best_ddd_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}, "model.CGOncology_MDM.ref_payor_types": {"database": "CGONCOLOGY_TEST", "schema": "ADM", "name": "ref_payor_types", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "adm/ref_payor_types.sql", "original_file_path": "models/adm/ref_payor_types.sql", "unique_id": "model.CGOncology_MDM.ref_payor_types", "fqn": ["CGOncology_MDM", "adm", "ref_payor_types"], "alias": "ref_payor_types", "checksum": {"name": "sha256", "checksum": "0c6c74ff77c0cdd633e384fc4cfdcdede968be1135d99f0ceda6022ccea2412a"}, "config": {"enabled": true, "alias": null, "schema": "ADM", "database": null, "tags": ["layer_4_adm", "customer_backbone", "customer_backbone", "adm", "reference"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_4_adm", "customer_backbone", "adm", "reference"], "description": "Payor type classification reference.\nBusiness Rules: MET-080 to MET-084\n", "columns": {"raw_payor_type": {"name": "raw_payor_type", "description": "Raw payor type from source data", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "canonical_payor_type": {"name": "canonical_payor_type", "description": "Canonical payor type", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/adm/schema.yml", "build_path": null, "unrendered_config": {"schema": "ADM", "materialized": "table", "tags": ["customer_backbone", "adm", "reference"]}, "created_at": 1770177079.584312, "relation_name": "CGONCOLOGY_TEST.ADM.ref_payor_types", "raw_code": "{{\n    config(\n        schema='ADM',\n        materialized='table',\n        tags=['customer_backbone', 'adm', 'reference']\n    )\n}}\n\n/*\nREF_PAYOR_TYPES - Payor Type Classification Reference\nBusiness Rules: MET-080 to MET-084\n\nMaps raw PATIENT_PRIMARY_PAYOR_TYPE values from claims data\nto 5 canonical payor types for standardized reporting.\n\nCanonical Types:\n- COMMERCIAL: Commercial/Private insurance (MET-080)\n- MEDICARE: Traditional Medicare FFS (MET-081)\n- MEDICAID: State Medicaid programs (MET-082)\n- MEDICARE_ADVANTAGE: Medicare Part C (MET-083)\n- OTHER: All other payor types (MET-084)\n*/\n\nSELECT\n    raw_payor_type,\n    canonical_payor_type,\n    payor_type_order,\n    description\nFROM (VALUES\n    -- COMMERCIAL (MET-080)\n    ('Commercial', 'COMMERCIAL', 1, 'Commercial/Private insurance'),\n    ('Indemnity Insurance', 'COMMERCIAL', 1, 'Commercial indemnity plans'),\n\n    -- MEDICARE (MET-081)\n    ('Medicare', 'MEDICARE', 2, 'Traditional Medicare (Fee-for-Service)'),\n\n    -- MEDICAID (MET-082)\n    ('Medicaid', 'MEDICAID', 3, 'State Medicaid programs'),\n\n    -- MEDICARE_ADVANTAGE (MET-083)\n    ('Medicare Advantage', 'MEDICARE_ADVANTAGE', 4, 'Medicare Part C managed care'),\n\n    -- OTHER (MET-084)\n    ('Other Government', 'OTHER', 5, 'Other government programs (VA, TRICARE, etc.)'),\n    ('Workers Comp', 'OTHER', 5, 'Workers compensation'),\n    ('Unknown', 'OTHER', 5, 'Unknown or unclassified payor'),\n    ('Other', 'OTHER', 5, 'Other payor types'),\n    ('Discount/Coupon', 'OTHER', 5, 'Discount programs and coupons'),\n    ('PBM', 'OTHER', 5, 'Pharmacy Benefit Manager'),\n    ('Automobile Medical', 'OTHER', 5, 'Auto insurance medical'),\n    ('Liability Medical', 'OTHER', 5, 'Liability insurance medical'),\n    ('Disability', 'OTHER', 5, 'Disability insurance')\n) AS t(raw_payor_type, canonical_payor_type, payor_type_order, description)", "doc_blocks": [], "language": "sql", "refs": [], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}, "model.CGOncology_MDM.adm_hco_hierarchy": {"database": "CGONCOLOGY_TEST", "schema": "ADM", "name": "adm_hco_hierarchy", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "adm/adm_hco_hierarchy.sql", "original_file_path": "models/adm/adm_hco_hierarchy.sql", "unique_id": "model.CGOncology_MDM.adm_hco_hierarchy", "fqn": ["CGOncology_MDM", "adm", "adm_hco_hierarchy"], "alias": "adm_hco_hierarchy", "checksum": {"name": "sha256", "checksum": "6fdeacc60fd30f583cf6d7d2b8f29464013734385e518b144876ca85f0d321fd"}, "config": {"enabled": true, "alias": null, "schema": "ADM", "database": null, "tags": ["layer_4_adm", "customer_backbone", "customer_backbone", "adm"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_4_adm", "customer_backbone", "adm"], "description": "HCO hierarchy structure with L1-L4 levels and parent relationships.\nBusiness Rules: HIR-001 to HIR-010\n", "columns": {"kmk_hco_id": {"name": "kmk_hco_id", "description": "KMK HCO identifier (primary key)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "hierarchy_level": {"name": "hierarchy_level", "description": "Hierarchy level (L1=Network Parent, L2=Network, L3=Account, L4=Practice Location)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "account_id_l1": {"name": "account_id_l1", "description": "L1 account ID", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "account_id_l2": {"name": "account_id_l2", "description": "L2 account ID", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "account_id_l3": {"name": "account_id_l3", "description": "L3 account ID", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "account_id_l4": {"name": "account_id_l4", "description": "L4 account ID", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/adm/schema.yml", "build_path": null, "unrendered_config": {"schema": "ADM", "materialized": "table", "tags": ["customer_backbone", "adm"]}, "created_at": 1770177079.5852768, "relation_name": "CGONCOLOGY_TEST.ADM.adm_hco_hierarchy", "raw_code": "{{\n    config(\n        schema='ADM',\n        materialized='table',\n        tags=['customer_backbone', 'adm']\n    )\n}}\n\n/*\nPROC-ADM-001: adm_hco_hierarchy - HCO Hierarchy (Flattened)\nSource: mdm_customer_master_hco, facility_to_facility_affiliation, config_mso_known_affiliations\nBusiness Rules: HIR-001 to HIR-024, NAE-001 to NAE-003, MSO-001 to MSO-005\n\nNETWORK AFFILIATION ENHANCEMENT (NAE-001, NAE-002, NAE-004):\n- NAE-001: Inherit network from Hospital/PG Parent (parent has network \u2192 child inherits)\n- NAE-002: Parent inherits network from co-located child (child has network \u2192 parent inherits)\n- NAE-004: Follow network chain (if network_id points to non-terminal entity, use that entity's network_id)\n  Fixes L3\u2192L3 references: Hospice\u2192Hospital\u2192Network becomes Hospice\u2192Network\n- NAE-003: REMOVED - was establishing parent relationship when co-located with no network (unnecessary)\n\nFULL MSO PE LOOKUP IMPLEMENTATION (Jan 2026 - MSO-005 REMOVED, MSO-001-SAFE RE-ENABLED):\n- MSO-001-SAFE: RE-ENABLED - F2F lookup with safeguard (only known MSO parents from seed can pull affiliates)\n  Fixes Solaris Health missing 20 urology group affiliates (e.g., UroPartners, Michigan Institute of Urology)\n- MSO-002: Network fallback if no MSO affiliation (PE = COALESCE(network_parent_id, network_id))\n- MSO-003: Priority for known MSOs from config_mso_known_affiliations seed file\n- MSO-004: Network override (if network_parent_id EXISTS and != pe_dh_id, use network_parent)\n- MSO-005: REMOVED - MSO self-reference removed so only seed-listed MSOs become L1\n\nMULTI-PASS HIERARCHY LEVEL ASSIGNMENT (Top-to-Bottom, Jan 2026):\n- Pass 1 - L1: PE self-reference (dh_id = resolved_pe_dh_id, only seed-listed MSOs from config_mso_known_affiliations)\n              OR triple self-reference (dh_id = network_parent_id = network_id)\n- Pass 2 - L2: network_id self-reference OR network_id points to L1\n- Pass 3 - L3: network_id points to L2 OR no network (standalone accounts) OR DDD-only backbone HCOs (dh_id IS NULL)\n- Pass 4 - L4: network_id points to L3 (deeper chains) OR practice locations\n- Practice locations: Default to L4 (could be L5 if parent is L4, but we cap at L4)\n- L1-L4 levels are mutually exclusive (each account belongs to exactly one level)\n- FIX 2026-01-12: DDD-only HCOs (dh_id IS NULL) that are in backbone are included in hierarchy as L3\n- FIX 2026-01-12: L1 MSOs restricted to seed-listed only (removed standalone MSO and MSO self-reference rules)\n*/\n\n-- Get data_date from ref_time_periods (single source of truth)\nWITH data_date_ref AS (\n    SELECT DISTINCT data_date\n    FROM {{ ref('ref_time_periods') }}\n    LIMIT 1\n),\n\nmaster AS (\n    SELECT\n        kmk_hco_id,\n        dh_id,\n        org_name,\n        firm_type,\n        NULL AS account_type,  -- account_type calculated in adm_hco_master, not available here\n        hq_state,\n        hq_zip_code,\n        CASE WHEN ddd_outlet_count > 0 THEN 'Y' ELSE 'N' END AS has_ddd_match,  -- Derived from DDD_OUTLET_COUNT\n        -- Address columns for NAE co-location matching\n        hq_address_line_1,\n        hq_city,\n        -- Parent relationship columns for NAE\n        hospital_parent_id,\n        hospital_parent_name,\n        pg_parent_id,\n        pg_parent_name,\n        -- Network/PE columns from MDM\n        network_id,\n        network_name,\n        network_firm_type,\n        network_parent_id,\n        network_parent_name,\n        network_parent_firm_type,\n        -- Territory columns - will be joined from SFE later, NULL for now\n        NULL AS kam_territory,\n        NULL AS kam_territory_name,\n        NULL AS kam_region,\n        NULL AS kam_region_name,\n        NULL AS hsd_territory,\n        NULL AS hsd_territory_name,\n        NULL AS msl_territory,\n        NULL AS msl_territory_name\n    FROM {{ ref('mdm_customer_master_hco') }}\n    -- PHASE 6: Practice locations are now included in master (firm_type='PRACTICE_LOCATION')\n    -- NOTE: All entities (DDD-only, practice locations, network entities) are already in mdm_customer_master_hco\n    --\n    -- KNOWN DATA QUALITY ISSUES:\n    -- 1. Orphaned Network ID References (2 cases):\n    --    - network_id = 19718 (\"Republic of Palau\") - referenced by 4 HCOs but doesn't exist as standalone entity in std_dh_hco\n    --    - network_id = 963287 (\"Kosrae Community Health Center\") - referenced by 1 HCO but doesn't exist as standalone entity in std_dh_hco\n    --    These are source data quality issues (orphaned references) that cannot be fixed through the pipeline.\n    --\n    -- 2. DDD-Only Records (firm_type IS NULL, dh_id IS NULL):\n    --    These are legitimate records representing DDD outlets that don't have a DHC match.\n    --    They are expected and included in the hierarchy as L3 (standalone accounts).\n    --    DO NOT filter these out - they are valid business entities.\n),\n\n-- =============================================================================\n-- NETWORK AFFILIATION ENHANCEMENT (NAE-001 to NAE-003)\n-- Runs BEFORE Account Type Classification and MSO PE Lookup\n-- Uses Hospital Parent and PG Parent to populate network fields\n-- =============================================================================\n\n-- NAE-002 Pass 1: Identify parents that should inherit network from co-located children\n-- A parent should inherit network when:\n--   - Parent has NO network_id\n--   - Child HAS network_id\n--   - Parent and Child are co-located (same address)\n-- NOTE: Practice locations are excluded from NAE process (they inherit from parent HCO, not network relationships)\n-- OPTIMIZED (Jan 2026): Split OR join into two separate joins with UNION to avoid cartesian scan\nnae_pass1_parent_inherits_raw AS (\n    -- Hospital parent matches\n    SELECT\n        parent.dh_id AS parent_dh_id,\n        child.network_id,\n        child.network_name\n    FROM master parent\n    INNER JOIN master child ON parent.dh_id = child.hospital_parent_id\n    WHERE parent.network_id IS NULL           -- Parent lacks network\n      AND child.network_id IS NOT NULL        -- Child has network\n      AND parent.firm_type != 'Practice Location'  -- Exclude practice locations as parents\n      AND child.firm_type != 'Practice Location'  -- Exclude practice locations as children\n      -- Co-location check (same address)\n      AND COALESCE(parent.hq_address_line_1, '') = COALESCE(child.hq_address_line_1, '')\n      AND COALESCE(parent.hq_city, '') = COALESCE(child.hq_city, '')\n      AND COALESCE(parent.hq_state, '') = COALESCE(child.hq_state, '')\n      AND COALESCE(parent.hq_zip_code, '') = COALESCE(child.hq_zip_code, '')\n\n    UNION ALL\n\n    -- PG parent matches\n    SELECT\n        parent.dh_id AS parent_dh_id,\n        child.network_id,\n        child.network_name\n    FROM master parent\n    INNER JOIN master child ON parent.dh_id = child.pg_parent_id\n    WHERE parent.network_id IS NULL           -- Parent lacks network\n      AND child.network_id IS NOT NULL        -- Child has network\n      AND parent.firm_type != 'Practice Location'  -- Exclude practice locations as parents\n      AND child.firm_type != 'Practice Location'  -- Exclude practice locations as children\n      -- Co-location check (same address)\n      AND COALESCE(parent.hq_address_line_1, '') = COALESCE(child.hq_address_line_1, '')\n      AND COALESCE(parent.hq_city, '') = COALESCE(child.hq_city, '')\n      AND COALESCE(parent.hq_state, '') = COALESCE(child.hq_state, '')\n      AND COALESCE(parent.hq_zip_code, '') = COALESCE(child.hq_zip_code, '')\n),\n\n-- Dedupe and pick first network_id per parent\nnae_pass1_parent_inherits AS (\n    SELECT\n        parent_dh_id,\n        FIRST_VALUE(network_id) OVER (\n            PARTITION BY parent_dh_id\n            ORDER BY network_id\n        ) AS inherited_network_id,\n        FIRST_VALUE(network_name) OVER (\n            PARTITION BY parent_dh_id\n            ORDER BY network_id\n        ) AS inherited_network_name\n    FROM nae_pass1_parent_inherits_raw\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY parent_dh_id ORDER BY network_id) = 1\n),\n\n-- NAE: Build parent lookup with network info for NAE-001\n-- FIX 2026-01-12: Ensure parent lookup works correctly for NAE-001\n-- FIX 2026-01-14: Replace scalar subqueries with LEFT JOINs to avoid \"Unsupported subquery type\" error\n-- FIX 2026-01-29: Removed co-location flags (hp_colocated, pg_colocated) - NAE-003 removed\nnae_parent_lookup AS (\n    SELECT\n        child.dh_id,\n        -- Hospital Parent effective network (includes NAE-002 inheritance)\n        COALESCE(hp.network_id, hp_inherit.inherited_network_id) AS hp_effective_network_id,\n        COALESCE(hp.network_name, hp_inherit.inherited_network_name) AS hp_effective_network_name,\n        -- PG Parent effective network (includes NAE-002 inheritance)\n        COALESCE(pg.network_id, pg_inherit.inherited_network_id) AS pg_effective_network_id,\n        COALESCE(pg.network_name, pg_inherit.inherited_network_name) AS pg_effective_network_name\n    FROM master child\n    LEFT JOIN master hp ON child.hospital_parent_id = hp.dh_id\n        AND hp.firm_type != 'Practice Location'  -- Prevent PL fan-out (PLs share parent dh_id)\n    LEFT JOIN nae_pass1_parent_inherits hp_inherit ON hp.dh_id = hp_inherit.parent_dh_id\n    LEFT JOIN master pg ON child.pg_parent_id = pg.dh_id\n        AND pg.firm_type != 'Practice Location'  -- Prevent PL fan-out (22x row explosion without this)\n    LEFT JOIN nae_pass1_parent_inherits pg_inherit ON pg.dh_id = pg_inherit.parent_dh_id\n    WHERE child.firm_type != 'Practice Location'\n),\n\n-- NAE Enhanced: Apply NAE-001 and NAE-002 rules\n-- Priority: NAE-002 (parent inherits from child) > NAE-001 (child inherits from parent)\nnae_enhanced AS (\n    SELECT\n        m.kmk_hco_id,\n        m.dh_id,\n        m.org_name,\n        m.firm_type,\n        m.account_type,\n        m.hq_state,\n        m.hq_zip_code,\n        m.has_ddd_match,\n        m.hospital_parent_id,\n        m.hospital_parent_name,\n        m.pg_parent_id,\n        m.pg_parent_name,\n\n        -- Enhanced network_id: NAE-002 first, then NAE-001\n        -- EXCLUDE practice locations from NAE (they should have NULL network_id)\n        CASE\n            WHEN m.firm_type = 'Practice Location' THEN NULL  -- Practice locations: no network_id\n            ELSE COALESCE(\n                -- NAE-002: This record (as parent) inherits from co-located child\n                pass1.inherited_network_id,\n                -- NAE-001: Inherit from Hospital Parent (Hospital first, then PG)\n                CASE WHEN m.network_id IS NULL AND p.hp_effective_network_id IS NOT NULL\n                     THEN p.hp_effective_network_id END,\n                -- NAE-001: Inherit from PG Parent\n                CASE WHEN m.network_id IS NULL AND p.pg_effective_network_id IS NOT NULL\n                     THEN p.pg_effective_network_id END,\n                -- Keep original\n                m.network_id\n            )\n        END AS network_id,\n\n        -- EXCLUDE practice locations from NAE (they should have NULL network_name)\n        CASE\n            WHEN m.firm_type = 'Practice Location' THEN NULL  -- Practice locations: no network_name\n            ELSE COALESCE(\n                pass1.inherited_network_name,\n                CASE WHEN m.network_id IS NULL AND p.hp_effective_network_id IS NOT NULL\n                     THEN p.hp_effective_network_name END,\n                CASE WHEN m.network_id IS NULL AND p.pg_effective_network_id IS NOT NULL\n                     THEN p.pg_effective_network_name END,\n                m.network_name\n            )\n        END AS network_name,\n\n        m.network_firm_type,\n\n        -- Pass through network_parent_id (NAE-003 REMOVED - was unnecessary)\n        CASE\n            WHEN m.firm_type = 'Practice Location' THEN NULL\n            ELSE m.network_parent_id\n        END AS network_parent_id,\n\n        -- Pass through network_parent_name\n        CASE\n            WHEN m.firm_type = 'Practice Location' THEN NULL\n            ELSE m.network_parent_name\n        END AS network_parent_name,\n\n        m.network_parent_firm_type,\n\n        -- Track which NAE rule was applied (NAE-003 REMOVED)\n        CASE\n            WHEN pass1.inherited_network_id IS NOT NULL THEN 'NAE-002'\n            WHEN m.network_id IS NULL AND p.hp_effective_network_id IS NOT NULL THEN 'NAE-001-HP'\n            WHEN m.network_id IS NULL AND p.pg_effective_network_id IS NOT NULL THEN 'NAE-001-PG'\n            ELSE NULL\n        END AS nae_rule_applied,\n\n        -- Territory columns\n        m.kam_territory,\n        m.kam_territory_name,\n        m.kam_region,\n        m.kam_region_name,\n        m.hsd_territory,\n        m.hsd_territory_name,\n        m.msl_territory,\n        m.msl_territory_name\n    FROM master m\n    LEFT JOIN nae_pass1_parent_inherits pass1 ON m.dh_id = pass1.parent_dh_id\n    LEFT JOIN nae_parent_lookup p ON m.dh_id = p.dh_id\n),\n\n-- =============================================================================\n-- NAE PASS 2: Propagate network to grandchildren\n-- After NAE Pass 1, some parents now have network_id. Their children should inherit.\n-- This handles cases where: grandchild \u2192 parent (got network via NAE) \u2192 grandparent (has network)\n-- =============================================================================\nnae_pass2_parent_lookup AS (\n    -- Build parent lookup using NAE-enhanced network_id\n    SELECT\n        child.dh_id,\n        child.hospital_parent_id,\n        child.pg_parent_id,\n        -- Hospital parent's NAE-enriched network_id and name\n        hp.network_id AS hp_network_id,\n        hp.network_name AS hp_network_name,\n        -- PG parent's NAE-enriched network_id and name\n        pg.network_id AS pg_network_id,\n        pg.network_name AS pg_network_name\n    FROM nae_enhanced child\n    LEFT JOIN nae_enhanced hp ON child.hospital_parent_id = hp.dh_id\n        AND hp.firm_type != 'Practice Location'  -- Prevent PL fan-out\n    LEFT JOIN nae_enhanced pg ON child.pg_parent_id = pg.dh_id\n        AND pg.firm_type != 'Practice Location'  -- Prevent PL fan-out\n    WHERE child.firm_type != 'Practice Location'\n      AND child.network_id IS NULL  -- Only for children still missing network_id\n),\n\nnae_enhanced_pass2 AS (\n    SELECT\n        m.kmk_hco_id,\n        m.dh_id,\n        m.org_name,\n        m.firm_type,\n        m.account_type,\n        m.hq_state,\n        m.hq_zip_code,\n        m.has_ddd_match,\n        -- Enhanced network_id: Apply NAE-001 using NAE-enriched parents\n        -- Guard: PLs share dh_id with parent PG - exclude them from inheriting via shared dh_id\n        COALESCE(\n            m.network_id,  -- Keep if already has network_id from pass 1\n            p2.hp_network_id,  -- Inherit from NAE-enriched Hospital Parent\n            p2.pg_network_id   -- Inherit from NAE-enriched PG Parent\n        ) AS network_id,\n        -- Sync network_name when inheriting network_id from parent\n        CASE\n            WHEN m.network_id IS NOT NULL THEN m.network_name  -- Already had network from pass 1\n            WHEN p2.hp_network_id IS NOT NULL THEN p2.hp_network_name\n            WHEN p2.pg_network_id IS NOT NULL THEN p2.pg_network_name\n            ELSE m.network_name\n        END AS network_name,\n        m.network_firm_type,\n        m.network_parent_id,\n        m.network_parent_name,\n        m.network_parent_firm_type,\n        m.hospital_parent_id,\n        m.hospital_parent_name,\n        m.pg_parent_id,\n        m.pg_parent_name,\n        -- Update NAE rule tracking for pass 2\n        CASE\n            WHEN m.nae_rule_applied IS NOT NULL THEN m.nae_rule_applied  -- Keep pass 1 rule\n            WHEN m.network_id IS NULL AND p2.hp_network_id IS NOT NULL THEN 'NAE-001-HP-P2'\n            WHEN m.network_id IS NULL AND p2.pg_network_id IS NOT NULL THEN 'NAE-001-PG-P2'\n            ELSE NULL\n        END AS nae_rule_applied,\n        m.kam_territory,\n        m.kam_territory_name,\n        m.kam_region,\n        m.kam_region_name,\n        m.hsd_territory,\n        m.hsd_territory_name,\n        m.msl_territory,\n        m.msl_territory_name\n    FROM nae_enhanced m\n    LEFT JOIN nae_pass2_parent_lookup p2 ON m.dh_id = p2.dh_id\n        AND m.firm_type != 'Practice Location'  -- PLs share dh_id with parent PG; exclude from inheritance\n),\n\n-- =============================================================================\n-- NAE PASS 3: Follow network chain when network_id points to non-terminal entity\n-- If my network_id points to an entity that has its own network_id (not self-reference),\n-- inherit that entity's network_id instead. This fixes L3\u2192L3 references.\n-- Example: Hospice(network_id=Hospital) \u2192 Hospital(network_id=Network) \u2192 Network\n-- Result: Hospice should have network_id=Network, not network_id=Hospital\n-- =============================================================================\nnae_pass3_network_chain AS (\n    SELECT\n        child.dh_id,\n        child.network_id AS original_network_id,\n        -- Look up the network entity's network_id\n        net.dh_id AS net_dh_id,\n        net.network_id AS net_network_id,\n        net.network_name AS net_network_name,\n        -- If network entity has its own network (and it's not self-reference), use that\n        CASE\n            WHEN net.network_id IS NOT NULL\n                 AND net.dh_id != net.network_id  -- Not self-reference (not L2)\n            THEN net.network_id\n            ELSE child.network_id  -- Keep original\n        END AS resolved_network_id,\n        -- Sync network_name when following chain\n        CASE\n            WHEN net.network_id IS NOT NULL\n                 AND net.dh_id != net.network_id\n            THEN net.network_name  -- Name of the resolved chain network\n            ELSE child.network_name  -- Keep original\n        END AS resolved_network_name\n    FROM nae_enhanced_pass2 child\n    LEFT JOIN nae_enhanced_pass2 net ON child.network_id = net.dh_id\n        AND COALESCE(net.firm_type, '') != 'Practice Location'  -- Prevent PL fan-out\n    WHERE child.firm_type != 'Practice Location'\n      AND child.network_id IS NOT NULL\n),\n\nnae_enhanced_pass3 AS (\n    SELECT\n        m.kmk_hco_id,\n        m.dh_id,\n        m.org_name,\n        m.firm_type,\n        m.account_type,\n        m.hq_state,\n        m.hq_zip_code,\n        m.has_ddd_match,\n        -- Use chain-resolved network_id\n        COALESCE(p3.resolved_network_id, m.network_id) AS network_id,\n        -- Sync network_name when chain resolves to different network\n        COALESCE(p3.resolved_network_name, m.network_name) AS network_name,\n        m.network_firm_type,\n        m.network_parent_id,\n        m.network_parent_name,\n        m.network_parent_firm_type,\n        m.hospital_parent_id,\n        m.hospital_parent_name,\n        m.pg_parent_id,\n        m.pg_parent_name,\n        -- Update NAE rule tracking for pass 3\n        CASE\n            WHEN m.nae_rule_applied IS NOT NULL THEN m.nae_rule_applied  -- Keep earlier rule\n            WHEN p3.resolved_network_id IS NOT NULL\n                 AND p3.resolved_network_id != p3.original_network_id\n            THEN 'NAE-004-CHAIN'  -- New rule: followed network chain\n            ELSE NULL\n        END AS nae_rule_applied,\n        m.kam_territory,\n        m.kam_territory_name,\n        m.kam_region,\n        m.kam_region_name,\n        m.hsd_territory,\n        m.hsd_territory_name,\n        m.msl_territory,\n        m.msl_territory_name\n    FROM nae_enhanced_pass2 m\n    LEFT JOIN nae_pass3_network_chain p3 ON m.dh_id = p3.dh_id\n        AND m.firm_type != 'Practice Location'  -- PLs share dh_id with parent PG; exclude from inheritance\n),\n\n-- =============================================================================\n-- MSO PE LOOKUP (MSO-003, MSO-005, MSO-002 - NO MSO-001)\n-- Uses NAE-enhanced network fields\n-- MSO-001 (facility_to_facility) REMOVED Jan 2026 - caused L1 fragmentation\n-- =============================================================================\n\n-- MSO-003: Load known MSO affiliations from config seed (pe_dh_id matching)\n-- This allows matching on network_parent_id or network_id against PE_DH_ID values\nknown_mso_pe_dh_id AS (\n    SELECT\n        CAST(MATCH_VALUE AS VARCHAR) AS match_pe_dh_id,  -- The value to match against\n        PE_DH_ID AS resolved_pe_dh_id,                    -- The resolved PE\n        PE_NAME AS resolved_pe_name,\n        PE_FIRM_TYPE AS resolved_pe_firm_type\n    FROM {{ ref('config_mso_known_affiliations') }}\n    WHERE MATCH_TYPE = 'pe_dh_id'\n),\n\n-- MSO-003-NET: Load known MSO affiliations from config seed (network_id matching)\n-- FIX (Jan 2026): Network_id type mappings were not being used - caused missing L1 attributions\n-- Example: network_id 1042905 \u2192 PE 1074215 (Solaris Health) for LUGPA practices\nknown_mso_network_id AS (\n    SELECT\n        CAST(MATCH_VALUE AS VARCHAR) AS match_network_id,  -- The network_id to match against\n        CAST(PE_DH_ID AS VARCHAR) AS resolved_pe_dh_id,    -- The resolved PE DH_ID\n        PE_NAME AS resolved_pe_name,\n        PE_FIRM_TYPE AS resolved_pe_firm_type\n    FROM {{ ref('config_mso_known_affiliations') }}\n    WHERE MATCH_TYPE = 'network_id'\n),\n\n-- MSO-001-SAFE: F2F affiliation lookup ONLY for known MSO parent DH_IDs\n-- RE-ENABLED (Jan 2026): Solaris Health affiliates were missing because F2F was disabled\n-- Safeguard: Only lookups where dh_id (parent) is in config_mso_known_affiliations\n-- This prevents L1 fragmentation by restricting F2F to known MSOs only\n-- Filter: IS_CURRENT = 'Y' to only use active affiliations\n-- Example: Solaris Health (DH_ID=1074215) has 21 urology group affiliates in F2F\nknown_mso_f2f_affiliations AS (\n    SELECT DISTINCT\n        CAST(f2f.affiliated_id AS VARCHAR) AS child_dh_id,\n        CAST(mso.PE_DH_ID AS VARCHAR) AS resolved_pe_dh_id,\n        mso.PE_NAME AS resolved_pe_name,\n        mso.PE_FIRM_TYPE AS resolved_pe_firm_type\n    FROM {{ ref('std_dh_facility_to_facility_affiliation_hist') }} f2f\n    INNER JOIN {{ ref('config_mso_known_affiliations') }} mso\n        ON CAST(f2f.dh_id AS VARCHAR) = CAST(mso.PE_DH_ID AS VARCHAR)\n    WHERE mso.MATCH_TYPE = 'pe_dh_id'\n      AND f2f.is_current = 'Y'  -- Only current/active affiliations\n),\n\n-- Apply MSO PE lookup waterfall (Jan 2026 - MSO-001-SAFE RE-ENABLED with safeguard, MSO-005 REMOVED)\n-- MSO-001-SAFE: F2F lookup re-enabled with safeguard - only seed-listed MSO parents can pull affiliates\nmso_pe_lookup AS (\n    SELECT\n        m.kmk_hco_id,\n        m.dh_id,\n        m.org_name,\n        m.firm_type,\n        m.account_type,\n        m.hq_state,\n        m.hq_zip_code,\n        m.has_ddd_match,\n        m.network_id,\n        m.network_name,\n        m.network_firm_type,\n        -- Redirect network_parent_id when it matches a seed network_id entry\n        -- This fixes US Oncology Network where 1034919 should redirect to 1073957\n        -- The MSO seed has: network_id=1034919 \u2192 PE_DH_ID=1073957\n        -- FIX: Keep as VARCHAR (resolved_pe_dh_id is already VARCHAR, cast network_parent_id to match)\n        COALESCE(\n            mso_net_parent_redirect.resolved_pe_dh_id,\n            CAST(m.network_parent_id AS VARCHAR)\n        ) AS network_parent_id,\n        COALESCE(\n            mso_net_parent_redirect.resolved_pe_name,\n            m.network_parent_name\n        ) AS network_parent_name,\n        m.network_parent_firm_type,\n        m.kam_territory,\n        m.kam_territory_name,\n        m.kam_region,\n        m.kam_region_name,\n        m.hsd_territory,\n        m.hsd_territory_name,\n        m.msl_territory,\n        m.msl_territory_name,\n\n        -- MSO PE Resolution Waterfall (Jan 2026 with network_id fix + F2F re-enabled):\n        -- Priority 0: MSO-003 Known MSO by pe_dh_id (matches dh_id, network_parent_id, or network_id)\n        -- Priority 1: MSO-003-NET Known MSO by network_id (e.g., Solaris Health via network_id 1042905)\n        -- Priority 1.5: MSO-001-SAFE F2F affiliation lookup (only for known MSO parents)\n        -- Priority 2: MSO-002 Network fallback (network_parent_id or network_id)\n        -- NOTE: MSO-001-SAFE re-enabled with safeguard (only seed-listed MSOs can pull F2F affiliates)\n        -- NOTE: MSO-005 (generic MSO self-reference) REMOVED - only seed-listed MSOs should be L1\n        -- OPTIMIZED: Split OR join into 3 separate joins, then COALESCE\n        COALESCE(\n            -- Priority 0a: Known MSO by dh_id match\n            mso_match_dh.resolved_pe_dh_id,\n            -- Priority 0b: Known MSO by network_parent_id match\n            mso_match_netparent.resolved_pe_dh_id,\n            -- Priority 0c: Known MSO by network_id match (pe_dh_id type)\n            mso_match_netid.resolved_pe_dh_id,\n            -- Priority 1: Known MSO by network_id (network_id type mapping)\n            mso_net_match.resolved_pe_dh_id,\n            -- Priority 1.5: F2F affiliation for known MSO parents (MSO-001-SAFE)\n            mso_f2f.resolved_pe_dh_id,\n            -- Priority 2: Network fallback (MSO-002)\n            m.network_parent_id,\n            m.network_id\n        ) AS resolved_pe_dh_id,\n\n        COALESCE(\n            mso_match_dh.resolved_pe_name,\n            mso_match_netparent.resolved_pe_name,\n            mso_match_netid.resolved_pe_name,\n            mso_net_match.resolved_pe_name,\n            mso_f2f.resolved_pe_name,\n            m.network_parent_name,\n            m.network_name\n        ) AS resolved_pe_name,\n\n        COALESCE(\n            mso_match_dh.resolved_pe_firm_type,\n            mso_match_netparent.resolved_pe_firm_type,\n            mso_match_netid.resolved_pe_firm_type,\n            mso_net_match.resolved_pe_firm_type,\n            mso_f2f.resolved_pe_firm_type,\n            m.network_parent_firm_type,\n            m.network_firm_type\n        ) AS resolved_pe_firm_type,\n\n        -- Track which MSO rule was applied\n        CASE\n            WHEN mso_match_dh.resolved_pe_dh_id IS NOT NULL THEN 'MSO-003-DIRECT'\n            WHEN mso_match_netparent.resolved_pe_dh_id IS NOT NULL THEN 'MSO-003-PE_PARENT'\n            WHEN mso_match_netid.resolved_pe_dh_id IS NOT NULL THEN 'MSO-003-PE_NETWORK'\n            WHEN mso_net_match.resolved_pe_dh_id IS NOT NULL THEN 'MSO-003-NETWORK_ID'\n            WHEN mso_f2f.resolved_pe_dh_id IS NOT NULL THEN 'MSO-001-F2F'\n            WHEN m.network_parent_id IS NOT NULL THEN 'MSO-002-NETWORK_PARENT'\n            WHEN m.network_id IS NOT NULL THEN 'MSO-002-NETWORK'\n            ELSE NULL\n        END AS mso_rule_applied,\n\n        -- Pass through NAE rule tracking\n        m.nae_rule_applied\n\n    FROM nae_enhanced_pass3 m\n    -- Priority 0: Known MSO by pe_dh_id - OPTIMIZED: Split OR into 3 separate JOINs\n    -- (OR conditions cause inefficient cartesian-like scans in Snowflake)\n    LEFT JOIN known_mso_pe_dh_id mso_match_dh ON\n        CAST(m.dh_id AS VARCHAR) = mso_match_dh.match_pe_dh_id\n    LEFT JOIN known_mso_pe_dh_id mso_match_netparent ON\n        CAST(m.network_parent_id AS VARCHAR) = mso_match_netparent.match_pe_dh_id\n    LEFT JOIN known_mso_pe_dh_id mso_match_netid ON\n        CAST(m.network_id AS VARCHAR) = mso_match_netid.match_pe_dh_id\n    -- Priority 1: Known MSO by network_id (FIX Jan 2026)\n    LEFT JOIN known_mso_network_id mso_net_match ON\n        CAST(m.network_id AS VARCHAR) = mso_net_match.match_network_id\n    -- Priority 1.5: MSO-001-SAFE F2F affiliation lookup (only for known MSO parents)\n    -- Re-enabled Jan 2026 to fix Solaris Health missing 20 urology group affiliates\n    LEFT JOIN known_mso_f2f_affiliations mso_f2f ON\n        CAST(m.dh_id AS VARCHAR) = mso_f2f.child_dh_id\n    -- Network parent redirect: When network_parent_id matches a seed network_id entry, redirect to PE_DH_ID\n    -- This fixes US Oncology Network: 1034919 (Imaging Center) redirects to 1073957 (Real MSO)\n    LEFT JOIN known_mso_network_id mso_net_parent_redirect ON\n        CAST(m.network_parent_id AS VARCHAR) = mso_net_parent_redirect.match_network_id\n    WHERE COALESCE(m.firm_type, '') != 'Practice Location'  -- Exclude practice locations from MSO PE lookup (they inherit from parent)\n      -- Include DDD-only records (firm_type IS NULL) - they should go through MSO PE lookup\n),\n\n-- PHASE 6: Practice locations (inherit PE from parent HCO, not network_parent_id)\n-- FIX (Jan 2026): Lookup parent HCO's resolved_pe_dh_id instead of using network_parent_id directly\npractice_location_mso AS (\n    SELECT\n        m.kmk_hco_id,\n        m.dh_id,\n        m.org_name,\n        m.firm_type,\n        m.account_type,\n        m.hq_state,\n        m.hq_zip_code,\n        m.has_ddd_match,\n        m.network_id,  -- Inherited from parent in master\n        m.network_name,\n        m.network_firm_type,\n        m.network_parent_id,\n        m.network_parent_name,\n        m.network_parent_firm_type,\n        m.kam_territory,\n        m.kam_territory_name,\n        m.kam_region,\n        m.kam_region_name,\n        m.hsd_territory,\n        m.hsd_territory_name,\n        m.msl_territory,\n        m.msl_territory_name,\n        -- PE: Inherit from parent HCO's resolved PE (from mso_pe_lookup)\n        -- Fallback to network_parent_id if parent not found\n        COALESCE(parent_hco.resolved_pe_dh_id, m.network_parent_id) AS resolved_pe_dh_id,\n        COALESCE(parent_hco.resolved_pe_name, m.network_parent_name) AS resolved_pe_name,\n        COALESCE(parent_hco.resolved_pe_firm_type, m.network_parent_firm_type) AS resolved_pe_firm_type,\n        'PRACTICE_LOCATION-INHERITED' AS mso_rule_applied,\n        NULL AS nae_rule_applied\n    FROM nae_enhanced_pass3 m\n    -- Lookup parent HCO from mso_pe_lookup using parent dh_id from mdm_customer_master_hco\n    LEFT JOIN mso_pe_lookup parent_hco\n        ON COALESCE(m.hospital_parent_id, m.pg_parent_id) = parent_hco.dh_id\n    WHERE m.firm_type = 'Practice Location'\n),\n\n-- Combine MSO PE lookup results with practice locations\nall_mso_pe AS (\n    SELECT * FROM mso_pe_lookup\n    UNION ALL\n    SELECT * FROM practice_location_mso\n),\n\n-- Pre-deduplicate to one row per kmk_hco_id before base_entities\n-- This keeps paired columns (network_id/name, pe_dh_id/name, etc.) synchronized\n-- Using ROW_NUMBER instead of independent MAX() which can desync paired values\nall_mso_pe_deduped AS (\n    SELECT *,\n        ROW_NUMBER() OVER (PARTITION BY kmk_hco_id ORDER BY dh_id NULLS LAST) AS _rn\n    FROM all_mso_pe\n),\n\n-- Assign hierarchy level based on self-reference patterns (HIR-001 to HIR-006)\n-- Matches DEV.ADM.HCO_HIERARCHY logic\n-- Base entities with attributes (no hierarchy_level yet - assigned in multi-pass)\n-- NOTE: One row per kmk_hco_id guaranteed by all_mso_pe_deduped.\n-- Any true duplication should be caught by guardrail tests (e.g., HIR-011a), not masked here.\nbase_entities AS (\n    SELECT\n        kmk_hco_id,\n        kmk_hco_id AS account_id,  -- Alias for compatibility\n        dh_id,\n        org_name,\n        firm_type,\n        account_type,\n        hq_state,\n        hq_zip_code,\n        CAST(has_ddd_match AS VARCHAR) AS has_ddd_match,\n\n        -- Network/PE columns (paired values stay synchronized from same source row)\n        network_id,\n        network_name,\n        network_firm_type,\n        network_parent_id,\n        network_parent_name,\n        network_parent_firm_type,\n\n        -- Resolved PE from MSO lookup\n        resolved_pe_dh_id,\n        resolved_pe_name,\n        resolved_pe_firm_type,\n        mso_rule_applied,\n        nae_rule_applied,\n\n        -- Territory columns\n        kam_territory,\n        kam_territory_name,\n        kam_region,\n        kam_region_name,\n        hsd_territory,\n        hsd_territory_name,\n        msl_territory,\n        msl_territory_name\n    FROM all_mso_pe_deduped\n    WHERE _rn = 1\n),\n\n-- ============================================================================\n-- MULTI-PASS HIERARCHY LEVEL ASSIGNMENT (Top-to-Bottom)\n-- L1 = Network Parent (PE/MSO/IDN), L2 = Network, L3 = Account, L4 = Child/Practice Location\n-- ============================================================================\n\n-- Pass 1: L1 entities (top of hierarchy)\n-- L1 = Seed-listed MSOs only (via MSO-003-DIRECT rule)\n--      OR true triple self-reference (dh_id = network_parent_id = network_id)\n-- FIX 2026-01-12: L1 restricted to seed MSOs only - no network self-reference allowed\nl1_entity_ids AS (\n    SELECT kmk_hco_id, dh_id\n    FROM base_entities\n    WHERE\n        -- Seed-listed MSOs only (MSO-003-DIRECT rule sets resolved_pe_dh_id = dh_id for seed MSOs)\n        -- Must be MSO-003-DIRECT, not MSO-002 network fallback\n        mso_rule_applied = 'MSO-003-DIRECT'\n        -- Triple self-reference (dh_id = network_parent = network) - rare edge case\n        OR (COALESCE(dh_id, -1) = COALESCE(network_parent_id, -2)\n            AND COALESCE(dh_id, -1) = COALESCE(network_id, -3)\n            AND dh_id IS NOT NULL AND network_parent_id IS NOT NULL AND network_id IS NOT NULL)\n),\n\n-- Pass 2: L2 entities (network level)\n-- L2 = network_id self-reference OR network_id points to L1\n-- OPTIMIZED: Using LEFT JOIN instead of NOT IN for better performance\n-- BUG-045 FIX: Use numeric comparison for consistency\nl2_entity_ids AS (\n    SELECT b.kmk_hco_id, b.dh_id\n    FROM base_entities b\n    LEFT JOIN l1_entity_ids l1_excl ON b.kmk_hco_id = l1_excl.kmk_hco_id\n    LEFT JOIN l1_entity_ids l1_net ON b.network_id = l1_net.dh_id\n    WHERE l1_excl.kmk_hco_id IS NULL  -- NOT in L1\n      AND b.firm_type != 'Practice Location'\n      AND (\n          -- Self-reference (dh_id = network_id) - numeric comparison\n          (COALESCE(b.dh_id, -1) = COALESCE(b.network_id, -2)\n           AND b.dh_id IS NOT NULL AND b.network_id IS NOT NULL)\n          -- OR network_id points to L1\n          OR l1_net.dh_id IS NOT NULL\n      )\n),\n\n-- Pass 3: L3 entities (account level)\n-- L3 = network_id points to L2 OR no network (standalone) OR DDD-only backbone HCOs\n-- OPTIMIZED: Using LEFT JOIN instead of NOT IN for better performance\n-- FIX 2026-01-12: Include DDD-only backbone HCOs (dh_id IS NULL) as L3\n--\n-- NOTE: DDD-only records (firm_type IS NULL, dh_id IS NULL) are legitimate and assigned to L3.\n-- These represent DDD outlets that don't have a DHC match and are valid standalone accounts.\nl3_entity_ids AS (\n    SELECT b.kmk_hco_id, b.dh_id\n    FROM base_entities b\n    LEFT JOIN l1_entity_ids l1_excl ON b.kmk_hco_id = l1_excl.kmk_hco_id\n    LEFT JOIN l2_entity_ids l2_excl ON b.kmk_hco_id = l2_excl.kmk_hco_id\n    LEFT JOIN l2_entity_ids l2_net ON b.network_id = l2_net.dh_id\n    WHERE l1_excl.kmk_hco_id IS NULL  -- NOT in L1\n      AND l2_excl.kmk_hco_id IS NULL  -- NOT in L2\n      AND b.firm_type != 'Practice Location'\n      AND (\n          -- network_id points to L2\n          l2_net.dh_id IS NOT NULL\n          -- OR no network at all (standalone)\n          OR b.network_id IS NULL\n          -- OR DDD-only backbone HCO (dh_id IS NULL) - assign as L3\n          OR b.dh_id IS NULL\n      )\n),\n\n-- FIX DV-061/HIR-010F (Jan 2026): Removed l4_non_pl_entity_ids CTE\n-- L4 should ONLY be for Practice Locations, not for other entity types\n-- Non-PL entities with network_id pointing to L3 should remain L3 (they're standalone accounts)\n\n-- Final hierarchy assignment: Join base_entities with level CTEs\n-- OPTIMIZED: Using LEFT JOIN instead of IN (subquery) for better performance\nhierarchy_assignment AS (\n    SELECT\n        b.*,\n        CASE\n            WHEN b.dh_id IS NULL THEN 'L3'  -- DDD-only entities are always L3 (standalone accounts)\n            WHEN b.firm_type = 'Practice Location' THEN 'L4'  -- Practice locations (with dh_id) are L4\n            WHEN l1.kmk_hco_id IS NOT NULL THEN 'L1'\n            WHEN l2.kmk_hco_id IS NOT NULL THEN 'L2'\n            -- All other entities (including those with network_id pointing to L3) are L3\n            ELSE 'L3'\n        END AS hierarchy_level\n    FROM base_entities b\n    LEFT JOIN l1_entity_ids l1 ON b.kmk_hco_id = l1.kmk_hco_id\n    LEFT JOIN l2_entity_ids l2 ON b.kmk_hco_id = l2.kmk_hco_id\n    LEFT JOIN l3_entity_ids l3 ON b.kmk_hco_id = l3.kmk_hco_id\n),\n\n-- L2 to L1 mapping: Map each L2 entity to its L1 parent via network_parent_id\n-- Handles L2\u2192L1 direct AND L2\u2192L2\u2192L1 chains (network_parent can be another L2)\nl2_to_l1_mapping AS (\n    SELECT\n        CAST(l2.kmk_hco_id AS VARCHAR) AS l2_kmk_hco_id,\n        COALESCE(\n            -- Direct L1 parent (network_parent is L1)\n            CASE WHEN parent.hierarchy_level = 'L1' THEN CAST(parent.kmk_hco_id AS VARCHAR) END,\n            -- Indirect L1 via L2 parent chain (network_parent is L2, follow to grandparent L1)\n            CASE WHEN parent.hierarchy_level = 'L2' THEN CAST(grandparent_l1.kmk_hco_id AS VARCHAR) END\n        ) AS l1_parent_kmk_hco_id\n    FROM hierarchy_assignment l2\n    LEFT JOIN hierarchy_assignment parent\n        ON l2.network_parent_id = parent.dh_id\n        AND parent.hierarchy_level IN ('L1', 'L2')\n        AND parent.firm_type != 'Practice Location'\n    -- For L2\u2192L2\u2192L1 chains: join to L1 via parent's network_parent_id\n    LEFT JOIN hierarchy_assignment grandparent_l1\n        ON parent.hierarchy_level = 'L2'\n        AND parent.network_parent_id = grandparent_l1.dh_id\n        AND grandparent_l1.hierarchy_level = 'L1'\n    WHERE l2.hierarchy_level = 'L2'\n      AND l2.network_parent_id IS NOT NULL\n),\n\n-- =============================================================================\n-- PE-DRIVEN L1 LOOKUP (Hybrid Option C - Jan 2026)\n-- Maps each HCO's pe_dh_id to the actual L1 entity\n-- Priority: 1) PE entity is L1 \u2192 use it, 2) PE entity is L2 \u2192 follow to L1, 3) Fall back to network chain\n-- MOVED before l3_to_parents_mapping for BUG-045 fix\n-- =============================================================================\npe_to_l1_mapping AS (\n    SELECT\n        CAST(h.kmk_hco_id AS VARCHAR) AS kmk_hco_id,\n        h.resolved_pe_dh_id,\n        -- Find the L1 entity for this PE\n        CASE\n            -- PE entity is L1 \u2192 use it directly\n            WHEN pe_entity.hierarchy_level = 'L1' THEN CAST(pe_entity.kmk_hco_id AS VARCHAR)\n            -- PE entity is L2 \u2192 follow to its L1 parent (NULL if no L1 parent)\n            WHEN pe_entity.hierarchy_level = 'L2' THEN l2_map.l1_parent_kmk_hco_id\n            -- PE entity is L3/L4 or not found \u2192 NULL (will fall back to network chain)\n            ELSE NULL\n        END AS pe_l1_kmk_hco_id\n    FROM hierarchy_assignment h\n    LEFT JOIN hierarchy_assignment pe_entity\n        ON h.resolved_pe_dh_id = pe_entity.dh_id\n        AND pe_entity.firm_type != 'Practice Location'\n    LEFT JOIN l2_to_l1_mapping l2_map\n        ON CAST(pe_entity.kmk_hco_id AS VARCHAR) = l2_map.l2_kmk_hco_id\n    WHERE h.resolved_pe_dh_id IS NOT NULL\n      AND h.firm_type != 'Practice Location'\n),\n\n-- L3 to parents mapping: Map each L3 entity to its L2 and L1 parents\n-- Handles cases where network_id points to L1, L2, or other levels\n-- Prioritizes L1/L2 matches over L3/L4 (dh_id can map to multiple hierarchy levels)\n-- BUG-045 FIX: Use PE-driven L1 lookup as fallback when l2_to_l1_mapping has no entry\nl3_to_parents_mapping AS (\n    SELECT DISTINCT\n        CAST(l3.kmk_hco_id AS VARCHAR) AS l3_kmk_hco_id,\n        -- L2 parent: depends on network entity's level\n        -- FIX HIR-015f: L1 network means no L2 in chain (should be NULL, not L1)\n        FIRST_VALUE(CASE\n            WHEN net.hierarchy_level = 'L2' THEN CAST(net.kmk_hco_id AS VARCHAR)\n            WHEN net.hierarchy_level = 'L1' THEN NULL  -- L1 network: no L2 in hierarchy chain\n            ELSE NULL  -- L3/L4 as network is data quality issue\n        END) OVER (PARTITION BY l3.kmk_hco_id\n                   ORDER BY CASE net.hierarchy_level WHEN 'L1' THEN 1 WHEN 'L2' THEN 2 WHEN 'L3' THEN 3 ELSE 9 END, net.dh_id\n        ) AS l2_parent_kmk_hco_id,\n        -- L1 parent: depends on network entity's level\n        -- BUG-045 FIX: COALESCE pe_to_l1 with l2_to_l1 to handle L2 without network_parent\n        FIRST_VALUE(CASE\n            WHEN net.hierarchy_level = 'L1' THEN CAST(net.kmk_hco_id AS VARCHAR)\n            WHEN net.hierarchy_level = 'L2' THEN COALESCE(pe_l1_map.pe_l1_kmk_hco_id, l1_map.l1_parent_kmk_hco_id)\n            ELSE NULL  -- L3/L4 as network is data quality issue\n        END) OVER (PARTITION BY l3.kmk_hco_id\n                   ORDER BY CASE net.hierarchy_level WHEN 'L1' THEN 1 WHEN 'L2' THEN 2 WHEN 'L3' THEN 3 ELSE 9 END, net.dh_id\n        ) AS l1_parent_kmk_hco_id\n    FROM hierarchy_assignment l3\n    LEFT JOIN hierarchy_assignment net\n        ON l3.network_id = net.dh_id\n        AND COALESCE(net.firm_type, '') != 'Practice Location'  -- Prevent PL fan-out\n    LEFT JOIN pe_to_l1_mapping pe_l1_map\n        ON CAST(net.kmk_hco_id AS VARCHAR) = pe_l1_map.kmk_hco_id\n    LEFT JOIN l2_to_l1_mapping l1_map\n        ON CAST(net.kmk_hco_id AS VARCHAR) = l1_map.l2_kmk_hco_id\n    WHERE l3.hierarchy_level = 'L3'\n      AND l3.network_id IS NOT NULL\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY l3.kmk_hco_id\n                               ORDER BY CASE net.hierarchy_level WHEN 'L1' THEN 1 WHEN 'L2' THEN 2 WHEN 'L3' THEN 3 ELSE 9 END, net.dh_id) = 1\n),\n\n-- =============================================================================\n-- L1 PROPAGATION FROM CHILDREN (L2 Fallback - Jan 2026)\n-- Propagate L1 from L3 children to L2 parents with NULL L1\n-- Uses majority-wins: pick the L1 that appears most among children\n-- This fixes cases where L2 has no L1 from PE or network chain, but its children do\n-- Example: North Oaks Health System (L2) has no network_parent, but its L3 children\n--          have L1 via their PG parent chain (inherited from source data)\n-- NOTE: This is a FALLBACK after pe_to_l1 and l2_to_l1_mapping\n-- FIX (Jan 2026): Also consider PE-derived L1 for L3 children, not just network chain\n-- =============================================================================\nl2_l1_from_children AS (\n    SELECT\n        l3_map.l2_parent_kmk_hco_id AS l2_account_id,\n        -- Use COALESCE: PE-derived L1 first, then network-chain L1\n        COALESCE(pe_l1.pe_l1_kmk_hco_id, l3_map.l1_parent_kmk_hco_id) AS inherited_l1,\n        COUNT(*) AS child_count\n    FROM l3_to_parents_mapping l3_map\n    -- Also join to pe_to_l1_mapping to get PE-derived L1 for L3 children\n    LEFT JOIN pe_to_l1_mapping pe_l1 ON l3_map.l3_kmk_hco_id = pe_l1.kmk_hco_id\n    WHERE l3_map.l2_parent_kmk_hco_id IS NOT NULL\n      AND COALESCE(pe_l1.pe_l1_kmk_hco_id, l3_map.l1_parent_kmk_hco_id) IS NOT NULL\n    GROUP BY l3_map.l2_parent_kmk_hco_id, COALESCE(pe_l1.pe_l1_kmk_hco_id, l3_map.l1_parent_kmk_hco_id)\n    QUALIFY ROW_NUMBER() OVER (\n        PARTITION BY l3_map.l2_parent_kmk_hco_id\n        ORDER BY COUNT(*) DESC, COALESCE(pe_l1.pe_l1_kmk_hco_id, l3_map.l1_parent_kmk_hco_id)  -- Majority wins, then deterministic tie-break\n    ) = 1\n),\n\n-- FIX HIR-035 (Feb 2026): Moved l2_comprehensive_l1 BEFORE practice_location_parents\n-- Comprehensive L2\u2192L1 mapping from all sources\n-- Used for L3 accounts and L4 practice locations to inherit L1 from their L2 parent\n-- Sources: PE-driven, network chain, inherited from L3 children (majority)\nl2_comprehensive_l1 AS (\n    SELECT\n        CAST(l2.kmk_hco_id AS VARCHAR) AS l2_kmk_hco_id,\n        COALESCE(\n            pe_l1_map.pe_l1_kmk_hco_id,        -- PE-driven L1\n            l2_map.l1_parent_kmk_hco_id,       -- Network chain L1\n            l2_child_l1.inherited_l1           -- Inherited from L3 children (majority)\n        ) AS l2_account_id_l1\n    FROM hierarchy_assignment l2\n    LEFT JOIN pe_to_l1_mapping pe_l1_map ON CAST(l2.kmk_hco_id AS VARCHAR) = pe_l1_map.kmk_hco_id\n    LEFT JOIN l2_to_l1_mapping l2_map ON CAST(l2.kmk_hco_id AS VARCHAR) = l2_map.l2_kmk_hco_id\n    LEFT JOIN l2_l1_from_children l2_child_l1 ON CAST(l2.kmk_hco_id AS VARCHAR) = l2_child_l1.l2_account_id\n    WHERE l2.hierarchy_level = 'L2'\n),\n\n-- PHASE 6: Practice location parent hierarchy lookup (SIMPLIFIED Feb 2026)\n-- Practice locations inherit L1/L2/L3 from parent HCO\n-- CLEAN DESIGN: Parent lookup only - L1/L2/L3 inheritance uses l2_comprehensive_l1 consistently\n-- NOTE: The dh_id for practice locations IS the parent organization's DH_ID\npractice_location_parents AS (\n    SELECT\n        pl.kmk_hco_id,\n        pl.dh_id AS parent_dh_id,\n        parent.kmk_hco_id AS parent_kmk_hco_id,\n        parent.hierarchy_level AS parent_hierarchy_level,\n        -- L2 parent ID for L3 parents (needed for L1 lookup via l2_comprehensive_l1)\n        l3_map.l2_parent_kmk_hco_id AS parent_l2_id\n    FROM hierarchy_assignment pl\n    LEFT JOIN hierarchy_assignment parent\n        ON pl.dh_id = parent.dh_id\n        AND parent.firm_type != 'Practice Location'\n    LEFT JOIN l3_to_parents_mapping l3_map\n        ON CAST(parent.kmk_hco_id AS VARCHAR) = l3_map.l3_kmk_hco_id\n    WHERE pl.firm_type = 'Practice Location'\n      AND pl.hierarchy_level = 'L4'\n),\n\n-- Territory lookup from ZIP alignment\n-- NOTE: Using direct table reference to avoid circular dependency with std_zip_territory\nzip_territories AS (\n    SELECT\n        zip_code,\n        kam_territory_code AS kam_territory,\n        kam_territory_name,\n        kam_region_code AS kam_region,\n        kam_region_name,\n        hsd_territory_code AS hsd_territory,\n        hsd_territory_name,\n        msl_territory_code AS msl_territory,\n        msl_territory_name\n    FROM {{ target.database }}.ADM.adm_sfe_zip_alignment\n    WHERE zip_alignment_version = '{{ var(\"sfe_version\") }}'\n),\n\n-- Final output with hierarchy columns\n-- REFACTORED Feb 2026: Single source of truth for L1 via l2_comprehensive_l1\n-- L2/L3/L4 all use l2_comprehensive_l1 for L1 inheritance (no redundant computation)\nfinal_output AS (\n    SELECT\n        CAST(h.kmk_hco_id AS VARCHAR) AS kmk_hco_id,\n        CAST(h.account_id AS VARCHAR) AS account_id,\n        h.hierarchy_level,\n\n        -- account_id_l1: Unified L1 inheritance using l2_comprehensive_l1\n        -- L1 = self, L2/L3/L4 = lookup via l2_comprehensive_l1 (NULL if standalone)\n        CASE\n            WHEN h.hierarchy_level = 'L1' THEN CAST(h.kmk_hco_id AS VARCHAR)\n            WHEN h.hierarchy_level = 'L2' THEN l2_self_l1.l2_account_id_l1\n            WHEN h.hierarchy_level = 'L3' THEN l2_parent_l1.l2_account_id_l1\n            WHEN h.hierarchy_level = 'L4' THEN\n                CASE\n                    WHEN pl_parent.parent_hierarchy_level = 'L1' THEN CAST(pl_parent.parent_kmk_hco_id AS VARCHAR)\n                    ELSE l4_parent_l1.l2_account_id_l1  -- L2/L3 parent: use their L2's L1\n                END\n            ELSE NULL\n        END AS account_id_l1,\n\n        -- account_id_l2: L2 = self, L3/L4 = lookup L2 parent\n        CASE\n            WHEN h.hierarchy_level = 'L2' THEN CAST(h.kmk_hco_id AS VARCHAR)\n            WHEN h.hierarchy_level = 'L3' THEN l3_map.l2_parent_kmk_hco_id\n            WHEN h.hierarchy_level = 'L4' THEN\n                CASE\n                    WHEN pl_parent.parent_hierarchy_level = 'L2' THEN CAST(pl_parent.parent_kmk_hco_id AS VARCHAR)\n                    WHEN pl_parent.parent_hierarchy_level = 'L3' THEN pl_parent.parent_l2_id\n                    ELSE NULL  -- L1 parent: no L2 in chain\n                END\n            ELSE NULL  -- L1: no L2 parent\n        END AS account_id_l2,\n\n        -- account_id_l3: L3 = self, L4 = parent if L3\n        CASE\n            WHEN h.hierarchy_level = 'L3' THEN CAST(h.kmk_hco_id AS VARCHAR)\n            WHEN h.hierarchy_level = 'L4' THEN\n                CASE WHEN pl_parent.parent_hierarchy_level = 'L3' THEN CAST(pl_parent.parent_kmk_hco_id AS VARCHAR) END\n            ELSE NULL  -- L1/L2: no L3 in chain\n        END AS account_id_l3,\n\n        -- account_id_l4: L4 = self\n        CASE WHEN h.hierarchy_level = 'L4' THEN CAST(h.kmk_hco_id AS VARCHAR) END AS account_id_l4,\n\n        -- parent_account_id: Direct parent (one level up in hierarchy)\n        CASE\n            WHEN h.hierarchy_level = 'L1' THEN NULL\n            WHEN h.hierarchy_level = 'L2' THEN l2_self_l1.l2_account_id_l1  -- L2's parent is L1\n            WHEN h.hierarchy_level = 'L3' THEN COALESCE(l3_map.l2_parent_kmk_hco_id, l3_map.l1_parent_kmk_hco_id)\n            WHEN h.hierarchy_level = 'L4' THEN COALESCE(\n                CASE WHEN pl_parent.parent_hierarchy_level = 'L3' THEN CAST(pl_parent.parent_kmk_hco_id AS VARCHAR) END,\n                CASE WHEN pl_parent.parent_hierarchy_level = 'L2' THEN CAST(pl_parent.parent_kmk_hco_id AS VARCHAR) END,\n                CASE WHEN pl_parent.parent_hierarchy_level = 'L1' THEN CAST(pl_parent.parent_kmk_hco_id AS VARCHAR) END\n            )\n            ELSE NULL\n        END AS parent_account_id,\n\n        h.org_name,\n        h.firm_type,\n        h.hq_state,\n        h.hq_zip_code,\n        h.has_ddd_match,\n        h.dh_id,\n\n        -- Network columns (pass-through from source - trust hierarchy_assignment values)\n        -- FIX 2026-01-29: Removed overly aggressive valid_network_targets validation\n        -- The previous logic incorrectly invalidated L2 Physician Groups because their\n        -- Practice Location children (L4) inherit the same dh_id by design.\n        -- This caused ~3,643 valid L2 networks and ~2,588 referencing HCOs to lose network_id.\n        h.network_id,\n        h.network_name,\n        h.network_firm_type,\n\n        -- Network Parent ID (for MSO tests - MSO-002, MSO-004)\n        h.network_parent_id,\n        h.network_parent_name,\n        h.network_parent_firm_type,\n\n        -- PE fields - NOW USING RESOLVED PE FROM MSO LOOKUP (MSO-001 to MSO-005)\n        h.resolved_pe_dh_id AS pe_dh_id,\n        h.resolved_pe_name AS pe_name,\n        CASE WHEN h.resolved_pe_dh_id IS NOT NULL THEN 'Y' ELSE 'N' END AS pe_flag,\n\n        -- PRIVATE_EQUITY_NAME for MSO tests (MSO-003)\n        -- Uses resolved PE name when firm_type is MSO\n        CASE\n            WHEN UPPER(h.resolved_pe_firm_type) = 'MANAGEMENT SERVICES ORGANIZATION'\n                THEN h.resolved_pe_name\n            ELSE NULL\n        END AS private_equity_name,\n\n        -- Rule tracking (for debugging/validation)\n        h.mso_rule_applied,\n        h.nae_rule_applied,\n\n        -- Orphan L4 flag: L4 entities with no valid parent in hierarchy\n        -- Should always be 'N' - if 'Y', indicates data quality issue\n        -- Practice locations: orphan if parent HCO not found\n        -- Non-PL L4: orphan if network_id is NULL (shouldn't happen given L4 criteria)\n        CASE\n            WHEN h.hierarchy_level = 'L4' AND h.firm_type = 'Practice Location' AND pl_parent.parent_kmk_hco_id IS NULL THEN 'Y'\n            WHEN h.hierarchy_level = 'L4' AND h.firm_type != 'Practice Location' AND h.network_id IS NULL THEN 'Y'\n            ELSE 'N'\n        END AS is_orphan_l4,\n\n        -- Territory fields (from std_zip_territory via hq_zip_code)\n        zt.kam_territory,\n        zt.kam_territory_name,\n        zt.kam_region,\n        zt.kam_region_name,\n        zt.hsd_territory,\n        zt.hsd_territory_name,\n        zt.msl_territory,\n        zt.msl_territory_name,\n\n        (SELECT data_date FROM data_date_ref) AS data_date\n\n    FROM hierarchy_assignment h\n    -- Territory lookup via ZIP code\n    LEFT JOIN zip_territories zt ON h.hq_zip_code = zt.zip_code\n    -- Practice location parent lookup (simplified - just finds parent HCO)\n    LEFT JOIN practice_location_parents pl_parent ON h.kmk_hco_id = pl_parent.kmk_hco_id\n    -- L3\u2192parents mapping for L3 accounts\n    LEFT JOIN l3_to_parents_mapping l3_map ON CAST(h.kmk_hco_id AS VARCHAR) = l3_map.l3_kmk_hco_id\n    -- L1 INHERITANCE (single source of truth via l2_comprehensive_l1):\n    -- 1. L2's own L1 (for L2 accounts)\n    LEFT JOIN l2_comprehensive_l1 l2_self_l1 ON h.hierarchy_level = 'L2' AND CAST(h.kmk_hco_id AS VARCHAR) = l2_self_l1.l2_kmk_hco_id\n    -- 2. L3's L1 (via L3's L2 parent)\n    LEFT JOIN l2_comprehensive_l1 l2_parent_l1 ON h.hierarchy_level = 'L3' AND l3_map.l2_parent_kmk_hco_id = l2_parent_l1.l2_kmk_hco_id\n    -- 3. L4's L1 (via parent's L2 - works for both L2 and L3 parents)\n    LEFT JOIN l2_comprehensive_l1 l4_parent_l1 ON h.hierarchy_level = 'L4'\n        AND COALESCE(\n            CASE WHEN pl_parent.parent_hierarchy_level = 'L2' THEN CAST(pl_parent.parent_kmk_hco_id AS VARCHAR) END,\n            pl_parent.parent_l2_id  -- L3 parent's L2\n        ) = l4_parent_l1.l2_kmk_hco_id\n)\n\n-- PHASE 6: Practice locations are now included in final_output (no separate CTE needed)\n-- All HCOs (including practice locations) are in final_output with proper hierarchy levels\n-- Add ultimate_parent_id: Root of the family tree (L1 > L2 > L3 > self)\nSELECT\n    *,\n    COALESCE(account_id_l1, account_id_l2, account_id_l3, account_id) AS ultimate_parent_id\nFROM final_output", "doc_blocks": [], "language": "sql", "refs": [{"name": "ref_time_periods", "package": null, "version": null}, {"name": "mdm_customer_master_hco", "package": null, "version": null}, {"name": "config_mso_known_affiliations", "package": null, "version": null}, {"name": "config_mso_known_affiliations", "package": null, "version": null}, {"name": "std_dh_facility_to_facility_affiliation_hist", "package": null, "version": null}, {"name": "config_mso_known_affiliations", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.ref_time_periods", "model.CGOncology_MDM.mdm_customer_master_hco", "seed.CGOncology_MDM.config_mso_known_affiliations", "model.CGOncology_MDM.std_dh_facility_to_facility_affiliation_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": ["kmk_hco_id"], "time_spine": null}, "model.CGOncology_MDM.source_orders": {"database": "CGONCOLOGY_TEST", "schema": "EXAMPLES", "name": "source_orders", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "examples/incremental_demo/source_orders.sql", "original_file_path": "models/examples/incremental_demo/source_orders.sql", "unique_id": "model.CGOncology_MDM.source_orders", "fqn": ["CGOncology_MDM", "examples", "incremental_demo", "source_orders"], "alias": "source_orders", "checksum": {"name": "sha256", "checksum": "0b72c97f178018c98c6d7175fd02f0d71f430dbdb30bcf79eb13f98a57eff23b"}, "config": {"enabled": true, "alias": null, "schema": "EXAMPLES", "database": null, "tags": ["example", "learning"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["example", "learning"], "description": "Simulated source data - orders that grow over time (for incremental demo)", "columns": {"order_id": {"name": "order_id", "description": "Unique order identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "customer_name": {"name": "customer_name", "description": "Customer who placed the order", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "amount": {"name": "amount", "description": "Order amount in dollars", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "order_date": {"name": "order_date", "description": "Date of the order", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "created_at": {"name": "created_at", "description": "Timestamp when order was created (used for incremental filtering)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/examples/incremental_demo/schema.yml", "build_path": null, "unrendered_config": {"tags": ["example", "learning"], "materialized": "table", "schema": "EXAMPLES"}, "created_at": 1770177079.781267, "relation_name": "CGONCOLOGY_TEST.EXAMPLES.source_orders", "raw_code": "{{\n    config(\n        materialized='table',\n        schema='EXAMPLES'\n    )\n}}\n\n-- SIMULATED SOURCE DATA: Orders that arrive daily\n-- This represents raw data that grows over time\n\nSELECT * FROM (\n    VALUES\n        (1, 'Alice', 100.00, '2024-01-01'::date, '2024-01-01 10:00:00'::timestamp),\n        (2, 'Bob',   150.00, '2024-01-01'::date, '2024-01-01 11:00:00'::timestamp),\n        (3, 'Carol', 200.00, '2024-01-02'::date, '2024-01-02 09:00:00'::timestamp),\n        (4, 'David', 175.00, '2024-01-02'::date, '2024-01-02 14:00:00'::timestamp),\n        (5, 'Eve',   225.00, '2024-01-03'::date, '2024-01-03 08:00:00'::timestamp)\n) AS t(order_id, customer_name, amount, order_date, created_at)", "doc_blocks": [], "language": "sql", "refs": [], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}, "model.CGOncology_MDM.incremental_orders": {"database": "CGONCOLOGY_TEST", "schema": "EXAMPLES", "name": "incremental_orders", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "examples/incremental_demo/incremental_orders.sql", "original_file_path": "models/examples/incremental_demo/incremental_orders.sql", "unique_id": "model.CGOncology_MDM.incremental_orders", "fqn": ["CGOncology_MDM", "examples", "incremental_demo", "incremental_orders"], "alias": "incremental_orders", "checksum": {"name": "sha256", "checksum": "b98826f9d406bb8fd15892d3d7b5b209f9e26f795d4057867ad6d3f603c7a158"}, "config": {"enabled": true, "alias": null, "schema": "EXAMPLES", "database": null, "tags": ["example", "learning"], "meta": {}, "group": null, "materialized": "incremental", "incremental_strategy": "merge", "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "order_id", "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["example", "learning"], "description": "Demo incremental model that processes orders.\n\nFIRST RUN: Loads all orders from source\nSUBSEQUENT RUNS: Only loads orders newer than MAX(created_at) in target\nFULL REFRESH: Rebuilds entire table from scratch\n", "columns": {"order_id": {"name": "order_id", "description": "Unique order identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "customer_name": {"name": "customer_name", "description": "Customer who placed the order", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "amount": {"name": "amount", "description": "Order amount in dollars", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "order_date": {"name": "order_date", "description": "Date of the order", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "created_at": {"name": "created_at", "description": "Timestamp when order was created", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "dbt_loaded_at": {"name": "dbt_loaded_at", "description": "Timestamp when dbt loaded this row", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "dbt_run_id": {"name": "dbt_run_id", "description": "dbt invocation ID that loaded this row", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/examples/incremental_demo/schema.yml", "build_path": null, "unrendered_config": {"tags": ["example", "learning"], "materialized": "incremental", "schema": "EXAMPLES", "unique_key": "order_id", "incremental_strategy": "merge"}, "created_at": 1770177079.7818072, "relation_name": "CGONCOLOGY_TEST.EXAMPLES.incremental_orders", "raw_code": "{{\n    config(\n        materialized='incremental',\n        schema='EXAMPLES',\n        unique_key='order_id',\n        incremental_strategy='merge'\n    )\n}}\n\n/*\n================================================================================\nINCREMENTAL MODEL DEMO\n================================================================================\n\nThis model demonstrates how incremental materialization works:\n\nFIRST RUN (or --full-refresh):\n  - Table doesn't exist OR we force rebuild\n  - Runs the FULL query (no WHERE filter)\n  - Creates table with ALL rows from source\n\nSUBSEQUENT RUNS:\n  - Table already exists\n  - The `is_incremental()` block becomes TRUE\n  - Only processes NEW/CHANGED rows (filtered by created_at)\n  - MERGE/INSERT based on unique_key\n\nKEY CONCEPTS:\n  - `is_incremental()` = TRUE only when table exists AND not doing full-refresh\n  - `unique_key` = how to identify existing rows for updates\n  - `incremental_strategy` = merge (update+insert), append (insert only), delete+insert\n================================================================================\n*/\n\nSELECT\n    order_id,\n    customer_name,\n    amount,\n    order_date,\n    created_at,\n\n    -- Add processing metadata\n    CURRENT_TIMESTAMP() AS dbt_loaded_at,\n    '{{ invocation_id }}' AS dbt_run_id\n\nFROM {{ ref('source_orders') }}\n\n{% if is_incremental() %}\n    -- THIS BLOCK ONLY RUNS ON INCREMENTAL RUNS (not first run, not full-refresh)\n    -- Only get rows newer than what we already have\n    WHERE created_at > (SELECT MAX(created_at) FROM {{ this }})\n{% endif %}", "doc_blocks": [], "language": "sql", "refs": [{"name": "source_orders", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.CGOncology_MDM.source_orders"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}, "model.CGOncology_MDM.source_customers": {"database": "CGONCOLOGY_TEST", "schema": "EXAMPLES", "name": "source_customers", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "examples/incremental_demo/source_customers.sql", "original_file_path": "models/examples/incremental_demo/source_customers.sql", "unique_id": "model.CGOncology_MDM.source_customers", "fqn": ["CGOncology_MDM", "examples", "incremental_demo", "source_customers"], "alias": "source_customers", "checksum": {"name": "sha256", "checksum": "abdac94f6a2d6bc37af37df6db7374946643bc94f93641c75802979c13c06840"}, "config": {"enabled": true, "alias": null, "schema": "EXAMPLES", "database": null, "tags": ["example", "learning"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["example", "learning"], "description": "Simulated source data - customers that can change over time (for snapshot demo)", "columns": {"customer_id": {"name": "customer_id", "description": "Unique customer identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "name": {"name": "name", "description": "Customer name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "email": {"name": "email", "description": "Customer email", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "tier": {"name": "tier", "description": "Customer tier (Bronze/Silver/Gold) - can change over time", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "updated_at": {"name": "updated_at", "description": "Timestamp of last update (used for snapshot change detection)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/examples/incremental_demo/schema.yml", "build_path": null, "unrendered_config": {"tags": ["example", "learning"], "materialized": "table", "schema": "EXAMPLES"}, "created_at": 1770177079.782316, "relation_name": "CGONCOLOGY_TEST.EXAMPLES.source_customers", "raw_code": "{{\n    config(\n        materialized='table',\n        schema='EXAMPLES'\n    )\n}}\n\n-- SIMULATED SOURCE DATA: Customer records that can CHANGE over time\n-- This represents data where we want to track historical changes\n\nSELECT * FROM (\n    VALUES\n        (1, 'Alice',   'alice@email.com',   'Gold',   '2024-01-01 10:00:00'::timestamp),\n        (2, 'Bob',     'bob@email.com',     'Silver', '2024-01-01 11:00:00'::timestamp),\n        (3, 'Carol',   'carol@email.com',   'Bronze', '2024-01-02 09:00:00'::timestamp)\n) AS t(customer_id, name, email, tier, updated_at)", "doc_blocks": [], "language": "sql", "refs": [], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}, "snapshot.CGOncology_MDM.snap_customers": {"database": "CGONCOLOGY_TEST", "schema": "SNAPSHOTS", "name": "snap_customers", "resource_type": "snapshot", "package_name": "CGOncology_MDM", "path": "snap_customers.sql", "original_file_path": "snapshots/snap_customers.sql", "unique_id": "snapshot.CGOncology_MDM.snap_customers", "fqn": ["CGOncology_MDM", "snap_customers", "snap_customers"], "alias": "snap_customers", "checksum": {"name": "sha256", "checksum": "926172482a426da5c4cbacd9f8e7056e138957c1858a9244a7c111893a9d571a"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": ["example", "learning"], "meta": {}, "group": null, "materialized": "snapshot", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "customer_id", "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "strategy": "timestamp", "target_schema": "SNAPSHOTS", "target_database": "CGONCOLOGY_TEST", "updated_at": "updated_at", "check_cols": null, "snapshot_meta_column_names": {"dbt_valid_to": null, "dbt_valid_from": null, "dbt_scd_id": null, "dbt_updated_at": null, "dbt_is_deleted": null}, "dbt_valid_to_current": null}, "tags": ["example", "learning"], "description": "Snapshot of customers tracking changes over time (Type 2 SCD).\n\nWhen a customer's data changes, this snapshot:\n1. Closes the old record (sets dbt_valid_to)\n2. Inserts new record (dbt_valid_to = NULL = current)\n\nQuery current: WHERE dbt_valid_to IS NULL\nQuery historical: Use dbt_valid_from and dbt_valid_to date ranges\n", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/examples/incremental_demo/schema.yml", "build_path": null, "unrendered_config": {"tags": ["example", "learning"], "target_database": "CGONCOLOGY_TEST", "target_schema": "SNAPSHOTS", "unique_key": "customer_id", "strategy": "timestamp", "updated_at": "updated_at"}, "created_at": 1770177079.782764, "relation_name": "CGONCOLOGY_TEST.SNAPSHOTS.snap_customers", "raw_code": "\n\n{{\n    config(\n        target_database='CGONCOLOGY_TEST',\n        target_schema='SNAPSHOTS',\n        unique_key='customer_id',\n        strategy='timestamp',\n        updated_at='updated_at'\n    )\n}}\n\n/*\n================================================================================\nSNAPSHOT MODEL DEMO\n================================================================================\n\nSnapshots are DIFFERENT from incremental models!\n\nPURPOSE:\n  - Track HISTORICAL CHANGES to records over time (Type 2 SCD)\n  - When a record changes, keep BOTH the old and new version\n  - Each version has valid_from and valid_to timestamps\n\nHOW IT WORKS:\n  1. First run: Captures all current records\n  2. Subsequent runs: Compares current vs previous\n     - NEW records \u2192 Insert with valid_from = now, valid_to = null\n     - CHANGED records \u2192 Close old record (valid_to = now), insert new version\n     - DELETED records \u2192 Close old record (valid_to = now)\n     - UNCHANGED records \u2192 Do nothing\n\nSNAPSHOT vs INCREMENTAL:\n  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n  \u2502                 \u2502 INCREMENTAL          \u2502 SNAPSHOT                    \u2502\n  \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n  \u2502 Purpose         \u2502 Process new data     \u2502 Track changes over time     \u2502\n  \u2502 History         \u2502 No (overwrites)      \u2502 Yes (keeps all versions)    \u2502\n  \u2502 Use case        \u2502 Fact tables (events) \u2502 Dimension tables (entities) \u2502\n  \u2502 Unique key      \u2502 Used for MERGE       \u2502 Used to identify record     \u2502\n  \u2502 Strategy        \u2502 merge/append/delete  \u2502 timestamp/check             \u2502\n  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n================================================================================\n*/\n\nSELECT\n    customer_id,\n    name,\n    email,\n    tier,\n    updated_at\nFROM {{ ref('source_customers') }}\n\n", "doc_blocks": [], "language": "sql", "refs": [{"name": "source_customers", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.source_customers"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}}, "analysis.CGOncology_MDM.val_path2_skip_validation": {"database": "CGONCOLOGY_TEST", "schema": "project", "name": "val_path2_skip_validation", "resource_type": "analysis", "package_name": "CGOncology_MDM", "path": "analysis/val_path2_skip_validation.sql", "original_file_path": "analyses/val_path2_skip_validation.sql", "unique_id": "analysis.CGOncology_MDM.val_path2_skip_validation", "fqn": ["CGOncology_MDM", "analysis", "val_path2_skip_validation"], "alias": "val_path2_skip_validation", "checksum": {"name": "sha256", "checksum": "638213bb47c5a3fabc6f1b1735d7c86bd80a5edbabd395c35f80c18cc1e8d7f5"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.171202, "relation_name": null, "raw_code": "/*\nValidation: Can Path 2 (Rendering NPI \u2192 HCO) be skipped for HCO-filed claims?\n\nPurpose: Count how many claim rows are attributed via Path 2 only (would lose\nattribution if Path 2 is removed) vs Path 2 with billing (would keep attribution\nvia billing NPI, possibly different HCO).\n\nRun: Execute directly in Snowflake (CGONCOLOGY_TEST). Uses FQNs so no dbt compile needed.\nFederal flag uses account_type from ADM_HCO_MASTER (no seed dependency).\n\nOutput columns:\n- path2_only_rows: Rows that would become UNATTRIBUTED if Path 2 is skipped\n- path2_with_billing_rows: Rows that would KEEP attribution via billing if Path 2 skipped\n- path2_with_billing_same_hco: Of path2_with_billing, same HCO (no volume move)\n- path2_with_billing_different_hco: Of path2_with_billing, different HCO (volume would move)\n- path2_total_rows: path2_only + path2_with_billing\n- recommendation: Whether Path 2 can be skipped\n*/\n\nWITH bc_patient_pool AS (\n    SELECT PATIENT_ID FROM CGONCOLOGY_TEST.STAGING.STG_BC_PATIENT_POOL\n),\n\nall_claims AS (\n    SELECT\n        PX_CLAIM_ID AS claim_id, 'PX' AS claim_type, PATIENT_ID, SERVICE_DATE AS service_date,\n        SERVICE_YEAR, SERVICE_MONTH, COALESCE(REPLACE(TREATMENT_CATEGORY, ' ', '_'), 'OTHER_PX') AS metric_category,\n        PROVIDER_RENDERING_NPI, PROVIDER_BILLING_NPI,\n        PATIENT_PRIMARY_PAYOR_TYPE AS payor_type, PATIENT_PRIMARY_PAYOR_NAME AS payor_name, PATIENT_PRIMARY_PAYOR_DH_ID AS payor_dh_id\n    FROM CGONCOLOGY_TEST.STANDARDIZATION.STD_PX_CLAIMS\n    WHERE SERVICE_DATE IS NOT NULL AND TREATMENT_CATEGORY IS NOT NULL\n    GROUP BY 1,2,3,4,5,6,7,8,9,10,11,12\n    UNION ALL\n    SELECT\n        MX_CLAIM_ID, 'DX', PATIENT_ID, SERVICE_DATE, SERVICE_YEAR, SERVICE_MONTH,\n        COALESCE(REPLACE(TREATMENT_CATEGORY, ' ', '_'), 'OTHER_DX'), PROVIDER_RENDERING_NPI, PROVIDER_BILLING_NPI,\n        PATIENT_PRIMARY_PAYOR_TYPE, PATIENT_PRIMARY_PAYOR_NAME, PATIENT_PRIMARY_PAYOR_DH_ID\n    FROM CGONCOLOGY_TEST.STANDARDIZATION.STD_DX_CLAIMS\n    WHERE SERVICE_DATE IS NOT NULL AND TREATMENT_CATEGORY IS NOT NULL\n    GROUP BY 1,2,3,4,5,6,7,8,9,10,11,12\n    UNION ALL\n    SELECT\n        RX_CLAIM_ID, 'RX', PATIENT_ID, FILL_DATE, FILL_YEAR, FILL_MONTH,\n        COALESCE(REPLACE(TREATMENT_CATEGORY, ' ', '_'), 'OTHER_RX'), PROVIDER_PRESCRIBING_NPI, NULL,\n        PATIENT_PRIMARY_PAYOR_TYPE, PATIENT_PRIMARY_PAYOR_NAME, PATIENT_PRIMARY_PAYOR_DH_ID\n    FROM CGONCOLOGY_TEST.STANDARDIZATION.STD_RX_CLAIMS\n    WHERE FILL_DATE IS NOT NULL AND TREATMENT_CATEGORY IS NOT NULL\n    GROUP BY 1,2,3,4,5,6,7,8,9,10,11,12\n),\n\nclaims_filtered AS (\n    SELECT c.* FROM all_claims c\n    INNER JOIN bc_patient_pool pool ON c.PATIENT_ID = pool.PATIENT_ID\n),\n\nhco_by_npi AS (\n    SELECT\n        hco.npi,\n        hco.KMK_HCO_ID,\n        am.account_type,\n        hco.firm_type,\n        CASE\n            WHEN h.kmk_hco_id = h.account_id_l4 THEN 4\n            WHEN h.kmk_hco_id = h.account_id_l3 THEN 3\n            WHEN h.kmk_hco_id = h.account_id_l2 THEN 2\n            WHEN h.kmk_hco_id = h.account_id_l1 THEN 1\n            ELSE 0\n        END AS hco_level\n    FROM CGONCOLOGY_TEST.MDM.MDM_CUSTOMER_MASTER_HCO hco\n    LEFT JOIN CGONCOLOGY_TEST.ADM.ADM_HCO_HIERARCHY h ON hco.KMK_HCO_ID = h.kmk_hco_id\n    LEFT JOIN CGONCOLOGY_TEST.ADM.ADM_HCO_MASTER am ON hco.KMK_HCO_ID = am.kmk_hco_id\n    WHERE hco.npi IS NOT NULL\n      AND (hco.firm_type IS NULL OR hco.firm_type != 'Practice Location')\n    QUALIFY ROW_NUMBER() OVER (\n        PARTITION BY hco.npi\n        ORDER BY\n            hco_level DESC,\n            CASE WHEN hco.firm_type = 'Physician Group' THEN 1 WHEN hco.firm_type = 'Hospital' THEN 2 ELSE 3 END,\n            hco.KMK_HCO_ID\n    ) = 1\n),\n\nclaims_enriched AS (\n    SELECT\n        c.claim_id,\n        c.claim_type,\n        c.PATIENT_ID,\n        c.metric_category,\n        c.PROVIDER_RENDERING_NPI,\n        c.PROVIDER_BILLING_NPI,\n        hcp.KMK_HCP_ID,\n        CASE WHEN ba_hco.KMK_HCO_ID IS NOT NULL THEN ba.BEST_KMK_HCO_ID ELSE NULL END AS hcp_aff_hco_id,\n        hco_render.KMK_HCO_ID AS render_hco_id,\n        hco_billing.KMK_HCO_ID AS billing_hco_id,\n        CASE WHEN hco_billing.account_type ILIKE '%FEDERAL%' THEN 'Y' ELSE 'N' END AS is_federal\n    FROM claims_filtered c\n    LEFT JOIN CGONCOLOGY_TEST.MDM.MDM_CUSTOMER_MASTER_HCP hcp ON c.PROVIDER_RENDERING_NPI = hcp.npi\n    LEFT JOIN CGONCOLOGY_TEST.MDM.MDM_BEST_AFFILIATION_HIST ba ON hcp.KMK_HCP_ID = ba.KMK_HCP_ID AND ba.is_current = 'Y'\n    LEFT JOIN CGONCOLOGY_TEST.MDM.MDM_CUSTOMER_MASTER_HCO ba_hco ON ba.BEST_KMK_HCO_ID = ba_hco.KMK_HCO_ID\n    LEFT JOIN hco_by_npi hco_render ON c.PROVIDER_RENDERING_NPI = hco_render.npi\n    LEFT JOIN hco_by_npi hco_billing ON c.PROVIDER_BILLING_NPI = hco_billing.npi\n),\n\npath2_metrics AS (\n    SELECT\n        SUM(CASE WHEN is_federal = 'N' AND KMK_HCP_ID IS NULL AND render_hco_id IS NOT NULL AND billing_hco_id IS NULL THEN 1 ELSE 0 END) AS path2_only_rows,\n        SUM(CASE WHEN is_federal = 'N' AND KMK_HCP_ID IS NULL AND render_hco_id IS NOT NULL AND billing_hco_id IS NOT NULL THEN 1 ELSE 0 END) AS path2_with_billing_rows,\n        SUM(CASE WHEN is_federal = 'N' AND KMK_HCP_ID IS NULL AND render_hco_id IS NOT NULL AND billing_hco_id IS NOT NULL AND render_hco_id = billing_hco_id THEN 1 ELSE 0 END) AS path2_with_billing_same_hco,\n        SUM(CASE WHEN is_federal = 'N' AND KMK_HCP_ID IS NULL AND render_hco_id IS NOT NULL AND billing_hco_id IS NOT NULL AND render_hco_id != billing_hco_id THEN 1 ELSE 0 END) AS path2_with_billing_different_hco\n    FROM claims_enriched\n)\n\nSELECT\n    path2_only_rows,\n    path2_with_billing_rows,\n    path2_with_billing_same_hco,\n    path2_with_billing_different_hco,\n    path2_only_rows + path2_with_billing_rows AS path2_total_rows,\n    CASE\n        WHEN path2_only_rows = 0 THEN 'Path 2 can be skipped: no rows would lose attribution.'\n        ELSE 'Path 2 cannot be skipped: ' || path2_only_rows || ' rows would lose HCO attribution.'\n    END AS recommendation\nFROM path2_metrics;", "doc_blocks": [], "language": "sql", "refs": [], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}}, "test.CGOncology_MDM.test_ddd_grain_long_reconciliation": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "test_ddd_grain_long_reconciliation", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "data_quality/test_ddd_grain_long_reconciliation.sql", "original_file_path": "tests/data_quality/test_ddd_grain_long_reconciliation.sql", "unique_id": "test.CGOncology_MDM.test_ddd_grain_long_reconciliation", "fqn": ["CGOncology_MDM", "data_quality", "test_ddd_grain_long_reconciliation"], "alias": "test_ddd_grain_long_reconciliation", "checksum": {"name": "sha256", "checksum": "233629572cfc39f60a6ae2eacd105e51f521bb95dd11361a5bb330204eb2d953"}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.174324, "relation_name": null, "raw_code": "/*\nDDD Cross-Table Reconciliation Tests\nValidates consistency across DDD metrics pipeline: grain \u2192 long \u2192 wide.\n\nTests:\n  1. Long L3 TICE_BCG L12M sales match Wide L12M_SALES (within 1%)\n  2. Long L3 ADSTILADRIN L12M sales match Wide L12M_SALES (within 1%)\n  3. All Long L4 entity_ids exist in grain account_id_l4\n  4. L4 entity count in Long matches grain L4 coverage (within 10%)\n\nReturns failing rows - 0 rows = all tests pass.\n*/\n\n-- Test 1: Long vs Wide - TICE_BCG L3 L12M sales reconciliation\nWITH long_tice_l3 AS (\n    SELECT COALESCE(SUM(sales_amount), 0) AS total_sales\n    FROM {{ ref('adm_ddd_metrics_long') }} l\n    INNER JOIN {{ ref('adm_hco_hierarchy') }} h ON l.entity_id = h.kmk_hco_id\n    WHERE l.entity_type = 'HCO'\n      AND l.metric_category = 'TICE_BCG'\n      AND l.period_key = 'L12M'\n      AND h.hierarchy_level = 'L3'\n),\n\nwide_tice_l3 AS (\n    SELECT COALESCE(SUM(L12M_SALES), 0) AS total_sales\n    FROM {{ ref('adm_ddd_metrics_wide') }} w\n    INNER JOIN {{ ref('adm_hco_hierarchy') }} h ON w.kmk_hco_id = h.kmk_hco_id\n    WHERE w.metric_category = 'TICE_BCG'\n      AND h.hierarchy_level = 'L3'\n),\n\nlong_vs_wide_tice AS (\n    SELECT\n        'long_vs_wide_tice_l3' AS test_name,\n        'Long=' || ROUND(l.total_sales,2) || ' Wide=' || ROUND(w.total_sales,2) AS detail\n    FROM long_tice_l3 l\n    CROSS JOIN wide_tice_l3 w\n    WHERE ABS(l.total_sales - w.total_sales) > GREATEST(w.total_sales * 0.01, 1.0)\n),\n\n-- Test 2: Long vs Wide - ADSTILADRIN L3 L12M sales reconciliation\nlong_adst_l3 AS (\n    SELECT COALESCE(SUM(sales_amount), 0) AS total_sales\n    FROM {{ ref('adm_ddd_metrics_long') }} l\n    INNER JOIN {{ ref('adm_hco_hierarchy') }} h ON l.entity_id = h.kmk_hco_id\n    WHERE l.entity_type = 'HCO'\n      AND l.metric_category = 'ADSTILADRIN'\n      AND l.period_key = 'L12M'\n      AND h.hierarchy_level = 'L3'\n),\n\nwide_adst_l3 AS (\n    SELECT COALESCE(SUM(L12M_SALES), 0) AS total_sales\n    FROM {{ ref('adm_ddd_metrics_wide') }} w\n    INNER JOIN {{ ref('adm_hco_hierarchy') }} h ON w.kmk_hco_id = h.kmk_hco_id\n    WHERE w.metric_category = 'ADSTILADRIN'\n      AND h.hierarchy_level = 'L3'\n),\n\nlong_vs_wide_adst AS (\n    SELECT\n        'long_vs_wide_adst_l3' AS test_name,\n        'Long=' || ROUND(l.total_sales,2) || ' Wide=' || ROUND(w.total_sales,2) AS detail\n    FROM long_adst_l3 l\n    CROSS JOIN wide_adst_l3 w\n    WHERE ABS(l.total_sales - w.total_sales) > GREATEST(w.total_sales * 0.01, 1.0)\n),\n\n-- Test 3: All Long L4 entity_ids exist in grain account_id_l4\nl4_in_long_not_in_grain AS (\n    SELECT\n        'l4_long_not_in_grain' AS test_name,\n        'L4 entity ' || l.entity_id || ' in long but not in grain' AS detail\n    FROM (\n        SELECT DISTINCT entity_id\n        FROM {{ ref('adm_ddd_metrics_long') }}\n        WHERE entity_type = 'HCO'\n          AND entity_id LIKE '4%'\n          AND period_key = 'L12M'\n    ) l\n    LEFT JOIN (\n        SELECT DISTINCT account_id_l4\n        FROM {{ ref('adm_ddd_metrics_grain') }}\n        WHERE account_id_l4 IS NOT NULL\n    ) g ON l.entity_id = g.account_id_l4\n    WHERE g.account_id_l4 IS NULL\n),\n\n-- Test 4: L4 entity count consistency between grain and long (within 10%)\ngrain_l4_count AS (\n    SELECT COUNT(DISTINCT account_id_l4) AS cnt\n    FROM {{ ref('adm_ddd_metrics_grain') }}\n    WHERE account_id_l4 IS NOT NULL\n),\n\nlong_l4_count AS (\n    SELECT COUNT(DISTINCT entity_id) AS cnt\n    FROM {{ ref('adm_ddd_metrics_long') }}\n    WHERE entity_type = 'HCO'\n      AND entity_id LIKE '4%'\n      AND period_key = 'L12M'\n),\n\nl4_count_mismatch AS (\n    SELECT\n        'l4_count_mismatch' AS test_name,\n        'Grain L4 entities=' || g.cnt || ' Long L4 entities=' || l.cnt AS detail\n    FROM grain_l4_count g\n    CROSS JOIN long_l4_count l\n    WHERE ABS(g.cnt - l.cnt) > GREATEST(g.cnt * 0.20, 10)\n)\n\nSELECT test_name, detail FROM long_vs_wide_tice\nUNION ALL\nSELECT test_name, detail FROM long_vs_wide_adst\nUNION ALL\nSELECT test_name, detail FROM l4_in_long_not_in_grain\nUNION ALL\nSELECT test_name, detail FROM l4_count_mismatch", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_ddd_metrics_long", "package": null, "version": null}, {"name": "adm_hco_hierarchy", "package": null, "version": null}, {"name": "adm_ddd_metrics_wide", "package": null, "version": null}, {"name": "adm_hco_hierarchy", "package": null, "version": null}, {"name": "adm_ddd_metrics_long", "package": null, "version": null}, {"name": "adm_hco_hierarchy", "package": null, "version": null}, {"name": "adm_ddd_metrics_wide", "package": null, "version": null}, {"name": "adm_hco_hierarchy", "package": null, "version": null}, {"name": "adm_ddd_metrics_long", "package": null, "version": null}, {"name": "adm_ddd_metrics_grain", "package": null, "version": null}, {"name": "adm_ddd_metrics_grain", "package": null, "version": null}, {"name": "adm_ddd_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.adm_ddd_metrics_long", "model.CGOncology_MDM.adm_hco_hierarchy", "model.CGOncology_MDM.adm_ddd_metrics_wide", "model.CGOncology_MDM.adm_ddd_metrics_grain"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}}, "test.CGOncology_MDM.qc_date_ranges": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "qc_date_ranges", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "data_quality/qc_date_ranges.sql", "original_file_path": "tests/data_quality/qc_date_ranges.sql", "unique_id": "test.CGOncology_MDM.qc_date_ranges", "fqn": ["CGOncology_MDM", "data_quality", "qc_date_ranges"], "alias": "qc_date_ranges", "checksum": {"name": "sha256", "checksum": "3793f6cdd5977709b5be6819a1bdbc36f31509e7bd162c3d47b3c4f51c1424b3"}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.179307, "relation_name": null, "raw_code": "/*\nData Quality Check: Date Range Validation\nValidates that claim dates are reasonable (not in future, not too old)\nShould return 0 rows if all dates are valid\n*/\n\nWITH dx_future_dates AS (\n    SELECT\n        'DX' AS claim_type,\n        'Future date' AS issue,\n        COUNT(*) AS record_count,\n        MIN(SERVICE_DATE) AS earliest_invalid_date,\n        MAX(SERVICE_DATE) AS latest_invalid_date\n    FROM {{ ref('std_dx_claims') }}\n    WHERE SERVICE_DATE > CURRENT_DATE\n    HAVING COUNT(*) > 0\n),\n\ndx_old_dates AS (\n    SELECT\n        'DX' AS claim_type,\n        'Too old (before 2010)' AS issue,\n        COUNT(*) AS record_count,\n        MIN(SERVICE_DATE) AS earliest_invalid_date,\n        MAX(SERVICE_DATE) AS latest_invalid_date\n    FROM {{ ref('std_dx_claims') }}\n    WHERE SERVICE_DATE < '2010-01-01'\n    HAVING COUNT(*) > 0\n),\n\npx_future_dates AS (\n    SELECT\n        'PX' AS claim_type,\n        'Future date' AS issue,\n        COUNT(*) AS record_count,\n        MIN(SERVICE_DATE) AS earliest_invalid_date,\n        MAX(SERVICE_DATE) AS latest_invalid_date\n    FROM {{ ref('std_px_claims') }}\n    WHERE SERVICE_DATE > CURRENT_DATE\n    HAVING COUNT(*) > 0\n),\n\npx_old_dates AS (\n    SELECT\n        'PX' AS claim_type,\n        'Too old (before 2010)' AS issue,\n        COUNT(*) AS record_count,\n        MIN(SERVICE_DATE) AS earliest_invalid_date,\n        MAX(SERVICE_DATE) AS latest_invalid_date\n    FROM {{ ref('std_px_claims') }}\n    WHERE SERVICE_DATE < '2010-01-01'\n    HAVING COUNT(*) > 0\n),\n\nrx_future_dates AS (\n    SELECT\n        'RX' AS claim_type,\n        'Future date' AS issue,\n        COUNT(*) AS record_count,\n        MIN(FILL_DATE) AS earliest_invalid_date,\n        MAX(FILL_DATE) AS latest_invalid_date\n    FROM {{ ref('std_rx_claims') }}\n    WHERE FILL_DATE > CURRENT_DATE\n    HAVING COUNT(*) > 0\n),\n\nrx_old_dates AS (\n    SELECT\n        'RX' AS claim_type,\n        'Too old (before 2010)' AS issue,\n        COUNT(*) AS record_count,\n        MIN(FILL_DATE) AS earliest_invalid_date,\n        MAX(FILL_DATE) AS latest_invalid_date\n    FROM {{ ref('std_rx_claims') }}\n    WHERE FILL_DATE < '2010-01-01'\n    HAVING COUNT(*) > 0\n)\n\nSELECT * FROM dx_future_dates\nUNION ALL\nSELECT * FROM dx_old_dates\nUNION ALL\nSELECT * FROM px_future_dates\nUNION ALL\nSELECT * FROM px_old_dates\nUNION ALL\nSELECT * FROM rx_future_dates\nUNION ALL\nSELECT * FROM rx_old_dates", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dx_claims", "package": null, "version": null}, {"name": "std_dx_claims", "package": null, "version": null}, {"name": "std_px_claims", "package": null, "version": null}, {"name": "std_px_claims", "package": null, "version": null}, {"name": "std_rx_claims", "package": null, "version": null}, {"name": "std_rx_claims", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.std_dx_claims", "model.CGOncology_MDM.std_px_claims", "model.CGOncology_MDM.std_rx_claims"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}}, "test.CGOncology_MDM.test_quarterly_freeze_consistency": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "test_quarterly_freeze_consistency", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "data_quality/test_quarterly_freeze_consistency.sql", "original_file_path": "tests/data_quality/test_quarterly_freeze_consistency.sql", "unique_id": "test.CGOncology_MDM.test_quarterly_freeze_consistency", "fqn": ["CGOncology_MDM", "data_quality", "test_quarterly_freeze_consistency"], "alias": "test_quarterly_freeze_consistency", "checksum": {"name": "sha256", "checksum": "4d0528cdbe3e06a1672fcce35d4acfbdda4a2a5a1af551757b6f8bcbf99ae053"}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.181355, "relation_name": null, "raw_code": "/*\nQuarterly Freeze Consistency Tests\nValidates the adm_frozen_account_type table used by adm_hco_master's freeze mechanism.\n\nTests:\n  1. Orphan IDs: Frozen table has IDs not present in adm_hco_master (stale freeze data)\n  2. Invalid account_type: Frozen values outside the known P-prefix classification set\n  3. Invalid hierarchy_level: Frozen values outside L1/L2/L3/L4\n\nNote: These tests validate the frozen TABLE data quality itself.\nIf adm_frozen_account_type does not exist or is empty, all tests pass (nothing to validate).\n\nReturns failing rows - 0 rows = all tests pass.\n*/\n\n-- Check if frozen table exists in this environment\n{% set frozen_table = target.database ~ '.ADM.adm_frozen_account_type' %}\n\nWITH frozen_table_exists AS (\n    SELECT COUNT(*) AS cnt\n    FROM {{ target.database }}.INFORMATION_SCHEMA.TABLES\n    WHERE TABLE_SCHEMA = 'ADM'\n      AND TABLE_NAME = 'ADM_FROZEN_ACCOUNT_TYPE'\n),\n\n-- Test 1: Orphan IDs - frozen KMK_HCO_IDs not in adm_hco_master\norphan_ids AS (\n    SELECT\n        'FREEZE_ORPHAN_ID' AS test_name,\n        f.KMK_HCO_ID AS failing_value,\n        'Frozen ID not found in adm_hco_master' AS message\n    FROM {{ frozen_table }} f\n    LEFT JOIN {{ ref('adm_hco_master') }} m ON f.KMK_HCO_ID = m.kmk_hco_id\n    WHERE m.kmk_hco_id IS NULL\n      AND (SELECT cnt FROM frozen_table_exists) > 0\n),\n\n-- Test 2: Invalid account_type values in frozen table\ninvalid_account_type AS (\n    SELECT\n        'FREEZE_INVALID_ACCOUNT_TYPE' AS test_name,\n        f.ACCOUNT_TYPE AS failing_value,\n        'account_type not in valid P-prefix set: ' || COALESCE(f.ACCOUNT_TYPE, 'NULL') AS message\n    FROM {{ frozen_table }} f\n    WHERE f.ACCOUNT_TYPE NOT IN (\n        'P1_LUGPA', 'P2_ACADEMIC', 'P2_NON-ACADEMIC',\n        'P3_ FEDERAL', 'P3_CCS', 'P4_SMALL_INDEP_Ctr'\n    )\n      AND f.ACCOUNT_TYPE IS NOT NULL\n      AND (SELECT cnt FROM frozen_table_exists) > 0\n),\n\n-- Test 3: Invalid hierarchy_level values in frozen table\ninvalid_hierarchy AS (\n    SELECT\n        'FREEZE_INVALID_HIERARCHY' AS test_name,\n        f.HIERARCHY_LEVEL AS failing_value,\n        'hierarchy_level not in L1-L4: ' || COALESCE(f.HIERARCHY_LEVEL, 'NULL') AS message\n    FROM {{ frozen_table }} f\n    WHERE f.HIERARCHY_LEVEL NOT IN ('L1', 'L2', 'L3', 'L4')\n      AND f.HIERARCHY_LEVEL IS NOT NULL\n      AND (SELECT cnt FROM frozen_table_exists) > 0\n)\n\nSELECT * FROM orphan_ids\nUNION ALL\nSELECT * FROM invalid_account_type\nUNION ALL\nSELECT * FROM invalid_hierarchy", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hco_master", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.adm_hco_master"]}, "compiled_path": "target/compiled/CGOncology_MDM/tests/data_quality/test_quarterly_freeze_consistency.sql", "compiled": true, "compiled_code": "/*\nQuarterly Freeze Consistency Tests\nValidates the adm_frozen_account_type table used by adm_hco_master's freeze mechanism.\n\nTests:\n  1. Orphan IDs: Frozen table has IDs not present in adm_hco_master (stale freeze data)\n  2. Invalid account_type: Frozen values outside the known P-prefix classification set\n  3. Invalid hierarchy_level: Frozen values outside L1/L2/L3/L4\n\nNote: These tests validate the frozen TABLE data quality itself.\nIf adm_frozen_account_type does not exist or is empty, all tests pass (nothing to validate).\n\nReturns failing rows - 0 rows = all tests pass.\n*/\n\n-- Check if frozen table exists in this environment\n\n\nWITH frozen_table_exists AS (\n    SELECT COUNT(*) AS cnt\n    FROM CGONCOLOGY_TEST.INFORMATION_SCHEMA.TABLES\n    WHERE TABLE_SCHEMA = 'ADM'\n      AND TABLE_NAME = 'ADM_FROZEN_ACCOUNT_TYPE'\n),\n\n-- Test 1: Orphan IDs - frozen KMK_HCO_IDs not in adm_hco_master\norphan_ids AS (\n    SELECT\n        'FREEZE_ORPHAN_ID' AS test_name,\n        f.KMK_HCO_ID AS failing_value,\n        'Frozen ID not found in adm_hco_master' AS message\n    FROM CGONCOLOGY_TEST.ADM.adm_frozen_account_type f\n    LEFT JOIN CGONCOLOGY_TEST.ADM.adm_hco_master m ON f.KMK_HCO_ID = m.kmk_hco_id\n    WHERE m.kmk_hco_id IS NULL\n      AND (SELECT cnt FROM frozen_table_exists) > 0\n),\n\n-- Test 2: Invalid account_type values in frozen table\ninvalid_account_type AS (\n    SELECT\n        'FREEZE_INVALID_ACCOUNT_TYPE' AS test_name,\n        f.ACCOUNT_TYPE AS failing_value,\n        'account_type not in valid P-prefix set: ' || COALESCE(f.ACCOUNT_TYPE, 'NULL') AS message\n    FROM CGONCOLOGY_TEST.ADM.adm_frozen_account_type f\n    WHERE f.ACCOUNT_TYPE NOT IN (\n        'P1_LUGPA', 'P2_ACADEMIC', 'P2_NON-ACADEMIC',\n        'P3_ FEDERAL', 'P3_CCS', 'P4_SMALL_INDEP_Ctr'\n    )\n      AND f.ACCOUNT_TYPE IS NOT NULL\n      AND (SELECT cnt FROM frozen_table_exists) > 0\n),\n\n-- Test 3: Invalid hierarchy_level values in frozen table\ninvalid_hierarchy AS (\n    SELECT\n        'FREEZE_INVALID_HIERARCHY' AS test_name,\n        f.HIERARCHY_LEVEL AS failing_value,\n        'hierarchy_level not in L1-L4: ' || COALESCE(f.HIERARCHY_LEVEL, 'NULL') AS message\n    FROM CGONCOLOGY_TEST.ADM.adm_frozen_account_type f\n    WHERE f.HIERARCHY_LEVEL NOT IN ('L1', 'L2', 'L3', 'L4')\n      AND f.HIERARCHY_LEVEL IS NOT NULL\n      AND (SELECT cnt FROM frozen_table_exists) > 0\n)\n\nSELECT * FROM orphan_ids\nUNION ALL\nSELECT * FROM invalid_account_type\nUNION ALL\nSELECT * FROM invalid_hierarchy", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}}, "test.CGOncology_MDM.test_ddd_l4_reconciliation": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "test_ddd_l4_reconciliation", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "data_quality/test_ddd_l4_reconciliation.sql", "original_file_path": "tests/data_quality/test_ddd_l4_reconciliation.sql", "unique_id": "test.CGOncology_MDM.test_ddd_l4_reconciliation", "fqn": ["CGOncology_MDM", "data_quality", "test_ddd_l4_reconciliation"], "alias": "test_ddd_l4_reconciliation", "checksum": {"name": "sha256", "checksum": "67ed9943503f7617ebfa3a210b51bd91b3cd37ec10043d743c8e2ced9a735206"}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "warn", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"severity": "warn"}, "created_at": 1770177079.1832829, "relation_name": null, "raw_code": "{{ config(severity='warn') }}\n/*\nDDD L4 Practice Location Reconciliation Tests\nValidates L4 data integrity in the DDD metrics pipeline.\n\nTests:\n  1. L4 entities in ddd_metrics_long exist in adm_hco_hierarchy\n  2. L4 grain rows with account_id_l4 have valid hierarchy entries\n  3. L4 metrics do not exceed their L3 parent totals (rollup consistency)\n  4. Grain table has meaningful L4 population (>= 500 HCOs)\n\nReturns failing rows - 0 rows = all tests pass.\n*/\n\n-- Test 1: All L4 entity_ids in adm_ddd_metrics_long exist in adm_hco_hierarchy\nWITH l4_entities_not_in_hierarchy AS (\n    SELECT DISTINCT\n        l.entity_id,\n        'L4 entity not in hierarchy' AS test_name\n    FROM {{ ref('adm_ddd_metrics_long') }} l\n    LEFT JOIN {{ ref('adm_hco_hierarchy') }} h\n        ON l.entity_id = h.kmk_hco_id\n    WHERE l.entity_id LIKE '4%'\n      AND l.entity_type = 'HCO'\n      AND l.period_key = 'L12M'\n      AND h.kmk_hco_id IS NULL\n),\n\n-- Test 2: Grain rows with account_id_l4 have valid L4 hierarchy entries\nl4_grain_not_in_hierarchy AS (\n    SELECT DISTINCT\n        g.account_id_l4 AS entity_id,\n        'L4 grain ID not in hierarchy' AS test_name\n    FROM {{ ref('adm_ddd_metrics_grain') }} g\n    LEFT JOIN {{ ref('adm_hco_hierarchy') }} h\n        ON g.account_id_l4 = h.kmk_hco_id\n        AND h.hierarchy_level = 'L4'\n    WHERE g.account_id_l4 IS NOT NULL\n      AND h.kmk_hco_id IS NULL\n),\n\n-- Test 3: L4 TICE_BCG L12M units do not exceed L3 parent totals\n-- Uses JOIN instead of correlated subquery (Snowflake limitation)\nl4_exceeds_l3 AS (\n    SELECT\n        l4_data.entity_id,\n        'L4 units (' || l4_data.units_count || ') exceed L3 parent (' || l3_data.units_count || ')' AS test_name\n    FROM {{ ref('adm_ddd_metrics_long') }} l4_data\n    INNER JOIN {{ ref('adm_hco_hierarchy') }} h\n        ON l4_data.entity_id = h.kmk_hco_id\n        AND h.hierarchy_level = 'L4'\n    INNER JOIN {{ ref('adm_ddd_metrics_long') }} l3_data\n        ON h.account_id_l3 = l3_data.entity_id\n        AND l3_data.entity_type = 'HCO'\n        AND l3_data.metric_category = 'TICE_BCG'\n        AND l3_data.period_key = 'L12M'\n    WHERE l4_data.entity_id LIKE '4%'\n      AND l4_data.entity_type = 'HCO'\n      AND l4_data.metric_category = 'TICE_BCG'\n      AND l4_data.period_key = 'L12M'\n      AND l4_data.units_count > l3_data.units_count\n),\n\n-- Test 4: Grain table has meaningful L4 population (>= 500 distinct HCOs with L4)\nl4_coverage_check AS (\n    SELECT\n        'insufficient_l4_coverage' AS entity_id,\n        'L4 coverage below 500 HCOs (found ' || COUNT(DISTINCT account_id_l4) || ')' AS test_name\n    FROM {{ ref('adm_ddd_metrics_grain') }}\n    WHERE account_id_l4 IS NOT NULL\n    HAVING COUNT(DISTINCT account_id_l4) < 500\n)\n\nSELECT entity_id, test_name FROM l4_entities_not_in_hierarchy\nUNION ALL\nSELECT entity_id, test_name FROM l4_grain_not_in_hierarchy\nUNION ALL\nSELECT entity_id, test_name FROM l4_exceeds_l3\nUNION ALL\nSELECT entity_id, test_name FROM l4_coverage_check", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_ddd_metrics_long", "package": null, "version": null}, {"name": "adm_hco_hierarchy", "package": null, "version": null}, {"name": "adm_ddd_metrics_grain", "package": null, "version": null}, {"name": "adm_hco_hierarchy", "package": null, "version": null}, {"name": "adm_ddd_metrics_long", "package": null, "version": null}, {"name": "adm_hco_hierarchy", "package": null, "version": null}, {"name": "adm_ddd_metrics_long", "package": null, "version": null}, {"name": "adm_ddd_metrics_grain", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.adm_ddd_metrics_long", "model.CGOncology_MDM.adm_hco_hierarchy", "model.CGOncology_MDM.adm_ddd_metrics_grain"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}}, "test.CGOncology_MDM.test_standardization_bounds": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "test_standardization_bounds", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "sfe/test_standardization_bounds.sql", "original_file_path": "tests/sfe/test_standardization_bounds.sql", "unique_id": "test.CGOncology_MDM.test_standardization_bounds", "fqn": ["CGOncology_MDM", "sfe", "test_standardization_bounds"], "alias": "test_standardization_bounds", "checksum": {"name": "sha256", "checksum": "70074f444ce3b81c3aff2e8b22b4826a1c1141bc781e38294db5100190777cc4"}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.1856372, "relation_name": null, "raw_code": "/*\nTest: Min-Max Standardization Bounds Validation\nPurpose: Verify that all standardized values are within 0-1 range\nReturns rows where standardized values are outside expected bounds\n*/\n\nSELECT\n    NPI,\n    STANDARDIZED_TOTAL_PATIENTS,\n    STANDARDIZED_BCG_CLAIMS,\n    STANDARDIZED_TURBT_CLAIMS,\n    COMPOSITE_SCORE,\n    CASE\n        WHEN STANDARDIZED_TOTAL_PATIENTS < 0 OR STANDARDIZED_TOTAL_PATIENTS > 1\n            THEN 'STANDARDIZED_TOTAL_PATIENTS out of bounds'\n        WHEN STANDARDIZED_BCG_CLAIMS < 0 OR STANDARDIZED_BCG_CLAIMS > 1\n            THEN 'STANDARDIZED_BCG_CLAIMS out of bounds'\n        WHEN STANDARDIZED_TURBT_CLAIMS < 0 OR STANDARDIZED_TURBT_CLAIMS > 1\n            THEN 'STANDARDIZED_TURBT_CLAIMS out of bounds'\n        WHEN COMPOSITE_SCORE < 0 OR COMPOSITE_SCORE > 1\n            THEN 'COMPOSITE_SCORE out of bounds (should be 0-1)'\n    END AS validation_issue\nFROM {{ ref('hcp_decile') }}\nWHERE STANDARDIZED_TOTAL_PATIENTS < 0 OR STANDARDIZED_TOTAL_PATIENTS > 1\n   OR STANDARDIZED_BCG_CLAIMS < 0 OR STANDARDIZED_BCG_CLAIMS > 1\n   OR STANDARDIZED_TURBT_CLAIMS < 0 OR STANDARDIZED_TURBT_CLAIMS > 1\n   OR COMPOSITE_SCORE < 0 OR COMPOSITE_SCORE > 1", "doc_blocks": [], "language": "sql", "refs": [{"name": "hcp_decile", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.hcp_decile"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}}, "test.CGOncology_MDM.test_cumulative_decile_boundaries": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "test_cumulative_decile_boundaries", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "sfe/test_cumulative_decile_boundaries.sql", "original_file_path": "tests/sfe/test_cumulative_decile_boundaries.sql", "unique_id": "test.CGOncology_MDM.test_cumulative_decile_boundaries", "fqn": ["CGOncology_MDM", "sfe", "test_cumulative_decile_boundaries"], "alias": "test_cumulative_decile_boundaries", "checksum": {"name": "sha256", "checksum": "633034284938ecd8299a63bdd13f34db3772b0bbd1b2ac97307d50204fb22d31"}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.187005, "relation_name": null, "raw_code": "/*\nTest: Cumulative Decile Boundary Validation\nPurpose: Verify that decile boundaries align with cumulative score percentages\n- Decile 10 should have cumulative % <= 10%\n- Decile 9 should have cumulative % > 10% and <= 20%\n- etc.\nReturns rows where HCPs are assigned to wrong decile based on cumulative percentage\n*/\n\nWITH hcp_with_cumulative AS (\n    SELECT\n        NPI,\n        COMPOSITE_SCORE,\n        DECILE,\n        SUM(COMPOSITE_SCORE) OVER (ORDER BY COMPOSITE_SCORE DESC, NPI) AS cumulative_score,\n        SUM(COMPOSITE_SCORE) OVER () AS total_score\n    FROM {{ ref('hcp_decile') }}\n),\n\nhcp_with_pct AS (\n    SELECT\n        NPI,\n        COMPOSITE_SCORE,\n        DECILE,\n        ROUND((cumulative_score / total_score) * 100, 2) AS cumulative_pct,\n        -- Calculate expected decile based on cumulative percentage\n        CASE\n            WHEN total_score = 0 THEN 1\n            WHEN (cumulative_score / total_score) * 100 <= 10 THEN 10\n            WHEN (cumulative_score / total_score) * 100 <= 20 THEN 9\n            WHEN (cumulative_score / total_score) * 100 <= 30 THEN 8\n            WHEN (cumulative_score / total_score) * 100 <= 40 THEN 7\n            WHEN (cumulative_score / total_score) * 100 <= 50 THEN 6\n            WHEN (cumulative_score / total_score) * 100 <= 60 THEN 5\n            WHEN (cumulative_score / total_score) * 100 <= 70 THEN 4\n            WHEN (cumulative_score / total_score) * 100 <= 80 THEN 3\n            WHEN (cumulative_score / total_score) * 100 <= 90 THEN 2\n            ELSE 1\n        END AS expected_decile\n    FROM hcp_with_cumulative\n)\n\n-- Return rows where actual decile doesn't match expected decile\nSELECT\n    NPI,\n    COMPOSITE_SCORE,\n    cumulative_pct,\n    DECILE AS actual_decile,\n    expected_decile,\n    'Decile assignment mismatch' AS validation_issue\nFROM hcp_with_pct\nWHERE DECILE != expected_decile\nORDER BY cumulative_pct", "doc_blocks": [], "language": "sql", "refs": [{"name": "hcp_decile", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.hcp_decile"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}}, "test.CGOncology_MDM.test_weighted_score_formula": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "test_weighted_score_formula", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "sfe/test_weighted_score_formula.sql", "original_file_path": "tests/sfe/test_weighted_score_formula.sql", "unique_id": "test.CGOncology_MDM.test_weighted_score_formula", "fqn": ["CGOncology_MDM", "sfe", "test_weighted_score_formula"], "alias": "test_weighted_score_formula", "checksum": {"name": "sha256", "checksum": "36e054335c4eaa67fcf14093e4d3918f6c59a2acb669578ed276532f2c6ce1b6"}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.188546, "relation_name": null, "raw_code": "/*\nTest: Composite Score Formula Validation\nPurpose: Verify that COMPOSITE_SCORE matches the expected formula using standardized values\nFormula: (STANDARDIZED_TOTAL_PATIENTS * 0.10) + (STANDARDIZED_BCG_CLAIMS * 0.45) + (STANDARDIZED_TURBT_CLAIMS * 0.45)\nReturns rows where calculated score doesn't match stored score\n*/\n\nWITH score_validation AS (\n    SELECT\n        NPI,\n        STANDARDIZED_TOTAL_PATIENTS,\n        STANDARDIZED_BCG_CLAIMS,\n        STANDARDIZED_TURBT_CLAIMS,\n        COMPOSITE_SCORE AS stored_score,\n        (COALESCE(STANDARDIZED_TOTAL_PATIENTS, 0) * 0.10 +\n         COALESCE(STANDARDIZED_BCG_CLAIMS, 0) * 0.45 +\n         COALESCE(STANDARDIZED_TURBT_CLAIMS, 0) * 0.45) AS calculated_score,\n        -- Calculate absolute difference\n        ABS(COMPOSITE_SCORE -\n            (COALESCE(STANDARDIZED_TOTAL_PATIENTS, 0) * 0.10 +\n             COALESCE(STANDARDIZED_BCG_CLAIMS, 0) * 0.45 +\n             COALESCE(STANDARDIZED_TURBT_CLAIMS, 0) * 0.45)) AS score_diff\n    FROM {{ ref('hcp_decile') }}\n)\n\n-- Return rows where stored score doesn't match calculated score\n-- Allow for tiny rounding differences (< 0.0001)\nSELECT\n    NPI,\n    STANDARDIZED_TOTAL_PATIENTS,\n    STANDARDIZED_BCG_CLAIMS,\n    STANDARDIZED_TURBT_CLAIMS,\n    stored_score,\n    calculated_score,\n    score_diff,\n    'Composite score mismatch' AS validation_issue\nFROM score_validation\nWHERE score_diff >= 0.0001\nORDER BY score_diff DESC", "doc_blocks": [], "language": "sql", "refs": [{"name": "hcp_decile", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.hcp_decile"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}}, "test.CGOncology_MDM.test_decile_score_distribution": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "test_decile_score_distribution", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "sfe/test_decile_score_distribution.sql", "original_file_path": "tests/sfe/test_decile_score_distribution.sql", "unique_id": "test.CGOncology_MDM.test_decile_score_distribution", "fqn": ["CGOncology_MDM", "sfe", "test_decile_score_distribution"], "alias": "test_decile_score_distribution", "checksum": {"name": "sha256", "checksum": "b238476aa27aacef96b3cbc2653fe88a51fe5887e3c81d271fa78ccee4f2c73f"}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.189974, "relation_name": null, "raw_code": "/*\nTest: Decile Score Distribution Validation\nPurpose: Verify that each decile contains approximately 10% of total composite score\nTolerance: \u00b11% (i.e., each decile should be between 9% and 11% of total score)\nReturns rows if any decile falls outside tolerance range\n*/\n\nWITH decile_scores AS (\n    SELECT\n        DECILE,\n        SUM(COMPOSITE_SCORE) AS decile_total_score,\n        COUNT(*) AS hcp_count\n    FROM {{ ref('hcp_decile') }}\n    GROUP BY DECILE\n),\n\noverall_total AS (\n    SELECT SUM(COMPOSITE_SCORE) AS total_score\n    FROM {{ ref('hcp_decile') }}\n),\n\ndecile_percentages AS (\n    SELECT\n        d.DECILE,\n        d.decile_total_score,\n        d.hcp_count,\n        o.total_score,\n        ROUND((d.decile_total_score / o.total_score) * 100, 2) AS pct_of_total_score\n    FROM decile_scores d\n    CROSS JOIN overall_total o\n)\n\n-- Return rows where decile percentage is outside tolerance (9% to 11%)\nSELECT\n    DECILE,\n    hcp_count,\n    decile_total_score,\n    total_score,\n    pct_of_total_score,\n    CASE\n        WHEN pct_of_total_score < 9 THEN 'Below 9% - too low'\n        WHEN pct_of_total_score > 11 THEN 'Above 11% - too high'\n    END AS validation_issue\nFROM decile_percentages\nWHERE pct_of_total_score < 9.0\n   OR pct_of_total_score > 11.0\nORDER BY DECILE", "doc_blocks": [], "language": "sql", "refs": [{"name": "hcp_decile", "package": null, "version": null}, {"name": "hcp_decile", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.hcp_decile"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}}, "test.CGOncology_MDM.val_cb_028_treatment_category_distribution": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "val_cb_028_treatment_category_distribution", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "business_rules/val_cb_028_treatment_category_distribution.sql", "original_file_path": "tests/business_rules/val_cb_028_treatment_category_distribution.sql", "unique_id": "test.CGOncology_MDM.val_cb_028_treatment_category_distribution", "fqn": ["CGOncology_MDM", "business_rules", "val_cb_028_treatment_category_distribution"], "alias": "val_cb_028_treatment_category_distribution", "checksum": {"name": "sha256", "checksum": "e688a3c410fba2d6bfa0d9bb5f5a904a653d813ee5c8fbf5d84062275273495e"}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.191354, "relation_name": null, "raw_code": "/*\nVAL-CB-028: Validate Treatment Category Distribution\nTests that treatment category distribution makes sense across all claim types\nShould return 0 rows if distribution is valid (no null categories for BC-specific codes)\n\nUpdated Jan 2026: Now uses stg_hcp_hco_claims (centralized BC claims model)\ninstead of separate stg_bc_dx_claims, stg_bc_px_claims, stg_bc_rx_claims\n\nNote: stg_hcp_hco_claims only includes:\n- DX claims: TREATMENT_CATEGORY is always NULL (no treatment category for diagnoses)\n- PX claims: TREATMENT_CATEGORY from ref_treatment_categories seed\n- RX claims: TREATMENT_CATEGORY from std_rx_claims (filtered to BC-related only)\n*/\n\nWITH category_validation AS (\n    SELECT\n        CLAIM_TYPE,\n        TREATMENT_CATEGORY,\n        COUNT(DISTINCT PATIENT_ID) AS patient_count,\n        COUNT(*) AS claim_count\n    FROM {{ ref('stg_hcp_hco_claims') }}\n    -- Only validate PX and RX claims (DX has no treatment category by design)\n    WHERE CLAIM_TYPE IN ('PX', 'RX')\n      AND TREATMENT_CATEGORY IS NOT NULL  -- Only BC-specific claims have treatment category\n    GROUP BY CLAIM_TYPE, TREATMENT_CATEGORY\n)\n\nSELECT\n    CLAIM_TYPE,\n    TREATMENT_CATEGORY,\n    patient_count,\n    claim_count,\n    CASE\n        WHEN patient_count = 0\n        THEN 'Treatment category has zero patients'\n        WHEN claim_count = 0\n        THEN 'Treatment category has zero claims'\n        ELSE 'Unknown issue'\n    END AS error_message\nFROM category_validation\nWHERE patient_count = 0\n   OR claim_count = 0", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_hco_claims", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.stg_hcp_hco_claims"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}}, "test.CGOncology_MDM.val_cb_025_code_mapping_coverage": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "val_cb_025_code_mapping_coverage", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "business_rules/val_cb_025_code_mapping_coverage.sql", "original_file_path": "tests/business_rules/val_cb_025_code_mapping_coverage.sql", "unique_id": "test.CGOncology_MDM.val_cb_025_code_mapping_coverage", "fqn": ["CGOncology_MDM", "business_rules", "val_cb_025_code_mapping_coverage"], "alias": "val_cb_025_code_mapping_coverage", "checksum": {"name": "sha256", "checksum": "924354444228fcf3ddd1b85bcd74c743a4550f57ad01df02325882bfcd7a1df2"}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.192817, "relation_name": null, "raw_code": "/*\nVAL-CB-025: Validate Code Mapping Coverage\nTests that all BC patients identified have at least one code that maps to seed files\nShould return 0 rows if all patient identifications are valid\n*/\n\nWITH dx_patients_without_mapping AS (\n    SELECT DISTINCT\n        'DX' AS pathway,\n        pt.PATIENT_ID,\n        COUNT(DISTINCT dx.DIAGNOSIS_CODE) AS unmapped_code_count,\n        'BC patient identified but no matching codes found in seed mappings' AS error_message\n    FROM {{ ref('std_dx_bc_patients') }} pt\n    LEFT JOIN {{ ref('std_dx_claims') }} dx\n        ON pt.PATIENT_ID = dx.PATIENT_ID\n    LEFT JOIN {{ ref('seed_bc_dx_code_mapping') }} mapping\n        ON dx.DIAGNOSIS_CODE = mapping.DIAGNOSIS_CODE\n        AND mapping.BC_PATIENT_POOL_FLAG = 'Y'\n    WHERE mapping.DIAGNOSIS_CODE IS NULL\n    GROUP BY pt.PATIENT_ID\n),\n\npx_patients_without_mapping AS (\n    SELECT DISTINCT\n        'PX' AS pathway,\n        pt.PATIENT_ID,\n        COUNT(DISTINCT px.PROCEDURE_CODE) AS unmapped_code_count,\n        'BC patient identified but no matching codes found in seed mappings' AS error_message\n    FROM {{ ref('std_px_bc_patients') }} pt\n    LEFT JOIN {{ ref('std_px_claims') }} px\n        ON pt.PATIENT_ID = px.PATIENT_ID\n    LEFT JOIN {{ ref('seed_bc_px_code_mapping') }} mapping\n        ON px.PROCEDURE_CODE = mapping.PROCEDURE_CODE\n        AND mapping.BC_PATIENT_POOL_FLAG = 'Y'\n    WHERE mapping.PROCEDURE_CODE IS NULL\n    GROUP BY pt.PATIENT_ID\n),\n\nrx_patients_without_mapping AS (\n    SELECT DISTINCT\n        'RX' AS pathway,\n        pt.PATIENT_ID,\n        COUNT(DISTINCT rx.NDC11) AS unmapped_code_count,\n        'BC patient identified but no matching codes found in seed mappings' AS error_message\n    FROM {{ ref('std_rx_bc_patients') }} pt\n    LEFT JOIN {{ ref('std_rx_claims') }} rx\n        ON pt.PATIENT_ID = rx.PATIENT_ID\n    LEFT JOIN {{ ref('seed_bc_rx_ndc_mapping') }} mapping\n        ON rx.NDC11 = mapping.NDC11\n        AND mapping.BC_PATIENT_POOL_FLAG = 'Y'\n    WHERE mapping.NDC11 IS NULL\n      -- Exclude patients identified only via product name matching\n      AND NOT (\n          (UPPER(rx.PRODUCT_NAME) LIKE '%BACILLUS%' AND UPPER(rx.PRODUCT_NAME) LIKE '%CALMETTE%')\n          OR UPPER(rx.PRODUCT_NAME) LIKE '%BCG%'\n      )\n    GROUP BY pt.PATIENT_ID\n)\n\nSELECT\n    pathway,\n    PATIENT_ID,\n    unmapped_code_count,\n    error_message\nFROM dx_patients_without_mapping\nUNION ALL\nSELECT\n    pathway,\n    PATIENT_ID,\n    unmapped_code_count,\n    error_message\nFROM px_patients_without_mapping\nUNION ALL\nSELECT\n    pathway,\n    PATIENT_ID,\n    unmapped_code_count,\n    error_message\nFROM rx_patients_without_mapping", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dx_bc_patients", "package": null, "version": null}, {"name": "std_dx_claims", "package": null, "version": null}, {"name": "seed_bc_dx_code_mapping", "package": null, "version": null}, {"name": "std_px_bc_patients", "package": null, "version": null}, {"name": "std_px_claims", "package": null, "version": null}, {"name": "seed_bc_px_code_mapping", "package": null, "version": null}, {"name": "std_rx_bc_patients", "package": null, "version": null}, {"name": "std_rx_claims", "package": null, "version": null}, {"name": "seed_bc_rx_ndc_mapping", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.std_dx_bc_patients", "model.CGOncology_MDM.std_dx_claims", "seed.CGOncology_MDM.seed_bc_dx_code_mapping", "model.CGOncology_MDM.std_px_bc_patients", "model.CGOncology_MDM.std_px_claims", "seed.CGOncology_MDM.seed_bc_px_code_mapping", "model.CGOncology_MDM.std_rx_bc_patients", "model.CGOncology_MDM.std_rx_claims", "seed.CGOncology_MDM.seed_bc_rx_ndc_mapping"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}}, "test.CGOncology_MDM.val_cb_029_code_mapping_completeness": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "val_cb_029_code_mapping_completeness", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "business_rules/val_cb_029_code_mapping_completeness.sql", "original_file_path": "tests/business_rules/val_cb_029_code_mapping_completeness.sql", "unique_id": "test.CGOncology_MDM.val_cb_029_code_mapping_completeness", "fqn": ["CGOncology_MDM", "business_rules", "val_cb_029_code_mapping_completeness"], "alias": "val_cb_029_code_mapping_completeness", "checksum": {"name": "sha256", "checksum": "3d7d87e7c207e08255f40a312262a0e42425775fed8b85b4b91299dd2961e09d"}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.194709, "relation_name": null, "raw_code": "/*\nVAL-CB-029: Validate Code Mapping Completeness\nDetects BC-like codes in claims that are not in code mapping seed files\nReturns rows for unmapped codes that may need to be added to seed files\n*/\n\nWITH unmapped_dx AS (\n    SELECT DISTINCT\n        'DX' AS claim_type,\n        DIAGNOSIS_CODE AS code,\n        COUNT(DISTINCT PATIENT_ID) AS affected_patients,\n        COUNT(*) AS claim_count,\n        'Potential new BC code not in seed mappings - review for inclusion' AS warning_message\n    FROM {{ ref('std_dx_claims') }}\n    WHERE (DIAGNOSIS_CODE LIKE 'C67%'\n           OR DIAGNOSIS_CODE IN ('D090', 'D414', 'D494', 'Z8551'))\n      AND DIAGNOSIS_CODE NOT IN (\n          SELECT DIAGNOSIS_CODE FROM {{ ref('seed_bc_dx_code_mapping') }}\n      )\n    GROUP BY DIAGNOSIS_CODE\n    HAVING COUNT(DISTINCT PATIENT_ID) >= 5  -- Threshold: 5+ patients\n),\n\nunmapped_px AS (\n    SELECT DISTINCT\n        'PX' AS claim_type,\n        PROCEDURE_CODE AS code,\n        COUNT(DISTINCT PATIENT_ID) AS affected_patients,\n        COUNT(*) AS claim_count,\n        'Potential new BC code not in seed mappings - review for inclusion' AS warning_message\n    FROM {{ ref('std_px_claims') }}\n    WHERE PROCEDURE_CODE IN ('52214','52224','52234','52235','52240',\n                              'J9031','J9030','90586','J9029','J9028',\n                              '51720','J9357','52000','52204',\n                              '51550','51555','51565','51570','51575',\n                              '51580','51585','51590','51595','51596')\n      AND PROCEDURE_CODE NOT IN (\n          SELECT PROCEDURE_CODE FROM {{ ref('seed_bc_px_code_mapping') }}\n      )\n    GROUP BY PROCEDURE_CODE\n    HAVING COUNT(DISTINCT PATIENT_ID) >= 5  -- Threshold: 5+ patients\n),\n\nunmapped_rx AS (\n    SELECT DISTINCT\n        'RX' AS claim_type,\n        NDC11 AS code,\n        COUNT(DISTINCT PATIENT_ID) AS affected_patients,\n        COUNT(*) AS claim_count,\n        'Potential new BC code not in seed mappings - review for inclusion' AS warning_message\n    FROM {{ ref('std_rx_claims') }}\n    WHERE (UPPER(PRODUCT_NAME) LIKE '%BCG%'\n           OR (UPPER(PRODUCT_NAME) LIKE '%BACILLUS%'\n               AND UPPER(PRODUCT_NAME) LIKE '%CALMETTE%'))\n      AND NDC11 NOT IN (\n          SELECT NDC11 FROM {{ ref('seed_bc_rx_ndc_mapping') }}\n      )\n    GROUP BY NDC11\n    HAVING COUNT(DISTINCT PATIENT_ID) >= 5  -- Threshold: 5+ patients\n)\n\nSELECT\n    claim_type,\n    code,\n    affected_patients,\n    claim_count,\n    warning_message\nFROM unmapped_dx\nUNION ALL\nSELECT\n    claim_type,\n    code,\n    affected_patients,\n    claim_count,\n    warning_message\nFROM unmapped_px\nUNION ALL\nSELECT\n    claim_type,\n    code,\n    affected_patients,\n    claim_count,\n    warning_message\nFROM unmapped_rx\nORDER BY affected_patients DESC", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dx_claims", "package": null, "version": null}, {"name": "seed_bc_dx_code_mapping", "package": null, "version": null}, {"name": "std_px_claims", "package": null, "version": null}, {"name": "seed_bc_px_code_mapping", "package": null, "version": null}, {"name": "std_rx_claims", "package": null, "version": null}, {"name": "seed_bc_rx_ndc_mapping", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.std_dx_claims", "seed.CGOncology_MDM.seed_bc_dx_code_mapping", "model.CGOncology_MDM.std_px_claims", "seed.CGOncology_MDM.seed_bc_px_code_mapping", "model.CGOncology_MDM.std_rx_claims", "seed.CGOncology_MDM.seed_bc_rx_ndc_mapping"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}}, "test.CGOncology_MDM.val_cb_026_patient_pool_consolidation": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "val_cb_026_patient_pool_consolidation", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "business_rules/val_cb_026_patient_pool_consolidation.sql", "original_file_path": "tests/business_rules/val_cb_026_patient_pool_consolidation.sql", "unique_id": "test.CGOncology_MDM.val_cb_026_patient_pool_consolidation", "fqn": ["CGOncology_MDM", "business_rules", "val_cb_026_patient_pool_consolidation"], "alias": "val_cb_026_patient_pool_consolidation", "checksum": {"name": "sha256", "checksum": "7e1d2950c4edeb51bf5ec5ddaf21771d3440e159e4dfd784ad0a98434f1dfbf5"}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.196887, "relation_name": null, "raw_code": "/*\nVAL-CB-026: Validate Patient Pool Consolidation\nTests that the FULL OUTER JOIN in stg_bc_patient_pool correctly consolidates all\nqualifying patients from the three pathways (DX, PX, RX).\n\n\"Qualifying\" means meeting inclusion criteria PAT-010/011/012:\n  - LATEST_BC_EVENT_DATE within configured date range\n  - DX_CLAIM_COUNT > 0 (must have diagnosis)\n  - PX_CLAIM_COUNT > 0 OR RX_CLAIM_COUNT > 0 (must have treatment)\n\nShould return 0 rows if all qualifying patients are in consolidated pool.\n*/\n\nWITH date_config AS (\n    SELECT\n        DATE('{{ var('claims_start_date') }}') AS start_date,\n        DATE('{{ var('claims_end_date') }}') AS end_date\n),\n\n-- Replicate the model's FULL OUTER JOIN to compute expected qualifying patients\ndx_patients AS (SELECT * FROM {{ ref('std_dx_bc_patients') }}),\npx_patients AS (SELECT * FROM {{ ref('std_px_bc_patients') }}),\nrx_patients AS (SELECT * FROM {{ ref('std_rx_bc_patients') }}),\n\nconsolidated AS (\n    SELECT\n        COALESCE(dx.PATIENT_ID, px.PATIENT_ID, rx.PATIENT_ID) AS PATIENT_ID,\n        CASE WHEN dx.PATIENT_ID IS NOT NULL THEN 'Y' ELSE 'N' END AS IDENTIFIED_VIA_DX,\n        CASE WHEN px.PATIENT_ID IS NOT NULL THEN 'Y' ELSE 'N' END AS IDENTIFIED_VIA_PX,\n        CASE WHEN rx.PATIENT_ID IS NOT NULL THEN 'Y' ELSE 'N' END AS IDENTIFIED_VIA_RX,\n        GREATEST(\n            COALESCE(dx.LATEST_DX_DATE, '1900-01-01'),\n            COALESCE(px.LATEST_PX_DATE, '1900-01-01'),\n            COALESCE(rx.LATEST_RX_DATE, '1900-01-01')\n        ) AS LATEST_BC_EVENT_DATE,\n        COALESCE(dx.DX_CLAIM_COUNT, 0) AS DX_CLAIM_COUNT,\n        COALESCE(px.PX_CLAIM_COUNT, 0) AS PX_CLAIM_COUNT,\n        COALESCE(rx.RX_CLAIM_COUNT, 0) AS RX_CLAIM_COUNT\n    FROM dx_patients dx\n    FULL OUTER JOIN px_patients px ON dx.PATIENT_ID = px.PATIENT_ID\n    FULL OUTER JOIN rx_patients rx ON COALESCE(dx.PATIENT_ID, px.PATIENT_ID) = rx.PATIENT_ID\n),\n\n-- Apply same inclusion criteria as model (PAT-010/011/012)\nexpected_qualifying AS (\n    SELECT *\n    FROM consolidated c\n    CROSS JOIN date_config dc\n    WHERE c.LATEST_BC_EVENT_DATE >= dc.start_date\n      AND c.LATEST_BC_EVENT_DATE <= dc.end_date\n      AND c.DX_CLAIM_COUNT > 0\n      AND (c.PX_CLAIM_COUNT > 0 OR c.RX_CLAIM_COUNT > 0)\n),\n\n-- Expected pathway counts (from replicated logic)\nexpected_counts AS (\n    SELECT 'DX' AS pathway, COUNT(DISTINCT PATIENT_ID) AS patient_count\n    FROM expected_qualifying WHERE IDENTIFIED_VIA_DX = 'Y'\n    UNION ALL\n    SELECT 'PX', COUNT(DISTINCT PATIENT_ID)\n    FROM expected_qualifying WHERE IDENTIFIED_VIA_PX = 'Y'\n    UNION ALL\n    SELECT 'RX', COUNT(DISTINCT PATIENT_ID)\n    FROM expected_qualifying WHERE IDENTIFIED_VIA_RX = 'Y'\n),\n\n-- Actual pathway counts (from pool output)\npool_counts AS (\n    SELECT 'DX' AS pathway, COUNT(DISTINCT PATIENT_ID) AS patient_count\n    FROM {{ ref('stg_bc_patient_pool') }} WHERE IDENTIFIED_VIA_DX = 'Y'\n    UNION ALL\n    SELECT 'PX', COUNT(DISTINCT PATIENT_ID)\n    FROM {{ ref('stg_bc_patient_pool') }} WHERE IDENTIFIED_VIA_PX = 'Y'\n    UNION ALL\n    SELECT 'RX', COUNT(DISTINCT PATIENT_ID)\n    FROM {{ ref('stg_bc_patient_pool') }} WHERE IDENTIFIED_VIA_RX = 'Y'\n),\n\nvalidation AS (\n    SELECT\n        e.pathway,\n        e.patient_count AS expected_count,\n        p.patient_count AS pool_count,\n        (p.patient_count - e.patient_count) AS difference\n    FROM expected_counts e\n    INNER JOIN pool_counts p ON e.pathway = p.pathway\n)\n\nSELECT\n    pathway,\n    expected_count,\n    pool_count,\n    difference,\n    'Patient pool consolidation mismatch for pathway' AS error_message\nFROM validation\nWHERE difference != 0", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dx_bc_patients", "package": null, "version": null}, {"name": "std_px_bc_patients", "package": null, "version": null}, {"name": "std_rx_bc_patients", "package": null, "version": null}, {"name": "stg_bc_patient_pool", "package": null, "version": null}, {"name": "stg_bc_patient_pool", "package": null, "version": null}, {"name": "stg_bc_patient_pool", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.std_dx_bc_patients", "model.CGOncology_MDM.std_px_bc_patients", "model.CGOncology_MDM.std_rx_bc_patients", "model.CGOncology_MDM.stg_bc_patient_pool"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}}, "test.CGOncology_MDM.dashboard_reporting_test_cases_dev": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dashboard_reporting_test_cases_dev", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "business_rules/dashboard_reporting_test_cases_dev.sql", "original_file_path": "tests/business_rules/dashboard_reporting_test_cases_dev.sql", "unique_id": "test.CGOncology_MDM.dashboard_reporting_test_cases_dev", "fqn": ["CGOncology_MDM", "business_rules", "dashboard_reporting_test_cases_dev"], "alias": "dashboard_reporting_test_cases_dev", "checksum": {"name": "sha256", "checksum": "23118268b1f7668508b77a92867b42ec48e2499a6b54e6eff29e005fabe0da4c"}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.199098, "relation_name": null, "raw_code": "/*\nHQ Dashboard Reporting - DEV-only Validation Tests\n\nPurpose:\n- Validate DEV reporting outputs created by `Manual Process/HQ_Dashboard_Dev.sql`\n- NO cross-environment reconciliation (DEV vs TEST). DEV-only QC.\n\nOutput format:\n- 3 columns: rule_id, failures, message\n  (aligned with existing business rule test conventions)\n*/\n\nWITH\n-- --------------------------------------------------------------------------\n-- Config: expected reporting tables in DEV\n-- --------------------------------------------------------------------------\nexpected_tables AS (\n    SELECT column1 AS table_name\n    FROM VALUES\n        ('CLINICAL_TRIAL_DATA'),\n        ('HCP_VIEW_DETAIL_TABLE'),\n        ('HCP_VIEW_DECILE_INFO'),\n        ('HCP_360'),\n        ('DDD_SALES_BY_ACCOUNTS'),\n        ('HCO_DETAILS_V2'),\n        ('SUMMARY_HCO')\n),\n\ndev_tables AS (\n    SELECT table_name\n    FROM CGONCOLOGY_DEV.INFORMATION_SCHEMA.TABLES\n    WHERE table_schema = 'REPORTING'\n),\n\nmissing_tables AS (\n    SELECT e.table_name\n    FROM expected_tables e\n    LEFT JOIN dev_tables d USING (table_name)\n    WHERE d.table_name IS NULL\n),\n\n-- --------------------------------------------------------------------------\n-- Helper CTEs for tests\n-- --------------------------------------------------------------------------\nhcp_detail_counts AS (\n    SELECT\n        \"NPI ID\" AS npi_id,\n        COUNT(*) AS row_cnt\n    FROM CGONCOLOGY_DEV.REPORTING.HCP_VIEW_DETAIL_TABLE\n    GROUP BY 1\n),\n\nhcp_detail_dupes AS (\n    SELECT\n        \"NPI ID\" AS npi_id,\n        TIME_PERIOD,\n        COUNT(*) AS row_cnt\n    FROM CGONCOLOGY_DEV.REPORTING.HCP_VIEW_DETAIL_TABLE\n    GROUP BY 1,2\n    HAVING COUNT(*) > 1\n),\n\nhcp_decile_dupes AS (\n    SELECT\n        \"NPI ID\" AS npi_id,\n        COUNT(*) AS row_cnt\n    FROM CGONCOLOGY_DEV.REPORTING.HCP_VIEW_DECILE_INFO\n    GROUP BY 1\n    HAVING COUNT(*) > 1\n),\n\nhcp_360_dupes AS (\n    SELECT\n        \"NPI ID\" AS npi_id,\n        TIME_PERIOD,\n        PAYOR_TYPE,\n        COUNT(*) AS row_cnt\n    FROM CGONCOLOGY_DEV.REPORTING.HCP_360\n    GROUP BY 1,2,3\n    HAVING COUNT(*) > 1\n),\n\nddd_sales_dupes AS (\n    SELECT\n        MONTH_ID,\n        ACCOUNT_TYPE,\n        COUNT(*) AS row_cnt\n    FROM CGONCOLOGY_DEV.REPORTING.DDD_SALES_BY_ACCOUNTS\n    GROUP BY 1,2\n    HAVING COUNT(*) > 1\n),\n\nhco_details_bad_counts AS (\n    SELECT\n        account_id,\n        COUNT(DISTINCT TIME_PERIOD) AS period_cnt\n    FROM CGONCOLOGY_DEV.REPORTING.HCO_DETAILS_V2\n    GROUP BY 1\n    HAVING COUNT(DISTINCT TIME_PERIOD) != 2\n),\n\nhco_details_dupes AS (\n    SELECT\n        account_id,\n        TIME_PERIOD,\n        COUNT(*) AS row_cnt\n    FROM CGONCOLOGY_DEV.REPORTING.HCO_DETAILS_V2\n    GROUP BY 1,2\n    HAVING COUNT(*) > 1\n),\n\nsummary_hco_dupes AS (\n    SELECT\n        ENTITY_LEVEL,\n        ACCOUNT_TYPE,\n        TREATMENT_NAME,\n        TARGET,\n        TERRITORY,\n        REGION,\n        TIME_PERIOD,\n        METRIC_TYPE,\n        COUNT(*) AS row_cnt\n    FROM CGONCOLOGY_DEV.REPORTING.SUMMARY_HCO\n    GROUP BY 1,2,3,4,5,6,7,8\n    HAVING COUNT(*) > 1\n)\n\n-- --------------------------------------------------------------------------\n-- Tests (DEV-only)\n-- --------------------------------------------------------------------------\nSELECT\n    'DASH-DEV-001' AS rule_id,\n    (SELECT COUNT(*) FROM missing_tables) AS failures,\n    CASE\n        WHEN (SELECT COUNT(*) FROM missing_tables) = 0 THEN 'PASS: all expected DEV REPORTING tables exist'\n        ELSE 'FAIL: missing DEV REPORTING tables: ' ||\n             (SELECT LISTAGG(table_name, ', ') WITHIN GROUP (ORDER BY table_name) FROM missing_tables)\n    END AS message\n\nUNION ALL\n\nSELECT\n    'DASH-DEV-002' AS rule_id,\n    (SELECT COUNT(*) FROM hcp_detail_counts WHERE row_cnt != 2) AS failures,\n    CASE\n        WHEN (SELECT COUNT(*) FROM hcp_detail_counts WHERE row_cnt != 2) = 0 THEN 'PASS: each HCP has exactly 2 rows in HCP_VIEW_DETAIL_TABLE (18 Months, Total)'\n        ELSE 'FAIL: HCPs with row_cnt != 2 in HCP_VIEW_DETAIL_TABLE. Sample NPI(s): ' ||\n             COALESCE((\n                 SELECT LISTAGG(npi_id, ', ') WITHIN GROUP (ORDER BY npi_id)\n                 FROM (SELECT npi_id FROM hcp_detail_counts WHERE row_cnt != 2 ORDER BY row_cnt DESC, npi_id LIMIT 20)\n             ), 'N/A')\n    END AS message\n\nUNION ALL\n\nSELECT\n    'DASH-DEV-003' AS rule_id,\n    (SELECT COUNT(*) FROM hcp_detail_dupes) AS failures,\n    CASE\n        WHEN (SELECT COUNT(*) FROM hcp_detail_dupes) = 0 THEN 'PASS: no duplicate (NPI ID, TIME_PERIOD) rows in HCP_VIEW_DETAIL_TABLE'\n        ELSE 'FAIL: duplicate (NPI ID, TIME_PERIOD) rows in HCP_VIEW_DETAIL_TABLE. Sample: ' ||\n             COALESCE((\n                 SELECT LISTAGG(npi_id || '|' || TIME_PERIOD, ', ') WITHIN GROUP (ORDER BY npi_id, TIME_PERIOD)\n                 FROM (SELECT npi_id, TIME_PERIOD FROM hcp_detail_dupes ORDER BY row_cnt DESC, npi_id, TIME_PERIOD LIMIT 20)\n             ), 'N/A')\n    END AS message\n\nUNION ALL\n\nSELECT\n    'DASH-DEV-004' AS rule_id,\n    (SELECT COUNT(*) FROM CGONCOLOGY_DEV.REPORTING.HCP_VIEW_DETAIL_TABLE WHERE \"NPI ID\" = '1104425545') AS failures,\n    CASE\n        WHEN (SELECT COUNT(*) FROM CGONCOLOGY_DEV.REPORTING.HCP_VIEW_DETAIL_TABLE WHERE \"NPI ID\" = '1104425545') = 0 THEN 'PASS: excluded NPI 1104425545 not present in HCP_VIEW_DETAIL_TABLE'\n        ELSE 'FAIL: excluded NPI 1104425545 present in HCP_VIEW_DETAIL_TABLE'\n    END AS message\n\nUNION ALL\n\nSELECT\n    'DASH-DEV-005' AS rule_id,\n    (SELECT COUNT(*) FROM hcp_decile_dupes) AS failures,\n    CASE\n        WHEN (SELECT COUNT(*) FROM hcp_decile_dupes) = 0 THEN 'PASS: HCP_VIEW_DECILE_INFO has unique \"NPI ID\"'\n        ELSE 'FAIL: duplicate \"NPI ID\" in HCP_VIEW_DECILE_INFO. Sample: ' ||\n             COALESCE((\n                 SELECT LISTAGG(npi_id, ', ') WITHIN GROUP (ORDER BY npi_id)\n                 FROM (SELECT npi_id FROM hcp_decile_dupes ORDER BY row_cnt DESC, npi_id LIMIT 20)\n             ), 'N/A')\n    END AS message\n\nUNION ALL\n\nSELECT\n    'DASH-DEV-006' AS rule_id,\n    ABS(\n        (SELECT COUNT(DISTINCT \"NPI ID\") FROM CGONCOLOGY_DEV.REPORTING.HCP_VIEW_DETAIL_TABLE) -\n        (SELECT COUNT(DISTINCT \"NPI ID\") FROM CGONCOLOGY_DEV.REPORTING.HCP_VIEW_DECILE_INFO)\n    ) AS failures,\n    CASE\n        WHEN (\n            (SELECT COUNT(DISTINCT \"NPI ID\") FROM CGONCOLOGY_DEV.REPORTING.HCP_VIEW_DETAIL_TABLE) =\n            (SELECT COUNT(DISTINCT \"NPI ID\") FROM CGONCOLOGY_DEV.REPORTING.HCP_VIEW_DECILE_INFO)\n        ) THEN 'PASS: HCP_VIEW_DECILE_INFO HCP count matches HCP_VIEW_DETAIL_TABLE'\n        ELSE 'FAIL: HCP count mismatch between HCP_VIEW_DETAIL_TABLE and HCP_VIEW_DECILE_INFO'\n    END AS message\n\nUNION ALL\n\nSELECT\n    'DASH-DEV-007' AS rule_id,\n    (SELECT COUNT(*) FROM hcp_360_dupes) AS failures,\n    CASE\n        WHEN (SELECT COUNT(*) FROM hcp_360_dupes) = 0 THEN 'PASS: no duplicate (NPI ID, TIME_PERIOD, PAYOR_TYPE) rows in HCP_360'\n        ELSE 'FAIL: duplicate (NPI ID, TIME_PERIOD, PAYOR_TYPE) rows in HCP_360. Sample: ' ||\n             COALESCE((\n                 SELECT LISTAGG(npi_id || '|' || TIME_PERIOD || '|' || PAYOR_TYPE, ', ') WITHIN GROUP (ORDER BY npi_id, TIME_PERIOD, PAYOR_TYPE)\n                 FROM (SELECT npi_id, TIME_PERIOD, PAYOR_TYPE FROM hcp_360_dupes ORDER BY row_cnt DESC, npi_id LIMIT 20)\n             ), 'N/A')\n    END AS message\n\nUNION ALL\n\nSELECT\n    'DASH-DEV-008' AS rule_id,\n    (SELECT COUNT(*) FROM CGONCOLOGY_DEV.REPORTING.DDD_SALES_BY_ACCOUNTS WHERE MONTH_ID < 1 OR MONTH_ID > 24) AS failures,\n    CASE\n        WHEN (SELECT COUNT(*) FROM CGONCOLOGY_DEV.REPORTING.DDD_SALES_BY_ACCOUNTS WHERE MONTH_ID < 1 OR MONTH_ID > 24) = 0 THEN 'PASS: DDD_SALES_BY_ACCOUNTS month_id is within 1-24'\n        ELSE 'FAIL: DDD_SALES_BY_ACCOUNTS has MONTH_ID outside 1-24'\n    END AS message\n\nUNION ALL\n\nSELECT\n    'DASH-DEV-009' AS rule_id,\n    (SELECT COUNT(*) FROM ddd_sales_dupes) AS failures,\n    CASE\n        WHEN (SELECT COUNT(*) FROM ddd_sales_dupes) = 0 THEN 'PASS: no duplicate (MONTH_ID, ACCOUNT_TYPE) rows in DDD_SALES_BY_ACCOUNTS'\n        ELSE 'FAIL: duplicate (MONTH_ID, ACCOUNT_TYPE) rows in DDD_SALES_BY_ACCOUNTS. Sample: ' ||\n             COALESCE((\n                 SELECT LISTAGG(MONTH_ID || '|' || ACCOUNT_TYPE, ', ') WITHIN GROUP (ORDER BY MONTH_ID, ACCOUNT_TYPE)\n                 FROM (SELECT MONTH_ID, ACCOUNT_TYPE FROM ddd_sales_dupes ORDER BY row_cnt DESC, MONTH_ID, ACCOUNT_TYPE LIMIT 20)\n             ), 'N/A')\n    END AS message\n\nUNION ALL\n\nSELECT\n    'DASH-DEV-010' AS rule_id,\n    (SELECT COUNT(*) FROM hco_details_bad_counts) + (SELECT COUNT(*) FROM hco_details_dupes) AS failures,\n    CASE\n        WHEN ((SELECT COUNT(*) FROM hco_details_bad_counts) = 0 AND (SELECT COUNT(*) FROM hco_details_dupes) = 0)\n            THEN 'PASS: HCO_DETAILS_V2 has exactly 2 time periods per account_id and no duplicate (account_id, TIME_PERIOD)'\n        ELSE 'FAIL: HCO_DETAILS_V2 issues. bad_period_cnt_accounts=' || (SELECT COUNT(*) FROM hco_details_bad_counts) ||\n             ', duplicate_account_period=' || (SELECT COUNT(*) FROM hco_details_dupes)\n    END AS message\n\nUNION ALL\n\nSELECT\n    'DASH-DEV-011' AS rule_id,\n    (SELECT COUNT(*) FROM summary_hco_dupes) AS failures,\n    CASE\n        WHEN (SELECT COUNT(*) FROM summary_hco_dupes) = 0 THEN 'PASS: SUMMARY_HCO has no duplicate dimension rows'\n        ELSE 'FAIL: SUMMARY_HCO duplicate dimension rows. Sample: ' ||\n             COALESCE((\n                 SELECT LISTAGG(ENTITY_LEVEL || '|' || ACCOUNT_TYPE || '|' || TREATMENT_NAME || '|' || TARGET || '|' || TERRITORY || '|' || REGION || '|' || TIME_PERIOD || '|' || METRIC_TYPE, ', ')\n                        WITHIN GROUP (ORDER BY ENTITY_LEVEL, ACCOUNT_TYPE, TREATMENT_NAME, TARGET, TERRITORY, REGION, TIME_PERIOD, METRIC_TYPE)\n                 FROM (\n                     SELECT ENTITY_LEVEL, ACCOUNT_TYPE, TREATMENT_NAME, TARGET, TERRITORY, REGION, TIME_PERIOD, METRIC_TYPE\n                     FROM summary_hco_dupes\n                     ORDER BY row_cnt DESC\n                     LIMIT 10\n                 )\n             ), 'N/A')\n    END AS message\n;", "doc_blocks": [], "language": "sql", "refs": [], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}}, "test.CGOncology_MDM.val_path2_skip_validation": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "val_path2_skip_validation", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "business_rules/val_path2_skip_validation.sql", "original_file_path": "tests/business_rules/val_path2_skip_validation.sql", "unique_id": "test.CGOncology_MDM.val_path2_skip_validation", "fqn": ["CGOncology_MDM", "business_rules", "val_path2_skip_validation"], "alias": "val_path2_skip_validation", "checksum": {"name": "sha256", "checksum": "a1bd767be5581ab005d5901bbb1141368d4217f23c98f3f48819b2eed399f78c"}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.200208, "relation_name": null, "raw_code": "/*\nValidation: Can Path 2 (Rendering NPI \u2192 HCO) be skipped for HCO-filed claims?\n\nPurpose: Count how many claim rows are attributed via Path 2 only (would lose\nattribution if Path 2 is removed) vs Path 2 with billing (would keep attribution\nvia billing NPI, possibly different HCO).\n\nRun: Use the compiled analysis (refs resolved): dbt compile, then execute\ntarget/compiled/CGOncology_MDM/analyses/val_path2_skip_validation.sql in Snowflake.\nSame logic in analyses/val_path2_skip_validation.sql.\n\nOutput columns:\n- path2_only_rows: Rows that would become UNATTRIBUTED if Path 2 is skipped\n  (render_hco_id NOT NULL, billing_hco_id NULL, non-Federal, not HCP)\n- path2_with_billing_rows: Rows that would KEEP attribution via billing if Path 2 skipped\n  (render_hco_id NOT NULL, billing_hco_id NOT NULL)\n- path2_with_billing_same_hco: Of path2_with_billing, same HCO (no volume move)\n- path2_with_billing_different_hco: Of path2_with_billing, different HCO (volume would move)\n- path2_total_rows: path2_only + path2_with_billing\n*/\n\nWITH bc_patient_pool AS (\n    SELECT PATIENT_ID FROM {{ ref('stg_bc_patient_pool') }}\n),\n\nall_claims AS (\n    SELECT\n        PX_CLAIM_ID AS claim_id, 'PX' AS claim_type, PATIENT_ID, SERVICE_DATE AS service_date,\n        SERVICE_YEAR, SERVICE_MONTH, COALESCE(REPLACE(TREATMENT_CATEGORY, ' ', '_'), 'OTHER_PX') AS metric_category,\n        PROVIDER_RENDERING_NPI, PROVIDER_BILLING_NPI,\n        PATIENT_PRIMARY_PAYOR_TYPE AS payor_type, PATIENT_PRIMARY_PAYOR_NAME AS payor_name, PATIENT_PRIMARY_PAYOR_DH_ID AS payor_dh_id\n    FROM {{ ref('std_px_claims') }}\n    WHERE SERVICE_DATE IS NOT NULL AND TREATMENT_CATEGORY IS NOT NULL\n    GROUP BY 1,2,3,4,5,6,7,8,9,10,11,12\n    UNION ALL\n    SELECT\n        MX_CLAIM_ID, 'DX', PATIENT_ID, SERVICE_DATE, SERVICE_YEAR, SERVICE_MONTH,\n        COALESCE(REPLACE(TREATMENT_CATEGORY, ' ', '_'), 'OTHER_DX'), PROVIDER_RENDERING_NPI, PROVIDER_BILLING_NPI,\n        PATIENT_PRIMARY_PAYOR_TYPE, PATIENT_PRIMARY_PAYOR_NAME, PATIENT_PRIMARY_PAYOR_DH_ID\n    FROM {{ ref('std_dx_claims') }}\n    WHERE SERVICE_DATE IS NOT NULL AND TREATMENT_CATEGORY IS NOT NULL\n    GROUP BY 1,2,3,4,5,6,7,8,9,10,11,12\n    UNION ALL\n    SELECT\n        RX_CLAIM_ID, 'RX', PATIENT_ID, FILL_DATE, FILL_YEAR, FILL_MONTH,\n        COALESCE(REPLACE(TREATMENT_CATEGORY, ' ', '_'), 'OTHER_RX'), PROVIDER_PRESCRIBING_NPI, NULL,\n        PATIENT_PRIMARY_PAYOR_TYPE, PATIENT_PRIMARY_PAYOR_NAME, PATIENT_PRIMARY_PAYOR_DH_ID\n    FROM {{ ref('std_rx_claims') }}\n    WHERE FILL_DATE IS NOT NULL AND TREATMENT_CATEGORY IS NOT NULL\n    GROUP BY 1,2,3,4,5,6,7,8,9,10,11,12\n),\n\nclaims_filtered AS (\n    SELECT c.* FROM all_claims c\n    INNER JOIN bc_patient_pool pool ON c.PATIENT_ID = pool.PATIENT_ID\n),\n\nhco_by_npi AS (\n    SELECT\n        hco.npi,\n        hco.KMK_HCO_ID,\n        abi.account_type,\n        hco.firm_type,\n        CASE\n            WHEN h.kmk_hco_id = h.account_id_l4 THEN 4\n            WHEN h.kmk_hco_id = h.account_id_l3 THEN 3\n            WHEN h.kmk_hco_id = h.account_id_l2 THEN 2\n            WHEN h.kmk_hco_id = h.account_id_l1 THEN 1\n            ELSE 0\n        END AS hco_level\n    FROM {{ ref('mdm_customer_master_hco') }} hco\n    LEFT JOIN {{ ref('adm_hco_hierarchy') }} h ON hco.KMK_HCO_ID = h.kmk_hco_id\n    LEFT JOIN {{ ref('account_type_business_input') }} abi ON CAST(hco.dh_id AS VARCHAR) = abi.dh_id\n    WHERE hco.npi IS NOT NULL\n      AND (hco.firm_type IS NULL OR hco.firm_type != 'Practice Location')\n    QUALIFY ROW_NUMBER() OVER (\n        PARTITION BY hco.npi\n        ORDER BY\n            hco_level DESC,\n            CASE WHEN hco.firm_type = 'Physician Group' THEN 1 WHEN hco.firm_type = 'Hospital' THEN 2 ELSE 3 END,\n            hco.KMK_HCO_ID\n    ) = 1\n),\n\nclaims_enriched AS (\n    SELECT\n        c.claim_id,\n        c.claim_type,\n        c.PATIENT_ID,\n        c.metric_category,\n        c.PROVIDER_RENDERING_NPI,\n        c.PROVIDER_BILLING_NPI,\n        hcp.KMK_HCP_ID,\n        CASE WHEN ba_hco.KMK_HCO_ID IS NOT NULL THEN ba.BEST_KMK_HCO_ID ELSE NULL END AS hcp_aff_hco_id,\n        hco_render.KMK_HCO_ID AS render_hco_id,\n        hco_billing.KMK_HCO_ID AS billing_hco_id,\n        CASE WHEN hco_billing.account_type ILIKE '%FEDERAL%' THEN 'Y' ELSE 'N' END AS is_federal\n    FROM claims_filtered c\n    LEFT JOIN {{ ref('mdm_customer_master_hcp') }} hcp ON c.PROVIDER_RENDERING_NPI = hcp.npi\n    LEFT JOIN {{ ref('mdm_best_affiliation_hist') }} ba ON hcp.KMK_HCP_ID = ba.KMK_HCP_ID AND ba.is_current = 'Y'\n    LEFT JOIN {{ ref('mdm_customer_master_hco') }} ba_hco ON ba.BEST_KMK_HCO_ID = ba_hco.KMK_HCO_ID\n    LEFT JOIN hco_by_npi hco_render ON c.PROVIDER_RENDERING_NPI = hco_render.npi\n    LEFT JOIN hco_by_npi hco_billing ON c.PROVIDER_BILLING_NPI = hco_billing.npi\n),\n\npath2_metrics AS (\n    SELECT\n        SUM(CASE WHEN is_federal = 'N' AND KMK_HCP_ID IS NULL AND render_hco_id IS NOT NULL AND billing_hco_id IS NULL THEN 1 ELSE 0 END) AS path2_only_rows,\n        SUM(CASE WHEN is_federal = 'N' AND KMK_HCP_ID IS NULL AND render_hco_id IS NOT NULL AND billing_hco_id IS NOT NULL THEN 1 ELSE 0 END) AS path2_with_billing_rows,\n        SUM(CASE WHEN is_federal = 'N' AND KMK_HCP_ID IS NULL AND render_hco_id IS NOT NULL AND billing_hco_id IS NOT NULL AND render_hco_id = billing_hco_id THEN 1 ELSE 0 END) AS path2_with_billing_same_hco,\n        SUM(CASE WHEN is_federal = 'N' AND KMK_HCP_ID IS NULL AND render_hco_id IS NOT NULL AND billing_hco_id IS NOT NULL AND render_hco_id != billing_hco_id THEN 1 ELSE 0 END) AS path2_with_billing_different_hco\n    FROM claims_enriched\n)\n\nSELECT\n    path2_only_rows,\n    path2_with_billing_rows,\n    path2_with_billing_same_hco,\n    path2_with_billing_different_hco,\n    path2_only_rows + path2_with_billing_rows AS path2_total_rows,\n    CASE\n        WHEN path2_only_rows = 0 THEN 'Path 2 can be skipped: no rows would lose attribution.'\n        ELSE 'Path 2 cannot be skipped: ' || path2_only_rows || ' rows would lose HCO attribution.'\n    END AS recommendation\nFROM path2_metrics;", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_bc_patient_pool", "package": null, "version": null}, {"name": "std_px_claims", "package": null, "version": null}, {"name": "std_dx_claims", "package": null, "version": null}, {"name": "std_rx_claims", "package": null, "version": null}, {"name": "mdm_customer_master_hco", "package": null, "version": null}, {"name": "adm_hco_hierarchy", "package": null, "version": null}, {"name": "account_type_business_input", "package": null, "version": null}, {"name": "mdm_customer_master_hcp", "package": null, "version": null}, {"name": "mdm_best_affiliation_hist", "package": null, "version": null}, {"name": "mdm_customer_master_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.stg_bc_patient_pool", "model.CGOncology_MDM.std_px_claims", "model.CGOncology_MDM.std_dx_claims", "model.CGOncology_MDM.std_rx_claims", "model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.adm_hco_hierarchy", "seed.CGOncology_MDM.account_type_business_input", "model.CGOncology_MDM.mdm_customer_master_hcp", "model.CGOncology_MDM.mdm_best_affiliation_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}}, "test.CGOncology_MDM.val_cb_030_new_code_detection": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "val_cb_030_new_code_detection", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "business_rules/val_cb_030_new_code_detection.sql", "original_file_path": "tests/business_rules/val_cb_030_new_code_detection.sql", "unique_id": "test.CGOncology_MDM.val_cb_030_new_code_detection", "fqn": ["CGOncology_MDM", "business_rules", "val_cb_030_new_code_detection"], "alias": "val_cb_030_new_code_detection", "checksum": {"name": "sha256", "checksum": "9e95060ef4ced6aa65e35054d9322db25cf1d871c101513df06caabad38f10a5"}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.202656, "relation_name": null, "raw_code": "/*\nVAL-CB-030: Detect New Potential BC Codes in Recent Data\nMonitors for new codes that appear frequently in recent data (2024+)\nHelps identify emerging treatments or coding changes\n*/\n\nWITH recent_dx_codes AS (\n    SELECT\n        DIAGNOSIS_CODE,\n        COUNT(DISTINCT PATIENT_ID) AS patient_count,\n        COUNT(*) AS claim_count,\n        MIN(SERVICE_DATE) AS first_seen_date,\n        MAX(SERVICE_DATE) AS last_seen_date,\n        SUM(CASE WHEN SERVICE_DATE >= '2024-01-01' THEN 1 ELSE 0 END) AS recent_claims\n    FROM {{ ref('std_dx_claims') }}\n    WHERE SERVICE_YEAR >= YEAR(CURRENT_DATE) - 1  -- Last year\n      AND (DIAGNOSIS_CODE LIKE 'C%'   -- Cancer codes\n           OR DIAGNOSIS_CODE LIKE 'D%' -- Neoplasm codes\n           OR DIAGNOSIS_CODE LIKE 'Z%') -- History codes\n    GROUP BY DIAGNOSIS_CODE\n    HAVING COUNT(DISTINCT PATIENT_ID) >= 10  -- Threshold: 10+ patients\n       AND SUM(CASE WHEN SERVICE_DATE >= '2024-01-01' THEN 1 ELSE 0 END) > 0\n),\n\nrecent_px_codes AS (\n    SELECT\n        PROCEDURE_CODE,\n        COUNT(DISTINCT PATIENT_ID) AS patient_count,\n        COUNT(*) AS claim_count,\n        MIN(SERVICE_DATE) AS first_seen_date,\n        MAX(SERVICE_DATE) AS last_seen_date,\n        SUM(CASE WHEN SERVICE_DATE >= '2024-01-01' THEN 1 ELSE 0 END) AS recent_claims\n    FROM {{ ref('std_px_claims') }}\n    WHERE SERVICE_YEAR >= YEAR(CURRENT_DATE) - 1\n      AND (PROCEDURE_CODE LIKE '52%'   -- Cystoscopy/TURBT codes\n           OR PROCEDURE_CODE LIKE 'J9%'  -- Drug administration codes\n           OR PROCEDURE_CODE LIKE '51%') -- Bladder procedure codes\n    GROUP BY PROCEDURE_CODE\n    HAVING COUNT(DISTINCT PATIENT_ID) >= 10\n       AND SUM(CASE WHEN SERVICE_DATE >= '2024-01-01' THEN 1 ELSE 0 END) > 0\n),\n\nknown_dx_codes AS (\n    SELECT DIAGNOSIS_CODE FROM {{ ref('seed_bc_dx_code_mapping') }}\n),\n\nknown_px_codes AS (\n    SELECT PROCEDURE_CODE FROM {{ ref('seed_bc_px_code_mapping') }}\n),\n\nnew_dx_codes AS (\n    SELECT\n        'DX' AS claim_type,\n        recent.DIAGNOSIS_CODE AS potential_new_code,\n        recent.patient_count,\n        recent.claim_count,\n        recent.recent_claims,\n        recent.first_seen_date,\n        recent.last_seen_date,\n        'Review for potential BC diagnosis code' AS recommendation\n    FROM recent_dx_codes recent\n    LEFT JOIN known_dx_codes known\n        ON recent.DIAGNOSIS_CODE = known.DIAGNOSIS_CODE\n    WHERE known.DIAGNOSIS_CODE IS NULL\n),\n\nnew_px_codes AS (\n    SELECT\n        'PX' AS claim_type,\n        recent.PROCEDURE_CODE AS potential_new_code,\n        recent.patient_count,\n        recent.claim_count,\n        recent.recent_claims,\n        recent.first_seen_date,\n        recent.last_seen_date,\n        'Review for potential BC procedure code' AS recommendation\n    FROM recent_px_codes recent\n    LEFT JOIN known_px_codes known\n        ON recent.PROCEDURE_CODE = known.PROCEDURE_CODE\n    WHERE known.PROCEDURE_CODE IS NULL\n)\n\nSELECT * FROM new_dx_codes\nUNION ALL\nSELECT * FROM new_px_codes\nORDER BY patient_count DESC", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dx_claims", "package": null, "version": null}, {"name": "std_px_claims", "package": null, "version": null}, {"name": "seed_bc_dx_code_mapping", "package": null, "version": null}, {"name": "seed_bc_px_code_mapping", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": ["model.CGOncology_MDM.std_dx_claims", "model.CGOncology_MDM.std_px_claims", "seed.CGOncology_MDM.seed_bc_dx_code_mapping", "seed.CGOncology_MDM.seed_bc_px_code_mapping"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}}, "test.CGOncology_MDM.val_apt_data_validation": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "val_apt_data_validation", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "business_rules/val_apt_data_validation.sql", "original_file_path": "tests/business_rules/val_apt_data_validation.sql", "unique_id": "test.CGOncology_MDM.val_apt_data_validation", "fqn": ["CGOncology_MDM", "business_rules", "val_apt_data_validation"], "alias": "val_apt_data_validation", "checksum": {"name": "sha256", "checksum": "19210b6cadb557a1e462da7895e9dfcb7ad1340f32d6e3f503d33e8cf1b8dfde"}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.2044249, "relation_name": null, "raw_code": "/*\nAPT Data Validation - Comprehensive Test Suite\nRun context: dbt singular test against {{ target.database }}.APT\n\nTest Categories:\n- DV_0XX: Row count and basic existence checks\n- DV_036: DDD-only accounts (no DHC match) excluded from LoV checks (LOV_001/002/003); known limitation.\n- DV_144: display_abr check applies only to KAM/HSD targets; MSL targets are intentionally excluded.\n- PK_0XX: Primary key uniqueness checks\n- CK_0XX: Composite key uniqueness checks\n- FK_0XX: Foreign key referential integrity checks\n- LOV_0XX: List of Values (LoV) validation checks\n\nNote: APT models are disabled in dbt_project.yml, so we use direct table references.\ndbt singular test: returns only failure rows (failures > 0) so test passes when 0 rows.\n*/\n\nWITH validation_results AS (\n\n-- ============================================================================\n-- SECTION 1: ROW COUNT AND EXISTENCE CHECKS (DV_0XX)\n-- ============================================================================\n\n-- DV_001: Row count ACCOUNTS (informational; failures=0 if > 0)\nSELECT\n    'DV_001' AS rule_id,\n    CASE WHEN COUNT(*) = 0 THEN 1 ELSE 0 END AS failures,\n    'APT.ACCOUNTS row count ' || COUNT(*)::VARCHAR AS message\nFROM {{ target.database }}.APT.ACCOUNTS\n\nUNION ALL\n\n-- DV_002: Row count HCPS\nSELECT\n    'DV_002' AS rule_id,\n    CASE WHEN COUNT(*) = 0 THEN 1 ELSE 0 END AS failures,\n    'APT.HCPS row count ' || COUNT(*)::VARCHAR AS message\nFROM {{ target.database }}.APT.HCPS\n\nUNION ALL\n\n-- DV_003: Row count EXECUTIVES\nSELECT\n    'DV_003' AS rule_id,\n    CASE WHEN COUNT(*) = 0 THEN 1 ELSE 0 END AS failures,\n    'APT.EXECUTIVES row count ' || COUNT(*)::VARCHAR AS message\nFROM {{ target.database }}.APT.EXECUTIVES\n\nUNION ALL\n\n-- DV_004: Row count TARGETS\nSELECT\n    'DV_004' AS rule_id,\n    CASE WHEN COUNT(*) = 0 THEN 1 ELSE 0 END AS failures,\n    'APT.TARGETS row count ' || COUNT(*)::VARCHAR AS message\nFROM {{ target.database }}.APT.TARGETS\n\nUNION ALL\n\n-- DV_005: Metric population check - at least one account has a metric populated\nSELECT\n    'DV_005' AS rule_id,\n    CASE WHEN (SELECT COUNT(*) FROM {{ target.database }}.APT.ACCOUNTS WHERE TURBT_Claims IS NOT NULL OR DDD_Tice_BCG_Sales IS NOT NULL OR Urologists_Total_nmb IS NOT NULL) > 0 THEN 0 ELSE 1 END AS failures,\n    'Accounts with at least one metric populated' AS message\nFROM (SELECT 1) _one\n\nUNION ALL\n\n-- DV_007: L4 Practice Location hierarchy - child must have parent_id (no orphans)\nSELECT\n    'DV_007' AS rule_id,\n    (SELECT COUNT(*) FROM {{ target.database }}.APT.ACCOUNTS WHERE account_level = 'L4_PRACTICE_LOCATION' AND parent_id IS NULL) AS failures,\n    'L4_PRACTICE_LOCATION with null parent_id' AS message\nFROM (SELECT 1) _one\n\nUNION ALL\n\n-- DV_008: Account 3000056040 address fix (optional data fix check)\nSELECT\n    'DV_008' AS rule_id,\n    COALESCE((\n        SELECT CASE\n            WHEN COUNT(*) = 0 THEN 0\n            WHEN MAX(CASE WHEN address1 LIKE '%600%' AND zip = '92868' THEN 1 ELSE 0 END) = 1 THEN 0\n            ELSE 1\n        END\n        FROM {{ target.database }}.APT.ACCOUNTS\n        WHERE account_id = '3000056040'\n    ), 0) AS failures,\n    'Account 3000056040 address check (600 City Pkwy W, 92868)' AS message\nFROM (SELECT 1) _one\n\nUNION ALL\n\n-- DV_009: NPI 1225058597 first_name fix (legacy RAFIK fix)\nSELECT\n    'DV_009' AS rule_id,\n    COALESCE((\n        SELECT CASE WHEN first_name ILIKE '%RAFIK%' THEN 0 ELSE 1 END\n        FROM {{ target.database }}.APT.HCPS\n        WHERE npi = 1225058597\n        LIMIT 1\n    ), 0) AS failures,\n    'NPI 1225058597 first_name check (expected RAFIK)' AS message\nFROM (SELECT 1) _one\n\nUNION ALL\n\n-- DV_144: KAM and HSD targets (not MSL) should have Display_ABR = 'Y'\n-- MSL-only targets are intentionally excluded from display_abr (abbreviated view).\nSELECT\n    'DV_144' AS rule_id,\n    (SELECT COUNT(*) FROM {{ target.database }}.APT.TARGETS t\n     INNER JOIN {{ target.database }}.APT.ACCOUNTS a ON a.account_id = t.account_id\n     WHERE t.team_code IN ('TEAM_KAM', 'TEAM_HSD')\n       AND COALESCE(a.Display_ABR, 'N') <> 'Y') AS failures,\n    'KAM/HSD targets with Display_ABR <> Y (MSL excluded)' AS message\nFROM (SELECT 1) _one\n\nUNION ALL\n\n-- ============================================================================\n-- SECTION 2: PRIMARY KEY UNIQUENESS CHECKS (PK_0XX)\n-- ============================================================================\n\n-- PK_001: ACCOUNTS.ACCOUNT_ID must be unique\nSELECT\n    'PK_001' AS rule_id,\n    COUNT(*) - COUNT(DISTINCT account_id) AS failures,\n    'ACCOUNTS.ACCOUNT_ID duplicate count' AS message\nFROM {{ target.database }}.APT.ACCOUNTS\n\nUNION ALL\n\n-- PK_002: HCPS.HCP_ID must be unique\nSELECT\n    'PK_002' AS rule_id,\n    COUNT(*) - COUNT(DISTINCT hcp_id) AS failures,\n    'HCPS.HCP_ID duplicate count' AS message\nFROM {{ target.database }}.APT.HCPS\n\nUNION ALL\n\n-- PK_003: EXECUTIVES.EXECUTIVE_ID must be unique\nSELECT\n    'PK_003' AS rule_id,\n    COUNT(*) - COUNT(DISTINCT executive_id) AS failures,\n    'EXECUTIVES.EXECUTIVE_ID duplicate count' AS message\nFROM {{ target.database }}.APT.EXECUTIVES\n\nUNION ALL\n\n-- PK_004: GEOGRAPHIES.GEO_CODE must be unique\nSELECT\n    'PK_004' AS rule_id,\n    COUNT(*) - COUNT(DISTINCT geo_code) AS failures,\n    'GEOGRAPHIES.GEO_CODE duplicate count' AS message\nFROM {{ target.database }}.APT.GEOGRAPHIES\n\nUNION ALL\n\n-- PK_005: STATES.CODE must be unique\nSELECT\n    'PK_005' AS rule_id,\n    COUNT(*) - COUNT(DISTINCT code) AS failures,\n    'STATES.CODE duplicate count' AS message\nFROM {{ target.database }}.APT.STATES\n\nUNION ALL\n\n-- PK_006: TEAMS.TEAM_CODE must be unique\nSELECT\n    'PK_006' AS rule_id,\n    COUNT(*) - COUNT(DISTINCT team_code) AS failures,\n    'TEAMS.TEAM_CODE duplicate count' AS message\nFROM {{ target.database }}.APT.TEAMS\n\nUNION ALL\n\n-- PK_007: PAYER_TYPES.CODE must be unique\nSELECT\n    'PK_007' AS rule_id,\n    COUNT(*) - COUNT(DISTINCT code) AS failures,\n    'PAYER_TYPES.CODE duplicate count' AS message\nFROM {{ target.database }}.APT.PAYER_TYPES\n\nUNION ALL\n\n-- PK_008: ACCOUNT_TYPES.CODE must be unique\nSELECT\n    'PK_008' AS rule_id,\n    COUNT(*) - COUNT(DISTINCT code) AS failures,\n    'ACCOUNT_TYPES.CODE duplicate count' AS message\nFROM {{ target.database }}.APT.ACCOUNT_TYPES\n\nUNION ALL\n\n-- PK_009: ACCOUNT_LEVELS.CODE must be unique\nSELECT\n    'PK_009' AS rule_id,\n    COUNT(*) - COUNT(DISTINCT code) AS failures,\n    'ACCOUNT_LEVELS.CODE duplicate count' AS message\nFROM {{ target.database }}.APT.ACCOUNT_LEVELS\n\nUNION ALL\n\n-- PK_010: METRIC_LIST.CODE must be unique\nSELECT\n    'PK_010' AS rule_id,\n    COUNT(*) - COUNT(DISTINCT code) AS failures,\n    'METRIC_LIST.CODE duplicate count' AS message\nFROM {{ target.database }}.APT.METRIC_LIST\n\nUNION ALL\n\n-- ============================================================================\n-- SECTION 3: COMPOSITE KEY UNIQUENESS CHECKS (CK_0XX)\n-- ============================================================================\n\n-- CK_001: TARGETS composite key (TEAM_CODE + ACCOUNT_ID) must be unique\nSELECT\n    'CK_001' AS rule_id,\n    COUNT(*) - COUNT(DISTINCT CONCAT(team_code, '|', account_id)) AS failures,\n    'TARGETS composite key (team_code, account_id) duplicate count' AS message\nFROM {{ target.database }}.APT.TARGETS\n\nUNION ALL\n\n-- CK_002: ACCOUNT_HCPS composite key (ACCOUNT_ID + HCP_ID) must be unique\nSELECT\n    'CK_002' AS rule_id,\n    COUNT(*) - COUNT(DISTINCT CONCAT(account_id, '|', hcp_id)) AS failures,\n    'ACCOUNT_HCPS composite key (account_id, hcp_id) duplicate count' AS message\nFROM {{ target.database }}.APT.ACCOUNT_HCPS\n\nUNION ALL\n\n-- CK_003: ACCOUNT_METRIC_VALUE composite key (ACCOUNT_ID + METRIC + X_VALUE) must be unique\nSELECT\n    'CK_003' AS rule_id,\n    COUNT(*) - COUNT(DISTINCT CONCAT(account_id, '|', metric, '|', x_value)) AS failures,\n    'ACCOUNT_METRIC_VALUE composite key (account_id, metric, x_value) duplicate count' AS message\nFROM {{ target.database }}.APT.ACCOUNT_METRIC_VALUE\n\nUNION ALL\n\n-- CK_004: GEO_METRIC_VALUE composite key (GEOGRAPHY_ID + METRIC + X_VALUE) must be unique\nSELECT\n    'CK_004' AS rule_id,\n    COUNT(*) - COUNT(DISTINCT CONCAT(geography_id, '|', metric, '|', x_value)) AS failures,\n    'GEO_METRIC_VALUE composite key (geography_id, metric, x_value) duplicate count' AS message\nFROM {{ target.database }}.APT.GEO_METRIC_VALUE\n\nUNION ALL\n\n-- CK_005: ACCOUNTS_GEO_AFFILIATION composite key (ACCOUNT_ID + GEO_CODE) must be unique\nSELECT\n    'CK_005' AS rule_id,\n    COUNT(*) - COUNT(DISTINCT CONCAT(account_id, '|', geo_code)) AS failures,\n    'ACCOUNTS_GEO_AFFILIATION composite key (account_id, geo_code) duplicate count' AS message\nFROM {{ target.database }}.APT.ACCOUNT_GEO_AFFILIATION\n\nUNION ALL\n\n-- CK_006: ACCOUNT_EXECUTIVES composite key (ACCOUNT_ID + EXECUTIVE_ID) must be unique\nSELECT\n    'CK_006' AS rule_id,\n    COUNT(*) - COUNT(DISTINCT CONCAT(account_id, '|', executive_id)) AS failures,\n    'ACCOUNT_EXECUTIVES composite key (account_id, executive_id) duplicate count' AS message\nFROM {{ target.database }}.APT.ACCOUNT_EXECUTIVES\n\nUNION ALL\n\n-- CK_007: ACCOUNT_PAYER_TYPES composite key (ACCOUNT_ID + PAYER_TYPE + PRODUCT) must be unique\nSELECT\n    'CK_007' AS rule_id,\n    COUNT(*) - COUNT(DISTINCT CONCAT(account_id, '|', payer_type, '|', product)) AS failures,\n    'ACCOUNT_PAYER_TYPES composite key (account_id, payer_type, product) duplicate count' AS message\nFROM {{ target.database }}.APT.ACCOUNT_PAYER_TYPES\n\nUNION ALL\n\n-- ============================================================================\n-- SECTION 4: FOREIGN KEY REFERENTIAL INTEGRITY CHECKS (FK_0XX)\n-- ============================================================================\n\n-- FK_001: ACCOUNTS.PARENT_ID must reference valid ACCOUNTS.ACCOUNT_ID\nSELECT\n    'FK_001' AS rule_id,\n    (SELECT COUNT(*) FROM {{ target.database }}.APT.ACCOUNTS a\n     WHERE a.parent_id IS NOT NULL\n       AND NOT EXISTS (SELECT 1 FROM {{ target.database }}.APT.ACCOUNTS p WHERE p.account_id = a.parent_id)) AS failures,\n    'ACCOUNTS.PARENT_ID orphan references' AS message\nFROM (SELECT 1) _one\n\nUNION ALL\n\n-- FK_002: TARGETS.ACCOUNT_ID must reference valid ACCOUNTS.ACCOUNT_ID\nSELECT\n    'FK_002' AS rule_id,\n    (SELECT COUNT(*) FROM {{ target.database }}.APT.TARGETS t\n     WHERE NOT EXISTS (SELECT 1 FROM {{ target.database }}.APT.ACCOUNTS a WHERE a.account_id = t.account_id)) AS failures,\n    'TARGETS.ACCOUNT_ID orphan references' AS message\nFROM (SELECT 1) _one\n\nUNION ALL\n\n-- FK_003: TARGETS.TEAM_CODE must reference valid TEAMS.TEAM_CODE\nSELECT\n    'FK_003' AS rule_id,\n    (SELECT COUNT(*) FROM {{ target.database }}.APT.TARGETS t\n     WHERE NOT EXISTS (SELECT 1 FROM {{ target.database }}.APT.TEAMS tm WHERE tm.team_code = t.team_code)) AS failures,\n    'TARGETS.TEAM_CODE orphan references' AS message\nFROM (SELECT 1) _one\n\nUNION ALL\n\n-- FK_004: ACCOUNT_HCPS.ACCOUNT_ID must reference valid ACCOUNTS.ACCOUNT_ID\nSELECT\n    'FK_004' AS rule_id,\n    (SELECT COUNT(*) FROM {{ target.database }}.APT.ACCOUNT_HCPS ah\n     WHERE NOT EXISTS (SELECT 1 FROM {{ target.database }}.APT.ACCOUNTS a WHERE a.account_id = ah.account_id)) AS failures,\n    'ACCOUNT_HCPS.ACCOUNT_ID orphan references' AS message\nFROM (SELECT 1) _one\n\nUNION ALL\n\n-- FK_005: ACCOUNT_HCPS.HCP_ID must reference valid HCPS.HCP_ID\nSELECT\n    'FK_005' AS rule_id,\n    (SELECT COUNT(*) FROM {{ target.database }}.APT.ACCOUNT_HCPS ah\n     WHERE NOT EXISTS (SELECT 1 FROM {{ target.database }}.APT.HCPS h WHERE h.hcp_id = ah.hcp_id)) AS failures,\n    'ACCOUNT_HCPS.HCP_ID orphan references' AS message\nFROM (SELECT 1) _one\n\nUNION ALL\n\n-- FK_006: EXECUTIVES.ACCOUNT_ID must reference valid ACCOUNTS.ACCOUNT_ID\nSELECT\n    'FK_006' AS rule_id,\n    (SELECT COUNT(*) FROM {{ target.database }}.APT.EXECUTIVES e\n     WHERE NOT EXISTS (SELECT 1 FROM {{ target.database }}.APT.ACCOUNTS a WHERE a.account_id = e.account_id)) AS failures,\n    'EXECUTIVES.ACCOUNT_ID orphan references' AS message\nFROM (SELECT 1) _one\n\nUNION ALL\n\n-- FK_007: ACCOUNT_EXECUTIVES.ACCOUNT_ID must reference valid ACCOUNTS.ACCOUNT_ID\nSELECT\n    'FK_007' AS rule_id,\n    (SELECT COUNT(*) FROM {{ target.database }}.APT.ACCOUNT_EXECUTIVES ae\n     WHERE NOT EXISTS (SELECT 1 FROM {{ target.database }}.APT.ACCOUNTS a WHERE a.account_id = ae.account_id)) AS failures,\n    'ACCOUNT_EXECUTIVES.ACCOUNT_ID orphan references' AS message\nFROM (SELECT 1) _one\n\nUNION ALL\n\n-- FK_008: ACCOUNT_EXECUTIVES.EXECUTIVE_ID must reference valid EXECUTIVES.EXECUTIVE_ID\nSELECT\n    'FK_008' AS rule_id,\n    (SELECT COUNT(*) FROM {{ target.database }}.APT.ACCOUNT_EXECUTIVES ae\n     WHERE NOT EXISTS (SELECT 1 FROM {{ target.database }}.APT.EXECUTIVES e WHERE e.executive_id = ae.executive_id)) AS failures,\n    'ACCOUNT_EXECUTIVES.EXECUTIVE_ID orphan references' AS message\nFROM (SELECT 1) _one\n\nUNION ALL\n\n-- FK_009: ACCOUNTS_GEO_AFFILIATION.ACCOUNT_ID must reference valid ACCOUNTS.ACCOUNT_ID\nSELECT\n    'FK_009' AS rule_id,\n    (SELECT COUNT(*) FROM {{ target.database }}.APT.ACCOUNT_GEO_AFFILIATION ag\n     WHERE NOT EXISTS (SELECT 1 FROM {{ target.database }}.APT.ACCOUNTS a WHERE a.account_id = ag.account_id)) AS failures,\n    'ACCOUNTS_GEO_AFFILIATION.ACCOUNT_ID orphan references' AS message\nFROM (SELECT 1) _one\n\nUNION ALL\n\n-- FK_010: ACCOUNTS_GEO_AFFILIATION.GEO_CODE must reference valid GEOGRAPHIES.GEO_CODE\nSELECT\n    'FK_010' AS rule_id,\n    (SELECT COUNT(*) FROM {{ target.database }}.APT.ACCOUNT_GEO_AFFILIATION ag\n     WHERE NOT EXISTS (SELECT 1 FROM {{ target.database }}.APT.GEOGRAPHIES g WHERE g.geo_code = ag.geo_code)) AS failures,\n    'ACCOUNTS_GEO_AFFILIATION.GEO_CODE orphan references' AS message\nFROM (SELECT 1) _one\n\nUNION ALL\n\n-- FK_011: ACCOUNT_METRIC_VALUE.ACCOUNT_ID must reference valid ACCOUNTS.ACCOUNT_ID\nSELECT\n    'FK_011' AS rule_id,\n    (SELECT COUNT(*) FROM {{ target.database }}.APT.ACCOUNT_METRIC_VALUE amv\n     WHERE NOT EXISTS (SELECT 1 FROM {{ target.database }}.APT.ACCOUNTS a WHERE a.account_id = amv.account_id)) AS failures,\n    'ACCOUNT_METRIC_VALUE.ACCOUNT_ID orphan references' AS message\nFROM (SELECT 1) _one\n\nUNION ALL\n\n-- FK_012: GEO_METRIC_VALUE.GEOGRAPHY_ID must reference valid GEOGRAPHIES.GEO_CODE\nSELECT\n    'FK_012' AS rule_id,\n    (SELECT COUNT(*) FROM {{ target.database }}.APT.GEO_METRIC_VALUE gmv\n     WHERE NOT EXISTS (SELECT 1 FROM {{ target.database }}.APT.GEOGRAPHIES g WHERE g.geo_code = gmv.geography_id)) AS failures,\n    'GEO_METRIC_VALUE.GEOGRAPHY_ID orphan references' AS message\nFROM (SELECT 1) _one\n\nUNION ALL\n\n-- FK_013: ACCOUNT_PAYER_TYPES.ACCOUNT_ID must reference valid ACCOUNTS.ACCOUNT_ID\nSELECT\n    'FK_013' AS rule_id,\n    (SELECT COUNT(*) FROM {{ target.database }}.APT.ACCOUNT_PAYER_TYPES apt\n     WHERE NOT EXISTS (SELECT 1 FROM {{ target.database }}.APT.ACCOUNTS a WHERE a.account_id = apt.account_id)) AS failures,\n    'ACCOUNT_PAYER_TYPES.ACCOUNT_ID orphan references' AS message\nFROM (SELECT 1) _one\n\nUNION ALL\n\n-- FK_014: GEOGRAPHIES.PARENT_CODE must reference valid GEOGRAPHIES.GEO_CODE\nSELECT\n    'FK_014' AS rule_id,\n    (SELECT COUNT(*) FROM {{ target.database }}.APT.GEOGRAPHIES g\n     WHERE g.parent_code IS NOT NULL\n       AND NOT EXISTS (SELECT 1 FROM {{ target.database }}.APT.GEOGRAPHIES p WHERE p.geo_code = g.parent_code)) AS failures,\n    'GEOGRAPHIES.PARENT_CODE orphan references' AS message\nFROM (SELECT 1) _one\n\nUNION ALL\n\n-- ============================================================================\n-- SECTION 5: LIST OF VALUES (LoV) VALIDATION CHECKS (LOV_0XX)\n-- ============================================================================\n\n-- LOV_001: ACCOUNTS.ACCOUNT_TYPE must be in ACCOUNT_TYPES.CODE\n-- DV_036: Exclude DDD-only accounts (firm_type IS NULL); known limitation of match_ddd_dhc fuzzy matching.\nSELECT\n    'LOV_001' AS rule_id,\n    (SELECT COUNT(*) FROM {{ target.database }}.APT.ACCOUNTS a\n     WHERE NOT EXISTS (SELECT 1 FROM {{ target.database }}.APT.ACCOUNT_TYPES at WHERE at.code = a.account_type)\n       AND (a.firm_type IS NOT NULL)) AS failures,\n    'ACCOUNTS.ACCOUNT_TYPE invalid LoV (excl. DDD-only)' AS message\nFROM (SELECT 1) _one\n\nUNION ALL\n\n-- LOV_002: ACCOUNTS.ACCOUNT_LEVEL must be in ACCOUNT_LEVELS.CODE\n-- DV_036: Exclude DDD-only accounts (firm_type IS NULL).\nSELECT\n    'LOV_002' AS rule_id,\n    (SELECT COUNT(*) FROM {{ target.database }}.APT.ACCOUNTS a\n     WHERE NOT EXISTS (SELECT 1 FROM {{ target.database }}.APT.ACCOUNT_LEVELS al WHERE al.code = a.account_level)\n       AND (a.firm_type IS NOT NULL)) AS failures,\n    'ACCOUNTS.ACCOUNT_LEVEL invalid LoV (excl. DDD-only)' AS message\nFROM (SELECT 1) _one\n\nUNION ALL\n\n-- LOV_003: ACCOUNTS.STATE must be in STATES.CODE (when not null)\n-- DV_036: Exclude DDD-only accounts (firm_type IS NULL).\nSELECT\n    'LOV_003' AS rule_id,\n    (SELECT COUNT(*) FROM {{ target.database }}.APT.ACCOUNTS a\n     WHERE a.state IS NOT NULL\n       AND NOT EXISTS (SELECT 1 FROM {{ target.database }}.APT.STATES s WHERE s.code = a.state)\n       AND (a.firm_type IS NOT NULL)) AS failures,\n    'ACCOUNTS.STATE invalid LoV (excl. DDD-only)' AS message\nFROM (SELECT 1) _one\n\nUNION ALL\n\n-- LOV_004: ACCOUNT_PAYER_TYPES.PAYER_TYPE must be in PAYER_TYPES.CODE\nSELECT\n    'LOV_004' AS rule_id,\n    (SELECT COUNT(*) FROM {{ target.database }}.APT.ACCOUNT_PAYER_TYPES apt\n     WHERE NOT EXISTS (SELECT 1 FROM {{ target.database }}.APT.PAYER_TYPES pt WHERE pt.code = apt.payer_type)) AS failures,\n    'ACCOUNT_PAYER_TYPES.PAYER_TYPE invalid LoV' AS message\nFROM (SELECT 1) _one\n\nUNION ALL\n\n-- LOV_005: ACCOUNT_METRIC_VALUE.METRIC must be in METRIC_LIST.CODE\nSELECT\n    'LOV_005' AS rule_id,\n    (SELECT COUNT(*) FROM {{ target.database }}.APT.ACCOUNT_METRIC_VALUE amv\n     WHERE NOT EXISTS (SELECT 1 FROM {{ target.database }}.APT.METRIC_LIST m WHERE m.code = amv.metric)) AS failures,\n    'ACCOUNT_METRIC_VALUE.METRIC invalid LoV' AS message\nFROM (SELECT 1) _one\n\nUNION ALL\n\n-- LOV_006: GEO_METRIC_VALUE.METRIC must be in METRIC_LIST.CODE\nSELECT\n    'LOV_006' AS rule_id,\n    (SELECT COUNT(*) FROM {{ target.database }}.APT.GEO_METRIC_VALUE gmv\n     WHERE NOT EXISTS (SELECT 1 FROM {{ target.database }}.APT.METRIC_LIST m WHERE m.code = gmv.metric)) AS failures,\n    'GEO_METRIC_VALUE.METRIC invalid LoV' AS message\nFROM (SELECT 1) _one\n\nUNION ALL\n\n-- LOV_007: TEAMS.UNIT_CODE must be in UNITS.UNIT_CODE\nSELECT\n    'LOV_007' AS rule_id,\n    (SELECT COUNT(*) FROM {{ target.database }}.APT.TEAMS t\n     WHERE NOT EXISTS (SELECT 1 FROM {{ target.database }}.APT.UNITS u WHERE u.unit_code = t.unit_code)) AS failures,\n    'TEAMS.UNIT_CODE invalid LoV' AS message\nFROM (SELECT 1) _one\n\nUNION ALL\n\n-- LOV_008: GEOGRAPHIES.UNIT must be in UNITS.UNIT_CODE\nSELECT\n    'LOV_008' AS rule_id,\n    (SELECT COUNT(*) FROM {{ target.database }}.APT.GEOGRAPHIES g\n     WHERE NOT EXISTS (SELECT 1 FROM {{ target.database }}.APT.UNITS u WHERE u.unit_code = g.unit)) AS failures,\n    'GEOGRAPHIES.UNIT invalid LoV' AS message\nFROM (SELECT 1) _one\n\nUNION ALL\n\n-- LOV_009: GEOGRAPHIES.TEAM must be in TEAMS.TEAM_NAME or TEAM_CODE (when not null)\n-- Note: HSD/KAM/MSL match TEAM_NAME; TEAM_PAYOR matches TEAM_CODE\nSELECT\n    'LOV_009' AS rule_id,\n    (SELECT COUNT(*) FROM {{ target.database }}.APT.GEOGRAPHIES g\n     WHERE g.team IS NOT NULL\n       AND NOT EXISTS (SELECT 1 FROM {{ target.database }}.APT.TEAMS t WHERE t.team_name = g.team OR t.team_code = g.team)) AS failures,\n    'GEOGRAPHIES.TEAM invalid LoV' AS message\nFROM (SELECT 1) _one\n\nUNION ALL\n\n-- LOV_010: HCPS.STATE must be in STATES.CODE (when not null)\nSELECT\n    'LOV_010' AS rule_id,\n    (SELECT COUNT(*) FROM {{ target.database }}.APT.HCPS h\n     WHERE h.state IS NOT NULL\n       AND NOT EXISTS (SELECT 1 FROM {{ target.database }}.APT.STATES s WHERE s.code = h.state)) AS failures,\n    'HCPS.STATE invalid LoV' AS message\nFROM (SELECT 1) _one\n\nUNION ALL\n\n-- LOV_011: DATA_POINTS.CODE must match ACCOUNT_METRIC_VALUE.X_VALUE date range\nSELECT\n    'LOV_011' AS rule_id,\n    (SELECT COUNT(*) FROM {{ target.database }}.APT.DATA_POINTS dp\n     WHERE NOT EXISTS (SELECT 1 FROM {{ target.database }}.APT.ACCOUNT_METRIC_VALUE amv WHERE amv.x_value::VARCHAR = dp.code)) AS failures,\n    'DATA_POINTS.CODE not in ACCOUNT_METRIC_VALUE date range' AS message\nFROM (SELECT 1) _one\n\n)\n\nSELECT rule_id, failures, message\nFROM validation_results\nWHERE failures > 0", "doc_blocks": [], "language": "sql", "refs": [], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}}, "seed.CGOncology_MDM.seed_new_payor_contacts": {"database": "CGONCOLOGY_TEST", "schema": "project", "name": "seed_new_payor_contacts", "resource_type": "seed", "package_name": "CGOncology_MDM", "path": "seed_new_payor_contacts.csv", "original_file_path": "seeds/seed_new_payor_contacts.csv", "unique_id": "seed.CGOncology_MDM.seed_new_payor_contacts", "fqn": ["CGOncology_MDM", "seed_new_payor_contacts"], "alias": "seed_new_payor_contacts", "checksum": {"name": "sha256", "checksum": "7569df63edca0c65169308a1d62ffa507ed59cc781f84f81187159589a7efd77"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "seed", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "delimiter": ",", "quote_columns": null}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.2134058, "relation_name": "CGONCOLOGY_TEST.project.seed_new_payor_contacts", "raw_code": "", "doc_blocks": [], "root_path": "/Volumes/SSD/MDM/CG_DBT/CGOncology_MDM", "depends_on": {"macros": []}}, "seed.CGOncology_MDM.config_account_type_thresholds": {"database": "CGONCOLOGY_TEST", "schema": "project", "name": "config_account_type_thresholds", "resource_type": "seed", "package_name": "CGOncology_MDM", "path": "config_account_type_thresholds.csv", "original_file_path": "seeds/config_account_type_thresholds.csv", "unique_id": "seed.CGOncology_MDM.config_account_type_thresholds", "fqn": ["CGOncology_MDM", "config_account_type_thresholds"], "alias": "config_account_type_thresholds", "checksum": {"name": "sha256", "checksum": "786d00d75d56e13969f2d7ed079fd959153fc3a1316dba6d9eb2863a36ad0e82"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "seed", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "delimiter": ",", "quote_columns": null}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.214171, "relation_name": "CGONCOLOGY_TEST.project.config_account_type_thresholds", "raw_code": "", "doc_blocks": [], "root_path": "/Volumes/SSD/MDM/CG_DBT/CGOncology_MDM", "depends_on": {"macros": []}}, "seed.CGOncology_MDM.seed_new_payor_upload": {"database": "CGONCOLOGY_TEST", "schema": "project", "name": "seed_new_payor_upload", "resource_type": "seed", "package_name": "CGOncology_MDM", "path": "seed_new_payor_upload.csv", "original_file_path": "seeds/seed_new_payor_upload.csv", "unique_id": "seed.CGOncology_MDM.seed_new_payor_upload", "fqn": ["CGOncology_MDM", "seed_new_payor_upload"], "alias": "seed_new_payor_upload", "checksum": {"name": "sha256", "checksum": "75cd5ea8dceadb0c100a256a7a5c200f542f02ccf941a1c6c2fbce5f1cbbcf9b"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "seed", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "delimiter": ",", "quote_columns": null}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.2148669, "relation_name": "CGONCOLOGY_TEST.project.seed_new_payor_upload", "raw_code": "", "doc_blocks": [], "root_path": "/Volumes/SSD/MDM/CG_DBT/CGOncology_MDM", "depends_on": {"macros": []}}, "seed.CGOncology_MDM.teams": {"database": "CGONCOLOGY_TEST", "schema": "project", "name": "teams", "resource_type": "seed", "package_name": "CGOncology_MDM", "path": "teams.csv", "original_file_path": "seeds/teams.csv", "unique_id": "seed.CGOncology_MDM.teams", "fqn": ["CGOncology_MDM", "teams"], "alias": "teams", "checksum": {"name": "sha256", "checksum": "a13943bc67eaeb2700267162e1e592bb0b1fc1b7a0577a40e1f49bb50ba1e0c7"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "seed", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "delimiter": ",", "quote_columns": null}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.2155561, "relation_name": "CGONCOLOGY_TEST.project.teams", "raw_code": "", "doc_blocks": [], "root_path": "/Volumes/SSD/MDM/CG_DBT/CGOncology_MDM", "depends_on": {"macros": []}}, "seed.CGOncology_MDM.config_name_aliases": {"database": "CGONCOLOGY_TEST", "schema": "project", "name": "config_name_aliases", "resource_type": "seed", "package_name": "CGOncology_MDM", "path": "config_name_aliases.csv", "original_file_path": "seeds/config_name_aliases.csv", "unique_id": "seed.CGOncology_MDM.config_name_aliases", "fqn": ["CGOncology_MDM", "config_name_aliases"], "alias": "config_name_aliases", "checksum": {"name": "sha256", "checksum": "2bae5b64e309e6ca3a2931557d3a96dda659a807eba4fb6f9546d46e00fa22ca"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "seed", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "delimiter": ",", "quote_columns": null}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.2162309, "relation_name": "CGONCOLOGY_TEST.project.config_name_aliases", "raw_code": "", "doc_blocks": [], "root_path": "/Volumes/SSD/MDM/CG_DBT/CGOncology_MDM", "depends_on": {"macros": []}}, "seed.CGOncology_MDM.seed_manual_hco_accounts": {"database": "CGONCOLOGY_TEST", "schema": "project", "name": "seed_manual_hco_accounts", "resource_type": "seed", "package_name": "CGOncology_MDM", "path": "seed_manual_hco_accounts.csv", "original_file_path": "seeds/seed_manual_hco_accounts.csv", "unique_id": "seed.CGOncology_MDM.seed_manual_hco_accounts", "fqn": ["CGOncology_MDM", "seed_manual_hco_accounts"], "alias": "seed_manual_hco_accounts", "checksum": {"name": "sha256", "checksum": "5232e514a87968873980bf4da27f06a9a09385f37a8c909c04bf835c5b68cc0c"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "seed", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {"kmk_hco_id": "varchar(20)", "org_name": "varchar(255)", "account_type": "varchar(50)", "account_level": "varchar(50)", "firm_type": "varchar(100)", "dh_id": "varchar(20)", "address_line_1": "varchar(255)", "city": "varchar(100)", "state": "varchar(2)", "zip_code": "varchar(10)", "notes": "varchar(500)"}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "delimiter": ",", "quote_columns": null}, "tags": [], "description": "Manual HCO accounts (7000000xxx series) not in standard DHC pipeline but needed for APT", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://seeds/schema.yml", "build_path": null, "unrendered_config": {"column_types": {"kmk_hco_id": "varchar(20)", "org_name": "varchar(255)", "account_type": "varchar(50)", "account_level": "varchar(50)", "firm_type": "varchar(100)", "dh_id": "varchar(20)", "address_line_1": "varchar(255)", "city": "varchar(100)", "state": "varchar(2)", "zip_code": "varchar(10)", "notes": "varchar(500)"}}, "created_at": 1770177079.26133, "relation_name": "CGONCOLOGY_TEST.project.seed_manual_hco_accounts", "raw_code": "", "doc_blocks": [], "root_path": "/Volumes/SSD/MDM/CG_DBT/CGOncology_MDM", "depends_on": {"macros": []}}, "seed.CGOncology_MDM.seed_firm_types": {"database": "CGONCOLOGY_TEST", "schema": "project", "name": "seed_firm_types", "resource_type": "seed", "package_name": "CGOncology_MDM", "path": "seed_firm_types.csv", "original_file_path": "seeds/seed_firm_types.csv", "unique_id": "seed.CGOncology_MDM.seed_firm_types", "fqn": ["CGOncology_MDM", "seed_firm_types"], "alias": "seed_firm_types", "checksum": {"name": "sha256", "checksum": "1a48f627af1d62030896576f1afc18592021ef6b39542f2cabf3d680c9fb7ac1"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "seed", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "delimiter": ",", "quote_columns": null}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.2175791, "relation_name": "CGONCOLOGY_TEST.project.seed_firm_types", "raw_code": "", "doc_blocks": [], "root_path": "/Volumes/SSD/MDM/CG_DBT/CGOncology_MDM", "depends_on": {"macros": []}}, "seed.CGOncology_MDM.config_survivorship_hco": {"database": "CGONCOLOGY_TEST", "schema": "project", "name": "config_survivorship_hco", "resource_type": "seed", "package_name": "CGOncology_MDM", "path": "config_survivorship_hco.csv", "original_file_path": "seeds/config_survivorship_hco.csv", "unique_id": "seed.CGOncology_MDM.config_survivorship_hco", "fqn": ["CGOncology_MDM", "config_survivorship_hco"], "alias": "config_survivorship_hco", "checksum": {"name": "sha256", "checksum": "039c70a6c51803d645f2fee2677e4ebd2f6fd0355bd0bce678c1f189bf59ace7"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "seed", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "delimiter": ",", "quote_columns": null}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.2182558, "relation_name": "CGONCOLOGY_TEST.project.config_survivorship_hco", "raw_code": "", "doc_blocks": [], "root_path": "/Volumes/SSD/MDM/CG_DBT/CGOncology_MDM", "depends_on": {"macros": []}}, "seed.CGOncology_MDM.seed_bc_rx_ndc_mapping": {"database": "CGONCOLOGY_TEST", "schema": "project", "name": "seed_bc_rx_ndc_mapping", "resource_type": "seed", "package_name": "CGOncology_MDM", "path": "seed_bc_rx_ndc_mapping.csv", "original_file_path": "seeds/seed_bc_rx_ndc_mapping.csv", "unique_id": "seed.CGOncology_MDM.seed_bc_rx_ndc_mapping", "fqn": ["CGOncology_MDM", "seed_bc_rx_ndc_mapping"], "alias": "seed_bc_rx_ndc_mapping", "checksum": {"name": "sha256", "checksum": "a1de4e6eb5d46f1ee57d7965e37433da846cbda4081ce35f3497433db3758c65"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "seed", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "delimiter": ",", "quote_columns": null}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.218931, "relation_name": "CGONCOLOGY_TEST.project.seed_bc_rx_ndc_mapping", "raw_code": "", "doc_blocks": [], "root_path": "/Volumes/SSD/MDM/CG_DBT/CGOncology_MDM", "depends_on": {"macros": []}}, "seed.CGOncology_MDM.zip_city_state_config": {"database": "CGONCOLOGY_TEST", "schema": "STANDARDIZATION", "name": "zip_city_state_config", "resource_type": "seed", "package_name": "CGOncology_MDM", "path": "zip_city_state_config.csv", "original_file_path": "seeds/zip_city_state_config.csv", "unique_id": "seed.CGOncology_MDM.zip_city_state_config", "fqn": ["CGOncology_MDM", "zip_city_state_config"], "alias": "zip_city_state_config", "checksum": {"name": "sha256", "checksum": "1994288a9f79146767b1425b6bd129abf9c27a56a81831f6bcd8fc15909766c7"}, "config": {"enabled": true, "alias": null, "schema": "STANDARDIZATION", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "seed", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {"ZIP": "varchar(5)"}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "delimiter": ",", "quote_columns": null}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"column_types": {"ZIP": "varchar(5)"}, "schema": "STANDARDIZATION"}, "created_at": 1770177079.2196429, "relation_name": "CGONCOLOGY_TEST.STANDARDIZATION.zip_city_state_config", "raw_code": "", "doc_blocks": [], "root_path": "/Volumes/SSD/MDM/CG_DBT/CGOncology_MDM", "depends_on": {"macros": []}}, "seed.CGOncology_MDM.seed_units": {"database": "CGONCOLOGY_TEST", "schema": "project", "name": "seed_units", "resource_type": "seed", "package_name": "CGOncology_MDM", "path": "seed_units.csv", "original_file_path": "seeds/seed_units.csv", "unique_id": "seed.CGOncology_MDM.seed_units", "fqn": ["CGOncology_MDM", "seed_units"], "alias": "seed_units", "checksum": {"name": "sha256", "checksum": "9063ee34e8b375753f60c2c45ad8ebae885d93c24a310744374ff4f8143f0318"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "seed", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "delimiter": ",", "quote_columns": null}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.222487, "relation_name": "CGONCOLOGY_TEST.project.seed_units", "raw_code": "", "doc_blocks": [], "root_path": "/Volumes/SSD/MDM/CG_DBT/CGOncology_MDM", "depends_on": {"macros": []}}, "seed.CGOncology_MDM.config_fuzzy_match_thresholds": {"database": "CGONCOLOGY_TEST", "schema": "project", "name": "config_fuzzy_match_thresholds", "resource_type": "seed", "package_name": "CGOncology_MDM", "path": "config_fuzzy_match_thresholds.csv", "original_file_path": "seeds/config_fuzzy_match_thresholds.csv", "unique_id": "seed.CGOncology_MDM.config_fuzzy_match_thresholds", "fqn": ["CGOncology_MDM", "config_fuzzy_match_thresholds"], "alias": "config_fuzzy_match_thresholds", "checksum": {"name": "sha256", "checksum": "e670b355af1c1921393fb383921782f3a6814126a20397d5c1f3c19509e21513"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "seed", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "delimiter": ",", "quote_columns": null}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.223177, "relation_name": "CGONCOLOGY_TEST.project.config_fuzzy_match_thresholds", "raw_code": "", "doc_blocks": [], "root_path": "/Volumes/SSD/MDM/CG_DBT/CGOncology_MDM", "depends_on": {"macros": []}}, "seed.CGOncology_MDM.seed_bc_dx_code_mapping": {"database": "CGONCOLOGY_TEST", "schema": "project", "name": "seed_bc_dx_code_mapping", "resource_type": "seed", "package_name": "CGOncology_MDM", "path": "seed_bc_dx_code_mapping.csv", "original_file_path": "seeds/seed_bc_dx_code_mapping.csv", "unique_id": "seed.CGOncology_MDM.seed_bc_dx_code_mapping", "fqn": ["CGOncology_MDM", "seed_bc_dx_code_mapping"], "alias": "seed_bc_dx_code_mapping", "checksum": {"name": "sha256", "checksum": "6bcedfc5cb8ef2057b8fd917325e36f2b812ae01287eb5dfa73c2bfe756a9666"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "seed", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "delimiter": ",", "quote_columns": null}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.2238562, "relation_name": "CGONCOLOGY_TEST.project.seed_bc_dx_code_mapping", "raw_code": "", "doc_blocks": [], "root_path": "/Volumes/SSD/MDM/CG_DBT/CGOncology_MDM", "depends_on": {"macros": []}}, "seed.CGOncology_MDM.seed_metric_list": {"database": "CGONCOLOGY_TEST", "schema": "project", "name": "seed_metric_list", "resource_type": "seed", "package_name": "CGOncology_MDM", "path": "seed_metric_list.csv", "original_file_path": "seeds/seed_metric_list.csv", "unique_id": "seed.CGOncology_MDM.seed_metric_list", "fqn": ["CGOncology_MDM", "seed_metric_list"], "alias": "seed_metric_list", "checksum": {"name": "sha256", "checksum": "7c9540d1604f0cb12f3f140d4e12b43b6049f0c48b6a085eaaad721a2b9d0748"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "seed", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "delimiter": ",", "quote_columns": null}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.224546, "relation_name": "CGONCOLOGY_TEST.project.seed_metric_list", "raw_code": "", "doc_blocks": [], "root_path": "/Volumes/SSD/MDM/CG_DBT/CGOncology_MDM", "depends_on": {"macros": []}}, "seed.CGOncology_MDM.config_address_abbreviations": {"database": "CGONCOLOGY_TEST", "schema": "project", "name": "config_address_abbreviations", "resource_type": "seed", "package_name": "CGOncology_MDM", "path": "config_address_abbreviations.csv", "original_file_path": "seeds/config_address_abbreviations.csv", "unique_id": "seed.CGOncology_MDM.config_address_abbreviations", "fqn": ["CGOncology_MDM", "config_address_abbreviations"], "alias": "config_address_abbreviations", "checksum": {"name": "sha256", "checksum": "b902305f68dc042555d1b6fb221680e9681cac3d41def4ca344301c9c57b74ac"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "seed", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {"original": "varchar(100)", "standard": "varchar(100)", "category": "varchar(50)"}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "delimiter": ",", "quote_columns": null}, "tags": [], "description": "Address abbreviation mappings for standardization", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://seeds/schema.yml", "build_path": null, "unrendered_config": {"column_types": {"original": "varchar(100)", "standard": "varchar(100)", "category": "varchar(50)"}}, "created_at": 1770177079.260867, "relation_name": "CGONCOLOGY_TEST.project.config_address_abbreviations", "raw_code": "", "doc_blocks": [], "root_path": "/Volumes/SSD/MDM/CG_DBT/CGOncology_MDM", "depends_on": {"macros": []}}, "seed.CGOncology_MDM.config_mso_known_affiliations": {"database": "CGONCOLOGY_TEST", "schema": "project", "name": "config_mso_known_affiliations", "resource_type": "seed", "package_name": "CGOncology_MDM", "path": "config_mso_known_affiliations.csv", "original_file_path": "seeds/config_mso_known_affiliations.csv", "unique_id": "seed.CGOncology_MDM.config_mso_known_affiliations", "fqn": ["CGOncology_MDM", "config_mso_known_affiliations"], "alias": "config_mso_known_affiliations", "checksum": {"name": "sha256", "checksum": "2445395e7f974d821a6b27ae0ebeebb07798d51f96617cf29dbfef6bd7dc0d4a"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "seed", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {"MATCH_VALUE": "varchar(50)", "PE_DH_ID": "varchar(50)", "PE_NAME": "varchar(255)", "PE_FIRM_TYPE": "varchar(100)", "MATCH_TYPE": "varchar(50)"}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "delimiter": ",", "quote_columns": null}, "tags": [], "description": "MSO (Management Services Organization) known affiliations for PE lookup", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://seeds/schema.yml", "build_path": null, "unrendered_config": {"column_types": {"MATCH_VALUE": "varchar(50)", "PE_DH_ID": "varchar(50)", "PE_NAME": "varchar(255)", "PE_FIRM_TYPE": "varchar(100)", "MATCH_TYPE": "varchar(50)"}}, "created_at": 1770177079.260413, "relation_name": "CGONCOLOGY_TEST.project.config_mso_known_affiliations", "raw_code": "", "doc_blocks": [], "root_path": "/Volumes/SSD/MDM/CG_DBT/CGOncology_MDM", "depends_on": {"macros": []}}, "seed.CGOncology_MDM.seed_payer_types": {"database": "CGONCOLOGY_TEST", "schema": "project", "name": "seed_payer_types", "resource_type": "seed", "package_name": "CGOncology_MDM", "path": "seed_payer_types.csv", "original_file_path": "seeds/seed_payer_types.csv", "unique_id": "seed.CGOncology_MDM.seed_payer_types", "fqn": ["CGOncology_MDM", "seed_payer_types"], "alias": "seed_payer_types", "checksum": {"name": "sha256", "checksum": "cfa6b5c60a5ee117a53cca8024bf40712e56d9b1e9c80a8e8d2bea412ecf3aff"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "seed", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "delimiter": ",", "quote_columns": null}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.2265978, "relation_name": "CGONCOLOGY_TEST.project.seed_payer_types", "raw_code": "", "doc_blocks": [], "root_path": "/Volumes/SSD/MDM/CG_DBT/CGOncology_MDM", "depends_on": {"macros": []}}, "seed.CGOncology_MDM.config_ddd_sub_category": {"database": "CGONCOLOGY_TEST", "schema": "project", "name": "config_ddd_sub_category", "resource_type": "seed", "package_name": "CGOncology_MDM", "path": "config_ddd_sub_category.csv", "original_file_path": "seeds/config_ddd_sub_category.csv", "unique_id": "seed.CGOncology_MDM.config_ddd_sub_category", "fqn": ["CGOncology_MDM", "config_ddd_sub_category"], "alias": "config_ddd_sub_category", "checksum": {"name": "sha256", "checksum": "9415fea5192d25f8b1d6814e5b864f980a5cb2b8aaff89f4f0f4c0d5de905798"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "seed", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "delimiter": ",", "quote_columns": null}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.227278, "relation_name": "CGONCOLOGY_TEST.project.config_ddd_sub_category", "raw_code": "", "doc_blocks": [], "root_path": "/Volumes/SSD/MDM/CG_DBT/CGOncology_MDM", "depends_on": {"macros": []}}, "seed.CGOncology_MDM.account_type_business_input": {"database": "CGONCOLOGY_TEST", "schema": "project", "name": "account_type_business_input", "resource_type": "seed", "package_name": "CGOncology_MDM", "path": "account_type_business_input.csv", "original_file_path": "seeds/account_type_business_input.csv", "unique_id": "seed.CGOncology_MDM.account_type_business_input", "fqn": ["CGOncology_MDM", "account_type_business_input"], "alias": "account_type_business_input", "checksum": {"name": "sha256", "checksum": "6cb619ef60eeda123186d39a7d99697821f36060a4600e5a021bffe2892a4fdf"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "seed", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "delimiter": ",", "quote_columns": null}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.2279491, "relation_name": "CGONCOLOGY_TEST.project.account_type_business_input", "raw_code": "", "doc_blocks": [], "root_path": "/Volumes/SSD/MDM/CG_DBT/CGOncology_MDM", "depends_on": {"macros": []}}, "seed.CGOncology_MDM.seed_bc_px_code_mapping": {"database": "CGONCOLOGY_TEST", "schema": "project", "name": "seed_bc_px_code_mapping", "resource_type": "seed", "package_name": "CGOncology_MDM", "path": "seed_bc_px_code_mapping.csv", "original_file_path": "seeds/seed_bc_px_code_mapping.csv", "unique_id": "seed.CGOncology_MDM.seed_bc_px_code_mapping", "fqn": ["CGOncology_MDM", "seed_bc_px_code_mapping"], "alias": "seed_bc_px_code_mapping", "checksum": {"name": "sha256", "checksum": "b7554ff159e0be8970f7c9a56d2da3fd352b08cfe513263b2bca5e306fb2b509"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "seed", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "delimiter": ",", "quote_columns": null}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.228605, "relation_name": "CGONCOLOGY_TEST.project.seed_bc_px_code_mapping", "raw_code": "", "doc_blocks": [], "root_path": "/Volumes/SSD/MDM/CG_DBT/CGOncology_MDM", "depends_on": {"macros": []}}, "seed.CGOncology_MDM.config_survivorship_hcp": {"database": "CGONCOLOGY_TEST", "schema": "project", "name": "config_survivorship_hcp", "resource_type": "seed", "package_name": "CGOncology_MDM", "path": "config_survivorship_hcp.csv", "original_file_path": "seeds/config_survivorship_hcp.csv", "unique_id": "seed.CGOncology_MDM.config_survivorship_hcp", "fqn": ["CGOncology_MDM", "config_survivorship_hcp"], "alias": "config_survivorship_hcp", "checksum": {"name": "sha256", "checksum": "d4508c80f75183434cff3b459b12705eb384c5ca602ca39482f1d8c44df55423"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "seed", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "delimiter": ",", "quote_columns": null}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.22926, "relation_name": "CGONCOLOGY_TEST.project.config_survivorship_hcp", "raw_code": "", "doc_blocks": [], "root_path": "/Volumes/SSD/MDM/CG_DBT/CGOncology_MDM", "depends_on": {"macros": []}}, "operation.CGOncology_MDM.CGOncology_MDM-on-run-start-0": {"database": "CGONCOLOGY_TEST", "schema": "project", "name": "CGOncology_MDM-on-run-start-0", "resource_type": "operation", "package_name": "CGOncology_MDM", "path": "hooks/CGOncology_MDM-on-run-start-0.sql", "original_file_path": "./dbt_project.yml", "unique_id": "operation.CGOncology_MDM.CGOncology_MDM-on-run-start-0", "fqn": ["CGOncology_MDM", "hooks", "CGOncology_MDM-on-run-start-0"], "alias": "CGOncology_MDM-on-run-start-0", "checksum": {"name": "sha256", "checksum": "ca0d8d2bb56fc563d65ae5cf7e70639b79b28d22749861a90634cbc77cc99a89"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null}, "tags": ["on-run-start"], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.2322419, "relation_name": null, "raw_code": "{{ check_refresh_mode() }}", "doc_blocks": [], "language": "sql", "refs": [], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.CGOncology_MDM.check_refresh_mode"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "index": 0}, "test.CGOncology_MDM.not_null_mdm_ref_market_definition_code_type.1ea347293e": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_mdm_ref_market_definition_code_type", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_mdm_ref_market_definition_code_type.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_mdm_ref_market_definition_code_type.1ea347293e", "fqn": ["CGOncology_MDM", "mdm", "not_null_mdm_ref_market_definition_code_type"], "alias": "not_null_mdm_ref_market_definition_code_type", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.266517, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_ref_market_definition", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.mdm_ref_market_definition"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "code_type", "file_key_name": "models.mdm_ref_market_definition", "attached_node": "model.CGOncology_MDM.mdm_ref_market_definition", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "code_type", "model": "{{ get_where_subquery(ref('mdm_ref_market_definition')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_mdm_ref_market_definition_code_type__DX__PX__RX__Sub_category.7430203439": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_mdm_ref_market_definition_code_type__DX__PX__RX__Sub_category", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_mdm_ref_market_2d931291d86adaa7161ec3bfa3ab4629.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_mdm_ref_market_definition_code_type__DX__PX__RX__Sub_category.7430203439", "fqn": ["CGOncology_MDM", "mdm", "accepted_values_mdm_ref_market_definition_code_type__DX__PX__RX__Sub_category"], "alias": "accepted_values_mdm_ref_market_2d931291d86adaa7161ec3bfa3ab4629", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_mdm_ref_market_2d931291d86adaa7161ec3bfa3ab4629", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_mdm_ref_market_2d931291d86adaa7161ec3bfa3ab4629"}, "created_at": 1770177079.2671309, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_mdm_ref_market_2d931291d86adaa7161ec3bfa3ab4629\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_ref_market_definition", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_ref_market_definition"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "code_type", "file_key_name": "models.mdm_ref_market_definition", "attached_node": "model.CGOncology_MDM.mdm_ref_market_definition", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "code_type", "values": ["DX", "PX", "RX", "Sub-category"], "model": "{{ get_where_subquery(ref('mdm_ref_market_definition')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_mdm_ref_market_definition_code.d44466f5db": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_mdm_ref_market_definition_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_mdm_ref_market_definition_code.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_mdm_ref_market_definition_code.d44466f5db", "fqn": ["CGOncology_MDM", "mdm", "not_null_mdm_ref_market_definition_code"], "alias": "not_null_mdm_ref_market_definition_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.268907, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_ref_market_definition", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.mdm_ref_market_definition"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "code", "file_key_name": "models.mdm_ref_market_definition", "attached_node": "model.CGOncology_MDM.mdm_ref_market_definition", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "code", "model": "{{ get_where_subquery(ref('mdm_ref_market_definition')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_mdm_customer_master_hco_kmk_hco_id.872bd2a427": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_mdm_customer_master_hco_kmk_hco_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_mdm_customer_master_hco_kmk_hco_id.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_mdm_customer_master_hco_kmk_hco_id.872bd2a427", "fqn": ["CGOncology_MDM", "mdm", "not_null_mdm_customer_master_hco_kmk_hco_id"], "alias": "not_null_mdm_customer_master_hco_kmk_hco_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.2694242, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hco_id", "file_key_name": "models.mdm_customer_master_hco", "attached_node": "model.CGOncology_MDM.mdm_customer_master_hco", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "kmk_hco_id", "model": "{{ get_where_subquery(ref('mdm_customer_master_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_mdm_customer_master_hco_kmk_hco_id.5a263fffb9": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_mdm_customer_master_hco_kmk_hco_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_mdm_customer_master_hco_kmk_hco_id.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.unique_mdm_customer_master_hco_kmk_hco_id.5a263fffb9", "fqn": ["CGOncology_MDM", "mdm", "unique_mdm_customer_master_hco_kmk_hco_id"], "alias": "unique_mdm_customer_master_hco_kmk_hco_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.269923, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hco_id", "file_key_name": "models.mdm_customer_master_hco", "attached_node": "model.CGOncology_MDM.mdm_customer_master_hco", "test_metadata": {"name": "unique", "kwargs": {"column_name": "kmk_hco_id", "model": "{{ get_where_subquery(ref('mdm_customer_master_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_mdm_customer_master_hco_kmk_hco_id___34_0_9_9_.c57ec6e0c3": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_column_values_to_match_regex_mdm_customer_master_hco_kmk_hco_id___34_0_9_9_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_column_1e6c8867510dd6ae1befac63fafa03fc.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_mdm_customer_master_hco_kmk_hco_id___34_0_9_9_.c57ec6e0c3", "fqn": ["CGOncology_MDM", "mdm", "dbt_expectations_expect_column_values_to_match_regex_mdm_customer_master_hco_kmk_hco_id___34_0_9_9_"], "alias": "dbt_expectations_expect_column_1e6c8867510dd6ae1befac63fafa03fc", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_column_1e6c8867510dd6ae1befac63fafa03fc", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_expectations_expect_column_1e6c8867510dd6ae1befac63fafa03fc"}, "created_at": 1770177079.270433, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_column_values_to_match_regex(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_expectations_expect_column_1e6c8867510dd6ae1befac63fafa03fc\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_column_values_to_match_regex", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hco_id", "file_key_name": "models.mdm_customer_master_hco", "attached_node": "model.CGOncology_MDM.mdm_customer_master_hco", "test_metadata": {"name": "expect_column_values_to_match_regex", "kwargs": {"column_name": "kmk_hco_id", "regex": "^[34][0-9]{9}$", "model": "{{ get_where_subquery(ref('mdm_customer_master_hco')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_mdm_customer_master_hco_dh_id___0__dh_id_IS_NOT_NULL.1f6f480f1f": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_column_values_to_not_match_regex_mdm_customer_master_hco_dh_id___0__dh_id_IS_NOT_NULL", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_column_f71611850bf124424394f7f52f73feda.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_mdm_customer_master_hco_dh_id___0__dh_id_IS_NOT_NULL.1f6f480f1f", "fqn": ["CGOncology_MDM", "mdm", "dbt_expectations_expect_column_values_to_not_match_regex_mdm_customer_master_hco_dh_id___0__dh_id_IS_NOT_NULL"], "alias": "dbt_expectations_expect_column_f71611850bf124424394f7f52f73feda", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_column_f71611850bf124424394f7f52f73feda", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_expectations_expect_column_f71611850bf124424394f7f52f73feda"}, "created_at": 1770177079.27191, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_column_values_to_not_match_regex(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_expectations_expect_column_f71611850bf124424394f7f52f73feda\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_column_values_to_not_match_regex", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "dh_id", "file_key_name": "models.mdm_customer_master_hco", "attached_node": "model.CGOncology_MDM.mdm_customer_master_hco", "test_metadata": {"name": "expect_column_values_to_not_match_regex", "kwargs": {"column_name": "dh_id", "regex": "[.]0", "row_condition": "dh_id IS NOT NULL", "model": "{{ get_where_subquery(ref('mdm_customer_master_hco')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.not_null_mdm_customer_master_hco_org_name.2edb57d8d4": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_mdm_customer_master_hco_org_name", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_mdm_customer_master_hco_org_name.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_mdm_customer_master_hco_org_name.2edb57d8d4", "fqn": ["CGOncology_MDM", "mdm", "not_null_mdm_customer_master_hco_org_name"], "alias": "not_null_mdm_customer_master_hco_org_name", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.273303, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "org_name", "file_key_name": "models.mdm_customer_master_hco", "attached_node": "model.CGOncology_MDM.mdm_customer_master_hco", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "org_name", "model": "{{ get_where_subquery(ref('mdm_customer_master_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.key_coverage_mdm_customer_master_hco_kmk_hco_id__kmk_hco_id__SOURCE_CODE_DHC_OR_SOURCE_CODE_DDD_AND_DH_ID_IS_NOT_NULL___ref_mdm_customer_xref_hco_.cc390e7732": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "key_coverage_mdm_customer_master_hco_kmk_hco_id__kmk_hco_id__SOURCE_CODE_DHC_OR_SOURCE_CODE_DDD_AND_DH_ID_IS_NOT_NULL___ref_mdm_customer_xref_hco_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "key_coverage_mdm_customer_mast_1d83781efb2d3830759c5c2d7752eaa7.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.key_coverage_mdm_customer_master_hco_kmk_hco_id__kmk_hco_id__SOURCE_CODE_DHC_OR_SOURCE_CODE_DDD_AND_DH_ID_IS_NOT_NULL___ref_mdm_customer_xref_hco_.cc390e7732", "fqn": ["CGOncology_MDM", "mdm", "key_coverage_mdm_customer_master_hco_kmk_hco_id__kmk_hco_id__SOURCE_CODE_DHC_OR_SOURCE_CODE_DDD_AND_DH_ID_IS_NOT_NULL___ref_mdm_customer_xref_hco_"], "alias": "key_coverage_mdm_customer_mast_1d83781efb2d3830759c5c2d7752eaa7", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "key_coverage_mdm_customer_mast_1d83781efb2d3830759c5c2d7752eaa7", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "key_coverage_mdm_customer_mast_1d83781efb2d3830759c5c2d7752eaa7"}, "created_at": 1770177079.273817, "relation_name": null, "raw_code": "{{ test_key_coverage(**_dbt_generic_test_kwargs) }}{{ config(alias=\"key_coverage_mdm_customer_mast_1d83781efb2d3830759c5c2d7752eaa7\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_xref_hco", "package": null, "version": null}, {"name": "mdm_customer_master_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.CGOncology_MDM.test_key_coverage", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_xref_hco", "model.CGOncology_MDM.mdm_customer_master_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.mdm_customer_master_hco", "attached_node": "model.CGOncology_MDM.mdm_customer_master_hco", "test_metadata": {"name": "key_coverage", "kwargs": {"column_name": "kmk_hco_id", "source_model": "ref('mdm_customer_xref_hco')", "source_column": "kmk_hco_id", "source_filter": "SOURCE_CODE = 'DHC' OR (SOURCE_CODE = 'DDD' AND DH_ID IS NOT NULL)", "model": "{{ get_where_subquery(ref('mdm_customer_master_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_mdm_customer_master_hcp_kmk_hcp_id.9e02d8cee2": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_mdm_customer_master_hcp_kmk_hcp_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_mdm_customer_master_hcp_kmk_hcp_id.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_mdm_customer_master_hcp_kmk_hcp_id.9e02d8cee2", "fqn": ["CGOncology_MDM", "mdm", "not_null_mdm_customer_master_hcp_kmk_hcp_id"], "alias": "not_null_mdm_customer_master_hcp_kmk_hcp_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.2754738, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hcp_id", "file_key_name": "models.mdm_customer_master_hcp", "attached_node": "model.CGOncology_MDM.mdm_customer_master_hcp", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "kmk_hcp_id", "model": "{{ get_where_subquery(ref('mdm_customer_master_hcp')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_mdm_customer_master_hcp_kmk_hcp_id.bb0184f77e": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_mdm_customer_master_hcp_kmk_hcp_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_mdm_customer_master_hcp_kmk_hcp_id.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.unique_mdm_customer_master_hcp_kmk_hcp_id.bb0184f77e", "fqn": ["CGOncology_MDM", "mdm", "unique_mdm_customer_master_hcp_kmk_hcp_id"], "alias": "unique_mdm_customer_master_hcp_kmk_hcp_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.275979, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hcp_id", "file_key_name": "models.mdm_customer_master_hcp", "attached_node": "model.CGOncology_MDM.mdm_customer_master_hcp", "test_metadata": {"name": "unique", "kwargs": {"column_name": "kmk_hcp_id", "model": "{{ get_where_subquery(ref('mdm_customer_master_hcp')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_mdm_customer_master_hcp_kmk_hcp_id___15_0_9_9_.a52d55a1ce": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_column_values_to_match_regex_mdm_customer_master_hcp_kmk_hcp_id___15_0_9_9_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_column_e4ad392ae5a04560aa46dcd2b8eb04df.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_mdm_customer_master_hcp_kmk_hcp_id___15_0_9_9_.a52d55a1ce", "fqn": ["CGOncology_MDM", "mdm", "dbt_expectations_expect_column_values_to_match_regex_mdm_customer_master_hcp_kmk_hcp_id___15_0_9_9_"], "alias": "dbt_expectations_expect_column_e4ad392ae5a04560aa46dcd2b8eb04df", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_column_e4ad392ae5a04560aa46dcd2b8eb04df", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_expectations_expect_column_e4ad392ae5a04560aa46dcd2b8eb04df"}, "created_at": 1770177079.276489, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_column_values_to_match_regex(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_expectations_expect_column_e4ad392ae5a04560aa46dcd2b8eb04df\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_column_values_to_match_regex", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hcp_id", "file_key_name": "models.mdm_customer_master_hcp", "attached_node": "model.CGOncology_MDM.mdm_customer_master_hcp", "test_metadata": {"name": "expect_column_values_to_match_regex", "kwargs": {"column_name": "kmk_hcp_id", "regex": "^[15][0-9]{9}$", "model": "{{ get_where_subquery(ref('mdm_customer_master_hcp')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.not_null_mdm_customer_master_hcp_npi.08ade6922b": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_mdm_customer_master_hcp_npi", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_mdm_customer_master_hcp_npi.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_mdm_customer_master_hcp_npi.08ade6922b", "fqn": ["CGOncology_MDM", "mdm", "not_null_mdm_customer_master_hcp_npi"], "alias": "not_null_mdm_customer_master_hcp_npi", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.277866, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "npi", "file_key_name": "models.mdm_customer_master_hcp", "attached_node": "model.CGOncology_MDM.mdm_customer_master_hcp", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "npi", "model": "{{ get_where_subquery(ref('mdm_customer_master_hcp')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_mdm_customer_master_hcp_npi.d95c718672": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_mdm_customer_master_hcp_npi", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_mdm_customer_master_hcp_npi.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.unique_mdm_customer_master_hcp_npi.d95c718672", "fqn": ["CGOncology_MDM", "mdm", "unique_mdm_customer_master_hcp_npi"], "alias": "unique_mdm_customer_master_hcp_npi", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.278367, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "npi", "file_key_name": "models.mdm_customer_master_hcp", "attached_node": "model.CGOncology_MDM.mdm_customer_master_hcp", "test_metadata": {"name": "unique", "kwargs": {"column_name": "npi", "model": "{{ get_where_subquery(ref('mdm_customer_master_hcp')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_mdm_customer_master_hcp_npi___0_9_10_.7145d546b1": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_column_values_to_match_regex_mdm_customer_master_hcp_npi___0_9_10_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_column_ea0148e17d038d0fa90f1385b1edadfc.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_mdm_customer_master_hcp_npi___0_9_10_.7145d546b1", "fqn": ["CGOncology_MDM", "mdm", "dbt_expectations_expect_column_values_to_match_regex_mdm_customer_master_hcp_npi___0_9_10_"], "alias": "dbt_expectations_expect_column_ea0148e17d038d0fa90f1385b1edadfc", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_column_ea0148e17d038d0fa90f1385b1edadfc", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_expectations_expect_column_ea0148e17d038d0fa90f1385b1edadfc"}, "created_at": 1770177079.278862, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_column_values_to_match_regex(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_expectations_expect_column_ea0148e17d038d0fa90f1385b1edadfc\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_column_values_to_match_regex", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "npi", "file_key_name": "models.mdm_customer_master_hcp", "attached_node": "model.CGOncology_MDM.mdm_customer_master_hcp", "test_metadata": {"name": "expect_column_values_to_match_regex", "kwargs": {"column_name": "npi", "regex": "^[0-9]{10}$", "model": "{{ get_where_subquery(ref('mdm_customer_master_hcp')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.not_null_mdm_customer_master_hcp_last_name.ea89caac8a": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_mdm_customer_master_hcp_last_name", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_mdm_customer_master_hcp_last_name.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_mdm_customer_master_hcp_last_name.ea89caac8a", "fqn": ["CGOncology_MDM", "mdm", "not_null_mdm_customer_master_hcp_last_name"], "alias": "not_null_mdm_customer_master_hcp_last_name", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.280215, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "last_name", "file_key_name": "models.mdm_customer_master_hcp", "attached_node": "model.CGOncology_MDM.mdm_customer_master_hcp", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "last_name", "model": "{{ get_where_subquery(ref('mdm_customer_master_hcp')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_mdm_customer_master_hcp_primary_specialty_____primary_specialty_IS_NOT_NULL.63e68a0e35": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_column_values_to_not_match_regex_mdm_customer_master_hcp_primary_specialty_____primary_specialty_IS_NOT_NULL", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_column_2e3d94bf4d0ccd45972cb4c98cd8c240.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_mdm_customer_master_hcp_primary_specialty_____primary_specialty_IS_NOT_NULL.63e68a0e35", "fqn": ["CGOncology_MDM", "mdm", "dbt_expectations_expect_column_values_to_not_match_regex_mdm_customer_master_hcp_primary_specialty_____primary_specialty_IS_NOT_NULL"], "alias": "dbt_expectations_expect_column_2e3d94bf4d0ccd45972cb4c98cd8c240", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_column_2e3d94bf4d0ccd45972cb4c98cd8c240", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_expectations_expect_column_2e3d94bf4d0ccd45972cb4c98cd8c240"}, "created_at": 1770177079.280726, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_column_values_to_not_match_regex(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_expectations_expect_column_2e3d94bf4d0ccd45972cb4c98cd8c240\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_column_values_to_not_match_regex", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "primary_specialty", "file_key_name": "models.mdm_customer_master_hcp", "attached_node": "model.CGOncology_MDM.mdm_customer_master_hcp", "test_metadata": {"name": "expect_column_values_to_not_match_regex", "kwargs": {"column_name": "primary_specialty", "regex": "[-/(),&]", "row_condition": "primary_specialty IS NOT NULL", "model": "{{ get_where_subquery(ref('mdm_customer_master_hcp')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_mdm_customer_master_hcp_primary_specialty___And_Or_Of_The___primary_specialty_IS_NOT_NULL.431e6cdde2": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_column_values_to_not_match_regex_mdm_customer_master_hcp_primary_specialty___And_Or_Of_The___primary_specialty_IS_NOT_NULL", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_column_9fc233513197445e91f66824a646f1b7.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_mdm_customer_master_hcp_primary_specialty___And_Or_Of_The___primary_specialty_IS_NOT_NULL.431e6cdde2", "fqn": ["CGOncology_MDM", "mdm", "dbt_expectations_expect_column_values_to_not_match_regex_mdm_customer_master_hcp_primary_specialty___And_Or_Of_The___primary_specialty_IS_NOT_NULL"], "alias": "dbt_expectations_expect_column_9fc233513197445e91f66824a646f1b7", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_column_9fc233513197445e91f66824a646f1b7", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_expectations_expect_column_9fc233513197445e91f66824a646f1b7"}, "created_at": 1770177079.282305, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_column_values_to_not_match_regex(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_expectations_expect_column_9fc233513197445e91f66824a646f1b7\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_column_values_to_not_match_regex", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "primary_specialty", "file_key_name": "models.mdm_customer_master_hcp", "attached_node": "model.CGOncology_MDM.mdm_customer_master_hcp", "test_metadata": {"name": "expect_column_values_to_not_match_regex", "kwargs": {"column_name": "primary_specialty", "regex": " (And|Or|Of|The) ", "row_condition": "primary_specialty IS NOT NULL", "model": "{{ get_where_subquery(ref('mdm_customer_master_hcp')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_mdm_customer_master_hcp_primary_specialty_____primary_specialty_IS_NOT_NULL.ebd4f1382a": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_column_values_to_not_match_regex_mdm_customer_master_hcp_primary_specialty_____primary_specialty_IS_NOT_NULL", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_column_2e3d94bf4d0ccd45972cb4c98cd8c240.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_mdm_customer_master_hcp_primary_specialty_____primary_specialty_IS_NOT_NULL.ebd4f1382a", "fqn": ["CGOncology_MDM", "mdm", "dbt_expectations_expect_column_values_to_not_match_regex_mdm_customer_master_hcp_primary_specialty_____primary_specialty_IS_NOT_NULL"], "alias": "dbt_expectations_expect_column_2e3d94bf4d0ccd45972cb4c98cd8c240", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_column_2e3d94bf4d0ccd45972cb4c98cd8c240", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_expectations_expect_column_2e3d94bf4d0ccd45972cb4c98cd8c240"}, "created_at": 1770177079.283614, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_column_values_to_not_match_regex(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_expectations_expect_column_2e3d94bf4d0ccd45972cb4c98cd8c240\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_column_values_to_not_match_regex", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "primary_specialty", "file_key_name": "models.mdm_customer_master_hcp", "attached_node": "model.CGOncology_MDM.mdm_customer_master_hcp", "test_metadata": {"name": "expect_column_values_to_not_match_regex", "kwargs": {"column_name": "primary_specialty", "regex": "  ", "row_condition": "primary_specialty IS NOT NULL", "model": "{{ get_where_subquery(ref('mdm_customer_master_hcp')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.dbt_expectations_expect_column_value_lengths_to_be_between_mdm_customer_master_hcp_primary_specialty__100.0751b38539": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_column_value_lengths_to_be_between_mdm_customer_master_hcp_primary_specialty__100", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_column_35b3c9c0bd2d2e8d1aefe5c5dd5c5244.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_column_value_lengths_to_be_between_mdm_customer_master_hcp_primary_specialty__100.0751b38539", "fqn": ["CGOncology_MDM", "mdm", "dbt_expectations_expect_column_value_lengths_to_be_between_mdm_customer_master_hcp_primary_specialty__100"], "alias": "dbt_expectations_expect_column_35b3c9c0bd2d2e8d1aefe5c5dd5c5244", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_column_35b3c9c0bd2d2e8d1aefe5c5dd5c5244", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": "primary_specialty IS NOT NULL", "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"where": "primary_specialty IS NOT NULL", "alias": "dbt_expectations_expect_column_35b3c9c0bd2d2e8d1aefe5c5dd5c5244"}, "created_at": 1770177079.285341, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_column_value_lengths_to_be_between(**_dbt_generic_test_kwargs) }}{{ config(where=\"primary_specialty IS NOT NULL\",alias=\"dbt_expectations_expect_column_35b3c9c0bd2d2e8d1aefe5c5dd5c5244\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_column_value_lengths_to_be_between", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "primary_specialty", "file_key_name": "models.mdm_customer_master_hcp", "attached_node": "model.CGOncology_MDM.mdm_customer_master_hcp", "test_metadata": {"name": "expect_column_value_lengths_to_be_between", "kwargs": {"column_name": "primary_specialty", "max_value": 100, "model": "{{ get_where_subquery(ref('mdm_customer_master_hcp')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.dbt_expectations_expect_column_value_lengths_to_be_between_mdm_customer_master_hcp_primary_specialty_group__100.542c204ac7": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_column_value_lengths_to_be_between_mdm_customer_master_hcp_primary_specialty_group__100", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_column_32ffdf7dbab75bd7547058e0d077a749.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_column_value_lengths_to_be_between_mdm_customer_master_hcp_primary_specialty_group__100.542c204ac7", "fqn": ["CGOncology_MDM", "mdm", "dbt_expectations_expect_column_value_lengths_to_be_between_mdm_customer_master_hcp_primary_specialty_group__100"], "alias": "dbt_expectations_expect_column_32ffdf7dbab75bd7547058e0d077a749", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_column_32ffdf7dbab75bd7547058e0d077a749", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": "primary_specialty_group IS NOT NULL", "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"where": "primary_specialty_group IS NOT NULL", "alias": "dbt_expectations_expect_column_32ffdf7dbab75bd7547058e0d077a749"}, "created_at": 1770177079.286916, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_column_value_lengths_to_be_between(**_dbt_generic_test_kwargs) }}{{ config(where=\"primary_specialty_group IS NOT NULL\",alias=\"dbt_expectations_expect_column_32ffdf7dbab75bd7547058e0d077a749\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_column_value_lengths_to_be_between", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "primary_specialty_group", "file_key_name": "models.mdm_customer_master_hcp", "attached_node": "model.CGOncology_MDM.mdm_customer_master_hcp", "test_metadata": {"name": "expect_column_value_lengths_to_be_between", "kwargs": {"column_name": "primary_specialty_group", "max_value": 100, "model": "{{ get_where_subquery(ref('mdm_customer_master_hcp')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.key_coverage_mdm_customer_master_hcp_kmk_hcp_id__kmk_hcp_id__SOURCE_CODE_DHC___ref_mdm_customer_xref_hcp_.c421076b29": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "key_coverage_mdm_customer_master_hcp_kmk_hcp_id__kmk_hcp_id__SOURCE_CODE_DHC___ref_mdm_customer_xref_hcp_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "key_coverage_mdm_customer_mast_cefa994f6a7981b0b4b3bbaa1d0249df.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.key_coverage_mdm_customer_master_hcp_kmk_hcp_id__kmk_hcp_id__SOURCE_CODE_DHC___ref_mdm_customer_xref_hcp_.c421076b29", "fqn": ["CGOncology_MDM", "mdm", "key_coverage_mdm_customer_master_hcp_kmk_hcp_id__kmk_hcp_id__SOURCE_CODE_DHC___ref_mdm_customer_xref_hcp_"], "alias": "key_coverage_mdm_customer_mast_cefa994f6a7981b0b4b3bbaa1d0249df", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "key_coverage_mdm_customer_mast_cefa994f6a7981b0b4b3bbaa1d0249df", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "key_coverage_mdm_customer_mast_cefa994f6a7981b0b4b3bbaa1d0249df"}, "created_at": 1770177079.288673, "relation_name": null, "raw_code": "{{ test_key_coverage(**_dbt_generic_test_kwargs) }}{{ config(alias=\"key_coverage_mdm_customer_mast_cefa994f6a7981b0b4b3bbaa1d0249df\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_xref_hcp", "package": null, "version": null}, {"name": "mdm_customer_master_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.CGOncology_MDM.test_key_coverage", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_xref_hcp", "model.CGOncology_MDM.mdm_customer_master_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.mdm_customer_master_hcp", "attached_node": "model.CGOncology_MDM.mdm_customer_master_hcp", "test_metadata": {"name": "key_coverage", "kwargs": {"column_name": "kmk_hcp_id", "source_model": "ref('mdm_customer_xref_hcp')", "source_column": "kmk_hcp_id", "source_filter": "SOURCE_CODE = 'DHC'", "model": "{{ get_where_subquery(ref('mdm_customer_master_hcp')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_mdm_customer_xref_hco_kmk_hco_id.fa70a0d10c": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_mdm_customer_xref_hco_kmk_hco_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_mdm_customer_xref_hco_kmk_hco_id.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_mdm_customer_xref_hco_kmk_hco_id.fa70a0d10c", "fqn": ["CGOncology_MDM", "mdm", "not_null_mdm_customer_xref_hco_kmk_hco_id"], "alias": "not_null_mdm_customer_xref_hco_kmk_hco_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.2901351, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_xref_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.mdm_customer_xref_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hco_id", "file_key_name": "models.mdm_customer_xref_hco", "attached_node": "model.CGOncology_MDM.mdm_customer_xref_hco", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "kmk_hco_id", "model": "{{ get_where_subquery(ref('mdm_customer_xref_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.relationships_mdm_customer_xref_hco_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.bb9737f0e4": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "relationships_mdm_customer_xref_hco_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "relationships_mdm_customer_xre_8bb0ed194e10851ae4e2b72ba6a38292.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.relationships_mdm_customer_xref_hco_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.bb9737f0e4", "fqn": ["CGOncology_MDM", "mdm", "relationships_mdm_customer_xref_hco_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_"], "alias": "relationships_mdm_customer_xre_8bb0ed194e10851ae4e2b72ba6a38292", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "relationships_mdm_customer_xre_8bb0ed194e10851ae4e2b72ba6a38292", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": "source_code = 'DHC'", "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"where": "source_code = 'DHC'", "alias": "relationships_mdm_customer_xre_8bb0ed194e10851ae4e2b72ba6a38292"}, "created_at": 1770177079.290663, "relation_name": null, "raw_code": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(where=\"source_code = 'DHC'\",alias=\"relationships_mdm_customer_xre_8bb0ed194e10851ae4e2b72ba6a38292\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hco", "package": null, "version": null}, {"name": "mdm_customer_xref_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.mdm_customer_xref_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hco_id", "file_key_name": "models.mdm_customer_xref_hco", "attached_node": "model.CGOncology_MDM.mdm_customer_xref_hco", "test_metadata": {"name": "relationships", "kwargs": {"to": "ref('mdm_customer_master_hco')", "field": "kmk_hco_id", "column_name": "kmk_hco_id", "model": "{{ get_where_subquery(ref('mdm_customer_xref_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_mdm_customer_xref_hco_source_code.767c39c483": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_mdm_customer_xref_hco_source_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_mdm_customer_xref_hco_source_code.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_mdm_customer_xref_hco_source_code.767c39c483", "fqn": ["CGOncology_MDM", "mdm", "not_null_mdm_customer_xref_hco_source_code"], "alias": "not_null_mdm_customer_xref_hco_source_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.292172, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_xref_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.mdm_customer_xref_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "source_code", "file_key_name": "models.mdm_customer_xref_hco", "attached_node": "model.CGOncology_MDM.mdm_customer_xref_hco", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "source_code", "model": "{{ get_where_subquery(ref('mdm_customer_xref_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_mdm_customer_xref_hco_source_code__DHC__DDD__MEDSCOUT__PRACTICE_LOCATION.55e13c3ae2": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_mdm_customer_xref_hco_source_code__DHC__DDD__MEDSCOUT__PRACTICE_LOCATION", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_mdm_customer_x_69318319780fc9aeba1e92bbf0a65a7b.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_mdm_customer_xref_hco_source_code__DHC__DDD__MEDSCOUT__PRACTICE_LOCATION.55e13c3ae2", "fqn": ["CGOncology_MDM", "mdm", "accepted_values_mdm_customer_xref_hco_source_code__DHC__DDD__MEDSCOUT__PRACTICE_LOCATION"], "alias": "accepted_values_mdm_customer_x_69318319780fc9aeba1e92bbf0a65a7b", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_mdm_customer_x_69318319780fc9aeba1e92bbf0a65a7b", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_mdm_customer_x_69318319780fc9aeba1e92bbf0a65a7b"}, "created_at": 1770177079.2926888, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_mdm_customer_x_69318319780fc9aeba1e92bbf0a65a7b\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_xref_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_xref_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "source_code", "file_key_name": "models.mdm_customer_xref_hco", "attached_node": "model.CGOncology_MDM.mdm_customer_xref_hco", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "source_code", "values": ["DHC", "DDD", "MEDSCOUT", "PRACTICE_LOCATION"], "model": "{{ get_where_subquery(ref('mdm_customer_xref_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_mdm_customer_xref_hco_source_id.d0ee1617fe": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_mdm_customer_xref_hco_source_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_mdm_customer_xref_hco_source_id.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_mdm_customer_xref_hco_source_id.d0ee1617fe", "fqn": ["CGOncology_MDM", "mdm", "not_null_mdm_customer_xref_hco_source_id"], "alias": "not_null_mdm_customer_xref_hco_source_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.294235, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_xref_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.mdm_customer_xref_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "source_id", "file_key_name": "models.mdm_customer_xref_hco", "attached_node": "model.CGOncology_MDM.mdm_customer_xref_hco", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "source_id", "model": "{{ get_where_subquery(ref('mdm_customer_xref_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.key_coverage_mdm_customer_xref_hco_source_id__dh_id__ref_std_dh_hco___SOURCE_CODE_DHC_.2474a26f9d": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "key_coverage_mdm_customer_xref_hco_source_id__dh_id__ref_std_dh_hco___SOURCE_CODE_DHC_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "key_coverage_mdm_customer_xref_e8f09afa155c7664d9ef575b5b86c2f7.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.key_coverage_mdm_customer_xref_hco_source_id__dh_id__ref_std_dh_hco___SOURCE_CODE_DHC_.2474a26f9d", "fqn": ["CGOncology_MDM", "mdm", "key_coverage_mdm_customer_xref_hco_source_id__dh_id__ref_std_dh_hco___SOURCE_CODE_DHC_"], "alias": "key_coverage_mdm_customer_xref_e8f09afa155c7664d9ef575b5b86c2f7", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "key_coverage_mdm_customer_xref_e8f09afa155c7664d9ef575b5b86c2f7", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "key_coverage_mdm_customer_xref_e8f09afa155c7664d9ef575b5b86c2f7"}, "created_at": 1770177079.294956, "relation_name": null, "raw_code": "{{ test_key_coverage(**_dbt_generic_test_kwargs) }}{{ config(alias=\"key_coverage_mdm_customer_xref_e8f09afa155c7664d9ef575b5b86c2f7\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hco", "package": null, "version": null}, {"name": "mdm_customer_xref_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.CGOncology_MDM.test_key_coverage", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_hco", "model.CGOncology_MDM.mdm_customer_xref_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.mdm_customer_xref_hco", "attached_node": "model.CGOncology_MDM.mdm_customer_xref_hco", "test_metadata": {"name": "key_coverage", "kwargs": {"column_name": "source_id", "source_model": "ref('std_dh_hco')", "source_column": "dh_id", "target_filter": "SOURCE_CODE = 'DHC'", "model": "{{ get_where_subquery(ref('mdm_customer_xref_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_mdm_customer_xref_hcp_kmk_hcp_id.5ee8ca04b8": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_mdm_customer_xref_hcp_kmk_hcp_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_mdm_customer_xref_hcp_kmk_hcp_id.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_mdm_customer_xref_hcp_kmk_hcp_id.5ee8ca04b8", "fqn": ["CGOncology_MDM", "mdm", "not_null_mdm_customer_xref_hcp_kmk_hcp_id"], "alias": "not_null_mdm_customer_xref_hcp_kmk_hcp_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.2966511, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_xref_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.mdm_customer_xref_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hcp_id", "file_key_name": "models.mdm_customer_xref_hcp", "attached_node": "model.CGOncology_MDM.mdm_customer_xref_hcp", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "kmk_hcp_id", "model": "{{ get_where_subquery(ref('mdm_customer_xref_hcp')) }}"}, "namespace": null}}, "test.CGOncology_MDM.relationships_mdm_customer_xref_hcp_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_.fd7d7aed14": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "relationships_mdm_customer_xref_hcp_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "relationships_mdm_customer_xre_d9c774d87a408f235e2cbcd14004e940.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.relationships_mdm_customer_xref_hcp_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_.fd7d7aed14", "fqn": ["CGOncology_MDM", "mdm", "relationships_mdm_customer_xref_hcp_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_"], "alias": "relationships_mdm_customer_xre_d9c774d87a408f235e2cbcd14004e940", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "relationships_mdm_customer_xre_d9c774d87a408f235e2cbcd14004e940", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": "source_code = 'DHC'", "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"where": "source_code = 'DHC'", "alias": "relationships_mdm_customer_xre_d9c774d87a408f235e2cbcd14004e940"}, "created_at": 1770177079.297191, "relation_name": null, "raw_code": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(where=\"source_code = 'DHC'\",alias=\"relationships_mdm_customer_xre_d9c774d87a408f235e2cbcd14004e940\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hcp", "package": null, "version": null}, {"name": "mdm_customer_xref_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hcp", "model.CGOncology_MDM.mdm_customer_xref_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hcp_id", "file_key_name": "models.mdm_customer_xref_hcp", "attached_node": "model.CGOncology_MDM.mdm_customer_xref_hcp", "test_metadata": {"name": "relationships", "kwargs": {"to": "ref('mdm_customer_master_hcp')", "field": "kmk_hcp_id", "column_name": "kmk_hcp_id", "model": "{{ get_where_subquery(ref('mdm_customer_xref_hcp')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_mdm_customer_xref_hcp_npi.3df694fd52": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_mdm_customer_xref_hcp_npi", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_mdm_customer_xref_hcp_npi.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_mdm_customer_xref_hcp_npi.3df694fd52", "fqn": ["CGOncology_MDM", "mdm", "not_null_mdm_customer_xref_hcp_npi"], "alias": "not_null_mdm_customer_xref_hcp_npi", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.298732, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_xref_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.mdm_customer_xref_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "npi", "file_key_name": "models.mdm_customer_xref_hcp", "attached_node": "model.CGOncology_MDM.mdm_customer_xref_hcp", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "npi", "model": "{{ get_where_subquery(ref('mdm_customer_xref_hcp')) }}"}, "namespace": null}}, "test.CGOncology_MDM.relationships_mdm_customer_xref_hcp_npi__npi__ref_mdm_customer_master_hcp_.af000d17f9": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "relationships_mdm_customer_xref_hcp_npi__npi__ref_mdm_customer_master_hcp_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "relationships_mdm_customer_xre_5e727bc52085305bf476edd9aa541848.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.relationships_mdm_customer_xref_hcp_npi__npi__ref_mdm_customer_master_hcp_.af000d17f9", "fqn": ["CGOncology_MDM", "mdm", "relationships_mdm_customer_xref_hcp_npi__npi__ref_mdm_customer_master_hcp_"], "alias": "relationships_mdm_customer_xre_5e727bc52085305bf476edd9aa541848", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "relationships_mdm_customer_xre_5e727bc52085305bf476edd9aa541848", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": "source_code = 'DHC'", "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"where": "source_code = 'DHC'", "alias": "relationships_mdm_customer_xre_5e727bc52085305bf476edd9aa541848"}, "created_at": 1770177079.2992482, "relation_name": null, "raw_code": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(where=\"source_code = 'DHC'\",alias=\"relationships_mdm_customer_xre_5e727bc52085305bf476edd9aa541848\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hcp", "package": null, "version": null}, {"name": "mdm_customer_xref_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hcp", "model.CGOncology_MDM.mdm_customer_xref_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "npi", "file_key_name": "models.mdm_customer_xref_hcp", "attached_node": "model.CGOncology_MDM.mdm_customer_xref_hcp", "test_metadata": {"name": "relationships", "kwargs": {"to": "ref('mdm_customer_master_hcp')", "field": "npi", "column_name": "npi", "model": "{{ get_where_subquery(ref('mdm_customer_xref_hcp')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_mdm_customer_xref_hcp_source_code.125eb81841": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_mdm_customer_xref_hcp_source_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_mdm_customer_xref_hcp_source_code.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_mdm_customer_xref_hcp_source_code.125eb81841", "fqn": ["CGOncology_MDM", "mdm", "not_null_mdm_customer_xref_hcp_source_code"], "alias": "not_null_mdm_customer_xref_hcp_source_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.301014, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_xref_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.mdm_customer_xref_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "source_code", "file_key_name": "models.mdm_customer_xref_hcp", "attached_node": "model.CGOncology_MDM.mdm_customer_xref_hcp", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "source_code", "model": "{{ get_where_subquery(ref('mdm_customer_xref_hcp')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_mdm_customer_xref_hcp_source_code__DHC__MEDSCOUT.48cc60fa51": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_mdm_customer_xref_hcp_source_code__DHC__MEDSCOUT", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_mdm_customer_x_df151a75057b0be569854a1546e260b4.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_mdm_customer_xref_hcp_source_code__DHC__MEDSCOUT.48cc60fa51", "fqn": ["CGOncology_MDM", "mdm", "accepted_values_mdm_customer_xref_hcp_source_code__DHC__MEDSCOUT"], "alias": "accepted_values_mdm_customer_x_df151a75057b0be569854a1546e260b4", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_mdm_customer_x_df151a75057b0be569854a1546e260b4", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_mdm_customer_x_df151a75057b0be569854a1546e260b4"}, "created_at": 1770177079.301536, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_mdm_customer_x_df151a75057b0be569854a1546e260b4\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_xref_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_xref_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "source_code", "file_key_name": "models.mdm_customer_xref_hcp", "attached_node": "model.CGOncology_MDM.mdm_customer_xref_hcp", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "source_code", "values": ["DHC", "MEDSCOUT"], "model": "{{ get_where_subquery(ref('mdm_customer_xref_hcp')) }}"}, "namespace": null}}, "test.CGOncology_MDM.key_coverage_mdm_customer_xref_hcp_source_id__npi__ref_std_dh_hcp___SOURCE_CODE_DHC_.1ea045b04f": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "key_coverage_mdm_customer_xref_hcp_source_id__npi__ref_std_dh_hcp___SOURCE_CODE_DHC_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "key_coverage_mdm_customer_xref_cc7f2ff6844417001636edc545c34e10.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.key_coverage_mdm_customer_xref_hcp_source_id__npi__ref_std_dh_hcp___SOURCE_CODE_DHC_.1ea045b04f", "fqn": ["CGOncology_MDM", "mdm", "key_coverage_mdm_customer_xref_hcp_source_id__npi__ref_std_dh_hcp___SOURCE_CODE_DHC_"], "alias": "key_coverage_mdm_customer_xref_cc7f2ff6844417001636edc545c34e10", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "key_coverage_mdm_customer_xref_cc7f2ff6844417001636edc545c34e10", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "key_coverage_mdm_customer_xref_cc7f2ff6844417001636edc545c34e10"}, "created_at": 1770177079.3028438, "relation_name": null, "raw_code": "{{ test_key_coverage(**_dbt_generic_test_kwargs) }}{{ config(alias=\"key_coverage_mdm_customer_xref_cc7f2ff6844417001636edc545c34e10\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hcp", "package": null, "version": null}, {"name": "mdm_customer_xref_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.CGOncology_MDM.test_key_coverage", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_hcp", "model.CGOncology_MDM.mdm_customer_xref_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.mdm_customer_xref_hcp", "attached_node": "model.CGOncology_MDM.mdm_customer_xref_hcp", "test_metadata": {"name": "key_coverage", "kwargs": {"column_name": "source_id", "source_model": "ref('std_dh_hcp')", "source_column": "npi", "target_filter": "SOURCE_CODE = 'DHC'", "model": "{{ get_where_subquery(ref('mdm_customer_xref_hcp')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_mdm_best_affiliation_npi.09b0285e48": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_mdm_best_affiliation_npi", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_mdm_best_affiliation_npi.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_mdm_best_affiliation_npi.09b0285e48", "fqn": ["CGOncology_MDM", "mdm", "not_null_mdm_best_affiliation_npi"], "alias": "not_null_mdm_best_affiliation_npi", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.304325, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_best_affiliation", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.mdm_best_affiliation"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "npi", "file_key_name": "models.mdm_best_affiliation", "attached_node": "model.CGOncology_MDM.mdm_best_affiliation", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "npi", "model": "{{ get_where_subquery(ref('mdm_best_affiliation')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_mdm_best_affiliation_npi.41d120735b": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_mdm_best_affiliation_npi", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_mdm_best_affiliation_npi.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.unique_mdm_best_affiliation_npi.41d120735b", "fqn": ["CGOncology_MDM", "mdm", "unique_mdm_best_affiliation_npi"], "alias": "unique_mdm_best_affiliation_npi", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.30499, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_best_affiliation", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.CGOncology_MDM.mdm_best_affiliation"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "npi", "file_key_name": "models.mdm_best_affiliation", "attached_node": "model.CGOncology_MDM.mdm_best_affiliation", "test_metadata": {"name": "unique", "kwargs": {"column_name": "npi", "model": "{{ get_where_subquery(ref('mdm_best_affiliation')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_mdm_best_affiliation_kmk_hcp_id.50709ac5e3": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_mdm_best_affiliation_kmk_hcp_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_mdm_best_affiliation_kmk_hcp_id.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_mdm_best_affiliation_kmk_hcp_id.50709ac5e3", "fqn": ["CGOncology_MDM", "mdm", "not_null_mdm_best_affiliation_kmk_hcp_id"], "alias": "not_null_mdm_best_affiliation_kmk_hcp_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.3055081, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_best_affiliation", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.mdm_best_affiliation"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hcp_id", "file_key_name": "models.mdm_best_affiliation", "attached_node": "model.CGOncology_MDM.mdm_best_affiliation", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "kmk_hcp_id", "model": "{{ get_where_subquery(ref('mdm_best_affiliation')) }}"}, "namespace": null}}, "test.CGOncology_MDM.relationships_mdm_best_affiliation_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_.14c07bfe64": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "relationships_mdm_best_affiliation_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "relationships_mdm_best_affilia_84838fb9eabe18fcff6c09f938b07b1a.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.relationships_mdm_best_affiliation_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_.14c07bfe64", "fqn": ["CGOncology_MDM", "mdm", "relationships_mdm_best_affiliation_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_"], "alias": "relationships_mdm_best_affilia_84838fb9eabe18fcff6c09f938b07b1a", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "relationships_mdm_best_affilia_84838fb9eabe18fcff6c09f938b07b1a", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "relationships_mdm_best_affilia_84838fb9eabe18fcff6c09f938b07b1a"}, "created_at": 1770177079.30603, "relation_name": null, "raw_code": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_mdm_best_affilia_84838fb9eabe18fcff6c09f938b07b1a\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hcp", "package": null, "version": null}, {"name": "mdm_best_affiliation", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hcp", "model.CGOncology_MDM.mdm_best_affiliation"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hcp_id", "file_key_name": "models.mdm_best_affiliation", "attached_node": "model.CGOncology_MDM.mdm_best_affiliation", "test_metadata": {"name": "relationships", "kwargs": {"to": "ref('mdm_customer_master_hcp')", "field": "kmk_hcp_id", "column_name": "kmk_hcp_id", "model": "{{ get_where_subquery(ref('mdm_best_affiliation')) }}"}, "namespace": null}}, "test.CGOncology_MDM.relationships_mdm_best_affiliation_best_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.94418604ac": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "relationships_mdm_best_affiliation_best_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "relationships_mdm_best_affilia_0e085c80adf5432c9b176b8a50487335.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.relationships_mdm_best_affiliation_best_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.94418604ac", "fqn": ["CGOncology_MDM", "mdm", "relationships_mdm_best_affiliation_best_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_"], "alias": "relationships_mdm_best_affilia_0e085c80adf5432c9b176b8a50487335", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "relationships_mdm_best_affilia_0e085c80adf5432c9b176b8a50487335", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": "best_kmk_hco_id IS NOT NULL", "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"where": "best_kmk_hco_id IS NOT NULL", "alias": "relationships_mdm_best_affilia_0e085c80adf5432c9b176b8a50487335"}, "created_at": 1770177079.30801, "relation_name": null, "raw_code": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(where=\"best_kmk_hco_id IS NOT NULL\",alias=\"relationships_mdm_best_affilia_0e085c80adf5432c9b176b8a50487335\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hco", "package": null, "version": null}, {"name": "mdm_best_affiliation", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.mdm_best_affiliation"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "best_kmk_hco_id", "file_key_name": "models.mdm_best_affiliation", "attached_node": "model.CGOncology_MDM.mdm_best_affiliation", "test_metadata": {"name": "relationships", "kwargs": {"to": "ref('mdm_customer_master_hco')", "field": "kmk_hco_id", "column_name": "best_kmk_hco_id", "model": "{{ get_where_subquery(ref('mdm_best_affiliation')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_mdm_best_affiliation_mapping_rule.9c21268898": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_mdm_best_affiliation_mapping_rule", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_mdm_best_affiliation_mapping_rule.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_mdm_best_affiliation_mapping_rule.9c21268898", "fqn": ["CGOncology_MDM", "mdm", "not_null_mdm_best_affiliation_mapping_rule"], "alias": "not_null_mdm_best_affiliation_mapping_rule", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.3099608, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_best_affiliation", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.mdm_best_affiliation"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "mapping_rule", "file_key_name": "models.mdm_best_affiliation", "attached_node": "model.CGOncology_MDM.mdm_best_affiliation", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "mapping_rule", "model": "{{ get_where_subquery(ref('mdm_best_affiliation')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_mdm_best_affiliation_hist_npi.dcaef99ecf": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_mdm_best_affiliation_hist_npi", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_mdm_best_affiliation_hist_npi.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_mdm_best_affiliation_hist_npi.dcaef99ecf", "fqn": ["CGOncology_MDM", "mdm", "not_null_mdm_best_affiliation_hist_npi"], "alias": "not_null_mdm_best_affiliation_hist_npi", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.310477, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_best_affiliation_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.mdm_best_affiliation_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "npi", "file_key_name": "models.mdm_best_affiliation_hist", "attached_node": "model.CGOncology_MDM.mdm_best_affiliation_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "npi", "model": "{{ get_where_subquery(ref('mdm_best_affiliation_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_mdm_best_affiliation_hist_version_number.ec106bab60": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_mdm_best_affiliation_hist_version_number", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_mdm_best_affiliation_hist_version_number.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_mdm_best_affiliation_hist_version_number.ec106bab60", "fqn": ["CGOncology_MDM", "mdm", "not_null_mdm_best_affiliation_hist_version_number"], "alias": "not_null_mdm_best_affiliation_hist_version_number", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.310981, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_best_affiliation_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.mdm_best_affiliation_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "version_number", "file_key_name": "models.mdm_best_affiliation_hist", "attached_node": "model.CGOncology_MDM.mdm_best_affiliation_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "version_number", "model": "{{ get_where_subquery(ref('mdm_best_affiliation_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_mdm_best_affiliation_hist_is_current.7996664e31": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_mdm_best_affiliation_hist_is_current", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_mdm_best_affiliation_hist_is_current.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_mdm_best_affiliation_hist_is_current.7996664e31", "fqn": ["CGOncology_MDM", "mdm", "not_null_mdm_best_affiliation_hist_is_current"], "alias": "not_null_mdm_best_affiliation_hist_is_current", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.311476, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_best_affiliation_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.mdm_best_affiliation_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_current", "file_key_name": "models.mdm_best_affiliation_hist", "attached_node": "model.CGOncology_MDM.mdm_best_affiliation_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "is_current", "model": "{{ get_where_subquery(ref('mdm_best_affiliation_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_mdm_best_affiliation_hist_is_current__Y__N.115e68cd06": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_mdm_best_affiliation_hist_is_current__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_mdm_best_affiliation_hist_is_current__Y__N.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_mdm_best_affiliation_hist_is_current__Y__N.115e68cd06", "fqn": ["CGOncology_MDM", "mdm", "accepted_values_mdm_best_affiliation_hist_is_current__Y__N"], "alias": "accepted_values_mdm_best_affiliation_hist_is_current__Y__N", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.311984, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_best_affiliation_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_best_affiliation_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_current", "file_key_name": "models.mdm_best_affiliation_hist", "attached_node": "model.CGOncology_MDM.mdm_best_affiliation_hist", "test_metadata": {"name": "accepted_values", "kwargs": {"values": ["Y", "N"], "column_name": "is_current", "model": "{{ get_where_subquery(ref('mdm_best_affiliation_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_mdm_best_affiliation_hist_npi__version_number.b205a74dfb": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_utils_unique_combination_of_columns_mdm_best_affiliation_hist_npi__version_number", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_utils_unique_combination_o_796a4b949aaeef44464f08e2bbc26115.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_mdm_best_affiliation_hist_npi__version_number.b205a74dfb", "fqn": ["CGOncology_MDM", "mdm", "dbt_utils_unique_combination_of_columns_mdm_best_affiliation_hist_npi__version_number"], "alias": "dbt_utils_unique_combination_o_796a4b949aaeef44464f08e2bbc26115", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_utils_unique_combination_o_796a4b949aaeef44464f08e2bbc26115", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_796a4b949aaeef44464f08e2bbc26115"}, "created_at": 1770177079.313268, "relation_name": null, "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_796a4b949aaeef44464f08e2bbc26115\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_best_affiliation_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_utils.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_best_affiliation_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.mdm_best_affiliation_hist", "attached_node": "model.CGOncology_MDM.mdm_best_affiliation_hist", "test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["npi", "version_number"], "model": "{{ get_where_subquery(ref('mdm_best_affiliation_hist')) }}"}, "namespace": "dbt_utils"}}, "test.CGOncology_MDM.not_null_mdm_customer_xref_hco_hist_kmk_hco_id.97be341d89": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_mdm_customer_xref_hco_hist_kmk_hco_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_mdm_customer_xref_hco_hist_kmk_hco_id.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_mdm_customer_xref_hco_hist_kmk_hco_id.97be341d89", "fqn": ["CGOncology_MDM", "mdm", "not_null_mdm_customer_xref_hco_hist_kmk_hco_id"], "alias": "not_null_mdm_customer_xref_hco_hist_kmk_hco_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.3145962, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_xref_hco_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.mdm_customer_xref_hco_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hco_id", "file_key_name": "models.mdm_customer_xref_hco_hist", "attached_node": "model.CGOncology_MDM.mdm_customer_xref_hco_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "kmk_hco_id", "model": "{{ get_where_subquery(ref('mdm_customer_xref_hco_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_mdm_customer_xref_hco_hist_version_number.5a5057b6ac": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_mdm_customer_xref_hco_hist_version_number", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_mdm_customer_xref_hco_hist_version_number.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_mdm_customer_xref_hco_hist_version_number.5a5057b6ac", "fqn": ["CGOncology_MDM", "mdm", "not_null_mdm_customer_xref_hco_hist_version_number"], "alias": "not_null_mdm_customer_xref_hco_hist_version_number", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.315093, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_xref_hco_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.mdm_customer_xref_hco_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "version_number", "file_key_name": "models.mdm_customer_xref_hco_hist", "attached_node": "model.CGOncology_MDM.mdm_customer_xref_hco_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "version_number", "model": "{{ get_where_subquery(ref('mdm_customer_xref_hco_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_mdm_customer_xref_hco_hist_is_current__Y__N.f0f38b0287": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_mdm_customer_xref_hco_hist_is_current__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_mdm_customer_xref_hco_hist_is_current__Y__N.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_mdm_customer_xref_hco_hist_is_current__Y__N.f0f38b0287", "fqn": ["CGOncology_MDM", "mdm", "accepted_values_mdm_customer_xref_hco_hist_is_current__Y__N"], "alias": "accepted_values_mdm_customer_xref_hco_hist_is_current__Y__N", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.315669, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_xref_hco_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_xref_hco_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_current", "file_key_name": "models.mdm_customer_xref_hco_hist", "attached_node": "model.CGOncology_MDM.mdm_customer_xref_hco_hist", "test_metadata": {"name": "accepted_values", "kwargs": {"values": ["Y", "N"], "column_name": "is_current", "model": "{{ get_where_subquery(ref('mdm_customer_xref_hco_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_mdm_customer_xref_hco_hist_kmk_hco_id__source_code__source_id__version_number.09dfa39014": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_utils_unique_combination_of_columns_mdm_customer_xref_hco_hist_kmk_hco_id__source_code__source_id__version_number", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_utils_unique_combination_o_77e5d8d0ecc8779ea1ca419c4c514550.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_mdm_customer_xref_hco_hist_kmk_hco_id__source_code__source_id__version_number.09dfa39014", "fqn": ["CGOncology_MDM", "mdm", "dbt_utils_unique_combination_of_columns_mdm_customer_xref_hco_hist_kmk_hco_id__source_code__source_id__version_number"], "alias": "dbt_utils_unique_combination_o_77e5d8d0ecc8779ea1ca419c4c514550", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_utils_unique_combination_o_77e5d8d0ecc8779ea1ca419c4c514550", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_77e5d8d0ecc8779ea1ca419c4c514550"}, "created_at": 1770177079.317735, "relation_name": null, "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_77e5d8d0ecc8779ea1ca419c4c514550\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_xref_hco_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_utils.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_xref_hco_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.mdm_customer_xref_hco_hist", "attached_node": "model.CGOncology_MDM.mdm_customer_xref_hco_hist", "test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["kmk_hco_id", "source_code", "source_id", "version_number"], "model": "{{ get_where_subquery(ref('mdm_customer_xref_hco_hist')) }}"}, "namespace": "dbt_utils"}}, "test.CGOncology_MDM.not_null_mdm_customer_xref_hcp_hist_kmk_hcp_id.7ec0ca69e8": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_mdm_customer_xref_hcp_hist_kmk_hcp_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_mdm_customer_xref_hcp_hist_kmk_hcp_id.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_mdm_customer_xref_hcp_hist_kmk_hcp_id.7ec0ca69e8", "fqn": ["CGOncology_MDM", "mdm", "not_null_mdm_customer_xref_hcp_hist_kmk_hcp_id"], "alias": "not_null_mdm_customer_xref_hcp_hist_kmk_hcp_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.319249, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_xref_hcp_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.mdm_customer_xref_hcp_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hcp_id", "file_key_name": "models.mdm_customer_xref_hcp_hist", "attached_node": "model.CGOncology_MDM.mdm_customer_xref_hcp_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "kmk_hcp_id", "model": "{{ get_where_subquery(ref('mdm_customer_xref_hcp_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_mdm_customer_xref_hcp_hist_version_number.f4744eacf4": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_mdm_customer_xref_hcp_hist_version_number", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_mdm_customer_xref_hcp_hist_version_number.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_mdm_customer_xref_hcp_hist_version_number.f4744eacf4", "fqn": ["CGOncology_MDM", "mdm", "not_null_mdm_customer_xref_hcp_hist_version_number"], "alias": "not_null_mdm_customer_xref_hcp_hist_version_number", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.319781, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_xref_hcp_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.mdm_customer_xref_hcp_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "version_number", "file_key_name": "models.mdm_customer_xref_hcp_hist", "attached_node": "model.CGOncology_MDM.mdm_customer_xref_hcp_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "version_number", "model": "{{ get_where_subquery(ref('mdm_customer_xref_hcp_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_mdm_customer_xref_hcp_hist_is_current__Y__N.1da3a07768": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_mdm_customer_xref_hcp_hist_is_current__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_mdm_customer_xref_hcp_hist_is_current__Y__N.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_mdm_customer_xref_hcp_hist_is_current__Y__N.1da3a07768", "fqn": ["CGOncology_MDM", "mdm", "accepted_values_mdm_customer_xref_hcp_hist_is_current__Y__N"], "alias": "accepted_values_mdm_customer_xref_hcp_hist_is_current__Y__N", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.3203049, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_xref_hcp_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_xref_hcp_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_current", "file_key_name": "models.mdm_customer_xref_hcp_hist", "attached_node": "model.CGOncology_MDM.mdm_customer_xref_hcp_hist", "test_metadata": {"name": "accepted_values", "kwargs": {"values": ["Y", "N"], "column_name": "is_current", "model": "{{ get_where_subquery(ref('mdm_customer_xref_hcp_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_mdm_customer_xref_hcp_hist_kmk_hcp_id__source_code__version_number.257291777b": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_utils_unique_combination_of_columns_mdm_customer_xref_hcp_hist_kmk_hcp_id__source_code__version_number", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_utils_unique_combination_o_7714028b3a89d25dc352725bdd8026fb.sql", "original_file_path": "models/mdm/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_mdm_customer_xref_hcp_hist_kmk_hcp_id__source_code__version_number.257291777b", "fqn": ["CGOncology_MDM", "mdm", "dbt_utils_unique_combination_of_columns_mdm_customer_xref_hcp_hist_kmk_hcp_id__source_code__version_number"], "alias": "dbt_utils_unique_combination_o_7714028b3a89d25dc352725bdd8026fb", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_utils_unique_combination_o_7714028b3a89d25dc352725bdd8026fb", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_7714028b3a89d25dc352725bdd8026fb"}, "created_at": 1770177079.321661, "relation_name": null, "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_7714028b3a89d25dc352725bdd8026fb\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_xref_hcp_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_utils.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_xref_hcp_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.mdm_customer_xref_hcp_hist", "attached_node": "model.CGOncology_MDM.mdm_customer_xref_hcp_hist", "test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["kmk_hcp_id", "source_code", "version_number"], "model": "{{ get_where_subquery(ref('mdm_customer_xref_hcp_hist')) }}"}, "namespace": "dbt_utils"}}, "test.CGOncology_MDM.not_null_match_ddd_dhc_DDD_OUTLET_ID.9431d55a7f": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_match_ddd_dhc_DDD_OUTLET_ID", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_match_ddd_dhc_DDD_OUTLET_ID.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_match_ddd_dhc_DDD_OUTLET_ID.9431d55a7f", "fqn": ["CGOncology_MDM", "staging", "not_null_match_ddd_dhc_DDD_OUTLET_ID"], "alias": "not_null_match_ddd_dhc_DDD_OUTLET_ID", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.32804, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "match_ddd_dhc", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.match_ddd_dhc"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "DDD_OUTLET_ID", "file_key_name": "models.match_ddd_dhc", "attached_node": "model.CGOncology_MDM.match_ddd_dhc", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "DDD_OUTLET_ID", "model": "{{ get_where_subquery(ref('match_ddd_dhc')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_match_ddd_dhc_DDD_OUTLET_ID.fcadb410cf": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_match_ddd_dhc_DDD_OUTLET_ID", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_match_ddd_dhc_DDD_OUTLET_ID.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.unique_match_ddd_dhc_DDD_OUTLET_ID.fcadb410cf", "fqn": ["CGOncology_MDM", "staging", "unique_match_ddd_dhc_DDD_OUTLET_ID"], "alias": "unique_match_ddd_dhc_DDD_OUTLET_ID", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.328583, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "match_ddd_dhc", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.CGOncology_MDM.match_ddd_dhc"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "DDD_OUTLET_ID", "file_key_name": "models.match_ddd_dhc", "attached_node": "model.CGOncology_MDM.match_ddd_dhc", "test_metadata": {"name": "unique", "kwargs": {"column_name": "DDD_OUTLET_ID", "model": "{{ get_where_subquery(ref('match_ddd_dhc')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_match_ddd_dhc_DDD_OUTLET_NAME.cf75f8fcd7": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_match_ddd_dhc_DDD_OUTLET_NAME", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_match_ddd_dhc_DDD_OUTLET_NAME.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_match_ddd_dhc_DDD_OUTLET_NAME.cf75f8fcd7", "fqn": ["CGOncology_MDM", "staging", "not_null_match_ddd_dhc_DDD_OUTLET_NAME"], "alias": "not_null_match_ddd_dhc_DDD_OUTLET_NAME", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.329076, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "match_ddd_dhc", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.match_ddd_dhc"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "DDD_OUTLET_NAME", "file_key_name": "models.match_ddd_dhc", "attached_node": "model.CGOncology_MDM.match_ddd_dhc", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "DDD_OUTLET_NAME", "model": "{{ get_where_subquery(ref('match_ddd_dhc')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_be_between_match_ddd_dhc_ADDRESS_MATCH_SCORE__100__0.59ba604c8c": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_column_values_to_be_between_match_ddd_dhc_ADDRESS_MATCH_SCORE__100__0", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_column_83cc4ac709eef3550e0ee62d6fd5049c.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_be_between_match_ddd_dhc_ADDRESS_MATCH_SCORE__100__0.59ba604c8c", "fqn": ["CGOncology_MDM", "staging", "dbt_expectations_expect_column_values_to_be_between_match_ddd_dhc_ADDRESS_MATCH_SCORE__100__0"], "alias": "dbt_expectations_expect_column_83cc4ac709eef3550e0ee62d6fd5049c", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_column_83cc4ac709eef3550e0ee62d6fd5049c", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": "ADDRESS_MATCH_SCORE IS NOT NULL", "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"where": "ADDRESS_MATCH_SCORE IS NOT NULL", "alias": "dbt_expectations_expect_column_83cc4ac709eef3550e0ee62d6fd5049c"}, "created_at": 1770177079.32959, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_column_values_to_be_between(**_dbt_generic_test_kwargs) }}{{ config(where=\"ADDRESS_MATCH_SCORE IS NOT NULL\",alias=\"dbt_expectations_expect_column_83cc4ac709eef3550e0ee62d6fd5049c\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "match_ddd_dhc", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_column_values_to_be_between", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.match_ddd_dhc"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "ADDRESS_MATCH_SCORE", "file_key_name": "models.match_ddd_dhc", "attached_node": "model.CGOncology_MDM.match_ddd_dhc", "test_metadata": {"name": "expect_column_values_to_be_between", "kwargs": {"column_name": "ADDRESS_MATCH_SCORE", "min_value": 0, "max_value": 100, "model": "{{ get_where_subquery(ref('match_ddd_dhc')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_be_between_match_ddd_dhc_NAME_MATCH_SCORE__100__0.ba2d1026eb": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_column_values_to_be_between_match_ddd_dhc_NAME_MATCH_SCORE__100__0", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_column_b0b974e739d5d4df321b9b1817d55ce5.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_be_between_match_ddd_dhc_NAME_MATCH_SCORE__100__0.ba2d1026eb", "fqn": ["CGOncology_MDM", "staging", "dbt_expectations_expect_column_values_to_be_between_match_ddd_dhc_NAME_MATCH_SCORE__100__0"], "alias": "dbt_expectations_expect_column_b0b974e739d5d4df321b9b1817d55ce5", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_column_b0b974e739d5d4df321b9b1817d55ce5", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": "NAME_MATCH_SCORE IS NOT NULL", "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"where": "NAME_MATCH_SCORE IS NOT NULL", "alias": "dbt_expectations_expect_column_b0b974e739d5d4df321b9b1817d55ce5"}, "created_at": 1770177079.3313549, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_column_values_to_be_between(**_dbt_generic_test_kwargs) }}{{ config(where=\"NAME_MATCH_SCORE IS NOT NULL\",alias=\"dbt_expectations_expect_column_b0b974e739d5d4df321b9b1817d55ce5\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "match_ddd_dhc", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_column_values_to_be_between", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.match_ddd_dhc"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "NAME_MATCH_SCORE", "file_key_name": "models.match_ddd_dhc", "attached_node": "model.CGOncology_MDM.match_ddd_dhc", "test_metadata": {"name": "expect_column_values_to_be_between", "kwargs": {"column_name": "NAME_MATCH_SCORE", "min_value": 0, "max_value": 100, "model": "{{ get_where_subquery(ref('match_ddd_dhc')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.accepted_values_match_ddd_dhc_MATCH_BUCKET__0__1__2__3__4.a27fe795cf": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_match_ddd_dhc_MATCH_BUCKET__0__1__2__3__4", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_match_ddd_dhc_MATCH_BUCKET__0__1__2__3__4.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_match_ddd_dhc_MATCH_BUCKET__0__1__2__3__4.a27fe795cf", "fqn": ["CGOncology_MDM", "staging", "accepted_values_match_ddd_dhc_MATCH_BUCKET__0__1__2__3__4"], "alias": "accepted_values_match_ddd_dhc_MATCH_BUCKET__0__1__2__3__4", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": "MATCH_BUCKET IS NOT NULL", "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"where": "MATCH_BUCKET IS NOT NULL"}, "created_at": 1770177079.333218, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(where=\"MATCH_BUCKET IS NOT NULL\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "match_ddd_dhc", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.match_ddd_dhc"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "MATCH_BUCKET", "file_key_name": "models.match_ddd_dhc", "attached_node": "model.CGOncology_MDM.match_ddd_dhc", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "MATCH_BUCKET", "values": ["0", "1", "2", "3", "4"], "model": "{{ get_where_subquery(ref('match_ddd_dhc')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_match_ddd_dhc_MATCH_STEP__0__1__2__3__4.029afef2fa": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_match_ddd_dhc_MATCH_STEP__0__1__2__3__4", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_match_ddd_dhc_MATCH_STEP__0__1__2__3__4.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_match_ddd_dhc_MATCH_STEP__0__1__2__3__4.029afef2fa", "fqn": ["CGOncology_MDM", "staging", "accepted_values_match_ddd_dhc_MATCH_STEP__0__1__2__3__4"], "alias": "accepted_values_match_ddd_dhc_MATCH_STEP__0__1__2__3__4", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": "MATCH_STEP IS NOT NULL", "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"where": "MATCH_STEP IS NOT NULL"}, "created_at": 1770177079.334847, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(where=\"MATCH_STEP IS NOT NULL\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "match_ddd_dhc", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.match_ddd_dhc"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "MATCH_STEP", "file_key_name": "models.match_ddd_dhc", "attached_node": "model.CGOncology_MDM.match_ddd_dhc", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "MATCH_STEP", "values": ["0", "1", "2", "3", "4"], "model": "{{ get_where_subquery(ref('match_ddd_dhc')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_match_ddd_dhc_DHC_MATCH_SOURCE__Practice_Location__HQ_Location__City_State_Fallback__Medscout_Bridge__DH_Matching_Return__Legacy_History__XREF_History.e46667f474": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_match_ddd_dhc_DHC_MATCH_SOURCE__Practice_Location__HQ_Location__City_State_Fallback__Medscout_Bridge__DH_Matching_Return__Legacy_History__XREF_History", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_match_ddd_dhc_f39f41793414a46e0e282b482e50a558.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_match_ddd_dhc_DHC_MATCH_SOURCE__Practice_Location__HQ_Location__City_State_Fallback__Medscout_Bridge__DH_Matching_Return__Legacy_History__XREF_History.e46667f474", "fqn": ["CGOncology_MDM", "staging", "accepted_values_match_ddd_dhc_DHC_MATCH_SOURCE__Practice_Location__HQ_Location__City_State_Fallback__Medscout_Bridge__DH_Matching_Return__Legacy_History__XREF_History"], "alias": "accepted_values_match_ddd_dhc_f39f41793414a46e0e282b482e50a558", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_match_ddd_dhc_f39f41793414a46e0e282b482e50a558", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": "DHC_MATCH_SOURCE IS NOT NULL", "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"where": "DHC_MATCH_SOURCE IS NOT NULL", "alias": "accepted_values_match_ddd_dhc_f39f41793414a46e0e282b482e50a558"}, "created_at": 1770177079.336308, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(where=\"DHC_MATCH_SOURCE IS NOT NULL\",alias=\"accepted_values_match_ddd_dhc_f39f41793414a46e0e282b482e50a558\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "match_ddd_dhc", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.match_ddd_dhc"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "DHC_MATCH_SOURCE", "file_key_name": "models.match_ddd_dhc", "attached_node": "model.CGOncology_MDM.match_ddd_dhc", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "DHC_MATCH_SOURCE", "values": ["Practice Location", "HQ Location", "City+State Fallback", "Medscout Bridge", "DH Matching Return", "Legacy History", "XREF History"], "model": "{{ get_where_subquery(ref('match_ddd_dhc')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_match_ddd_dhc_MATCH_STATUS.50e40ba959": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_match_ddd_dhc_MATCH_STATUS", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_match_ddd_dhc_MATCH_STATUS.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_match_ddd_dhc_MATCH_STATUS.50e40ba959", "fqn": ["CGOncology_MDM", "staging", "not_null_match_ddd_dhc_MATCH_STATUS"], "alias": "not_null_match_ddd_dhc_MATCH_STATUS", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.3377018, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "match_ddd_dhc", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.match_ddd_dhc"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "MATCH_STATUS", "file_key_name": "models.match_ddd_dhc", "attached_node": "model.CGOncology_MDM.match_ddd_dhc", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "MATCH_STATUS", "model": "{{ get_where_subquery(ref('match_ddd_dhc')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_match_ddd_dhc_MATCH_STATUS__MATCHED__UNMATCHED.623af1049a": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_match_ddd_dhc_MATCH_STATUS__MATCHED__UNMATCHED", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_match_ddd_dhc_MATCH_STATUS__MATCHED__UNMATCHED.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_match_ddd_dhc_MATCH_STATUS__MATCHED__UNMATCHED.623af1049a", "fqn": ["CGOncology_MDM", "staging", "accepted_values_match_ddd_dhc_MATCH_STATUS__MATCHED__UNMATCHED"], "alias": "accepted_values_match_ddd_dhc_MATCH_STATUS__MATCHED__UNMATCHED", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.338219, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "match_ddd_dhc", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.match_ddd_dhc"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "MATCH_STATUS", "file_key_name": "models.match_ddd_dhc", "attached_node": "model.CGOncology_MDM.match_ddd_dhc", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "MATCH_STATUS", "values": ["MATCHED", "UNMATCHED"], "model": "{{ get_where_subquery(ref('match_ddd_dhc')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_match_ddd_dhc_CONFIDENCE_LEVEL__HIGH__MEDIUM__STEWARD__HISTORICAL.690cc051c1": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_match_ddd_dhc_CONFIDENCE_LEVEL__HIGH__MEDIUM__STEWARD__HISTORICAL", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_match_ddd_dhc_a2e536610ef000824cb4e36b97c85263.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_match_ddd_dhc_CONFIDENCE_LEVEL__HIGH__MEDIUM__STEWARD__HISTORICAL.690cc051c1", "fqn": ["CGOncology_MDM", "staging", "accepted_values_match_ddd_dhc_CONFIDENCE_LEVEL__HIGH__MEDIUM__STEWARD__HISTORICAL"], "alias": "accepted_values_match_ddd_dhc_a2e536610ef000824cb4e36b97c85263", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_match_ddd_dhc_a2e536610ef000824cb4e36b97c85263", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": "CONFIDENCE_LEVEL IS NOT NULL", "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"where": "CONFIDENCE_LEVEL IS NOT NULL", "alias": "accepted_values_match_ddd_dhc_a2e536610ef000824cb4e36b97c85263"}, "created_at": 1770177079.3398259, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(where=\"CONFIDENCE_LEVEL IS NOT NULL\",alias=\"accepted_values_match_ddd_dhc_a2e536610ef000824cb4e36b97c85263\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "match_ddd_dhc", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.match_ddd_dhc"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "CONFIDENCE_LEVEL", "file_key_name": "models.match_ddd_dhc", "attached_node": "model.CGOncology_MDM.match_ddd_dhc", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "CONFIDENCE_LEVEL", "values": ["HIGH", "MEDIUM", "STEWARD", "HISTORICAL"], "model": "{{ get_where_subquery(ref('match_ddd_dhc')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_match_ddd_dhc_IS_HISTORICAL_MATCH.d9bf2310fd": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_match_ddd_dhc_IS_HISTORICAL_MATCH", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_match_ddd_dhc_IS_HISTORICAL_MATCH.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_match_ddd_dhc_IS_HISTORICAL_MATCH.d9bf2310fd", "fqn": ["CGOncology_MDM", "staging", "not_null_match_ddd_dhc_IS_HISTORICAL_MATCH"], "alias": "not_null_match_ddd_dhc_IS_HISTORICAL_MATCH", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.3411012, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "match_ddd_dhc", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.match_ddd_dhc"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "IS_HISTORICAL_MATCH", "file_key_name": "models.match_ddd_dhc", "attached_node": "model.CGOncology_MDM.match_ddd_dhc", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "IS_HISTORICAL_MATCH", "model": "{{ get_where_subquery(ref('match_ddd_dhc')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_match_ddd_dhc_IS_DELTA.14815dedb4": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_match_ddd_dhc_IS_DELTA", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_match_ddd_dhc_IS_DELTA.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_match_ddd_dhc_IS_DELTA.14815dedb4", "fqn": ["CGOncology_MDM", "staging", "not_null_match_ddd_dhc_IS_DELTA"], "alias": "not_null_match_ddd_dhc_IS_DELTA", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.341602, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "match_ddd_dhc", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.match_ddd_dhc"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "IS_DELTA", "file_key_name": "models.match_ddd_dhc", "attached_node": "model.CGOncology_MDM.match_ddd_dhc", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "IS_DELTA", "model": "{{ get_where_subquery(ref('match_ddd_dhc')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_match_medscout_dhc_hcp_MEDSCOUT_ID.f3c6209b8f": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_match_medscout_dhc_hcp_MEDSCOUT_ID", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_match_medscout_dhc_hcp_MEDSCOUT_ID.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_match_medscout_dhc_hcp_MEDSCOUT_ID.f3c6209b8f", "fqn": ["CGOncology_MDM", "staging", "not_null_match_medscout_dhc_hcp_MEDSCOUT_ID"], "alias": "not_null_match_medscout_dhc_hcp_MEDSCOUT_ID", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.3421068, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "match_medscout_dhc_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.match_medscout_dhc_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "MEDSCOUT_ID", "file_key_name": "models.match_medscout_dhc_hcp", "attached_node": "model.CGOncology_MDM.match_medscout_dhc_hcp", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "MEDSCOUT_ID", "model": "{{ get_where_subquery(ref('match_medscout_dhc_hcp')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_match_medscout_dhc_hcp_MEDSCOUT_ID.a4ddb83f70": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_match_medscout_dhc_hcp_MEDSCOUT_ID", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_match_medscout_dhc_hcp_MEDSCOUT_ID.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.unique_match_medscout_dhc_hcp_MEDSCOUT_ID.a4ddb83f70", "fqn": ["CGOncology_MDM", "staging", "unique_match_medscout_dhc_hcp_MEDSCOUT_ID"], "alias": "unique_match_medscout_dhc_hcp_MEDSCOUT_ID", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.342604, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "match_medscout_dhc_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.CGOncology_MDM.match_medscout_dhc_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "MEDSCOUT_ID", "file_key_name": "models.match_medscout_dhc_hcp", "attached_node": "model.CGOncology_MDM.match_medscout_dhc_hcp", "test_metadata": {"name": "unique", "kwargs": {"column_name": "MEDSCOUT_ID", "model": "{{ get_where_subquery(ref('match_medscout_dhc_hcp')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_match_medscout_dhc_hcp_NPI.1d48ccd718": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_match_medscout_dhc_hcp_NPI", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_match_medscout_dhc_hcp_NPI.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_match_medscout_dhc_hcp_NPI.1d48ccd718", "fqn": ["CGOncology_MDM", "staging", "not_null_match_medscout_dhc_hcp_NPI"], "alias": "not_null_match_medscout_dhc_hcp_NPI", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.343105, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "match_medscout_dhc_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.match_medscout_dhc_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "NPI", "file_key_name": "models.match_medscout_dhc_hcp", "attached_node": "model.CGOncology_MDM.match_medscout_dhc_hcp", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "NPI", "model": "{{ get_where_subquery(ref('match_medscout_dhc_hcp')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_match_medscout_dhc_hcp_MATCH_TYPE__NPI_EXACT.b0e6786039": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_match_medscout_dhc_hcp_MATCH_TYPE__NPI_EXACT", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_match_medscout_dhc_hcp_MATCH_TYPE__NPI_EXACT.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_match_medscout_dhc_hcp_MATCH_TYPE__NPI_EXACT.b0e6786039", "fqn": ["CGOncology_MDM", "staging", "accepted_values_match_medscout_dhc_hcp_MATCH_TYPE__NPI_EXACT"], "alias": "accepted_values_match_medscout_dhc_hcp_MATCH_TYPE__NPI_EXACT", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": "MATCH_TYPE IS NOT NULL", "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"where": "MATCH_TYPE IS NOT NULL"}, "created_at": 1770177079.343615, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(where=\"MATCH_TYPE IS NOT NULL\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "match_medscout_dhc_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.match_medscout_dhc_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "MATCH_TYPE", "file_key_name": "models.match_medscout_dhc_hcp", "attached_node": "model.CGOncology_MDM.match_medscout_dhc_hcp", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "MATCH_TYPE", "values": ["NPI_EXACT"], "model": "{{ get_where_subquery(ref('match_medscout_dhc_hcp')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_match_medscout_dhc_hcp_MATCH_STATUS.58d977e8e9": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_match_medscout_dhc_hcp_MATCH_STATUS", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_match_medscout_dhc_hcp_MATCH_STATUS.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_match_medscout_dhc_hcp_MATCH_STATUS.58d977e8e9", "fqn": ["CGOncology_MDM", "staging", "not_null_match_medscout_dhc_hcp_MATCH_STATUS"], "alias": "not_null_match_medscout_dhc_hcp_MATCH_STATUS", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.344897, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "match_medscout_dhc_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.match_medscout_dhc_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "MATCH_STATUS", "file_key_name": "models.match_medscout_dhc_hcp", "attached_node": "model.CGOncology_MDM.match_medscout_dhc_hcp", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "MATCH_STATUS", "model": "{{ get_where_subquery(ref('match_medscout_dhc_hcp')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_match_medscout_dhc_hcp_MATCH_STATUS__MATCHED__UNMATCHED.b9609b5d31": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_match_medscout_dhc_hcp_MATCH_STATUS__MATCHED__UNMATCHED", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_match_medscout_14bbd303dc490c90438559b3a855c2b5.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_match_medscout_dhc_hcp_MATCH_STATUS__MATCHED__UNMATCHED.b9609b5d31", "fqn": ["CGOncology_MDM", "staging", "accepted_values_match_medscout_dhc_hcp_MATCH_STATUS__MATCHED__UNMATCHED"], "alias": "accepted_values_match_medscout_14bbd303dc490c90438559b3a855c2b5", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_match_medscout_14bbd303dc490c90438559b3a855c2b5", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_match_medscout_14bbd303dc490c90438559b3a855c2b5"}, "created_at": 1770177079.345406, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_match_medscout_14bbd303dc490c90438559b3a855c2b5\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "match_medscout_dhc_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.match_medscout_dhc_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "MATCH_STATUS", "file_key_name": "models.match_medscout_dhc_hcp", "attached_node": "model.CGOncology_MDM.match_medscout_dhc_hcp", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "MATCH_STATUS", "values": ["MATCHED", "UNMATCHED"], "model": "{{ get_where_subquery(ref('match_medscout_dhc_hcp')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_match_medscout_dhc_hcp_IS_DELTA.62a95babd1": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_match_medscout_dhc_hcp_IS_DELTA", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_match_medscout_dhc_hcp_IS_DELTA.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_match_medscout_dhc_hcp_IS_DELTA.62a95babd1", "fqn": ["CGOncology_MDM", "staging", "not_null_match_medscout_dhc_hcp_IS_DELTA"], "alias": "not_null_match_medscout_dhc_hcp_IS_DELTA", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.347214, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "match_medscout_dhc_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.match_medscout_dhc_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "IS_DELTA", "file_key_name": "models.match_medscout_dhc_hcp", "attached_node": "model.CGOncology_MDM.match_medscout_dhc_hcp", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "IS_DELTA", "model": "{{ get_where_subquery(ref('match_medscout_dhc_hcp')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_match_medscout_dhc_hcp_IS_HISTORICAL_MATCH.e1fe9b7c05": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_match_medscout_dhc_hcp_IS_HISTORICAL_MATCH", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_match_medscout_dhc_hcp_IS_HISTORICAL_MATCH.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_match_medscout_dhc_hcp_IS_HISTORICAL_MATCH.e1fe9b7c05", "fqn": ["CGOncology_MDM", "staging", "not_null_match_medscout_dhc_hcp_IS_HISTORICAL_MATCH"], "alias": "not_null_match_medscout_dhc_hcp_IS_HISTORICAL_MATCH", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.34774, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "match_medscout_dhc_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.match_medscout_dhc_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "IS_HISTORICAL_MATCH", "file_key_name": "models.match_medscout_dhc_hcp", "attached_node": "model.CGOncology_MDM.match_medscout_dhc_hcp", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "IS_HISTORICAL_MATCH", "model": "{{ get_where_subquery(ref('match_medscout_dhc_hcp')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_match_medscout_dhc_hcp_MATCH_DATE.132412ad64": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_match_medscout_dhc_hcp_MATCH_DATE", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_match_medscout_dhc_hcp_MATCH_DATE.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_match_medscout_dhc_hcp_MATCH_DATE.132412ad64", "fqn": ["CGOncology_MDM", "staging", "not_null_match_medscout_dhc_hcp_MATCH_DATE"], "alias": "not_null_match_medscout_dhc_hcp_MATCH_DATE", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.348293, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "match_medscout_dhc_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.match_medscout_dhc_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "MATCH_DATE", "file_key_name": "models.match_medscout_dhc_hcp", "attached_node": "model.CGOncology_MDM.match_medscout_dhc_hcp", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "MATCH_DATE", "model": "{{ get_where_subquery(ref('match_medscout_dhc_hcp')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_bc_patient_pool_PATIENT_ID.d047ac8e90": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_bc_patient_pool_PATIENT_ID", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_bc_patient_pool_PATIENT_ID.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_bc_patient_pool_PATIENT_ID.d047ac8e90", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_bc_patient_pool_PATIENT_ID"], "alias": "not_null_stg_bc_patient_pool_PATIENT_ID", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.3488, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_bc_patient_pool", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_bc_patient_pool"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "PATIENT_ID", "file_key_name": "models.stg_bc_patient_pool", "attached_node": "model.CGOncology_MDM.stg_bc_patient_pool", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "PATIENT_ID", "model": "{{ get_where_subquery(ref('stg_bc_patient_pool')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_stg_bc_patient_pool_PATIENT_ID.38ad9d6549": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_stg_bc_patient_pool_PATIENT_ID", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_stg_bc_patient_pool_PATIENT_ID.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.unique_stg_bc_patient_pool_PATIENT_ID.38ad9d6549", "fqn": ["CGOncology_MDM", "staging", "unique_stg_bc_patient_pool_PATIENT_ID"], "alias": "unique_stg_bc_patient_pool_PATIENT_ID", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.3492858, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_bc_patient_pool", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.CGOncology_MDM.stg_bc_patient_pool"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "PATIENT_ID", "file_key_name": "models.stg_bc_patient_pool", "attached_node": "model.CGOncology_MDM.stg_bc_patient_pool", "test_metadata": {"name": "unique", "kwargs": {"column_name": "PATIENT_ID", "model": "{{ get_where_subquery(ref('stg_bc_patient_pool')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_bc_patient_pool_IDENTIFIED_VIA_DX.259ef11f32": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_bc_patient_pool_IDENTIFIED_VIA_DX", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_bc_patient_pool_IDENTIFIED_VIA_DX.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_bc_patient_pool_IDENTIFIED_VIA_DX.259ef11f32", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_bc_patient_pool_IDENTIFIED_VIA_DX"], "alias": "not_null_stg_bc_patient_pool_IDENTIFIED_VIA_DX", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.349768, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_bc_patient_pool", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_bc_patient_pool"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "IDENTIFIED_VIA_DX", "file_key_name": "models.stg_bc_patient_pool", "attached_node": "model.CGOncology_MDM.stg_bc_patient_pool", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "IDENTIFIED_VIA_DX", "model": "{{ get_where_subquery(ref('stg_bc_patient_pool')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_stg_bc_patient_pool_IDENTIFIED_VIA_DX__Y__N.1ee43ae670": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_stg_bc_patient_pool_IDENTIFIED_VIA_DX__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_stg_bc_patient_pool_IDENTIFIED_VIA_DX__Y__N.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_stg_bc_patient_pool_IDENTIFIED_VIA_DX__Y__N.1ee43ae670", "fqn": ["CGOncology_MDM", "staging", "accepted_values_stg_bc_patient_pool_IDENTIFIED_VIA_DX__Y__N"], "alias": "accepted_values_stg_bc_patient_pool_IDENTIFIED_VIA_DX__Y__N", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.350261, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_bc_patient_pool", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.stg_bc_patient_pool"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "IDENTIFIED_VIA_DX", "file_key_name": "models.stg_bc_patient_pool", "attached_node": "model.CGOncology_MDM.stg_bc_patient_pool", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "IDENTIFIED_VIA_DX", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('stg_bc_patient_pool')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_bc_patient_pool_IDENTIFIED_VIA_PX.3936f0c36d": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_bc_patient_pool_IDENTIFIED_VIA_PX", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_bc_patient_pool_IDENTIFIED_VIA_PX.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_bc_patient_pool_IDENTIFIED_VIA_PX.3936f0c36d", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_bc_patient_pool_IDENTIFIED_VIA_PX"], "alias": "not_null_stg_bc_patient_pool_IDENTIFIED_VIA_PX", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.351469, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_bc_patient_pool", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_bc_patient_pool"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "IDENTIFIED_VIA_PX", "file_key_name": "models.stg_bc_patient_pool", "attached_node": "model.CGOncology_MDM.stg_bc_patient_pool", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "IDENTIFIED_VIA_PX", "model": "{{ get_where_subquery(ref('stg_bc_patient_pool')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_stg_bc_patient_pool_IDENTIFIED_VIA_PX__Y__N.70b904dc00": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_stg_bc_patient_pool_IDENTIFIED_VIA_PX__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_stg_bc_patient_pool_IDENTIFIED_VIA_PX__Y__N.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_stg_bc_patient_pool_IDENTIFIED_VIA_PX__Y__N.70b904dc00", "fqn": ["CGOncology_MDM", "staging", "accepted_values_stg_bc_patient_pool_IDENTIFIED_VIA_PX__Y__N"], "alias": "accepted_values_stg_bc_patient_pool_IDENTIFIED_VIA_PX__Y__N", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.351964, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_bc_patient_pool", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.stg_bc_patient_pool"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "IDENTIFIED_VIA_PX", "file_key_name": "models.stg_bc_patient_pool", "attached_node": "model.CGOncology_MDM.stg_bc_patient_pool", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "IDENTIFIED_VIA_PX", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('stg_bc_patient_pool')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_bc_patient_pool_IDENTIFIED_VIA_RX.a4f6073e8a": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_bc_patient_pool_IDENTIFIED_VIA_RX", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_bc_patient_pool_IDENTIFIED_VIA_RX.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_bc_patient_pool_IDENTIFIED_VIA_RX.a4f6073e8a", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_bc_patient_pool_IDENTIFIED_VIA_RX"], "alias": "not_null_stg_bc_patient_pool_IDENTIFIED_VIA_RX", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.3530948, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_bc_patient_pool", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_bc_patient_pool"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "IDENTIFIED_VIA_RX", "file_key_name": "models.stg_bc_patient_pool", "attached_node": "model.CGOncology_MDM.stg_bc_patient_pool", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "IDENTIFIED_VIA_RX", "model": "{{ get_where_subquery(ref('stg_bc_patient_pool')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_stg_bc_patient_pool_IDENTIFIED_VIA_RX__Y__N.c11d1877c2": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_stg_bc_patient_pool_IDENTIFIED_VIA_RX__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_stg_bc_patient_pool_IDENTIFIED_VIA_RX__Y__N.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_stg_bc_patient_pool_IDENTIFIED_VIA_RX__Y__N.c11d1877c2", "fqn": ["CGOncology_MDM", "staging", "accepted_values_stg_bc_patient_pool_IDENTIFIED_VIA_RX__Y__N"], "alias": "accepted_values_stg_bc_patient_pool_IDENTIFIED_VIA_RX__Y__N", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.353855, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_bc_patient_pool", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.stg_bc_patient_pool"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "IDENTIFIED_VIA_RX", "file_key_name": "models.stg_bc_patient_pool", "attached_node": "model.CGOncology_MDM.stg_bc_patient_pool", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "IDENTIFIED_VIA_RX", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('stg_bc_patient_pool')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_bc_patient_pool_IDENTIFICATION_PATHWAY_COUNT.3ed02c7eac": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_bc_patient_pool_IDENTIFICATION_PATHWAY_COUNT", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_bc_patient_pool_IDENTIFICATION_PATHWAY_COUNT.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_bc_patient_pool_IDENTIFICATION_PATHWAY_COUNT.3ed02c7eac", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_bc_patient_pool_IDENTIFICATION_PATHWAY_COUNT"], "alias": "not_null_stg_bc_patient_pool_IDENTIFICATION_PATHWAY_COUNT", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.3550022, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_bc_patient_pool", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_bc_patient_pool"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "IDENTIFICATION_PATHWAY_COUNT", "file_key_name": "models.stg_bc_patient_pool", "attached_node": "model.CGOncology_MDM.stg_bc_patient_pool", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "IDENTIFICATION_PATHWAY_COUNT", "model": "{{ get_where_subquery(ref('stg_bc_patient_pool')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_stg_bc_patient_pool_IDENTIFICATION_PATHWAY_COUNT__1__2__3.59434ca4f4": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_stg_bc_patient_pool_IDENTIFICATION_PATHWAY_COUNT__1__2__3", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_stg_bc_patient_03114e94d8331ba6488d546f313dd872.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_stg_bc_patient_pool_IDENTIFICATION_PATHWAY_COUNT__1__2__3.59434ca4f4", "fqn": ["CGOncology_MDM", "staging", "accepted_values_stg_bc_patient_pool_IDENTIFICATION_PATHWAY_COUNT__1__2__3"], "alias": "accepted_values_stg_bc_patient_03114e94d8331ba6488d546f313dd872", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_stg_bc_patient_03114e94d8331ba6488d546f313dd872", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_stg_bc_patient_03114e94d8331ba6488d546f313dd872"}, "created_at": 1770177079.355519, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_stg_bc_patient_03114e94d8331ba6488d546f313dd872\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_bc_patient_pool", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.stg_bc_patient_pool"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "IDENTIFICATION_PATHWAY_COUNT", "file_key_name": "models.stg_bc_patient_pool", "attached_node": "model.CGOncology_MDM.stg_bc_patient_pool", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "IDENTIFICATION_PATHWAY_COUNT", "values": [1, 2, 3], "model": "{{ get_where_subquery(ref('stg_bc_patient_pool')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_bc_patient_pool_EARLIEST_BC_EVENT_DATE.1d286cde6b": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_bc_patient_pool_EARLIEST_BC_EVENT_DATE", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_bc_patient_pool_EARLIEST_BC_EVENT_DATE.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_bc_patient_pool_EARLIEST_BC_EVENT_DATE.1d286cde6b", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_bc_patient_pool_EARLIEST_BC_EVENT_DATE"], "alias": "not_null_stg_bc_patient_pool_EARLIEST_BC_EVENT_DATE", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.356812, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_bc_patient_pool", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_bc_patient_pool"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "EARLIEST_BC_EVENT_DATE", "file_key_name": "models.stg_bc_patient_pool", "attached_node": "model.CGOncology_MDM.stg_bc_patient_pool", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "EARLIEST_BC_EVENT_DATE", "model": "{{ get_where_subquery(ref('stg_bc_patient_pool')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_bc_patient_pool_LATEST_BC_EVENT_DATE.f0a01e8ad2": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_bc_patient_pool_LATEST_BC_EVENT_DATE", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_bc_patient_pool_LATEST_BC_EVENT_DATE.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_bc_patient_pool_LATEST_BC_EVENT_DATE.f0a01e8ad2", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_bc_patient_pool_LATEST_BC_EVENT_DATE"], "alias": "not_null_stg_bc_patient_pool_LATEST_BC_EVENT_DATE", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.3573089, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_bc_patient_pool", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_bc_patient_pool"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "LATEST_BC_EVENT_DATE", "file_key_name": "models.stg_bc_patient_pool", "attached_node": "model.CGOncology_MDM.stg_bc_patient_pool", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "LATEST_BC_EVENT_DATE", "model": "{{ get_where_subquery(ref('stg_bc_patient_pool')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_bc_patient_pool_TOTAL_BC_CLAIM_COUNT.256c214c05": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_bc_patient_pool_TOTAL_BC_CLAIM_COUNT", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_bc_patient_pool_TOTAL_BC_CLAIM_COUNT.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_bc_patient_pool_TOTAL_BC_CLAIM_COUNT.256c214c05", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_bc_patient_pool_TOTAL_BC_CLAIM_COUNT"], "alias": "not_null_stg_bc_patient_pool_TOTAL_BC_CLAIM_COUNT", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.357811, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_bc_patient_pool", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_bc_patient_pool"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "TOTAL_BC_CLAIM_COUNT", "file_key_name": "models.stg_bc_patient_pool", "attached_node": "model.CGOncology_MDM.stg_bc_patient_pool", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "TOTAL_BC_CLAIM_COUNT", "model": "{{ get_where_subquery(ref('stg_bc_patient_pool')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_stg_bc_patient_pool_PATIENT_GENDER__M__F__U__X.2f60f286c0": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_stg_bc_patient_pool_PATIENT_GENDER__M__F__U__X", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_stg_bc_patient_pool_PATIENT_GENDER__M__F__U__X.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_stg_bc_patient_pool_PATIENT_GENDER__M__F__U__X.2f60f286c0", "fqn": ["CGOncology_MDM", "staging", "accepted_values_stg_bc_patient_pool_PATIENT_GENDER__M__F__U__X"], "alias": "accepted_values_stg_bc_patient_pool_PATIENT_GENDER__M__F__U__X", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": "PATIENT_GENDER IS NOT NULL", "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"where": "PATIENT_GENDER IS NOT NULL"}, "created_at": 1770177079.358329, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(where=\"PATIENT_GENDER IS NOT NULL\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_bc_patient_pool", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.stg_bc_patient_pool"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "PATIENT_GENDER", "file_key_name": "models.stg_bc_patient_pool", "attached_node": "model.CGOncology_MDM.stg_bc_patient_pool", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "PATIENT_GENDER", "values": ["M", "F", "U", "X"], "model": "{{ get_where_subquery(ref('stg_bc_patient_pool')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_hcp_hco_claims_PATIENT_ID.9a0bcf8302": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_hcp_hco_claims_PATIENT_ID", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_hcp_hco_claims_PATIENT_ID.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_hcp_hco_claims_PATIENT_ID.9a0bcf8302", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_hcp_hco_claims_PATIENT_ID"], "alias": "not_null_stg_hcp_hco_claims_PATIENT_ID", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.359642, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_hco_claims", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_hcp_hco_claims"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "PATIENT_ID", "file_key_name": "models.stg_hcp_hco_claims", "attached_node": "model.CGOncology_MDM.stg_hcp_hco_claims", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "PATIENT_ID", "model": "{{ get_where_subquery(ref('stg_hcp_hco_claims')) }}"}, "namespace": null}}, "test.CGOncology_MDM.relationships_stg_hcp_hco_claims_PATIENT_ID__PATIENT_ID__ref_stg_bc_patient_pool_.8c28be3c10": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "relationships_stg_hcp_hco_claims_PATIENT_ID__PATIENT_ID__ref_stg_bc_patient_pool_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "relationships_stg_hcp_hco_clai_aabac3330e043ac658944298be4b1e40.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.relationships_stg_hcp_hco_claims_PATIENT_ID__PATIENT_ID__ref_stg_bc_patient_pool_.8c28be3c10", "fqn": ["CGOncology_MDM", "staging", "relationships_stg_hcp_hco_claims_PATIENT_ID__PATIENT_ID__ref_stg_bc_patient_pool_"], "alias": "relationships_stg_hcp_hco_clai_aabac3330e043ac658944298be4b1e40", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "relationships_stg_hcp_hco_clai_aabac3330e043ac658944298be4b1e40", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "relationships_stg_hcp_hco_clai_aabac3330e043ac658944298be4b1e40"}, "created_at": 1770177079.3601432, "relation_name": null, "raw_code": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_stg_hcp_hco_clai_aabac3330e043ac658944298be4b1e40\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_bc_patient_pool", "package": null, "version": null}, {"name": "stg_hcp_hco_claims", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.stg_bc_patient_pool", "model.CGOncology_MDM.stg_hcp_hco_claims"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "PATIENT_ID", "file_key_name": "models.stg_hcp_hco_claims", "attached_node": "model.CGOncology_MDM.stg_hcp_hco_claims", "test_metadata": {"name": "relationships", "kwargs": {"to": "ref('stg_bc_patient_pool')", "field": "PATIENT_ID", "column_name": "PATIENT_ID", "model": "{{ get_where_subquery(ref('stg_hcp_hco_claims')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_hcp_hco_claims_SERVICE_DATE.3a3afd17c5": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_hcp_hco_claims_SERVICE_DATE", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_hcp_hco_claims_SERVICE_DATE.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_hcp_hco_claims_SERVICE_DATE.3a3afd17c5", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_hcp_hco_claims_SERVICE_DATE"], "alias": "not_null_stg_hcp_hco_claims_SERVICE_DATE", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.36186, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_hco_claims", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_hcp_hco_claims"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "SERVICE_DATE", "file_key_name": "models.stg_hcp_hco_claims", "attached_node": "model.CGOncology_MDM.stg_hcp_hco_claims", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "SERVICE_DATE", "model": "{{ get_where_subquery(ref('stg_hcp_hco_claims')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_hcp_hco_claims_CLAIM_TYPE.2672d69539": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_hcp_hco_claims_CLAIM_TYPE", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_hcp_hco_claims_CLAIM_TYPE.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_hcp_hco_claims_CLAIM_TYPE.2672d69539", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_hcp_hco_claims_CLAIM_TYPE"], "alias": "not_null_stg_hcp_hco_claims_CLAIM_TYPE", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.3623538, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_hco_claims", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_hcp_hco_claims"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "CLAIM_TYPE", "file_key_name": "models.stg_hcp_hco_claims", "attached_node": "model.CGOncology_MDM.stg_hcp_hco_claims", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "CLAIM_TYPE", "model": "{{ get_where_subquery(ref('stg_hcp_hco_claims')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_stg_hcp_hco_claims_CLAIM_TYPE__DX__PX__RX.183fef863b": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_stg_hcp_hco_claims_CLAIM_TYPE__DX__PX__RX", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_stg_hcp_hco_claims_CLAIM_TYPE__DX__PX__RX.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_stg_hcp_hco_claims_CLAIM_TYPE__DX__PX__RX.183fef863b", "fqn": ["CGOncology_MDM", "staging", "accepted_values_stg_hcp_hco_claims_CLAIM_TYPE__DX__PX__RX"], "alias": "accepted_values_stg_hcp_hco_claims_CLAIM_TYPE__DX__PX__RX", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.362847, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_hco_claims", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.stg_hcp_hco_claims"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "CLAIM_TYPE", "file_key_name": "models.stg_hcp_hco_claims", "attached_node": "model.CGOncology_MDM.stg_hcp_hco_claims", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "CLAIM_TYPE", "values": ["DX", "PX", "RX"], "model": "{{ get_where_subquery(ref('stg_hcp_hco_claims')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_NPI.57a8a3ff0f": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_hcp_bc_metrics_NPI", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_hcp_bc_metrics_NPI.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_NPI.57a8a3ff0f", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_hcp_bc_metrics_NPI"], "alias": "not_null_stg_hcp_bc_metrics_NPI", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.3639848, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "NPI", "file_key_name": "models.stg_hcp_bc_metrics", "attached_node": "model.CGOncology_MDM.stg_hcp_bc_metrics", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "NPI", "model": "{{ get_where_subquery(ref('stg_hcp_bc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_stg_hcp_bc_metrics_NPI.092de56925": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_stg_hcp_bc_metrics_NPI", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_stg_hcp_bc_metrics_NPI.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.unique_stg_hcp_bc_metrics_NPI.092de56925", "fqn": ["CGOncology_MDM", "staging", "unique_stg_hcp_bc_metrics_NPI"], "alias": "unique_stg_hcp_bc_metrics_NPI", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.36447, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "NPI", "file_key_name": "models.stg_hcp_bc_metrics", "attached_node": "model.CGOncology_MDM.stg_hcp_bc_metrics", "test_metadata": {"name": "unique", "kwargs": {"column_name": "NPI", "model": "{{ get_where_subquery(ref('stg_hcp_bc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_BC_PATIENT_COUNT.963cf7cf30": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_hcp_bc_metrics_BC_PATIENT_COUNT", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_hcp_bc_metrics_BC_PATIENT_COUNT.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_BC_PATIENT_COUNT.963cf7cf30", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_hcp_bc_metrics_BC_PATIENT_COUNT"], "alias": "not_null_stg_hcp_bc_metrics_BC_PATIENT_COUNT", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.364952, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "BC_PATIENT_COUNT", "file_key_name": "models.stg_hcp_bc_metrics", "attached_node": "model.CGOncology_MDM.stg_hcp_bc_metrics", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "BC_PATIENT_COUNT", "model": "{{ get_where_subquery(ref('stg_hcp_bc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_DX_PATIENT_COUNT.914c0df3f0": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_hcp_bc_metrics_DX_PATIENT_COUNT", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_hcp_bc_metrics_DX_PATIENT_COUNT.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_DX_PATIENT_COUNT.914c0df3f0", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_hcp_bc_metrics_DX_PATIENT_COUNT"], "alias": "not_null_stg_hcp_bc_metrics_DX_PATIENT_COUNT", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.36543, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "DX_PATIENT_COUNT", "file_key_name": "models.stg_hcp_bc_metrics", "attached_node": "model.CGOncology_MDM.stg_hcp_bc_metrics", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "DX_PATIENT_COUNT", "model": "{{ get_where_subquery(ref('stg_hcp_bc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_RX_PATIENT_COUNT.592d04ea6e": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_hcp_bc_metrics_RX_PATIENT_COUNT", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_hcp_bc_metrics_RX_PATIENT_COUNT.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_RX_PATIENT_COUNT.592d04ea6e", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_hcp_bc_metrics_RX_PATIENT_COUNT"], "alias": "not_null_stg_hcp_bc_metrics_RX_PATIENT_COUNT", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.366122, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "RX_PATIENT_COUNT", "file_key_name": "models.stg_hcp_bc_metrics", "attached_node": "model.CGOncology_MDM.stg_hcp_bc_metrics", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "RX_PATIENT_COUNT", "model": "{{ get_where_subquery(ref('stg_hcp_bc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_TURBT_PATIENTS.70efb088e0": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_hcp_bc_metrics_TURBT_PATIENTS", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_hcp_bc_metrics_TURBT_PATIENTS.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_TURBT_PATIENTS.70efb088e0", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_hcp_bc_metrics_TURBT_PATIENTS"], "alias": "not_null_stg_hcp_bc_metrics_TURBT_PATIENTS", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.366647, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "TURBT_PATIENTS", "file_key_name": "models.stg_hcp_bc_metrics", "attached_node": "model.CGOncology_MDM.stg_hcp_bc_metrics", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "TURBT_PATIENTS", "model": "{{ get_where_subquery(ref('stg_hcp_bc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_BCG_PATIENTS.8b51cdd62e": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_hcp_bc_metrics_BCG_PATIENTS", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_hcp_bc_metrics_BCG_PATIENTS.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_BCG_PATIENTS.8b51cdd62e", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_hcp_bc_metrics_BCG_PATIENTS"], "alias": "not_null_stg_hcp_bc_metrics_BCG_PATIENTS", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.367148, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "BCG_PATIENTS", "file_key_name": "models.stg_hcp_bc_metrics", "attached_node": "model.CGOncology_MDM.stg_hcp_bc_metrics", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "BCG_PATIENTS", "model": "{{ get_where_subquery(ref('stg_hcp_bc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_ADSTILADRIN_PATIENTS.c85b423b99": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_hcp_bc_metrics_ADSTILADRIN_PATIENTS", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_hcp_bc_metrics_ADSTILADRIN_PATIENTS.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_ADSTILADRIN_PATIENTS.c85b423b99", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_hcp_bc_metrics_ADSTILADRIN_PATIENTS"], "alias": "not_null_stg_hcp_bc_metrics_ADSTILADRIN_PATIENTS", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.367646, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "ADSTILADRIN_PATIENTS", "file_key_name": "models.stg_hcp_bc_metrics", "attached_node": "model.CGOncology_MDM.stg_hcp_bc_metrics", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "ADSTILADRIN_PATIENTS", "model": "{{ get_where_subquery(ref('stg_hcp_bc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_ANKTIVA_PATIENTS.9ce93db81c": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_hcp_bc_metrics_ANKTIVA_PATIENTS", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_hcp_bc_metrics_ANKTIVA_PATIENTS.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_ANKTIVA_PATIENTS.9ce93db81c", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_hcp_bc_metrics_ANKTIVA_PATIENTS"], "alias": "not_null_stg_hcp_bc_metrics_ANKTIVA_PATIENTS", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.3684218, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "ANKTIVA_PATIENTS", "file_key_name": "models.stg_hcp_bc_metrics", "attached_node": "model.CGOncology_MDM.stg_hcp_bc_metrics", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "ANKTIVA_PATIENTS", "model": "{{ get_where_subquery(ref('stg_hcp_bc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_KEYTRUDA_PATIENTS.11c0558b26": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_hcp_bc_metrics_KEYTRUDA_PATIENTS", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_hcp_bc_metrics_KEYTRUDA_PATIENTS.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_KEYTRUDA_PATIENTS.11c0558b26", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_hcp_bc_metrics_KEYTRUDA_PATIENTS"], "alias": "not_null_stg_hcp_bc_metrics_KEYTRUDA_PATIENTS", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.368927, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "KEYTRUDA_PATIENTS", "file_key_name": "models.stg_hcp_bc_metrics", "attached_node": "model.CGOncology_MDM.stg_hcp_bc_metrics", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "KEYTRUDA_PATIENTS", "model": "{{ get_where_subquery(ref('stg_hcp_bc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_CYSTOSCOPY_PATIENTS.26524a772d": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_hcp_bc_metrics_CYSTOSCOPY_PATIENTS", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_hcp_bc_metrics_CYSTOSCOPY_PATIENTS.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_CYSTOSCOPY_PATIENTS.26524a772d", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_hcp_bc_metrics_CYSTOSCOPY_PATIENTS"], "alias": "not_null_stg_hcp_bc_metrics_CYSTOSCOPY_PATIENTS", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.369432, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "CYSTOSCOPY_PATIENTS", "file_key_name": "models.stg_hcp_bc_metrics", "attached_node": "model.CGOncology_MDM.stg_hcp_bc_metrics", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "CYSTOSCOPY_PATIENTS", "model": "{{ get_where_subquery(ref('stg_hcp_bc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_RX_BCG_PATIENTS.1b19cc04a6": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_hcp_bc_metrics_RX_BCG_PATIENTS", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_hcp_bc_metrics_RX_BCG_PATIENTS.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_RX_BCG_PATIENTS.1b19cc04a6", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_hcp_bc_metrics_RX_BCG_PATIENTS"], "alias": "not_null_stg_hcp_bc_metrics_RX_BCG_PATIENTS", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.369926, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "RX_BCG_PATIENTS", "file_key_name": "models.stg_hcp_bc_metrics", "attached_node": "model.CGOncology_MDM.stg_hcp_bc_metrics", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "RX_BCG_PATIENTS", "model": "{{ get_where_subquery(ref('stg_hcp_bc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_RX_ADSTILADRIN_PATIENTS.83317531f5": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_hcp_bc_metrics_RX_ADSTILADRIN_PATIENTS", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_hcp_bc_metrics_RX_ADSTILADRIN_PATIENTS.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_RX_ADSTILADRIN_PATIENTS.83317531f5", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_hcp_bc_metrics_RX_ADSTILADRIN_PATIENTS"], "alias": "not_null_stg_hcp_bc_metrics_RX_ADSTILADRIN_PATIENTS", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.370429, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "RX_ADSTILADRIN_PATIENTS", "file_key_name": "models.stg_hcp_bc_metrics", "attached_node": "model.CGOncology_MDM.stg_hcp_bc_metrics", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "RX_ADSTILADRIN_PATIENTS", "model": "{{ get_where_subquery(ref('stg_hcp_bc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_RX_ANKTIVA_PATIENTS.6d08e257a9": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_hcp_bc_metrics_RX_ANKTIVA_PATIENTS", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_hcp_bc_metrics_RX_ANKTIVA_PATIENTS.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_RX_ANKTIVA_PATIENTS.6d08e257a9", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_hcp_bc_metrics_RX_ANKTIVA_PATIENTS"], "alias": "not_null_stg_hcp_bc_metrics_RX_ANKTIVA_PATIENTS", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.370931, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "RX_ANKTIVA_PATIENTS", "file_key_name": "models.stg_hcp_bc_metrics", "attached_node": "model.CGOncology_MDM.stg_hcp_bc_metrics", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "RX_ANKTIVA_PATIENTS", "model": "{{ get_where_subquery(ref('stg_hcp_bc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_IS_UROLOGIST.77ceba9871": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_hcp_bc_metrics_IS_UROLOGIST", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_hcp_bc_metrics_IS_UROLOGIST.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_IS_UROLOGIST.77ceba9871", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_hcp_bc_metrics_IS_UROLOGIST"], "alias": "not_null_stg_hcp_bc_metrics_IS_UROLOGIST", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.3714318, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "IS_UROLOGIST", "file_key_name": "models.stg_hcp_bc_metrics", "attached_node": "model.CGOncology_MDM.stg_hcp_bc_metrics", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "IS_UROLOGIST", "model": "{{ get_where_subquery(ref('stg_hcp_bc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_IS_UROLOGIST__Y__N.62a606d1c8": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_stg_hcp_bc_metrics_IS_UROLOGIST__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_stg_hcp_bc_metrics_IS_UROLOGIST__Y__N.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_IS_UROLOGIST__Y__N.62a606d1c8", "fqn": ["CGOncology_MDM", "staging", "accepted_values_stg_hcp_bc_metrics_IS_UROLOGIST__Y__N"], "alias": "accepted_values_stg_hcp_bc_metrics_IS_UROLOGIST__Y__N", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.371941, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "IS_UROLOGIST", "file_key_name": "models.stg_hcp_bc_metrics", "attached_node": "model.CGOncology_MDM.stg_hcp_bc_metrics", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "IS_UROLOGIST", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('stg_hcp_bc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_IS_TARGET.541cb9e827": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_hcp_bc_metrics_IS_TARGET", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_hcp_bc_metrics_IS_TARGET.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_IS_TARGET.541cb9e827", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_hcp_bc_metrics_IS_TARGET"], "alias": "not_null_stg_hcp_bc_metrics_IS_TARGET", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.373386, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "IS_TARGET", "file_key_name": "models.stg_hcp_bc_metrics", "attached_node": "model.CGOncology_MDM.stg_hcp_bc_metrics", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "IS_TARGET", "model": "{{ get_where_subquery(ref('stg_hcp_bc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_IS_TARGET__Y__N.8e09f806ba": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_stg_hcp_bc_metrics_IS_TARGET__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_stg_hcp_bc_metrics_IS_TARGET__Y__N.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_IS_TARGET__Y__N.8e09f806ba", "fqn": ["CGOncology_MDM", "staging", "accepted_values_stg_hcp_bc_metrics_IS_TARGET__Y__N"], "alias": "accepted_values_stg_hcp_bc_metrics_IS_TARGET__Y__N", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.373899, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "IS_TARGET", "file_key_name": "models.stg_hcp_bc_metrics", "attached_node": "model.CGOncology_MDM.stg_hcp_bc_metrics", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "IS_TARGET", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('stg_hcp_bc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_HAS_ACTIVITY.360aaae1ed": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_hcp_bc_metrics_HAS_ACTIVITY", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_hcp_bc_metrics_HAS_ACTIVITY.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_HAS_ACTIVITY.360aaae1ed", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_hcp_bc_metrics_HAS_ACTIVITY"], "alias": "not_null_stg_hcp_bc_metrics_HAS_ACTIVITY", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.375225, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "HAS_ACTIVITY", "file_key_name": "models.stg_hcp_bc_metrics", "attached_node": "model.CGOncology_MDM.stg_hcp_bc_metrics", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "HAS_ACTIVITY", "model": "{{ get_where_subquery(ref('stg_hcp_bc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_HAS_ACTIVITY__Y__N.2b140a4257": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_stg_hcp_bc_metrics_HAS_ACTIVITY__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_stg_hcp_bc_metrics_HAS_ACTIVITY__Y__N.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_HAS_ACTIVITY__Y__N.2b140a4257", "fqn": ["CGOncology_MDM", "staging", "accepted_values_stg_hcp_bc_metrics_HAS_ACTIVITY__Y__N"], "alias": "accepted_values_stg_hcp_bc_metrics_HAS_ACTIVITY__Y__N", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.375826, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "HAS_ACTIVITY", "file_key_name": "models.stg_hcp_bc_metrics", "attached_node": "model.CGOncology_MDM.stg_hcp_bc_metrics", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "HAS_ACTIVITY", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('stg_hcp_bc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_HAS_BC_TREATMENT_CLAIMS.ad9b758830": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_hcp_bc_metrics_HAS_BC_TREATMENT_CLAIMS", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_hcp_bc_metrics_HAS_BC_TREATMENT_CLAIMS.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_HAS_BC_TREATMENT_CLAIMS.ad9b758830", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_hcp_bc_metrics_HAS_BC_TREATMENT_CLAIMS"], "alias": "not_null_stg_hcp_bc_metrics_HAS_BC_TREATMENT_CLAIMS", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.37763, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "HAS_BC_TREATMENT_CLAIMS", "file_key_name": "models.stg_hcp_bc_metrics", "attached_node": "model.CGOncology_MDM.stg_hcp_bc_metrics", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "HAS_BC_TREATMENT_CLAIMS", "model": "{{ get_where_subquery(ref('stg_hcp_bc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_HAS_BC_TREATMENT_CLAIMS__Y__N.2df31db436": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_stg_hcp_bc_metrics_HAS_BC_TREATMENT_CLAIMS__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_stg_hcp_bc_met_1613c83b8ceb3cae9cb41d79a726b9a4.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_HAS_BC_TREATMENT_CLAIMS__Y__N.2df31db436", "fqn": ["CGOncology_MDM", "staging", "accepted_values_stg_hcp_bc_metrics_HAS_BC_TREATMENT_CLAIMS__Y__N"], "alias": "accepted_values_stg_hcp_bc_met_1613c83b8ceb3cae9cb41d79a726b9a4", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_stg_hcp_bc_met_1613c83b8ceb3cae9cb41d79a726b9a4", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_stg_hcp_bc_met_1613c83b8ceb3cae9cb41d79a726b9a4"}, "created_at": 1770177079.378154, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_stg_hcp_bc_met_1613c83b8ceb3cae9cb41d79a726b9a4\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "HAS_BC_TREATMENT_CLAIMS", "file_key_name": "models.stg_hcp_bc_metrics", "attached_node": "model.CGOncology_MDM.stg_hcp_bc_metrics", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "HAS_BC_TREATMENT_CLAIMS", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('stg_hcp_bc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_HAS_BC_PROCEDURE_CLAIMS.54530c687b": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_hcp_bc_metrics_HAS_BC_PROCEDURE_CLAIMS", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_hcp_bc_metrics_HAS_BC_PROCEDURE_CLAIMS.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_HAS_BC_PROCEDURE_CLAIMS.54530c687b", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_hcp_bc_metrics_HAS_BC_PROCEDURE_CLAIMS"], "alias": "not_null_stg_hcp_bc_metrics_HAS_BC_PROCEDURE_CLAIMS", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.3796852, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "HAS_BC_PROCEDURE_CLAIMS", "file_key_name": "models.stg_hcp_bc_metrics", "attached_node": "model.CGOncology_MDM.stg_hcp_bc_metrics", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "HAS_BC_PROCEDURE_CLAIMS", "model": "{{ get_where_subquery(ref('stg_hcp_bc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_HAS_BC_PROCEDURE_CLAIMS__Y__N.192be9057e": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_stg_hcp_bc_metrics_HAS_BC_PROCEDURE_CLAIMS__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_stg_hcp_bc_met_3469c8124d83171f243769c19e9dd4b2.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_HAS_BC_PROCEDURE_CLAIMS__Y__N.192be9057e", "fqn": ["CGOncology_MDM", "staging", "accepted_values_stg_hcp_bc_metrics_HAS_BC_PROCEDURE_CLAIMS__Y__N"], "alias": "accepted_values_stg_hcp_bc_met_3469c8124d83171f243769c19e9dd4b2", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_stg_hcp_bc_met_3469c8124d83171f243769c19e9dd4b2", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_stg_hcp_bc_met_3469c8124d83171f243769c19e9dd4b2"}, "created_at": 1770177079.380288, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_stg_hcp_bc_met_3469c8124d83171f243769c19e9dd4b2\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "HAS_BC_PROCEDURE_CLAIMS", "file_key_name": "models.stg_hcp_bc_metrics", "attached_node": "model.CGOncology_MDM.stg_hcp_bc_metrics", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "HAS_BC_PROCEDURE_CLAIMS", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('stg_hcp_bc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_HAS_BC_RX_CLAIMS.c66cedcecc": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_hcp_bc_metrics_HAS_BC_RX_CLAIMS", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_hcp_bc_metrics_HAS_BC_RX_CLAIMS.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_HAS_BC_RX_CLAIMS.c66cedcecc", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_hcp_bc_metrics_HAS_BC_RX_CLAIMS"], "alias": "not_null_stg_hcp_bc_metrics_HAS_BC_RX_CLAIMS", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.381871, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "HAS_BC_RX_CLAIMS", "file_key_name": "models.stg_hcp_bc_metrics", "attached_node": "model.CGOncology_MDM.stg_hcp_bc_metrics", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "HAS_BC_RX_CLAIMS", "model": "{{ get_where_subquery(ref('stg_hcp_bc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_HAS_BC_RX_CLAIMS__Y__N.b26915858b": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_stg_hcp_bc_metrics_HAS_BC_RX_CLAIMS__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_stg_hcp_bc_metrics_HAS_BC_RX_CLAIMS__Y__N.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_HAS_BC_RX_CLAIMS__Y__N.b26915858b", "fqn": ["CGOncology_MDM", "staging", "accepted_values_stg_hcp_bc_metrics_HAS_BC_RX_CLAIMS__Y__N"], "alias": "accepted_values_stg_hcp_bc_metrics_HAS_BC_RX_CLAIMS__Y__N", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.382387, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "HAS_BC_RX_CLAIMS", "file_key_name": "models.stg_hcp_bc_metrics", "attached_node": "model.CGOncology_MDM.stg_hcp_bc_metrics", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "HAS_BC_RX_CLAIMS", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('stg_hcp_bc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_BC_BACKBONE_FLAG.a17b979898": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_hcp_bc_metrics_BC_BACKBONE_FLAG", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_hcp_bc_metrics_BC_BACKBONE_FLAG.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_BC_BACKBONE_FLAG.a17b979898", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_hcp_bc_metrics_BC_BACKBONE_FLAG"], "alias": "not_null_stg_hcp_bc_metrics_BC_BACKBONE_FLAG", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.383939, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "BC_BACKBONE_FLAG", "file_key_name": "models.stg_hcp_bc_metrics", "attached_node": "model.CGOncology_MDM.stg_hcp_bc_metrics", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "BC_BACKBONE_FLAG", "model": "{{ get_where_subquery(ref('stg_hcp_bc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_BC_BACKBONE_FLAG__Y__N.ba1821dd61": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_stg_hcp_bc_metrics_BC_BACKBONE_FLAG__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_stg_hcp_bc_metrics_BC_BACKBONE_FLAG__Y__N.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_BC_BACKBONE_FLAG__Y__N.ba1821dd61", "fqn": ["CGOncology_MDM", "staging", "accepted_values_stg_hcp_bc_metrics_BC_BACKBONE_FLAG__Y__N"], "alias": "accepted_values_stg_hcp_bc_metrics_BC_BACKBONE_FLAG__Y__N", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.384453, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "BC_BACKBONE_FLAG", "file_key_name": "models.stg_hcp_bc_metrics", "attached_node": "model.CGOncology_MDM.stg_hcp_bc_metrics", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "BC_BACKBONE_FLAG", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('stg_hcp_bc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_HCP_CATEGORY.b39969faec": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_hcp_bc_metrics_HCP_CATEGORY", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_hcp_bc_metrics_HCP_CATEGORY.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_HCP_CATEGORY.b39969faec", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_hcp_bc_metrics_HCP_CATEGORY"], "alias": "not_null_stg_hcp_bc_metrics_HCP_CATEGORY", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.385748, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "HCP_CATEGORY", "file_key_name": "models.stg_hcp_bc_metrics", "attached_node": "model.CGOncology_MDM.stg_hcp_bc_metrics", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "HCP_CATEGORY", "model": "{{ get_where_subquery(ref('stg_hcp_bc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_HCP_CATEGORY__Urologist__BC_Treatment_Patient_Pool__BC_RX_Prescriber__Target_HCP__Activity_HCP__Total_BC_Patient_Pool.f12bf82f00": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_stg_hcp_bc_metrics_HCP_CATEGORY__Urologist__BC_Treatment_Patient_Pool__BC_RX_Prescriber__Target_HCP__Activity_HCP__Total_BC_Patient_Pool", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_stg_hcp_bc_met_dc39ed42a6510ec3af2704bbd4abc707.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_HCP_CATEGORY__Urologist__BC_Treatment_Patient_Pool__BC_RX_Prescriber__Target_HCP__Activity_HCP__Total_BC_Patient_Pool.f12bf82f00", "fqn": ["CGOncology_MDM", "staging", "accepted_values_stg_hcp_bc_metrics_HCP_CATEGORY__Urologist__BC_Treatment_Patient_Pool__BC_RX_Prescriber__Target_HCP__Activity_HCP__Total_BC_Patient_Pool"], "alias": "accepted_values_stg_hcp_bc_met_dc39ed42a6510ec3af2704bbd4abc707", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_stg_hcp_bc_met_dc39ed42a6510ec3af2704bbd4abc707", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_stg_hcp_bc_met_dc39ed42a6510ec3af2704bbd4abc707"}, "created_at": 1770177079.386435, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_stg_hcp_bc_met_dc39ed42a6510ec3af2704bbd4abc707\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "HCP_CATEGORY", "file_key_name": "models.stg_hcp_bc_metrics", "attached_node": "model.CGOncology_MDM.stg_hcp_bc_metrics", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "HCP_CATEGORY", "values": ["Urologist", "BC Treatment Patient Pool", "BC RX Prescriber", "Target HCP", "Activity HCP", "Total BC Patient Pool"], "model": "{{ get_where_subquery(ref('stg_hcp_bc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_BC_VOLUME_TIER.b6e432164c": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_hcp_bc_metrics_BC_VOLUME_TIER", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_hcp_bc_metrics_BC_VOLUME_TIER.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_BC_VOLUME_TIER.b6e432164c", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_hcp_bc_metrics_BC_VOLUME_TIER"], "alias": "not_null_stg_hcp_bc_metrics_BC_VOLUME_TIER", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.388044, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "BC_VOLUME_TIER", "file_key_name": "models.stg_hcp_bc_metrics", "attached_node": "model.CGOncology_MDM.stg_hcp_bc_metrics", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "BC_VOLUME_TIER", "model": "{{ get_where_subquery(ref('stg_hcp_bc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_BC_VOLUME_TIER__HIGH__MEDIUM__LOW__NONE.610aafdce1": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_stg_hcp_bc_metrics_BC_VOLUME_TIER__HIGH__MEDIUM__LOW__NONE", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_stg_hcp_bc_met_0cd3b79a979fb905c0dd807fac773109.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_BC_VOLUME_TIER__HIGH__MEDIUM__LOW__NONE.610aafdce1", "fqn": ["CGOncology_MDM", "staging", "accepted_values_stg_hcp_bc_metrics_BC_VOLUME_TIER__HIGH__MEDIUM__LOW__NONE"], "alias": "accepted_values_stg_hcp_bc_met_0cd3b79a979fb905c0dd807fac773109", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_stg_hcp_bc_met_0cd3b79a979fb905c0dd807fac773109", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_stg_hcp_bc_met_0cd3b79a979fb905c0dd807fac773109"}, "created_at": 1770177079.388574, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_stg_hcp_bc_met_0cd3b79a979fb905c0dd807fac773109\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "BC_VOLUME_TIER", "file_key_name": "models.stg_hcp_bc_metrics", "attached_node": "model.CGOncology_MDM.stg_hcp_bc_metrics", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "BC_VOLUME_TIER", "values": ["HIGH", "MEDIUM", "LOW", "NONE"], "model": "{{ get_where_subquery(ref('stg_hcp_bc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_DATA_DATE.cdf6c17b7c": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_hcp_bc_metrics_DATA_DATE", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_hcp_bc_metrics_DATA_DATE.sql", "original_file_path": "models/staging/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_DATA_DATE.cdf6c17b7c", "fqn": ["CGOncology_MDM", "staging", "not_null_stg_hcp_bc_metrics_DATA_DATE"], "alias": "not_null_stg_hcp_bc_metrics_DATA_DATE", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.389948, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_hcp_bc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_hcp_bc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "DATA_DATE", "file_key_name": "models.stg_hcp_bc_metrics", "attached_node": "model.CGOncology_MDM.stg_hcp_bc_metrics", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "DATA_DATE", "model": "{{ get_where_subquery(ref('stg_hcp_bc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_hcp_decile_NPI.e208cb8767": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_hcp_decile_NPI", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_hcp_decile_NPI.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_hcp_decile_NPI.e208cb8767", "fqn": ["CGOncology_MDM", "SFE", "not_null_hcp_decile_NPI"], "alias": "not_null_hcp_decile_NPI", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.3922508, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "hcp_decile", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.hcp_decile"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "NPI", "file_key_name": "models.hcp_decile", "attached_node": "model.CGOncology_MDM.hcp_decile", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "NPI", "model": "{{ get_where_subquery(ref('hcp_decile')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_hcp_decile_NPI.9eca6ac110": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_hcp_decile_NPI", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_hcp_decile_NPI.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.unique_hcp_decile_NPI.9eca6ac110", "fqn": ["CGOncology_MDM", "SFE", "unique_hcp_decile_NPI"], "alias": "unique_hcp_decile_NPI", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.393135, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "hcp_decile", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.CGOncology_MDM.hcp_decile"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "NPI", "file_key_name": "models.hcp_decile", "attached_node": "model.CGOncology_MDM.hcp_decile", "test_metadata": {"name": "unique", "kwargs": {"column_name": "NPI", "model": "{{ get_where_subquery(ref('hcp_decile')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_hcp_decile_TIME_PERIOD.f5eac4fc6a": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_hcp_decile_TIME_PERIOD", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_hcp_decile_TIME_PERIOD.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_hcp_decile_TIME_PERIOD.f5eac4fc6a", "fqn": ["CGOncology_MDM", "SFE", "not_null_hcp_decile_TIME_PERIOD"], "alias": "not_null_hcp_decile_TIME_PERIOD", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.3936481, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "hcp_decile", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.hcp_decile"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "TIME_PERIOD", "file_key_name": "models.hcp_decile", "attached_node": "model.CGOncology_MDM.hcp_decile", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "TIME_PERIOD", "model": "{{ get_where_subquery(ref('hcp_decile')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_hcp_decile_STANDARDIZED_TOTAL_PATIENTS.ee7998a705": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_hcp_decile_STANDARDIZED_TOTAL_PATIENTS", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_hcp_decile_STANDARDIZED_TOTAL_PATIENTS.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_hcp_decile_STANDARDIZED_TOTAL_PATIENTS.ee7998a705", "fqn": ["CGOncology_MDM", "SFE", "not_null_hcp_decile_STANDARDIZED_TOTAL_PATIENTS"], "alias": "not_null_hcp_decile_STANDARDIZED_TOTAL_PATIENTS", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.3942049, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "hcp_decile", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.hcp_decile"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "STANDARDIZED_TOTAL_PATIENTS", "file_key_name": "models.hcp_decile", "attached_node": "model.CGOncology_MDM.hcp_decile", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "STANDARDIZED_TOTAL_PATIENTS", "model": "{{ get_where_subquery(ref('hcp_decile')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_hcp_decile_STANDARDIZED_BCG_CLAIMS.dd05c0a210": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_hcp_decile_STANDARDIZED_BCG_CLAIMS", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_hcp_decile_STANDARDIZED_BCG_CLAIMS.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_hcp_decile_STANDARDIZED_BCG_CLAIMS.dd05c0a210", "fqn": ["CGOncology_MDM", "SFE", "not_null_hcp_decile_STANDARDIZED_BCG_CLAIMS"], "alias": "not_null_hcp_decile_STANDARDIZED_BCG_CLAIMS", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.394743, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "hcp_decile", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.hcp_decile"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "STANDARDIZED_BCG_CLAIMS", "file_key_name": "models.hcp_decile", "attached_node": "model.CGOncology_MDM.hcp_decile", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "STANDARDIZED_BCG_CLAIMS", "model": "{{ get_where_subquery(ref('hcp_decile')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_hcp_decile_STANDARDIZED_TURBT_CLAIMS.80c23eabcf": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_hcp_decile_STANDARDIZED_TURBT_CLAIMS", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_hcp_decile_STANDARDIZED_TURBT_CLAIMS.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_hcp_decile_STANDARDIZED_TURBT_CLAIMS.80c23eabcf", "fqn": ["CGOncology_MDM", "SFE", "not_null_hcp_decile_STANDARDIZED_TURBT_CLAIMS"], "alias": "not_null_hcp_decile_STANDARDIZED_TURBT_CLAIMS", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.395252, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "hcp_decile", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.hcp_decile"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "STANDARDIZED_TURBT_CLAIMS", "file_key_name": "models.hcp_decile", "attached_node": "model.CGOncology_MDM.hcp_decile", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "STANDARDIZED_TURBT_CLAIMS", "model": "{{ get_where_subquery(ref('hcp_decile')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_hcp_decile_COMPOSITE_SCORE.1570178381": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_hcp_decile_COMPOSITE_SCORE", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_hcp_decile_COMPOSITE_SCORE.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_hcp_decile_COMPOSITE_SCORE.1570178381", "fqn": ["CGOncology_MDM", "SFE", "not_null_hcp_decile_COMPOSITE_SCORE"], "alias": "not_null_hcp_decile_COMPOSITE_SCORE", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.395831, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "hcp_decile", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.hcp_decile"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "COMPOSITE_SCORE", "file_key_name": "models.hcp_decile", "attached_node": "model.CGOncology_MDM.hcp_decile", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "COMPOSITE_SCORE", "model": "{{ get_where_subquery(ref('hcp_decile')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_hcp_decile_DECILE.4053a88425": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_hcp_decile_DECILE", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_hcp_decile_DECILE.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_hcp_decile_DECILE.4053a88425", "fqn": ["CGOncology_MDM", "SFE", "not_null_hcp_decile_DECILE"], "alias": "not_null_hcp_decile_DECILE", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.396449, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "hcp_decile", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.hcp_decile"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "DECILE", "file_key_name": "models.hcp_decile", "attached_node": "model.CGOncology_MDM.hcp_decile", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "DECILE", "model": "{{ get_where_subquery(ref('hcp_decile')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_hcp_decile_DECILE__1__2__3__4__5__6__7__8__9__10.113157d98c": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_hcp_decile_DECILE__1__2__3__4__5__6__7__8__9__10", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_hcp_decile_a94583bb7b4a939539b2f759a889d06b.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_hcp_decile_DECILE__1__2__3__4__5__6__7__8__9__10.113157d98c", "fqn": ["CGOncology_MDM", "SFE", "accepted_values_hcp_decile_DECILE__1__2__3__4__5__6__7__8__9__10"], "alias": "accepted_values_hcp_decile_a94583bb7b4a939539b2f759a889d06b", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_hcp_decile_a94583bb7b4a939539b2f759a889d06b", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_hcp_decile_a94583bb7b4a939539b2f759a889d06b"}, "created_at": 1770177079.397005, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_hcp_decile_a94583bb7b4a939539b2f759a889d06b\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "hcp_decile", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.hcp_decile"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "DECILE", "file_key_name": "models.hcp_decile", "attached_node": "model.CGOncology_MDM.hcp_decile", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "DECILE", "values": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "model": "{{ get_where_subquery(ref('hcp_decile')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_sfe_targets_entity_id.c065cd9d0a": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_sfe_targets_entity_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_sfe_targets_entity_id.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_sfe_targets_entity_id.c065cd9d0a", "fqn": ["CGOncology_MDM", "SFE", "not_null_stg_sfe_targets_entity_id"], "alias": "not_null_stg_sfe_targets_entity_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.398623, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_sfe_targets", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_sfe_targets"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "entity_id", "file_key_name": "models.stg_sfe_targets", "attached_node": "model.CGOncology_MDM.stg_sfe_targets", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "entity_id", "model": "{{ get_where_subquery(ref('stg_sfe_targets')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_sfe_targets_entity_type.8082c3d2af": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_sfe_targets_entity_type", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_sfe_targets_entity_type.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_sfe_targets_entity_type.8082c3d2af", "fqn": ["CGOncology_MDM", "SFE", "not_null_stg_sfe_targets_entity_type"], "alias": "not_null_stg_sfe_targets_entity_type", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.399132, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_sfe_targets", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_sfe_targets"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "entity_type", "file_key_name": "models.stg_sfe_targets", "attached_node": "model.CGOncology_MDM.stg_sfe_targets", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "entity_type", "model": "{{ get_where_subquery(ref('stg_sfe_targets')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_stg_sfe_targets_entity_type__HCO__HCP.e4003662ec": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_stg_sfe_targets_entity_type__HCO__HCP", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_stg_sfe_targets_entity_type__HCO__HCP.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_stg_sfe_targets_entity_type__HCO__HCP.e4003662ec", "fqn": ["CGOncology_MDM", "SFE", "accepted_values_stg_sfe_targets_entity_type__HCO__HCP"], "alias": "accepted_values_stg_sfe_targets_entity_type__HCO__HCP", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.399638, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_sfe_targets", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.stg_sfe_targets"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "entity_type", "file_key_name": "models.stg_sfe_targets", "attached_node": "model.CGOncology_MDM.stg_sfe_targets", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "entity_type", "values": ["HCO", "HCP"], "model": "{{ get_where_subquery(ref('stg_sfe_targets')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_sfe_targets_target_type.6d0a8711b5": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_sfe_targets_target_type", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_sfe_targets_target_type.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_sfe_targets_target_type.6d0a8711b5", "fqn": ["CGOncology_MDM", "SFE", "not_null_stg_sfe_targets_target_type"], "alias": "not_null_stg_sfe_targets_target_type", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.401186, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_sfe_targets", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_sfe_targets"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "target_type", "file_key_name": "models.stg_sfe_targets", "attached_node": "model.CGOncology_MDM.stg_sfe_targets", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "target_type", "model": "{{ get_where_subquery(ref('stg_sfe_targets')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_stg_sfe_targets_target_type__KAM_NETWORK__KAM_CHILD__HSD__HCP_TARGET__MSL_TARGET.19afec1207": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_stg_sfe_targets_target_type__KAM_NETWORK__KAM_CHILD__HSD__HCP_TARGET__MSL_TARGET", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_stg_sfe_target_e11657c16e2a40322193656ce90ff275.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_stg_sfe_targets_target_type__KAM_NETWORK__KAM_CHILD__HSD__HCP_TARGET__MSL_TARGET.19afec1207", "fqn": ["CGOncology_MDM", "SFE", "accepted_values_stg_sfe_targets_target_type__KAM_NETWORK__KAM_CHILD__HSD__HCP_TARGET__MSL_TARGET"], "alias": "accepted_values_stg_sfe_target_e11657c16e2a40322193656ce90ff275", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_stg_sfe_target_e11657c16e2a40322193656ce90ff275", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_stg_sfe_target_e11657c16e2a40322193656ce90ff275"}, "created_at": 1770177079.401709, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_stg_sfe_target_e11657c16e2a40322193656ce90ff275\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_sfe_targets", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.stg_sfe_targets"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "target_type", "file_key_name": "models.stg_sfe_targets", "attached_node": "model.CGOncology_MDM.stg_sfe_targets", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "target_type", "values": ["KAM_NETWORK", "KAM_CHILD", "HSD", "HCP_TARGET", "MSL_TARGET"], "model": "{{ get_where_subquery(ref('stg_sfe_targets')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_stg_sfe_targets_target_flag.02d4b9155f": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_stg_sfe_targets_target_flag", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_stg_sfe_targets_target_flag.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_stg_sfe_targets_target_flag.02d4b9155f", "fqn": ["CGOncology_MDM", "SFE", "not_null_stg_sfe_targets_target_flag"], "alias": "not_null_stg_sfe_targets_target_flag", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.403003, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "stg_sfe_targets", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.stg_sfe_targets"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "target_flag", "file_key_name": "models.stg_sfe_targets", "attached_node": "model.CGOncology_MDM.stg_sfe_targets", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "target_flag", "model": "{{ get_where_subquery(ref('stg_sfe_targets')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_sfe_geographies_geo_code.3bf1753026": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_sfe_geographies_geo_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_sfe_geographies_geo_code.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_sfe_geographies_geo_code.3bf1753026", "fqn": ["CGOncology_MDM", "SFE", "not_null_adm_sfe_geographies_geo_code"], "alias": "not_null_adm_sfe_geographies_geo_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.4035, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_sfe_geographies", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_sfe_geographies"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "geo_code", "file_key_name": "models.adm_sfe_geographies", "attached_node": "model.CGOncology_MDM.adm_sfe_geographies", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "geo_code", "model": "{{ get_where_subquery(ref('adm_sfe_geographies')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_adm_sfe_geographies_geo_code.2eea9dd057": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_adm_sfe_geographies_geo_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_adm_sfe_geographies_geo_code.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.unique_adm_sfe_geographies_geo_code.2eea9dd057", "fqn": ["CGOncology_MDM", "SFE", "unique_adm_sfe_geographies_geo_code"], "alias": "unique_adm_sfe_geographies_geo_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.403994, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_sfe_geographies", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.CGOncology_MDM.adm_sfe_geographies"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "geo_code", "file_key_name": "models.adm_sfe_geographies", "attached_node": "model.CGOncology_MDM.adm_sfe_geographies", "test_metadata": {"name": "unique", "kwargs": {"column_name": "geo_code", "model": "{{ get_where_subquery(ref('adm_sfe_geographies')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_sfe_geographies_geo_name.4bc8946e84": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_sfe_geographies_geo_name", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_sfe_geographies_geo_name.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_sfe_geographies_geo_name.4bc8946e84", "fqn": ["CGOncology_MDM", "SFE", "not_null_adm_sfe_geographies_geo_name"], "alias": "not_null_adm_sfe_geographies_geo_name", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.404496, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_sfe_geographies", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_sfe_geographies"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "geo_name", "file_key_name": "models.adm_sfe_geographies", "attached_node": "model.CGOncology_MDM.adm_sfe_geographies", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "geo_name", "model": "{{ get_where_subquery(ref('adm_sfe_geographies')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_sfe_geographies_geo_type.ac40d5904e": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_sfe_geographies_geo_type", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_sfe_geographies_geo_type.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_sfe_geographies_geo_type.ac40d5904e", "fqn": ["CGOncology_MDM", "SFE", "not_null_adm_sfe_geographies_geo_type"], "alias": "not_null_adm_sfe_geographies_geo_type", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.405001, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_sfe_geographies", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_sfe_geographies"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "geo_type", "file_key_name": "models.adm_sfe_geographies", "attached_node": "model.CGOncology_MDM.adm_sfe_geographies", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "geo_type", "model": "{{ get_where_subquery(ref('adm_sfe_geographies')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_adm_sfe_geographies_geo_type__TERRITORY__REGION__NATION.b2998d82da": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_sfe_geographies_geo_type__TERRITORY__REGION__NATION", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_sfe_geogra_f5cd78340fce220edf799e33b8732c19.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_sfe_geographies_geo_type__TERRITORY__REGION__NATION.b2998d82da", "fqn": ["CGOncology_MDM", "SFE", "accepted_values_adm_sfe_geographies_geo_type__TERRITORY__REGION__NATION"], "alias": "accepted_values_adm_sfe_geogra_f5cd78340fce220edf799e33b8732c19", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_adm_sfe_geogra_f5cd78340fce220edf799e33b8732c19", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_adm_sfe_geogra_f5cd78340fce220edf799e33b8732c19"}, "created_at": 1770177079.405517, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_adm_sfe_geogra_f5cd78340fce220edf799e33b8732c19\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_sfe_geographies", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_sfe_geographies"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "geo_type", "file_key_name": "models.adm_sfe_geographies", "attached_node": "model.CGOncology_MDM.adm_sfe_geographies", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "geo_type", "values": ["TERRITORY", "REGION", "NATION"], "model": "{{ get_where_subquery(ref('adm_sfe_geographies')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_adm_sfe_geographies_team__KAM__HSD__MSL__PAYOR.d41f96ee2a": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_sfe_geographies_team__KAM__HSD__MSL__PAYOR", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_sfe_geographies_team__KAM__HSD__MSL__PAYOR.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_sfe_geographies_team__KAM__HSD__MSL__PAYOR.d41f96ee2a", "fqn": ["CGOncology_MDM", "SFE", "accepted_values_adm_sfe_geographies_team__KAM__HSD__MSL__PAYOR"], "alias": "accepted_values_adm_sfe_geographies_team__KAM__HSD__MSL__PAYOR", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.406837, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_sfe_geographies", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_sfe_geographies"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "team", "file_key_name": "models.adm_sfe_geographies", "attached_node": "model.CGOncology_MDM.adm_sfe_geographies", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "team", "values": ["KAM", "HSD", "MSL", "PAYOR"], "model": "{{ get_where_subquery(ref('adm_sfe_geographies')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_sfe_zip_alignment_zip_code.650f602114": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_sfe_zip_alignment_zip_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_sfe_zip_alignment_zip_code.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_sfe_zip_alignment_zip_code.650f602114", "fqn": ["CGOncology_MDM", "SFE", "not_null_adm_sfe_zip_alignment_zip_code"], "alias": "not_null_adm_sfe_zip_alignment_zip_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.4085498, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_sfe_zip_alignment", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_sfe_zip_alignment"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "zip_code", "file_key_name": "models.adm_sfe_zip_alignment", "attached_node": "model.CGOncology_MDM.adm_sfe_zip_alignment", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "zip_code", "model": "{{ get_where_subquery(ref('adm_sfe_zip_alignment')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_adm_sfe_zip_alignment_zip_code.d5a56b576f": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_adm_sfe_zip_alignment_zip_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_adm_sfe_zip_alignment_zip_code.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.unique_adm_sfe_zip_alignment_zip_code.d5a56b576f", "fqn": ["CGOncology_MDM", "SFE", "unique_adm_sfe_zip_alignment_zip_code"], "alias": "unique_adm_sfe_zip_alignment_zip_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.4091158, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_sfe_zip_alignment", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.CGOncology_MDM.adm_sfe_zip_alignment"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "zip_code", "file_key_name": "models.adm_sfe_zip_alignment", "attached_node": "model.CGOncology_MDM.adm_sfe_zip_alignment", "test_metadata": {"name": "unique", "kwargs": {"column_name": "zip_code", "model": "{{ get_where_subquery(ref('adm_sfe_zip_alignment')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_sfe_hco_targets_kmk_hco_id.5878b9508f": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_sfe_hco_targets_kmk_hco_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_sfe_hco_targets_kmk_hco_id.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_sfe_hco_targets_kmk_hco_id.5878b9508f", "fqn": ["CGOncology_MDM", "SFE", "not_null_adm_sfe_hco_targets_kmk_hco_id"], "alias": "not_null_adm_sfe_hco_targets_kmk_hco_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.409641, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_sfe_hco_targets", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_sfe_hco_targets"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hco_id", "file_key_name": "models.adm_sfe_hco_targets", "attached_node": "model.CGOncology_MDM.adm_sfe_hco_targets", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "kmk_hco_id", "model": "{{ get_where_subquery(ref('adm_sfe_hco_targets')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_adm_sfe_hco_targets_kmk_hco_id.de0c13379d": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_adm_sfe_hco_targets_kmk_hco_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_adm_sfe_hco_targets_kmk_hco_id.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.unique_adm_sfe_hco_targets_kmk_hco_id.de0c13379d", "fqn": ["CGOncology_MDM", "SFE", "unique_adm_sfe_hco_targets_kmk_hco_id"], "alias": "unique_adm_sfe_hco_targets_kmk_hco_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.4101472, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_sfe_hco_targets", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.CGOncology_MDM.adm_sfe_hco_targets"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hco_id", "file_key_name": "models.adm_sfe_hco_targets", "attached_node": "model.CGOncology_MDM.adm_sfe_hco_targets", "test_metadata": {"name": "unique", "kwargs": {"column_name": "kmk_hco_id", "model": "{{ get_where_subquery(ref('adm_sfe_hco_targets')) }}"}, "namespace": null}}, "test.CGOncology_MDM.relationships_adm_sfe_hco_targets_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.07e79ca121": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "relationships_adm_sfe_hco_targets_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "relationships_adm_sfe_hco_targ_98ed3c652390366ea9248dbd95c09cb3.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.relationships_adm_sfe_hco_targets_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.07e79ca121", "fqn": ["CGOncology_MDM", "SFE", "relationships_adm_sfe_hco_targets_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_"], "alias": "relationships_adm_sfe_hco_targ_98ed3c652390366ea9248dbd95c09cb3", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "relationships_adm_sfe_hco_targ_98ed3c652390366ea9248dbd95c09cb3", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "relationships_adm_sfe_hco_targ_98ed3c652390366ea9248dbd95c09cb3"}, "created_at": 1770177079.410675, "relation_name": null, "raw_code": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_adm_sfe_hco_targ_98ed3c652390366ea9248dbd95c09cb3\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hco", "package": null, "version": null}, {"name": "adm_sfe_hco_targets", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.adm_sfe_hco_targets"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hco_id", "file_key_name": "models.adm_sfe_hco_targets", "attached_node": "model.CGOncology_MDM.adm_sfe_hco_targets", "test_metadata": {"name": "relationships", "kwargs": {"to": "ref('mdm_customer_master_hco')", "field": "kmk_hco_id", "column_name": "kmk_hco_id", "model": "{{ get_where_subquery(ref('adm_sfe_hco_targets')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_adm_sfe_hco_targets_kam_network_target_flag__Y__N.5d3ad1f11a": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_sfe_hco_targets_kam_network_target_flag__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_sfe_hco_ta_54deefcd0c788b6c3ddb0d9374150ad1.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_sfe_hco_targets_kam_network_target_flag__Y__N.5d3ad1f11a", "fqn": ["CGOncology_MDM", "SFE", "accepted_values_adm_sfe_hco_targets_kam_network_target_flag__Y__N"], "alias": "accepted_values_adm_sfe_hco_ta_54deefcd0c788b6c3ddb0d9374150ad1", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_adm_sfe_hco_ta_54deefcd0c788b6c3ddb0d9374150ad1", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_adm_sfe_hco_ta_54deefcd0c788b6c3ddb0d9374150ad1"}, "created_at": 1770177079.412415, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_adm_sfe_hco_ta_54deefcd0c788b6c3ddb0d9374150ad1\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_sfe_hco_targets", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_sfe_hco_targets"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kam_network_target_flag", "file_key_name": "models.adm_sfe_hco_targets", "attached_node": "model.CGOncology_MDM.adm_sfe_hco_targets", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "kam_network_target_flag", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('adm_sfe_hco_targets')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_adm_sfe_hco_targets_kam_child_target_flag__Y__N.fafd69b0be": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_sfe_hco_targets_kam_child_target_flag__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_sfe_hco_targets_kam_child_target_flag__Y__N.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_sfe_hco_targets_kam_child_target_flag__Y__N.fafd69b0be", "fqn": ["CGOncology_MDM", "SFE", "accepted_values_adm_sfe_hco_targets_kam_child_target_flag__Y__N"], "alias": "accepted_values_adm_sfe_hco_targets_kam_child_target_flag__Y__N", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.413732, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_sfe_hco_targets", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_sfe_hco_targets"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kam_child_target_flag", "file_key_name": "models.adm_sfe_hco_targets", "attached_node": "model.CGOncology_MDM.adm_sfe_hco_targets", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "kam_child_target_flag", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('adm_sfe_hco_targets')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_adm_sfe_hco_targets_hsd_target_flag__Y__N.276ace2e5a": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_sfe_hco_targets_hsd_target_flag__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_sfe_hco_targets_hsd_target_flag__Y__N.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_sfe_hco_targets_hsd_target_flag__Y__N.276ace2e5a", "fqn": ["CGOncology_MDM", "SFE", "accepted_values_adm_sfe_hco_targets_hsd_target_flag__Y__N"], "alias": "accepted_values_adm_sfe_hco_targets_hsd_target_flag__Y__N", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.414922, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_sfe_hco_targets", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_sfe_hco_targets"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "hsd_target_flag", "file_key_name": "models.adm_sfe_hco_targets", "attached_node": "model.CGOncology_MDM.adm_sfe_hco_targets", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "hsd_target_flag", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('adm_sfe_hco_targets')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_adm_sfe_hco_targets_msl_target_flag__Y__N.0e207c3aaa": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_sfe_hco_targets_msl_target_flag__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_sfe_hco_targets_msl_target_flag__Y__N.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_sfe_hco_targets_msl_target_flag__Y__N.0e207c3aaa", "fqn": ["CGOncology_MDM", "SFE", "accepted_values_adm_sfe_hco_targets_msl_target_flag__Y__N"], "alias": "accepted_values_adm_sfe_hco_targets_msl_target_flag__Y__N", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.4171221, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_sfe_hco_targets", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_sfe_hco_targets"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "msl_target_flag", "file_key_name": "models.adm_sfe_hco_targets", "attached_node": "model.CGOncology_MDM.adm_sfe_hco_targets", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "msl_target_flag", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('adm_sfe_hco_targets')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_sfe_hcp_targets_kmk_hcp_id.343a5058c2": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_sfe_hcp_targets_kmk_hcp_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_sfe_hcp_targets_kmk_hcp_id.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_sfe_hcp_targets_kmk_hcp_id.343a5058c2", "fqn": ["CGOncology_MDM", "SFE", "not_null_adm_sfe_hcp_targets_kmk_hcp_id"], "alias": "not_null_adm_sfe_hcp_targets_kmk_hcp_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.4185019, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_sfe_hcp_targets", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_sfe_hcp_targets"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hcp_id", "file_key_name": "models.adm_sfe_hcp_targets", "attached_node": "model.CGOncology_MDM.adm_sfe_hcp_targets", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "kmk_hcp_id", "model": "{{ get_where_subquery(ref('adm_sfe_hcp_targets')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_adm_sfe_hcp_targets_kmk_hcp_id.b80969407d": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_adm_sfe_hcp_targets_kmk_hcp_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_adm_sfe_hcp_targets_kmk_hcp_id.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.unique_adm_sfe_hcp_targets_kmk_hcp_id.b80969407d", "fqn": ["CGOncology_MDM", "SFE", "unique_adm_sfe_hcp_targets_kmk_hcp_id"], "alias": "unique_adm_sfe_hcp_targets_kmk_hcp_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.419028, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_sfe_hcp_targets", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.CGOncology_MDM.adm_sfe_hcp_targets"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hcp_id", "file_key_name": "models.adm_sfe_hcp_targets", "attached_node": "model.CGOncology_MDM.adm_sfe_hcp_targets", "test_metadata": {"name": "unique", "kwargs": {"column_name": "kmk_hcp_id", "model": "{{ get_where_subquery(ref('adm_sfe_hcp_targets')) }}"}, "namespace": null}}, "test.CGOncology_MDM.relationships_adm_sfe_hcp_targets_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_.4ca0295145": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "relationships_adm_sfe_hcp_targets_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "relationships_adm_sfe_hcp_targ_41625ba4021454f308be1e6099632b56.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.relationships_adm_sfe_hcp_targets_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_.4ca0295145", "fqn": ["CGOncology_MDM", "SFE", "relationships_adm_sfe_hcp_targets_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_"], "alias": "relationships_adm_sfe_hcp_targ_41625ba4021454f308be1e6099632b56", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "relationships_adm_sfe_hcp_targ_41625ba4021454f308be1e6099632b56", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "relationships_adm_sfe_hcp_targ_41625ba4021454f308be1e6099632b56"}, "created_at": 1770177079.419562, "relation_name": null, "raw_code": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_adm_sfe_hcp_targ_41625ba4021454f308be1e6099632b56\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hcp", "package": null, "version": null}, {"name": "adm_sfe_hcp_targets", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hcp", "model.CGOncology_MDM.adm_sfe_hcp_targets"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hcp_id", "file_key_name": "models.adm_sfe_hcp_targets", "attached_node": "model.CGOncology_MDM.adm_sfe_hcp_targets", "test_metadata": {"name": "relationships", "kwargs": {"to": "ref('mdm_customer_master_hcp')", "field": "kmk_hcp_id", "column_name": "kmk_hcp_id", "model": "{{ get_where_subquery(ref('adm_sfe_hcp_targets')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_adm_sfe_hcp_targets_kam_target_flag__Y__N.b025c684ba": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_sfe_hcp_targets_kam_target_flag__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_sfe_hcp_targets_kam_target_flag__Y__N.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_sfe_hcp_targets_kam_target_flag__Y__N.b025c684ba", "fqn": ["CGOncology_MDM", "SFE", "accepted_values_adm_sfe_hcp_targets_kam_target_flag__Y__N"], "alias": "accepted_values_adm_sfe_hcp_targets_kam_target_flag__Y__N", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.4212759, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_sfe_hcp_targets", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_sfe_hcp_targets"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kam_target_flag", "file_key_name": "models.adm_sfe_hcp_targets", "attached_node": "model.CGOncology_MDM.adm_sfe_hcp_targets", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "kam_target_flag", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('adm_sfe_hcp_targets')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_adm_sfe_hcp_targets_kam_decile__1__2__3__4__5__6__7__8__9__10.acc477934d": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_sfe_hcp_targets_kam_decile__1__2__3__4__5__6__7__8__9__10", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_sfe_hcp_ta_df0881991df15be6ed3188f86c8e327d.sql", "original_file_path": "models/SFE/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_sfe_hcp_targets_kam_decile__1__2__3__4__5__6__7__8__9__10.acc477934d", "fqn": ["CGOncology_MDM", "SFE", "accepted_values_adm_sfe_hcp_targets_kam_decile__1__2__3__4__5__6__7__8__9__10"], "alias": "accepted_values_adm_sfe_hcp_ta_df0881991df15be6ed3188f86c8e327d", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_adm_sfe_hcp_ta_df0881991df15be6ed3188f86c8e327d", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": "kam_decile IS NOT NULL", "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"where": "kam_decile IS NOT NULL", "alias": "accepted_values_adm_sfe_hcp_ta_df0881991df15be6ed3188f86c8e327d"}, "created_at": 1770177079.4225311, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(where=\"kam_decile IS NOT NULL\",alias=\"accepted_values_adm_sfe_hcp_ta_df0881991df15be6ed3188f86c8e327d\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_sfe_hcp_targets", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_sfe_hcp_targets"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kam_decile", "file_key_name": "models.adm_sfe_hcp_targets", "attached_node": "model.CGOncology_MDM.adm_sfe_hcp_targets", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "kam_decile", "values": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "model": "{{ get_where_subquery(ref('adm_sfe_hcp_targets')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_dh_hco_dh_id.155e4b5801": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dh_hco_dh_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dh_hco_dh_id.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dh_hco_dh_id.155e4b5801", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dh_hco_dh_id"], "alias": "not_null_std_dh_hco_dh_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.4420638, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dh_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "dh_id", "file_key_name": "models.std_dh_hco", "attached_node": "model.CGOncology_MDM.std_dh_hco", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "dh_id", "model": "{{ get_where_subquery(ref('std_dh_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_std_dh_hco_dh_id.c89c925785": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_std_dh_hco_dh_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_std_dh_hco_dh_id.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.unique_std_dh_hco_dh_id.c89c925785", "fqn": ["CGOncology_MDM", "standardization", "unique_std_dh_hco_dh_id"], "alias": "unique_std_dh_hco_dh_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.442608, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.CGOncology_MDM.std_dh_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "dh_id", "file_key_name": "models.std_dh_hco", "attached_node": "model.CGOncology_MDM.std_dh_hco", "test_metadata": {"name": "unique", "kwargs": {"column_name": "dh_id", "model": "{{ get_where_subquery(ref('std_dh_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_std_dh_hco_dh_id___0.c014a1da7b": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_column_values_to_not_match_regex_std_dh_hco_dh_id___0", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_column_59b45276f6b60dfbfc3315e2c99915ea.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_std_dh_hco_dh_id___0.c014a1da7b", "fqn": ["CGOncology_MDM", "standardization", "dbt_expectations_expect_column_values_to_not_match_regex_std_dh_hco_dh_id___0"], "alias": "dbt_expectations_expect_column_59b45276f6b60dfbfc3315e2c99915ea", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_column_59b45276f6b60dfbfc3315e2c99915ea", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_expectations_expect_column_59b45276f6b60dfbfc3315e2c99915ea"}, "created_at": 1770177079.443126, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_column_values_to_not_match_regex(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_expectations_expect_column_59b45276f6b60dfbfc3315e2c99915ea\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_column_values_to_not_match_regex", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "dh_id", "file_key_name": "models.std_dh_hco", "attached_node": "model.CGOncology_MDM.std_dh_hco", "test_metadata": {"name": "expect_column_values_to_not_match_regex", "kwargs": {"column_name": "dh_id", "regex": "[.]0", "model": "{{ get_where_subquery(ref('std_dh_hco')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.dbt_expectations_expect_column_value_lengths_to_be_between_std_dh_hco_normalized_org_name__2.5f688cf1f4": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_column_value_lengths_to_be_between_std_dh_hco_normalized_org_name__2", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_column_7911da26c9946d698b80f2d63d7dc4e3.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_column_value_lengths_to_be_between_std_dh_hco_normalized_org_name__2.5f688cf1f4", "fqn": ["CGOncology_MDM", "standardization", "dbt_expectations_expect_column_value_lengths_to_be_between_std_dh_hco_normalized_org_name__2"], "alias": "dbt_expectations_expect_column_7911da26c9946d698b80f2d63d7dc4e3", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_column_7911da26c9946d698b80f2d63d7dc4e3", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": "normalized_org_name IS NOT NULL", "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"where": "normalized_org_name IS NOT NULL", "alias": "dbt_expectations_expect_column_7911da26c9946d698b80f2d63d7dc4e3"}, "created_at": 1770177079.4448152, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_column_value_lengths_to_be_between(**_dbt_generic_test_kwargs) }}{{ config(where=\"normalized_org_name IS NOT NULL\",alias=\"dbt_expectations_expect_column_7911da26c9946d698b80f2d63d7dc4e3\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_column_value_lengths_to_be_between", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "normalized_org_name", "file_key_name": "models.std_dh_hco", "attached_node": "model.CGOncology_MDM.std_dh_hco", "test_metadata": {"name": "expect_column_value_lengths_to_be_between", "kwargs": {"column_name": "normalized_org_name", "min_value": 2, "model": "{{ get_where_subquery(ref('std_dh_hco')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_dh_hco_hq_address_line_1___a_z___hq_address_line_1_IS_NOT_NULL.027089ef29": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_column_values_to_match_regex_std_dh_hco_hq_address_line_1___a_z___hq_address_line_1_IS_NOT_NULL", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_column_afc73e63829eb2abb822a96e9d02e9b4.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_dh_hco_hq_address_line_1___a_z___hq_address_line_1_IS_NOT_NULL.027089ef29", "fqn": ["CGOncology_MDM", "standardization", "dbt_expectations_expect_column_values_to_match_regex_std_dh_hco_hq_address_line_1___a_z___hq_address_line_1_IS_NOT_NULL"], "alias": "dbt_expectations_expect_column_afc73e63829eb2abb822a96e9d02e9b4", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_column_afc73e63829eb2abb822a96e9d02e9b4", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_expectations_expect_column_afc73e63829eb2abb822a96e9d02e9b4"}, "created_at": 1770177079.446243, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_column_values_to_match_regex(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_expectations_expect_column_afc73e63829eb2abb822a96e9d02e9b4\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_column_values_to_match_regex", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "hq_address_line_1", "file_key_name": "models.std_dh_hco", "attached_node": "model.CGOncology_MDM.std_dh_hco", "test_metadata": {"name": "expect_column_values_to_match_regex", "kwargs": {"column_name": "hq_address_line_1", "regex": "^[^a-z]+$", "row_condition": "hq_address_line_1 IS NOT NULL", "model": "{{ get_where_subquery(ref('std_dh_hco')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_std_dh_hco_hq_address_line_1_____hq_address_line_1_IS_NOT_NULL.bb2ad3576e": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_column_values_to_not_match_regex_std_dh_hco_hq_address_line_1_____hq_address_line_1_IS_NOT_NULL", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_column_aafbd353a0c2dddd21541339a09b78fe.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_std_dh_hco_hq_address_line_1_____hq_address_line_1_IS_NOT_NULL.bb2ad3576e", "fqn": ["CGOncology_MDM", "standardization", "dbt_expectations_expect_column_values_to_not_match_regex_std_dh_hco_hq_address_line_1_____hq_address_line_1_IS_NOT_NULL"], "alias": "dbt_expectations_expect_column_aafbd353a0c2dddd21541339a09b78fe", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_column_aafbd353a0c2dddd21541339a09b78fe", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_expectations_expect_column_aafbd353a0c2dddd21541339a09b78fe"}, "created_at": 1770177079.447863, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_column_values_to_not_match_regex(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_expectations_expect_column_aafbd353a0c2dddd21541339a09b78fe\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_column_values_to_not_match_regex", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "hq_address_line_1", "file_key_name": "models.std_dh_hco", "attached_node": "model.CGOncology_MDM.std_dh_hco", "test_metadata": {"name": "expect_column_values_to_not_match_regex", "kwargs": {"column_name": "hq_address_line_1", "regex": "  ", "row_condition": "hq_address_line_1 IS NOT NULL", "model": "{{ get_where_subquery(ref('std_dh_hco')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_dh_hco_hq_city___a_z___hq_city_IS_NOT_NULL.be52dcc2b8": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_column_values_to_match_regex_std_dh_hco_hq_city___a_z___hq_city_IS_NOT_NULL", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_column_4622b697ec9dde70171f84018fc78200.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_dh_hco_hq_city___a_z___hq_city_IS_NOT_NULL.be52dcc2b8", "fqn": ["CGOncology_MDM", "standardization", "dbt_expectations_expect_column_values_to_match_regex_std_dh_hco_hq_city___a_z___hq_city_IS_NOT_NULL"], "alias": "dbt_expectations_expect_column_4622b697ec9dde70171f84018fc78200", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_column_4622b697ec9dde70171f84018fc78200", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_expectations_expect_column_4622b697ec9dde70171f84018fc78200"}, "created_at": 1770177079.449209, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_column_values_to_match_regex(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_expectations_expect_column_4622b697ec9dde70171f84018fc78200\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_column_values_to_match_regex", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "hq_city", "file_key_name": "models.std_dh_hco", "attached_node": "model.CGOncology_MDM.std_dh_hco", "test_metadata": {"name": "expect_column_values_to_match_regex", "kwargs": {"column_name": "hq_city", "regex": "^[^a-z]+$", "row_condition": "hq_city IS NOT NULL", "model": "{{ get_where_subquery(ref('std_dh_hco')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.not_null_std_dh_hco_source_hash.c5c2443af6": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dh_hco_source_hash", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dh_hco_source_hash.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dh_hco_source_hash.c5c2443af6", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dh_hco_source_hash"], "alias": "not_null_std_dh_hco_source_hash", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.4505322, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dh_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "source_hash", "file_key_name": "models.std_dh_hco", "attached_node": "model.CGOncology_MDM.std_dh_hco", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "source_hash", "model": "{{ get_where_subquery(ref('std_dh_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_expectations_expect_column_value_lengths_to_be_between_std_dh_hco_source_hash__64__64.524a96ddc2": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_column_value_lengths_to_be_between_std_dh_hco_source_hash__64__64", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_column_8a4bda78cda92b413304eeba68a73ec6.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_column_value_lengths_to_be_between_std_dh_hco_source_hash__64__64.524a96ddc2", "fqn": ["CGOncology_MDM", "standardization", "dbt_expectations_expect_column_value_lengths_to_be_between_std_dh_hco_source_hash__64__64"], "alias": "dbt_expectations_expect_column_8a4bda78cda92b413304eeba68a73ec6", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_column_8a4bda78cda92b413304eeba68a73ec6", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_expectations_expect_column_8a4bda78cda92b413304eeba68a73ec6"}, "created_at": 1770177079.451041, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_column_value_lengths_to_be_between(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_expectations_expect_column_8a4bda78cda92b413304eeba68a73ec6\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_column_value_lengths_to_be_between", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "source_hash", "file_key_name": "models.std_dh_hco", "attached_node": "model.CGOncology_MDM.std_dh_hco", "test_metadata": {"name": "expect_column_value_lengths_to_be_between", "kwargs": {"column_name": "source_hash", "min_value": 64, "max_value": 64, "model": "{{ get_where_subquery(ref('std_dh_hco')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.accepted_values_std_dh_hco_hq_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY__DC__PR__VI__GU__AS__MP.22828f4652": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_std_dh_hco_hq_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY__DC__PR__VI__GU__AS__MP", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_std_dh_hco_0789528e7e897976e09c9d5596294291.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_std_dh_hco_hq_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY__DC__PR__VI__GU__AS__MP.22828f4652", "fqn": ["CGOncology_MDM", "standardization", "accepted_values_std_dh_hco_hq_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY__DC__PR__VI__GU__AS__MP"], "alias": "accepted_values_std_dh_hco_0789528e7e897976e09c9d5596294291", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_std_dh_hco_0789528e7e897976e09c9d5596294291", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": "hq_state IS NOT NULL", "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"where": "hq_state IS NOT NULL", "alias": "accepted_values_std_dh_hco_0789528e7e897976e09c9d5596294291"}, "created_at": 1770177079.4527009, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(where=\"hq_state IS NOT NULL\",alias=\"accepted_values_std_dh_hco_0789528e7e897976e09c9d5596294291\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "hq_state", "file_key_name": "models.std_dh_hco", "attached_node": "model.CGOncology_MDM.std_dh_hco", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "hq_state", "values": ["AL", "AK", "AZ", "AR", "CA", "CO", "CT", "DE", "FL", "GA", "HI", "ID", "IL", "IN", "IA", "KS", "KY", "LA", "ME", "MD", "MA", "MI", "MN", "MS", "MO", "MT", "NE", "NV", "NH", "NJ", "NM", "NY", "NC", "ND", "OH", "OK", "OR", "PA", "RI", "SC", "SD", "TN", "TX", "UT", "VT", "VA", "WA", "WV", "WI", "WY", "DC", "PR", "VI", "GU", "AS", "MP"], "model": "{{ get_where_subquery(ref('std_dh_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_dh_hco_hq_zip_code___0_9_5___hq_zip_code_IS_NOT_NULL.53831fcfe7": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_column_values_to_match_regex_std_dh_hco_hq_zip_code___0_9_5___hq_zip_code_IS_NOT_NULL", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_column_6532c75ec065db8762d8d27f480f8eee.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_dh_hco_hq_zip_code___0_9_5___hq_zip_code_IS_NOT_NULL.53831fcfe7", "fqn": ["CGOncology_MDM", "standardization", "dbt_expectations_expect_column_values_to_match_regex_std_dh_hco_hq_zip_code___0_9_5___hq_zip_code_IS_NOT_NULL"], "alias": "dbt_expectations_expect_column_6532c75ec065db8762d8d27f480f8eee", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_column_6532c75ec065db8762d8d27f480f8eee", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_expectations_expect_column_6532c75ec065db8762d8d27f480f8eee"}, "created_at": 1770177079.4540958, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_column_values_to_match_regex(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_expectations_expect_column_6532c75ec065db8762d8d27f480f8eee\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_column_values_to_match_regex", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "hq_zip_code", "file_key_name": "models.std_dh_hco", "attached_node": "model.CGOncology_MDM.std_dh_hco", "test_metadata": {"name": "expect_column_values_to_match_regex", "kwargs": {"column_name": "hq_zip_code", "regex": "^[0-9]{5}$", "row_condition": "hq_zip_code IS NOT NULL", "model": "{{ get_where_subquery(ref('std_dh_hco')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.row_count_match_std_dh_hco_source_raw_dh_PRELAND_DH_ALL_COMPANIES_OVERVIEW_.8f7f1522b5": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "row_count_match_std_dh_hco_source_raw_dh_PRELAND_DH_ALL_COMPANIES_OVERVIEW_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "row_count_match_std_dh_hco_d63cdd466644d36b8d074d7c1e02eca7.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.row_count_match_std_dh_hco_source_raw_dh_PRELAND_DH_ALL_COMPANIES_OVERVIEW_.8f7f1522b5", "fqn": ["CGOncology_MDM", "standardization", "row_count_match_std_dh_hco_source_raw_dh_PRELAND_DH_ALL_COMPANIES_OVERVIEW_"], "alias": "row_count_match_std_dh_hco_d63cdd466644d36b8d074d7c1e02eca7", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "row_count_match_std_dh_hco_d63cdd466644d36b8d074d7c1e02eca7", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "row_count_match_std_dh_hco_d63cdd466644d36b8d074d7c1e02eca7"}, "created_at": 1770177079.455474, "relation_name": null, "raw_code": "{{ test_row_count_match(**_dbt_generic_test_kwargs) }}{{ config(alias=\"row_count_match_std_dh_hco_d63cdd466644d36b8d074d7c1e02eca7\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hco", "package": null, "version": null}], "sources": [["raw_dh", "PRELAND_DH_ALL_COMPANIES_OVERVIEW"]], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.CGOncology_MDM.test_row_count_match", "macro.dbt.get_where_subquery"], "nodes": ["source.CGOncology_MDM.raw_dh.PRELAND_DH_ALL_COMPANIES_OVERVIEW", "model.CGOncology_MDM.std_dh_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.std_dh_hco", "attached_node": "model.CGOncology_MDM.std_dh_hco", "test_metadata": {"name": "row_count_match", "kwargs": {"source_model": "source('raw_dh', 'PRELAND_DH_ALL_COMPANIES_OVERVIEW')", "model": "{{ get_where_subquery(ref('std_dh_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_expectations_expect_table_row_count_to_be_between_std_dh_hco_300000.3c0c96a031": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_table_row_count_to_be_between_std_dh_hco_300000", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_table__9b20d7b923ec62f38fc6d26a440569e1.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_table_row_count_to_be_between_std_dh_hco_300000.3c0c96a031", "fqn": ["CGOncology_MDM", "standardization", "dbt_expectations_expect_table_row_count_to_be_between_std_dh_hco_300000"], "alias": "dbt_expectations_expect_table__9b20d7b923ec62f38fc6d26a440569e1", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_table__9b20d7b923ec62f38fc6d26a440569e1", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_expectations_expect_table__9b20d7b923ec62f38fc6d26a440569e1"}, "created_at": 1770177079.457037, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_table_row_count_to_be_between(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_expectations_expect_table__9b20d7b923ec62f38fc6d26a440569e1\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_table_row_count_to_be_between", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.std_dh_hco", "attached_node": "model.CGOncology_MDM.std_dh_hco", "test_metadata": {"name": "expect_table_row_count_to_be_between", "kwargs": {"min_value": 300000, "model": "{{ get_where_subquery(ref('std_dh_hco')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.not_null_std_dh_hcp_npi.f78527bf39": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dh_hcp_npi", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dh_hcp_npi.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dh_hcp_npi.f78527bf39", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dh_hcp_npi"], "alias": "not_null_std_dh_hcp_npi", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.459051, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dh_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "npi", "file_key_name": "models.std_dh_hcp", "attached_node": "model.CGOncology_MDM.std_dh_hcp", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "npi", "model": "{{ get_where_subquery(ref('std_dh_hcp')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_std_dh_hcp_npi.3d97c53efa": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_std_dh_hcp_npi", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_std_dh_hcp_npi.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.unique_std_dh_hcp_npi.3d97c53efa", "fqn": ["CGOncology_MDM", "standardization", "unique_std_dh_hcp_npi"], "alias": "unique_std_dh_hcp_npi", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.459624, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.CGOncology_MDM.std_dh_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "npi", "file_key_name": "models.std_dh_hcp", "attached_node": "model.CGOncology_MDM.std_dh_hcp", "test_metadata": {"name": "unique", "kwargs": {"column_name": "npi", "model": "{{ get_where_subquery(ref('std_dh_hcp')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_dh_hcp_npi___0_9_10_.f3ce611aa7": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_column_values_to_match_regex_std_dh_hcp_npi___0_9_10_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_column_54cfc9d9b75fb1e36591f29eb87ca8fc.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_dh_hcp_npi___0_9_10_.f3ce611aa7", "fqn": ["CGOncology_MDM", "standardization", "dbt_expectations_expect_column_values_to_match_regex_std_dh_hcp_npi___0_9_10_"], "alias": "dbt_expectations_expect_column_54cfc9d9b75fb1e36591f29eb87ca8fc", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_column_54cfc9d9b75fb1e36591f29eb87ca8fc", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_expectations_expect_column_54cfc9d9b75fb1e36591f29eb87ca8fc"}, "created_at": 1770177079.460143, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_column_values_to_match_regex(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_expectations_expect_column_54cfc9d9b75fb1e36591f29eb87ca8fc\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_column_values_to_match_regex", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "npi", "file_key_name": "models.std_dh_hcp", "attached_node": "model.CGOncology_MDM.std_dh_hcp", "test_metadata": {"name": "expect_column_values_to_match_regex", "kwargs": {"column_name": "npi", "regex": "^[0-9]{10}$", "model": "{{ get_where_subquery(ref('std_dh_hcp')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.not_null_std_dh_hcp_last_name.4a4b23e2b8": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dh_hcp_last_name", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dh_hcp_last_name.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dh_hcp_last_name.4a4b23e2b8", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dh_hcp_last_name"], "alias": "not_null_std_dh_hcp_last_name", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.4618182, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dh_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "last_name", "file_key_name": "models.std_dh_hcp", "attached_node": "model.CGOncology_MDM.std_dh_hcp", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "last_name", "model": "{{ get_where_subquery(ref('std_dh_hcp')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_std_dh_hcp_last_name_____last_name_IS_NOT_NULL.1257101c2c": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_column_values_to_not_match_regex_std_dh_hcp_last_name_____last_name_IS_NOT_NULL", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_column_5b463d05a4dddf6b468e09b3aa389028.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_std_dh_hcp_last_name_____last_name_IS_NOT_NULL.1257101c2c", "fqn": ["CGOncology_MDM", "standardization", "dbt_expectations_expect_column_values_to_not_match_regex_std_dh_hcp_last_name_____last_name_IS_NOT_NULL"], "alias": "dbt_expectations_expect_column_5b463d05a4dddf6b468e09b3aa389028", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_column_5b463d05a4dddf6b468e09b3aa389028", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_expectations_expect_column_5b463d05a4dddf6b468e09b3aa389028"}, "created_at": 1770177079.4623392, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_column_values_to_not_match_regex(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_expectations_expect_column_5b463d05a4dddf6b468e09b3aa389028\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_column_values_to_not_match_regex", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "last_name", "file_key_name": "models.std_dh_hcp", "attached_node": "model.CGOncology_MDM.std_dh_hcp", "test_metadata": {"name": "expect_column_values_to_not_match_regex", "kwargs": {"column_name": "last_name", "regex": "^ | $", "row_condition": "last_name IS NOT NULL", "model": "{{ get_where_subquery(ref('std_dh_hcp')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_std_dh_hcp_first_name_____first_name_IS_NOT_NULL.d2932f7c96": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_column_values_to_not_match_regex_std_dh_hcp_first_name_____first_name_IS_NOT_NULL", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_column_ef52b6cbcf2aba8cf9965302de0b8b11.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_std_dh_hcp_first_name_____first_name_IS_NOT_NULL.d2932f7c96", "fqn": ["CGOncology_MDM", "standardization", "dbt_expectations_expect_column_values_to_not_match_regex_std_dh_hcp_first_name_____first_name_IS_NOT_NULL"], "alias": "dbt_expectations_expect_column_ef52b6cbcf2aba8cf9965302de0b8b11", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_column_ef52b6cbcf2aba8cf9965302de0b8b11", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_expectations_expect_column_ef52b6cbcf2aba8cf9965302de0b8b11"}, "created_at": 1770177079.463797, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_column_values_to_not_match_regex(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_expectations_expect_column_ef52b6cbcf2aba8cf9965302de0b8b11\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_column_values_to_not_match_regex", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "first_name", "file_key_name": "models.std_dh_hcp", "attached_node": "model.CGOncology_MDM.std_dh_hcp", "test_metadata": {"name": "expect_column_values_to_not_match_regex", "kwargs": {"column_name": "first_name", "regex": "^ | $", "row_condition": "first_name IS NOT NULL", "model": "{{ get_where_subquery(ref('std_dh_hcp')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.accepted_values_std_dh_hcp_practice_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY__DC__PR__VI__GU__AS__MP__NS__PH.cc7ab9603a": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_std_dh_hcp_practice_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY__DC__PR__VI__GU__AS__MP__NS__PH", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_std_dh_hcp_9bf419822bcd870e42cd391a8fab3610.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_std_dh_hcp_practice_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY__DC__PR__VI__GU__AS__MP__NS__PH.cc7ab9603a", "fqn": ["CGOncology_MDM", "standardization", "accepted_values_std_dh_hcp_practice_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY__DC__PR__VI__GU__AS__MP__NS__PH"], "alias": "accepted_values_std_dh_hcp_9bf419822bcd870e42cd391a8fab3610", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_std_dh_hcp_9bf419822bcd870e42cd391a8fab3610", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": "practice_state IS NOT NULL", "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"where": "practice_state IS NOT NULL", "alias": "accepted_values_std_dh_hcp_9bf419822bcd870e42cd391a8fab3610"}, "created_at": 1770177079.465489, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(where=\"practice_state IS NOT NULL\",alias=\"accepted_values_std_dh_hcp_9bf419822bcd870e42cd391a8fab3610\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "practice_state", "file_key_name": "models.std_dh_hcp", "attached_node": "model.CGOncology_MDM.std_dh_hcp", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "practice_state", "values": ["AL", "AK", "AZ", "AR", "CA", "CO", "CT", "DE", "FL", "GA", "HI", "ID", "IL", "IN", "IA", "KS", "KY", "LA", "ME", "MD", "MA", "MI", "MN", "MS", "MO", "MT", "NE", "NV", "NH", "NJ", "NM", "NY", "NC", "ND", "OH", "OK", "OR", "PA", "RI", "SC", "SD", "TN", "TX", "UT", "VT", "VA", "WA", "WV", "WI", "WY", "DC", "PR", "VI", "GU", "AS", "MP", "NS", "PH"], "model": "{{ get_where_subquery(ref('std_dh_hcp')) }}"}, "namespace": null}}, "test.CGOncology_MDM.row_count_match_std_dh_hcp_NPI_IS_NOT_NULL__source_raw_dh_PRELAND_DH_PHYSICIANS_OVERVIEW_.396fdde72a": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "row_count_match_std_dh_hcp_NPI_IS_NOT_NULL__source_raw_dh_PRELAND_DH_PHYSICIANS_OVERVIEW_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "row_count_match_std_dh_hcp_4c544f630b296ca9e34def0de5fb885b.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.row_count_match_std_dh_hcp_NPI_IS_NOT_NULL__source_raw_dh_PRELAND_DH_PHYSICIANS_OVERVIEW_.396fdde72a", "fqn": ["CGOncology_MDM", "standardization", "row_count_match_std_dh_hcp_NPI_IS_NOT_NULL__source_raw_dh_PRELAND_DH_PHYSICIANS_OVERVIEW_"], "alias": "row_count_match_std_dh_hcp_4c544f630b296ca9e34def0de5fb885b", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "row_count_match_std_dh_hcp_4c544f630b296ca9e34def0de5fb885b", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "row_count_match_std_dh_hcp_4c544f630b296ca9e34def0de5fb885b"}, "created_at": 1770177079.466955, "relation_name": null, "raw_code": "{{ test_row_count_match(**_dbt_generic_test_kwargs) }}{{ config(alias=\"row_count_match_std_dh_hcp_4c544f630b296ca9e34def0de5fb885b\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hcp", "package": null, "version": null}], "sources": [["raw_dh", "PRELAND_DH_PHYSICIANS_OVERVIEW"]], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.CGOncology_MDM.test_row_count_match", "macro.dbt.get_where_subquery"], "nodes": ["source.CGOncology_MDM.raw_dh.PRELAND_DH_PHYSICIANS_OVERVIEW", "model.CGOncology_MDM.std_dh_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.std_dh_hcp", "attached_node": "model.CGOncology_MDM.std_dh_hcp", "test_metadata": {"name": "row_count_match", "kwargs": {"source_model": "source('raw_dh', 'PRELAND_DH_PHYSICIANS_OVERVIEW')", "source_filter": "NPI IS NOT NULL", "model": "{{ get_where_subquery(ref('std_dh_hcp')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_dh_practice_location_practice_location_id.87970307c4": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dh_practice_location_practice_location_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dh_practice_location_practice_location_id.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dh_practice_location_practice_location_id.87970307c4", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dh_practice_location_practice_location_id"], "alias": "not_null_std_dh_practice_location_practice_location_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.46845, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_practice_location", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dh_practice_location"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "practice_location_id", "file_key_name": "models.std_dh_practice_location", "attached_node": "model.CGOncology_MDM.std_dh_practice_location", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "practice_location_id", "model": "{{ get_where_subquery(ref('std_dh_practice_location')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_std_dh_practice_location_practice_location_id.d81b4d0eeb": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_std_dh_practice_location_practice_location_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_std_dh_practice_location_practice_location_id.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.unique_std_dh_practice_location_practice_location_id.d81b4d0eeb", "fqn": ["CGOncology_MDM", "standardization", "unique_std_dh_practice_location_practice_location_id"], "alias": "unique_std_dh_practice_location_practice_location_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.4689548, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_practice_location", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.CGOncology_MDM.std_dh_practice_location"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "practice_location_id", "file_key_name": "models.std_dh_practice_location", "attached_node": "model.CGOncology_MDM.std_dh_practice_location", "test_metadata": {"name": "unique", "kwargs": {"column_name": "practice_location_id", "model": "{{ get_where_subquery(ref('std_dh_practice_location')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_dh_practice_location_address_line_1___a_z___address_line_1_IS_NOT_NULL.7604558e84": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_column_values_to_match_regex_std_dh_practice_location_address_line_1___a_z___address_line_1_IS_NOT_NULL", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_column_acc6312ffc0d2385ceade5349eabff47.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_dh_practice_location_address_line_1___a_z___address_line_1_IS_NOT_NULL.7604558e84", "fqn": ["CGOncology_MDM", "standardization", "dbt_expectations_expect_column_values_to_match_regex_std_dh_practice_location_address_line_1___a_z___address_line_1_IS_NOT_NULL"], "alias": "dbt_expectations_expect_column_acc6312ffc0d2385ceade5349eabff47", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_column_acc6312ffc0d2385ceade5349eabff47", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_expectations_expect_column_acc6312ffc0d2385ceade5349eabff47"}, "created_at": 1770177079.469464, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_column_values_to_match_regex(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_expectations_expect_column_acc6312ffc0d2385ceade5349eabff47\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_practice_location", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_column_values_to_match_regex", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_practice_location"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "address_line_1", "file_key_name": "models.std_dh_practice_location", "attached_node": "model.CGOncology_MDM.std_dh_practice_location", "test_metadata": {"name": "expect_column_values_to_match_regex", "kwargs": {"column_name": "address_line_1", "regex": "^[^a-z]+$", "row_condition": "address_line_1 IS NOT NULL", "model": "{{ get_where_subquery(ref('std_dh_practice_location')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_std_dh_practice_location_address_line_1_____address_line_1_IS_NOT_NULL.d38c4fa34d": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_column_values_to_not_match_regex_std_dh_practice_location_address_line_1_____address_line_1_IS_NOT_NULL", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_column_824e83e53bcca68391c7f67500edd438.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_std_dh_practice_location_address_line_1_____address_line_1_IS_NOT_NULL.d38c4fa34d", "fqn": ["CGOncology_MDM", "standardization", "dbt_expectations_expect_column_values_to_not_match_regex_std_dh_practice_location_address_line_1_____address_line_1_IS_NOT_NULL"], "alias": "dbt_expectations_expect_column_824e83e53bcca68391c7f67500edd438", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_column_824e83e53bcca68391c7f67500edd438", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_expectations_expect_column_824e83e53bcca68391c7f67500edd438"}, "created_at": 1770177079.470838, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_column_values_to_not_match_regex(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_expectations_expect_column_824e83e53bcca68391c7f67500edd438\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_practice_location", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_column_values_to_not_match_regex", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_practice_location"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "address_line_1", "file_key_name": "models.std_dh_practice_location", "attached_node": "model.CGOncology_MDM.std_dh_practice_location", "test_metadata": {"name": "expect_column_values_to_not_match_regex", "kwargs": {"column_name": "address_line_1", "regex": "  ", "row_condition": "address_line_1 IS NOT NULL", "model": "{{ get_where_subquery(ref('std_dh_practice_location')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_dh_practice_location_zip_code___0_9_5___zip_code_IS_NOT_NULL.08e160408e": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_column_values_to_match_regex_std_dh_practice_location_zip_code___0_9_5___zip_code_IS_NOT_NULL", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_column_283725f123c6d82f672446b43fabaadf.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_dh_practice_location_zip_code___0_9_5___zip_code_IS_NOT_NULL.08e160408e", "fqn": ["CGOncology_MDM", "standardization", "dbt_expectations_expect_column_values_to_match_regex_std_dh_practice_location_zip_code___0_9_5___zip_code_IS_NOT_NULL"], "alias": "dbt_expectations_expect_column_283725f123c6d82f672446b43fabaadf", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_column_283725f123c6d82f672446b43fabaadf", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_expectations_expect_column_283725f123c6d82f672446b43fabaadf"}, "created_at": 1770177079.472446, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_column_values_to_match_regex(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_expectations_expect_column_283725f123c6d82f672446b43fabaadf\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_practice_location", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_column_values_to_match_regex", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_practice_location"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "zip_code", "file_key_name": "models.std_dh_practice_location", "attached_node": "model.CGOncology_MDM.std_dh_practice_location", "test_metadata": {"name": "expect_column_values_to_match_regex", "kwargs": {"column_name": "zip_code", "regex": "^[0-9]{5}$", "row_condition": "zip_code IS NOT NULL", "model": "{{ get_where_subquery(ref('std_dh_practice_location')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.accepted_values_std_dh_practice_location_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY__DC__PR__VI__GU__AS__MP.4b60111d92": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_std_dh_practice_location_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY__DC__PR__VI__GU__AS__MP", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_std_dh_practic_56834f73fdf94f43c5c311a3fd4df385.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_std_dh_practice_location_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY__DC__PR__VI__GU__AS__MP.4b60111d92", "fqn": ["CGOncology_MDM", "standardization", "accepted_values_std_dh_practice_location_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY__DC__PR__VI__GU__AS__MP"], "alias": "accepted_values_std_dh_practic_56834f73fdf94f43c5c311a3fd4df385", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_std_dh_practic_56834f73fdf94f43c5c311a3fd4df385", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": "state IS NOT NULL", "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"where": "state IS NOT NULL", "alias": "accepted_values_std_dh_practic_56834f73fdf94f43c5c311a3fd4df385"}, "created_at": 1770177079.473803, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(where=\"state IS NOT NULL\",alias=\"accepted_values_std_dh_practic_56834f73fdf94f43c5c311a3fd4df385\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_practice_location", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_practice_location"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "state", "file_key_name": "models.std_dh_practice_location", "attached_node": "model.CGOncology_MDM.std_dh_practice_location", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "state", "values": ["AL", "AK", "AZ", "AR", "CA", "CO", "CT", "DE", "FL", "GA", "HI", "ID", "IL", "IN", "IA", "KS", "KY", "LA", "ME", "MD", "MA", "MI", "MN", "MS", "MO", "MT", "NE", "NV", "NH", "NJ", "NM", "NY", "NC", "ND", "OH", "OK", "OR", "PA", "RI", "SC", "SD", "TN", "TX", "UT", "VT", "VA", "WA", "WV", "WI", "WY", "DC", "PR", "VI", "GU", "AS", "MP"], "model": "{{ get_where_subquery(ref('std_dh_practice_location')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_dh_practice_location_unique_combined_key.c6f3a69f42": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dh_practice_location_unique_combined_key", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dh_practice_location_unique_combined_key.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dh_practice_location_unique_combined_key.c6f3a69f42", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dh_practice_location_unique_combined_key"], "alias": "not_null_std_dh_practice_location_unique_combined_key", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.475153, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_practice_location", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dh_practice_location"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "unique_combined_key", "file_key_name": "models.std_dh_practice_location", "attached_node": "model.CGOncology_MDM.std_dh_practice_location", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "unique_combined_key", "model": "{{ get_where_subquery(ref('std_dh_practice_location')) }}"}, "namespace": null}}, "test.CGOncology_MDM.row_count_match_std_dh_practice_location_PRACTICE_LOCATION_ID_IS_NOT_NULL__source_raw_dh_PRELAND_DH_PHYSICIAN_GROUP_PRACTICE_LOCATION_.176238d91c": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "row_count_match_std_dh_practice_location_PRACTICE_LOCATION_ID_IS_NOT_NULL__source_raw_dh_PRELAND_DH_PHYSICIAN_GROUP_PRACTICE_LOCATION_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "row_count_match_std_dh_practic_68d40255e0ad94879c0e641c2ffedead.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.row_count_match_std_dh_practice_location_PRACTICE_LOCATION_ID_IS_NOT_NULL__source_raw_dh_PRELAND_DH_PHYSICIAN_GROUP_PRACTICE_LOCATION_.176238d91c", "fqn": ["CGOncology_MDM", "standardization", "row_count_match_std_dh_practice_location_PRACTICE_LOCATION_ID_IS_NOT_NULL__source_raw_dh_PRELAND_DH_PHYSICIAN_GROUP_PRACTICE_LOCATION_"], "alias": "row_count_match_std_dh_practic_68d40255e0ad94879c0e641c2ffedead", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "row_count_match_std_dh_practic_68d40255e0ad94879c0e641c2ffedead", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "row_count_match_std_dh_practic_68d40255e0ad94879c0e641c2ffedead"}, "created_at": 1770177079.475749, "relation_name": null, "raw_code": "{{ test_row_count_match(**_dbt_generic_test_kwargs) }}{{ config(alias=\"row_count_match_std_dh_practic_68d40255e0ad94879c0e641c2ffedead\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_practice_location", "package": null, "version": null}], "sources": [["raw_dh", "PRELAND_DH_PHYSICIAN_GROUP_PRACTICE_LOCATION"]], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.CGOncology_MDM.test_row_count_match", "macro.dbt.get_where_subquery"], "nodes": ["source.CGOncology_MDM.raw_dh.PRELAND_DH_PHYSICIAN_GROUP_PRACTICE_LOCATION", "model.CGOncology_MDM.std_dh_practice_location"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.std_dh_practice_location", "attached_node": "model.CGOncology_MDM.std_dh_practice_location", "test_metadata": {"name": "row_count_match", "kwargs": {"source_model": "source('raw_dh', 'PRELAND_DH_PHYSICIAN_GROUP_PRACTICE_LOCATION')", "source_filter": "PRACTICE_LOCATION_ID IS NOT NULL", "model": "{{ get_where_subquery(ref('std_dh_practice_location')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_npi.980d3a3d64": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dh_hcp_hco_affiliation_npi", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dh_hcp_hco_affiliation_npi.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_npi.980d3a3d64", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dh_hcp_hco_affiliation_npi"], "alias": "not_null_std_dh_hcp_hco_affiliation_npi", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.477514, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hcp_hco_affiliation", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dh_hcp_hco_affiliation"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "npi", "file_key_name": "models.std_dh_hcp_hco_affiliation", "attached_node": "model.CGOncology_MDM.std_dh_hcp_hco_affiliation", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "npi", "model": "{{ get_where_subquery(ref('std_dh_hcp_hco_affiliation')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_affiliated_dh_id.d792350727": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dh_hcp_hco_affiliation_affiliated_dh_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dh_hcp_hco_affiliation_affiliated_dh_id.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_affiliated_dh_id.d792350727", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dh_hcp_hco_affiliation_affiliated_dh_id"], "alias": "not_null_std_dh_hcp_hco_affiliation_affiliated_dh_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.478336, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hcp_hco_affiliation", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dh_hcp_hco_affiliation"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "affiliated_dh_id", "file_key_name": "models.std_dh_hcp_hco_affiliation", "attached_node": "model.CGOncology_MDM.std_dh_hcp_hco_affiliation", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "affiliated_dh_id", "model": "{{ get_where_subquery(ref('std_dh_hcp_hco_affiliation')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_std_dh_hcp_hco_affiliation_affiliation_type__CURRENT__HISTORICAL.c5017b3e1e": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_std_dh_hcp_hco_affiliation_affiliation_type__CURRENT__HISTORICAL", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_std_dh_hcp_hco_fddc0425ad783e7531e68120afcd61a2.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_std_dh_hcp_hco_affiliation_affiliation_type__CURRENT__HISTORICAL.c5017b3e1e", "fqn": ["CGOncology_MDM", "standardization", "accepted_values_std_dh_hcp_hco_affiliation_affiliation_type__CURRENT__HISTORICAL"], "alias": "accepted_values_std_dh_hcp_hco_fddc0425ad783e7531e68120afcd61a2", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_std_dh_hcp_hco_fddc0425ad783e7531e68120afcd61a2", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": "affiliation_type IS NOT NULL", "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"where": "affiliation_type IS NOT NULL", "alias": "accepted_values_std_dh_hcp_hco_fddc0425ad783e7531e68120afcd61a2"}, "created_at": 1770177079.478861, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(where=\"affiliation_type IS NOT NULL\",alias=\"accepted_values_std_dh_hcp_hco_fddc0425ad783e7531e68120afcd61a2\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hcp_hco_affiliation", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_hcp_hco_affiliation"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "affiliation_type", "file_key_name": "models.std_dh_hcp_hco_affiliation", "attached_node": "model.CGOncology_MDM.std_dh_hcp_hco_affiliation", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "affiliation_type", "values": ["CURRENT", "HISTORICAL"], "model": "{{ get_where_subquery(ref('std_dh_hcp_hco_affiliation')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_is_current.55af4662bf": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dh_hcp_hco_affiliation_is_current", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dh_hcp_hco_affiliation_is_current.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_is_current.55af4662bf", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dh_hcp_hco_affiliation_is_current"], "alias": "not_null_std_dh_hcp_hco_affiliation_is_current", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.480227, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hcp_hco_affiliation", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dh_hcp_hco_affiliation"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_current", "file_key_name": "models.std_dh_hcp_hco_affiliation", "attached_node": "model.CGOncology_MDM.std_dh_hcp_hco_affiliation", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "is_current", "model": "{{ get_where_subquery(ref('std_dh_hcp_hco_affiliation')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_std_dh_hcp_hco_affiliation_is_current__True__False.133669a192": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_std_dh_hcp_hco_affiliation_is_current__True__False", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_std_dh_hcp_hco_f5ce7ca7c1ce99654db2455261a55c05.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_std_dh_hcp_hco_affiliation_is_current__True__False.133669a192", "fqn": ["CGOncology_MDM", "standardization", "accepted_values_std_dh_hcp_hco_affiliation_is_current__True__False"], "alias": "accepted_values_std_dh_hcp_hco_f5ce7ca7c1ce99654db2455261a55c05", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_std_dh_hcp_hco_f5ce7ca7c1ce99654db2455261a55c05", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_std_dh_hcp_hco_f5ce7ca7c1ce99654db2455261a55c05"}, "created_at": 1770177079.4807308, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_std_dh_hcp_hco_f5ce7ca7c1ce99654db2455261a55c05\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hcp_hco_affiliation", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_hcp_hco_affiliation"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_current", "file_key_name": "models.std_dh_hcp_hco_affiliation", "attached_node": "model.CGOncology_MDM.std_dh_hcp_hco_affiliation", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "is_current", "values": [true, false], "model": "{{ get_where_subquery(ref('std_dh_hcp_hco_affiliation')) }}"}, "namespace": null}}, "test.CGOncology_MDM.row_count_match_std_dh_hcp_hco_affiliation_NPI_IS_NOT_NULL_AND_AFFILIATED_ID_IS_NOT_NULL_AND_TRIM_CAST_AFFILIATED_ID_AS_VARCHAR_50___source_raw_dh_PRELAND_DH_PHYSICIANS_FACILITY_AFFILIATION_.b965d97151": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "row_count_match_std_dh_hcp_hco_affiliation_NPI_IS_NOT_NULL_AND_AFFILIATED_ID_IS_NOT_NULL_AND_TRIM_CAST_AFFILIATED_ID_AS_VARCHAR_50___source_raw_dh_PRELAND_DH_PHYSICIANS_FACILITY_AFFILIATION_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "row_count_match_std_dh_hcp_hco_9c3532087d6a9c4cb176245d3699c010.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.row_count_match_std_dh_hcp_hco_affiliation_NPI_IS_NOT_NULL_AND_AFFILIATED_ID_IS_NOT_NULL_AND_TRIM_CAST_AFFILIATED_ID_AS_VARCHAR_50___source_raw_dh_PRELAND_DH_PHYSICIANS_FACILITY_AFFILIATION_.b965d97151", "fqn": ["CGOncology_MDM", "standardization", "row_count_match_std_dh_hcp_hco_affiliation_NPI_IS_NOT_NULL_AND_AFFILIATED_ID_IS_NOT_NULL_AND_TRIM_CAST_AFFILIATED_ID_AS_VARCHAR_50___source_raw_dh_PRELAND_DH_PHYSICIANS_FACILITY_AFFILIATION_"], "alias": "row_count_match_std_dh_hcp_hco_9c3532087d6a9c4cb176245d3699c010", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "row_count_match_std_dh_hcp_hco_9c3532087d6a9c4cb176245d3699c010", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "row_count_match_std_dh_hcp_hco_9c3532087d6a9c4cb176245d3699c010"}, "created_at": 1770177079.4820118, "relation_name": null, "raw_code": "{{ test_row_count_match(**_dbt_generic_test_kwargs) }}{{ config(alias=\"row_count_match_std_dh_hcp_hco_9c3532087d6a9c4cb176245d3699c010\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hcp_hco_affiliation", "package": null, "version": null}], "sources": [["raw_dh", "PRELAND_DH_PHYSICIANS_FACILITY_AFFILIATION"]], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.CGOncology_MDM.test_row_count_match", "macro.dbt.get_where_subquery"], "nodes": ["source.CGOncology_MDM.raw_dh.PRELAND_DH_PHYSICIANS_FACILITY_AFFILIATION", "model.CGOncology_MDM.std_dh_hcp_hco_affiliation"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.std_dh_hcp_hco_affiliation", "attached_node": "model.CGOncology_MDM.std_dh_hcp_hco_affiliation", "test_metadata": {"name": "row_count_match", "kwargs": {"source_model": "source('raw_dh', 'PRELAND_DH_PHYSICIANS_FACILITY_AFFILIATION')", "source_filter": "NPI IS NOT NULL AND AFFILIATED_ID IS NOT NULL AND TRIM(CAST(AFFILIATED_ID AS VARCHAR(50))) <> ''", "model": "{{ get_where_subquery(ref('std_dh_hcp_hco_affiliation')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_hcp_hco_affiliation_npi__affiliated_dh_id.59c0275aa4": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_utils_unique_combination_of_columns_std_dh_hcp_hco_affiliation_npi__affiliated_dh_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_utils_unique_combination_o_92e1c2d804a3c238adfdd99df9162273.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_hcp_hco_affiliation_npi__affiliated_dh_id.59c0275aa4", "fqn": ["CGOncology_MDM", "standardization", "dbt_utils_unique_combination_of_columns_std_dh_hcp_hco_affiliation_npi__affiliated_dh_id"], "alias": "dbt_utils_unique_combination_o_92e1c2d804a3c238adfdd99df9162273", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_utils_unique_combination_o_92e1c2d804a3c238adfdd99df9162273", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_92e1c2d804a3c238adfdd99df9162273"}, "created_at": 1770177079.483456, "relation_name": null, "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_92e1c2d804a3c238adfdd99df9162273\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hcp_hco_affiliation", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_utils.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_hcp_hco_affiliation"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.std_dh_hcp_hco_affiliation", "attached_node": "model.CGOncology_MDM.std_dh_hcp_hco_affiliation", "test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["npi", "affiliated_dh_id"], "model": "{{ get_where_subquery(ref('std_dh_hcp_hco_affiliation')) }}"}, "namespace": "dbt_utils"}}, "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_dh_id.c15863164f": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dh_facility_to_facility_affiliation_dh_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dh_facility_to_facility_affiliation_dh_id.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_dh_id.c15863164f", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dh_facility_to_facility_affiliation_dh_id"], "alias": "not_null_std_dh_facility_to_facility_affiliation_dh_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.484952, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_facility_to_facility_affiliation", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dh_facility_to_facility_affiliation"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "dh_id", "file_key_name": "models.std_dh_facility_to_facility_affiliation", "attached_node": "model.CGOncology_MDM.std_dh_facility_to_facility_affiliation", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "dh_id", "model": "{{ get_where_subquery(ref('std_dh_facility_to_facility_affiliation')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_affiliated_id.41b2bd78b8": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dh_facility_to_facility_affiliation_affiliated_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dh_facility_to_facility_affiliation_affiliated_id.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_affiliated_id.41b2bd78b8", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dh_facility_to_facility_affiliation_affiliated_id"], "alias": "not_null_std_dh_facility_to_facility_affiliation_affiliated_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.485448, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_facility_to_facility_affiliation", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dh_facility_to_facility_affiliation"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "affiliated_id", "file_key_name": "models.std_dh_facility_to_facility_affiliation", "attached_node": "model.CGOncology_MDM.std_dh_facility_to_facility_affiliation", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "affiliated_id", "model": "{{ get_where_subquery(ref('std_dh_facility_to_facility_affiliation')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_source_hash.0bd14f03fe": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dh_facility_to_facility_affiliation_source_hash", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dh_facility_to_facility_affiliation_source_hash.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_source_hash.0bd14f03fe", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dh_facility_to_facility_affiliation_source_hash"], "alias": "not_null_std_dh_facility_to_facility_affiliation_source_hash", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.485952, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_facility_to_facility_affiliation", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dh_facility_to_facility_affiliation"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "source_hash", "file_key_name": "models.std_dh_facility_to_facility_affiliation", "attached_node": "model.CGOncology_MDM.std_dh_facility_to_facility_affiliation", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "source_hash", "model": "{{ get_where_subquery(ref('std_dh_facility_to_facility_affiliation')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_facility_to_facility_affiliation_dh_id__affiliated_id.8ff632a963": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_utils_unique_combination_of_columns_std_dh_facility_to_facility_affiliation_dh_id__affiliated_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_utils_unique_combination_o_3f7dcc7edd775cf75fbd2b26ccce5b95.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_facility_to_facility_affiliation_dh_id__affiliated_id.8ff632a963", "fqn": ["CGOncology_MDM", "standardization", "dbt_utils_unique_combination_of_columns_std_dh_facility_to_facility_affiliation_dh_id__affiliated_id"], "alias": "dbt_utils_unique_combination_o_3f7dcc7edd775cf75fbd2b26ccce5b95", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_utils_unique_combination_o_3f7dcc7edd775cf75fbd2b26ccce5b95", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_3f7dcc7edd775cf75fbd2b26ccce5b95"}, "created_at": 1770177079.486455, "relation_name": null, "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_3f7dcc7edd775cf75fbd2b26ccce5b95\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_facility_to_facility_affiliation", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_utils.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_facility_to_facility_affiliation"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.std_dh_facility_to_facility_affiliation", "attached_node": "model.CGOncology_MDM.std_dh_facility_to_facility_affiliation", "test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["dh_id", "affiliated_id"], "model": "{{ get_where_subquery(ref('std_dh_facility_to_facility_affiliation')) }}"}, "namespace": "dbt_utils"}}, "test.CGOncology_MDM.not_null_std_ddd_hco_ddd_outlet_id.1b0484230f": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_ddd_hco_ddd_outlet_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_ddd_hco_ddd_outlet_id.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_ddd_hco_ddd_outlet_id.1b0484230f", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_ddd_hco_ddd_outlet_id"], "alias": "not_null_std_ddd_hco_ddd_outlet_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.4877481, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_ddd_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_ddd_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "ddd_outlet_id", "file_key_name": "models.std_ddd_hco", "attached_node": "model.CGOncology_MDM.std_ddd_hco", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "ddd_outlet_id", "model": "{{ get_where_subquery(ref('std_ddd_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_std_ddd_hco_ddd_outlet_id.c70c0abdc6": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_std_ddd_hco_ddd_outlet_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_std_ddd_hco_ddd_outlet_id.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.unique_std_ddd_hco_ddd_outlet_id.c70c0abdc6", "fqn": ["CGOncology_MDM", "standardization", "unique_std_ddd_hco_ddd_outlet_id"], "alias": "unique_std_ddd_hco_ddd_outlet_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.488245, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_ddd_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.CGOncology_MDM.std_ddd_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "ddd_outlet_id", "file_key_name": "models.std_ddd_hco", "attached_node": "model.CGOncology_MDM.std_ddd_hco", "test_metadata": {"name": "unique", "kwargs": {"column_name": "ddd_outlet_id", "model": "{{ get_where_subquery(ref('std_ddd_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_ddd_hco_ddd_outlet_name___a_z___ddd_outlet_name_IS_NOT_NULL.35cba45a91": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_column_values_to_match_regex_std_ddd_hco_ddd_outlet_name___a_z___ddd_outlet_name_IS_NOT_NULL", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_column_fcbfac613ecd8f53cd82be15d5be1836.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_ddd_hco_ddd_outlet_name___a_z___ddd_outlet_name_IS_NOT_NULL.35cba45a91", "fqn": ["CGOncology_MDM", "standardization", "dbt_expectations_expect_column_values_to_match_regex_std_ddd_hco_ddd_outlet_name___a_z___ddd_outlet_name_IS_NOT_NULL"], "alias": "dbt_expectations_expect_column_fcbfac613ecd8f53cd82be15d5be1836", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_column_fcbfac613ecd8f53cd82be15d5be1836", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_expectations_expect_column_fcbfac613ecd8f53cd82be15d5be1836"}, "created_at": 1770177079.48875, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_column_values_to_match_regex(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_expectations_expect_column_fcbfac613ecd8f53cd82be15d5be1836\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_ddd_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_column_values_to_match_regex", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_ddd_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "ddd_outlet_name", "file_key_name": "models.std_ddd_hco", "attached_node": "model.CGOncology_MDM.std_ddd_hco", "test_metadata": {"name": "expect_column_values_to_match_regex", "kwargs": {"column_name": "ddd_outlet_name", "regex": "^[^a-z]+$", "row_condition": "ddd_outlet_name IS NOT NULL", "model": "{{ get_where_subquery(ref('std_ddd_hco')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_ddd_hco_zip_code___0_9_5___zip_code_IS_NOT_NULL.b2c4f2e2df": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_column_values_to_match_regex_std_ddd_hco_zip_code___0_9_5___zip_code_IS_NOT_NULL", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_column_16f6d34b6acf221f806186a38f4b895d.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_ddd_hco_zip_code___0_9_5___zip_code_IS_NOT_NULL.b2c4f2e2df", "fqn": ["CGOncology_MDM", "standardization", "dbt_expectations_expect_column_values_to_match_regex_std_ddd_hco_zip_code___0_9_5___zip_code_IS_NOT_NULL"], "alias": "dbt_expectations_expect_column_16f6d34b6acf221f806186a38f4b895d", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_column_16f6d34b6acf221f806186a38f4b895d", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_expectations_expect_column_16f6d34b6acf221f806186a38f4b895d"}, "created_at": 1770177079.490112, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_column_values_to_match_regex(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_expectations_expect_column_16f6d34b6acf221f806186a38f4b895d\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_ddd_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_column_values_to_match_regex", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_ddd_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "zip_code", "file_key_name": "models.std_ddd_hco", "attached_node": "model.CGOncology_MDM.std_ddd_hco", "test_metadata": {"name": "expect_column_values_to_match_regex", "kwargs": {"column_name": "zip_code", "regex": "^[0-9]{5}$", "row_condition": "zip_code IS NOT NULL", "model": "{{ get_where_subquery(ref('std_ddd_hco')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.accepted_values_std_ddd_hco_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY__DC__PR__VI__GU__AS__MP.1e74911fad": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_std_ddd_hco_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY__DC__PR__VI__GU__AS__MP", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_std_ddd_hco_622e6bbb7e7830f818ada70e4be77563.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_std_ddd_hco_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY__DC__PR__VI__GU__AS__MP.1e74911fad", "fqn": ["CGOncology_MDM", "standardization", "accepted_values_std_ddd_hco_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY__DC__PR__VI__GU__AS__MP"], "alias": "accepted_values_std_ddd_hco_622e6bbb7e7830f818ada70e4be77563", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_std_ddd_hco_622e6bbb7e7830f818ada70e4be77563", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": "state IS NOT NULL", "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"where": "state IS NOT NULL", "alias": "accepted_values_std_ddd_hco_622e6bbb7e7830f818ada70e4be77563"}, "created_at": 1770177079.4917362, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(where=\"state IS NOT NULL\",alias=\"accepted_values_std_ddd_hco_622e6bbb7e7830f818ada70e4be77563\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_ddd_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_ddd_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "state", "file_key_name": "models.std_ddd_hco", "attached_node": "model.CGOncology_MDM.std_ddd_hco", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "state", "values": ["AL", "AK", "AZ", "AR", "CA", "CO", "CT", "DE", "FL", "GA", "HI", "ID", "IL", "IN", "IA", "KS", "KY", "LA", "ME", "MD", "MA", "MI", "MN", "MS", "MO", "MT", "NE", "NV", "NH", "NJ", "NM", "NY", "NC", "ND", "OH", "OK", "OR", "PA", "RI", "SC", "SD", "TN", "TX", "UT", "VT", "VA", "WA", "WV", "WI", "WY", "DC", "PR", "VI", "GU", "AS", "MP"], "model": "{{ get_where_subquery(ref('std_ddd_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_ddd_hco_class_of_trade.966b717e30": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_ddd_hco_class_of_trade", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_ddd_hco_class_of_trade.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_ddd_hco_class_of_trade.966b717e30", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_ddd_hco_class_of_trade"], "alias": "not_null_std_ddd_hco_class_of_trade", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.4931, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_ddd_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_ddd_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "class_of_trade", "file_key_name": "models.std_ddd_hco", "attached_node": "model.CGOncology_MDM.std_ddd_hco", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "class_of_trade", "model": "{{ get_where_subquery(ref('std_ddd_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_std_ddd_hco_class_of_trade__CLINICS__HOSPITALS__CHAIN__INDEPENDENT__NURSING_HOME__HEALTH_CARE_PLAN__MAIL_SERVICE__MISCELLANEOUS__FOODSTORE__MASS_MERCHANDISER__N_A__UNKNOWN.f93e3e0083": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_std_ddd_hco_class_of_trade__CLINICS__HOSPITALS__CHAIN__INDEPENDENT__NURSING_HOME__HEALTH_CARE_PLAN__MAIL_SERVICE__MISCELLANEOUS__FOODSTORE__MASS_MERCHANDISER__N_A__UNKNOWN", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_std_ddd_hco_087da57db494d7b0869b701b0e2ddeca.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_std_ddd_hco_class_of_trade__CLINICS__HOSPITALS__CHAIN__INDEPENDENT__NURSING_HOME__HEALTH_CARE_PLAN__MAIL_SERVICE__MISCELLANEOUS__FOODSTORE__MASS_MERCHANDISER__N_A__UNKNOWN.f93e3e0083", "fqn": ["CGOncology_MDM", "standardization", "accepted_values_std_ddd_hco_class_of_trade__CLINICS__HOSPITALS__CHAIN__INDEPENDENT__NURSING_HOME__HEALTH_CARE_PLAN__MAIL_SERVICE__MISCELLANEOUS__FOODSTORE__MASS_MERCHANDISER__N_A__UNKNOWN"], "alias": "accepted_values_std_ddd_hco_087da57db494d7b0869b701b0e2ddeca", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_std_ddd_hco_087da57db494d7b0869b701b0e2ddeca", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_std_ddd_hco_087da57db494d7b0869b701b0e2ddeca"}, "created_at": 1770177079.49362, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_std_ddd_hco_087da57db494d7b0869b701b0e2ddeca\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_ddd_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_ddd_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "class_of_trade", "file_key_name": "models.std_ddd_hco", "attached_node": "model.CGOncology_MDM.std_ddd_hco", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "class_of_trade", "values": ["CLINICS", "HOSPITALS", "CHAIN", "INDEPENDENT", "NURSING HOME", "HEALTH CARE PLAN", "MAIL SERVICE", "MISCELLANEOUS", "FOODSTORE", "MASS MERCHANDISER", "N/A", "UNKNOWN"], "model": "{{ get_where_subquery(ref('std_ddd_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_ddd_hco_is_zip_excluded.c6559e9806": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_ddd_hco_is_zip_excluded", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_ddd_hco_is_zip_excluded.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_ddd_hco_is_zip_excluded.c6559e9806", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_ddd_hco_is_zip_excluded"], "alias": "not_null_std_ddd_hco_is_zip_excluded", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.4948611, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_ddd_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_ddd_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_zip_excluded", "file_key_name": "models.std_ddd_hco", "attached_node": "model.CGOncology_MDM.std_ddd_hco", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "is_zip_excluded", "model": "{{ get_where_subquery(ref('std_ddd_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_std_ddd_hco_is_zip_excluded__True__False.39c820062c": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_std_ddd_hco_is_zip_excluded__True__False", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_std_ddd_hco_is_zip_excluded__True__False.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_std_ddd_hco_is_zip_excluded__True__False.39c820062c", "fqn": ["CGOncology_MDM", "standardization", "accepted_values_std_ddd_hco_is_zip_excluded__True__False"], "alias": "accepted_values_std_ddd_hco_is_zip_excluded__True__False", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.495363, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_ddd_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_ddd_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_zip_excluded", "file_key_name": "models.std_ddd_hco", "attached_node": "model.CGOncology_MDM.std_ddd_hco", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "is_zip_excluded", "values": [true, false], "model": "{{ get_where_subquery(ref('std_ddd_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_ddd_hco_is_supply_chain_excluded.0e5299adc6": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_ddd_hco_is_supply_chain_excluded", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_ddd_hco_is_supply_chain_excluded.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_ddd_hco_is_supply_chain_excluded.0e5299adc6", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_ddd_hco_is_supply_chain_excluded"], "alias": "not_null_std_ddd_hco_is_supply_chain_excluded", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.496911, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_ddd_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_ddd_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_supply_chain_excluded", "file_key_name": "models.std_ddd_hco", "attached_node": "model.CGOncology_MDM.std_ddd_hco", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "is_supply_chain_excluded", "model": "{{ get_where_subquery(ref('std_ddd_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_std_ddd_hco_is_supply_chain_excluded__True__False.a885c0891c": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_std_ddd_hco_is_supply_chain_excluded__True__False", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_std_ddd_hco_a6ab174de6838767b249aec82f3d52b9.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_std_ddd_hco_is_supply_chain_excluded__True__False.a885c0891c", "fqn": ["CGOncology_MDM", "standardization", "accepted_values_std_ddd_hco_is_supply_chain_excluded__True__False"], "alias": "accepted_values_std_ddd_hco_a6ab174de6838767b249aec82f3d52b9", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_std_ddd_hco_a6ab174de6838767b249aec82f3d52b9", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_std_ddd_hco_a6ab174de6838767b249aec82f3d52b9"}, "created_at": 1770177079.4974358, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_std_ddd_hco_a6ab174de6838767b249aec82f3d52b9\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_ddd_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_ddd_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_supply_chain_excluded", "file_key_name": "models.std_ddd_hco", "attached_node": "model.CGOncology_MDM.std_ddd_hco", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "is_supply_chain_excluded", "values": [true, false], "model": "{{ get_where_subquery(ref('std_ddd_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_ddd_sales_ddd_outlet_id.d18206dc26": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_ddd_sales_ddd_outlet_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_ddd_sales_ddd_outlet_id.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_ddd_sales_ddd_outlet_id.d18206dc26", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_ddd_sales_ddd_outlet_id"], "alias": "not_null_std_ddd_sales_ddd_outlet_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.499917, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_ddd_sales", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_ddd_sales"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "ddd_outlet_id", "file_key_name": "models.std_ddd_sales", "attached_node": "model.CGOncology_MDM.std_ddd_sales", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "ddd_outlet_id", "model": "{{ get_where_subquery(ref('std_ddd_sales')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_ddd_sales_product_group_id.28e5d2f6ee": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_ddd_sales_product_group_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_ddd_sales_product_group_id.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_ddd_sales_product_group_id.28e5d2f6ee", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_ddd_sales_product_group_id"], "alias": "not_null_std_ddd_sales_product_group_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.500414, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_ddd_sales", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_ddd_sales"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "product_group_id", "file_key_name": "models.std_ddd_sales", "attached_node": "model.CGOncology_MDM.std_ddd_sales", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "product_group_id", "model": "{{ get_where_subquery(ref('std_ddd_sales')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_std_ddd_sales_product_name__ADSTILADRIN__ANKTIVA__TICE_BCG__INLEXZO__OTHER.bd0919193d": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_std_ddd_sales_product_name__ADSTILADRIN__ANKTIVA__TICE_BCG__INLEXZO__OTHER", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_std_ddd_sales_930b12105c91c0de72bca82815dcc880.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_std_ddd_sales_product_name__ADSTILADRIN__ANKTIVA__TICE_BCG__INLEXZO__OTHER.bd0919193d", "fqn": ["CGOncology_MDM", "standardization", "accepted_values_std_ddd_sales_product_name__ADSTILADRIN__ANKTIVA__TICE_BCG__INLEXZO__OTHER"], "alias": "accepted_values_std_ddd_sales_930b12105c91c0de72bca82815dcc880", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_std_ddd_sales_930b12105c91c0de72bca82815dcc880", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_std_ddd_sales_930b12105c91c0de72bca82815dcc880"}, "created_at": 1770177079.500916, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_std_ddd_sales_930b12105c91c0de72bca82815dcc880\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_ddd_sales", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_ddd_sales"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "product_name", "file_key_name": "models.std_ddd_sales", "attached_node": "model.CGOncology_MDM.std_ddd_sales", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "product_name", "values": ["ADSTILADRIN", "ANKTIVA", "TICE_BCG", "INLEXZO", "OTHER"], "model": "{{ get_where_subquery(ref('std_ddd_sales')) }}"}, "namespace": null}}, "test.CGOncology_MDM.row_count_match_std_ddd_sales_DDD_OUTLET_NUMBER_IS_NOT_NULL_AND_PRODUCT_GROUP_ID_IS_NOT_NULL__source_raw_ddd_PRELAND_DDD_SALES_.e723d1ef6c": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "row_count_match_std_ddd_sales_DDD_OUTLET_NUMBER_IS_NOT_NULL_AND_PRODUCT_GROUP_ID_IS_NOT_NULL__source_raw_ddd_PRELAND_DDD_SALES_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "row_count_match_std_ddd_sales_9d6528ad961936a953418988d36f0fc6.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.row_count_match_std_ddd_sales_DDD_OUTLET_NUMBER_IS_NOT_NULL_AND_PRODUCT_GROUP_ID_IS_NOT_NULL__source_raw_ddd_PRELAND_DDD_SALES_.e723d1ef6c", "fqn": ["CGOncology_MDM", "standardization", "row_count_match_std_ddd_sales_DDD_OUTLET_NUMBER_IS_NOT_NULL_AND_PRODUCT_GROUP_ID_IS_NOT_NULL__source_raw_ddd_PRELAND_DDD_SALES_"], "alias": "row_count_match_std_ddd_sales_9d6528ad961936a953418988d36f0fc6", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "row_count_match_std_ddd_sales_9d6528ad961936a953418988d36f0fc6", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "row_count_match_std_ddd_sales_9d6528ad961936a953418988d36f0fc6"}, "created_at": 1770177079.5022662, "relation_name": null, "raw_code": "{{ test_row_count_match(**_dbt_generic_test_kwargs) }}{{ config(alias=\"row_count_match_std_ddd_sales_9d6528ad961936a953418988d36f0fc6\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_ddd_sales", "package": null, "version": null}], "sources": [["raw_ddd", "PRELAND_DDD_SALES"]], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.CGOncology_MDM.test_row_count_match", "macro.dbt.get_where_subquery"], "nodes": ["source.CGOncology_MDM.raw_ddd.PRELAND_DDD_SALES", "model.CGOncology_MDM.std_ddd_sales"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.std_ddd_sales", "attached_node": "model.CGOncology_MDM.std_ddd_sales", "test_metadata": {"name": "row_count_match", "kwargs": {"source_model": "source('raw_ddd', 'PRELAND_DDD_SALES')", "source_filter": "DDD_OUTLET_NUMBER IS NOT NULL AND PRODUCT_GROUP_ID IS NOT NULL", "model": "{{ get_where_subquery(ref('std_ddd_sales')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_medscout_hco_medscout_id.b291b23043": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_medscout_hco_medscout_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_medscout_hco_medscout_id.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_medscout_hco_medscout_id.b291b23043", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_medscout_hco_medscout_id"], "alias": "not_null_std_medscout_hco_medscout_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.503742, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_medscout_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_medscout_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "medscout_id", "file_key_name": "models.std_medscout_hco", "attached_node": "model.CGOncology_MDM.std_medscout_hco", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "medscout_id", "model": "{{ get_where_subquery(ref('std_medscout_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_std_medscout_hco_medscout_id.a77c97f5fa": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_std_medscout_hco_medscout_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_std_medscout_hco_medscout_id.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.unique_std_medscout_hco_medscout_id.a77c97f5fa", "fqn": ["CGOncology_MDM", "standardization", "unique_std_medscout_hco_medscout_id"], "alias": "unique_std_medscout_hco_medscout_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.504235, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_medscout_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.CGOncology_MDM.std_medscout_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "medscout_id", "file_key_name": "models.std_medscout_hco", "attached_node": "model.CGOncology_MDM.std_medscout_hco", "test_metadata": {"name": "unique", "kwargs": {"column_name": "medscout_id", "model": "{{ get_where_subquery(ref('std_medscout_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_medscout_hco_npi.f5cc69b5b3": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_medscout_hco_npi", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_medscout_hco_npi.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_medscout_hco_npi.f5cc69b5b3", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_medscout_hco_npi"], "alias": "not_null_std_medscout_hco_npi", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.5047271, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_medscout_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_medscout_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "npi", "file_key_name": "models.std_medscout_hco", "attached_node": "model.CGOncology_MDM.std_medscout_hco", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "npi", "model": "{{ get_where_subquery(ref('std_medscout_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.row_count_match_std_medscout_hco_NPI_IS_NOT_NULL__source_raw_medscout_PRELAND_MEDSCOUT_HCO_DATA_.bef7505a83": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "row_count_match_std_medscout_hco_NPI_IS_NOT_NULL__source_raw_medscout_PRELAND_MEDSCOUT_HCO_DATA_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "row_count_match_std_medscout_h_2d346625b0ee37b023794eaecd6035a4.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.row_count_match_std_medscout_hco_NPI_IS_NOT_NULL__source_raw_medscout_PRELAND_MEDSCOUT_HCO_DATA_.bef7505a83", "fqn": ["CGOncology_MDM", "standardization", "row_count_match_std_medscout_hco_NPI_IS_NOT_NULL__source_raw_medscout_PRELAND_MEDSCOUT_HCO_DATA_"], "alias": "row_count_match_std_medscout_h_2d346625b0ee37b023794eaecd6035a4", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "row_count_match_std_medscout_h_2d346625b0ee37b023794eaecd6035a4", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "row_count_match_std_medscout_h_2d346625b0ee37b023794eaecd6035a4"}, "created_at": 1770177079.505242, "relation_name": null, "raw_code": "{{ test_row_count_match(**_dbt_generic_test_kwargs) }}{{ config(alias=\"row_count_match_std_medscout_h_2d346625b0ee37b023794eaecd6035a4\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_medscout_hco", "package": null, "version": null}], "sources": [["raw_medscout", "PRELAND_MEDSCOUT_HCO_DATA"]], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.CGOncology_MDM.test_row_count_match", "macro.dbt.get_where_subquery"], "nodes": ["source.CGOncology_MDM.raw_medscout.PRELAND_MEDSCOUT_HCO_DATA", "model.CGOncology_MDM.std_medscout_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.std_medscout_hco", "attached_node": "model.CGOncology_MDM.std_medscout_hco", "test_metadata": {"name": "row_count_match", "kwargs": {"source_model": "source('raw_medscout', 'PRELAND_MEDSCOUT_HCO_DATA')", "source_filter": "NPI IS NOT NULL", "model": "{{ get_where_subquery(ref('std_medscout_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_medscout_hcp_medscout_id.24a1ca994e": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_medscout_hcp_medscout_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_medscout_hcp_medscout_id.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_medscout_hcp_medscout_id.24a1ca994e", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_medscout_hcp_medscout_id"], "alias": "not_null_std_medscout_hcp_medscout_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.506975, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_medscout_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_medscout_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "medscout_id", "file_key_name": "models.std_medscout_hcp", "attached_node": "model.CGOncology_MDM.std_medscout_hcp", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "medscout_id", "model": "{{ get_where_subquery(ref('std_medscout_hcp')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_std_medscout_hcp_medscout_id.48cf6c0773": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_std_medscout_hcp_medscout_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_std_medscout_hcp_medscout_id.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.unique_std_medscout_hcp_medscout_id.48cf6c0773", "fqn": ["CGOncology_MDM", "standardization", "unique_std_medscout_hcp_medscout_id"], "alias": "unique_std_medscout_hcp_medscout_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.507465, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_medscout_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.CGOncology_MDM.std_medscout_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "medscout_id", "file_key_name": "models.std_medscout_hcp", "attached_node": "model.CGOncology_MDM.std_medscout_hcp", "test_metadata": {"name": "unique", "kwargs": {"column_name": "medscout_id", "model": "{{ get_where_subquery(ref('std_medscout_hcp')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_medscout_hcp_npi.77f3adaf1e": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_medscout_hcp_npi", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_medscout_hcp_npi.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_medscout_hcp_npi.77f3adaf1e", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_medscout_hcp_npi"], "alias": "not_null_std_medscout_hcp_npi", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.507954, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_medscout_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_medscout_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "npi", "file_key_name": "models.std_medscout_hcp", "attached_node": "model.CGOncology_MDM.std_medscout_hcp", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "npi", "model": "{{ get_where_subquery(ref('std_medscout_hcp')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_medscout_hcp_last_name.32a63aaea7": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_medscout_hcp_last_name", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_medscout_hcp_last_name.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_medscout_hcp_last_name.32a63aaea7", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_medscout_hcp_last_name"], "alias": "not_null_std_medscout_hcp_last_name", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.508441, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_medscout_hcp", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_medscout_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "last_name", "file_key_name": "models.std_medscout_hcp", "attached_node": "model.CGOncology_MDM.std_medscout_hcp", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "last_name", "model": "{{ get_where_subquery(ref('std_medscout_hcp')) }}"}, "namespace": null}}, "test.CGOncology_MDM.row_count_match_std_medscout_hcp_NPI_IS_NOT_NULL__source_raw_medscout_PRELAND_MEDSCOUT_HCP_DATA_.c13864403f": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "row_count_match_std_medscout_hcp_NPI_IS_NOT_NULL__source_raw_medscout_PRELAND_MEDSCOUT_HCP_DATA_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "row_count_match_std_medscout_h_2f6ac0a11810ef6ec18f18d92d0424c7.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.row_count_match_std_medscout_hcp_NPI_IS_NOT_NULL__source_raw_medscout_PRELAND_MEDSCOUT_HCP_DATA_.c13864403f", "fqn": ["CGOncology_MDM", "standardization", "row_count_match_std_medscout_hcp_NPI_IS_NOT_NULL__source_raw_medscout_PRELAND_MEDSCOUT_HCP_DATA_"], "alias": "row_count_match_std_medscout_h_2f6ac0a11810ef6ec18f18d92d0424c7", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "row_count_match_std_medscout_h_2f6ac0a11810ef6ec18f18d92d0424c7", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "row_count_match_std_medscout_h_2f6ac0a11810ef6ec18f18d92d0424c7"}, "created_at": 1770177079.50894, "relation_name": null, "raw_code": "{{ test_row_count_match(**_dbt_generic_test_kwargs) }}{{ config(alias=\"row_count_match_std_medscout_h_2f6ac0a11810ef6ec18f18d92d0424c7\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_medscout_hcp", "package": null, "version": null}], "sources": [["raw_medscout", "PRELAND_MEDSCOUT_HCP_DATA"]], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.CGOncology_MDM.test_row_count_match", "macro.dbt.get_where_subquery"], "nodes": ["source.CGOncology_MDM.raw_medscout.PRELAND_MEDSCOUT_HCP_DATA", "model.CGOncology_MDM.std_medscout_hcp"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.std_medscout_hcp", "attached_node": "model.CGOncology_MDM.std_medscout_hcp", "test_metadata": {"name": "row_count_match", "kwargs": {"source_model": "source('raw_medscout', 'PRELAND_MEDSCOUT_HCP_DATA')", "source_filter": "NPI IS NOT NULL", "model": "{{ get_where_subquery(ref('std_medscout_hcp')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_dx_claims_MX_CLAIM_ID.2533d41622": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dx_claims_MX_CLAIM_ID", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dx_claims_MX_CLAIM_ID.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dx_claims_MX_CLAIM_ID.2533d41622", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dx_claims_MX_CLAIM_ID"], "alias": "not_null_std_dx_claims_MX_CLAIM_ID", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.51039, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dx_claims", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dx_claims"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "MX_CLAIM_ID", "file_key_name": "models.std_dx_claims", "attached_node": "model.CGOncology_MDM.std_dx_claims", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "MX_CLAIM_ID", "model": "{{ get_where_subquery(ref('std_dx_claims')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_dx_claims_PATIENT_ID.f957d7d8f1": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dx_claims_PATIENT_ID", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dx_claims_PATIENT_ID.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dx_claims_PATIENT_ID.f957d7d8f1", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dx_claims_PATIENT_ID"], "alias": "not_null_std_dx_claims_PATIENT_ID", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.510889, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dx_claims", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dx_claims"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "PATIENT_ID", "file_key_name": "models.std_dx_claims", "attached_node": "model.CGOncology_MDM.std_dx_claims", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "PATIENT_ID", "model": "{{ get_where_subquery(ref('std_dx_claims')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_dx_claims_SERVICE_DATE.9235ca5535": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dx_claims_SERVICE_DATE", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dx_claims_SERVICE_DATE.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dx_claims_SERVICE_DATE.9235ca5535", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dx_claims_SERVICE_DATE"], "alias": "not_null_std_dx_claims_SERVICE_DATE", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.5113878, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dx_claims", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dx_claims"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "SERVICE_DATE", "file_key_name": "models.std_dx_claims", "attached_node": "model.CGOncology_MDM.std_dx_claims", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "SERVICE_DATE", "model": "{{ get_where_subquery(ref('std_dx_claims')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_dx_claims_DIAGNOSIS_CODE.eb269d8bef": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dx_claims_DIAGNOSIS_CODE", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dx_claims_DIAGNOSIS_CODE.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dx_claims_DIAGNOSIS_CODE.eb269d8bef", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dx_claims_DIAGNOSIS_CODE"], "alias": "not_null_std_dx_claims_DIAGNOSIS_CODE", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.5118852, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dx_claims", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dx_claims"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "DIAGNOSIS_CODE", "file_key_name": "models.std_dx_claims", "attached_node": "model.CGOncology_MDM.std_dx_claims", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "DIAGNOSIS_CODE", "model": "{{ get_where_subquery(ref('std_dx_claims')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_std_dx_claims_TREATMENT_CATEGORY__BC_DIAGNOSIS.fc5d7f855e": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_std_dx_claims_TREATMENT_CATEGORY__BC_DIAGNOSIS", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_std_dx_claims_TREATMENT_CATEGORY__BC_DIAGNOSIS.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_std_dx_claims_TREATMENT_CATEGORY__BC_DIAGNOSIS.fc5d7f855e", "fqn": ["CGOncology_MDM", "standardization", "accepted_values_std_dx_claims_TREATMENT_CATEGORY__BC_DIAGNOSIS"], "alias": "accepted_values_std_dx_claims_TREATMENT_CATEGORY__BC_DIAGNOSIS", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": "TREATMENT_CATEGORY IS NOT NULL", "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"where": "TREATMENT_CATEGORY IS NOT NULL"}, "created_at": 1770177079.5123992, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(where=\"TREATMENT_CATEGORY IS NOT NULL\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dx_claims", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dx_claims"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "TREATMENT_CATEGORY", "file_key_name": "models.std_dx_claims", "attached_node": "model.CGOncology_MDM.std_dx_claims", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "TREATMENT_CATEGORY", "values": ["BC DIAGNOSIS"], "model": "{{ get_where_subquery(ref('std_dx_claims')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_std_dx_claims_PATIENT_GENDER__M__F__U__X.15a4bb0c64": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_std_dx_claims_PATIENT_GENDER__M__F__U__X", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_std_dx_claims_PATIENT_GENDER__M__F__U__X.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_std_dx_claims_PATIENT_GENDER__M__F__U__X.15a4bb0c64", "fqn": ["CGOncology_MDM", "standardization", "accepted_values_std_dx_claims_PATIENT_GENDER__M__F__U__X"], "alias": "accepted_values_std_dx_claims_PATIENT_GENDER__M__F__U__X", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": "PATIENT_GENDER IS NOT NULL", "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"where": "PATIENT_GENDER IS NOT NULL"}, "created_at": 1770177079.5139809, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(where=\"PATIENT_GENDER IS NOT NULL\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dx_claims", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dx_claims"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "PATIENT_GENDER", "file_key_name": "models.std_dx_claims", "attached_node": "model.CGOncology_MDM.std_dx_claims", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "PATIENT_GENDER", "values": ["M", "F", "U", "X"], "model": "{{ get_where_subquery(ref('std_dx_claims')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_px_claims_PX_CLAIM_ID.ee2882f522": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_px_claims_PX_CLAIM_ID", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_px_claims_PX_CLAIM_ID.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_px_claims_PX_CLAIM_ID.ee2882f522", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_px_claims_PX_CLAIM_ID"], "alias": "not_null_std_px_claims_PX_CLAIM_ID", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.515254, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_px_claims", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_px_claims"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "PX_CLAIM_ID", "file_key_name": "models.std_px_claims", "attached_node": "model.CGOncology_MDM.std_px_claims", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "PX_CLAIM_ID", "model": "{{ get_where_subquery(ref('std_px_claims')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_px_claims_PATIENT_ID.bee2b9e04e": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_px_claims_PATIENT_ID", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_px_claims_PATIENT_ID.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_px_claims_PATIENT_ID.bee2b9e04e", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_px_claims_PATIENT_ID"], "alias": "not_null_std_px_claims_PATIENT_ID", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.5159009, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_px_claims", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_px_claims"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "PATIENT_ID", "file_key_name": "models.std_px_claims", "attached_node": "model.CGOncology_MDM.std_px_claims", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "PATIENT_ID", "model": "{{ get_where_subquery(ref('std_px_claims')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_px_claims_SERVICE_DATE.1002e03153": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_px_claims_SERVICE_DATE", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_px_claims_SERVICE_DATE.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_px_claims_SERVICE_DATE.1002e03153", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_px_claims_SERVICE_DATE"], "alias": "not_null_std_px_claims_SERVICE_DATE", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.516581, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_px_claims", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_px_claims"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "SERVICE_DATE", "file_key_name": "models.std_px_claims", "attached_node": "model.CGOncology_MDM.std_px_claims", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "SERVICE_DATE", "model": "{{ get_where_subquery(ref('std_px_claims')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_std_px_claims_PROCEDURE_CODE_TYPE__CPTHCPCS__ICD10PROC.5ab255ec5c": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_std_px_claims_PROCEDURE_CODE_TYPE__CPTHCPCS__ICD10PROC", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_std_px_claims_d5514bb362a83be819df604e4557452f.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_std_px_claims_PROCEDURE_CODE_TYPE__CPTHCPCS__ICD10PROC.5ab255ec5c", "fqn": ["CGOncology_MDM", "standardization", "accepted_values_std_px_claims_PROCEDURE_CODE_TYPE__CPTHCPCS__ICD10PROC"], "alias": "accepted_values_std_px_claims_d5514bb362a83be819df604e4557452f", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_std_px_claims_d5514bb362a83be819df604e4557452f", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": "PROCEDURE_CODE_TYPE IS NOT NULL", "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"where": "PROCEDURE_CODE_TYPE IS NOT NULL", "alias": "accepted_values_std_px_claims_d5514bb362a83be819df604e4557452f"}, "created_at": 1770177079.517271, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(where=\"PROCEDURE_CODE_TYPE IS NOT NULL\",alias=\"accepted_values_std_px_claims_d5514bb362a83be819df604e4557452f\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_px_claims", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_px_claims"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "PROCEDURE_CODE_TYPE", "file_key_name": "models.std_px_claims", "attached_node": "model.CGOncology_MDM.std_px_claims", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "PROCEDURE_CODE_TYPE", "values": ["CPTHCPCS", "ICD10PROC"], "model": "{{ get_where_subquery(ref('std_px_claims')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_std_px_claims_TREATMENT_CATEGORY__TURBT__TICE_BCG__ADSTILADRIN__ANKTIVA__CYSTOSCOPY__KEYTRUDA__OTHER_PROCEDURES.49a71a7de5": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_std_px_claims_TREATMENT_CATEGORY__TURBT__TICE_BCG__ADSTILADRIN__ANKTIVA__CYSTOSCOPY__KEYTRUDA__OTHER_PROCEDURES", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_std_px_claims_11ca4a7555477eb312419ef246a2d7ef.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_std_px_claims_TREATMENT_CATEGORY__TURBT__TICE_BCG__ADSTILADRIN__ANKTIVA__CYSTOSCOPY__KEYTRUDA__OTHER_PROCEDURES.49a71a7de5", "fqn": ["CGOncology_MDM", "standardization", "accepted_values_std_px_claims_TREATMENT_CATEGORY__TURBT__TICE_BCG__ADSTILADRIN__ANKTIVA__CYSTOSCOPY__KEYTRUDA__OTHER_PROCEDURES"], "alias": "accepted_values_std_px_claims_11ca4a7555477eb312419ef246a2d7ef", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_std_px_claims_11ca4a7555477eb312419ef246a2d7ef", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": "TREATMENT_CATEGORY IS NOT NULL", "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"where": "TREATMENT_CATEGORY IS NOT NULL", "alias": "accepted_values_std_px_claims_11ca4a7555477eb312419ef246a2d7ef"}, "created_at": 1770177079.518999, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(where=\"TREATMENT_CATEGORY IS NOT NULL\",alias=\"accepted_values_std_px_claims_11ca4a7555477eb312419ef246a2d7ef\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_px_claims", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_px_claims"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "TREATMENT_CATEGORY", "file_key_name": "models.std_px_claims", "attached_node": "model.CGOncology_MDM.std_px_claims", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "TREATMENT_CATEGORY", "values": ["TURBT", "TICE BCG", "ADSTILADRIN", "ANKTIVA", "CYSTOSCOPY", "KEYTRUDA", "OTHER PROCEDURES"], "model": "{{ get_where_subquery(ref('std_px_claims')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_std_px_claims_PATIENT_GENDER__M__F__U__X.8c1d91c8d7": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_std_px_claims_PATIENT_GENDER__M__F__U__X", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_std_px_claims_PATIENT_GENDER__M__F__U__X.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_std_px_claims_PATIENT_GENDER__M__F__U__X.8c1d91c8d7", "fqn": ["CGOncology_MDM", "standardization", "accepted_values_std_px_claims_PATIENT_GENDER__M__F__U__X"], "alias": "accepted_values_std_px_claims_PATIENT_GENDER__M__F__U__X", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": "PATIENT_GENDER IS NOT NULL", "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"where": "PATIENT_GENDER IS NOT NULL"}, "created_at": 1770177079.520362, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(where=\"PATIENT_GENDER IS NOT NULL\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_px_claims", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_px_claims"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "PATIENT_GENDER", "file_key_name": "models.std_px_claims", "attached_node": "model.CGOncology_MDM.std_px_claims", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "PATIENT_GENDER", "values": ["M", "F", "U", "X"], "model": "{{ get_where_subquery(ref('std_px_claims')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_rx_claims_RX_CLAIM_ID.bf79ee906e": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_rx_claims_RX_CLAIM_ID", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_rx_claims_RX_CLAIM_ID.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_rx_claims_RX_CLAIM_ID.bf79ee906e", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_rx_claims_RX_CLAIM_ID"], "alias": "not_null_std_rx_claims_RX_CLAIM_ID", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.521976, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_rx_claims", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_rx_claims"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "RX_CLAIM_ID", "file_key_name": "models.std_rx_claims", "attached_node": "model.CGOncology_MDM.std_rx_claims", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "RX_CLAIM_ID", "model": "{{ get_where_subquery(ref('std_rx_claims')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_rx_claims_PATIENT_ID.465afae066": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_rx_claims_PATIENT_ID", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_rx_claims_PATIENT_ID.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_rx_claims_PATIENT_ID.465afae066", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_rx_claims_PATIENT_ID"], "alias": "not_null_std_rx_claims_PATIENT_ID", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.5224829, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_rx_claims", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_rx_claims"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "PATIENT_ID", "file_key_name": "models.std_rx_claims", "attached_node": "model.CGOncology_MDM.std_rx_claims", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "PATIENT_ID", "model": "{{ get_where_subquery(ref('std_rx_claims')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_rx_claims_FILL_DATE.70a2e61aad": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_rx_claims_FILL_DATE", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_rx_claims_FILL_DATE.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_rx_claims_FILL_DATE.70a2e61aad", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_rx_claims_FILL_DATE"], "alias": "not_null_std_rx_claims_FILL_DATE", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.522984, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_rx_claims", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_rx_claims"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "FILL_DATE", "file_key_name": "models.std_rx_claims", "attached_node": "model.CGOncology_MDM.std_rx_claims", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "FILL_DATE", "model": "{{ get_where_subquery(ref('std_rx_claims')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_rx_claims_NDC11.1bfec2ed95": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_rx_claims_NDC11", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_rx_claims_NDC11.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_rx_claims_NDC11.1bfec2ed95", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_rx_claims_NDC11"], "alias": "not_null_std_rx_claims_NDC11", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.5234802, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_rx_claims", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_rx_claims"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "NDC11", "file_key_name": "models.std_rx_claims", "attached_node": "model.CGOncology_MDM.std_rx_claims", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "NDC11", "model": "{{ get_where_subquery(ref('std_rx_claims')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_std_rx_claims_TREATMENT_CATEGORY__TICE_BCG__ADSTILADRIN__ANKTIVA__OTHER_PROCEDURES.236093b5b7": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_std_rx_claims_TREATMENT_CATEGORY__TICE_BCG__ADSTILADRIN__ANKTIVA__OTHER_PROCEDURES", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_std_rx_claims_abfa5cafd9f8f52281c1c2d27f4282c0.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_std_rx_claims_TREATMENT_CATEGORY__TICE_BCG__ADSTILADRIN__ANKTIVA__OTHER_PROCEDURES.236093b5b7", "fqn": ["CGOncology_MDM", "standardization", "accepted_values_std_rx_claims_TREATMENT_CATEGORY__TICE_BCG__ADSTILADRIN__ANKTIVA__OTHER_PROCEDURES"], "alias": "accepted_values_std_rx_claims_abfa5cafd9f8f52281c1c2d27f4282c0", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_std_rx_claims_abfa5cafd9f8f52281c1c2d27f4282c0", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": "TREATMENT_CATEGORY IS NOT NULL", "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"where": "TREATMENT_CATEGORY IS NOT NULL", "alias": "accepted_values_std_rx_claims_abfa5cafd9f8f52281c1c2d27f4282c0"}, "created_at": 1770177079.5240011, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(where=\"TREATMENT_CATEGORY IS NOT NULL\",alias=\"accepted_values_std_rx_claims_abfa5cafd9f8f52281c1c2d27f4282c0\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_rx_claims", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_rx_claims"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "TREATMENT_CATEGORY", "file_key_name": "models.std_rx_claims", "attached_node": "model.CGOncology_MDM.std_rx_claims", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "TREATMENT_CATEGORY", "values": ["TICE BCG", "ADSTILADRIN", "ANKTIVA", "OTHER PROCEDURES"], "model": "{{ get_where_subquery(ref('std_rx_claims')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_std_rx_claims_PATIENT_GENDER__M__F__U__X.0e6fac2fd6": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_std_rx_claims_PATIENT_GENDER__M__F__U__X", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_std_rx_claims_PATIENT_GENDER__M__F__U__X.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_std_rx_claims_PATIENT_GENDER__M__F__U__X.0e6fac2fd6", "fqn": ["CGOncology_MDM", "standardization", "accepted_values_std_rx_claims_PATIENT_GENDER__M__F__U__X"], "alias": "accepted_values_std_rx_claims_PATIENT_GENDER__M__F__U__X", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": "PATIENT_GENDER IS NOT NULL", "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"where": "PATIENT_GENDER IS NOT NULL"}, "created_at": 1770177079.5253592, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(where=\"PATIENT_GENDER IS NOT NULL\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_rx_claims", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_rx_claims"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "PATIENT_GENDER", "file_key_name": "models.std_rx_claims", "attached_node": "model.CGOncology_MDM.std_rx_claims", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "PATIENT_GENDER", "values": ["M", "F", "U", "X"], "model": "{{ get_where_subquery(ref('std_rx_claims')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_dx_bc_patients_PATIENT_ID.5f1553fb03": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dx_bc_patients_PATIENT_ID", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dx_bc_patients_PATIENT_ID.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dx_bc_patients_PATIENT_ID.5f1553fb03", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dx_bc_patients_PATIENT_ID"], "alias": "not_null_std_dx_bc_patients_PATIENT_ID", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.526613, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dx_bc_patients", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dx_bc_patients"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "PATIENT_ID", "file_key_name": "models.std_dx_bc_patients", "attached_node": "model.CGOncology_MDM.std_dx_bc_patients", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "PATIENT_ID", "model": "{{ get_where_subquery(ref('std_dx_bc_patients')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_std_dx_bc_patients_PATIENT_ID.2b164dce90": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_std_dx_bc_patients_PATIENT_ID", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_std_dx_bc_patients_PATIENT_ID.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.unique_std_dx_bc_patients_PATIENT_ID.2b164dce90", "fqn": ["CGOncology_MDM", "standardization", "unique_std_dx_bc_patients_PATIENT_ID"], "alias": "unique_std_dx_bc_patients_PATIENT_ID", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.527103, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dx_bc_patients", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.CGOncology_MDM.std_dx_bc_patients"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "PATIENT_ID", "file_key_name": "models.std_dx_bc_patients", "attached_node": "model.CGOncology_MDM.std_dx_bc_patients", "test_metadata": {"name": "unique", "kwargs": {"column_name": "PATIENT_ID", "model": "{{ get_where_subquery(ref('std_dx_bc_patients')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_dx_bc_patients_EARLIEST_DX_DATE.9511ca689b": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dx_bc_patients_EARLIEST_DX_DATE", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dx_bc_patients_EARLIEST_DX_DATE.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dx_bc_patients_EARLIEST_DX_DATE.9511ca689b", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dx_bc_patients_EARLIEST_DX_DATE"], "alias": "not_null_std_dx_bc_patients_EARLIEST_DX_DATE", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.527596, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dx_bc_patients", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dx_bc_patients"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "EARLIEST_DX_DATE", "file_key_name": "models.std_dx_bc_patients", "attached_node": "model.CGOncology_MDM.std_dx_bc_patients", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "EARLIEST_DX_DATE", "model": "{{ get_where_subquery(ref('std_dx_bc_patients')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_std_dx_bc_patients_IDENTIFICATION_SOURCE__DX.d52ce05901": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_std_dx_bc_patients_IDENTIFICATION_SOURCE__DX", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_std_dx_bc_patients_IDENTIFICATION_SOURCE__DX.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_std_dx_bc_patients_IDENTIFICATION_SOURCE__DX.d52ce05901", "fqn": ["CGOncology_MDM", "standardization", "accepted_values_std_dx_bc_patients_IDENTIFICATION_SOURCE__DX"], "alias": "accepted_values_std_dx_bc_patients_IDENTIFICATION_SOURCE__DX", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.528304, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dx_bc_patients", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dx_bc_patients"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "IDENTIFICATION_SOURCE", "file_key_name": "models.std_dx_bc_patients", "attached_node": "model.CGOncology_MDM.std_dx_bc_patients", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "IDENTIFICATION_SOURCE", "values": ["DX"], "model": "{{ get_where_subquery(ref('std_dx_bc_patients')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_px_bc_patients_PATIENT_ID.58b2a57a43": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_px_bc_patients_PATIENT_ID", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_px_bc_patients_PATIENT_ID.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_px_bc_patients_PATIENT_ID.58b2a57a43", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_px_bc_patients_PATIENT_ID"], "alias": "not_null_std_px_bc_patients_PATIENT_ID", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.530092, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_px_bc_patients", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_px_bc_patients"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "PATIENT_ID", "file_key_name": "models.std_px_bc_patients", "attached_node": "model.CGOncology_MDM.std_px_bc_patients", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "PATIENT_ID", "model": "{{ get_where_subquery(ref('std_px_bc_patients')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_std_px_bc_patients_PATIENT_ID.e2e20292bd": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_std_px_bc_patients_PATIENT_ID", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_std_px_bc_patients_PATIENT_ID.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.unique_std_px_bc_patients_PATIENT_ID.e2e20292bd", "fqn": ["CGOncology_MDM", "standardization", "unique_std_px_bc_patients_PATIENT_ID"], "alias": "unique_std_px_bc_patients_PATIENT_ID", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.530636, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_px_bc_patients", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.CGOncology_MDM.std_px_bc_patients"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "PATIENT_ID", "file_key_name": "models.std_px_bc_patients", "attached_node": "model.CGOncology_MDM.std_px_bc_patients", "test_metadata": {"name": "unique", "kwargs": {"column_name": "PATIENT_ID", "model": "{{ get_where_subquery(ref('std_px_bc_patients')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_px_bc_patients_EARLIEST_PX_DATE.afa0f2a8ce": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_px_bc_patients_EARLIEST_PX_DATE", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_px_bc_patients_EARLIEST_PX_DATE.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_px_bc_patients_EARLIEST_PX_DATE.afa0f2a8ce", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_px_bc_patients_EARLIEST_PX_DATE"], "alias": "not_null_std_px_bc_patients_EARLIEST_PX_DATE", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.531165, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_px_bc_patients", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_px_bc_patients"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "EARLIEST_PX_DATE", "file_key_name": "models.std_px_bc_patients", "attached_node": "model.CGOncology_MDM.std_px_bc_patients", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "EARLIEST_PX_DATE", "model": "{{ get_where_subquery(ref('std_px_bc_patients')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_std_px_bc_patients_IDENTIFICATION_SOURCE__PX.52f2870006": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_std_px_bc_patients_IDENTIFICATION_SOURCE__PX", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_std_px_bc_patients_IDENTIFICATION_SOURCE__PX.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_std_px_bc_patients_IDENTIFICATION_SOURCE__PX.52f2870006", "fqn": ["CGOncology_MDM", "standardization", "accepted_values_std_px_bc_patients_IDENTIFICATION_SOURCE__PX"], "alias": "accepted_values_std_px_bc_patients_IDENTIFICATION_SOURCE__PX", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.5316732, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_px_bc_patients", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_px_bc_patients"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "IDENTIFICATION_SOURCE", "file_key_name": "models.std_px_bc_patients", "attached_node": "model.CGOncology_MDM.std_px_bc_patients", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "IDENTIFICATION_SOURCE", "values": ["PX"], "model": "{{ get_where_subquery(ref('std_px_bc_patients')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_rx_bc_patients_PATIENT_ID.71727e35f0": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_rx_bc_patients_PATIENT_ID", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_rx_bc_patients_PATIENT_ID.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_rx_bc_patients_PATIENT_ID.71727e35f0", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_rx_bc_patients_PATIENT_ID"], "alias": "not_null_std_rx_bc_patients_PATIENT_ID", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.533024, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_rx_bc_patients", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_rx_bc_patients"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "PATIENT_ID", "file_key_name": "models.std_rx_bc_patients", "attached_node": "model.CGOncology_MDM.std_rx_bc_patients", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "PATIENT_ID", "model": "{{ get_where_subquery(ref('std_rx_bc_patients')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_std_rx_bc_patients_PATIENT_ID.02957e8bb5": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_std_rx_bc_patients_PATIENT_ID", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_std_rx_bc_patients_PATIENT_ID.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.unique_std_rx_bc_patients_PATIENT_ID.02957e8bb5", "fqn": ["CGOncology_MDM", "standardization", "unique_std_rx_bc_patients_PATIENT_ID"], "alias": "unique_std_rx_bc_patients_PATIENT_ID", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.53353, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_rx_bc_patients", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.CGOncology_MDM.std_rx_bc_patients"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "PATIENT_ID", "file_key_name": "models.std_rx_bc_patients", "attached_node": "model.CGOncology_MDM.std_rx_bc_patients", "test_metadata": {"name": "unique", "kwargs": {"column_name": "PATIENT_ID", "model": "{{ get_where_subquery(ref('std_rx_bc_patients')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_rx_bc_patients_EARLIEST_RX_DATE.6fcf09063b": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_rx_bc_patients_EARLIEST_RX_DATE", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_rx_bc_patients_EARLIEST_RX_DATE.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_rx_bc_patients_EARLIEST_RX_DATE.6fcf09063b", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_rx_bc_patients_EARLIEST_RX_DATE"], "alias": "not_null_std_rx_bc_patients_EARLIEST_RX_DATE", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.5340228, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_rx_bc_patients", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_rx_bc_patients"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "EARLIEST_RX_DATE", "file_key_name": "models.std_rx_bc_patients", "attached_node": "model.CGOncology_MDM.std_rx_bc_patients", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "EARLIEST_RX_DATE", "model": "{{ get_where_subquery(ref('std_rx_bc_patients')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_std_rx_bc_patients_IDENTIFICATION_SOURCE__RX.8755a20de4": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_std_rx_bc_patients_IDENTIFICATION_SOURCE__RX", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_std_rx_bc_patients_IDENTIFICATION_SOURCE__RX.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_std_rx_bc_patients_IDENTIFICATION_SOURCE__RX.8755a20de4", "fqn": ["CGOncology_MDM", "standardization", "accepted_values_std_rx_bc_patients_IDENTIFICATION_SOURCE__RX"], "alias": "accepted_values_std_rx_bc_patients_IDENTIFICATION_SOURCE__RX", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.534527, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_rx_bc_patients", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_rx_bc_patients"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "IDENTIFICATION_SOURCE", "file_key_name": "models.std_rx_bc_patients", "attached_node": "model.CGOncology_MDM.std_rx_bc_patients", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "IDENTIFICATION_SOURCE", "values": ["RX"], "model": "{{ get_where_subquery(ref('std_rx_bc_patients')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_dh_hco_hist_dh_id.7937f17fc0": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dh_hco_hist_dh_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dh_hco_hist_dh_id.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dh_hco_hist_dh_id.7937f17fc0", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dh_hco_hist_dh_id"], "alias": "not_null_std_dh_hco_hist_dh_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.535742, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hco_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dh_hco_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "dh_id", "file_key_name": "models.std_dh_hco_hist", "attached_node": "model.CGOncology_MDM.std_dh_hco_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "dh_id", "model": "{{ get_where_subquery(ref('std_dh_hco_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_dh_hco_hist_version_number.7c4e6114b5": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dh_hco_hist_version_number", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dh_hco_hist_version_number.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dh_hco_hist_version_number.7c4e6114b5", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dh_hco_hist_version_number"], "alias": "not_null_std_dh_hco_hist_version_number", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.53653, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hco_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dh_hco_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "version_number", "file_key_name": "models.std_dh_hco_hist", "attached_node": "model.CGOncology_MDM.std_dh_hco_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "version_number", "model": "{{ get_where_subquery(ref('std_dh_hco_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_dh_hco_hist_is_current.7ddaa82390": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dh_hco_hist_is_current", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dh_hco_hist_is_current.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dh_hco_hist_is_current.7ddaa82390", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dh_hco_hist_is_current"], "alias": "not_null_std_dh_hco_hist_is_current", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.537034, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hco_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dh_hco_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_current", "file_key_name": "models.std_dh_hco_hist", "attached_node": "model.CGOncology_MDM.std_dh_hco_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "is_current", "model": "{{ get_where_subquery(ref('std_dh_hco_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_std_dh_hco_hist_is_current__Y__N.4e0f166b09": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_std_dh_hco_hist_is_current__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_std_dh_hco_hist_is_current__Y__N.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_std_dh_hco_hist_is_current__Y__N.4e0f166b09", "fqn": ["CGOncology_MDM", "standardization", "accepted_values_std_dh_hco_hist_is_current__Y__N"], "alias": "accepted_values_std_dh_hco_hist_is_current__Y__N", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.537548, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hco_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_hco_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_current", "file_key_name": "models.std_dh_hco_hist", "attached_node": "model.CGOncology_MDM.std_dh_hco_hist", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "is_current", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('std_dh_hco_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_dh_hco_hist_is_active.131197f8f7": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dh_hco_hist_is_active", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dh_hco_hist_is_active.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dh_hco_hist_is_active.131197f8f7", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dh_hco_hist_is_active"], "alias": "not_null_std_dh_hco_hist_is_active", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.5392032, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hco_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dh_hco_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_active", "file_key_name": "models.std_dh_hco_hist", "attached_node": "model.CGOncology_MDM.std_dh_hco_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "is_active", "model": "{{ get_where_subquery(ref('std_dh_hco_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_std_dh_hco_hist_is_active__Y__N.b27d95e392": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_std_dh_hco_hist_is_active__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_std_dh_hco_hist_is_active__Y__N.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_std_dh_hco_hist_is_active__Y__N.b27d95e392", "fqn": ["CGOncology_MDM", "standardization", "accepted_values_std_dh_hco_hist_is_active__Y__N"], "alias": "accepted_values_std_dh_hco_hist_is_active__Y__N", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.5397482, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hco_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_hco_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_active", "file_key_name": "models.std_dh_hco_hist", "attached_node": "model.CGOncology_MDM.std_dh_hco_hist", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "is_active", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('std_dh_hco_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_hco_hist_dh_id__version_number.23ca9667d1": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_utils_unique_combination_of_columns_std_dh_hco_hist_dh_id__version_number", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_utils_unique_combination_o_27829cde2bb4c53333cb0e04a6575271.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_hco_hist_dh_id__version_number.23ca9667d1", "fqn": ["CGOncology_MDM", "standardization", "dbt_utils_unique_combination_of_columns_std_dh_hco_hist_dh_id__version_number"], "alias": "dbt_utils_unique_combination_o_27829cde2bb4c53333cb0e04a6575271", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_utils_unique_combination_o_27829cde2bb4c53333cb0e04a6575271", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_27829cde2bb4c53333cb0e04a6575271"}, "created_at": 1770177079.5410938, "relation_name": null, "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_27829cde2bb4c53333cb0e04a6575271\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hco_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_utils.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_hco_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.std_dh_hco_hist", "attached_node": "model.CGOncology_MDM.std_dh_hco_hist", "test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["dh_id", "version_number"], "model": "{{ get_where_subquery(ref('std_dh_hco_hist')) }}"}, "namespace": "dbt_utils"}}, "test.CGOncology_MDM.not_null_std_dh_practice_location_hist_kmk_pl_id.13975dc992": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dh_practice_location_hist_kmk_pl_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dh_practice_location_hist_kmk_pl_id.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dh_practice_location_hist_kmk_pl_id.13975dc992", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dh_practice_location_hist_kmk_pl_id"], "alias": "not_null_std_dh_practice_location_hist_kmk_pl_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.542468, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_practice_location_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dh_practice_location_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_pl_id", "file_key_name": "models.std_dh_practice_location_hist", "attached_node": "model.CGOncology_MDM.std_dh_practice_location_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "kmk_pl_id", "model": "{{ get_where_subquery(ref('std_dh_practice_location_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_dh_practice_location_hist_version_number.ca12478fce": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dh_practice_location_hist_version_number", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dh_practice_location_hist_version_number.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dh_practice_location_hist_version_number.ca12478fce", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dh_practice_location_hist_version_number"], "alias": "not_null_std_dh_practice_location_hist_version_number", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.542969, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_practice_location_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dh_practice_location_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "version_number", "file_key_name": "models.std_dh_practice_location_hist", "attached_node": "model.CGOncology_MDM.std_dh_practice_location_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "version_number", "model": "{{ get_where_subquery(ref('std_dh_practice_location_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_dh_practice_location_hist_is_current.85bf5428f8": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dh_practice_location_hist_is_current", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dh_practice_location_hist_is_current.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dh_practice_location_hist_is_current.85bf5428f8", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dh_practice_location_hist_is_current"], "alias": "not_null_std_dh_practice_location_hist_is_current", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.543465, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_practice_location_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dh_practice_location_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_current", "file_key_name": "models.std_dh_practice_location_hist", "attached_node": "model.CGOncology_MDM.std_dh_practice_location_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "is_current", "model": "{{ get_where_subquery(ref('std_dh_practice_location_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_std_dh_practice_location_hist_is_current__Y__N.97ab5347ed": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_std_dh_practice_location_hist_is_current__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_std_dh_practice_location_hist_is_current__Y__N.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_std_dh_practice_location_hist_is_current__Y__N.97ab5347ed", "fqn": ["CGOncology_MDM", "standardization", "accepted_values_std_dh_practice_location_hist_is_current__Y__N"], "alias": "accepted_values_std_dh_practice_location_hist_is_current__Y__N", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.54429, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_practice_location_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_practice_location_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_current", "file_key_name": "models.std_dh_practice_location_hist", "attached_node": "model.CGOncology_MDM.std_dh_practice_location_hist", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "is_current", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('std_dh_practice_location_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_practice_location_hist_kmk_pl_id__version_number.8e31476c9a": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_utils_unique_combination_of_columns_std_dh_practice_location_hist_kmk_pl_id__version_number", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_utils_unique_combination_o_6ee29a7b06cc9228959f4e5c88c8b2a1.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_practice_location_hist_kmk_pl_id__version_number.8e31476c9a", "fqn": ["CGOncology_MDM", "standardization", "dbt_utils_unique_combination_of_columns_std_dh_practice_location_hist_kmk_pl_id__version_number"], "alias": "dbt_utils_unique_combination_o_6ee29a7b06cc9228959f4e5c88c8b2a1", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_utils_unique_combination_o_6ee29a7b06cc9228959f4e5c88c8b2a1", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_6ee29a7b06cc9228959f4e5c88c8b2a1"}, "created_at": 1770177079.545546, "relation_name": null, "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_6ee29a7b06cc9228959f4e5c88c8b2a1\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_practice_location_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_utils.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_practice_location_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.std_dh_practice_location_hist", "attached_node": "model.CGOncology_MDM.std_dh_practice_location_hist", "test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["kmk_pl_id", "version_number"], "model": "{{ get_where_subquery(ref('std_dh_practice_location_hist')) }}"}, "namespace": "dbt_utils"}}, "test.CGOncology_MDM.not_null_std_dh_hcp_hist_npi.019b3d8523": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dh_hcp_hist_npi", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dh_hcp_hist_npi.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dh_hcp_hist_npi.019b3d8523", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dh_hcp_hist_npi"], "alias": "not_null_std_dh_hcp_hist_npi", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.546845, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hcp_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dh_hcp_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "npi", "file_key_name": "models.std_dh_hcp_hist", "attached_node": "model.CGOncology_MDM.std_dh_hcp_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "npi", "model": "{{ get_where_subquery(ref('std_dh_hcp_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_dh_hcp_hist_version_number.855d421cee": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dh_hcp_hist_version_number", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dh_hcp_hist_version_number.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dh_hcp_hist_version_number.855d421cee", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dh_hcp_hist_version_number"], "alias": "not_null_std_dh_hcp_hist_version_number", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.547344, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hcp_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dh_hcp_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "version_number", "file_key_name": "models.std_dh_hcp_hist", "attached_node": "model.CGOncology_MDM.std_dh_hcp_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "version_number", "model": "{{ get_where_subquery(ref('std_dh_hcp_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_dh_hcp_hist_is_current.1974f68cf0": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dh_hcp_hist_is_current", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dh_hcp_hist_is_current.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dh_hcp_hist_is_current.1974f68cf0", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dh_hcp_hist_is_current"], "alias": "not_null_std_dh_hcp_hist_is_current", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.547849, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hcp_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dh_hcp_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_current", "file_key_name": "models.std_dh_hcp_hist", "attached_node": "model.CGOncology_MDM.std_dh_hcp_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "is_current", "model": "{{ get_where_subquery(ref('std_dh_hcp_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_std_dh_hcp_hist_is_current__Y__N.4648d155b9": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_std_dh_hcp_hist_is_current__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_std_dh_hcp_hist_is_current__Y__N.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_std_dh_hcp_hist_is_current__Y__N.4648d155b9", "fqn": ["CGOncology_MDM", "standardization", "accepted_values_std_dh_hcp_hist_is_current__Y__N"], "alias": "accepted_values_std_dh_hcp_hist_is_current__Y__N", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.548357, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hcp_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_hcp_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_current", "file_key_name": "models.std_dh_hcp_hist", "attached_node": "model.CGOncology_MDM.std_dh_hcp_hist", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "is_current", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('std_dh_hcp_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_dh_hcp_hist_is_active.e041856ff2": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dh_hcp_hist_is_active", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dh_hcp_hist_is_active.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dh_hcp_hist_is_active.e041856ff2", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dh_hcp_hist_is_active"], "alias": "not_null_std_dh_hcp_hist_is_active", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.549553, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hcp_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dh_hcp_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_active", "file_key_name": "models.std_dh_hcp_hist", "attached_node": "model.CGOncology_MDM.std_dh_hcp_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "is_active", "model": "{{ get_where_subquery(ref('std_dh_hcp_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_std_dh_hcp_hist_is_active__Y__N.882f8b924d": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_std_dh_hcp_hist_is_active__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_std_dh_hcp_hist_is_active__Y__N.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_std_dh_hcp_hist_is_active__Y__N.882f8b924d", "fqn": ["CGOncology_MDM", "standardization", "accepted_values_std_dh_hcp_hist_is_active__Y__N"], "alias": "accepted_values_std_dh_hcp_hist_is_active__Y__N", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.5500538, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hcp_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_hcp_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_active", "file_key_name": "models.std_dh_hcp_hist", "attached_node": "model.CGOncology_MDM.std_dh_hcp_hist", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "is_active", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('std_dh_hcp_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_hcp_hist_npi__version_number.dbfe70f933": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_utils_unique_combination_of_columns_std_dh_hcp_hist_npi__version_number", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_utils_unique_combination_o_423d51c67f283b17d095763ef13bf003.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_hcp_hist_npi__version_number.dbfe70f933", "fqn": ["CGOncology_MDM", "standardization", "dbt_utils_unique_combination_of_columns_std_dh_hcp_hist_npi__version_number"], "alias": "dbt_utils_unique_combination_o_423d51c67f283b17d095763ef13bf003", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_utils_unique_combination_o_423d51c67f283b17d095763ef13bf003", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_423d51c67f283b17d095763ef13bf003"}, "created_at": 1770177079.551522, "relation_name": null, "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_423d51c67f283b17d095763ef13bf003\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hcp_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_utils.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_hcp_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.std_dh_hcp_hist", "attached_node": "model.CGOncology_MDM.std_dh_hcp_hist", "test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["npi", "version_number"], "model": "{{ get_where_subquery(ref('std_dh_hcp_hist')) }}"}, "namespace": "dbt_utils"}}, "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_hist_npi.28b5fbc518": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dh_hcp_hco_affiliation_hist_npi", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dh_hcp_hco_affiliation_hist_npi.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_hist_npi.28b5fbc518", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dh_hcp_hco_affiliation_hist_npi"], "alias": "not_null_std_dh_hcp_hco_affiliation_hist_npi", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.552819, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hcp_hco_affiliation_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dh_hcp_hco_affiliation_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "npi", "file_key_name": "models.std_dh_hcp_hco_affiliation_hist", "attached_node": "model.CGOncology_MDM.std_dh_hcp_hco_affiliation_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "npi", "model": "{{ get_where_subquery(ref('std_dh_hcp_hco_affiliation_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_hist_affiliated_id.9b572d258d": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dh_hcp_hco_affiliation_hist_affiliated_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dh_hcp_hco_affiliation_hist_affiliated_id.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_hist_affiliated_id.9b572d258d", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dh_hcp_hco_affiliation_hist_affiliated_id"], "alias": "not_null_std_dh_hcp_hco_affiliation_hist_affiliated_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.553322, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hcp_hco_affiliation_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dh_hcp_hco_affiliation_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "affiliated_id", "file_key_name": "models.std_dh_hcp_hco_affiliation_hist", "attached_node": "model.CGOncology_MDM.std_dh_hcp_hco_affiliation_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "affiliated_id", "model": "{{ get_where_subquery(ref('std_dh_hcp_hco_affiliation_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_hist_version_number.e994c81d25": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dh_hcp_hco_affiliation_hist_version_number", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dh_hcp_hco_affiliation_hist_version_number.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_hist_version_number.e994c81d25", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dh_hcp_hco_affiliation_hist_version_number"], "alias": "not_null_std_dh_hcp_hco_affiliation_hist_version_number", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.5538182, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hcp_hco_affiliation_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dh_hcp_hco_affiliation_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "version_number", "file_key_name": "models.std_dh_hcp_hco_affiliation_hist", "attached_node": "model.CGOncology_MDM.std_dh_hcp_hco_affiliation_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "version_number", "model": "{{ get_where_subquery(ref('std_dh_hcp_hco_affiliation_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_hist_is_current.37f0597c4a": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dh_hcp_hco_affiliation_hist_is_current", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dh_hcp_hco_affiliation_hist_is_current.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_hist_is_current.37f0597c4a", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dh_hcp_hco_affiliation_hist_is_current"], "alias": "not_null_std_dh_hcp_hco_affiliation_hist_is_current", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.554494, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hcp_hco_affiliation_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dh_hcp_hco_affiliation_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_current", "file_key_name": "models.std_dh_hcp_hco_affiliation_hist", "attached_node": "model.CGOncology_MDM.std_dh_hcp_hco_affiliation_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "is_current", "model": "{{ get_where_subquery(ref('std_dh_hcp_hco_affiliation_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_std_dh_hcp_hco_affiliation_hist_is_current__Y__N.1017a9ee9d": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_std_dh_hcp_hco_affiliation_hist_is_current__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_std_dh_hcp_hco_504a6a0b6833e487f0d6a4e728e61d46.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_std_dh_hcp_hco_affiliation_hist_is_current__Y__N.1017a9ee9d", "fqn": ["CGOncology_MDM", "standardization", "accepted_values_std_dh_hcp_hco_affiliation_hist_is_current__Y__N"], "alias": "accepted_values_std_dh_hcp_hco_504a6a0b6833e487f0d6a4e728e61d46", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_std_dh_hcp_hco_504a6a0b6833e487f0d6a4e728e61d46", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_std_dh_hcp_hco_504a6a0b6833e487f0d6a4e728e61d46"}, "created_at": 1770177079.5550468, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_std_dh_hcp_hco_504a6a0b6833e487f0d6a4e728e61d46\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hcp_hco_affiliation_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_hcp_hco_affiliation_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_current", "file_key_name": "models.std_dh_hcp_hco_affiliation_hist", "attached_node": "model.CGOncology_MDM.std_dh_hcp_hco_affiliation_hist", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "is_current", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('std_dh_hcp_hco_affiliation_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_hcp_hco_affiliation_hist_npi__affiliated_id__version_number.e5ea84e2ec": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_utils_unique_combination_of_columns_std_dh_hcp_hco_affiliation_hist_npi__affiliated_id__version_number", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_utils_unique_combination_o_f927c009f2c14a4ed319f8e95dec6d5b.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_hcp_hco_affiliation_hist_npi__affiliated_id__version_number.e5ea84e2ec", "fqn": ["CGOncology_MDM", "standardization", "dbt_utils_unique_combination_of_columns_std_dh_hcp_hco_affiliation_hist_npi__affiliated_id__version_number"], "alias": "dbt_utils_unique_combination_o_f927c009f2c14a4ed319f8e95dec6d5b", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_utils_unique_combination_o_f927c009f2c14a4ed319f8e95dec6d5b", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_f927c009f2c14a4ed319f8e95dec6d5b"}, "created_at": 1770177079.5565581, "relation_name": null, "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_f927c009f2c14a4ed319f8e95dec6d5b\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_hcp_hco_affiliation_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_utils.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_hcp_hco_affiliation_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.std_dh_hcp_hco_affiliation_hist", "attached_node": "model.CGOncology_MDM.std_dh_hcp_hco_affiliation_hist", "test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["npi", "affiliated_id", "version_number"], "model": "{{ get_where_subquery(ref('std_dh_hcp_hco_affiliation_hist')) }}"}, "namespace": "dbt_utils"}}, "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_hist_dh_id.c1156c613e": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dh_facility_to_facility_affiliation_hist_dh_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dh_facility_to_facility_affiliation_hist_dh_id.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_hist_dh_id.c1156c613e", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dh_facility_to_facility_affiliation_hist_dh_id"], "alias": "not_null_std_dh_facility_to_facility_affiliation_hist_dh_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.558332, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_facility_to_facility_affiliation_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dh_facility_to_facility_affiliation_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "dh_id", "file_key_name": "models.std_dh_facility_to_facility_affiliation_hist", "attached_node": "model.CGOncology_MDM.std_dh_facility_to_facility_affiliation_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "dh_id", "model": "{{ get_where_subquery(ref('std_dh_facility_to_facility_affiliation_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_hist_affiliated_id.e6f7b4617d": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dh_facility_to_facility_affiliation_hist_affiliated_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dh_facility_to_fa_726c6015d606e0adff6ad8b2fbf5f5d1.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_hist_affiliated_id.e6f7b4617d", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dh_facility_to_facility_affiliation_hist_affiliated_id"], "alias": "not_null_std_dh_facility_to_fa_726c6015d606e0adff6ad8b2fbf5f5d1", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "not_null_std_dh_facility_to_fa_726c6015d606e0adff6ad8b2fbf5f5d1", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "not_null_std_dh_facility_to_fa_726c6015d606e0adff6ad8b2fbf5f5d1"}, "created_at": 1770177079.558849, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}{{ config(alias=\"not_null_std_dh_facility_to_fa_726c6015d606e0adff6ad8b2fbf5f5d1\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_facility_to_facility_affiliation_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dh_facility_to_facility_affiliation_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "affiliated_id", "file_key_name": "models.std_dh_facility_to_facility_affiliation_hist", "attached_node": "model.CGOncology_MDM.std_dh_facility_to_facility_affiliation_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "affiliated_id", "model": "{{ get_where_subquery(ref('std_dh_facility_to_facility_affiliation_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_hist_version_number.03382a4b79": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dh_facility_to_facility_affiliation_hist_version_number", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dh_facility_to_fa_baf8ce5982cf5cc29ffcbd60fec29ba7.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_hist_version_number.03382a4b79", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dh_facility_to_facility_affiliation_hist_version_number"], "alias": "not_null_std_dh_facility_to_fa_baf8ce5982cf5cc29ffcbd60fec29ba7", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "not_null_std_dh_facility_to_fa_baf8ce5982cf5cc29ffcbd60fec29ba7", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "not_null_std_dh_facility_to_fa_baf8ce5982cf5cc29ffcbd60fec29ba7"}, "created_at": 1770177079.559357, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}{{ config(alias=\"not_null_std_dh_facility_to_fa_baf8ce5982cf5cc29ffcbd60fec29ba7\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_facility_to_facility_affiliation_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dh_facility_to_facility_affiliation_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "version_number", "file_key_name": "models.std_dh_facility_to_facility_affiliation_hist", "attached_node": "model.CGOncology_MDM.std_dh_facility_to_facility_affiliation_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "version_number", "model": "{{ get_where_subquery(ref('std_dh_facility_to_facility_affiliation_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_hist_is_current.5b8241a75f": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_dh_facility_to_facility_affiliation_hist_is_current", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_dh_facility_to_fa_b84b7c76168972504ac1b19138f5b3ff.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_hist_is_current.5b8241a75f", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_dh_facility_to_facility_affiliation_hist_is_current"], "alias": "not_null_std_dh_facility_to_fa_b84b7c76168972504ac1b19138f5b3ff", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "not_null_std_dh_facility_to_fa_b84b7c76168972504ac1b19138f5b3ff", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "not_null_std_dh_facility_to_fa_b84b7c76168972504ac1b19138f5b3ff"}, "created_at": 1770177079.559857, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}{{ config(alias=\"not_null_std_dh_facility_to_fa_b84b7c76168972504ac1b19138f5b3ff\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_facility_to_facility_affiliation_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_dh_facility_to_facility_affiliation_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_current", "file_key_name": "models.std_dh_facility_to_facility_affiliation_hist", "attached_node": "model.CGOncology_MDM.std_dh_facility_to_facility_affiliation_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "is_current", "model": "{{ get_where_subquery(ref('std_dh_facility_to_facility_affiliation_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_std_dh_facility_to_facility_affiliation_hist_is_current__Y__N.6d0529eaa0": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_std_dh_facility_to_facility_affiliation_hist_is_current__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_std_dh_facilit_ba2bf8ca95a0f23a99ea86c9203fc305.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_std_dh_facility_to_facility_affiliation_hist_is_current__Y__N.6d0529eaa0", "fqn": ["CGOncology_MDM", "standardization", "accepted_values_std_dh_facility_to_facility_affiliation_hist_is_current__Y__N"], "alias": "accepted_values_std_dh_facilit_ba2bf8ca95a0f23a99ea86c9203fc305", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_std_dh_facilit_ba2bf8ca95a0f23a99ea86c9203fc305", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_std_dh_facilit_ba2bf8ca95a0f23a99ea86c9203fc305"}, "created_at": 1770177079.56058, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_std_dh_facilit_ba2bf8ca95a0f23a99ea86c9203fc305\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_facility_to_facility_affiliation_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_facility_to_facility_affiliation_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_current", "file_key_name": "models.std_dh_facility_to_facility_affiliation_hist", "attached_node": "model.CGOncology_MDM.std_dh_facility_to_facility_affiliation_hist", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "is_current", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('std_dh_facility_to_facility_affiliation_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_facility_to_facility_affiliation_hist_dh_id__affiliated_id__version_number.6a1c689fcc": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_utils_unique_combination_of_columns_std_dh_facility_to_facility_affiliation_hist_dh_id__affiliated_id__version_number", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_utils_unique_combination_o_688ea7f9c2e684ed9def4933b3f5bb28.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_facility_to_facility_affiliation_hist_dh_id__affiliated_id__version_number.6a1c689fcc", "fqn": ["CGOncology_MDM", "standardization", "dbt_utils_unique_combination_of_columns_std_dh_facility_to_facility_affiliation_hist_dh_id__affiliated_id__version_number"], "alias": "dbt_utils_unique_combination_o_688ea7f9c2e684ed9def4933b3f5bb28", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_utils_unique_combination_o_688ea7f9c2e684ed9def4933b3f5bb28", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_688ea7f9c2e684ed9def4933b3f5bb28"}, "created_at": 1770177079.5622349, "relation_name": null, "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_688ea7f9c2e684ed9def4933b3f5bb28\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_dh_facility_to_facility_affiliation_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_utils.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_dh_facility_to_facility_affiliation_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.std_dh_facility_to_facility_affiliation_hist", "attached_node": "model.CGOncology_MDM.std_dh_facility_to_facility_affiliation_hist", "test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["dh_id", "affiliated_id", "version_number"], "model": "{{ get_where_subquery(ref('std_dh_facility_to_facility_affiliation_hist')) }}"}, "namespace": "dbt_utils"}}, "test.CGOncology_MDM.not_null_std_ddd_hco_hist_ddd_outlet_id.9edec51303": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_ddd_hco_hist_ddd_outlet_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_ddd_hco_hist_ddd_outlet_id.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_ddd_hco_hist_ddd_outlet_id.9edec51303", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_ddd_hco_hist_ddd_outlet_id"], "alias": "not_null_std_ddd_hco_hist_ddd_outlet_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.5636249, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_ddd_hco_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_ddd_hco_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "ddd_outlet_id", "file_key_name": "models.std_ddd_hco_hist", "attached_node": "model.CGOncology_MDM.std_ddd_hco_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "ddd_outlet_id", "model": "{{ get_where_subquery(ref('std_ddd_hco_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_ddd_hco_hist_version_number.f697601dc5": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_ddd_hco_hist_version_number", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_ddd_hco_hist_version_number.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_ddd_hco_hist_version_number.f697601dc5", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_ddd_hco_hist_version_number"], "alias": "not_null_std_ddd_hco_hist_version_number", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.56423, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_ddd_hco_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_ddd_hco_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "version_number", "file_key_name": "models.std_ddd_hco_hist", "attached_node": "model.CGOncology_MDM.std_ddd_hco_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "version_number", "model": "{{ get_where_subquery(ref('std_ddd_hco_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_ddd_hco_hist_is_current.3ab5dde3a4": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_ddd_hco_hist_is_current", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_ddd_hco_hist_is_current.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_ddd_hco_hist_is_current.3ab5dde3a4", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_ddd_hco_hist_is_current"], "alias": "not_null_std_ddd_hco_hist_is_current", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.564835, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_ddd_hco_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_ddd_hco_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_current", "file_key_name": "models.std_ddd_hco_hist", "attached_node": "model.CGOncology_MDM.std_ddd_hco_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "is_current", "model": "{{ get_where_subquery(ref('std_ddd_hco_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_std_ddd_hco_hist_is_current__Y__N.3cc9ac69ad": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_std_ddd_hco_hist_is_current__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_std_ddd_hco_hist_is_current__Y__N.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_std_ddd_hco_hist_is_current__Y__N.3cc9ac69ad", "fqn": ["CGOncology_MDM", "standardization", "accepted_values_std_ddd_hco_hist_is_current__Y__N"], "alias": "accepted_values_std_ddd_hco_hist_is_current__Y__N", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.565381, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_ddd_hco_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_ddd_hco_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_current", "file_key_name": "models.std_ddd_hco_hist", "attached_node": "model.CGOncology_MDM.std_ddd_hco_hist", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "is_current", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('std_ddd_hco_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_ddd_hco_hist_is_active.d1163cfd85": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_ddd_hco_hist_is_active", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_ddd_hco_hist_is_active.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_ddd_hco_hist_is_active.d1163cfd85", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_ddd_hco_hist_is_active"], "alias": "not_null_std_ddd_hco_hist_is_active", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.5671449, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_ddd_hco_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_ddd_hco_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_active", "file_key_name": "models.std_ddd_hco_hist", "attached_node": "model.CGOncology_MDM.std_ddd_hco_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "is_active", "model": "{{ get_where_subquery(ref('std_ddd_hco_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_std_ddd_hco_hist_is_active__Y__N.228110045d": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_std_ddd_hco_hist_is_active__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_std_ddd_hco_hist_is_active__Y__N.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_std_ddd_hco_hist_is_active__Y__N.228110045d", "fqn": ["CGOncology_MDM", "standardization", "accepted_values_std_ddd_hco_hist_is_active__Y__N"], "alias": "accepted_values_std_ddd_hco_hist_is_active__Y__N", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.5676749, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_ddd_hco_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_ddd_hco_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_active", "file_key_name": "models.std_ddd_hco_hist", "attached_node": "model.CGOncology_MDM.std_ddd_hco_hist", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "is_active", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('std_ddd_hco_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_ddd_hco_hist_ddd_outlet_id__version_number.3ed056f0fc": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_utils_unique_combination_of_columns_std_ddd_hco_hist_ddd_outlet_id__version_number", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_utils_unique_combination_o_cf6774eefcefaaab7abac913413aaec3.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_ddd_hco_hist_ddd_outlet_id__version_number.3ed056f0fc", "fqn": ["CGOncology_MDM", "standardization", "dbt_utils_unique_combination_of_columns_std_ddd_hco_hist_ddd_outlet_id__version_number"], "alias": "dbt_utils_unique_combination_o_cf6774eefcefaaab7abac913413aaec3", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_utils_unique_combination_o_cf6774eefcefaaab7abac913413aaec3", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_cf6774eefcefaaab7abac913413aaec3"}, "created_at": 1770177079.568962, "relation_name": null, "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_cf6774eefcefaaab7abac913413aaec3\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_ddd_hco_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_utils.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_ddd_hco_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.std_ddd_hco_hist", "attached_node": "model.CGOncology_MDM.std_ddd_hco_hist", "test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["ddd_outlet_id", "version_number"], "model": "{{ get_where_subquery(ref('std_ddd_hco_hist')) }}"}, "namespace": "dbt_utils"}}, "test.CGOncology_MDM.not_null_std_ddd_sales_hist_ddd_outlet_id.aae4b0d159": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_ddd_sales_hist_ddd_outlet_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_ddd_sales_hist_ddd_outlet_id.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_ddd_sales_hist_ddd_outlet_id.aae4b0d159", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_ddd_sales_hist_ddd_outlet_id"], "alias": "not_null_std_ddd_sales_hist_ddd_outlet_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.570295, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_ddd_sales_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_ddd_sales_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "ddd_outlet_id", "file_key_name": "models.std_ddd_sales_hist", "attached_node": "model.CGOncology_MDM.std_ddd_sales_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "ddd_outlet_id", "model": "{{ get_where_subquery(ref('std_ddd_sales_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_medscout_hco_hist_medscout_id.32eb6a182a": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_medscout_hco_hist_medscout_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_medscout_hco_hist_medscout_id.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_medscout_hco_hist_medscout_id.32eb6a182a", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_medscout_hco_hist_medscout_id"], "alias": "not_null_std_medscout_hco_hist_medscout_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.570796, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_medscout_hco_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_medscout_hco_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "medscout_id", "file_key_name": "models.std_medscout_hco_hist", "attached_node": "model.CGOncology_MDM.std_medscout_hco_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "medscout_id", "model": "{{ get_where_subquery(ref('std_medscout_hco_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_medscout_hco_hist_version_number.6fcd0d9465": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_medscout_hco_hist_version_number", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_medscout_hco_hist_version_number.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_medscout_hco_hist_version_number.6fcd0d9465", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_medscout_hco_hist_version_number"], "alias": "not_null_std_medscout_hco_hist_version_number", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.5713248, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_medscout_hco_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_medscout_hco_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "version_number", "file_key_name": "models.std_medscout_hco_hist", "attached_node": "model.CGOncology_MDM.std_medscout_hco_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "version_number", "model": "{{ get_where_subquery(ref('std_medscout_hco_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_medscout_hco_hist_is_current.c89f159e10": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_medscout_hco_hist_is_current", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_medscout_hco_hist_is_current.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_medscout_hco_hist_is_current.c89f159e10", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_medscout_hco_hist_is_current"], "alias": "not_null_std_medscout_hco_hist_is_current", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.571844, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_medscout_hco_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_medscout_hco_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_current", "file_key_name": "models.std_medscout_hco_hist", "attached_node": "model.CGOncology_MDM.std_medscout_hco_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "is_current", "model": "{{ get_where_subquery(ref('std_medscout_hco_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_std_medscout_hco_hist_is_current__Y__N.1b6303c595": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_std_medscout_hco_hist_is_current__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_std_medscout_hco_hist_is_current__Y__N.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_std_medscout_hco_hist_is_current__Y__N.1b6303c595", "fqn": ["CGOncology_MDM", "standardization", "accepted_values_std_medscout_hco_hist_is_current__Y__N"], "alias": "accepted_values_std_medscout_hco_hist_is_current__Y__N", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.5723479, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_medscout_hco_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_medscout_hco_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_current", "file_key_name": "models.std_medscout_hco_hist", "attached_node": "model.CGOncology_MDM.std_medscout_hco_hist", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "is_current", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('std_medscout_hco_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_medscout_hco_hist_is_active.97ee31c0e1": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_medscout_hco_hist_is_active", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_medscout_hco_hist_is_active.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_medscout_hco_hist_is_active.97ee31c0e1", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_medscout_hco_hist_is_active"], "alias": "not_null_std_medscout_hco_hist_is_active", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.573848, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_medscout_hco_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_medscout_hco_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_active", "file_key_name": "models.std_medscout_hco_hist", "attached_node": "model.CGOncology_MDM.std_medscout_hco_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "is_active", "model": "{{ get_where_subquery(ref('std_medscout_hco_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_std_medscout_hco_hist_is_active__Y__N.9be0124c5d": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_std_medscout_hco_hist_is_active__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_std_medscout_hco_hist_is_active__Y__N.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_std_medscout_hco_hist_is_active__Y__N.9be0124c5d", "fqn": ["CGOncology_MDM", "standardization", "accepted_values_std_medscout_hco_hist_is_active__Y__N"], "alias": "accepted_values_std_medscout_hco_hist_is_active__Y__N", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.5743601, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_medscout_hco_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_medscout_hco_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_active", "file_key_name": "models.std_medscout_hco_hist", "attached_node": "model.CGOncology_MDM.std_medscout_hco_hist", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "is_active", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('std_medscout_hco_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_medscout_hco_hist_medscout_id__version_number.f5a93c52f3": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_utils_unique_combination_of_columns_std_medscout_hco_hist_medscout_id__version_number", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_utils_unique_combination_o_d613a7393ee56e4ff720cc69744ca637.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_medscout_hco_hist_medscout_id__version_number.f5a93c52f3", "fqn": ["CGOncology_MDM", "standardization", "dbt_utils_unique_combination_of_columns_std_medscout_hco_hist_medscout_id__version_number"], "alias": "dbt_utils_unique_combination_o_d613a7393ee56e4ff720cc69744ca637", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_utils_unique_combination_o_d613a7393ee56e4ff720cc69744ca637", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_d613a7393ee56e4ff720cc69744ca637"}, "created_at": 1770177079.5756009, "relation_name": null, "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_d613a7393ee56e4ff720cc69744ca637\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_medscout_hco_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_utils.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_medscout_hco_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.std_medscout_hco_hist", "attached_node": "model.CGOncology_MDM.std_medscout_hco_hist", "test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["medscout_id", "version_number"], "model": "{{ get_where_subquery(ref('std_medscout_hco_hist')) }}"}, "namespace": "dbt_utils"}}, "test.CGOncology_MDM.not_null_std_medscout_hcp_hist_medscout_id.0e8f48d476": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_medscout_hcp_hist_medscout_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_medscout_hcp_hist_medscout_id.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_medscout_hcp_hist_medscout_id.0e8f48d476", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_medscout_hcp_hist_medscout_id"], "alias": "not_null_std_medscout_hcp_hist_medscout_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.577371, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_medscout_hcp_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_medscout_hcp_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "medscout_id", "file_key_name": "models.std_medscout_hcp_hist", "attached_node": "model.CGOncology_MDM.std_medscout_hcp_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "medscout_id", "model": "{{ get_where_subquery(ref('std_medscout_hcp_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_medscout_hcp_hist_version_number.be260d61c7": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_medscout_hcp_hist_version_number", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_medscout_hcp_hist_version_number.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_medscout_hcp_hist_version_number.be260d61c7", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_medscout_hcp_hist_version_number"], "alias": "not_null_std_medscout_hcp_hist_version_number", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.577897, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_medscout_hcp_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_medscout_hcp_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "version_number", "file_key_name": "models.std_medscout_hcp_hist", "attached_node": "model.CGOncology_MDM.std_medscout_hcp_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "version_number", "model": "{{ get_where_subquery(ref('std_medscout_hcp_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_medscout_hcp_hist_is_current.e6054c50ee": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_medscout_hcp_hist_is_current", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_medscout_hcp_hist_is_current.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_medscout_hcp_hist_is_current.e6054c50ee", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_medscout_hcp_hist_is_current"], "alias": "not_null_std_medscout_hcp_hist_is_current", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.578402, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_medscout_hcp_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_medscout_hcp_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_current", "file_key_name": "models.std_medscout_hcp_hist", "attached_node": "model.CGOncology_MDM.std_medscout_hcp_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "is_current", "model": "{{ get_where_subquery(ref('std_medscout_hcp_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_std_medscout_hcp_hist_is_current__Y__N.cf3bdfa364": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_std_medscout_hcp_hist_is_current__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_std_medscout_hcp_hist_is_current__Y__N.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_std_medscout_hcp_hist_is_current__Y__N.cf3bdfa364", "fqn": ["CGOncology_MDM", "standardization", "accepted_values_std_medscout_hcp_hist_is_current__Y__N"], "alias": "accepted_values_std_medscout_hcp_hist_is_current__Y__N", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.578903, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_medscout_hcp_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_medscout_hcp_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_current", "file_key_name": "models.std_medscout_hcp_hist", "attached_node": "model.CGOncology_MDM.std_medscout_hcp_hist", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "is_current", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('std_medscout_hcp_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_std_medscout_hcp_hist_is_active.119b7dfec8": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_std_medscout_hcp_hist_is_active", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_std_medscout_hcp_hist_is_active.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_std_medscout_hcp_hist_is_active.119b7dfec8", "fqn": ["CGOncology_MDM", "standardization", "not_null_std_medscout_hcp_hist_is_active"], "alias": "not_null_std_medscout_hcp_hist_is_active", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.580832, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_medscout_hcp_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.std_medscout_hcp_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_active", "file_key_name": "models.std_medscout_hcp_hist", "attached_node": "model.CGOncology_MDM.std_medscout_hcp_hist", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "is_active", "model": "{{ get_where_subquery(ref('std_medscout_hcp_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_std_medscout_hcp_hist_is_active__Y__N.927a3159c2": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_std_medscout_hcp_hist_is_active__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_std_medscout_hcp_hist_is_active__Y__N.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_std_medscout_hcp_hist_is_active__Y__N.927a3159c2", "fqn": ["CGOncology_MDM", "standardization", "accepted_values_std_medscout_hcp_hist_is_active__Y__N"], "alias": "accepted_values_std_medscout_hcp_hist_is_active__Y__N", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.581364, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_medscout_hcp_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_medscout_hcp_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_active", "file_key_name": "models.std_medscout_hcp_hist", "attached_node": "model.CGOncology_MDM.std_medscout_hcp_hist", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "is_active", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('std_medscout_hcp_hist')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_medscout_hcp_hist_medscout_id__version_number.2807cc00e5": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_utils_unique_combination_of_columns_std_medscout_hcp_hist_medscout_id__version_number", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_utils_unique_combination_o_218a3d00481e0df3fa33a3a2442fe50b.sql", "original_file_path": "models/standardization/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_medscout_hcp_hist_medscout_id__version_number.2807cc00e5", "fqn": ["CGOncology_MDM", "standardization", "dbt_utils_unique_combination_of_columns_std_medscout_hcp_hist_medscout_id__version_number"], "alias": "dbt_utils_unique_combination_o_218a3d00481e0df3fa33a3a2442fe50b", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_utils_unique_combination_o_218a3d00481e0df3fa33a3a2442fe50b", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_218a3d00481e0df3fa33a3a2442fe50b"}, "created_at": 1770177079.58271, "relation_name": null, "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_218a3d00481e0df3fa33a3a2442fe50b\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "std_medscout_hcp_hist", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_utils.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.std_medscout_hcp_hist"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.std_medscout_hcp_hist", "attached_node": "model.CGOncology_MDM.std_medscout_hcp_hist", "test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["medscout_id", "version_number"], "model": "{{ get_where_subquery(ref('std_medscout_hcp_hist')) }}"}, "namespace": "dbt_utils"}}, "test.CGOncology_MDM.not_null_ref_time_periods_period_key.a9e994cf12": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_ref_time_periods_period_key", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_ref_time_periods_period_key.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_ref_time_periods_period_key.a9e994cf12", "fqn": ["CGOncology_MDM", "adm", "not_null_ref_time_periods_period_key"], "alias": "not_null_ref_time_periods_period_key", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.589988, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "ref_time_periods", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.ref_time_periods"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "period_key", "file_key_name": "models.ref_time_periods", "attached_node": "model.CGOncology_MDM.ref_time_periods", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "period_key", "model": "{{ get_where_subquery(ref('ref_time_periods')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_ref_time_periods_period_key.557cb7d317": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_ref_time_periods_period_key", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_ref_time_periods_period_key.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.unique_ref_time_periods_period_key.557cb7d317", "fqn": ["CGOncology_MDM", "adm", "unique_ref_time_periods_period_key"], "alias": "unique_ref_time_periods_period_key", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.590562, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "ref_time_periods", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.CGOncology_MDM.ref_time_periods"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "period_key", "file_key_name": "models.ref_time_periods", "attached_node": "model.CGOncology_MDM.ref_time_periods", "test_metadata": {"name": "unique", "kwargs": {"column_name": "period_key", "model": "{{ get_where_subquery(ref('ref_time_periods')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_ref_time_periods_period_type.5eeae962e8": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_ref_time_periods_period_type", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_ref_time_periods_period_type.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_ref_time_periods_period_type.5eeae962e8", "fqn": ["CGOncology_MDM", "adm", "not_null_ref_time_periods_period_type"], "alias": "not_null_ref_time_periods_period_type", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.591088, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "ref_time_periods", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.ref_time_periods"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "period_type", "file_key_name": "models.ref_time_periods", "attached_node": "model.CGOncology_MDM.ref_time_periods", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "period_type", "model": "{{ get_where_subquery(ref('ref_time_periods')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_ref_time_periods_period_type__MONTHLY__QUARTERLY__ROLLING__YTD__QTD__PY__PYTD__P2Y__CALENDAR_YEAR__LTD__TOTAL.5af4e4a14b": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_ref_time_periods_period_type__MONTHLY__QUARTERLY__ROLLING__YTD__QTD__PY__PYTD__P2Y__CALENDAR_YEAR__LTD__TOTAL", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_ref_time_perio_69dab05cba8341cff10c03c297c38747.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_ref_time_periods_period_type__MONTHLY__QUARTERLY__ROLLING__YTD__QTD__PY__PYTD__P2Y__CALENDAR_YEAR__LTD__TOTAL.5af4e4a14b", "fqn": ["CGOncology_MDM", "adm", "accepted_values_ref_time_periods_period_type__MONTHLY__QUARTERLY__ROLLING__YTD__QTD__PY__PYTD__P2Y__CALENDAR_YEAR__LTD__TOTAL"], "alias": "accepted_values_ref_time_perio_69dab05cba8341cff10c03c297c38747", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_ref_time_perio_69dab05cba8341cff10c03c297c38747", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_ref_time_perio_69dab05cba8341cff10c03c297c38747"}, "created_at": 1770177079.591609, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_ref_time_perio_69dab05cba8341cff10c03c297c38747\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "ref_time_periods", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.ref_time_periods"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "period_type", "file_key_name": "models.ref_time_periods", "attached_node": "model.CGOncology_MDM.ref_time_periods", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "period_type", "values": ["MONTHLY", "QUARTERLY", "ROLLING", "YTD", "QTD", "PY", "PYTD", "P2Y", "CALENDAR_YEAR", "LTD", "TOTAL"], "model": "{{ get_where_subquery(ref('ref_time_periods')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_ref_treatment_categories_code.1067f5254b": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_ref_treatment_categories_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_ref_treatment_categories_code.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_ref_treatment_categories_code.1067f5254b", "fqn": ["CGOncology_MDM", "adm", "not_null_ref_treatment_categories_code"], "alias": "not_null_ref_treatment_categories_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.593173, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "ref_treatment_categories", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.ref_treatment_categories"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "code", "file_key_name": "models.ref_treatment_categories", "attached_node": "model.CGOncology_MDM.ref_treatment_categories", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "code", "model": "{{ get_where_subquery(ref('ref_treatment_categories')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_ref_treatment_categories_code_type.4e9dabd64d": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_ref_treatment_categories_code_type", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_ref_treatment_categories_code_type.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_ref_treatment_categories_code_type.4e9dabd64d", "fqn": ["CGOncology_MDM", "adm", "not_null_ref_treatment_categories_code_type"], "alias": "not_null_ref_treatment_categories_code_type", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.5936792, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "ref_treatment_categories", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.ref_treatment_categories"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "code_type", "file_key_name": "models.ref_treatment_categories", "attached_node": "model.CGOncology_MDM.ref_treatment_categories", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "code_type", "model": "{{ get_where_subquery(ref('ref_treatment_categories')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_ref_treatment_categories_code_type__DX__CPT__HCPCS__ICD10PCS__ICD9__NDC.67743f64a9": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_ref_treatment_categories_code_type__DX__CPT__HCPCS__ICD10PCS__ICD9__NDC", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_ref_treatment__8354ca1e962368622ef9a8b8ca1f624c.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_ref_treatment_categories_code_type__DX__CPT__HCPCS__ICD10PCS__ICD9__NDC.67743f64a9", "fqn": ["CGOncology_MDM", "adm", "accepted_values_ref_treatment_categories_code_type__DX__CPT__HCPCS__ICD10PCS__ICD9__NDC"], "alias": "accepted_values_ref_treatment__8354ca1e962368622ef9a8b8ca1f624c", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_ref_treatment__8354ca1e962368622ef9a8b8ca1f624c", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_ref_treatment__8354ca1e962368622ef9a8b8ca1f624c"}, "created_at": 1770177079.594194, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_ref_treatment__8354ca1e962368622ef9a8b8ca1f624c\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "ref_treatment_categories", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.ref_treatment_categories"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "code_type", "file_key_name": "models.ref_treatment_categories", "attached_node": "model.CGOncology_MDM.ref_treatment_categories", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "code_type", "values": ["DX", "CPT", "HCPCS", "ICD10PCS", "ICD9", "NDC"], "model": "{{ get_where_subquery(ref('ref_treatment_categories')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_ref_treatment_categories_metric_category__BC_DIAGNOSIS__TURBT__TICE_BCG__ADSTILADRIN__ANKTIVA__KEYTRUDA__CYSTOSCOPY__OTHER_PX__OTHER.3764e2253e": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_ref_treatment_categories_metric_category__BC_DIAGNOSIS__TURBT__TICE_BCG__ADSTILADRIN__ANKTIVA__KEYTRUDA__CYSTOSCOPY__OTHER_PX__OTHER", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_ref_treatment__9ee5c5f4bd55b1cd57160534a315fbd3.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_ref_treatment_categories_metric_category__BC_DIAGNOSIS__TURBT__TICE_BCG__ADSTILADRIN__ANKTIVA__KEYTRUDA__CYSTOSCOPY__OTHER_PX__OTHER.3764e2253e", "fqn": ["CGOncology_MDM", "adm", "accepted_values_ref_treatment_categories_metric_category__BC_DIAGNOSIS__TURBT__TICE_BCG__ADSTILADRIN__ANKTIVA__KEYTRUDA__CYSTOSCOPY__OTHER_PX__OTHER"], "alias": "accepted_values_ref_treatment__9ee5c5f4bd55b1cd57160534a315fbd3", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_ref_treatment__9ee5c5f4bd55b1cd57160534a315fbd3", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_ref_treatment__9ee5c5f4bd55b1cd57160534a315fbd3"}, "created_at": 1770177079.59604, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_ref_treatment__9ee5c5f4bd55b1cd57160534a315fbd3\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "ref_treatment_categories", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.ref_treatment_categories"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "metric_category", "file_key_name": "models.ref_treatment_categories", "attached_node": "model.CGOncology_MDM.ref_treatment_categories", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "metric_category", "values": ["BC_DIAGNOSIS", "TURBT", "TICE_BCG", "ADSTILADRIN", "ANKTIVA", "KEYTRUDA", "CYSTOSCOPY", "OTHER_PX", "OTHER"], "model": "{{ get_where_subquery(ref('ref_treatment_categories')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_ref_payor_types_raw_payor_type.7785659b91": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_ref_payor_types_raw_payor_type", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_ref_payor_types_raw_payor_type.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_ref_payor_types_raw_payor_type.7785659b91", "fqn": ["CGOncology_MDM", "adm", "not_null_ref_payor_types_raw_payor_type"], "alias": "not_null_ref_payor_types_raw_payor_type", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.5975602, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "ref_payor_types", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.ref_payor_types"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "raw_payor_type", "file_key_name": "models.ref_payor_types", "attached_node": "model.CGOncology_MDM.ref_payor_types", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "raw_payor_type", "model": "{{ get_where_subquery(ref('ref_payor_types')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_ref_payor_types_canonical_payor_type.67a25c16e9": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_ref_payor_types_canonical_payor_type", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_ref_payor_types_canonical_payor_type.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_ref_payor_types_canonical_payor_type.67a25c16e9", "fqn": ["CGOncology_MDM", "adm", "not_null_ref_payor_types_canonical_payor_type"], "alias": "not_null_ref_payor_types_canonical_payor_type", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.59809, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "ref_payor_types", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.ref_payor_types"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "canonical_payor_type", "file_key_name": "models.ref_payor_types", "attached_node": "model.CGOncology_MDM.ref_payor_types", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "canonical_payor_type", "model": "{{ get_where_subquery(ref('ref_payor_types')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_ref_payor_types_canonical_payor_type__COMMERCIAL__MEDICARE__MEDICAID__MEDICARE_ADVANTAGE__OTHER.0219c536fb": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_ref_payor_types_canonical_payor_type__COMMERCIAL__MEDICARE__MEDICAID__MEDICARE_ADVANTAGE__OTHER", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_ref_payor_type_90142e60c8903d853c1d2336a1be6229.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_ref_payor_types_canonical_payor_type__COMMERCIAL__MEDICARE__MEDICAID__MEDICARE_ADVANTAGE__OTHER.0219c536fb", "fqn": ["CGOncology_MDM", "adm", "accepted_values_ref_payor_types_canonical_payor_type__COMMERCIAL__MEDICARE__MEDICAID__MEDICARE_ADVANTAGE__OTHER"], "alias": "accepted_values_ref_payor_type_90142e60c8903d853c1d2336a1be6229", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_ref_payor_type_90142e60c8903d853c1d2336a1be6229", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_ref_payor_type_90142e60c8903d853c1d2336a1be6229"}, "created_at": 1770177079.598618, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_ref_payor_type_90142e60c8903d853c1d2336a1be6229\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "ref_payor_types", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.ref_payor_types"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "canonical_payor_type", "file_key_name": "models.ref_payor_types", "attached_node": "model.CGOncology_MDM.ref_payor_types", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "canonical_payor_type", "values": ["COMMERCIAL", "MEDICARE", "MEDICAID", "MEDICARE_ADVANTAGE", "OTHER"], "model": "{{ get_where_subquery(ref('ref_payor_types')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_hco_master_kmk_hco_id.19c041cf01": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_hco_master_kmk_hco_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_hco_master_kmk_hco_id.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_hco_master_kmk_hco_id.19c041cf01", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_hco_master_kmk_hco_id"], "alias": "not_null_adm_hco_master_kmk_hco_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.6000571, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hco_master", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_hco_master"]}, "compiled_path": "target/compiled/CGOncology_MDM/models/adm/schema.yml/not_null_adm_hco_master_kmk_hco_id.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect kmk_hco_id\nfrom CGONCOLOGY_TEST.ADM.adm_hco_master\nwhere kmk_hco_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hco_id", "file_key_name": "models.adm_hco_master", "attached_node": "model.CGOncology_MDM.adm_hco_master", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "kmk_hco_id", "model": "{{ get_where_subquery(ref('adm_hco_master')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_adm_hco_master_kmk_hco_id.595890ac11": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_adm_hco_master_kmk_hco_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_adm_hco_master_kmk_hco_id.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.unique_adm_hco_master_kmk_hco_id.595890ac11", "fqn": ["CGOncology_MDM", "adm", "unique_adm_hco_master_kmk_hco_id"], "alias": "unique_adm_hco_master_kmk_hco_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.600568, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hco_master", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_hco_master"]}, "compiled_path": "target/compiled/CGOncology_MDM/models/adm/schema.yml/unique_adm_hco_master_kmk_hco_id.sql", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    kmk_hco_id as unique_field,\n    count(*) as n_records\n\nfrom CGONCOLOGY_TEST.ADM.adm_hco_master\nwhere kmk_hco_id is not null\ngroup by kmk_hco_id\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hco_id", "file_key_name": "models.adm_hco_master", "attached_node": "model.CGOncology_MDM.adm_hco_master", "test_metadata": {"name": "unique", "kwargs": {"column_name": "kmk_hco_id", "model": "{{ get_where_subquery(ref('adm_hco_master')) }}"}, "namespace": null}}, "test.CGOncology_MDM.relationships_adm_hco_master_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.5e67cf4dd2": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "relationships_adm_hco_master_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "relationships_adm_hco_master_f2436efcb74ae9b9c23a4746b8c9680f.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.relationships_adm_hco_master_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.5e67cf4dd2", "fqn": ["CGOncology_MDM", "adm", "relationships_adm_hco_master_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_"], "alias": "relationships_adm_hco_master_f2436efcb74ae9b9c23a4746b8c9680f", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "relationships_adm_hco_master_f2436efcb74ae9b9c23a4746b8c9680f", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "relationships_adm_hco_master_f2436efcb74ae9b9c23a4746b8c9680f"}, "created_at": 1770177079.601088, "relation_name": null, "raw_code": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_adm_hco_master_f2436efcb74ae9b9c23a4746b8c9680f\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hco", "package": null, "version": null}, {"name": "adm_hco_master", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.adm_hco_master"]}, "compiled_path": "target/compiled/CGOncology_MDM/models/adm/schema.yml/relationships_adm_hco_master_f2436efcb74ae9b9c23a4746b8c9680f.sql", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select kmk_hco_id as from_field\n    from CGONCOLOGY_TEST.ADM.adm_hco_master\n    where kmk_hco_id is not null\n),\n\nparent as (\n    select kmk_hco_id as to_field\n    from CGONCOLOGY_TEST.MDM.mdm_customer_master_hco\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hco_id", "file_key_name": "models.adm_hco_master", "attached_node": "model.CGOncology_MDM.adm_hco_master", "test_metadata": {"name": "relationships", "kwargs": {"to": "ref('mdm_customer_master_hco')", "field": "kmk_hco_id", "column_name": "kmk_hco_id", "model": "{{ get_where_subquery(ref('adm_hco_master')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_adm_hco_master_kmk_hco_id___34_0_9_9_.59162648b2": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_column_values_to_match_regex_adm_hco_master_kmk_hco_id___34_0_9_9_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_column_9a13ef141e47b9772c43275f5d297426.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_adm_hco_master_kmk_hco_id___34_0_9_9_.59162648b2", "fqn": ["CGOncology_MDM", "adm", "dbt_expectations_expect_column_values_to_match_regex_adm_hco_master_kmk_hco_id___34_0_9_9_"], "alias": "dbt_expectations_expect_column_9a13ef141e47b9772c43275f5d297426", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_column_9a13ef141e47b9772c43275f5d297426", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_expectations_expect_column_9a13ef141e47b9772c43275f5d297426"}, "created_at": 1770177079.602616, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_column_values_to_match_regex(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_expectations_expect_column_9a13ef141e47b9772c43275f5d297426\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hco_master", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_column_values_to_match_regex", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_hco_master"]}, "compiled_path": "target/compiled/CGOncology_MDM/models/adm/schema.yml/dbt_expectations_expect_column_9a13ef141e47b9772c43275f5d297426.sql", "compiled": true, "compiled_code": "\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n\n\n    \nregexp_instr(kmk_hco_id, '^[34][0-9]{9}$', 1, 1, 0, '')\n\n\n > 0\n as expression\n\n\n    from CGONCOLOGY_TEST.ADM.adm_hco_master\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hco_id", "file_key_name": "models.adm_hco_master", "attached_node": "model.CGOncology_MDM.adm_hco_master", "test_metadata": {"name": "expect_column_values_to_match_regex", "kwargs": {"column_name": "kmk_hco_id", "regex": "^[34][0-9]{9}$", "model": "{{ get_where_subquery(ref('adm_hco_master')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.accepted_values_adm_hco_master_account_type__P1_LUGPA__P2_ACADEMIC__P2_NON_ACADEMIC__P3__FEDERAL__P3_CCS__P4_SMALL_INDEP_Ctr.4bd3ff3d4d": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_hco_master_account_type__P1_LUGPA__P2_ACADEMIC__P2_NON_ACADEMIC__P3__FEDERAL__P3_CCS__P4_SMALL_INDEP_Ctr", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_hco_master_47f69f6701e072e09e6f28858fa0dcd9.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_hco_master_account_type__P1_LUGPA__P2_ACADEMIC__P2_NON_ACADEMIC__P3__FEDERAL__P3_CCS__P4_SMALL_INDEP_Ctr.4bd3ff3d4d", "fqn": ["CGOncology_MDM", "adm", "accepted_values_adm_hco_master_account_type__P1_LUGPA__P2_ACADEMIC__P2_NON_ACADEMIC__P3__FEDERAL__P3_CCS__P4_SMALL_INDEP_Ctr"], "alias": "accepted_values_adm_hco_master_47f69f6701e072e09e6f28858fa0dcd9", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_adm_hco_master_47f69f6701e072e09e6f28858fa0dcd9", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_adm_hco_master_47f69f6701e072e09e6f28858fa0dcd9"}, "created_at": 1770177079.604338, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_adm_hco_master_47f69f6701e072e09e6f28858fa0dcd9\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hco_master", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_hco_master"]}, "compiled_path": "target/compiled/CGOncology_MDM/models/adm/schema.yml/accepted_values_adm_hco_master_47f69f6701e072e09e6f28858fa0dcd9.sql", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        account_type as value_field,\n        count(*) as n_records\n\n    from CGONCOLOGY_TEST.ADM.adm_hco_master\n    group by account_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'P1_LUGPA','P2_ACADEMIC','P2_NON-ACADEMIC','P3_ FEDERAL','P3_CCS','P4_SMALL_INDEP_Ctr'\n)\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "account_type", "file_key_name": "models.adm_hco_master", "attached_node": "model.CGOncology_MDM.adm_hco_master", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "account_type", "values": ["P1_LUGPA", "P2_ACADEMIC", "P2_NON-ACADEMIC", "P3_ FEDERAL", "P3_CCS", "P4_SMALL_INDEP_Ctr"], "model": "{{ get_where_subquery(ref('adm_hco_master')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_adm_hco_master_account_type_priority__P1__P2__P3__P4.c308974a6e": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_hco_master_account_type_priority__P1__P2__P3__P4", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_hco_master_45f93a589c4eefc6c9da032d9e987646.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_hco_master_account_type_priority__P1__P2__P3__P4.c308974a6e", "fqn": ["CGOncology_MDM", "adm", "accepted_values_adm_hco_master_account_type_priority__P1__P2__P3__P4"], "alias": "accepted_values_adm_hco_master_45f93a589c4eefc6c9da032d9e987646", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_adm_hco_master_45f93a589c4eefc6c9da032d9e987646", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_adm_hco_master_45f93a589c4eefc6c9da032d9e987646"}, "created_at": 1770177079.605645, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_adm_hco_master_45f93a589c4eefc6c9da032d9e987646\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hco_master", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_hco_master"]}, "compiled_path": "target/compiled/CGOncology_MDM/models/adm/schema.yml/accepted_values_adm_hco_master_45f93a589c4eefc6c9da032d9e987646.sql", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        account_type_priority as value_field,\n        count(*) as n_records\n\n    from CGONCOLOGY_TEST.ADM.adm_hco_master\n    group by account_type_priority\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'P1','P2','P3','P4'\n)\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "account_type_priority", "file_key_name": "models.adm_hco_master", "attached_node": "model.CGOncology_MDM.adm_hco_master", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "account_type_priority", "values": ["P1", "P2", "P3", "P4"], "model": "{{ get_where_subquery(ref('adm_hco_master')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_adm_hco_master_hierarchy_level__L1__L2__L3__L4.17118f63d4": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_hco_master_hierarchy_level__L1__L2__L3__L4", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_hco_master_hierarchy_level__L1__L2__L3__L4.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_hco_master_hierarchy_level__L1__L2__L3__L4.17118f63d4", "fqn": ["CGOncology_MDM", "adm", "accepted_values_adm_hco_master_hierarchy_level__L1__L2__L3__L4"], "alias": "accepted_values_adm_hco_master_hierarchy_level__L1__L2__L3__L4", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.6068559, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hco_master", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_hco_master"]}, "compiled_path": "target/compiled/CGOncology_MDM/models/adm/schema.yml/accepted_values_adm_hco_master_hierarchy_level__L1__L2__L3__L4.sql", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        hierarchy_level as value_field,\n        count(*) as n_records\n\n    from CGONCOLOGY_TEST.ADM.adm_hco_master\n    group by hierarchy_level\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'L1','L2','L3','L4'\n)\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "hierarchy_level", "file_key_name": "models.adm_hco_master", "attached_node": "model.CGOncology_MDM.adm_hco_master", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "hierarchy_level", "values": ["L1", "L2", "L3", "L4"], "model": "{{ get_where_subquery(ref('adm_hco_master')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_hco_master_cust_backbone_flag.2eb804314f": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_hco_master_cust_backbone_flag", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_hco_master_cust_backbone_flag.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_hco_master_cust_backbone_flag.2eb804314f", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_hco_master_cust_backbone_flag"], "alias": "not_null_adm_hco_master_cust_backbone_flag", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.6079738, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hco_master", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_hco_master"]}, "compiled_path": "target/compiled/CGOncology_MDM/models/adm/schema.yml/not_null_adm_hco_master_cust_backbone_flag.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cust_backbone_flag\nfrom CGONCOLOGY_TEST.ADM.adm_hco_master\nwhere cust_backbone_flag is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "cust_backbone_flag", "file_key_name": "models.adm_hco_master", "attached_node": "model.CGOncology_MDM.adm_hco_master", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "cust_backbone_flag", "model": "{{ get_where_subquery(ref('adm_hco_master')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_adm_hco_master_cust_backbone_flag__Y__N.66c59561ee": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_hco_master_cust_backbone_flag__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_hco_master_cust_backbone_flag__Y__N.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_hco_master_cust_backbone_flag__Y__N.66c59561ee", "fqn": ["CGOncology_MDM", "adm", "accepted_values_adm_hco_master_cust_backbone_flag__Y__N"], "alias": "accepted_values_adm_hco_master_cust_backbone_flag__Y__N", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.608459, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hco_master", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_hco_master"]}, "compiled_path": "target/compiled/CGOncology_MDM/models/adm/schema.yml/accepted_values_adm_hco_master_cust_backbone_flag__Y__N.sql", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        cust_backbone_flag as value_field,\n        count(*) as n_records\n\n    from CGONCOLOGY_TEST.ADM.adm_hco_master\n    group by cust_backbone_flag\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Y','N'\n)\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "cust_backbone_flag", "file_key_name": "models.adm_hco_master", "attached_node": "model.CGOncology_MDM.adm_hco_master", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "cust_backbone_flag", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('adm_hco_master')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_adm_hco_master_network_target_flag__0__1.f1bb7a4710": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_hco_master_network_target_flag__0__1", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_hco_master_network_target_flag__0__1.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_hco_master_network_target_flag__0__1.f1bb7a4710", "fqn": ["CGOncology_MDM", "adm", "accepted_values_adm_hco_master_network_target_flag__0__1"], "alias": "accepted_values_adm_hco_master_network_target_flag__0__1", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.609827, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hco_master", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_hco_master"]}, "compiled_path": "target/compiled/CGOncology_MDM/models/adm/schema.yml/accepted_values_adm_hco_master_network_target_flag__0__1.sql", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        network_target_flag as value_field,\n        count(*) as n_records\n\n    from CGONCOLOGY_TEST.ADM.adm_hco_master\n    group by network_target_flag\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    '0','1'\n)\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "network_target_flag", "file_key_name": "models.adm_hco_master", "attached_node": "model.CGOncology_MDM.adm_hco_master", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "network_target_flag", "values": [0, 1], "model": "{{ get_where_subquery(ref('adm_hco_master')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_adm_hco_master_child_target_flag__0__1.f2eb08ef11": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_hco_master_child_target_flag__0__1", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_hco_master_child_target_flag__0__1.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_hco_master_child_target_flag__0__1.f2eb08ef11", "fqn": ["CGOncology_MDM", "adm", "accepted_values_adm_hco_master_child_target_flag__0__1"], "alias": "accepted_values_adm_hco_master_child_target_flag__0__1", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.61095, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hco_master", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_hco_master"]}, "compiled_path": "target/compiled/CGOncology_MDM/models/adm/schema.yml/accepted_values_adm_hco_master_child_target_flag__0__1.sql", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        child_target_flag as value_field,\n        count(*) as n_records\n\n    from CGONCOLOGY_TEST.ADM.adm_hco_master\n    group by child_target_flag\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    '0','1'\n)\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "child_target_flag", "file_key_name": "models.adm_hco_master", "attached_node": "model.CGOncology_MDM.adm_hco_master", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "child_target_flag", "values": [0, 1], "model": "{{ get_where_subquery(ref('adm_hco_master')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_adm_hco_master_kam_target_flag__Y__N.bae2588bce": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_hco_master_kam_target_flag__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_hco_master_kam_target_flag__Y__N.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_hco_master_kam_target_flag__Y__N.bae2588bce", "fqn": ["CGOncology_MDM", "adm", "accepted_values_adm_hco_master_kam_target_flag__Y__N"], "alias": "accepted_values_adm_hco_master_kam_target_flag__Y__N", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.612051, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hco_master", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_hco_master"]}, "compiled_path": "target/compiled/CGOncology_MDM/models/adm/schema.yml/accepted_values_adm_hco_master_kam_target_flag__Y__N.sql", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        kam_target_flag as value_field,\n        count(*) as n_records\n\n    from CGONCOLOGY_TEST.ADM.adm_hco_master\n    group by kam_target_flag\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Y','N'\n)\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kam_target_flag", "file_key_name": "models.adm_hco_master", "attached_node": "model.CGOncology_MDM.adm_hco_master", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "kam_target_flag", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('adm_hco_master')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_adm_hco_master_hsd_target_flag__Y__N.6622511c65": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_hco_master_hsd_target_flag__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_hco_master_hsd_target_flag__Y__N.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_hco_master_hsd_target_flag__Y__N.6622511c65", "fqn": ["CGOncology_MDM", "adm", "accepted_values_adm_hco_master_hsd_target_flag__Y__N"], "alias": "accepted_values_adm_hco_master_hsd_target_flag__Y__N", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.613143, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hco_master", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_hco_master"]}, "compiled_path": "target/compiled/CGOncology_MDM/models/adm/schema.yml/accepted_values_adm_hco_master_hsd_target_flag__Y__N.sql", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        hsd_target_flag as value_field,\n        count(*) as n_records\n\n    from CGONCOLOGY_TEST.ADM.adm_hco_master\n    group by hsd_target_flag\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Y','N'\n)\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "hsd_target_flag", "file_key_name": "models.adm_hco_master", "attached_node": "model.CGOncology_MDM.adm_hco_master", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "hsd_target_flag", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('adm_hco_master')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_adm_hco_master_msl_target_flag__Y__N.fc14917e51": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_hco_master_msl_target_flag__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_hco_master_msl_target_flag__Y__N.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_hco_master_msl_target_flag__Y__N.fc14917e51", "fqn": ["CGOncology_MDM", "adm", "accepted_values_adm_hco_master_msl_target_flag__Y__N"], "alias": "accepted_values_adm_hco_master_msl_target_flag__Y__N", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.6144562, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hco_master", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_hco_master"]}, "compiled_path": "target/compiled/CGOncology_MDM/models/adm/schema.yml/accepted_values_adm_hco_master_msl_target_flag__Y__N.sql", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        msl_target_flag as value_field,\n        count(*) as n_records\n\n    from CGONCOLOGY_TEST.ADM.adm_hco_master\n    group by msl_target_flag\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Y','N'\n)\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "msl_target_flag", "file_key_name": "models.adm_hco_master", "attached_node": "model.CGOncology_MDM.adm_hco_master", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "msl_target_flag", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('adm_hco_master')) }}"}, "namespace": null}}, "test.CGOncology_MDM.row_count_match_adm_hco_master_ref_mdm_customer_master_hco_.8e0ebfab64": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "row_count_match_adm_hco_master_ref_mdm_customer_master_hco_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "row_count_match_adm_hco_master_ref_mdm_customer_master_hco_.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.row_count_match_adm_hco_master_ref_mdm_customer_master_hco_.8e0ebfab64", "fqn": ["CGOncology_MDM", "adm", "row_count_match_adm_hco_master_ref_mdm_customer_master_hco_"], "alias": "row_count_match_adm_hco_master_ref_mdm_customer_master_hco_", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.6155698, "relation_name": null, "raw_code": "{{ test_row_count_match(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hco", "package": null, "version": null}, {"name": "adm_hco_master", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.CGOncology_MDM.test_row_count_match", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.adm_hco_master"]}, "compiled_path": "target/compiled/CGOncology_MDM/models/adm/schema.yml/row_count_match_adm_hco_master_ref_mdm_customer_master_hco_.sql", "compiled": true, "compiled_code": "\n\n\nWITH target_count AS (\n    SELECT COUNT(*) as cnt\n    FROM CGONCOLOGY_TEST.ADM.adm_hco_master\n    \n),\nsource_count AS (\n    SELECT COUNT(*) as cnt\n    FROM CGONCOLOGY_TEST.MDM.mdm_customer_master_hco\n    \n),\ncomparison AS (\n    SELECT\n        t.cnt as target_rows,\n        s.cnt as source_rows,\n        t.cnt - s.cnt as row_difference\n    FROM target_count t\n    CROSS JOIN source_count s\n)\nSELECT *\nFROM comparison\nWHERE target_rows != source_rows\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.adm_hco_master", "attached_node": "model.CGOncology_MDM.adm_hco_master", "test_metadata": {"name": "row_count_match", "kwargs": {"source_model": "ref('mdm_customer_master_hco')", "model": "{{ get_where_subquery(ref('adm_hco_master')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_hcp_master_kmk_hcp_id.9fed89113c": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_hcp_master_kmk_hcp_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_hcp_master_kmk_hcp_id.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_hcp_master_kmk_hcp_id.9fed89113c", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_hcp_master_kmk_hcp_id"], "alias": "not_null_adm_hcp_master_kmk_hcp_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.617602, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hcp_master", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_hcp_master"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hcp_id", "file_key_name": "models.adm_hcp_master", "attached_node": "model.CGOncology_MDM.adm_hcp_master", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "kmk_hcp_id", "model": "{{ get_where_subquery(ref('adm_hcp_master')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_adm_hcp_master_kmk_hcp_id.3250d72e22": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_adm_hcp_master_kmk_hcp_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_adm_hcp_master_kmk_hcp_id.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.unique_adm_hcp_master_kmk_hcp_id.3250d72e22", "fqn": ["CGOncology_MDM", "adm", "unique_adm_hcp_master_kmk_hcp_id"], "alias": "unique_adm_hcp_master_kmk_hcp_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.618127, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hcp_master", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.CGOncology_MDM.adm_hcp_master"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hcp_id", "file_key_name": "models.adm_hcp_master", "attached_node": "model.CGOncology_MDM.adm_hcp_master", "test_metadata": {"name": "unique", "kwargs": {"column_name": "kmk_hcp_id", "model": "{{ get_where_subquery(ref('adm_hcp_master')) }}"}, "namespace": null}}, "test.CGOncology_MDM.relationships_adm_hcp_master_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_.29aa3c4a53": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "relationships_adm_hcp_master_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "relationships_adm_hcp_master_1541c0cf6b918e81ec1279cd0f8b5f16.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.relationships_adm_hcp_master_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_.29aa3c4a53", "fqn": ["CGOncology_MDM", "adm", "relationships_adm_hcp_master_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_"], "alias": "relationships_adm_hcp_master_1541c0cf6b918e81ec1279cd0f8b5f16", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "relationships_adm_hcp_master_1541c0cf6b918e81ec1279cd0f8b5f16", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "relationships_adm_hcp_master_1541c0cf6b918e81ec1279cd0f8b5f16"}, "created_at": 1770177079.618655, "relation_name": null, "raw_code": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_adm_hcp_master_1541c0cf6b918e81ec1279cd0f8b5f16\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hcp", "package": null, "version": null}, {"name": "adm_hcp_master", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hcp", "model.CGOncology_MDM.adm_hcp_master"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hcp_id", "file_key_name": "models.adm_hcp_master", "attached_node": "model.CGOncology_MDM.adm_hcp_master", "test_metadata": {"name": "relationships", "kwargs": {"to": "ref('mdm_customer_master_hcp')", "field": "kmk_hcp_id", "column_name": "kmk_hcp_id", "model": "{{ get_where_subquery(ref('adm_hcp_master')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_adm_hcp_master_kmk_hcp_id___15_0_9_9_.0f016d3772": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_column_values_to_match_regex_adm_hcp_master_kmk_hcp_id___15_0_9_9_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_column_f7ffd352f49baf408891bca6e657b0cd.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_adm_hcp_master_kmk_hcp_id___15_0_9_9_.0f016d3772", "fqn": ["CGOncology_MDM", "adm", "dbt_expectations_expect_column_values_to_match_regex_adm_hcp_master_kmk_hcp_id___15_0_9_9_"], "alias": "dbt_expectations_expect_column_f7ffd352f49baf408891bca6e657b0cd", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_column_f7ffd352f49baf408891bca6e657b0cd", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_expectations_expect_column_f7ffd352f49baf408891bca6e657b0cd"}, "created_at": 1770177079.6203048, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_column_values_to_match_regex(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_expectations_expect_column_f7ffd352f49baf408891bca6e657b0cd\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hcp_master", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_column_values_to_match_regex", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_hcp_master"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hcp_id", "file_key_name": "models.adm_hcp_master", "attached_node": "model.CGOncology_MDM.adm_hcp_master", "test_metadata": {"name": "expect_column_values_to_match_regex", "kwargs": {"column_name": "kmk_hcp_id", "regex": "^[15][0-9]{9}$", "model": "{{ get_where_subquery(ref('adm_hcp_master')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.not_null_adm_hcp_master_npi.b8c1e61554": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_hcp_master_npi", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_hcp_master_npi.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_hcp_master_npi.b8c1e61554", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_hcp_master_npi"], "alias": "not_null_adm_hcp_master_npi", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.6221042, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hcp_master", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_hcp_master"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "npi", "file_key_name": "models.adm_hcp_master", "attached_node": "model.CGOncology_MDM.adm_hcp_master", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "npi", "model": "{{ get_where_subquery(ref('adm_hcp_master')) }}"}, "namespace": null}}, "test.CGOncology_MDM.relationships_adm_hcp_master_npi__npi__ref_mdm_customer_master_hcp_.c817192688": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "relationships_adm_hcp_master_npi__npi__ref_mdm_customer_master_hcp_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "relationships_adm_hcp_master_7dc4deb6de92ad5276cf38430094e533.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.relationships_adm_hcp_master_npi__npi__ref_mdm_customer_master_hcp_.c817192688", "fqn": ["CGOncology_MDM", "adm", "relationships_adm_hcp_master_npi__npi__ref_mdm_customer_master_hcp_"], "alias": "relationships_adm_hcp_master_7dc4deb6de92ad5276cf38430094e533", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "relationships_adm_hcp_master_7dc4deb6de92ad5276cf38430094e533", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "relationships_adm_hcp_master_7dc4deb6de92ad5276cf38430094e533"}, "created_at": 1770177079.6226351, "relation_name": null, "raw_code": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_adm_hcp_master_7dc4deb6de92ad5276cf38430094e533\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hcp", "package": null, "version": null}, {"name": "adm_hcp_master", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hcp", "model.CGOncology_MDM.adm_hcp_master"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "npi", "file_key_name": "models.adm_hcp_master", "attached_node": "model.CGOncology_MDM.adm_hcp_master", "test_metadata": {"name": "relationships", "kwargs": {"to": "ref('mdm_customer_master_hcp')", "field": "npi", "column_name": "npi", "model": "{{ get_where_subquery(ref('adm_hcp_master')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_hcp_master_cust_backbone_flag.aae912f453": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_hcp_master_cust_backbone_flag", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_hcp_master_cust_backbone_flag.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_hcp_master_cust_backbone_flag.aae912f453", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_hcp_master_cust_backbone_flag"], "alias": "not_null_adm_hcp_master_cust_backbone_flag", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.624137, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hcp_master", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_hcp_master"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "cust_backbone_flag", "file_key_name": "models.adm_hcp_master", "attached_node": "model.CGOncology_MDM.adm_hcp_master", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "cust_backbone_flag", "model": "{{ get_where_subquery(ref('adm_hcp_master')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_adm_hcp_master_cust_backbone_flag__Y__N.c77ea1fe72": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_hcp_master_cust_backbone_flag__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_hcp_master_cust_backbone_flag__Y__N.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_hcp_master_cust_backbone_flag__Y__N.c77ea1fe72", "fqn": ["CGOncology_MDM", "adm", "accepted_values_adm_hcp_master_cust_backbone_flag__Y__N"], "alias": "accepted_values_adm_hcp_master_cust_backbone_flag__Y__N", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.624633, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hcp_master", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_hcp_master"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "cust_backbone_flag", "file_key_name": "models.adm_hcp_master", "attached_node": "model.CGOncology_MDM.adm_hcp_master", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "cust_backbone_flag", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('adm_hcp_master')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_adm_hcp_master_kam_target_flag__Y__N.64ee4b29c7": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_hcp_master_kam_target_flag__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_hcp_master_kam_target_flag__Y__N.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_hcp_master_kam_target_flag__Y__N.64ee4b29c7", "fqn": ["CGOncology_MDM", "adm", "accepted_values_adm_hcp_master_kam_target_flag__Y__N"], "alias": "accepted_values_adm_hcp_master_kam_target_flag__Y__N", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.62582, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hcp_master", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_hcp_master"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kam_target_flag", "file_key_name": "models.adm_hcp_master", "attached_node": "model.CGOncology_MDM.adm_hcp_master", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "kam_target_flag", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('adm_hcp_master')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_adm_hcp_master_kam_decile__1__2__3__4__5__6__7__8__9__10.756fdeacaf": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_hcp_master_kam_decile__1__2__3__4__5__6__7__8__9__10", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_hcp_master_0674efcb66f05e67b4d9c5f92ab6c7c2.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_hcp_master_kam_decile__1__2__3__4__5__6__7__8__9__10.756fdeacaf", "fqn": ["CGOncology_MDM", "adm", "accepted_values_adm_hcp_master_kam_decile__1__2__3__4__5__6__7__8__9__10"], "alias": "accepted_values_adm_hcp_master_0674efcb66f05e67b4d9c5f92ab6c7c2", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_adm_hcp_master_0674efcb66f05e67b4d9c5f92ab6c7c2", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": "kam_decile IS NOT NULL", "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"where": "kam_decile IS NOT NULL", "alias": "accepted_values_adm_hcp_master_0674efcb66f05e67b4d9c5f92ab6c7c2"}, "created_at": 1770177079.6270368, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(where=\"kam_decile IS NOT NULL\",alias=\"accepted_values_adm_hcp_master_0674efcb66f05e67b4d9c5f92ab6c7c2\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hcp_master", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_hcp_master"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kam_decile", "file_key_name": "models.adm_hcp_master", "attached_node": "model.CGOncology_MDM.adm_hcp_master", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "kam_decile", "values": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "model": "{{ get_where_subquery(ref('adm_hcp_master')) }}"}, "namespace": null}}, "test.CGOncology_MDM.row_count_match_adm_hcp_master_ref_mdm_customer_master_hcp_.45f3a4cae5": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "row_count_match_adm_hcp_master_ref_mdm_customer_master_hcp_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "row_count_match_adm_hcp_master_ref_mdm_customer_master_hcp_.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.row_count_match_adm_hcp_master_ref_mdm_customer_master_hcp_.45f3a4cae5", "fqn": ["CGOncology_MDM", "adm", "row_count_match_adm_hcp_master_ref_mdm_customer_master_hcp_"], "alias": "row_count_match_adm_hcp_master_ref_mdm_customer_master_hcp_", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.6287072, "relation_name": null, "raw_code": "{{ test_row_count_match(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hcp", "package": null, "version": null}, {"name": "adm_hcp_master", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.CGOncology_MDM.test_row_count_match", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hcp", "model.CGOncology_MDM.adm_hcp_master"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.adm_hcp_master", "attached_node": "model.CGOncology_MDM.adm_hcp_master", "test_metadata": {"name": "row_count_match", "kwargs": {"source_model": "ref('mdm_customer_master_hcp')", "model": "{{ get_where_subquery(ref('adm_hcp_master')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_hco_hierarchy_kmk_hco_id.57589754c5": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_hco_hierarchy_kmk_hco_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_hco_hierarchy_kmk_hco_id.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_hco_hierarchy_kmk_hco_id.57589754c5", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_hco_hierarchy_kmk_hco_id"], "alias": "not_null_adm_hco_hierarchy_kmk_hco_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.630282, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hco_hierarchy", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_hco_hierarchy"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hco_id", "file_key_name": "models.adm_hco_hierarchy", "attached_node": "model.CGOncology_MDM.adm_hco_hierarchy", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "kmk_hco_id", "model": "{{ get_where_subquery(ref('adm_hco_hierarchy')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_adm_hco_hierarchy_kmk_hco_id.af11937683": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_adm_hco_hierarchy_kmk_hco_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_adm_hco_hierarchy_kmk_hco_id.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.unique_adm_hco_hierarchy_kmk_hco_id.af11937683", "fqn": ["CGOncology_MDM", "adm", "unique_adm_hco_hierarchy_kmk_hco_id"], "alias": "unique_adm_hco_hierarchy_kmk_hco_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.630836, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hco_hierarchy", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.CGOncology_MDM.adm_hco_hierarchy"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hco_id", "file_key_name": "models.adm_hco_hierarchy", "attached_node": "model.CGOncology_MDM.adm_hco_hierarchy", "test_metadata": {"name": "unique", "kwargs": {"column_name": "kmk_hco_id", "model": "{{ get_where_subquery(ref('adm_hco_hierarchy')) }}"}, "namespace": null}}, "test.CGOncology_MDM.relationships_adm_hco_hierarchy_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.1d6b8c0dce": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "relationships_adm_hco_hierarchy_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "relationships_adm_hco_hierarch_c1a7b2d802bfa8a624a36034e6acfc70.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.relationships_adm_hco_hierarchy_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.1d6b8c0dce", "fqn": ["CGOncology_MDM", "adm", "relationships_adm_hco_hierarchy_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_"], "alias": "relationships_adm_hco_hierarch_c1a7b2d802bfa8a624a36034e6acfc70", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "relationships_adm_hco_hierarch_c1a7b2d802bfa8a624a36034e6acfc70", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "relationships_adm_hco_hierarch_c1a7b2d802bfa8a624a36034e6acfc70"}, "created_at": 1770177079.631385, "relation_name": null, "raw_code": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_adm_hco_hierarch_c1a7b2d802bfa8a624a36034e6acfc70\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hco", "package": null, "version": null}, {"name": "adm_hco_hierarchy", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.adm_hco_hierarchy"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hco_id", "file_key_name": "models.adm_hco_hierarchy", "attached_node": "model.CGOncology_MDM.adm_hco_hierarchy", "test_metadata": {"name": "relationships", "kwargs": {"to": "ref('mdm_customer_master_hco')", "field": "kmk_hco_id", "column_name": "kmk_hco_id", "model": "{{ get_where_subquery(ref('adm_hco_hierarchy')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_hco_hierarchy_hierarchy_level.8368eddce9": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_hco_hierarchy_hierarchy_level", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_hco_hierarchy_hierarchy_level.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_hco_hierarchy_hierarchy_level.8368eddce9", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_hco_hierarchy_hierarchy_level"], "alias": "not_null_adm_hco_hierarchy_hierarchy_level", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.633155, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hco_hierarchy", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_hco_hierarchy"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "hierarchy_level", "file_key_name": "models.adm_hco_hierarchy", "attached_node": "model.CGOncology_MDM.adm_hco_hierarchy", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "hierarchy_level", "model": "{{ get_where_subquery(ref('adm_hco_hierarchy')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_adm_hco_hierarchy_hierarchy_level__L1__L2__L3__L4.aedee61f35": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_hco_hierarchy_hierarchy_level__L1__L2__L3__L4", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_hco_hierar_65f641ba6130758ccf1a666254f5c47f.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_hco_hierarchy_hierarchy_level__L1__L2__L3__L4.aedee61f35", "fqn": ["CGOncology_MDM", "adm", "accepted_values_adm_hco_hierarchy_hierarchy_level__L1__L2__L3__L4"], "alias": "accepted_values_adm_hco_hierar_65f641ba6130758ccf1a666254f5c47f", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_adm_hco_hierar_65f641ba6130758ccf1a666254f5c47f", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_adm_hco_hierar_65f641ba6130758ccf1a666254f5c47f"}, "created_at": 1770177079.633675, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_adm_hco_hierar_65f641ba6130758ccf1a666254f5c47f\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hco_hierarchy", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_hco_hierarchy"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "hierarchy_level", "file_key_name": "models.adm_hco_hierarchy", "attached_node": "model.CGOncology_MDM.adm_hco_hierarchy", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "hierarchy_level", "values": ["L1", "L2", "L3", "L4"], "model": "{{ get_where_subquery(ref('adm_hco_hierarchy')) }}"}, "namespace": null}}, "test.CGOncology_MDM.relationships_adm_hco_hierarchy_account_id_l1__kmk_hco_id__ref_mdm_customer_master_hco_.23c5f3762e": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "relationships_adm_hco_hierarchy_account_id_l1__kmk_hco_id__ref_mdm_customer_master_hco_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "relationships_adm_hco_hierarch_fd8d0d57ae0eaf236b8e393a0eda17bb.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.relationships_adm_hco_hierarchy_account_id_l1__kmk_hco_id__ref_mdm_customer_master_hco_.23c5f3762e", "fqn": ["CGOncology_MDM", "adm", "relationships_adm_hco_hierarchy_account_id_l1__kmk_hco_id__ref_mdm_customer_master_hco_"], "alias": "relationships_adm_hco_hierarch_fd8d0d57ae0eaf236b8e393a0eda17bb", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "relationships_adm_hco_hierarch_fd8d0d57ae0eaf236b8e393a0eda17bb", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": "account_id_l1 IS NOT NULL", "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"where": "account_id_l1 IS NOT NULL", "alias": "relationships_adm_hco_hierarch_fd8d0d57ae0eaf236b8e393a0eda17bb"}, "created_at": 1770177079.635401, "relation_name": null, "raw_code": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(where=\"account_id_l1 IS NOT NULL\",alias=\"relationships_adm_hco_hierarch_fd8d0d57ae0eaf236b8e393a0eda17bb\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hco", "package": null, "version": null}, {"name": "adm_hco_hierarchy", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.adm_hco_hierarchy"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "account_id_l1", "file_key_name": "models.adm_hco_hierarchy", "attached_node": "model.CGOncology_MDM.adm_hco_hierarchy", "test_metadata": {"name": "relationships", "kwargs": {"to": "ref('mdm_customer_master_hco')", "field": "kmk_hco_id", "column_name": "account_id_l1", "model": "{{ get_where_subquery(ref('adm_hco_hierarchy')) }}"}, "namespace": null}}, "test.CGOncology_MDM.relationships_adm_hco_hierarchy_account_id_l2__kmk_hco_id__ref_mdm_customer_master_hco_.1db54b1492": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "relationships_adm_hco_hierarchy_account_id_l2__kmk_hco_id__ref_mdm_customer_master_hco_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "relationships_adm_hco_hierarch_c998084dfc8163e1d01dc267f43d86db.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.relationships_adm_hco_hierarchy_account_id_l2__kmk_hco_id__ref_mdm_customer_master_hco_.1db54b1492", "fqn": ["CGOncology_MDM", "adm", "relationships_adm_hco_hierarchy_account_id_l2__kmk_hco_id__ref_mdm_customer_master_hco_"], "alias": "relationships_adm_hco_hierarch_c998084dfc8163e1d01dc267f43d86db", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "relationships_adm_hco_hierarch_c998084dfc8163e1d01dc267f43d86db", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": "account_id_l2 IS NOT NULL", "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"where": "account_id_l2 IS NOT NULL", "alias": "relationships_adm_hco_hierarch_c998084dfc8163e1d01dc267f43d86db"}, "created_at": 1770177079.636988, "relation_name": null, "raw_code": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(where=\"account_id_l2 IS NOT NULL\",alias=\"relationships_adm_hco_hierarch_c998084dfc8163e1d01dc267f43d86db\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hco", "package": null, "version": null}, {"name": "adm_hco_hierarchy", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.adm_hco_hierarchy"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "account_id_l2", "file_key_name": "models.adm_hco_hierarchy", "attached_node": "model.CGOncology_MDM.adm_hco_hierarchy", "test_metadata": {"name": "relationships", "kwargs": {"to": "ref('mdm_customer_master_hco')", "field": "kmk_hco_id", "column_name": "account_id_l2", "model": "{{ get_where_subquery(ref('adm_hco_hierarchy')) }}"}, "namespace": null}}, "test.CGOncology_MDM.relationships_adm_hco_hierarchy_account_id_l3__kmk_hco_id__ref_mdm_customer_master_hco_.c75c8794ac": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "relationships_adm_hco_hierarchy_account_id_l3__kmk_hco_id__ref_mdm_customer_master_hco_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "relationships_adm_hco_hierarch_ee05d96f5a647012073ae96fdbbaba82.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.relationships_adm_hco_hierarchy_account_id_l3__kmk_hco_id__ref_mdm_customer_master_hco_.c75c8794ac", "fqn": ["CGOncology_MDM", "adm", "relationships_adm_hco_hierarchy_account_id_l3__kmk_hco_id__ref_mdm_customer_master_hco_"], "alias": "relationships_adm_hco_hierarch_ee05d96f5a647012073ae96fdbbaba82", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "relationships_adm_hco_hierarch_ee05d96f5a647012073ae96fdbbaba82", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": "account_id_l3 IS NOT NULL", "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"where": "account_id_l3 IS NOT NULL", "alias": "relationships_adm_hco_hierarch_ee05d96f5a647012073ae96fdbbaba82"}, "created_at": 1770177079.638539, "relation_name": null, "raw_code": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(where=\"account_id_l3 IS NOT NULL\",alias=\"relationships_adm_hco_hierarch_ee05d96f5a647012073ae96fdbbaba82\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hco", "package": null, "version": null}, {"name": "adm_hco_hierarchy", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.adm_hco_hierarchy"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "account_id_l3", "file_key_name": "models.adm_hco_hierarchy", "attached_node": "model.CGOncology_MDM.adm_hco_hierarchy", "test_metadata": {"name": "relationships", "kwargs": {"to": "ref('mdm_customer_master_hco')", "field": "kmk_hco_id", "column_name": "account_id_l3", "model": "{{ get_where_subquery(ref('adm_hco_hierarchy')) }}"}, "namespace": null}}, "test.CGOncology_MDM.relationships_adm_hco_hierarchy_account_id_l4__kmk_hco_id__ref_mdm_customer_master_hco_.11f5ece339": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "relationships_adm_hco_hierarchy_account_id_l4__kmk_hco_id__ref_mdm_customer_master_hco_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "relationships_adm_hco_hierarch_f77b05b9319c82a4a13ecfc1190a5606.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.relationships_adm_hco_hierarchy_account_id_l4__kmk_hco_id__ref_mdm_customer_master_hco_.11f5ece339", "fqn": ["CGOncology_MDM", "adm", "relationships_adm_hco_hierarchy_account_id_l4__kmk_hco_id__ref_mdm_customer_master_hco_"], "alias": "relationships_adm_hco_hierarch_f77b05b9319c82a4a13ecfc1190a5606", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "relationships_adm_hco_hierarch_f77b05b9319c82a4a13ecfc1190a5606", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": "account_id_l4 IS NOT NULL", "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"where": "account_id_l4 IS NOT NULL", "alias": "relationships_adm_hco_hierarch_f77b05b9319c82a4a13ecfc1190a5606"}, "created_at": 1770177079.640055, "relation_name": null, "raw_code": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(where=\"account_id_l4 IS NOT NULL\",alias=\"relationships_adm_hco_hierarch_f77b05b9319c82a4a13ecfc1190a5606\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hco", "package": null, "version": null}, {"name": "adm_hco_hierarchy", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.adm_hco_hierarchy"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "account_id_l4", "file_key_name": "models.adm_hco_hierarchy", "attached_node": "model.CGOncology_MDM.adm_hco_hierarchy", "test_metadata": {"name": "relationships", "kwargs": {"to": "ref('mdm_customer_master_hco')", "field": "kmk_hco_id", "column_name": "account_id_l4", "model": "{{ get_where_subquery(ref('adm_hco_hierarchy')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_claims_metrics_long_entity_type.4ee8824a9d": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_claims_metrics_long_entity_type", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_claims_metrics_long_entity_type.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_claims_metrics_long_entity_type.4ee8824a9d", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_claims_metrics_long_entity_type"], "alias": "not_null_adm_claims_metrics_long_entity_type", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.641522, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_claims_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_claims_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "entity_type", "file_key_name": "models.adm_claims_metrics_long", "attached_node": "model.CGOncology_MDM.adm_claims_metrics_long", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "entity_type", "model": "{{ get_where_subquery(ref('adm_claims_metrics_long')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_adm_claims_metrics_long_entity_type__HCO__HCP.ae7d2aedac": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_claims_metrics_long_entity_type__HCO__HCP", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_claims_metrics_long_entity_type__HCO__HCP.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_claims_metrics_long_entity_type__HCO__HCP.ae7d2aedac", "fqn": ["CGOncology_MDM", "adm", "accepted_values_adm_claims_metrics_long_entity_type__HCO__HCP"], "alias": "accepted_values_adm_claims_metrics_long_entity_type__HCO__HCP", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.642414, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_claims_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_claims_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "entity_type", "file_key_name": "models.adm_claims_metrics_long", "attached_node": "model.CGOncology_MDM.adm_claims_metrics_long", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "entity_type", "values": ["HCO", "HCP"], "model": "{{ get_where_subquery(ref('adm_claims_metrics_long')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_claims_metrics_long_entity_id.62f222c646": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_claims_metrics_long_entity_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_claims_metrics_long_entity_id.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_claims_metrics_long_entity_id.62f222c646", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_claims_metrics_long_entity_id"], "alias": "not_null_adm_claims_metrics_long_entity_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.643625, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_claims_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_claims_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "entity_id", "file_key_name": "models.adm_claims_metrics_long", "attached_node": "model.CGOncology_MDM.adm_claims_metrics_long", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "entity_id", "model": "{{ get_where_subquery(ref('adm_claims_metrics_long')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_claims_metrics_long_metric_category.a993d0d928": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_claims_metrics_long_metric_category", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_claims_metrics_long_metric_category.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_claims_metrics_long_metric_category.a993d0d928", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_claims_metrics_long_metric_category"], "alias": "not_null_adm_claims_metrics_long_metric_category", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.6441238, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_claims_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_claims_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "metric_category", "file_key_name": "models.adm_claims_metrics_long", "attached_node": "model.CGOncology_MDM.adm_claims_metrics_long", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "metric_category", "model": "{{ get_where_subquery(ref('adm_claims_metrics_long')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_adm_claims_metrics_long_metric_category__BC_DIAGNOSIS__TURBT__TICE_BCG__ADSTILADRIN__ANKTIVA__KEYTRUDA__CYSTOSCOPY__OTHER_PROCEDURES__Total_Claims.94301565dc": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_claims_metrics_long_metric_category__BC_DIAGNOSIS__TURBT__TICE_BCG__ADSTILADRIN__ANKTIVA__KEYTRUDA__CYSTOSCOPY__OTHER_PROCEDURES__Total_Claims", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_claims_met_0efe0214a6871744bdc0bee4b87cf7b9.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_claims_metrics_long_metric_category__BC_DIAGNOSIS__TURBT__TICE_BCG__ADSTILADRIN__ANKTIVA__KEYTRUDA__CYSTOSCOPY__OTHER_PROCEDURES__Total_Claims.94301565dc", "fqn": ["CGOncology_MDM", "adm", "accepted_values_adm_claims_metrics_long_metric_category__BC_DIAGNOSIS__TURBT__TICE_BCG__ADSTILADRIN__ANKTIVA__KEYTRUDA__CYSTOSCOPY__OTHER_PROCEDURES__Total_Claims"], "alias": "accepted_values_adm_claims_met_0efe0214a6871744bdc0bee4b87cf7b9", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_adm_claims_met_0efe0214a6871744bdc0bee4b87cf7b9", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_adm_claims_met_0efe0214a6871744bdc0bee4b87cf7b9"}, "created_at": 1770177079.644644, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_adm_claims_met_0efe0214a6871744bdc0bee4b87cf7b9\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_claims_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_claims_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "metric_category", "file_key_name": "models.adm_claims_metrics_long", "attached_node": "model.CGOncology_MDM.adm_claims_metrics_long", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "metric_category", "values": ["BC_DIAGNOSIS", "TURBT", "TICE_BCG", "ADSTILADRIN", "ANKTIVA", "KEYTRUDA", "CYSTOSCOPY", "OTHER_PROCEDURES", "Total Claims"], "model": "{{ get_where_subquery(ref('adm_claims_metrics_long')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_claims_metrics_long_period_key.a7e5be47da": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_claims_metrics_long_period_key", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_claims_metrics_long_period_key.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_claims_metrics_long_period_key.a7e5be47da", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_claims_metrics_long_period_key"], "alias": "not_null_adm_claims_metrics_long_period_key", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.645916, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_claims_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_claims_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "period_key", "file_key_name": "models.adm_claims_metrics_long", "attached_node": "model.CGOncology_MDM.adm_claims_metrics_long", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "period_key", "model": "{{ get_where_subquery(ref('adm_claims_metrics_long')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_claims_metrics_long_claim_count.e55d380d3c": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_claims_metrics_long_claim_count", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_claims_metrics_long_claim_count.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_claims_metrics_long_claim_count.e55d380d3c", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_claims_metrics_long_claim_count"], "alias": "not_null_adm_claims_metrics_long_claim_count", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.646413, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_claims_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_claims_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "claim_count", "file_key_name": "models.adm_claims_metrics_long", "attached_node": "model.CGOncology_MDM.adm_claims_metrics_long", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "claim_count", "model": "{{ get_where_subquery(ref('adm_claims_metrics_long')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_be_between_adm_claims_metrics_long_claim_count__0.d16650926f": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_column_values_to_be_between_adm_claims_metrics_long_claim_count__0", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_column_5d63a7843e440705390c48571baa6260.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_be_between_adm_claims_metrics_long_claim_count__0.d16650926f", "fqn": ["CGOncology_MDM", "adm", "dbt_expectations_expect_column_values_to_be_between_adm_claims_metrics_long_claim_count__0"], "alias": "dbt_expectations_expect_column_5d63a7843e440705390c48571baa6260", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_column_5d63a7843e440705390c48571baa6260", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_expectations_expect_column_5d63a7843e440705390c48571baa6260"}, "created_at": 1770177079.6469078, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_column_values_to_be_between(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_expectations_expect_column_5d63a7843e440705390c48571baa6260\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_claims_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_column_values_to_be_between", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_claims_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "claim_count", "file_key_name": "models.adm_claims_metrics_long", "attached_node": "model.CGOncology_MDM.adm_claims_metrics_long", "test_metadata": {"name": "expect_column_values_to_be_between", "kwargs": {"column_name": "claim_count", "min_value": 0, "model": "{{ get_where_subquery(ref('adm_claims_metrics_long')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.not_null_adm_claims_metrics_long_patient_count.a793935234": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_claims_metrics_long_patient_count", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_claims_metrics_long_patient_count.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_claims_metrics_long_patient_count.a793935234", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_claims_metrics_long_patient_count"], "alias": "not_null_adm_claims_metrics_long_patient_count", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.648521, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_claims_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_claims_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "patient_count", "file_key_name": "models.adm_claims_metrics_long", "attached_node": "model.CGOncology_MDM.adm_claims_metrics_long", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "patient_count", "model": "{{ get_where_subquery(ref('adm_claims_metrics_long')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_be_between_adm_claims_metrics_long_patient_count__0.52b56d55e6": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_column_values_to_be_between_adm_claims_metrics_long_patient_count__0", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_column_5a154df2bc870849bb8ee850d63b5aa6.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_be_between_adm_claims_metrics_long_patient_count__0.52b56d55e6", "fqn": ["CGOncology_MDM", "adm", "dbt_expectations_expect_column_values_to_be_between_adm_claims_metrics_long_patient_count__0"], "alias": "dbt_expectations_expect_column_5a154df2bc870849bb8ee850d63b5aa6", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_column_5a154df2bc870849bb8ee850d63b5aa6", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_expectations_expect_column_5a154df2bc870849bb8ee850d63b5aa6"}, "created_at": 1770177079.649046, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_column_values_to_be_between(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_expectations_expect_column_5a154df2bc870849bb8ee850d63b5aa6\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_claims_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_column_values_to_be_between", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_claims_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "patient_count", "file_key_name": "models.adm_claims_metrics_long", "attached_node": "model.CGOncology_MDM.adm_claims_metrics_long", "test_metadata": {"name": "expect_column_values_to_be_between", "kwargs": {"column_name": "patient_count", "min_value": 0, "model": "{{ get_where_subquery(ref('adm_claims_metrics_long')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_adm_claims_metrics_long_entity_type__entity_id__metric_category__period_key.bd089e0447": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_utils_unique_combination_of_columns_adm_claims_metrics_long_entity_type__entity_id__metric_category__period_key", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_utils_unique_combination_o_830110e9e3ae0204cb6009731d0d380a.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_adm_claims_metrics_long_entity_type__entity_id__metric_category__period_key.bd089e0447", "fqn": ["CGOncology_MDM", "adm", "dbt_utils_unique_combination_of_columns_adm_claims_metrics_long_entity_type__entity_id__metric_category__period_key"], "alias": "dbt_utils_unique_combination_o_830110e9e3ae0204cb6009731d0d380a", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_utils_unique_combination_o_830110e9e3ae0204cb6009731d0d380a", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_830110e9e3ae0204cb6009731d0d380a"}, "created_at": 1770177079.650399, "relation_name": null, "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_830110e9e3ae0204cb6009731d0d380a\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_claims_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_utils.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_claims_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.adm_claims_metrics_long", "attached_node": "model.CGOncology_MDM.adm_claims_metrics_long", "test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["entity_type", "entity_id", "metric_category", "period_key"], "model": "{{ get_where_subquery(ref('adm_claims_metrics_long')) }}"}, "namespace": "dbt_utils"}}, "test.CGOncology_MDM.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_adm_claims_metrics_long_claim_count__patient_count__True.4687b44aa9": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_adm_claims_metrics_long_claim_count__patient_count__True", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_column_7e7809e994c3a7eb3d0de355bd9abb36.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_adm_claims_metrics_long_claim_count__patient_count__True.4687b44aa9", "fqn": ["CGOncology_MDM", "adm", "dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_adm_claims_metrics_long_claim_count__patient_count__True"], "alias": "dbt_expectations_expect_column_7e7809e994c3a7eb3d0de355bd9abb36", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_column_7e7809e994c3a7eb3d0de355bd9abb36", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_expectations_expect_column_7e7809e994c3a7eb3d0de355bd9abb36"}, "created_at": 1770177079.651666, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_column_pair_values_A_to_be_greater_than_B(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_expectations_expect_column_7e7809e994c3a7eb3d0de355bd9abb36\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_claims_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_column_pair_values_A_to_be_greater_than_B", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_claims_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.adm_claims_metrics_long", "attached_node": "model.CGOncology_MDM.adm_claims_metrics_long", "test_metadata": {"name": "expect_column_pair_values_A_to_be_greater_than_B", "kwargs": {"column_A": "claim_count", "column_B": "patient_count", "or_equal": true, "model": "{{ get_where_subquery(ref('adm_claims_metrics_long')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.not_null_adm_claims_metrics_by_payor_entity_type.cab3d439d4": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_claims_metrics_by_payor_entity_type", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_claims_metrics_by_payor_entity_type.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_claims_metrics_by_payor_entity_type.cab3d439d4", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_claims_metrics_by_payor_entity_type"], "alias": "not_null_adm_claims_metrics_by_payor_entity_type", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.652971, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_claims_metrics_by_payor", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_claims_metrics_by_payor"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "entity_type", "file_key_name": "models.adm_claims_metrics_by_payor", "attached_node": "model.CGOncology_MDM.adm_claims_metrics_by_payor", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "entity_type", "model": "{{ get_where_subquery(ref('adm_claims_metrics_by_payor')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_adm_claims_metrics_by_payor_entity_type__HCO__HCP.0d142bb56f": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_claims_metrics_by_payor_entity_type__HCO__HCP", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_claims_met_38051df6f3c0cdb4fce63355e96f354d.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_claims_metrics_by_payor_entity_type__HCO__HCP.0d142bb56f", "fqn": ["CGOncology_MDM", "adm", "accepted_values_adm_claims_metrics_by_payor_entity_type__HCO__HCP"], "alias": "accepted_values_adm_claims_met_38051df6f3c0cdb4fce63355e96f354d", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_adm_claims_met_38051df6f3c0cdb4fce63355e96f354d", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_adm_claims_met_38051df6f3c0cdb4fce63355e96f354d"}, "created_at": 1770177079.653485, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_adm_claims_met_38051df6f3c0cdb4fce63355e96f354d\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_claims_metrics_by_payor", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_claims_metrics_by_payor"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "entity_type", "file_key_name": "models.adm_claims_metrics_by_payor", "attached_node": "model.CGOncology_MDM.adm_claims_metrics_by_payor", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "entity_type", "values": ["HCO", "HCP"], "model": "{{ get_where_subquery(ref('adm_claims_metrics_by_payor')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_claims_metrics_by_payor_entity_id.da949df3be": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_claims_metrics_by_payor_entity_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_claims_metrics_by_payor_entity_id.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_claims_metrics_by_payor_entity_id.da949df3be", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_claims_metrics_by_payor_entity_id"], "alias": "not_null_adm_claims_metrics_by_payor_entity_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.6550221, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_claims_metrics_by_payor", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_claims_metrics_by_payor"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "entity_id", "file_key_name": "models.adm_claims_metrics_by_payor", "attached_node": "model.CGOncology_MDM.adm_claims_metrics_by_payor", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "entity_id", "model": "{{ get_where_subquery(ref('adm_claims_metrics_by_payor')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_claims_metrics_by_payor_metric_category.4d935aea00": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_claims_metrics_by_payor_metric_category", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_claims_metrics_by_payor_metric_category.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_claims_metrics_by_payor_metric_category.4d935aea00", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_claims_metrics_by_payor_metric_category"], "alias": "not_null_adm_claims_metrics_by_payor_metric_category", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.6555278, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_claims_metrics_by_payor", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_claims_metrics_by_payor"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "metric_category", "file_key_name": "models.adm_claims_metrics_by_payor", "attached_node": "model.CGOncology_MDM.adm_claims_metrics_by_payor", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "metric_category", "model": "{{ get_where_subquery(ref('adm_claims_metrics_by_payor')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_claims_metrics_by_payor_payor_type.0155c9899e": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_claims_metrics_by_payor_payor_type", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_claims_metrics_by_payor_payor_type.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_claims_metrics_by_payor_payor_type.0155c9899e", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_claims_metrics_by_payor_payor_type"], "alias": "not_null_adm_claims_metrics_by_payor_payor_type", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.656505, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_claims_metrics_by_payor", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_claims_metrics_by_payor"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "payor_type", "file_key_name": "models.adm_claims_metrics_by_payor", "attached_node": "model.CGOncology_MDM.adm_claims_metrics_by_payor", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "payor_type", "model": "{{ get_where_subquery(ref('adm_claims_metrics_by_payor')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_adm_claims_metrics_by_payor_payor_type__COMMERCIAL__MEDICARE__MEDICAID__MEDICARE_ADVANTAGE__OTHER__ALL.6c39bb89fc": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_claims_metrics_by_payor_payor_type__COMMERCIAL__MEDICARE__MEDICAID__MEDICARE_ADVANTAGE__OTHER__ALL", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_claims_met_732dade53348350180527d45fdb375e0.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_claims_metrics_by_payor_payor_type__COMMERCIAL__MEDICARE__MEDICAID__MEDICARE_ADVANTAGE__OTHER__ALL.6c39bb89fc", "fqn": ["CGOncology_MDM", "adm", "accepted_values_adm_claims_metrics_by_payor_payor_type__COMMERCIAL__MEDICARE__MEDICAID__MEDICARE_ADVANTAGE__OTHER__ALL"], "alias": "accepted_values_adm_claims_met_732dade53348350180527d45fdb375e0", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_adm_claims_met_732dade53348350180527d45fdb375e0", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_adm_claims_met_732dade53348350180527d45fdb375e0"}, "created_at": 1770177079.657185, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_adm_claims_met_732dade53348350180527d45fdb375e0\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_claims_metrics_by_payor", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_claims_metrics_by_payor"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "payor_type", "file_key_name": "models.adm_claims_metrics_by_payor", "attached_node": "model.CGOncology_MDM.adm_claims_metrics_by_payor", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "payor_type", "values": ["COMMERCIAL", "MEDICARE", "MEDICAID", "MEDICARE_ADVANTAGE", "OTHER", "ALL"], "model": "{{ get_where_subquery(ref('adm_claims_metrics_by_payor')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_hco_claims_wide_kmk_hco_id.c341d38d95": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_hco_claims_wide_kmk_hco_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_hco_claims_wide_kmk_hco_id.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_hco_claims_wide_kmk_hco_id.c341d38d95", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_hco_claims_wide_kmk_hco_id"], "alias": "not_null_adm_hco_claims_wide_kmk_hco_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.6588612, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hco_claims_wide", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_hco_claims_wide"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hco_id", "file_key_name": "models.adm_hco_claims_wide", "attached_node": "model.CGOncology_MDM.adm_hco_claims_wide", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "kmk_hco_id", "model": "{{ get_where_subquery(ref('adm_hco_claims_wide')) }}"}, "namespace": null}}, "test.CGOncology_MDM.relationships_adm_hco_claims_wide_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.6f179ab665": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "relationships_adm_hco_claims_wide_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "relationships_adm_hco_claims_w_94b0d78db2c3dfebbc18be0c2cf3d914.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.relationships_adm_hco_claims_wide_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.6f179ab665", "fqn": ["CGOncology_MDM", "adm", "relationships_adm_hco_claims_wide_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_"], "alias": "relationships_adm_hco_claims_w_94b0d78db2c3dfebbc18be0c2cf3d914", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "relationships_adm_hco_claims_w_94b0d78db2c3dfebbc18be0c2cf3d914", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "relationships_adm_hco_claims_w_94b0d78db2c3dfebbc18be0c2cf3d914"}, "created_at": 1770177079.6593978, "relation_name": null, "raw_code": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_adm_hco_claims_w_94b0d78db2c3dfebbc18be0c2cf3d914\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hco", "package": null, "version": null}, {"name": "adm_hco_claims_wide", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.adm_hco_claims_wide"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hco_id", "file_key_name": "models.adm_hco_claims_wide", "attached_node": "model.CGOncology_MDM.adm_hco_claims_wide", "test_metadata": {"name": "relationships", "kwargs": {"to": "ref('mdm_customer_master_hco')", "field": "kmk_hco_id", "column_name": "kmk_hco_id", "model": "{{ get_where_subquery(ref('adm_hco_claims_wide')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_hco_claims_wide_metric_category.0ee4d97e6c": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_hco_claims_wide_metric_category", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_hco_claims_wide_metric_category.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_hco_claims_wide_metric_category.0ee4d97e6c", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_hco_claims_wide_metric_category"], "alias": "not_null_adm_hco_claims_wide_metric_category", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.661066, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hco_claims_wide", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_hco_claims_wide"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "metric_category", "file_key_name": "models.adm_hco_claims_wide", "attached_node": "model.CGOncology_MDM.adm_hco_claims_wide", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "metric_category", "model": "{{ get_where_subquery(ref('adm_hco_claims_wide')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_adm_hco_claims_wide_kmk_hco_id__metric_category.6de5f75027": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_utils_unique_combination_of_columns_adm_hco_claims_wide_kmk_hco_id__metric_category", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_utils_unique_combination_o_df96e6f763c843e2b59f5a84923250fc.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_adm_hco_claims_wide_kmk_hco_id__metric_category.6de5f75027", "fqn": ["CGOncology_MDM", "adm", "dbt_utils_unique_combination_of_columns_adm_hco_claims_wide_kmk_hco_id__metric_category"], "alias": "dbt_utils_unique_combination_o_df96e6f763c843e2b59f5a84923250fc", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_utils_unique_combination_o_df96e6f763c843e2b59f5a84923250fc", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_df96e6f763c843e2b59f5a84923250fc"}, "created_at": 1770177079.66158, "relation_name": null, "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_df96e6f763c843e2b59f5a84923250fc\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hco_claims_wide", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_utils.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_hco_claims_wide"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.adm_hco_claims_wide", "attached_node": "model.CGOncology_MDM.adm_hco_claims_wide", "test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["kmk_hco_id", "metric_category"], "model": "{{ get_where_subquery(ref('adm_hco_claims_wide')) }}"}, "namespace": "dbt_utils"}}, "test.CGOncology_MDM.not_null_adm_hcp_claims_wide_kmk_hcp_id.8632196ef4": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_hcp_claims_wide_kmk_hcp_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_hcp_claims_wide_kmk_hcp_id.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_hcp_claims_wide_kmk_hcp_id.8632196ef4", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_hcp_claims_wide_kmk_hcp_id"], "alias": "not_null_adm_hcp_claims_wide_kmk_hcp_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.663274, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hcp_claims_wide", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_hcp_claims_wide"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hcp_id", "file_key_name": "models.adm_hcp_claims_wide", "attached_node": "model.CGOncology_MDM.adm_hcp_claims_wide", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "kmk_hcp_id", "model": "{{ get_where_subquery(ref('adm_hcp_claims_wide')) }}"}, "namespace": null}}, "test.CGOncology_MDM.relationships_adm_hcp_claims_wide_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_.a271032517": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "relationships_adm_hcp_claims_wide_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "relationships_adm_hcp_claims_w_ebc1d6161632cf41021e3890e31b3d30.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.relationships_adm_hcp_claims_wide_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_.a271032517", "fqn": ["CGOncology_MDM", "adm", "relationships_adm_hcp_claims_wide_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_"], "alias": "relationships_adm_hcp_claims_w_ebc1d6161632cf41021e3890e31b3d30", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "relationships_adm_hcp_claims_w_ebc1d6161632cf41021e3890e31b3d30", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "relationships_adm_hcp_claims_w_ebc1d6161632cf41021e3890e31b3d30"}, "created_at": 1770177079.6637928, "relation_name": null, "raw_code": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_adm_hcp_claims_w_ebc1d6161632cf41021e3890e31b3d30\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hcp", "package": null, "version": null}, {"name": "adm_hcp_claims_wide", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hcp", "model.CGOncology_MDM.adm_hcp_claims_wide"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hcp_id", "file_key_name": "models.adm_hcp_claims_wide", "attached_node": "model.CGOncology_MDM.adm_hcp_claims_wide", "test_metadata": {"name": "relationships", "kwargs": {"to": "ref('mdm_customer_master_hcp')", "field": "kmk_hcp_id", "column_name": "kmk_hcp_id", "model": "{{ get_where_subquery(ref('adm_hcp_claims_wide')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_hcp_claims_wide_metric_category.2721711915": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_hcp_claims_wide_metric_category", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_hcp_claims_wide_metric_category.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_hcp_claims_wide_metric_category.2721711915", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_hcp_claims_wide_metric_category"], "alias": "not_null_adm_hcp_claims_wide_metric_category", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.665278, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hcp_claims_wide", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_hcp_claims_wide"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "metric_category", "file_key_name": "models.adm_hcp_claims_wide", "attached_node": "model.CGOncology_MDM.adm_hcp_claims_wide", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "metric_category", "model": "{{ get_where_subquery(ref('adm_hcp_claims_wide')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_adm_hcp_claims_wide_kmk_hcp_id__metric_category.f671822c9f": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_utils_unique_combination_of_columns_adm_hcp_claims_wide_kmk_hcp_id__metric_category", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_utils_unique_combination_o_217328c5830a8934e9a5609db8e2d972.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_adm_hcp_claims_wide_kmk_hcp_id__metric_category.f671822c9f", "fqn": ["CGOncology_MDM", "adm", "dbt_utils_unique_combination_of_columns_adm_hcp_claims_wide_kmk_hcp_id__metric_category"], "alias": "dbt_utils_unique_combination_o_217328c5830a8934e9a5609db8e2d972", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_utils_unique_combination_o_217328c5830a8934e9a5609db8e2d972", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_217328c5830a8934e9a5609db8e2d972"}, "created_at": 1770177079.6657972, "relation_name": null, "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_217328c5830a8934e9a5609db8e2d972\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hcp_claims_wide", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_utils.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_hcp_claims_wide"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.adm_hcp_claims_wide", "attached_node": "model.CGOncology_MDM.adm_hcp_claims_wide", "test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["kmk_hcp_id", "metric_category"], "model": "{{ get_where_subquery(ref('adm_hcp_claims_wide')) }}"}, "namespace": "dbt_utils"}}, "test.CGOncology_MDM.not_null_adm_nmibc_risk_patient_id.fab493a5d5": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_nmibc_risk_patient_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_nmibc_risk_patient_id.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_nmibc_risk_patient_id.fab493a5d5", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_nmibc_risk_patient_id"], "alias": "not_null_adm_nmibc_risk_patient_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.667087, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_nmibc_risk", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_nmibc_risk"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "patient_id", "file_key_name": "models.adm_nmibc_risk", "attached_node": "model.CGOncology_MDM.adm_nmibc_risk", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "patient_id", "model": "{{ get_where_subquery(ref('adm_nmibc_risk')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_adm_nmibc_risk_patient_id.0f914ec428": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_adm_nmibc_risk_patient_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_adm_nmibc_risk_patient_id.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.unique_adm_nmibc_risk_patient_id.0f914ec428", "fqn": ["CGOncology_MDM", "adm", "unique_adm_nmibc_risk_patient_id"], "alias": "unique_adm_nmibc_risk_patient_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.667593, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_nmibc_risk", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.CGOncology_MDM.adm_nmibc_risk"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "patient_id", "file_key_name": "models.adm_nmibc_risk", "attached_node": "model.CGOncology_MDM.adm_nmibc_risk", "test_metadata": {"name": "unique", "kwargs": {"column_name": "patient_id", "model": "{{ get_where_subquery(ref('adm_nmibc_risk')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_nmibc_risk_nmibc_risk_tier.d7a1407372": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_nmibc_risk_nmibc_risk_tier", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_nmibc_risk_nmibc_risk_tier.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_nmibc_risk_nmibc_risk_tier.d7a1407372", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_nmibc_risk_nmibc_risk_tier"], "alias": "not_null_adm_nmibc_risk_nmibc_risk_tier", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.668088, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_nmibc_risk", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_nmibc_risk"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "nmibc_risk_tier", "file_key_name": "models.adm_nmibc_risk", "attached_node": "model.CGOncology_MDM.adm_nmibc_risk", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "nmibc_risk_tier", "model": "{{ get_where_subquery(ref('adm_nmibc_risk')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_adm_nmibc_risk_nmibc_risk_tier__HIGH__INTERMEDIATE__LOW.ea5c66bfb9": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_nmibc_risk_nmibc_risk_tier__HIGH__INTERMEDIATE__LOW", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_nmibc_risk_77043f1ddf50a4578f110f7754e3f8a3.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_nmibc_risk_nmibc_risk_tier__HIGH__INTERMEDIATE__LOW.ea5c66bfb9", "fqn": ["CGOncology_MDM", "adm", "accepted_values_adm_nmibc_risk_nmibc_risk_tier__HIGH__INTERMEDIATE__LOW"], "alias": "accepted_values_adm_nmibc_risk_77043f1ddf50a4578f110f7754e3f8a3", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_adm_nmibc_risk_77043f1ddf50a4578f110f7754e3f8a3", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_adm_nmibc_risk_77043f1ddf50a4578f110f7754e3f8a3"}, "created_at": 1770177079.668589, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_adm_nmibc_risk_77043f1ddf50a4578f110f7754e3f8a3\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_nmibc_risk", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_nmibc_risk"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "nmibc_risk_tier", "file_key_name": "models.adm_nmibc_risk", "attached_node": "model.CGOncology_MDM.adm_nmibc_risk", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "nmibc_risk_tier", "values": ["HIGH", "INTERMEDIATE", "LOW"], "model": "{{ get_where_subquery(ref('adm_nmibc_risk')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_hco_nmibc_metrics_kmk_hco_id.879ce27570": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_hco_nmibc_metrics_kmk_hco_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_hco_nmibc_metrics_kmk_hco_id.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_hco_nmibc_metrics_kmk_hco_id.879ce27570", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_hco_nmibc_metrics_kmk_hco_id"], "alias": "not_null_adm_hco_nmibc_metrics_kmk_hco_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.670768, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hco_nmibc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_hco_nmibc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hco_id", "file_key_name": "models.adm_hco_nmibc_metrics", "attached_node": "model.CGOncology_MDM.adm_hco_nmibc_metrics", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "kmk_hco_id", "model": "{{ get_where_subquery(ref('adm_hco_nmibc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_adm_hco_nmibc_metrics_kmk_hco_id.d9d7542acd": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_adm_hco_nmibc_metrics_kmk_hco_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_adm_hco_nmibc_metrics_kmk_hco_id.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.unique_adm_hco_nmibc_metrics_kmk_hco_id.d9d7542acd", "fqn": ["CGOncology_MDM", "adm", "unique_adm_hco_nmibc_metrics_kmk_hco_id"], "alias": "unique_adm_hco_nmibc_metrics_kmk_hco_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.6714509, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hco_nmibc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.CGOncology_MDM.adm_hco_nmibc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hco_id", "file_key_name": "models.adm_hco_nmibc_metrics", "attached_node": "model.CGOncology_MDM.adm_hco_nmibc_metrics", "test_metadata": {"name": "unique", "kwargs": {"column_name": "kmk_hco_id", "model": "{{ get_where_subquery(ref('adm_hco_nmibc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.relationships_adm_hco_nmibc_metrics_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.9077e1ad59": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "relationships_adm_hco_nmibc_metrics_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "relationships_adm_hco_nmibc_me_b081b20fbbf6ced82abe845e4e21b15f.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.relationships_adm_hco_nmibc_metrics_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.9077e1ad59", "fqn": ["CGOncology_MDM", "adm", "relationships_adm_hco_nmibc_metrics_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_"], "alias": "relationships_adm_hco_nmibc_me_b081b20fbbf6ced82abe845e4e21b15f", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "relationships_adm_hco_nmibc_me_b081b20fbbf6ced82abe845e4e21b15f", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "relationships_adm_hco_nmibc_me_b081b20fbbf6ced82abe845e4e21b15f"}, "created_at": 1770177079.671999, "relation_name": null, "raw_code": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_adm_hco_nmibc_me_b081b20fbbf6ced82abe845e4e21b15f\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hco", "package": null, "version": null}, {"name": "adm_hco_nmibc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.adm_hco_nmibc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hco_id", "file_key_name": "models.adm_hco_nmibc_metrics", "attached_node": "model.CGOncology_MDM.adm_hco_nmibc_metrics", "test_metadata": {"name": "relationships", "kwargs": {"to": "ref('mdm_customer_master_hco')", "field": "kmk_hco_id", "column_name": "kmk_hco_id", "model": "{{ get_where_subquery(ref('adm_hco_nmibc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_hco_nmibc_metrics_total_nmibc_patients.a38658c0ce": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_hco_nmibc_metrics_total_nmibc_patients", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_hco_nmibc_metrics_total_nmibc_patients.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_hco_nmibc_metrics_total_nmibc_patients.a38658c0ce", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_hco_nmibc_metrics_total_nmibc_patients"], "alias": "not_null_adm_hco_nmibc_metrics_total_nmibc_patients", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.673718, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hco_nmibc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_hco_nmibc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "total_nmibc_patients", "file_key_name": "models.adm_hco_nmibc_metrics", "attached_node": "model.CGOncology_MDM.adm_hco_nmibc_metrics", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "total_nmibc_patients", "model": "{{ get_where_subquery(ref('adm_hco_nmibc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_hco_nmibc_metrics_high_risk_nmibc_patients.05ab66c196": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_hco_nmibc_metrics_high_risk_nmibc_patients", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_hco_nmibc_metrics_high_risk_nmibc_patients.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_hco_nmibc_metrics_high_risk_nmibc_patients.05ab66c196", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_hco_nmibc_metrics_high_risk_nmibc_patients"], "alias": "not_null_adm_hco_nmibc_metrics_high_risk_nmibc_patients", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.67422, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hco_nmibc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_hco_nmibc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "high_risk_nmibc_patients", "file_key_name": "models.adm_hco_nmibc_metrics", "attached_node": "model.CGOncology_MDM.adm_hco_nmibc_metrics", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "high_risk_nmibc_patients", "model": "{{ get_where_subquery(ref('adm_hco_nmibc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_hco_nmibc_metrics_mid_risk_nmibc_patients.fa614f1d00": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_hco_nmibc_metrics_mid_risk_nmibc_patients", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_hco_nmibc_metrics_mid_risk_nmibc_patients.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_hco_nmibc_metrics_mid_risk_nmibc_patients.fa614f1d00", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_hco_nmibc_metrics_mid_risk_nmibc_patients"], "alias": "not_null_adm_hco_nmibc_metrics_mid_risk_nmibc_patients", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.67471, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hco_nmibc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_hco_nmibc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "mid_risk_nmibc_patients", "file_key_name": "models.adm_hco_nmibc_metrics", "attached_node": "model.CGOncology_MDM.adm_hco_nmibc_metrics", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "mid_risk_nmibc_patients", "model": "{{ get_where_subquery(ref('adm_hco_nmibc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_hco_nmibc_metrics_low_risk_nmibc_patients.3ca3bd0262": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_hco_nmibc_metrics_low_risk_nmibc_patients", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_hco_nmibc_metrics_low_risk_nmibc_patients.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_hco_nmibc_metrics_low_risk_nmibc_patients.3ca3bd0262", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_hco_nmibc_metrics_low_risk_nmibc_patients"], "alias": "not_null_adm_hco_nmibc_metrics_low_risk_nmibc_patients", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.675197, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hco_nmibc_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_hco_nmibc_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "low_risk_nmibc_patients", "file_key_name": "models.adm_hco_nmibc_metrics", "attached_node": "model.CGOncology_MDM.adm_hco_nmibc_metrics", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "low_risk_nmibc_patients", "model": "{{ get_where_subquery(ref('adm_hco_nmibc_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_ddd_metrics_grain_outlet_no.bd9c6a4fba": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_ddd_metrics_grain_outlet_no", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_ddd_metrics_grain_outlet_no.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_ddd_metrics_grain_outlet_no.bd9c6a4fba", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_ddd_metrics_grain_outlet_no"], "alias": "not_null_adm_ddd_metrics_grain_outlet_no", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.675788, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_ddd_metrics_grain", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_ddd_metrics_grain"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "outlet_no", "file_key_name": "models.adm_ddd_metrics_grain", "attached_node": "model.CGOncology_MDM.adm_ddd_metrics_grain", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "outlet_no", "model": "{{ get_where_subquery(ref('adm_ddd_metrics_grain')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_ddd_metrics_grain_product_group_id.b56b99cd4d": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_ddd_metrics_grain_product_group_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_ddd_metrics_grain_product_group_id.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_ddd_metrics_grain_product_group_id.b56b99cd4d", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_ddd_metrics_grain_product_group_id"], "alias": "not_null_adm_ddd_metrics_grain_product_group_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.676407, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_ddd_metrics_grain", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_ddd_metrics_grain"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "product_group_id", "file_key_name": "models.adm_ddd_metrics_grain", "attached_node": "model.CGOncology_MDM.adm_ddd_metrics_grain", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "product_group_id", "model": "{{ get_where_subquery(ref('adm_ddd_metrics_grain')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_adm_ddd_metrics_grain_product_group_id__1__2__3__4__7.85590311ef": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_ddd_metrics_grain_product_group_id__1__2__3__4__7", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_ddd_metric_8795bc042301e08846ffb3ebc68271c6.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_ddd_metrics_grain_product_group_id__1__2__3__4__7.85590311ef", "fqn": ["CGOncology_MDM", "adm", "accepted_values_adm_ddd_metrics_grain_product_group_id__1__2__3__4__7"], "alias": "accepted_values_adm_ddd_metric_8795bc042301e08846ffb3ebc68271c6", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_adm_ddd_metric_8795bc042301e08846ffb3ebc68271c6", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_adm_ddd_metric_8795bc042301e08846ffb3ebc68271c6"}, "created_at": 1770177079.677136, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_adm_ddd_metric_8795bc042301e08846ffb3ebc68271c6\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_ddd_metrics_grain", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_ddd_metrics_grain"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "product_group_id", "file_key_name": "models.adm_ddd_metrics_grain", "attached_node": "model.CGOncology_MDM.adm_ddd_metrics_grain", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "product_group_id", "values": ["1", "2", "3", "4", "7"], "model": "{{ get_where_subquery(ref('adm_ddd_metrics_grain')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_ddd_metrics_grain_kmk_hco_id.af8e20f7b3": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_ddd_metrics_grain_kmk_hco_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_ddd_metrics_grain_kmk_hco_id.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_ddd_metrics_grain_kmk_hco_id.af8e20f7b3", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_ddd_metrics_grain_kmk_hco_id"], "alias": "not_null_adm_ddd_metrics_grain_kmk_hco_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.678996, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_ddd_metrics_grain", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_ddd_metrics_grain"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hco_id", "file_key_name": "models.adm_ddd_metrics_grain", "attached_node": "model.CGOncology_MDM.adm_ddd_metrics_grain", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "kmk_hco_id", "model": "{{ get_where_subquery(ref('adm_ddd_metrics_grain')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_ddd_metrics_grain_sales_amount.c0f65820e3": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_ddd_metrics_grain_sales_amount", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_ddd_metrics_grain_sales_amount.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_ddd_metrics_grain_sales_amount.c0f65820e3", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_ddd_metrics_grain_sales_amount"], "alias": "not_null_adm_ddd_metrics_grain_sales_amount", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.679501, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_ddd_metrics_grain", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_ddd_metrics_grain"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "sales_amount", "file_key_name": "models.adm_ddd_metrics_grain", "attached_node": "model.CGOncology_MDM.adm_ddd_metrics_grain", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "sales_amount", "model": "{{ get_where_subquery(ref('adm_ddd_metrics_grain')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_ddd_metrics_grain_units_count.05cd92af6c": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_ddd_metrics_grain_units_count", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_ddd_metrics_grain_units_count.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_ddd_metrics_grain_units_count.05cd92af6c", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_ddd_metrics_grain_units_count"], "alias": "not_null_adm_ddd_metrics_grain_units_count", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.679997, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_ddd_metrics_grain", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_ddd_metrics_grain"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "units_count", "file_key_name": "models.adm_ddd_metrics_grain", "attached_node": "model.CGOncology_MDM.adm_ddd_metrics_grain", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "units_count", "model": "{{ get_where_subquery(ref('adm_ddd_metrics_grain')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_ddd_metrics_grain_month_num.e58f620175": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_ddd_metrics_grain_month_num", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_ddd_metrics_grain_month_num.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_ddd_metrics_grain_month_num.e58f620175", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_ddd_metrics_grain_month_num"], "alias": "not_null_adm_ddd_metrics_grain_month_num", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.68049, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_ddd_metrics_grain", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_ddd_metrics_grain"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "month_num", "file_key_name": "models.adm_ddd_metrics_grain", "attached_node": "model.CGOncology_MDM.adm_ddd_metrics_grain", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "month_num", "model": "{{ get_where_subquery(ref('adm_ddd_metrics_grain')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_be_between_adm_ddd_metrics_grain_month_num__24__1.cca6edfe9a": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_column_values_to_be_between_adm_ddd_metrics_grain_month_num__24__1", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_column_fddd7d87ddd713a0583182eef879957c.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_be_between_adm_ddd_metrics_grain_month_num__24__1.cca6edfe9a", "fqn": ["CGOncology_MDM", "adm", "dbt_expectations_expect_column_values_to_be_between_adm_ddd_metrics_grain_month_num__24__1"], "alias": "dbt_expectations_expect_column_fddd7d87ddd713a0583182eef879957c", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_column_fddd7d87ddd713a0583182eef879957c", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_expectations_expect_column_fddd7d87ddd713a0583182eef879957c"}, "created_at": 1770177079.680994, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_column_values_to_be_between(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_expectations_expect_column_fddd7d87ddd713a0583182eef879957c\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_ddd_metrics_grain", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_column_values_to_be_between", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_ddd_metrics_grain"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "month_num", "file_key_name": "models.adm_ddd_metrics_grain", "attached_node": "model.CGOncology_MDM.adm_ddd_metrics_grain", "test_metadata": {"name": "expect_column_values_to_be_between", "kwargs": {"column_name": "month_num", "min_value": 1, "max_value": 24, "model": "{{ get_where_subquery(ref('adm_ddd_metrics_grain')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.dbt_expectations_expect_table_row_count_to_be_between_adm_ddd_metrics_grain_50000.0acb967837": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_table_row_count_to_be_between_adm_ddd_metrics_grain_50000", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_table__1b30c05f5aa2a2af725448aded9cb4b2.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_table_row_count_to_be_between_adm_ddd_metrics_grain_50000.0acb967837", "fqn": ["CGOncology_MDM", "adm", "dbt_expectations_expect_table_row_count_to_be_between_adm_ddd_metrics_grain_50000"], "alias": "dbt_expectations_expect_table__1b30c05f5aa2a2af725448aded9cb4b2", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_table__1b30c05f5aa2a2af725448aded9cb4b2", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_expectations_expect_table__1b30c05f5aa2a2af725448aded9cb4b2"}, "created_at": 1770177079.682438, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_table_row_count_to_be_between(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_expectations_expect_table__1b30c05f5aa2a2af725448aded9cb4b2\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_ddd_metrics_grain", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_table_row_count_to_be_between", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_ddd_metrics_grain"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.adm_ddd_metrics_grain", "attached_node": "model.CGOncology_MDM.adm_ddd_metrics_grain", "test_metadata": {"name": "expect_table_row_count_to_be_between", "kwargs": {"min_value": 50000, "model": "{{ get_where_subquery(ref('adm_ddd_metrics_grain')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.not_null_adm_ddd_metrics_wide_kmk_hco_id.eb1befe131": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_ddd_metrics_wide_kmk_hco_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_ddd_metrics_wide_kmk_hco_id.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_ddd_metrics_wide_kmk_hco_id.eb1befe131", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_ddd_metrics_wide_kmk_hco_id"], "alias": "not_null_adm_ddd_metrics_wide_kmk_hco_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.6838112, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_ddd_metrics_wide", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_ddd_metrics_wide"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hco_id", "file_key_name": "models.adm_ddd_metrics_wide", "attached_node": "model.CGOncology_MDM.adm_ddd_metrics_wide", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "kmk_hco_id", "model": "{{ get_where_subquery(ref('adm_ddd_metrics_wide')) }}"}, "namespace": null}}, "test.CGOncology_MDM.relationships_adm_ddd_metrics_wide_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.7717014ac4": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "relationships_adm_ddd_metrics_wide_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "relationships_adm_ddd_metrics__12ea2103363adb4588ff1c19bde03ebe.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.relationships_adm_ddd_metrics_wide_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.7717014ac4", "fqn": ["CGOncology_MDM", "adm", "relationships_adm_ddd_metrics_wide_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_"], "alias": "relationships_adm_ddd_metrics__12ea2103363adb4588ff1c19bde03ebe", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "relationships_adm_ddd_metrics__12ea2103363adb4588ff1c19bde03ebe", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "relationships_adm_ddd_metrics__12ea2103363adb4588ff1c19bde03ebe"}, "created_at": 1770177079.684326, "relation_name": null, "raw_code": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_adm_ddd_metrics__12ea2103363adb4588ff1c19bde03ebe\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hco", "package": null, "version": null}, {"name": "adm_ddd_metrics_wide", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.adm_ddd_metrics_wide"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hco_id", "file_key_name": "models.adm_ddd_metrics_wide", "attached_node": "model.CGOncology_MDM.adm_ddd_metrics_wide", "test_metadata": {"name": "relationships", "kwargs": {"to": "ref('mdm_customer_master_hco')", "field": "kmk_hco_id", "column_name": "kmk_hco_id", "model": "{{ get_where_subquery(ref('adm_ddd_metrics_wide')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_ddd_metrics_wide_metric_category.5264fc27ec": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_ddd_metrics_wide_metric_category", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_ddd_metrics_wide_metric_category.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_ddd_metrics_wide_metric_category.5264fc27ec", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_ddd_metrics_wide_metric_category"], "alias": "not_null_adm_ddd_metrics_wide_metric_category", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.686035, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_ddd_metrics_wide", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_ddd_metrics_wide"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "metric_category", "file_key_name": "models.adm_ddd_metrics_wide", "attached_node": "model.CGOncology_MDM.adm_ddd_metrics_wide", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "metric_category", "model": "{{ get_where_subquery(ref('adm_ddd_metrics_wide')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_adm_ddd_metrics_wide_kmk_hco_id__metric_category.95bbc51f56": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_utils_unique_combination_of_columns_adm_ddd_metrics_wide_kmk_hco_id__metric_category", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_utils_unique_combination_o_4786ff8c2eb1691384520f965b5b3191.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_adm_ddd_metrics_wide_kmk_hco_id__metric_category.95bbc51f56", "fqn": ["CGOncology_MDM", "adm", "dbt_utils_unique_combination_of_columns_adm_ddd_metrics_wide_kmk_hco_id__metric_category"], "alias": "dbt_utils_unique_combination_o_4786ff8c2eb1691384520f965b5b3191", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_utils_unique_combination_o_4786ff8c2eb1691384520f965b5b3191", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_4786ff8c2eb1691384520f965b5b3191"}, "created_at": 1770177079.686547, "relation_name": null, "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_4786ff8c2eb1691384520f965b5b3191\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_ddd_metrics_wide", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_utils.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_ddd_metrics_wide"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.adm_ddd_metrics_wide", "attached_node": "model.CGOncology_MDM.adm_ddd_metrics_wide", "test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["kmk_hco_id", "metric_category"], "model": "{{ get_where_subquery(ref('adm_ddd_metrics_wide')) }}"}, "namespace": "dbt_utils"}}, "test.CGOncology_MDM.not_null_adm_ddd_metrics_long_entity_type.3a48119566": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_ddd_metrics_long_entity_type", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_ddd_metrics_long_entity_type.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_ddd_metrics_long_entity_type.3a48119566", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_ddd_metrics_long_entity_type"], "alias": "not_null_adm_ddd_metrics_long_entity_type", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.687815, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_ddd_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_ddd_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "entity_type", "file_key_name": "models.adm_ddd_metrics_long", "attached_node": "model.CGOncology_MDM.adm_ddd_metrics_long", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "entity_type", "model": "{{ get_where_subquery(ref('adm_ddd_metrics_long')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_adm_ddd_metrics_long_entity_type__HCO.8cdf8eb4c5": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_ddd_metrics_long_entity_type__HCO", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_ddd_metrics_long_entity_type__HCO.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_ddd_metrics_long_entity_type__HCO.8cdf8eb4c5", "fqn": ["CGOncology_MDM", "adm", "accepted_values_adm_ddd_metrics_long_entity_type__HCO"], "alias": "accepted_values_adm_ddd_metrics_long_entity_type__HCO", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.688323, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_ddd_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_ddd_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "entity_type", "file_key_name": "models.adm_ddd_metrics_long", "attached_node": "model.CGOncology_MDM.adm_ddd_metrics_long", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "entity_type", "values": ["HCO"], "model": "{{ get_where_subquery(ref('adm_ddd_metrics_long')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_ddd_metrics_long_entity_id.5d26527a34": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_ddd_metrics_long_entity_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_ddd_metrics_long_entity_id.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_ddd_metrics_long_entity_id.5d26527a34", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_ddd_metrics_long_entity_id"], "alias": "not_null_adm_ddd_metrics_long_entity_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.689488, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_ddd_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_ddd_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "entity_id", "file_key_name": "models.adm_ddd_metrics_long", "attached_node": "model.CGOncology_MDM.adm_ddd_metrics_long", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "entity_id", "model": "{{ get_where_subquery(ref('adm_ddd_metrics_long')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_ddd_metrics_long_metric_category.6ff3e16807": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_ddd_metrics_long_metric_category", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_ddd_metrics_long_metric_category.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_ddd_metrics_long_metric_category.6ff3e16807", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_ddd_metrics_long_metric_category"], "alias": "not_null_adm_ddd_metrics_long_metric_category", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.689986, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_ddd_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_ddd_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "metric_category", "file_key_name": "models.adm_ddd_metrics_long", "attached_node": "model.CGOncology_MDM.adm_ddd_metrics_long", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "metric_category", "model": "{{ get_where_subquery(ref('adm_ddd_metrics_long')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_adm_ddd_metrics_long_metric_category__TICE_BCG__ADSTILADRIN__ANKTIVA__INLEXZO__TOTAL_BRANDED__TOTAL__OTHER.84c56bf16a": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_ddd_metrics_long_metric_category__TICE_BCG__ADSTILADRIN__ANKTIVA__INLEXZO__TOTAL_BRANDED__TOTAL__OTHER", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_ddd_metric_9a2f16345bc40a2f13bddf79ae417a89.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_ddd_metrics_long_metric_category__TICE_BCG__ADSTILADRIN__ANKTIVA__INLEXZO__TOTAL_BRANDED__TOTAL__OTHER.84c56bf16a", "fqn": ["CGOncology_MDM", "adm", "accepted_values_adm_ddd_metrics_long_metric_category__TICE_BCG__ADSTILADRIN__ANKTIVA__INLEXZO__TOTAL_BRANDED__TOTAL__OTHER"], "alias": "accepted_values_adm_ddd_metric_9a2f16345bc40a2f13bddf79ae417a89", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_adm_ddd_metric_9a2f16345bc40a2f13bddf79ae417a89", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_adm_ddd_metric_9a2f16345bc40a2f13bddf79ae417a89"}, "created_at": 1770177079.6905012, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_adm_ddd_metric_9a2f16345bc40a2f13bddf79ae417a89\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_ddd_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_ddd_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "metric_category", "file_key_name": "models.adm_ddd_metrics_long", "attached_node": "model.CGOncology_MDM.adm_ddd_metrics_long", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "metric_category", "values": ["TICE_BCG", "ADSTILADRIN", "ANKTIVA", "INLEXZO", "TOTAL_BRANDED", "TOTAL", "OTHER"], "model": "{{ get_where_subquery(ref('adm_ddd_metrics_long')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_ddd_metrics_long_period_key.9bdfea608e": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_ddd_metrics_long_period_key", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_ddd_metrics_long_period_key.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_ddd_metrics_long_period_key.9bdfea608e", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_ddd_metrics_long_period_key"], "alias": "not_null_adm_ddd_metrics_long_period_key", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.6917639, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_ddd_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_ddd_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "period_key", "file_key_name": "models.adm_ddd_metrics_long", "attached_node": "model.CGOncology_MDM.adm_ddd_metrics_long", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "period_key", "model": "{{ get_where_subquery(ref('adm_ddd_metrics_long')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_ddd_metrics_long_period_type.1b0e3c4c83": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_ddd_metrics_long_period_type", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_ddd_metrics_long_period_type.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_ddd_metrics_long_period_type.1b0e3c4c83", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_ddd_metrics_long_period_type"], "alias": "not_null_adm_ddd_metrics_long_period_type", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.692555, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_ddd_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_ddd_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "period_type", "file_key_name": "models.adm_ddd_metrics_long", "attached_node": "model.CGOncology_MDM.adm_ddd_metrics_long", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "period_type", "model": "{{ get_where_subquery(ref('adm_ddd_metrics_long')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_adm_ddd_metrics_long_period_type__MONTHLY__QUARTERLY__ROLLING__YTD__QTD__PY__PYTD__P2Y__CALENDAR_YEAR__LTD__TOTAL.60fff9a04a": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_ddd_metrics_long_period_type__MONTHLY__QUARTERLY__ROLLING__YTD__QTD__PY__PYTD__P2Y__CALENDAR_YEAR__LTD__TOTAL", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_ddd_metric_8ba4d54200042fce30541cd7394edf8f.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_ddd_metrics_long_period_type__MONTHLY__QUARTERLY__ROLLING__YTD__QTD__PY__PYTD__P2Y__CALENDAR_YEAR__LTD__TOTAL.60fff9a04a", "fqn": ["CGOncology_MDM", "adm", "accepted_values_adm_ddd_metrics_long_period_type__MONTHLY__QUARTERLY__ROLLING__YTD__QTD__PY__PYTD__P2Y__CALENDAR_YEAR__LTD__TOTAL"], "alias": "accepted_values_adm_ddd_metric_8ba4d54200042fce30541cd7394edf8f", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_adm_ddd_metric_8ba4d54200042fce30541cd7394edf8f", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_adm_ddd_metric_8ba4d54200042fce30541cd7394edf8f"}, "created_at": 1770177079.693078, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_adm_ddd_metric_8ba4d54200042fce30541cd7394edf8f\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_ddd_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_ddd_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "period_type", "file_key_name": "models.adm_ddd_metrics_long", "attached_node": "model.CGOncology_MDM.adm_ddd_metrics_long", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "period_type", "values": ["MONTHLY", "QUARTERLY", "ROLLING", "YTD", "QTD", "PY", "PYTD", "P2Y", "CALENDAR_YEAR", "LTD", "TOTAL"], "model": "{{ get_where_subquery(ref('adm_ddd_metrics_long')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_ddd_metrics_long_data_date.350c355f44": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_ddd_metrics_long_data_date", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_ddd_metrics_long_data_date.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_ddd_metrics_long_data_date.350c355f44", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_ddd_metrics_long_data_date"], "alias": "not_null_adm_ddd_metrics_long_data_date", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.6943529, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_ddd_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_ddd_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "data_date", "file_key_name": "models.adm_ddd_metrics_long", "attached_node": "model.CGOncology_MDM.adm_ddd_metrics_long", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "data_date", "model": "{{ get_where_subquery(ref('adm_ddd_metrics_long')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_expectations_expect_table_row_count_to_be_between_adm_ddd_metrics_long_100000.0fbaec9138": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_expectations_expect_table_row_count_to_be_between_adm_ddd_metrics_long_100000", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_expectations_expect_table__6d45ded4bcfb742b6ce8b8a8da0fe0c6.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_expectations_expect_table_row_count_to_be_between_adm_ddd_metrics_long_100000.0fbaec9138", "fqn": ["CGOncology_MDM", "adm", "dbt_expectations_expect_table_row_count_to_be_between_adm_ddd_metrics_long_100000"], "alias": "dbt_expectations_expect_table__6d45ded4bcfb742b6ce8b8a8da0fe0c6", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_expectations_expect_table__6d45ded4bcfb742b6ce8b8a8da0fe0c6", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_expectations_expect_table__6d45ded4bcfb742b6ce8b8a8da0fe0c6"}, "created_at": 1770177079.69486, "relation_name": null, "raw_code": "{{ dbt_expectations.test_expect_table_row_count_to_be_between(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_expectations_expect_table__6d45ded4bcfb742b6ce8b8a8da0fe0c6\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_ddd_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_expectations.test_expect_table_row_count_to_be_between", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_ddd_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.adm_ddd_metrics_long", "attached_node": "model.CGOncology_MDM.adm_ddd_metrics_long", "test_metadata": {"name": "expect_table_row_count_to_be_between", "kwargs": {"min_value": 100000, "model": "{{ get_where_subquery(ref('adm_ddd_metrics_long')) }}"}, "namespace": "dbt_expectations"}}, "test.CGOncology_MDM.not_null_adm_lowest_level_metrics_kmk_hco_id.55b4f59cf8": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_lowest_level_metrics_kmk_hco_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_lowest_level_metrics_kmk_hco_id.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_lowest_level_metrics_kmk_hco_id.55b4f59cf8", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_lowest_level_metrics_kmk_hco_id"], "alias": "not_null_adm_lowest_level_metrics_kmk_hco_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.696432, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_lowest_level_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_lowest_level_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hco_id", "file_key_name": "models.adm_lowest_level_metrics", "attached_node": "model.CGOncology_MDM.adm_lowest_level_metrics", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "kmk_hco_id", "model": "{{ get_where_subquery(ref('adm_lowest_level_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.relationships_adm_lowest_level_metrics_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.a9076ad74b": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "relationships_adm_lowest_level_metrics_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "relationships_adm_lowest_level_ec39135bd5a66c67ef90c4abfe1429ea.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.relationships_adm_lowest_level_metrics_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.a9076ad74b", "fqn": ["CGOncology_MDM", "adm", "relationships_adm_lowest_level_metrics_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_"], "alias": "relationships_adm_lowest_level_ec39135bd5a66c67ef90c4abfe1429ea", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "relationships_adm_lowest_level_ec39135bd5a66c67ef90c4abfe1429ea", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "relationships_adm_lowest_level_ec39135bd5a66c67ef90c4abfe1429ea"}, "created_at": 1770177079.69699, "relation_name": null, "raw_code": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_adm_lowest_level_ec39135bd5a66c67ef90c4abfe1429ea\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hco", "package": null, "version": null}, {"name": "adm_lowest_level_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.adm_lowest_level_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hco_id", "file_key_name": "models.adm_lowest_level_metrics", "attached_node": "model.CGOncology_MDM.adm_lowest_level_metrics", "test_metadata": {"name": "relationships", "kwargs": {"to": "ref('mdm_customer_master_hco')", "field": "kmk_hco_id", "column_name": "kmk_hco_id", "model": "{{ get_where_subquery(ref('adm_lowest_level_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_lowest_level_metrics_metric_category.70e347ae8a": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_lowest_level_metrics_metric_category", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_lowest_level_metrics_metric_category.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_lowest_level_metrics_metric_category.70e347ae8a", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_lowest_level_metrics_metric_category"], "alias": "not_null_adm_lowest_level_metrics_metric_category", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.6987169, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_lowest_level_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_lowest_level_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "metric_category", "file_key_name": "models.adm_lowest_level_metrics", "attached_node": "model.CGOncology_MDM.adm_lowest_level_metrics", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "metric_category", "model": "{{ get_where_subquery(ref('adm_lowest_level_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_lowest_level_metrics_metric_code.b05b2de93c": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_lowest_level_metrics_metric_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_lowest_level_metrics_metric_code.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_lowest_level_metrics_metric_code.b05b2de93c", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_lowest_level_metrics_metric_code"], "alias": "not_null_adm_lowest_level_metrics_metric_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.699573, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_lowest_level_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_lowest_level_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "metric_code", "file_key_name": "models.adm_lowest_level_metrics", "attached_node": "model.CGOncology_MDM.adm_lowest_level_metrics", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "metric_code", "model": "{{ get_where_subquery(ref('adm_lowest_level_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_lowest_level_metrics_period_key.580102b640": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_lowest_level_metrics_period_key", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_lowest_level_metrics_period_key.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_lowest_level_metrics_period_key.580102b640", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_lowest_level_metrics_period_key"], "alias": "not_null_adm_lowest_level_metrics_period_key", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.7000918, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_lowest_level_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_lowest_level_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "period_key", "file_key_name": "models.adm_lowest_level_metrics", "attached_node": "model.CGOncology_MDM.adm_lowest_level_metrics", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "period_key", "model": "{{ get_where_subquery(ref('adm_lowest_level_metrics')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_adm_lowest_level_metrics_kmk_hco_id__metric_category__metric_code__period_key.98b6841877": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_utils_unique_combination_of_columns_adm_lowest_level_metrics_kmk_hco_id__metric_category__metric_code__period_key", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_utils_unique_combination_o_dd48195e93bcafca98db7060b17299f3.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_adm_lowest_level_metrics_kmk_hco_id__metric_category__metric_code__period_key.98b6841877", "fqn": ["CGOncology_MDM", "adm", "dbt_utils_unique_combination_of_columns_adm_lowest_level_metrics_kmk_hco_id__metric_category__metric_code__period_key"], "alias": "dbt_utils_unique_combination_o_dd48195e93bcafca98db7060b17299f3", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "dbt_utils_unique_combination_o_dd48195e93bcafca98db7060b17299f3", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_dd48195e93bcafca98db7060b17299f3"}, "created_at": 1770177079.700619, "relation_name": null, "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_dd48195e93bcafca98db7060b17299f3\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_lowest_level_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_utils.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_lowest_level_metrics"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.adm_lowest_level_metrics", "attached_node": "model.CGOncology_MDM.adm_lowest_level_metrics", "test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["kmk_hco_id", "metric_category", "metric_code", "period_key"], "model": "{{ get_where_subquery(ref('adm_lowest_level_metrics')) }}"}, "namespace": "dbt_utils"}}, "test.CGOncology_MDM.not_null_ref_address_best_hco_kmk_hco_id.f5e718f933": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_ref_address_best_hco_kmk_hco_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_ref_address_best_hco_kmk_hco_id.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_ref_address_best_hco_kmk_hco_id.f5e718f933", "fqn": ["CGOncology_MDM", "adm", "not_null_ref_address_best_hco_kmk_hco_id"], "alias": "not_null_ref_address_best_hco_kmk_hco_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.7020118, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "ref_address_best_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.ref_address_best_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hco_id", "file_key_name": "models.ref_address_best_hco", "attached_node": "model.CGOncology_MDM.ref_address_best_hco", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "kmk_hco_id", "model": "{{ get_where_subquery(ref('ref_address_best_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_ref_address_best_hco_kmk_hco_id.a384281d43": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_ref_address_best_hco_kmk_hco_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_ref_address_best_hco_kmk_hco_id.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.unique_ref_address_best_hco_kmk_hco_id.a384281d43", "fqn": ["CGOncology_MDM", "adm", "unique_ref_address_best_hco_kmk_hco_id"], "alias": "unique_ref_address_best_hco_kmk_hco_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.702511, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "ref_address_best_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.CGOncology_MDM.ref_address_best_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hco_id", "file_key_name": "models.ref_address_best_hco", "attached_node": "model.CGOncology_MDM.ref_address_best_hco", "test_metadata": {"name": "unique", "kwargs": {"column_name": "kmk_hco_id", "model": "{{ get_where_subquery(ref('ref_address_best_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.relationships_ref_address_best_hco_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.0936f794de": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "relationships_ref_address_best_hco_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "relationships_ref_address_best_53375b13accc0ffc152db12c70cbe4e8.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.relationships_ref_address_best_hco_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.0936f794de", "fqn": ["CGOncology_MDM", "adm", "relationships_ref_address_best_hco_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_"], "alias": "relationships_ref_address_best_53375b13accc0ffc152db12c70cbe4e8", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "relationships_ref_address_best_53375b13accc0ffc152db12c70cbe4e8", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "relationships_ref_address_best_53375b13accc0ffc152db12c70cbe4e8"}, "created_at": 1770177079.70302, "relation_name": null, "raw_code": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_ref_address_best_53375b13accc0ffc152db12c70cbe4e8\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "mdm_customer_master_hco", "package": null, "version": null}, {"name": "ref_address_best_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.ref_address_best_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hco_id", "file_key_name": "models.ref_address_best_hco", "attached_node": "model.CGOncology_MDM.ref_address_best_hco", "test_metadata": {"name": "relationships", "kwargs": {"to": "ref('mdm_customer_master_hco')", "field": "kmk_hco_id", "column_name": "kmk_hco_id", "model": "{{ get_where_subquery(ref('ref_address_best_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_ref_address_best_hco_address_group_id.53d638d7eb": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_ref_address_best_hco_address_group_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_ref_address_best_hco_address_group_id.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_ref_address_best_hco_address_group_id.53d638d7eb", "fqn": ["CGOncology_MDM", "adm", "not_null_ref_address_best_hco_address_group_id"], "alias": "not_null_ref_address_best_hco_address_group_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.7045178, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "ref_address_best_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.ref_address_best_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "address_group_id", "file_key_name": "models.ref_address_best_hco", "attached_node": "model.CGOncology_MDM.ref_address_best_hco", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "address_group_id", "model": "{{ get_where_subquery(ref('ref_address_best_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_ref_address_best_hco_address_best_hco_id.dab8f5f797": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_ref_address_best_hco_address_best_hco_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_ref_address_best_hco_address_best_hco_id.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_ref_address_best_hco_address_best_hco_id.dab8f5f797", "fqn": ["CGOncology_MDM", "adm", "not_null_ref_address_best_hco_address_best_hco_id"], "alias": "not_null_ref_address_best_hco_address_best_hco_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.7050161, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "ref_address_best_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.ref_address_best_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "address_best_hco_id", "file_key_name": "models.ref_address_best_hco", "attached_node": "model.CGOncology_MDM.ref_address_best_hco", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "address_best_hco_id", "model": "{{ get_where_subquery(ref('ref_address_best_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_ref_address_best_hco_is_address_best.49ac58e764": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_ref_address_best_hco_is_address_best", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_ref_address_best_hco_is_address_best.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_ref_address_best_hco_is_address_best.49ac58e764", "fqn": ["CGOncology_MDM", "adm", "not_null_ref_address_best_hco_is_address_best"], "alias": "not_null_ref_address_best_hco_is_address_best", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.705512, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "ref_address_best_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.ref_address_best_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_address_best", "file_key_name": "models.ref_address_best_hco", "attached_node": "model.CGOncology_MDM.ref_address_best_hco", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "is_address_best", "model": "{{ get_where_subquery(ref('ref_address_best_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_ref_address_best_hco_is_address_best__Y__N.4821daa5cd": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_ref_address_best_hco_is_address_best__Y__N", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_ref_address_best_hco_is_address_best__Y__N.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_ref_address_best_hco_is_address_best__Y__N.4821daa5cd", "fqn": ["CGOncology_MDM", "adm", "accepted_values_ref_address_best_hco_is_address_best__Y__N"], "alias": "accepted_values_ref_address_best_hco_is_address_best__Y__N", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.7060218, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "ref_address_best_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.ref_address_best_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "is_address_best", "file_key_name": "models.ref_address_best_hco", "attached_node": "model.CGOncology_MDM.ref_address_best_hco", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "is_address_best", "values": ["Y", "N"], "model": "{{ get_where_subquery(ref('ref_address_best_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_ref_address_best_hco_address_group_count.a48f51a241": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_ref_address_best_hco_address_group_count", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_ref_address_best_hco_address_group_count.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_ref_address_best_hco_address_group_count.a48f51a241", "fqn": ["CGOncology_MDM", "adm", "not_null_ref_address_best_hco_address_group_count"], "alias": "not_null_ref_address_best_hco_address_group_count", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.707461, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "ref_address_best_hco", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.ref_address_best_hco"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "address_group_count", "file_key_name": "models.ref_address_best_hco", "attached_node": "model.CGOncology_MDM.ref_address_best_hco", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "address_group_count", "model": "{{ get_where_subquery(ref('ref_address_best_hco')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_entity_type.7f2a2cf4d0": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_address_best_hco_metrics_long_entity_type", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_address_best_hco_metrics_long_entity_type.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_entity_type.7f2a2cf4d0", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_address_best_hco_metrics_long_entity_type"], "alias": "not_null_adm_address_best_hco_metrics_long_entity_type", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.707964, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_address_best_hco_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_address_best_hco_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "entity_type", "file_key_name": "models.adm_address_best_hco_metrics_long", "attached_node": "model.CGOncology_MDM.adm_address_best_hco_metrics_long", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "entity_type", "model": "{{ get_where_subquery(ref('adm_address_best_hco_metrics_long')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_adm_address_best_hco_metrics_long_entity_type__ADDRESS_BEST_HCO.e3223ff58e": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_address_best_hco_metrics_long_entity_type__ADDRESS_BEST_HCO", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_address_be_76427a798ae602d81ea7e6e1cb80a9f4.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_address_best_hco_metrics_long_entity_type__ADDRESS_BEST_HCO.e3223ff58e", "fqn": ["CGOncology_MDM", "adm", "accepted_values_adm_address_best_hco_metrics_long_entity_type__ADDRESS_BEST_HCO"], "alias": "accepted_values_adm_address_be_76427a798ae602d81ea7e6e1cb80a9f4", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_adm_address_be_76427a798ae602d81ea7e6e1cb80a9f4", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_adm_address_be_76427a798ae602d81ea7e6e1cb80a9f4"}, "created_at": 1770177079.7084842, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_adm_address_be_76427a798ae602d81ea7e6e1cb80a9f4\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_address_best_hco_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_address_best_hco_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "entity_type", "file_key_name": "models.adm_address_best_hco_metrics_long", "attached_node": "model.CGOncology_MDM.adm_address_best_hco_metrics_long", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "entity_type", "values": ["ADDRESS_BEST_HCO"], "model": "{{ get_where_subquery(ref('adm_address_best_hco_metrics_long')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_entity_id.58f585bf06": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_address_best_hco_metrics_long_entity_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_address_best_hco_metrics_long_entity_id.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_entity_id.58f585bf06", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_address_best_hco_metrics_long_entity_id"], "alias": "not_null_adm_address_best_hco_metrics_long_entity_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.7097669, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_address_best_hco_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_address_best_hco_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "entity_id", "file_key_name": "models.adm_address_best_hco_metrics_long", "attached_node": "model.CGOncology_MDM.adm_address_best_hco_metrics_long", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "entity_id", "model": "{{ get_where_subquery(ref('adm_address_best_hco_metrics_long')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_metric_category.61333a3296": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_address_best_hco_metrics_long_metric_category", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_address_best_hco_metrics_long_metric_category.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_metric_category.61333a3296", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_address_best_hco_metrics_long_metric_category"], "alias": "not_null_adm_address_best_hco_metrics_long_metric_category", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.710271, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_address_best_hco_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_address_best_hco_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "metric_category", "file_key_name": "models.adm_address_best_hco_metrics_long", "attached_node": "model.CGOncology_MDM.adm_address_best_hco_metrics_long", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "metric_category", "model": "{{ get_where_subquery(ref('adm_address_best_hco_metrics_long')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_period_key.6479f81b48": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_address_best_hco_metrics_long_period_key", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_address_best_hco_metrics_long_period_key.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_period_key.6479f81b48", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_address_best_hco_metrics_long_period_key"], "alias": "not_null_adm_address_best_hco_metrics_long_period_key", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.710767, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_address_best_hco_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_address_best_hco_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "period_key", "file_key_name": "models.adm_address_best_hco_metrics_long", "attached_node": "model.CGOncology_MDM.adm_address_best_hco_metrics_long", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "period_key", "model": "{{ get_where_subquery(ref('adm_address_best_hco_metrics_long')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_claim_count.16f35ae23f": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_address_best_hco_metrics_long_claim_count", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_address_best_hco_metrics_long_claim_count.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_claim_count.16f35ae23f", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_address_best_hco_metrics_long_claim_count"], "alias": "not_null_adm_address_best_hco_metrics_long_claim_count", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.7112708, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_address_best_hco_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_address_best_hco_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "claim_count", "file_key_name": "models.adm_address_best_hco_metrics_long", "attached_node": "model.CGOncology_MDM.adm_address_best_hco_metrics_long", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "claim_count", "model": "{{ get_where_subquery(ref('adm_address_best_hco_metrics_long')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_patient_count.e3d2699c30": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_address_best_hco_metrics_long_patient_count", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_address_best_hco_metrics_long_patient_count.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_patient_count.e3d2699c30", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_address_best_hco_metrics_long_patient_count"], "alias": "not_null_adm_address_best_hco_metrics_long_patient_count", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.7117708, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_address_best_hco_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_address_best_hco_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "patient_count", "file_key_name": "models.adm_address_best_hco_metrics_long", "attached_node": "model.CGOncology_MDM.adm_address_best_hco_metrics_long", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "patient_count", "model": "{{ get_where_subquery(ref('adm_address_best_hco_metrics_long')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_contributing_hco_count.95bedc6749": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_address_best_hco_metrics_long_contributing_hco_count", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_address_best_hco__962be534037ce32c7ba619bfdf3914d3.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_contributing_hco_count.95bedc6749", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_address_best_hco_metrics_long_contributing_hco_count"], "alias": "not_null_adm_address_best_hco__962be534037ce32c7ba619bfdf3914d3", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "not_null_adm_address_best_hco__962be534037ce32c7ba619bfdf3914d3", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "not_null_adm_address_best_hco__962be534037ce32c7ba619bfdf3914d3"}, "created_at": 1770177079.712276, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}{{ config(alias=\"not_null_adm_address_best_hco__962be534037ce32c7ba619bfdf3914d3\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_address_best_hco_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_address_best_hco_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "contributing_hco_count", "file_key_name": "models.adm_address_best_hco_metrics_long", "attached_node": "model.CGOncology_MDM.adm_address_best_hco_metrics_long", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "contributing_hco_count", "model": "{{ get_where_subquery(ref('adm_address_best_hco_metrics_long')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_wide_kmk_hco_id.7132de2edb": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_address_best_hco_metrics_wide_kmk_hco_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_address_best_hco_metrics_wide_kmk_hco_id.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_wide_kmk_hco_id.7132de2edb", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_address_best_hco_metrics_wide_kmk_hco_id"], "alias": "not_null_adm_address_best_hco_metrics_wide_kmk_hco_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.712773, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_address_best_hco_metrics_wide", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_address_best_hco_metrics_wide"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hco_id", "file_key_name": "models.adm_address_best_hco_metrics_wide", "attached_node": "model.CGOncology_MDM.adm_address_best_hco_metrics_wide", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "kmk_hco_id", "model": "{{ get_where_subquery(ref('adm_address_best_hco_metrics_wide')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_wide_metric_category.2d7e0dbc9e": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_address_best_hco_metrics_wide_metric_category", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_address_best_hco_metrics_wide_metric_category.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_wide_metric_category.2d7e0dbc9e", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_address_best_hco_metrics_wide_metric_category"], "alias": "not_null_adm_address_best_hco_metrics_wide_metric_category", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.71327, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_address_best_hco_metrics_wide", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_address_best_hco_metrics_wide"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "metric_category", "file_key_name": "models.adm_address_best_hco_metrics_wide", "attached_node": "model.CGOncology_MDM.adm_address_best_hco_metrics_wide", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "metric_category", "model": "{{ get_where_subquery(ref('adm_address_best_hco_metrics_wide')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_address_best_ddd_metrics_long_entity_type.bbb73a3e00": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_address_best_ddd_metrics_long_entity_type", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_address_best_ddd_metrics_long_entity_type.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_address_best_ddd_metrics_long_entity_type.bbb73a3e00", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_address_best_ddd_metrics_long_entity_type"], "alias": "not_null_adm_address_best_ddd_metrics_long_entity_type", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.713763, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_address_best_ddd_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_address_best_ddd_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "entity_type", "file_key_name": "models.adm_address_best_ddd_metrics_long", "attached_node": "model.CGOncology_MDM.adm_address_best_ddd_metrics_long", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "entity_type", "model": "{{ get_where_subquery(ref('adm_address_best_ddd_metrics_long')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_adm_address_best_ddd_metrics_long_entity_type__ADDRESS_BEST_HCO.76d303acb5": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_address_best_ddd_metrics_long_entity_type__ADDRESS_BEST_HCO", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_address_be_bbe69d57e50880a7e68efda8e630302b.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_address_best_ddd_metrics_long_entity_type__ADDRESS_BEST_HCO.76d303acb5", "fqn": ["CGOncology_MDM", "adm", "accepted_values_adm_address_best_ddd_metrics_long_entity_type__ADDRESS_BEST_HCO"], "alias": "accepted_values_adm_address_be_bbe69d57e50880a7e68efda8e630302b", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_adm_address_be_bbe69d57e50880a7e68efda8e630302b", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_adm_address_be_bbe69d57e50880a7e68efda8e630302b"}, "created_at": 1770177079.714266, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_adm_address_be_bbe69d57e50880a7e68efda8e630302b\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_address_best_ddd_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_address_best_ddd_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "entity_type", "file_key_name": "models.adm_address_best_ddd_metrics_long", "attached_node": "model.CGOncology_MDM.adm_address_best_ddd_metrics_long", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "entity_type", "values": ["ADDRESS_BEST_HCO"], "model": "{{ get_where_subquery(ref('adm_address_best_ddd_metrics_long')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_address_best_ddd_metrics_long_entity_id.dc95135281": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_address_best_ddd_metrics_long_entity_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_address_best_ddd_metrics_long_entity_id.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_address_best_ddd_metrics_long_entity_id.dc95135281", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_address_best_ddd_metrics_long_entity_id"], "alias": "not_null_adm_address_best_ddd_metrics_long_entity_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.715789, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_address_best_ddd_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_address_best_ddd_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "entity_id", "file_key_name": "models.adm_address_best_ddd_metrics_long", "attached_node": "model.CGOncology_MDM.adm_address_best_ddd_metrics_long", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "entity_id", "model": "{{ get_where_subquery(ref('adm_address_best_ddd_metrics_long')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_address_best_ddd_metrics_long_metric_category.d523793836": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_address_best_ddd_metrics_long_metric_category", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_address_best_ddd_metrics_long_metric_category.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_address_best_ddd_metrics_long_metric_category.d523793836", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_address_best_ddd_metrics_long_metric_category"], "alias": "not_null_adm_address_best_ddd_metrics_long_metric_category", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.716296, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_address_best_ddd_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_address_best_ddd_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "metric_category", "file_key_name": "models.adm_address_best_ddd_metrics_long", "attached_node": "model.CGOncology_MDM.adm_address_best_ddd_metrics_long", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "metric_category", "model": "{{ get_where_subquery(ref('adm_address_best_ddd_metrics_long')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_adm_address_best_ddd_metrics_long_metric_category__TICE_BCG__ADSTILADRIN__ANKTIVA__INLEXZO__TOTAL_BRANDED__TOTAL__OTHER.c8ce60c168": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_address_best_ddd_metrics_long_metric_category__TICE_BCG__ADSTILADRIN__ANKTIVA__INLEXZO__TOTAL_BRANDED__TOTAL__OTHER", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_address_be_3530c94642d382e12c890233a57b05f0.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_address_best_ddd_metrics_long_metric_category__TICE_BCG__ADSTILADRIN__ANKTIVA__INLEXZO__TOTAL_BRANDED__TOTAL__OTHER.c8ce60c168", "fqn": ["CGOncology_MDM", "adm", "accepted_values_adm_address_best_ddd_metrics_long_metric_category__TICE_BCG__ADSTILADRIN__ANKTIVA__INLEXZO__TOTAL_BRANDED__TOTAL__OTHER"], "alias": "accepted_values_adm_address_be_3530c94642d382e12c890233a57b05f0", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_adm_address_be_3530c94642d382e12c890233a57b05f0", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_adm_address_be_3530c94642d382e12c890233a57b05f0"}, "created_at": 1770177079.716813, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_adm_address_be_3530c94642d382e12c890233a57b05f0\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_address_best_ddd_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_address_best_ddd_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "metric_category", "file_key_name": "models.adm_address_best_ddd_metrics_long", "attached_node": "model.CGOncology_MDM.adm_address_best_ddd_metrics_long", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "metric_category", "values": ["TICE_BCG", "ADSTILADRIN", "ANKTIVA", "INLEXZO", "TOTAL_BRANDED", "TOTAL", "OTHER"], "model": "{{ get_where_subquery(ref('adm_address_best_ddd_metrics_long')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_address_best_ddd_metrics_long_period_key.10fec1acd6": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_address_best_ddd_metrics_long_period_key", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_address_best_ddd_metrics_long_period_key.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_address_best_ddd_metrics_long_period_key.10fec1acd6", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_address_best_ddd_metrics_long_period_key"], "alias": "not_null_adm_address_best_ddd_metrics_long_period_key", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.718135, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_address_best_ddd_metrics_long", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_address_best_ddd_metrics_long"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "period_key", "file_key_name": "models.adm_address_best_ddd_metrics_long", "attached_node": "model.CGOncology_MDM.adm_address_best_ddd_metrics_long", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "period_key", "model": "{{ get_where_subquery(ref('adm_address_best_ddd_metrics_long')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_address_best_ddd_metrics_wide_kmk_hco_id.945c4a01b0": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_address_best_ddd_metrics_wide_kmk_hco_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_address_best_ddd_metrics_wide_kmk_hco_id.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_address_best_ddd_metrics_wide_kmk_hco_id.945c4a01b0", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_address_best_ddd_metrics_wide_kmk_hco_id"], "alias": "not_null_adm_address_best_ddd_metrics_wide_kmk_hco_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.7186391, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_address_best_ddd_metrics_wide", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_address_best_ddd_metrics_wide"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "kmk_hco_id", "file_key_name": "models.adm_address_best_ddd_metrics_wide", "attached_node": "model.CGOncology_MDM.adm_address_best_ddd_metrics_wide", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "kmk_hco_id", "model": "{{ get_where_subquery(ref('adm_address_best_ddd_metrics_wide')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_address_best_ddd_metrics_wide_metric_category.215003c5bc": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_address_best_ddd_metrics_wide_metric_category", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_address_best_ddd_metrics_wide_metric_category.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_address_best_ddd_metrics_wide_metric_category.215003c5bc", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_address_best_ddd_metrics_wide_metric_category"], "alias": "not_null_adm_address_best_ddd_metrics_wide_metric_category", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.719133, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_address_best_ddd_metrics_wide", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_address_best_ddd_metrics_wide"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "metric_category", "file_key_name": "models.adm_address_best_ddd_metrics_wide", "attached_node": "model.CGOncology_MDM.adm_address_best_ddd_metrics_wide", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "metric_category", "model": "{{ get_where_subquery(ref('adm_address_best_ddd_metrics_wide')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_pipeline_snapshot_run_timestamp.ff8bc8e6ff": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_pipeline_snapshot_run_timestamp", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_pipeline_snapshot_run_timestamp.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_pipeline_snapshot_run_timestamp.ff8bc8e6ff", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_pipeline_snapshot_run_timestamp"], "alias": "not_null_adm_pipeline_snapshot_run_timestamp", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.71963, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_pipeline_snapshot", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_pipeline_snapshot"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "run_timestamp", "file_key_name": "models.adm_pipeline_snapshot", "attached_node": "model.CGOncology_MDM.adm_pipeline_snapshot", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "run_timestamp", "model": "{{ get_where_subquery(ref('adm_pipeline_snapshot')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_pipeline_snapshot_data_date.d3d141b40b": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_pipeline_snapshot_data_date", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_pipeline_snapshot_data_date.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_pipeline_snapshot_data_date.d3d141b40b", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_pipeline_snapshot_data_date"], "alias": "not_null_adm_pipeline_snapshot_data_date", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.7201338, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_pipeline_snapshot", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_pipeline_snapshot"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "data_date", "file_key_name": "models.adm_pipeline_snapshot", "attached_node": "model.CGOncology_MDM.adm_pipeline_snapshot", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "data_date", "model": "{{ get_where_subquery(ref('adm_pipeline_snapshot')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_pipeline_snapshot_metric_group.3587125e97": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_pipeline_snapshot_metric_group", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_pipeline_snapshot_metric_group.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_pipeline_snapshot_metric_group.3587125e97", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_pipeline_snapshot_metric_group"], "alias": "not_null_adm_pipeline_snapshot_metric_group", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.720639, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_pipeline_snapshot", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_pipeline_snapshot"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "metric_group", "file_key_name": "models.adm_pipeline_snapshot", "attached_node": "model.CGOncology_MDM.adm_pipeline_snapshot", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "metric_group", "model": "{{ get_where_subquery(ref('adm_pipeline_snapshot')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_pipeline_snapshot_metric_name.7ed1bacdec": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_pipeline_snapshot_metric_name", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_pipeline_snapshot_metric_name.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_pipeline_snapshot_metric_name.7ed1bacdec", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_pipeline_snapshot_metric_name"], "alias": "not_null_adm_pipeline_snapshot_metric_name", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.72114, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_pipeline_snapshot", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_pipeline_snapshot"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "metric_name", "file_key_name": "models.adm_pipeline_snapshot", "attached_node": "model.CGOncology_MDM.adm_pipeline_snapshot", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "metric_name", "model": "{{ get_where_subquery(ref('adm_pipeline_snapshot')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_pipeline_snapshot_metric_value.f59cc31a65": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_pipeline_snapshot_metric_value", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_pipeline_snapshot_metric_value.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_pipeline_snapshot_metric_value.f59cc31a65", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_pipeline_snapshot_metric_value"], "alias": "not_null_adm_pipeline_snapshot_metric_value", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.721631, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_pipeline_snapshot", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_pipeline_snapshot"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "metric_value", "file_key_name": "models.adm_pipeline_snapshot", "attached_node": "model.CGOncology_MDM.adm_pipeline_snapshot", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "metric_value", "model": "{{ get_where_subquery(ref('adm_pipeline_snapshot')) }}"}, "namespace": null}}, "test.CGOncology_MDM.accepted_values_adm_pipeline_diff_severity__CRITICAL__WARNING__INFO__OK.5092607787": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "accepted_values_adm_pipeline_diff_severity__CRITICAL__WARNING__INFO__OK", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "accepted_values_adm_pipeline_d_1ac20c355172c81e1485f83519628bec.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.accepted_values_adm_pipeline_diff_severity__CRITICAL__WARNING__INFO__OK.5092607787", "fqn": ["CGOncology_MDM", "adm", "accepted_values_adm_pipeline_diff_severity__CRITICAL__WARNING__INFO__OK"], "alias": "accepted_values_adm_pipeline_d_1ac20c355172c81e1485f83519628bec", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "accepted_values_adm_pipeline_d_1ac20c355172c81e1485f83519628bec", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "accepted_values_adm_pipeline_d_1ac20c355172c81e1485f83519628bec"}, "created_at": 1770177079.7221398, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias=\"accepted_values_adm_pipeline_d_1ac20c355172c81e1485f83519628bec\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_pipeline_diff", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.CGOncology_MDM.adm_pipeline_diff"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "severity", "file_key_name": "models.adm_pipeline_diff", "attached_node": "model.CGOncology_MDM.adm_pipeline_diff", "test_metadata": {"name": "accepted_values", "kwargs": {"column_name": "severity", "values": ["CRITICAL", "WARNING", "INFO", "OK"], "model": "{{ get_where_subquery(ref('adm_pipeline_diff')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_pipeline_trend_data_date.f3fa81fdfb": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_pipeline_trend_data_date", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_pipeline_trend_data_date.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_pipeline_trend_data_date.f3fa81fdfb", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_pipeline_trend_data_date"], "alias": "not_null_adm_pipeline_trend_data_date", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.723802, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_pipeline_trend", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_pipeline_trend"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "data_date", "file_key_name": "models.adm_pipeline_trend", "attached_node": "model.CGOncology_MDM.adm_pipeline_trend", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "data_date", "model": "{{ get_where_subquery(ref('adm_pipeline_trend')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_pipeline_trend_metric_group.7c11051e3c": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_pipeline_trend_metric_group", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_pipeline_trend_metric_group.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_pipeline_trend_metric_group.7c11051e3c", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_pipeline_trend_metric_group"], "alias": "not_null_adm_pipeline_trend_metric_group", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.724307, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_pipeline_trend", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_pipeline_trend"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "metric_group", "file_key_name": "models.adm_pipeline_trend", "attached_node": "model.CGOncology_MDM.adm_pipeline_trend", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "metric_group", "model": "{{ get_where_subquery(ref('adm_pipeline_trend')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_adm_pipeline_trend_metric_name.e432676a27": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_adm_pipeline_trend_metric_name", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_adm_pipeline_trend_metric_name.sql", "original_file_path": "models/adm/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_adm_pipeline_trend_metric_name.e432676a27", "fqn": ["CGOncology_MDM", "adm", "not_null_adm_pipeline_trend_metric_name"], "alias": "not_null_adm_pipeline_trend_metric_name", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.724809, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_pipeline_trend", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.CGOncology_MDM.adm_pipeline_trend"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "metric_name", "file_key_name": "models.adm_pipeline_trend", "attached_node": "model.CGOncology_MDM.adm_pipeline_trend", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "metric_name", "model": "{{ get_where_subquery(ref('adm_pipeline_trend')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_accounts_account_id.f3516ebe86": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_accounts_account_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_accounts_account_id.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_accounts_account_id.f3516ebe86", "fqn": ["CGOncology_MDM", "apt", "not_null_accounts_account_id"], "alias": "not_null_accounts_account_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.7420218, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "accounts", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "account_id", "file_key_name": "models.accounts", "attached_node": "model.CGOncology_MDM.accounts", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "account_id", "model": "{{ get_where_subquery(ref('accounts')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_accounts_account_id.4e8028f44d": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_accounts_account_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_accounts_account_id.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.unique_accounts_account_id.4e8028f44d", "fqn": ["CGOncology_MDM", "apt", "unique_accounts_account_id"], "alias": "unique_accounts_account_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.742562, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "accounts", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "account_id", "file_key_name": "models.accounts", "attached_node": "model.CGOncology_MDM.accounts", "test_metadata": {"name": "unique", "kwargs": {"column_name": "account_id", "model": "{{ get_where_subquery(ref('accounts')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_hcps_hcp_id.9d00a42a49": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_hcps_hcp_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_hcps_hcp_id.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_hcps_hcp_id.9d00a42a49", "fqn": ["CGOncology_MDM", "apt", "not_null_hcps_hcp_id"], "alias": "not_null_hcps_hcp_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.743072, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "hcps", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "hcp_id", "file_key_name": "models.hcps", "attached_node": "model.CGOncology_MDM.hcps", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "hcp_id", "model": "{{ get_where_subquery(ref('hcps')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_hcps_hcp_id.7cd4d1db94": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_hcps_hcp_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_hcps_hcp_id.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.unique_hcps_hcp_id.7cd4d1db94", "fqn": ["CGOncology_MDM", "apt", "unique_hcps_hcp_id"], "alias": "unique_hcps_hcp_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.743574, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "hcps", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "hcp_id", "file_key_name": "models.hcps", "attached_node": "model.CGOncology_MDM.hcps", "test_metadata": {"name": "unique", "kwargs": {"column_name": "hcp_id", "model": "{{ get_where_subquery(ref('hcps')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_account_metric_value_account_id.daca68f839": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_account_metric_value_account_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_account_metric_value_account_id.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_account_metric_value_account_id.daca68f839", "fqn": ["CGOncology_MDM", "apt", "not_null_account_metric_value_account_id"], "alias": "not_null_account_metric_value_account_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.744083, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "account_metric_value", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "account_id", "file_key_name": "models.account_metric_value", "attached_node": "model.CGOncology_MDM.account_metric_value", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "account_id", "model": "{{ get_where_subquery(ref('account_metric_value')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_account_metric_value_metric.7d4142e6c1": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_account_metric_value_metric", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_account_metric_value_metric.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_account_metric_value_metric.7d4142e6c1", "fqn": ["CGOncology_MDM", "apt", "not_null_account_metric_value_metric"], "alias": "not_null_account_metric_value_metric", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.744585, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "account_metric_value", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "metric", "file_key_name": "models.account_metric_value", "attached_node": "model.CGOncology_MDM.account_metric_value", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "metric", "model": "{{ get_where_subquery(ref('account_metric_value')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_account_metric_value_x_value.7266aac6a3": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_account_metric_value_x_value", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_account_metric_value_x_value.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_account_metric_value_x_value.7266aac6a3", "fqn": ["CGOncology_MDM", "apt", "not_null_account_metric_value_x_value"], "alias": "not_null_account_metric_value_x_value", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.7450829, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "account_metric_value", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "x_value", "file_key_name": "models.account_metric_value", "attached_node": "model.CGOncology_MDM.account_metric_value", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "x_value", "model": "{{ get_where_subquery(ref('account_metric_value')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_account_metric_value_account_id__metric__x_value.a7fdcfc32d": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_utils_unique_combination_of_columns_account_metric_value_account_id__metric__x_value", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_utils_unique_combination_o_2ee1f0adfc756443115d440a21505220.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_account_metric_value_account_id__metric__x_value.a7fdcfc32d", "fqn": ["CGOncology_MDM", "apt", "dbt_utils_unique_combination_of_columns_account_metric_value_account_id__metric__x_value"], "alias": "dbt_utils_unique_combination_o_2ee1f0adfc756443115d440a21505220", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": "dbt_utils_unique_combination_o_2ee1f0adfc756443115d440a21505220", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_2ee1f0adfc756443115d440a21505220"}, "created_at": 1770177079.745606, "relation_name": null, "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_2ee1f0adfc756443115d440a21505220\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "account_metric_value", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_utils.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.account_metric_value", "attached_node": "model.CGOncology_MDM.account_metric_value", "test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["account_id", "metric", "x_value"], "model": "{{ get_where_subquery(ref('account_metric_value')) }}"}, "namespace": "dbt_utils"}}, "test.CGOncology_MDM.not_null_geo_metric_value_geography_id.c03bcc8173": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_geo_metric_value_geography_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_geo_metric_value_geography_id.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_geo_metric_value_geography_id.c03bcc8173", "fqn": ["CGOncology_MDM", "apt", "not_null_geo_metric_value_geography_id"], "alias": "not_null_geo_metric_value_geography_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.747493, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "geo_metric_value", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "geography_id", "file_key_name": "models.geo_metric_value", "attached_node": "model.CGOncology_MDM.geo_metric_value", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "geography_id", "model": "{{ get_where_subquery(ref('geo_metric_value')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_geo_metric_value_metric.6c74eefef1": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_geo_metric_value_metric", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_geo_metric_value_metric.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_geo_metric_value_metric.6c74eefef1", "fqn": ["CGOncology_MDM", "apt", "not_null_geo_metric_value_metric"], "alias": "not_null_geo_metric_value_metric", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.748002, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "geo_metric_value", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "metric", "file_key_name": "models.geo_metric_value", "attached_node": "model.CGOncology_MDM.geo_metric_value", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "metric", "model": "{{ get_where_subquery(ref('geo_metric_value')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_geo_metric_value_x_value.7d369f5606": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_geo_metric_value_x_value", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_geo_metric_value_x_value.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_geo_metric_value_x_value.7d369f5606", "fqn": ["CGOncology_MDM", "apt", "not_null_geo_metric_value_x_value"], "alias": "not_null_geo_metric_value_x_value", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.7485068, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "geo_metric_value", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "x_value", "file_key_name": "models.geo_metric_value", "attached_node": "model.CGOncology_MDM.geo_metric_value", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "x_value", "model": "{{ get_where_subquery(ref('geo_metric_value')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_geo_metric_value_geography_id__metric__x_value.9b6b21c19d": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_utils_unique_combination_of_columns_geo_metric_value_geography_id__metric__x_value", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_utils_unique_combination_o_791e7527cdb4e01b07fd7bea3f89285d.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_geo_metric_value_geography_id__metric__x_value.9b6b21c19d", "fqn": ["CGOncology_MDM", "apt", "dbt_utils_unique_combination_of_columns_geo_metric_value_geography_id__metric__x_value"], "alias": "dbt_utils_unique_combination_o_791e7527cdb4e01b07fd7bea3f89285d", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": "dbt_utils_unique_combination_o_791e7527cdb4e01b07fd7bea3f89285d", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_791e7527cdb4e01b07fd7bea3f89285d"}, "created_at": 1770177079.7490182, "relation_name": null, "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_791e7527cdb4e01b07fd7bea3f89285d\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "geo_metric_value", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_utils.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.geo_metric_value", "attached_node": "model.CGOncology_MDM.geo_metric_value", "test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["geography_id", "metric", "x_value"], "model": "{{ get_where_subquery(ref('geo_metric_value')) }}"}, "namespace": "dbt_utils"}}, "test.CGOncology_MDM.not_null_account_hcps_account_id.9105429673": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_account_hcps_account_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_account_hcps_account_id.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_account_hcps_account_id.9105429673", "fqn": ["CGOncology_MDM", "apt", "not_null_account_hcps_account_id"], "alias": "not_null_account_hcps_account_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.750475, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "account_hcps", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "account_id", "file_key_name": "models.account_hcps", "attached_node": "model.CGOncology_MDM.account_hcps", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "account_id", "model": "{{ get_where_subquery(ref('account_hcps')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_account_hcps_hcp_id.4ade91a768": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_account_hcps_hcp_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_account_hcps_hcp_id.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_account_hcps_hcp_id.4ade91a768", "fqn": ["CGOncology_MDM", "apt", "not_null_account_hcps_hcp_id"], "alias": "not_null_account_hcps_hcp_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.750975, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "account_hcps", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "hcp_id", "file_key_name": "models.account_hcps", "attached_node": "model.CGOncology_MDM.account_hcps", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "hcp_id", "model": "{{ get_where_subquery(ref('account_hcps')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_account_hcps_account_id__hcp_id.e5ab65a978": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_utils_unique_combination_of_columns_account_hcps_account_id__hcp_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_utils_unique_combination_o_20f06b710495b7a7cc8de142dd14c0d3.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_account_hcps_account_id__hcp_id.e5ab65a978", "fqn": ["CGOncology_MDM", "apt", "dbt_utils_unique_combination_of_columns_account_hcps_account_id__hcp_id"], "alias": "dbt_utils_unique_combination_o_20f06b710495b7a7cc8de142dd14c0d3", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": "dbt_utils_unique_combination_o_20f06b710495b7a7cc8de142dd14c0d3", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_20f06b710495b7a7cc8de142dd14c0d3"}, "created_at": 1770177079.751487, "relation_name": null, "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_20f06b710495b7a7cc8de142dd14c0d3\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "account_hcps", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_utils.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.account_hcps", "attached_node": "model.CGOncology_MDM.account_hcps", "test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["account_id", "hcp_id"], "model": "{{ get_where_subquery(ref('account_hcps')) }}"}, "namespace": "dbt_utils"}}, "test.CGOncology_MDM.not_null_targets_team_code.f3721486b3": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_targets_team_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_targets_team_code.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_targets_team_code.f3721486b3", "fqn": ["CGOncology_MDM", "apt", "not_null_targets_team_code"], "alias": "not_null_targets_team_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.752855, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "targets", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "team_code", "file_key_name": "models.targets", "attached_node": "model.CGOncology_MDM.targets", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "team_code", "model": "{{ get_where_subquery(ref('targets')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_targets_account_id.1ed19c89aa": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_targets_account_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_targets_account_id.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_targets_account_id.1ed19c89aa", "fqn": ["CGOncology_MDM", "apt", "not_null_targets_account_id"], "alias": "not_null_targets_account_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.753352, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "targets", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "account_id", "file_key_name": "models.targets", "attached_node": "model.CGOncology_MDM.targets", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "account_id", "model": "{{ get_where_subquery(ref('targets')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_targets_team_code__account_id.7822ba6bb9": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_utils_unique_combination_of_columns_targets_team_code__account_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_utils_unique_combination_o_dde4cbd5adbcfe59e675e690341d9e23.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_targets_team_code__account_id.7822ba6bb9", "fqn": ["CGOncology_MDM", "apt", "dbt_utils_unique_combination_of_columns_targets_team_code__account_id"], "alias": "dbt_utils_unique_combination_o_dde4cbd5adbcfe59e675e690341d9e23", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": "dbt_utils_unique_combination_o_dde4cbd5adbcfe59e675e690341d9e23", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_dde4cbd5adbcfe59e675e690341d9e23"}, "created_at": 1770177079.754168, "relation_name": null, "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_dde4cbd5adbcfe59e675e690341d9e23\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "targets", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_utils.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.targets", "attached_node": "model.CGOncology_MDM.targets", "test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["team_code", "account_id"], "model": "{{ get_where_subquery(ref('targets')) }}"}, "namespace": "dbt_utils"}}, "test.CGOncology_MDM.not_null_accounts_geo_affiliation_account_id.d02fe7ab82": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_accounts_geo_affiliation_account_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_accounts_geo_affiliation_account_id.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_accounts_geo_affiliation_account_id.d02fe7ab82", "fqn": ["CGOncology_MDM", "apt", "not_null_accounts_geo_affiliation_account_id"], "alias": "not_null_accounts_geo_affiliation_account_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.7555149, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "accounts_geo_affiliation", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "account_id", "file_key_name": "models.accounts_geo_affiliation", "attached_node": "model.CGOncology_MDM.accounts_geo_affiliation", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "account_id", "model": "{{ get_where_subquery(ref('accounts_geo_affiliation')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_accounts_geo_affiliation_geo_code.4cc1f22303": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_accounts_geo_affiliation_geo_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_accounts_geo_affiliation_geo_code.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_accounts_geo_affiliation_geo_code.4cc1f22303", "fqn": ["CGOncology_MDM", "apt", "not_null_accounts_geo_affiliation_geo_code"], "alias": "not_null_accounts_geo_affiliation_geo_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.756029, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "accounts_geo_affiliation", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "geo_code", "file_key_name": "models.accounts_geo_affiliation", "attached_node": "model.CGOncology_MDM.accounts_geo_affiliation", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "geo_code", "model": "{{ get_where_subquery(ref('accounts_geo_affiliation')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_accounts_geo_affiliation_account_id__geo_code.33b45a1a4a": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_utils_unique_combination_of_columns_accounts_geo_affiliation_account_id__geo_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_utils_unique_combination_o_9aacad40004c6e7f54998dda7c2e49a0.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_accounts_geo_affiliation_account_id__geo_code.33b45a1a4a", "fqn": ["CGOncology_MDM", "apt", "dbt_utils_unique_combination_of_columns_accounts_geo_affiliation_account_id__geo_code"], "alias": "dbt_utils_unique_combination_o_9aacad40004c6e7f54998dda7c2e49a0", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": "dbt_utils_unique_combination_o_9aacad40004c6e7f54998dda7c2e49a0", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_9aacad40004c6e7f54998dda7c2e49a0"}, "created_at": 1770177079.7565491, "relation_name": null, "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_9aacad40004c6e7f54998dda7c2e49a0\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "accounts_geo_affiliation", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_utils.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.accounts_geo_affiliation", "attached_node": "model.CGOncology_MDM.accounts_geo_affiliation", "test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["account_id", "geo_code"], "model": "{{ get_where_subquery(ref('accounts_geo_affiliation')) }}"}, "namespace": "dbt_utils"}}, "test.CGOncology_MDM.not_null_account_payer_types_account_id.f1840ce997": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_account_payer_types_account_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_account_payer_types_account_id.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_account_payer_types_account_id.f1840ce997", "fqn": ["CGOncology_MDM", "apt", "not_null_account_payer_types_account_id"], "alias": "not_null_account_payer_types_account_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.7580018, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "account_payer_types", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "account_id", "file_key_name": "models.account_payer_types", "attached_node": "model.CGOncology_MDM.account_payer_types", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "account_id", "model": "{{ get_where_subquery(ref('account_payer_types')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_account_payer_types_payer_type.de70e0d27e": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_account_payer_types_payer_type", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_account_payer_types_payer_type.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_account_payer_types_payer_type.de70e0d27e", "fqn": ["CGOncology_MDM", "apt", "not_null_account_payer_types_payer_type"], "alias": "not_null_account_payer_types_payer_type", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.758497, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "account_payer_types", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "payer_type", "file_key_name": "models.account_payer_types", "attached_node": "model.CGOncology_MDM.account_payer_types", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "payer_type", "model": "{{ get_where_subquery(ref('account_payer_types')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_account_payer_types_account_id__payer_type__product.91f9599d2f": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_utils_unique_combination_of_columns_account_payer_types_account_id__payer_type__product", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_utils_unique_combination_o_3abebca83f00ee0572da8ec93154dfe7.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_account_payer_types_account_id__payer_type__product.91f9599d2f", "fqn": ["CGOncology_MDM", "apt", "dbt_utils_unique_combination_of_columns_account_payer_types_account_id__payer_type__product"], "alias": "dbt_utils_unique_combination_o_3abebca83f00ee0572da8ec93154dfe7", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": "dbt_utils_unique_combination_o_3abebca83f00ee0572da8ec93154dfe7", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_3abebca83f00ee0572da8ec93154dfe7"}, "created_at": 1770177079.759008, "relation_name": null, "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_3abebca83f00ee0572da8ec93154dfe7\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "account_payer_types", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_utils.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.account_payer_types", "attached_node": "model.CGOncology_MDM.account_payer_types", "test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["account_id", "payer_type", "product"], "model": "{{ get_where_subquery(ref('account_payer_types')) }}"}, "namespace": "dbt_utils"}}, "test.CGOncology_MDM.not_null_account_executives_account_id.fcc34ca9c9": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_account_executives_account_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_account_executives_account_id.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_account_executives_account_id.fcc34ca9c9", "fqn": ["CGOncology_MDM", "apt", "not_null_account_executives_account_id"], "alias": "not_null_account_executives_account_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.760363, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "account_executives", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "account_id", "file_key_name": "models.account_executives", "attached_node": "model.CGOncology_MDM.account_executives", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "account_id", "model": "{{ get_where_subquery(ref('account_executives')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_account_executives_executive_id.3fc9f05c72": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_account_executives_executive_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_account_executives_executive_id.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_account_executives_executive_id.3fc9f05c72", "fqn": ["CGOncology_MDM", "apt", "not_null_account_executives_executive_id"], "alias": "not_null_account_executives_executive_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.761224, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "account_executives", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "executive_id", "file_key_name": "models.account_executives", "attached_node": "model.CGOncology_MDM.account_executives", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "executive_id", "model": "{{ get_where_subquery(ref('account_executives')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_account_executives_account_id__executive_id.bd23489999": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_utils_unique_combination_of_columns_account_executives_account_id__executive_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_utils_unique_combination_o_02c0ea01871daed1a912a0c8325e6a0a.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_account_executives_account_id__executive_id.bd23489999", "fqn": ["CGOncology_MDM", "apt", "dbt_utils_unique_combination_of_columns_account_executives_account_id__executive_id"], "alias": "dbt_utils_unique_combination_o_02c0ea01871daed1a912a0c8325e6a0a", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": "dbt_utils_unique_combination_o_02c0ea01871daed1a912a0c8325e6a0a", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_02c0ea01871daed1a912a0c8325e6a0a"}, "created_at": 1770177079.762045, "relation_name": null, "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_02c0ea01871daed1a912a0c8325e6a0a\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "account_executives", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_utils.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.account_executives", "attached_node": "model.CGOncology_MDM.account_executives", "test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["account_id", "executive_id"], "model": "{{ get_where_subquery(ref('account_executives')) }}"}, "namespace": "dbt_utils"}}, "test.CGOncology_MDM.not_null_geographies_geo_code.a5991755ab": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_geographies_geo_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_geographies_geo_code.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_geographies_geo_code.a5991755ab", "fqn": ["CGOncology_MDM", "apt", "not_null_geographies_geo_code"], "alias": "not_null_geographies_geo_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.7637382, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "geographies", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "geo_code", "file_key_name": "models.geographies", "attached_node": "model.CGOncology_MDM.geographies", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "geo_code", "model": "{{ get_where_subquery(ref('geographies')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_geographies_geo_code.7f462935fb": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_geographies_geo_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_geographies_geo_code.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.unique_geographies_geo_code.7f462935fb", "fqn": ["CGOncology_MDM", "apt", "unique_geographies_geo_code"], "alias": "unique_geographies_geo_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.764268, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "geographies", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "geo_code", "file_key_name": "models.geographies", "attached_node": "model.CGOncology_MDM.geographies", "test_metadata": {"name": "unique", "kwargs": {"column_name": "geo_code", "model": "{{ get_where_subquery(ref('geographies')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_account_levels_code.849ccc9022": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_account_levels_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_account_levels_code.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_account_levels_code.849ccc9022", "fqn": ["CGOncology_MDM", "apt", "not_null_account_levels_code"], "alias": "not_null_account_levels_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.76479, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "account_levels", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "code", "file_key_name": "models.account_levels", "attached_node": "model.CGOncology_MDM.account_levels", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "code", "model": "{{ get_where_subquery(ref('account_levels')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_account_levels_code.5bdbf79dd1": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_account_levels_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_account_levels_code.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.unique_account_levels_code.5bdbf79dd1", "fqn": ["CGOncology_MDM", "apt", "unique_account_levels_code"], "alias": "unique_account_levels_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.765298, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "account_levels", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "code", "file_key_name": "models.account_levels", "attached_node": "model.CGOncology_MDM.account_levels", "test_metadata": {"name": "unique", "kwargs": {"column_name": "code", "model": "{{ get_where_subquery(ref('account_levels')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_account_types_code.71ee76f58d": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_account_types_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_account_types_code.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_account_types_code.71ee76f58d", "fqn": ["CGOncology_MDM", "apt", "not_null_account_types_code"], "alias": "not_null_account_types_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.7657971, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "account_types", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "code", "file_key_name": "models.account_types", "attached_node": "model.CGOncology_MDM.account_types", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "code", "model": "{{ get_where_subquery(ref('account_types')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_account_types_code.970ebf6203": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_account_types_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_account_types_code.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.unique_account_types_code.970ebf6203", "fqn": ["CGOncology_MDM", "apt", "unique_account_types_code"], "alias": "unique_account_types_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.766295, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "account_types", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "code", "file_key_name": "models.account_types", "attached_node": "model.CGOncology_MDM.account_types", "test_metadata": {"name": "unique", "kwargs": {"column_name": "code", "model": "{{ get_where_subquery(ref('account_types')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_teams_team_code.564726c6b6": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_teams_team_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_teams_team_code.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_teams_team_code.564726c6b6", "fqn": ["CGOncology_MDM", "apt", "not_null_teams_team_code"], "alias": "not_null_teams_team_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.7667918, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "teams", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["seed.CGOncology_MDM.teams"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "team_code", "file_key_name": "models.teams", "attached_node": "seed.CGOncology_MDM.teams", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "team_code", "model": "{{ get_where_subquery(ref('teams')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_teams_team_code.4a63fda674": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_teams_team_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_teams_team_code.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.unique_teams_team_code.4a63fda674", "fqn": ["CGOncology_MDM", "apt", "unique_teams_team_code"], "alias": "unique_teams_team_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.767287, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "teams", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["seed.CGOncology_MDM.teams"]}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "team_code", "file_key_name": "models.teams", "attached_node": "seed.CGOncology_MDM.teams", "test_metadata": {"name": "unique", "kwargs": {"column_name": "team_code", "model": "{{ get_where_subquery(ref('teams')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_metric_list_code.decbcfb7bd": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_metric_list_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_metric_list_code.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_metric_list_code.decbcfb7bd", "fqn": ["CGOncology_MDM", "apt", "not_null_metric_list_code"], "alias": "not_null_metric_list_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.7678301, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "metric_list", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "code", "file_key_name": "models.metric_list", "attached_node": "model.CGOncology_MDM.metric_list", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "code", "model": "{{ get_where_subquery(ref('metric_list')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_metric_list_code.e46edf3df9": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_metric_list_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_metric_list_code.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.unique_metric_list_code.e46edf3df9", "fqn": ["CGOncology_MDM", "apt", "unique_metric_list_code"], "alias": "unique_metric_list_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.7686012, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "metric_list", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "code", "file_key_name": "models.metric_list", "attached_node": "model.CGOncology_MDM.metric_list", "test_metadata": {"name": "unique", "kwargs": {"column_name": "code", "model": "{{ get_where_subquery(ref('metric_list')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_payer_types_code.fe7996f333": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_payer_types_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_payer_types_code.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_payer_types_code.fe7996f333", "fqn": ["CGOncology_MDM", "apt", "not_null_payer_types_code"], "alias": "not_null_payer_types_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.7691169, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "payer_types", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "code", "file_key_name": "models.payer_types", "attached_node": "model.CGOncology_MDM.payer_types", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "code", "model": "{{ get_where_subquery(ref('payer_types')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_payer_types_code.bb3be8482d": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_payer_types_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_payer_types_code.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.unique_payer_types_code.bb3be8482d", "fqn": ["CGOncology_MDM", "apt", "unique_payer_types_code"], "alias": "unique_payer_types_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.769608, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "payer_types", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "code", "file_key_name": "models.payer_types", "attached_node": "model.CGOncology_MDM.payer_types", "test_metadata": {"name": "unique", "kwargs": {"column_name": "code", "model": "{{ get_where_subquery(ref('payer_types')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_units_unit_code.06667a1d29": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_units_unit_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_units_unit_code.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_units_unit_code.06667a1d29", "fqn": ["CGOncology_MDM", "apt", "not_null_units_unit_code"], "alias": "not_null_units_unit_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.7710772, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "units", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "unit_code", "file_key_name": "models.units", "attached_node": "model.CGOncology_MDM.units", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "unit_code", "model": "{{ get_where_subquery(ref('units')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_units_unit_code.f733452279": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_units_unit_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_units_unit_code.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.unique_units_unit_code.f733452279", "fqn": ["CGOncology_MDM", "apt", "unique_units_unit_code"], "alias": "unique_units_unit_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.771583, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "units", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "unit_code", "file_key_name": "models.units", "attached_node": "model.CGOncology_MDM.units", "test_metadata": {"name": "unique", "kwargs": {"column_name": "unit_code", "model": "{{ get_where_subquery(ref('units')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_states_code.ef45871ca2": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_states_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_states_code.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_states_code.ef45871ca2", "fqn": ["CGOncology_MDM", "apt", "not_null_states_code"], "alias": "not_null_states_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.772073, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "states", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "code", "file_key_name": "models.states", "attached_node": "model.CGOncology_MDM.states", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "code", "model": "{{ get_where_subquery(ref('states')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_states_code.a1c69eafa1": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_states_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_states_code.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.unique_states_code.a1c69eafa1", "fqn": ["CGOncology_MDM", "apt", "unique_states_code"], "alias": "unique_states_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.772565, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "states", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "code", "file_key_name": "models.states", "attached_node": "model.CGOncology_MDM.states", "test_metadata": {"name": "unique", "kwargs": {"column_name": "code", "model": "{{ get_where_subquery(ref('states')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_firm_types_code.de9c62050f": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_firm_types_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_firm_types_code.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_firm_types_code.de9c62050f", "fqn": ["CGOncology_MDM", "apt", "not_null_firm_types_code"], "alias": "not_null_firm_types_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.773058, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "firm_types", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "code", "file_key_name": "models.firm_types", "attached_node": "model.CGOncology_MDM.firm_types", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "code", "model": "{{ get_where_subquery(ref('firm_types')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_firm_types_code.05448a131a": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_firm_types_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_firm_types_code.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.unique_firm_types_code.05448a131a", "fqn": ["CGOncology_MDM", "apt", "unique_firm_types_code"], "alias": "unique_firm_types_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.773592, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "firm_types", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "code", "file_key_name": "models.firm_types", "attached_node": "model.CGOncology_MDM.firm_types", "test_metadata": {"name": "unique", "kwargs": {"column_name": "code", "model": "{{ get_where_subquery(ref('firm_types')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_data_source_data_source.bac58ac78f": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_data_source_data_source", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_data_source_data_source.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_data_source_data_source.bac58ac78f", "fqn": ["CGOncology_MDM", "apt", "not_null_data_source_data_source"], "alias": "not_null_data_source_data_source", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.774177, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "data_source", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "data_source", "file_key_name": "models.data_source", "attached_node": "model.CGOncology_MDM.data_source", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "data_source", "model": "{{ get_where_subquery(ref('data_source')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_data_source_data_source.add5f8ee8f": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_data_source_data_source", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_data_source_data_source.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.unique_data_source_data_source.add5f8ee8f", "fqn": ["CGOncology_MDM", "apt", "unique_data_source_data_source"], "alias": "unique_data_source_data_source", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.774683, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "data_source", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "data_source", "file_key_name": "models.data_source", "attached_node": "model.CGOncology_MDM.data_source", "test_metadata": {"name": "unique", "kwargs": {"column_name": "data_source", "model": "{{ get_where_subquery(ref('data_source')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_config_charts_chart_code.a0fe743549": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_config_charts_chart_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_config_charts_chart_code.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_config_charts_chart_code.a0fe743549", "fqn": ["CGOncology_MDM", "apt", "not_null_config_charts_chart_code"], "alias": "not_null_config_charts_chart_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.775182, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "config_charts", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "chart_code", "file_key_name": "models.config_charts", "attached_node": "model.CGOncology_MDM.config_charts", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "chart_code", "model": "{{ get_where_subquery(ref('config_charts')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_config_charts_chart_code.053a97cd50": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_config_charts_chart_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_config_charts_chart_code.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.unique_config_charts_chart_code.053a97cd50", "fqn": ["CGOncology_MDM", "apt", "unique_config_charts_chart_code"], "alias": "unique_config_charts_chart_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.775713, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "config_charts", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "chart_code", "file_key_name": "models.config_charts", "attached_node": "model.CGOncology_MDM.config_charts", "test_metadata": {"name": "unique", "kwargs": {"column_name": "chart_code", "model": "{{ get_where_subquery(ref('config_charts')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_data_points_code.3eed85fe8d": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_data_points_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_data_points_code.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_data_points_code.3eed85fe8d", "fqn": ["CGOncology_MDM", "apt", "not_null_data_points_code"], "alias": "not_null_data_points_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.776275, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "data_points", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "code", "file_key_name": "models.data_points", "attached_node": "model.CGOncology_MDM.data_points", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "code", "model": "{{ get_where_subquery(ref('data_points')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_data_points_code.a0594e6970": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_data_points_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_data_points_code.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.unique_data_points_code.a0594e6970", "fqn": ["CGOncology_MDM", "apt", "unique_data_points_code"], "alias": "unique_data_points_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.776795, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "data_points", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "code", "file_key_name": "models.data_points", "attached_node": "model.CGOncology_MDM.data_points", "test_metadata": {"name": "unique", "kwargs": {"column_name": "code", "model": "{{ get_where_subquery(ref('data_points')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_executives_executive_id.cfcbd8a9f1": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_executives_executive_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_executives_executive_id.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_executives_executive_id.cfcbd8a9f1", "fqn": ["CGOncology_MDM", "apt", "not_null_executives_executive_id"], "alias": "not_null_executives_executive_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.777471, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "executives", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "executive_id", "file_key_name": "models.executives", "attached_node": "model.CGOncology_MDM.executives", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "executive_id", "model": "{{ get_where_subquery(ref('executives')) }}"}, "namespace": null}}, "test.CGOncology_MDM.unique_executives_executive_id.d4fe1ece33": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "unique_executives_executive_id", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "unique_executives_executive_id.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.unique_executives_executive_id.d4fe1ece33", "fqn": ["CGOncology_MDM", "apt", "unique_executives_executive_id"], "alias": "unique_executives_executive_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.778006, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "executives", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "executive_id", "file_key_name": "models.executives", "attached_node": "model.CGOncology_MDM.executives", "test_metadata": {"name": "unique", "kwargs": {"column_name": "executive_id", "model": "{{ get_where_subquery(ref('executives')) }}"}, "namespace": null}}, "test.CGOncology_MDM.not_null_geo_levels_unit_code.2ed13993b7": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "not_null_geo_levels_unit_code", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "not_null_geo_levels_unit_code.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.not_null_geo_levels_unit_code.2ed13993b7", "fqn": ["CGOncology_MDM", "apt", "not_null_geo_levels_unit_code"], "alias": "not_null_geo_levels_unit_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1770177079.778516, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "geo_levels", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "unit_code", "file_key_name": "models.geo_levels", "attached_node": "model.CGOncology_MDM.geo_levels", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "unit_code", "model": "{{ get_where_subquery(ref('geo_levels')) }}"}, "namespace": null}}, "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_geo_levels_unit_code__level.620331e0a0": {"database": "CGONCOLOGY_TEST", "schema": "dbt_test__audit", "name": "dbt_utils_unique_combination_of_columns_geo_levels_unit_code__level", "resource_type": "test", "package_name": "CGOncology_MDM", "path": "dbt_utils_unique_combination_o_2aa742f65f1a60e7878af64bf69f4327.sql", "original_file_path": "models/apt/schema.yml", "unique_id": "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_geo_levels_unit_code__level.620331e0a0", "fqn": ["CGOncology_MDM", "apt", "dbt_utils_unique_combination_of_columns_geo_levels_unit_code__level"], "alias": "dbt_utils_unique_combination_o_2aa742f65f1a60e7878af64bf69f4327", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": false, "alias": "dbt_utils_unique_combination_o_2aa742f65f1a60e7878af64bf69f4327", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_2aa742f65f1a60e7878af64bf69f4327"}, "created_at": 1770177079.779045, "relation_name": null, "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_2aa742f65f1a60e7878af64bf69f4327\") }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "geo_levels", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": ["macro.dbt_utils.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": null, "file_key_name": "models.geo_levels", "attached_node": "model.CGOncology_MDM.geo_levels", "test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["unit_code", "level"], "model": "{{ get_where_subquery(ref('geo_levels')) }}"}, "namespace": "dbt_utils"}}}, "sources": {"source.CGOncology_MDM.raw_dh.PRELAND_DH_ALL_COMPANIES_OVERVIEW": {"database": "CGONCOLOGY_DEV", "schema": "MODEL", "name": "PRELAND_DH_ALL_COMPANIES_OVERVIEW", "resource_type": "source", "package_name": "CGOncology_MDM", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "unique_id": "source.CGOncology_MDM.raw_dh.PRELAND_DH_ALL_COMPANIES_OVERVIEW", "fqn": ["CGOncology_MDM", "raw_dh", "PRELAND_DH_ALL_COMPANIES_OVERVIEW"], "source_name": "raw_dh", "source_description": "Definitive Healthcare (DH/DHC) source tables", "loader": "", "identifier": "PRELAND_DH_ALL_COMPANIES_OVERVIEW", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "loaded_at_query": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "DH HCO (Healthcare Organizations) overview data", "columns": {"DH_ID": {"name": "DH_ID", "description": "Definitive Healthcare organization ID", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "ORG_NAME": {"name": "ORG_NAME", "description": "Organization name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "FIRM_TYPE": {"name": "FIRM_TYPE", "description": "Firm type classification", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "HQ_ADDRESS": {"name": "HQ_ADDRESS", "description": "Headquarters address line 1", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "HQ_ADDRESS1": {"name": "HQ_ADDRESS1", "description": "Headquarters address line 2", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "HQ_CITY": {"name": "HQ_CITY", "description": "Headquarters city", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "HQ_STATE": {"name": "HQ_STATE", "description": "Headquarters state", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "HQ_ZIP_CODE": {"name": "HQ_ZIP_CODE", "description": "Headquarters ZIP code", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "NPI_NUMBER": {"name": "NPI_NUMBER", "description": "NPI number", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "MAIN_SPECIALTY": {"name": "MAIN_SPECIALTY", "description": "Main specialty", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "HOSPITAL_TYPE": {"name": "HOSPITAL_TYPE", "description": "Hospital type classification", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "HOSPITAL_OWNERSHIP": {"name": "HOSPITAL_OWNERSHIP", "description": "Hospital ownership type", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "NETWORK_ID": {"name": "NETWORK_ID", "description": "Network ID", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "NETWORK_NAME": {"name": "NETWORK_NAME", "description": "Network name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "NETWORK_FIRM_TYPE": {"name": "NETWORK_FIRM_TYPE", "description": "Network firm type", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "NETWORK_PARENT_ID": {"name": "NETWORK_PARENT_ID", "description": "Network parent ID", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "NETWORK_PARENT_NAME": {"name": "NETWORK_PARENT_NAME", "description": "Network parent name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "NETWORK_PARENT_FIRM_TYPE": {"name": "NETWORK_PARENT_FIRM_TYPE", "description": "Network parent firm type", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "HOSPITAL_PARENT_ID": {"name": "HOSPITAL_PARENT_ID", "description": "Hospital parent ID", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "HOSPITAL_PARENT_NAME": {"name": "HOSPITAL_PARENT_NAME", "description": "Hospital parent name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PG_PARENT_ID": {"name": "PG_PARENT_ID", "description": "Physician group parent ID", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PG_PARENT_NAME": {"name": "PG_PARENT_NAME", "description": "Physician group parent name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "SF_PARENT_ACCOUNT_ID": {"name": "SF_PARENT_ACCOUNT_ID", "description": "Salesforce parent account ID", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "SF_PARENT_ACCOUNT_NAME": {"name": "SF_PARENT_ACCOUNT_NAME", "description": "Salesforce parent account name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "LOAD_DATE": {"name": "LOAD_DATE", "description": "Data load timestamp", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true, "event_time": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "patch_path": null, "unrendered_config": {"loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "relation_name": "CGONCOLOGY_DEV.MODEL.PRELAND_DH_ALL_COMPANIES_OVERVIEW", "created_at": 1770177079.785402, "unrendered_database": "CGONCOLOGY_DEV", "unrendered_schema": "MODEL", "doc_blocks": []}, "source.CGOncology_MDM.raw_dh.PRELAND_DH_PHYSICIANS_OVERVIEW": {"database": "CGONCOLOGY_DEV", "schema": "MODEL", "name": "PRELAND_DH_PHYSICIANS_OVERVIEW", "resource_type": "source", "package_name": "CGOncology_MDM", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "unique_id": "source.CGOncology_MDM.raw_dh.PRELAND_DH_PHYSICIANS_OVERVIEW", "fqn": ["CGOncology_MDM", "raw_dh", "PRELAND_DH_PHYSICIANS_OVERVIEW"], "source_name": "raw_dh", "source_description": "Definitive Healthcare (DH/DHC) source tables", "loader": "", "identifier": "PRELAND_DH_PHYSICIANS_OVERVIEW", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "loaded_at_query": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "DH HCP (Healthcare Provider/Physician) overview data", "columns": {"NPI": {"name": "NPI", "description": "National Provider Identifier (primary key for HCPs)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "FIRST_NAME": {"name": "FIRST_NAME", "description": "Physician first name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "LAST_NAME": {"name": "LAST_NAME", "description": "Physician last name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "SPECIALTY_PRIMARY": {"name": "SPECIALTY_PRIMARY", "description": "Primary specialty", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "SPECIALTY_SECONDARY": {"name": "SPECIALTY_SECONDARY", "description": "Secondary specialty", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "HQ_ADDRESS": {"name": "HQ_ADDRESS", "description": "Primary practice address line 1", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "HQ_ADDRESS1": {"name": "HQ_ADDRESS1", "description": "Primary practice address line 2", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "HQ_CITY": {"name": "HQ_CITY", "description": "Practice city", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "HQ_STATE": {"name": "HQ_STATE", "description": "Practice state", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "HQ_ZIP_CODE": {"name": "HQ_ZIP_CODE", "description": "Practice ZIP code", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "LOAD_DATE": {"name": "LOAD_DATE", "description": "Data load timestamp", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true, "event_time": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "patch_path": null, "unrendered_config": {"loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "relation_name": "CGONCOLOGY_DEV.MODEL.PRELAND_DH_PHYSICIANS_OVERVIEW", "created_at": 1770177079.785606, "unrendered_database": "CGONCOLOGY_DEV", "unrendered_schema": "MODEL", "doc_blocks": []}, "source.CGOncology_MDM.raw_dh.PRELAND_DH_PHYSICIAN_GROUP_PRACTICE_LOCATION": {"database": "CGONCOLOGY_DEV", "schema": "MODEL", "name": "PRELAND_DH_PHYSICIAN_GROUP_PRACTICE_LOCATION", "resource_type": "source", "package_name": "CGOncology_MDM", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "unique_id": "source.CGOncology_MDM.raw_dh.PRELAND_DH_PHYSICIAN_GROUP_PRACTICE_LOCATION", "fqn": ["CGOncology_MDM", "raw_dh", "PRELAND_DH_PHYSICIAN_GROUP_PRACTICE_LOCATION"], "source_name": "raw_dh", "source_description": "Definitive Healthcare (DH/DHC) source tables", "loader": "", "identifier": "PRELAND_DH_PHYSICIAN_GROUP_PRACTICE_LOCATION", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "loaded_at_query": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "DH Practice Location data (L4 level)", "columns": {"PRACTICE_LOCATION_ID": {"name": "PRACTICE_LOCATION_ID", "description": "Practice location DH ID (L4)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PRACTICE_LOCATION_NAME": {"name": "PRACTICE_LOCATION_NAME", "description": "Practice location name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PRACTICE_LOCATION_ADDRESS": {"name": "PRACTICE_LOCATION_ADDRESS", "description": "Address line 1", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PRACTICE_LOCATION_ADDRESS1": {"name": "PRACTICE_LOCATION_ADDRESS1", "description": "Address line 2", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PRACTICE_LOCATION_CITY": {"name": "PRACTICE_LOCATION_CITY", "description": "City", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PRACTICE_LOCATION_STATE": {"name": "PRACTICE_LOCATION_STATE", "description": "State", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PRACTICE_LOCATION_ZIP_CODE": {"name": "PRACTICE_LOCATION_ZIP_CODE", "description": "ZIP code", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "DEFINITIVE_ID": {"name": "DEFINITIVE_ID", "description": "Parent organization DH ID (L3)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "LOAD_DATE": {"name": "LOAD_DATE", "description": "Data load timestamp", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true, "event_time": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "patch_path": null, "unrendered_config": {"loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "relation_name": "CGONCOLOGY_DEV.MODEL.PRELAND_DH_PHYSICIAN_GROUP_PRACTICE_LOCATION", "created_at": 1770177079.7857978, "unrendered_database": "CGONCOLOGY_DEV", "unrendered_schema": "MODEL", "doc_blocks": []}, "source.CGOncology_MDM.raw_dh.PRELAND_DH_PHYSICIANS_FACILITY_AFFILIATION": {"database": "CGONCOLOGY_DEV", "schema": "MODEL", "name": "PRELAND_DH_PHYSICIANS_FACILITY_AFFILIATION", "resource_type": "source", "package_name": "CGOncology_MDM", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "unique_id": "source.CGOncology_MDM.raw_dh.PRELAND_DH_PHYSICIANS_FACILITY_AFFILIATION", "fqn": ["CGOncology_MDM", "raw_dh", "PRELAND_DH_PHYSICIANS_FACILITY_AFFILIATION"], "source_name": "raw_dh", "source_description": "Definitive Healthcare (DH/DHC) source tables", "loader": "", "identifier": "PRELAND_DH_PHYSICIANS_FACILITY_AFFILIATION", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "loaded_at_query": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "DH HCP-HCO Affiliation data (physician to facility relationships)", "columns": {"NPI": {"name": "NPI", "description": "Physician NPI", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "DEFINITIVE_ID": {"name": "DEFINITIVE_ID", "description": "Affiliated facility DH ID", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "AFFILIATION_TYPE": {"name": "AFFILIATION_TYPE", "description": "Type of affiliation", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "LOAD_DATE": {"name": "LOAD_DATE", "description": "Data load timestamp", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true, "event_time": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "patch_path": null, "unrendered_config": {"loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "relation_name": "CGONCOLOGY_DEV.MODEL.PRELAND_DH_PHYSICIANS_FACILITY_AFFILIATION", "created_at": 1770177079.785981, "unrendered_database": "CGONCOLOGY_DEV", "unrendered_schema": "MODEL", "doc_blocks": []}, "source.CGOncology_MDM.raw_dh.PRELAND_DH_FACILITY_TO_FACILITY_AFFILIATION": {"database": "CGONCOLOGY_DEV", "schema": "MODEL", "name": "PRELAND_DH_FACILITY_TO_FACILITY_AFFILIATION", "resource_type": "source", "package_name": "CGOncology_MDM", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "unique_id": "source.CGOncology_MDM.raw_dh.PRELAND_DH_FACILITY_TO_FACILITY_AFFILIATION", "fqn": ["CGOncology_MDM", "raw_dh", "PRELAND_DH_FACILITY_TO_FACILITY_AFFILIATION"], "source_name": "raw_dh", "source_description": "Definitive Healthcare (DH/DHC) source tables", "loader": "", "identifier": "PRELAND_DH_FACILITY_TO_FACILITY_AFFILIATION", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "loaded_at_query": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "DH Facility-to-Facility Affiliation data (for MSO PE lookup - MSO-001)", "columns": {"DH_ID": {"name": "DH_ID", "description": "Source facility DH ID", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "ORG_NAME": {"name": "ORG_NAME", "description": "Source organization name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "FIRM_TYPE": {"name": "FIRM_TYPE", "description": "Source firm type", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "NETWORK_ID": {"name": "NETWORK_ID", "description": "Network ID", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "NETWORK_NAME": {"name": "NETWORK_NAME", "description": "Network name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "NETWORK_PARENT_ID": {"name": "NETWORK_PARENT_ID", "description": "Network parent ID", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "NETWORK_PARENT_NAME": {"name": "NETWORK_PARENT_NAME", "description": "Network parent name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "AFFILIATED_ID": {"name": "AFFILIATED_ID", "description": "Affiliated facility DH ID", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "AFFILIATED_NAME": {"name": "AFFILIATED_NAME", "description": "Affiliated facility name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "AFFILIATED_FIRM_TYPE": {"name": "AFFILIATED_FIRM_TYPE", "description": "Affiliated facility firm type (look for 'Management Services Organization')", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "LOAD_DATE": {"name": "LOAD_DATE", "description": "Data load timestamp", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true, "event_time": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "patch_path": null, "unrendered_config": {"loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "relation_name": "CGONCOLOGY_DEV.MODEL.PRELAND_DH_FACILITY_TO_FACILITY_AFFILIATION", "created_at": 1770177079.78617, "unrendered_database": "CGONCOLOGY_DEV", "unrendered_schema": "MODEL", "doc_blocks": []}, "source.CGOncology_MDM.raw_dh.PRELAND_DH_BLADDERCANCER_HXMX_DIAGNOSIS": {"database": "CGONCOLOGY_DEV", "schema": "MODEL", "name": "PRELAND_DH_BLADDERCANCER_HXMX_DIAGNOSIS", "resource_type": "source", "package_name": "CGOncology_MDM", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "unique_id": "source.CGOncology_MDM.raw_dh.PRELAND_DH_BLADDERCANCER_HXMX_DIAGNOSIS", "fqn": ["CGOncology_MDM", "raw_dh", "PRELAND_DH_BLADDERCANCER_HXMX_DIAGNOSIS"], "source_name": "raw_dh", "source_description": "Definitive Healthcare (DH/DHC) source tables", "loader": "", "identifier": "PRELAND_DH_BLADDERCANCER_HXMX_DIAGNOSIS", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "loaded_at_query": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "DH Bladder Cancer Diagnosis (DX) claims data", "columns": {"MX_CLAIM_ID": {"name": "MX_CLAIM_ID", "description": "Diagnosis claim ID (primary key with DIAGNOSIS_CODE)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PATIENT_ID": {"name": "PATIENT_ID", "description": "Patient identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "SERVICE_DATE": {"name": "SERVICE_DATE", "description": "Date of service", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "SERVICE_YEAR": {"name": "SERVICE_YEAR", "description": "Year of service", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "SERVICE_MONTH": {"name": "SERVICE_MONTH", "description": "Month of service", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "CLAIM_TYPE": {"name": "CLAIM_TYPE", "description": "Claim type (e.g., Professional, Institutional)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "DIAGNOSIS_CODE": {"name": "DIAGNOSIS_CODE", "description": "ICD-10 diagnosis code", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "DIAGNOSIS_DESCRIPTION": {"name": "DIAGNOSIS_DESCRIPTION", "description": "Diagnosis code description", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "SERVICE_LOCATION_CODE": {"name": "SERVICE_LOCATION_CODE", "description": "Place of service code", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "SERVICE_LOCATION_DESCRIPTION": {"name": "SERVICE_LOCATION_DESCRIPTION", "description": "Place of service description", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PATIENT_PRIMARY_PAYOR_NAME": {"name": "PATIENT_PRIMARY_PAYOR_NAME", "description": "Primary payor name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PATIENT_PRIMARY_PAYOR_DH_ID": {"name": "PATIENT_PRIMARY_PAYOR_DH_ID", "description": "Primary payor DH ID", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PATIENT_PRIMARY_PAYOR_TYPE": {"name": "PATIENT_PRIMARY_PAYOR_TYPE", "description": "Primary payor type classification", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PATIENT_GENDER": {"name": "PATIENT_GENDER", "description": "Patient gender", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PATIENT_BIRTH_YEAR": {"name": "PATIENT_BIRTH_YEAR", "description": "Patient birth year", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PATIENT_ZIP3": {"name": "PATIENT_ZIP3", "description": "Patient 3-digit ZIP code", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PROVIDER_FACILITY_NPI": {"name": "PROVIDER_FACILITY_NPI", "description": "Facility NPI (TEXT type)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PROVIDER_BILLING_NPI": {"name": "PROVIDER_BILLING_NPI", "description": "Billing provider NPI (TEXT type)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PROVIDER_BILLING_DH_ID": {"name": "PROVIDER_BILLING_DH_ID", "description": "Billing provider DH ID", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PROVIDER_RENDERING_NPI": {"name": "PROVIDER_RENDERING_NPI", "description": "Rendering provider NPI (TEXT type)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "DELIVERABLE": {"name": "DELIVERABLE", "description": "Source data batch identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true, "event_time": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "patch_path": null, "unrendered_config": {"loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "relation_name": "CGONCOLOGY_DEV.MODEL.PRELAND_DH_BLADDERCANCER_HXMX_DIAGNOSIS", "created_at": 1770177079.7863739, "unrendered_database": "CGONCOLOGY_DEV", "unrendered_schema": "MODEL", "doc_blocks": []}, "source.CGOncology_MDM.raw_dh.PRELAND_DH_BLADDERCANCER_HXMX_PROCEDURE": {"database": "CGONCOLOGY_DEV", "schema": "MODEL", "name": "PRELAND_DH_BLADDERCANCER_HXMX_PROCEDURE", "resource_type": "source", "package_name": "CGOncology_MDM", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "unique_id": "source.CGOncology_MDM.raw_dh.PRELAND_DH_BLADDERCANCER_HXMX_PROCEDURE", "fqn": ["CGOncology_MDM", "raw_dh", "PRELAND_DH_BLADDERCANCER_HXMX_PROCEDURE"], "source_name": "raw_dh", "source_description": "Definitive Healthcare (DH/DHC) source tables", "loader": "", "identifier": "PRELAND_DH_BLADDERCANCER_HXMX_PROCEDURE", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "loaded_at_query": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "DH Bladder Cancer Procedure (PX) claims data", "columns": {"PX_CLAIM_ID": {"name": "PX_CLAIM_ID", "description": "Procedure claim ID (primary key with PROCEDURE_CODE)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PATIENT_ID": {"name": "PATIENT_ID", "description": "Patient identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "SERVICE_DATE": {"name": "SERVICE_DATE", "description": "Date of service", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "SERVICE_YEAR": {"name": "SERVICE_YEAR", "description": "Year of service", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "SERVICE_MONTH": {"name": "SERVICE_MONTH", "description": "Month of service", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "CLAIM_TYPE": {"name": "CLAIM_TYPE", "description": "Claim type (e.g., Professional, Institutional)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PROCEDURE_CODE": {"name": "PROCEDURE_CODE", "description": "CPT/HCPCS procedure code", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PROCEDURE_CODE_TYPE": {"name": "PROCEDURE_CODE_TYPE", "description": "Procedure code type classification", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PROCEDURE_DESCRIPTION": {"name": "PROCEDURE_DESCRIPTION", "description": "Procedure code description", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "NDC11": {"name": "NDC11", "description": "11-digit NDC code (for drug-related procedures)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PRODUCT_NAME": {"name": "PRODUCT_NAME", "description": "Product name (for drug-related procedures)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PATIENT_PRIMARY_PAYOR_NAME": {"name": "PATIENT_PRIMARY_PAYOR_NAME", "description": "Primary payor name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PATIENT_PRIMARY_PAYOR_DH_ID": {"name": "PATIENT_PRIMARY_PAYOR_DH_ID", "description": "Primary payor DH ID", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PATIENT_PRIMARY_PAYOR_TYPE": {"name": "PATIENT_PRIMARY_PAYOR_TYPE", "description": "Primary payor type classification", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PATIENT_GENDER": {"name": "PATIENT_GENDER", "description": "Patient gender", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PATIENT_BIRTH_YEAR": {"name": "PATIENT_BIRTH_YEAR", "description": "Patient birth year", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PATIENT_ZIP3": {"name": "PATIENT_ZIP3", "description": "Patient 3-digit ZIP code", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PROVIDER_FACILITY_NPI": {"name": "PROVIDER_FACILITY_NPI", "description": "Facility NPI (NUMBER type)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PROVIDER_BILLING_NPI": {"name": "PROVIDER_BILLING_NPI", "description": "Billing provider NPI (NUMBER type)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PROVIDER_BILLING_DH_ID": {"name": "PROVIDER_BILLING_DH_ID", "description": "Billing provider DH ID", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PROVIDER_RENDERING_NPI": {"name": "PROVIDER_RENDERING_NPI", "description": "Rendering provider NPI (NUMBER type)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "DELIVERABLE": {"name": "DELIVERABLE", "description": "Source data batch identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true, "event_time": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "patch_path": null, "unrendered_config": {"loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "relation_name": "CGONCOLOGY_DEV.MODEL.PRELAND_DH_BLADDERCANCER_HXMX_PROCEDURE", "created_at": 1770177079.786577, "unrendered_database": "CGONCOLOGY_DEV", "unrendered_schema": "MODEL", "doc_blocks": []}, "source.CGOncology_MDM.raw_dh.PRELAND_DH_BLADDERCANCER_RX": {"database": "CGONCOLOGY_DEV", "schema": "MODEL", "name": "PRELAND_DH_BLADDERCANCER_RX", "resource_type": "source", "package_name": "CGOncology_MDM", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "unique_id": "source.CGOncology_MDM.raw_dh.PRELAND_DH_BLADDERCANCER_RX", "fqn": ["CGOncology_MDM", "raw_dh", "PRELAND_DH_BLADDERCANCER_RX"], "source_name": "raw_dh", "source_description": "Definitive Healthcare (DH/DHC) source tables", "loader": "", "identifier": "PRELAND_DH_BLADDERCANCER_RX", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "loaded_at_query": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "DH Bladder Cancer Prescription (RX) claims data", "columns": {"RX_CLAIM_ID": {"name": "RX_CLAIM_ID", "description": "RX claim ID (primary key with NDC11)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PATIENT_ID": {"name": "PATIENT_ID", "description": "Patient identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "FILL_DATE": {"name": "FILL_DATE", "description": "Prescription fill date", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "FILL_YEAR": {"name": "FILL_YEAR", "description": "Fill year", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "FILL_MONTH": {"name": "FILL_MONTH", "description": "Fill month", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "NDC11": {"name": "NDC11", "description": "11-digit NDC code", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PRODUCT_NAME": {"name": "PRODUCT_NAME", "description": "Product name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "BRAND_NAME": {"name": "BRAND_NAME", "description": "Brand name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "GENERIC_NAME": {"name": "GENERIC_NAME", "description": "Generic name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PRODUCT_FORM": {"name": "PRODUCT_FORM", "description": "Product dosage form", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PRODUCT_STRENGTH": {"name": "PRODUCT_STRENGTH", "description": "Product strength", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PATIENT_PRIMARY_PAYOR_NAME": {"name": "PATIENT_PRIMARY_PAYOR_NAME", "description": "Primary payor name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PATIENT_PRIMARY_PAYOR_DH_ID": {"name": "PATIENT_PRIMARY_PAYOR_DH_ID", "description": "Primary payor DH ID", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PATIENT_PRIMARY_PAYOR_TYPE": {"name": "PATIENT_PRIMARY_PAYOR_TYPE", "description": "Primary payor type classification", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PATIENT_GENDER": {"name": "PATIENT_GENDER", "description": "Patient gender", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PATIENT_BIRTH_YEAR": {"name": "PATIENT_BIRTH_YEAR", "description": "Patient birth year", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PATIENT_ZIP3": {"name": "PATIENT_ZIP3", "description": "Patient 3-digit ZIP code", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PROVIDER_PRESCRIBING_NPI": {"name": "PROVIDER_PRESCRIBING_NPI", "description": "Prescribing provider NPI (NUMBER type)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true, "event_time": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "patch_path": null, "unrendered_config": {"loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "relation_name": "CGONCOLOGY_DEV.MODEL.PRELAND_DH_BLADDERCANCER_RX", "created_at": 1770177079.786774, "unrendered_database": "CGONCOLOGY_DEV", "unrendered_schema": "MODEL", "doc_blocks": []}, "source.CGOncology_MDM.raw_dh.PRELAND_CG_ONCOLOGY_FULL_MATCHING_RETURN_20241025": {"database": "CGONCOLOGY_DEV", "schema": "MODEL", "name": "PRELAND_CG_ONCOLOGY_FULL_MATCHING_RETURN_20241025", "resource_type": "source", "package_name": "CGOncology_MDM", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "unique_id": "source.CGOncology_MDM.raw_dh.PRELAND_CG_ONCOLOGY_FULL_MATCHING_RETURN_20241025", "fqn": ["CGOncology_MDM", "raw_dh", "PRELAND_CG_ONCOLOGY_FULL_MATCHING_RETURN_20241025"], "source_name": "raw_dh", "source_description": "Definitive Healthcare (DH/DHC) source tables", "loader": "", "identifier": "PRELAND_CG_ONCOLOGY_FULL_MATCHING_RETURN_20241025", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "loaded_at_query": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "DH Matching Return file - stewardship-verified DDD-to-DH matches (Oct 2024)", "columns": {"ID": {"name": "ID", "description": "DDD outlet number (needs LPAD to 8 chars)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "HOSPITAL_ID": {"name": "HOSPITAL_ID", "description": "Matched DH organization ID", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "OUTLET_NAME": {"name": "OUTLET_NAME", "description": "DDD outlet name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "ADDRESS": {"name": "ADDRESS", "description": "DDD outlet address", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true, "event_time": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "patch_path": null, "unrendered_config": {"loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "relation_name": "CGONCOLOGY_DEV.MODEL.PRELAND_CG_ONCOLOGY_FULL_MATCHING_RETURN_20241025", "created_at": 1770177079.786953, "unrendered_database": "CGONCOLOGY_DEV", "unrendered_schema": "MODEL", "doc_blocks": []}, "source.CGOncology_MDM.raw_medscout.PRELAND_MEDSCOUT_HCO_DATA": {"database": "CGONCOLOGY_DEV", "schema": "MODEL", "name": "PRELAND_MEDSCOUT_HCO_DATA", "resource_type": "source", "package_name": "CGOncology_MDM", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "unique_id": "source.CGOncology_MDM.raw_medscout.PRELAND_MEDSCOUT_HCO_DATA", "fqn": ["CGOncology_MDM", "raw_medscout", "PRELAND_MEDSCOUT_HCO_DATA"], "source_name": "raw_medscout", "source_description": "Medscout HCO and HCP data source tables", "loader": "", "identifier": "PRELAND_MEDSCOUT_HCO_DATA", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "loaded_at_query": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "Medscout HCO (Healthcare Organization) data with claims metrics", "columns": {"NPI": {"name": "NPI", "description": "Organization NPI number", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "NAME": {"name": "NAME", "description": "Organization name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "CITY": {"name": "CITY", "description": "City", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "STATE": {"name": "STATE", "description": "State", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "SPECIALTY": {"name": "SPECIALTY", "description": "Organization specialty", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "TYPE": {"name": "TYPE", "description": "Facility type", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "TOTAL_01_BLADDER_CANCER_DIAGNOSIS_CLAIMS": {"name": "TOTAL_01_BLADDER_CANCER_DIAGNOSIS_CLAIMS", "description": "Bladder cancer diagnosis claims total", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "TOTAL_01_BLADDER_CANCER_DIAGNOSIS_PATIENTS": {"name": "TOTAL_01_BLADDER_CANCER_DIAGNOSIS_PATIENTS", "description": "Bladder cancer diagnosis patients total", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "TOTAL_02_CYSTOSCOPY_CLAIMS": {"name": "TOTAL_02_CYSTOSCOPY_CLAIMS", "description": "Cystoscopy claims total", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "TOTAL_02_CYSTOSCOPY_PATIENTS": {"name": "TOTAL_02_CYSTOSCOPY_PATIENTS", "description": "Cystoscopy patients total", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "TOTAL_03_TURBT_CLAIMS": {"name": "TOTAL_03_TURBT_CLAIMS", "description": "TURBT claims total", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "TOTAL_03_TURBT_PATIENTS": {"name": "TOTAL_03_TURBT_PATIENTS", "description": "TURBT patients total", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "TOTAL_04_TICE_BCG_CLAIMS": {"name": "TOTAL_04_TICE_BCG_CLAIMS", "description": "TICE BCG claims total", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "TOTAL_04_TICE_BCG_PATIENTS": {"name": "TOTAL_04_TICE_BCG_PATIENTS", "description": "TICE BCG patients total", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "TOTAL_05_ADSTILADRIN_CLAIMS": {"name": "TOTAL_05_ADSTILADRIN_CLAIMS", "description": "Adstiladrin claims total", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "TOTAL_05_ADSTILADRIN_PATIENTS": {"name": "TOTAL_05_ADSTILADRIN_PATIENTS", "description": "Adstiladrin patients total", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "TOTAL_06_KEYTRUDA_CLAIMS": {"name": "TOTAL_06_KEYTRUDA_CLAIMS", "description": "Keytruda claims total", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "TOTAL_06_KEYTRUDA_PATIENTS": {"name": "TOTAL_06_KEYTRUDA_PATIENTS", "description": "Keytruda patients total", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "LOAD_DATE": {"name": "LOAD_DATE", "description": "Data load timestamp", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true, "event_time": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "patch_path": null, "unrendered_config": {"loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "relation_name": "CGONCOLOGY_DEV.MODEL.PRELAND_MEDSCOUT_HCO_DATA", "created_at": 1770177079.7871518, "unrendered_database": "CGONCOLOGY_DEV", "unrendered_schema": "MODEL", "doc_blocks": []}, "source.CGOncology_MDM.raw_medscout.PRELAND_MEDSCOUT_HCP_DATA": {"database": "CGONCOLOGY_DEV", "schema": "MODEL", "name": "PRELAND_MEDSCOUT_HCP_DATA", "resource_type": "source", "package_name": "CGOncology_MDM", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "unique_id": "source.CGOncology_MDM.raw_medscout.PRELAND_MEDSCOUT_HCP_DATA", "fqn": ["CGOncology_MDM", "raw_medscout", "PRELAND_MEDSCOUT_HCP_DATA"], "source_name": "raw_medscout", "source_description": "Medscout HCO and HCP data source tables", "loader": "", "identifier": "PRELAND_MEDSCOUT_HCP_DATA", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "loaded_at_query": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "Medscout HCP (Healthcare Provider) data", "columns": {"MEDSCOUT_ID": {"name": "MEDSCOUT_ID", "description": "Medscout provider ID", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "NPI": {"name": "NPI", "description": "National Provider Identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "FIRST_NAME": {"name": "FIRST_NAME", "description": "Provider first name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "LAST_NAME": {"name": "LAST_NAME", "description": "Provider last name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "SPECIALTY": {"name": "SPECIALTY", "description": "Provider specialty", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "CITY": {"name": "CITY", "description": "City", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "STATE": {"name": "STATE", "description": "State", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "LOAD_DATE": {"name": "LOAD_DATE", "description": "Data load timestamp", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true, "event_time": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "patch_path": null, "unrendered_config": {"loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "relation_name": "CGONCOLOGY_DEV.MODEL.PRELAND_MEDSCOUT_HCP_DATA", "created_at": 1770177079.787337, "unrendered_database": "CGONCOLOGY_DEV", "unrendered_schema": "MODEL", "doc_blocks": []}, "source.CGOncology_MDM.raw_ddd.PRELAND_DDD_DEMOGRAPHICS": {"database": "CGONCOLOGY_DEV", "schema": "MODEL", "name": "PRELAND_DDD_DEMOGRAPHICS", "resource_type": "source", "package_name": "CGOncology_MDM", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "unique_id": "source.CGOncology_MDM.raw_ddd.PRELAND_DDD_DEMOGRAPHICS", "fqn": ["CGOncology_MDM", "raw_ddd", "PRELAND_DDD_DEMOGRAPHICS"], "source_name": "raw_ddd", "source_description": "DDD (Drug Distribution Data) source tables", "loader": "", "identifier": "PRELAND_DDD_DEMOGRAPHICS", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "loaded_at_query": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "DDD outlet demographics and address data", "columns": {"DDD_OUTLET_NO": {"name": "DDD_OUTLET_NO", "description": "DDD outlet number (primary key)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "DDD_OUTLET_NAME": {"name": "DDD_OUTLET_NAME", "description": "Outlet name", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "DDD_OUTLET_ADDRESS": {"name": "DDD_OUTLET_ADDRESS", "description": "Street address", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "DDD_OUTLET_CITY": {"name": "DDD_OUTLET_CITY", "description": "City", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "DDD_OUTLET_ST": {"name": "DDD_OUTLET_ST", "description": "State (2-char code)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "DDD_OUTLET_ZIP": {"name": "DDD_OUTLET_ZIP", "description": "ZIP code", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "LOAD_DATE": {"name": "LOAD_DATE", "description": "Data load timestamp", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true, "event_time": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "patch_path": null, "unrendered_config": {"loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "relation_name": "CGONCOLOGY_DEV.MODEL.PRELAND_DDD_DEMOGRAPHICS", "created_at": 1770177079.787522, "unrendered_database": "CGONCOLOGY_DEV", "unrendered_schema": "MODEL", "doc_blocks": []}, "source.CGOncology_MDM.raw_ddd.PRELAND_DDD_SALES": {"database": "CGONCOLOGY_DEV", "schema": "MODEL", "name": "PRELAND_DDD_SALES", "resource_type": "source", "package_name": "CGOncology_MDM", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "unique_id": "source.CGOncology_MDM.raw_ddd.PRELAND_DDD_SALES", "fqn": ["CGOncology_MDM", "raw_ddd", "PRELAND_DDD_SALES"], "source_name": "raw_ddd", "source_description": "DDD (Drug Distribution Data) source tables", "loader": "", "identifier": "PRELAND_DDD_SALES", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "loaded_at_query": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "DDD sales data with monthly dollar amounts by product group", "columns": {"DDD_OUTLET_NUMBER": {"name": "DDD_OUTLET_NUMBER", "description": "DDD outlet number (foreign key to demographics)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "DDD_SUBCATEGORY_CODE": {"name": "DDD_SUBCATEGORY_CODE", "description": "DDD sub-category code (e.g., D9=Clinics, H1=Hospitals, S5=Mail Service)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "PRODUCT_GROUP_ID": {"name": "PRODUCT_GROUP_ID", "description": "Product group identifier (1=ADSTILADRIN, 2=ANKTIVA, 3/4=TICE BCG, 7=INLEXZO)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "DATA_DATE": {"name": "DATA_DATE", "description": "Report data date (end of reporting period)", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "DOLLAR_AMT_MONTH_1": {"name": "DOLLAR_AMT_MONTH_1", "description": "Sales amount for most recent month", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "DOLLAR_AMT_MONTH_2": {"name": "DOLLAR_AMT_MONTH_2", "description": "Sales amount for month 2", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "DOLLAR_AMT_MONTH_12": {"name": "DOLLAR_AMT_MONTH_12", "description": "Sales amount for month 12", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "DOLLAR_AMT_MONTH_24": {"name": "DOLLAR_AMT_MONTH_24", "description": "Sales amount for month 24", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "LOAD_DATE": {"name": "LOAD_DATE", "description": "Data load timestamp", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true, "event_time": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "patch_path": null, "unrendered_config": {"loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "relation_name": "CGONCOLOGY_DEV.MODEL.PRELAND_DDD_SALES", "created_at": 1770177079.7877069, "unrendered_database": "CGONCOLOGY_DEV", "unrendered_schema": "MODEL", "doc_blocks": []}, "source.CGOncology_MDM.cgoncology_dev_adm.HCP_AISSEL": {"database": "CGONCOLOGY_DEV", "schema": "ADM", "name": "HCP_AISSEL", "resource_type": "source", "package_name": "CGOncology_MDM", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "unique_id": "source.CGOncology_MDM.cgoncology_dev_adm.HCP_AISSEL", "fqn": ["CGOncology_MDM", "cgoncology_dev_adm", "HCP_AISSEL"], "source_name": "cgoncology_dev_adm", "source_description": "Legacy ADM tables from CGONCOLOGY_DEV", "loader": "", "identifier": "HCP_AISSEL", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "loaded_at_query": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "HCP Aissel/Konectar rankings and metrics", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true, "event_time": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "patch_path": null, "unrendered_config": {"loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "relation_name": "CGONCOLOGY_DEV.ADM.HCP_AISSEL", "created_at": 1770177079.787877, "unrendered_database": "CGONCOLOGY_DEV", "unrendered_schema": "ADM", "doc_blocks": []}, "source.CGOncology_MDM.cgoncology_dev_adm.MEDICAL_INTERACTIONS": {"database": "CGONCOLOGY_DEV", "schema": "ADM", "name": "MEDICAL_INTERACTIONS", "resource_type": "source", "package_name": "CGOncology_MDM", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "unique_id": "source.CGOncology_MDM.cgoncology_dev_adm.MEDICAL_INTERACTIONS", "fqn": ["CGOncology_MDM", "cgoncology_dev_adm", "MEDICAL_INTERACTIONS"], "source_name": "cgoncology_dev_adm", "source_description": "Legacy ADM tables from CGONCOLOGY_DEV", "loader": "", "identifier": "MEDICAL_INTERACTIONS", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "loaded_at_query": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "Medical interaction logs", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true, "event_time": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "patch_path": null, "unrendered_config": {"loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "relation_name": "CGONCOLOGY_DEV.ADM.MEDICAL_INTERACTIONS", "created_at": 1770177079.788051, "unrendered_database": "CGONCOLOGY_DEV", "unrendered_schema": "ADM", "doc_blocks": []}, "source.CGOncology_MDM.cgoncology_dev_adm.MEDICAL_INSIGHTS": {"database": "CGONCOLOGY_DEV", "schema": "ADM", "name": "MEDICAL_INSIGHTS", "resource_type": "source", "package_name": "CGOncology_MDM", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "unique_id": "source.CGOncology_MDM.cgoncology_dev_adm.MEDICAL_INSIGHTS", "fqn": ["CGOncology_MDM", "cgoncology_dev_adm", "MEDICAL_INSIGHTS"], "source_name": "cgoncology_dev_adm", "source_description": "Legacy ADM tables from CGONCOLOGY_DEV", "loader": "", "identifier": "MEDICAL_INSIGHTS", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "loaded_at_query": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "Medical insight logs", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true, "event_time": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "patch_path": null, "unrendered_config": {"loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "relation_name": "CGONCOLOGY_DEV.ADM.MEDICAL_INSIGHTS", "created_at": 1770177079.788227, "unrendered_database": "CGONCOLOGY_DEV", "unrendered_schema": "ADM", "doc_blocks": []}, "source.CGOncology_MDM.cgoncology_dev_reporting.ACTIVITY_DASHBOARD_METRICS": {"database": "CGONCOLOGY_DEV", "schema": "REPORTING", "name": "ACTIVITY_DASHBOARD_METRICS", "resource_type": "source", "package_name": "CGOncology_MDM", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "unique_id": "source.CGOncology_MDM.cgoncology_dev_reporting.ACTIVITY_DASHBOARD_METRICS", "fqn": ["CGOncology_MDM", "cgoncology_dev_reporting", "ACTIVITY_DASHBOARD_METRICS"], "source_name": "cgoncology_dev_reporting", "source_description": "CGONCOLOGY_DEV reporting layer - pre-aggregated HCP and patient views", "loader": "", "identifier": "ACTIVITY_DASHBOARD_METRICS", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "loaded_at_query": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "Activity dashboard metrics for profiling data", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true, "event_time": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "patch_path": null, "unrendered_config": {"loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "relation_name": "CGONCOLOGY_DEV.REPORTING.ACTIVITY_DASHBOARD_METRICS", "created_at": 1770177079.788401, "unrendered_database": "CGONCOLOGY_DEV", "unrendered_schema": "REPORTING", "doc_blocks": []}, "source.CGOncology_MDM.cgoncology_dev_reporting.CLINICAL_TRIAL_DATA": {"database": "CGONCOLOGY_DEV", "schema": "REPORTING", "name": "CLINICAL_TRIAL_DATA", "resource_type": "source", "package_name": "CGOncology_MDM", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "unique_id": "source.CGOncology_MDM.cgoncology_dev_reporting.CLINICAL_TRIAL_DATA", "fqn": ["CGOncology_MDM", "cgoncology_dev_reporting", "CLINICAL_TRIAL_DATA"], "source_name": "cgoncology_dev_reporting", "source_description": "CGONCOLOGY_DEV reporting layer - pre-aggregated HCP and patient views", "loader": "", "identifier": "CLINICAL_TRIAL_DATA", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "loaded_at_query": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "Clinical trial investigator data", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true, "event_time": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "patch_path": null, "unrendered_config": {"loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "relation_name": "CGONCOLOGY_DEV.REPORTING.CLINICAL_TRIAL_DATA", "created_at": 1770177079.788577, "unrendered_database": "CGONCOLOGY_DEV", "unrendered_schema": "REPORTING", "doc_blocks": []}, "source.CGOncology_MDM.cgoncology_dev_reporting.HCP_VIEW_DETAIL_TABLE": {"database": "CGONCOLOGY_DEV", "schema": "REPORTING", "name": "HCP_VIEW_DETAIL_TABLE", "resource_type": "source", "package_name": "CGOncology_MDM", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "unique_id": "source.CGOncology_MDM.cgoncology_dev_reporting.HCP_VIEW_DETAIL_TABLE", "fqn": ["CGOncology_MDM", "cgoncology_dev_reporting", "HCP_VIEW_DETAIL_TABLE"], "source_name": "cgoncology_dev_reporting", "source_description": "CGONCOLOGY_DEV reporting layer - pre-aggregated HCP and patient views", "loader": "", "identifier": "HCP_VIEW_DETAIL_TABLE", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "loaded_at_query": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "HCP detail view with claims metrics for decile calculation", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true, "event_time": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "patch_path": null, "unrendered_config": {"loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "relation_name": "CGONCOLOGY_DEV.REPORTING.HCP_VIEW_DETAIL_TABLE", "created_at": 1770177079.7887528, "unrendered_database": "CGONCOLOGY_DEV", "unrendered_schema": "REPORTING", "doc_blocks": []}, "source.CGOncology_MDM.staging.ADMIN_SITE_TARGET_LIST_ACCT_ID": {"database": "CGONCOLOGY_DEV", "schema": "STAGING", "name": "ADMIN_SITE_TARGET_LIST_ACCT_ID", "resource_type": "source", "package_name": "CGOncology_MDM", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "unique_id": "source.CGOncology_MDM.staging.ADMIN_SITE_TARGET_LIST_ACCT_ID", "fqn": ["CGOncology_MDM", "staging", "ADMIN_SITE_TARGET_LIST_ACCT_ID"], "source_name": "staging", "source_description": "CGONCOLOGY_DEV staging layer - SFE target lists", "loader": "", "identifier": "ADMIN_SITE_TARGET_LIST_ACCT_ID", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "loaded_at_query": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "KAM Network target list with deciles (L1/L2 accounts)", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true, "event_time": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "patch_path": null, "unrendered_config": {"loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "relation_name": "CGONCOLOGY_DEV.STAGING.ADMIN_SITE_TARGET_LIST_ACCT_ID", "created_at": 1770177079.788929, "unrendered_database": "CGONCOLOGY_DEV", "unrendered_schema": "STAGING", "doc_blocks": []}, "source.CGOncology_MDM.staging.CHILD_SITE_TARGET_LIST_ACCT_ID": {"database": "CGONCOLOGY_DEV", "schema": "STAGING", "name": "CHILD_SITE_TARGET_LIST_ACCT_ID", "resource_type": "source", "package_name": "CGOncology_MDM", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "unique_id": "source.CGOncology_MDM.staging.CHILD_SITE_TARGET_LIST_ACCT_ID", "fqn": ["CGOncology_MDM", "staging", "CHILD_SITE_TARGET_LIST_ACCT_ID"], "source_name": "staging", "source_description": "CGONCOLOGY_DEV staging layer - SFE target lists", "loader": "", "identifier": "CHILD_SITE_TARGET_LIST_ACCT_ID", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "loaded_at_query": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "KAM Child target list with deciles (L3 accounts)", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true, "event_time": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "patch_path": null, "unrendered_config": {"loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "relation_name": "CGONCOLOGY_DEV.STAGING.CHILD_SITE_TARGET_LIST_ACCT_ID", "created_at": 1770177079.7891042, "unrendered_database": "CGONCOLOGY_DEV", "unrendered_schema": "STAGING", "doc_blocks": []}, "source.CGOncology_MDM.staging.CG_ONCOLOGY_HCP_TARGETING_LIST": {"database": "CGONCOLOGY_DEV", "schema": "STAGING", "name": "CG_ONCOLOGY_HCP_TARGETING_LIST", "resource_type": "source", "package_name": "CGOncology_MDM", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "unique_id": "source.CGOncology_MDM.staging.CG_ONCOLOGY_HCP_TARGETING_LIST", "fqn": ["CGOncology_MDM", "staging", "CG_ONCOLOGY_HCP_TARGETING_LIST"], "source_name": "staging", "source_description": "CGONCOLOGY_DEV staging layer - SFE target lists", "loader": "", "identifier": "CG_ONCOLOGY_HCP_TARGETING_LIST", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "loaded_at_query": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "HCP target list with deciles", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true, "event_time": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "patch_path": null, "unrendered_config": {"loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "relation_name": "CGONCOLOGY_DEV.STAGING.CG_ONCOLOGY_HCP_TARGETING_LIST", "created_at": 1770177079.789276, "unrendered_database": "CGONCOLOGY_DEV", "unrendered_schema": "STAGING", "doc_blocks": []}, "source.CGOncology_MDM.cgoncology_prod_analytical.HSD_TARGET_UNIVERSE_UPDATED_RANK": {"database": "CGONCOLOGY_PROD", "schema": "ANALYTICAL", "name": "HSD_TARGET_UNIVERSE_UPDATED_RANK", "resource_type": "source", "package_name": "CGOncology_MDM", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "unique_id": "source.CGOncology_MDM.cgoncology_prod_analytical.HSD_TARGET_UNIVERSE_UPDATED_RANK", "fqn": ["CGOncology_MDM", "cgoncology_prod_analytical", "HSD_TARGET_UNIVERSE_UPDATED_RANK"], "source_name": "cgoncology_prod_analytical", "source_description": "CGONCOLOGY_PROD analytical layer - HSD and MSL targets", "loader": "", "identifier": "HSD_TARGET_UNIVERSE_UPDATED_RANK", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "loaded_at_query": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "HSD target universe with national rankings", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true, "event_time": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "patch_path": null, "unrendered_config": {"loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "relation_name": "CGONCOLOGY_PROD.ANALYTICAL.HSD_TARGET_UNIVERSE_UPDATED_RANK", "created_at": 1770177079.7894511, "unrendered_database": "CGONCOLOGY_PROD", "unrendered_schema": "ANALYTICAL", "doc_blocks": []}, "source.CGOncology_MDM.cgoncology_prod_analytical.CG_MSL_Target_list": {"database": "CGONCOLOGY_PROD", "schema": "ANALYTICAL", "name": "CG_MSL_Target_list", "resource_type": "source", "package_name": "CGOncology_MDM", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "unique_id": "source.CGOncology_MDM.cgoncology_prod_analytical.CG_MSL_Target_list", "fqn": ["CGOncology_MDM", "cgoncology_prod_analytical", "CG_MSL_Target_list"], "source_name": "cgoncology_prod_analytical", "source_description": "CGONCOLOGY_PROD analytical layer - HSD and MSL targets", "loader": "", "identifier": "CG_MSL_Target_list", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "loaded_at_query": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "MSL target list", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true, "event_time": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "patch_path": null, "unrendered_config": {"loaded_at_field": null, "loaded_at_query": null, "meta": {}, "tags": []}, "relation_name": "CGONCOLOGY_PROD.ANALYTICAL.CG_MSL_Target_list", "created_at": 1770177079.789624, "unrendered_database": "CGONCOLOGY_PROD", "unrendered_schema": "ANALYTICAL", "doc_blocks": []}}, "macros": {"macro.CGOncology_MDM.check_refresh_mode": {"name": "check_refresh_mode", "resource_type": "macro", "package_name": "CGOncology_MDM", "path": "macros/check_refresh_mode.sql", "original_file_path": "macros/check_refresh_mode.sql", "unique_id": "macro.CGOncology_MDM.check_refresh_mode", "macro_sql": "{% macro check_refresh_mode() %}\n  {#\n    Environment Refresh Mode Enforcement\n    ------------------------------------\n    - DEV target: Blocks --full-refresh (incremental only)\n    - TEST target: Allows --full-refresh (always full refresh recommended)\n\n    To override for schema changes in DEV, use:\n      dbt run --target dev --vars '{\"allow_full_refresh_in_dev\": true}'\n\n    IMPORTANT: This hook only blocks explicit --full-refresh via native dbt.\n    It does NOT protect against:\n      1. Table not existing in DEV (dbt treats as initial load = silent full-refresh)\n      2. Python runner (dbt_run_via_python.py) which bypasses dbt hooks entirely\n    The Python runner has its own guard (--allow-initial-load-in-dev flag)\n    that blocks both full-refresh and missing-table scenarios on DEV.\n  #}\n\n  {% set allow_override = var('allow_full_refresh_in_dev', false) %}\n\n  {% if flags.FULL_REFRESH and target.name == 'dev' and not allow_override %}\n    {{ exceptions.raise_compiler_error(\n      \"\\n\" ~\n      \"========================================================\\n\" ~\n      \"ERROR: --full-refresh is blocked in DEV target\\n\" ~\n      \"========================================================\\n\" ~\n      \"\\n\" ~\n      \"DEV environment is for incremental updates only.\\n\" ~\n      \"\\n\" ~\n      \"Options:\\n\" ~\n      \"  1. Use TEST for full refresh:\\n\" ~\n      \"     dbt run --target test --full-refresh --select ...\\n\" ~\n      \"\\n\" ~\n      \"  2. Override for schema changes (use with caution):\\n\" ~\n      \"     dbt run --target dev --full-refresh --vars '{\\\"allow_full_refresh_in_dev\\\": true}' --select ...\\n\" ~\n      \"\\n\" ~\n      \"========================================================\\n\"\n    ) }}\n  {% endif %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.2572129, "supported_languages": null}, "macro.CGOncology_MDM.standardize_address": {"name": "standardize_address", "resource_type": "macro", "package_name": "CGOncology_MDM", "path": "macros/standardize_address.sql", "original_file_path": "macros/standardize_address.sql", "unique_id": "macro.CGOncology_MDM.standardize_address", "macro_sql": "{%- macro standardize_address(column_name) -%}\n{#\n    STD-004: Address Abbreviation Standardization\n\n    This macro applies address standardization rules using DEV's STANDARD_ADDRESS_CONFIG table.\n    It matches DEV's exact behavior: split address into words, lookup each word in config, reassemble.\n\n    MAT-001 Fix: Removes asterisks (*) from addresses before abbreviation standardization.\n    This helps with matching outlets that have asterisks in their addresses.\n\n    NOTE: Uses {{ target.database }}.STAGING.STANDARD_ADDRESS_CONFIG (copied from DEV)\n          to ensure exact match with DEV baseline standardization for ID preservation.\n\n    Usage:\n        {{ standardize_address('HQ_ADDRESS') }}\n        {{ standardize_address('PRACTICE_LOCATION_ADDRESS') }}\n\n    How it works (matches DEV's address_standardization procedure):\n    1. Remove asterisks (MAT-001)\n    2. UPPER and TRIM the address\n    3. Split into words by space\n    4. For each word, lookup in STANDARD_ADDRESS_CONFIG by FULL_FORM\n    5. Replace with ABR if found, otherwise keep original word\n    6. Reassemble words with spaces\n\n    Implementation: Uses Snowflake TRANSFORM + OBJECT_AGG for inline word-by-word lookup\n    (replaces correlated subquery approach which Snowflake does not support in SELECT).\n#}\nARRAY_TO_STRING(\n    TRANSFORM(\n        SPLIT(REGEXP_REPLACE(UPPER(TRIM({{ column_name }})), '\\\\*', ''), ' '),\n        word -> COALESCE(\n            (SELECT OBJECT_AGG(UPPER(FULL_FORM), TO_VARIANT(ABR)) FROM {{ target.database }}.STAGING.STANDARD_ADDRESS_CONFIG)[word]::VARCHAR,\n            word\n        )\n    ),\n    ' '\n){%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.257463, "supported_languages": null}, "macro.CGOncology_MDM.clone_pipeline_backup": {"name": "clone_pipeline_backup", "resource_type": "macro", "package_name": "CGOncology_MDM", "path": "macros/clone_pipeline_backup.sql", "original_file_path": "macros/clone_pipeline_backup.sql", "unique_id": "macro.CGOncology_MDM.clone_pipeline_backup", "macro_sql": "{% macro clone_pipeline_backup() %}\n  {#\n    Pipeline Backup via Zero-Copy CLONE\n    ------------------------------------\n    Clones key MDM/ADM tables to ARCHIVE schema before each pipeline run.\n    Suffix = data_date with hyphens stripped (e.g., 2025-11-30 \u2192 20251130).\n\n    Uses CREATE TABLE IF NOT EXISTS so re-running the same data_date is safe.\n    To force a re-clone, manually DROP the clone table first.\n\n    Each CLONE is executed individually via run_query() because\n    Snowflake's cursor.execute() only handles one statement at a time.\n\n    Safety: Checks each source table exists before cloning, so this\n    macro won't fail on partial pipeline builds (e.g., running only\n    Layer 1 when MDM/ADM tables don't exist yet).\n\n    Triggered via on-run-start in dbt_project.yml.\n  #}\n\n  {% if execute %}\n\n    {% set suffix = var('data_date').replace('-', '') %}\n\n    {% set tables = [\n      ('MDM', 'MDM_CUSTOMER_MASTER_HCO'),\n      ('MDM', 'MDM_CUSTOMER_MASTER_HCP'),\n      ('MDM', 'MDM_BEST_AFFILIATION'),\n      ('MDM', 'MDM_CUSTOMER_XREF_HCO'),\n      ('MDM', 'MDM_CUSTOMER_XREF_HCP'),\n      ('ADM', 'ADM_HCO_MASTER'),\n      ('ADM', 'ADM_HCP_MASTER'),\n      ('ADM', 'ADM_HCO_HIERARCHY'),\n      ('ADM', 'ADM_CLAIMS_METRICS_LONG'),\n      ('ADM', 'ADM_DDD_METRICS_LONG'),\n    ] %}\n\n    {% for schema, table in tables %}\n      {# Check if source table exists before attempting clone #}\n      {% set check_sql = \"SELECT COUNT(*) AS cnt FROM \" ~ target.database ~ \".INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = '\" ~ schema ~ \"' AND TABLE_NAME = '\" ~ table ~ \"'\" %}\n      {% set result = run_query(check_sql) %}\n\n      {% if result and result.rows | length > 0 and result.rows[0][0] > 0 %}\n        {# Always create transient clones - works for both transient and permanent source tables #}\n        {# Transient clones are fine for backups and avoid \"cannot clone transient to permanent\" errors #}\n        {% set clone_sql %}\n          CREATE TRANSIENT TABLE IF NOT EXISTS {{ target.database }}.ARCHIVE.{{ table }}_{{ suffix }}\n            CLONE {{ target.database }}.{{ schema }}.{{ table }}\n        {% endset %}\n        {% do run_query(clone_sql) %}\n      {% endif %}\n    {% endfor %}\n\n  {% endif %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.259087, "supported_languages": null}, "macro.CGOncology_MDM.generate_schema_name": {"name": "generate_schema_name", "resource_type": "macro", "package_name": "CGOncology_MDM", "path": "macros/generate_schema_name.sql", "original_file_path": "macros/generate_schema_name.sql", "unique_id": "macro.CGOncology_MDM.generate_schema_name", "macro_sql": "{% macro generate_schema_name(custom_schema_name, node) -%}\n    {%- if custom_schema_name is none -%}\n        {{ target.schema }}\n    {%- else -%}\n        {{ custom_schema_name }}\n    {%- endif -%}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.259294, "supported_languages": null}, "macro.CGOncology_MDM.standardize_org_name": {"name": "standardize_org_name", "resource_type": "macro", "package_name": "CGOncology_MDM", "path": "macros/standardize_org_name.sql", "original_file_path": "macros/standardize_org_name.sql", "unique_id": "macro.CGOncology_MDM.standardize_org_name", "macro_sql": "{%- macro standardize_org_name(column_name) -%}\n{#\n    Standardizes organization names for matching purposes.\n    Expands common abbreviations to full forms.\n\n    P1: Critical (CTR, HOSP, MED, CL)\n    P2: Medium (GRP, SYS, HLTH, COMM, REG, MEM, UNIV, MT)\n\n    SKIP: ST (STREET/STATE), DR (DRIVE/DOCTOR) - too ambiguous\n    KEEP AS-IS: UCLA, UCSF, NYU, USC - both sources use consistently\n\n    Reference: seeds/config_name_aliases.csv\n#}\nTRIM(REGEXP_REPLACE(\n    REGEXP_REPLACE(\n        REGEXP_REPLACE(\n            REGEXP_REPLACE(\n                REGEXP_REPLACE(\n                    REGEXP_REPLACE(\n                        REGEXP_REPLACE(\n                            REGEXP_REPLACE(\n                                REGEXP_REPLACE(\n                                    REGEXP_REPLACE(\n                                        REGEXP_REPLACE(\n                                            REGEXP_REPLACE(\n                                                REGEXP_REPLACE(\n                                                    REGEXP_REPLACE(\n                                                        REGEXP_REPLACE(\n                                                            REGEXP_REPLACE(\n                                                                REGEXP_REPLACE(\n                                                                    REGEXP_REPLACE(\n                                                                        UPPER(TRIM({{ column_name }})),\n                                                                        -- P1: Critical - suffix patterns first\n                                                                        ' MED CT$', ' MEDICAL CENTER'),\n                                                                    ' MED CTR$', ' MEDICAL CENTER'),\n                                                                ' MED OP$', ' MEDICAL CENTER OUTPATIENT'),\n                                                            ' CL$', ' CLINIC'),\n                                                        -- P1: Critical - word boundary patterns\n                                                        '\\\\bCTR\\\\b', 'CENTER'),\n                                                    '\\\\bCNTR\\\\b', 'CENTER'),\n                                                '\\\\bHOSP\\\\b', 'HOSPITAL'),\n                                            '\\\\bMED\\\\b', 'MEDICAL'),\n                                        -- P2: Medium priority\n                                        '\\\\bHLTH\\\\b', 'HEALTH'),\n                                    '\\\\bSYS\\\\b', 'SYSTEM'),\n                                '\\\\bGRP\\\\b', 'GROUP'),\n                            '\\\\bCOMM\\\\b', 'COMMUNITY'),\n                        '\\\\bREG\\\\b', 'REGIONAL'),\n                    '\\\\bMEM\\\\b', 'MEMORIAL'),\n                '\\\\bUNIV\\\\b', 'UNIVERSITY'),\n            '^MT SINAI', 'MOUNT SINAI'),\n        '^MT ', 'MOUNT '),\n    '  +', ' '))\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.259773, "supported_languages": null}, "macro.CGOncology_MDM.standardize_specialty": {"name": "standardize_specialty", "resource_type": "macro", "package_name": "CGOncology_MDM", "path": "macros/standardize_specialty.sql", "original_file_path": "macros/standardize_specialty.sql", "unique_id": "macro.CGOncology_MDM.standardize_specialty", "macro_sql": "{% macro standardize_specialty(column_name, max_length=100) %}\n{#\n    STD-SPEC-001: Specialty Text Standardization\n    \n    Normalizes specialty text to handle case variations, remove/replace special characters,\n    and control length.\n    \n    Usage:\n        {{ standardize_specialty('SPECIALTY_PRIMARY', 100) }}\n        {{ standardize_specialty('SPECIALTY_PRIMARY_GROUP', 100) }}\n    \n    Parameters:\n        - column_name: Source column to standardize\n        - max_length: Maximum length (default 100, truncates if longer)\n    \n    Normalizations:\n        - Case: \"And\" \u2192 \"and\", \"Or\" \u2192 \"or\", \"Of\" \u2192 \"of\", \"The\" \u2192 \"the\", \"Formerly\" \u2192 \"formerly\", \"Only\" \u2192 \"only\"\n        - Hyphens (-): Replace with space\n        - Slashes (/): Replace with \" and \"\n        - Parentheses (): Remove parentheses and content\n        - Commas (,): Remove\n        - Ampersands (&): Replace with \" and \"\n        - Multiple spaces: Collapse to single space\n        - Length: Truncate to max_length if longer\n        - Trim leading/trailing whitespace\n#}\nCASE\n    WHEN TRIM({{ column_name }}) IS NULL OR TRIM({{ column_name }}) = '' THEN NULL\n    ELSE SUBSTRING(\n        TRIM(REGEXP_REPLACE(\n            REGEXP_REPLACE(\n                REGEXP_REPLACE(\n                    REGEXP_REPLACE(\n                        REGEXP_REPLACE(\n                            REGEXP_REPLACE(\n                                REGEXP_REPLACE(\n                                    REGEXP_REPLACE(\n                                        REGEXP_REPLACE(\n                                            REGEXP_REPLACE(\n                                                REGEXP_REPLACE(\n                                                    REGEXP_REPLACE(\n                                                        TRIM({{ column_name }}),\n                                                        -- Remove parentheses and their content\n                                                        '\\\\s*\\\\([^)]*\\\\)\\\\s*', ' '),\n                                                    -- Replace slashes with \" and \"\n                                                    '/', ' and '),\n                                                -- Replace hyphens with space\n                                                '\\\\s*-\\\\s*', ' '),\n                                            -- Replace ampersands with \" and \"\n                                            '\\\\s*&\\\\s*', ' and '),\n                                        -- Remove commas\n                                        ',', ''),\n                                    -- Normalize \"And\" to \"and\"\n                                    '\\\\bAnd\\\\b', 'and'),\n                                -- Normalize \"Or\" to \"or\"\n                                '\\\\bOr\\\\b', 'or'),\n                            -- Normalize \"Of\" to \"of\"\n                            '\\\\bOf\\\\b', 'of'),\n                        -- Normalize \"The\" to \"the\"\n                        '\\\\bThe\\\\b', 'the'),\n                    -- Normalize \"Formerly\" to \"formerly\"\n                    '\\\\bFormerly\\\\b', 'formerly'),\n                -- Normalize \"Only\" to \"only\"\n                '\\\\bOnly\\\\b', 'only'),\n            -- Collapse multiple spaces to single space\n            '  +', ' '))\n        , 1, {{ max_length }})\nEND\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.2602901, "supported_languages": null}, "macro.CGOncology_MDM.test_aggregate_match": {"name": "test_aggregate_match", "resource_type": "macro", "package_name": "CGOncology_MDM", "path": "macros/tests/test_aggregate_match.sql", "original_file_path": "macros/tests/test_aggregate_match.sql", "unique_id": "macro.CGOncology_MDM.test_aggregate_match", "macro_sql": "{% test aggregate_match(model, column_name, source_model, source_column, agg_function='SUM', target_filter=None, source_filter=None) %}\n{#\n  Custom generic test: aggregate_match\n  Business Rule: REC-003\n\n  Validates that aggregate values EXACTLY match between source and target models.\n  Filters ensure we're comparing the same data subsets.\n\n  Parameters:\n    - column_name: The column in target model to aggregate\n    - source_model: The source/upstream model to compare against (use ref())\n    - source_column: The column in source model to aggregate\n    - agg_function: Aggregation function (SUM, COUNT, AVG, MIN, MAX) - default SUM\n    - target_filter: Optional WHERE clause for target model (without WHERE keyword)\n    - source_filter: Optional WHERE clause for source model (without WHERE keyword)\n\n  Usage in schema.yml:\n    models:\n      - name: adm_claims_metrics_long\n        columns:\n          - name: claim_count\n            tests:\n              - aggregate_match:\n                  source_model: ref('std_dx_claims')\n                  source_column: mx_claim_id\n                  agg_function: COUNT\n                  target_filter: \"metric_category = 'DX' AND period_key = 'LTD'\"\n                  source_filter: \"service_date IS NOT NULL\"\n\n  Returns row if aggregates don't match exactly.\n#}\n\nWITH target_agg AS (\n    SELECT {{ agg_function }}({{ column_name }}) as agg_value\n    FROM {{ model }}\n    {% if target_filter %}\n    WHERE {{ target_filter }}\n    {% endif %}\n),\nsource_agg AS (\n    SELECT {{ agg_function }}({{ source_column }}) as agg_value\n    FROM {{ source_model }}\n    {% if source_filter %}\n    WHERE {{ source_filter }}\n    {% endif %}\n),\ncomparison AS (\n    SELECT\n        t.agg_value as target_value,\n        s.agg_value as source_value,\n        COALESCE(t.agg_value, 0) - COALESCE(s.agg_value, 0) as difference\n    FROM target_agg t\n    CROSS JOIN source_agg s\n)\nSELECT *\nFROM comparison\nWHERE COALESCE(target_value, 0) != COALESCE(source_value, 0)\n\n{% endtest %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.260709, "supported_languages": null}, "macro.CGOncology_MDM.test_row_count_match": {"name": "test_row_count_match", "resource_type": "macro", "package_name": "CGOncology_MDM", "path": "macros/tests/test_row_count_match.sql", "original_file_path": "macros/tests/test_row_count_match.sql", "unique_id": "macro.CGOncology_MDM.test_row_count_match", "macro_sql": "{% test row_count_match(model, source_model, target_filter=None, source_filter=None) %}\n{#\n  Custom generic test: row_count_match\n  Business Rule: REC-001\n\n  Validates that row count in model EXACTLY matches row count in source model.\n  Filters ensure we're comparing the same data subsets.\n\n  Parameters:\n    - source_model: The source/upstream model to compare against (use ref())\n    - target_filter: Optional WHERE clause for target model (without WHERE keyword)\n    - source_filter: Optional WHERE clause for source model (without WHERE keyword)\n\n  Usage in schema.yml:\n    models:\n      - name: mdm_customer_xref_hco\n        tests:\n          - row_count_match:\n              source_model: ref('std_dh_hco')\n              target_filter: \"source_system = 'DHC'\"\n              source_filter: \"dh_id IS NOT NULL\"\n\n  Returns rows if counts don't match exactly.\n#}\n\nWITH target_count AS (\n    SELECT COUNT(*) as cnt\n    FROM {{ model }}\n    {% if target_filter %}\n    WHERE {{ target_filter }}\n    {% endif %}\n),\nsource_count AS (\n    SELECT COUNT(*) as cnt\n    FROM {{ source_model }}\n    {% if source_filter %}\n    WHERE {{ source_filter }}\n    {% endif %}\n),\ncomparison AS (\n    SELECT\n        t.cnt as target_rows,\n        s.cnt as source_rows,\n        t.cnt - s.cnt as row_difference\n    FROM target_count t\n    CROSS JOIN source_count s\n)\nSELECT *\nFROM comparison\nWHERE target_rows != source_rows\n\n{% endtest %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.261006, "supported_languages": null}, "macro.CGOncology_MDM.test_min_rows": {"name": "test_min_rows", "resource_type": "macro", "package_name": "CGOncology_MDM", "path": "macros/tests/test_min_rows.sql", "original_file_path": "macros/tests/test_min_rows.sql", "unique_id": "macro.CGOncology_MDM.test_min_rows", "macro_sql": "{% test min_rows(model, min_count) %}\n{#\n  Custom generic test: min_rows\n  Business Rules: RAW-004, RAW-020\n\n  Validates that a model has at least the specified minimum number of rows.\n  Test fails if row count is below the threshold.\n\n  Usage in schema.yml:\n    models:\n      - name: std_dh_hco\n        tests:\n          - min_rows:\n              min_count: 1000\n#}\n\nWITH row_count AS (\n    SELECT COUNT(*) AS cnt\n    FROM {{ model }}\n)\nSELECT cnt\nFROM row_count\nWHERE cnt < {{ min_count }}\n\n{% endtest %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.261146, "supported_languages": null}, "macro.CGOncology_MDM.test_uppercase": {"name": "test_uppercase", "resource_type": "macro", "package_name": "CGOncology_MDM", "path": "macros/tests/test_uppercase.sql", "original_file_path": "macros/tests/test_uppercase.sql", "unique_id": "macro.CGOncology_MDM.test_uppercase", "macro_sql": "{% test uppercase(model, column_name) %}\n{#\n  Custom generic test: uppercase\n  Business Rules: STD-003, STD-004\n\n  Validates that a column contains only uppercase letters.\n  - Checks that value equals UPPER(value)\n  - NULL values are allowed\n\n  Usage in schema.yml:\n    columns:\n      - name: state_code\n        tests:\n          - uppercase\n#}\n\nSELECT *\nFROM {{ model }}\nWHERE {{ column_name }} IS NOT NULL\n  AND {{ column_name }} != UPPER({{ column_name }})\n\n{% endtest %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.261303, "supported_languages": null}, "macro.CGOncology_MDM.test_valid_npi": {"name": "test_valid_npi", "resource_type": "macro", "package_name": "CGOncology_MDM", "path": "macros/tests/test_valid_npi.sql", "original_file_path": "macros/tests/test_valid_npi.sql", "unique_id": "macro.CGOncology_MDM.test_valid_npi", "macro_sql": "{% test valid_npi(model, column_name) %}\n{#\n  Custom generic test: valid_npi\n  Business Rule: STD-012\n\n  Validates that an NPI column contains properly formatted 10-digit NPIs.\n  - Must be exactly 10 characters\n  - Must be all digits (0-9)\n  - NULL values are allowed\n\n  Usage in schema.yml:\n    columns:\n      - name: npi\n        tests:\n          - valid_npi\n#}\n\nSELECT *\nFROM {{ model }}\nWHERE {{ column_name }} IS NOT NULL\n  AND (\n    LENGTH({{ column_name }}) != 10\n    OR NOT REGEXP_LIKE({{ column_name }}, '^[0-9]{10}$')\n  )\n\n{% endtest %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.261468, "supported_languages": null}, "macro.CGOncology_MDM.test_no_empty_strings": {"name": "test_no_empty_strings", "resource_type": "macro", "package_name": "CGOncology_MDM", "path": "macros/tests/test_no_empty_strings.sql", "original_file_path": "macros/tests/test_no_empty_strings.sql", "unique_id": "macro.CGOncology_MDM.test_no_empty_strings", "macro_sql": "{% test no_empty_strings(model, column_name) %}\n{#\n  Custom generic test: no_empty_strings\n  Business Rule: STD-030\n\n  Validates that a column contains no empty strings ('').\n  NULL values are allowed - only empty strings fail.\n\n  Usage in schema.yml:\n    columns:\n      - name: org_name\n        tests:\n          - no_empty_strings\n#}\n\nSELECT *\nFROM {{ model }}\nWHERE {{ column_name }} = ''\n\n{% endtest %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.261597, "supported_languages": null}, "macro.CGOncology_MDM.test_is_trimmed": {"name": "test_is_trimmed", "resource_type": "macro", "package_name": "CGOncology_MDM", "path": "macros/tests/test_is_trimmed.sql", "original_file_path": "macros/tests/test_is_trimmed.sql", "unique_id": "macro.CGOncology_MDM.test_is_trimmed", "macro_sql": "{% test is_trimmed(model, column_name) %}\n{#\n  Custom generic test: is_trimmed\n  Business Rules: STD-011, STD-021\n\n  Validates that a column has no leading or trailing whitespace.\n  - Checks that value equals TRIM(value)\n  - NULL values are allowed\n\n  Usage in schema.yml:\n    columns:\n      - name: org_name\n        tests:\n          - is_trimmed\n#}\n\nSELECT *\nFROM {{ model }}\nWHERE {{ column_name }} IS NOT NULL\n  AND {{ column_name }} != TRIM({{ column_name }})\n\n{% endtest %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.2617521, "supported_languages": null}, "macro.CGOncology_MDM.test_key_coverage": {"name": "test_key_coverage", "resource_type": "macro", "package_name": "CGOncology_MDM", "path": "macros/tests/test_key_coverage.sql", "original_file_path": "macros/tests/test_key_coverage.sql", "unique_id": "macro.CGOncology_MDM.test_key_coverage", "macro_sql": "{% test key_coverage(model, column_name, source_model, source_column, target_filter=None, source_filter=None) %}\n{#\n  Custom generic test: key_coverage\n  Business Rule: REC-002\n\n  Validates that ALL keys from source model exist in target model.\n  Ensures no records are lost during transformation.\n  Filters ensure we're comparing the same data subsets.\n\n  Parameters:\n    - column_name: The key column in the target model\n    - source_model: The source/upstream model to compare against (use ref())\n    - source_column: The key column in the source model\n    - target_filter: Optional WHERE clause for target model (without WHERE keyword)\n    - source_filter: Optional WHERE clause for source model (without WHERE keyword)\n\n  Usage in schema.yml:\n    models:\n      - name: mdm_customer_xref_hco\n        columns:\n          - name: source_id\n            tests:\n              - key_coverage:\n                  source_model: ref('std_dh_hco')\n                  source_column: dh_id\n                  target_filter: \"source_system = 'DHC'\"\n                  source_filter: \"dh_id IS NOT NULL\"\n\n  Returns source keys that are missing in target.\n#}\n\nWITH source_keys AS (\n    SELECT DISTINCT {{ source_column }} as key_value\n    FROM {{ source_model }}\n    WHERE {{ source_column }} IS NOT NULL\n    {% if source_filter %}\n    AND {{ source_filter }}\n    {% endif %}\n),\ntarget_keys AS (\n    SELECT DISTINCT {{ column_name }} as key_value\n    FROM {{ model }}\n    WHERE {{ column_name }} IS NOT NULL\n    {% if target_filter %}\n    AND {{ target_filter }}\n    {% endif %}\n)\nSELECT s.key_value as missing_key\nFROM source_keys s\nLEFT JOIN target_keys t ON s.key_value = t.key_value\nWHERE t.key_value IS NULL\n\n{% endtest %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.262115, "supported_languages": null}, "macro.CGOncology_MDM.test_valid_zip": {"name": "test_valid_zip", "resource_type": "macro", "package_name": "CGOncology_MDM", "path": "macros/tests/test_valid_zip.sql", "original_file_path": "macros/tests/test_valid_zip.sql", "unique_id": "macro.CGOncology_MDM.test_valid_zip", "macro_sql": "{% test valid_zip(model, column_name) %}\n{#\n  Custom generic test: valid_zip\n  Business Rule: STD-001\n\n  Validates that a ZIP code column contains properly formatted 5-digit ZIP codes.\n  - Must be exactly 5 characters\n  - Must be all digits (0-9)\n  - NULL values are allowed\n\n  Usage in schema.yml:\n    columns:\n      - name: zip_code\n        tests:\n          - valid_zip\n#}\n\nSELECT *\nFROM {{ model }}\nWHERE {{ column_name }} IS NOT NULL\n  AND (\n    LENGTH({{ column_name }}) != 5\n    OR NOT REGEXP_LIKE({{ column_name }}, '^[0-9]{5}$')\n  )\n\n{% endtest %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.2622862, "supported_languages": null}, "macro.dbt_snowflake.snowflake__generate_database_name": {"name": "snowflake__generate_database_name", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/get_custom_name.sql", "original_file_path": "macros/get_custom_name.sql", "unique_id": "macro.dbt_snowflake.snowflake__generate_database_name", "macro_sql": "{% macro snowflake__generate_database_name(custom_database_name=none, node=none) -%}\n    {%- if custom_database_name is none -%}\n         {%- if node is not none and node|attr('database') -%}\n            {%- set catalog_relation = adapter.build_catalog_relation(node) -%}\n        {%- elif 'config' in target -%}\n            {%- set catalog_relation = adapter.build_catalog_relation(target) -%}\n        {%- else -%}\n            {%- set catalog_relation = none -%}\n        {%- endif -%}\n        {%- if catalog_relation is not none\n            and catalog_relation|attr('catalog_linked_database')-%}\n            {{ return(catalog_relation.catalog_linked_database) }}\n        {%- else -%}\n            {{ target.database }}\n        {%- endif -%}\n    {%- else -%}\n       {{ custom_database_name }}\n    {%- endif -%}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.262783, "supported_languages": null}, "macro.dbt_snowflake.snowflake__get_catalog": {"name": "snowflake__get_catalog", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/catalog.sql", "original_file_path": "macros/catalog.sql", "unique_id": "macro.dbt_snowflake.snowflake__get_catalog", "macro_sql": "{% macro snowflake__get_catalog(information_schema, schemas) -%}\n\n    {% set query %}\n        with tables as (\n            {{ snowflake__get_catalog_tables_sql(information_schema) }}\n            {{ snowflake__get_catalog_schemas_where_clause_sql(schemas) }}\n        ),\n        columns as (\n            {{ snowflake__get_catalog_columns_sql(information_schema) }}\n            {{ snowflake__get_catalog_schemas_where_clause_sql(schemas) }}\n        )\n        {{ snowflake__get_catalog_results_sql() }}\n    {%- endset -%}\n\n    {{ return(run_query(query)) }}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__get_catalog_tables_sql", "macro.dbt_snowflake.snowflake__get_catalog_schemas_where_clause_sql", "macro.dbt_snowflake.snowflake__get_catalog_columns_sql", "macro.dbt_snowflake.snowflake__get_catalog_results_sql", "macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.2633128, "supported_languages": null}, "macro.dbt_snowflake.snowflake__get_catalog_relations": {"name": "snowflake__get_catalog_relations", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/catalog.sql", "original_file_path": "macros/catalog.sql", "unique_id": "macro.dbt_snowflake.snowflake__get_catalog_relations", "macro_sql": "{% macro snowflake__get_catalog_relations(information_schema, relations) -%}\n\n    {% set query %}\n        with tables as (\n            {{ snowflake__get_catalog_tables_sql(information_schema) }}\n            {{ snowflake__get_catalog_relations_where_clause_sql(relations) }}\n        ),\n        columns as (\n            {{ snowflake__get_catalog_columns_sql(information_schema) }}\n            {{ snowflake__get_catalog_relations_where_clause_sql(relations) }}\n        )\n        {{ snowflake__get_catalog_results_sql() }}\n    {%- endset -%}\n\n    {{ return(run_query(query)) }}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__get_catalog_tables_sql", "macro.dbt_snowflake.snowflake__get_catalog_relations_where_clause_sql", "macro.dbt_snowflake.snowflake__get_catalog_columns_sql", "macro.dbt_snowflake.snowflake__get_catalog_results_sql", "macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.263596, "supported_languages": null}, "macro.dbt_snowflake.snowflake__get_catalog_tables_sql": {"name": "snowflake__get_catalog_tables_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/catalog.sql", "original_file_path": "macros/catalog.sql", "unique_id": "macro.dbt_snowflake.snowflake__get_catalog_tables_sql", "macro_sql": "{% macro snowflake__get_catalog_tables_sql(information_schema) -%}\n    select\n        table_catalog as \"table_database\",\n        table_schema as \"table_schema\",\n        table_name as \"table_name\",\n        case\n            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'\n            else table_type\n        end as \"table_type\",\n        comment as \"table_comment\",\n\n        -- note: this is the _role_ that owns the table\n        table_owner as \"table_owner\",\n\n        'Clustering Key' as \"stats:clustering_key:label\",\n        clustering_key as \"stats:clustering_key:value\",\n        'The key used to cluster this table' as \"stats:clustering_key:description\",\n        (clustering_key is not null) as \"stats:clustering_key:include\",\n\n        'Row Count' as \"stats:row_count:label\",\n        row_count as \"stats:row_count:value\",\n        'An approximate count of rows in this table' as \"stats:row_count:description\",\n        (row_count is not null) as \"stats:row_count:include\",\n\n        'Approximate Size' as \"stats:bytes:label\",\n        bytes as \"stats:bytes:value\",\n        'Approximate size of the table as reported by Snowflake' as \"stats:bytes:description\",\n        (bytes is not null) as \"stats:bytes:include\",\n\n        'Last Modified' as \"stats:last_modified:label\",\n        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as \"stats:last_modified:value\",\n        'The timestamp for last update/change' as \"stats:last_modified:description\",\n        (last_altered is not null and table_type='BASE TABLE') as \"stats:last_modified:include\"\n    from {{ information_schema }}.tables\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.2637389, "supported_languages": null}, "macro.dbt_snowflake.snowflake__get_catalog_columns_sql": {"name": "snowflake__get_catalog_columns_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/catalog.sql", "original_file_path": "macros/catalog.sql", "unique_id": "macro.dbt_snowflake.snowflake__get_catalog_columns_sql", "macro_sql": "{% macro snowflake__get_catalog_columns_sql(information_schema) -%}\n    select\n        table_catalog as \"table_database\",\n        table_schema as \"table_schema\",\n        table_name as \"table_name\",\n\n        column_name as \"column_name\",\n        ordinal_position as \"column_index\",\n        data_type as \"column_type\",\n        comment as \"column_comment\"\n    from {{ information_schema }}.columns\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.263818, "supported_languages": null}, "macro.dbt_snowflake.snowflake__get_catalog_results_sql": {"name": "snowflake__get_catalog_results_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/catalog.sql", "original_file_path": "macros/catalog.sql", "unique_id": "macro.dbt_snowflake.snowflake__get_catalog_results_sql", "macro_sql": "{% macro snowflake__get_catalog_results_sql() -%}\n    select *\n    from tables\n    join columns using (\"table_database\", \"table_schema\", \"table_name\")\n    order by \"column_index\"\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.263871, "supported_languages": null}, "macro.dbt_snowflake.snowflake__catalog_equals": {"name": "snowflake__catalog_equals", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/catalog.sql", "original_file_path": "macros/catalog.sql", "unique_id": "macro.dbt_snowflake.snowflake__catalog_equals", "macro_sql": "{% macro snowflake__catalog_equals(field, value) %}\n    \"{{ field }}\" ilike '{{ value }}' and upper(\"{{ field }}\") = upper('{{ value }}')\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.263972, "supported_languages": null}, "macro.dbt_snowflake.snowflake__get_catalog_schemas_where_clause_sql": {"name": "snowflake__get_catalog_schemas_where_clause_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/catalog.sql", "original_file_path": "macros/catalog.sql", "unique_id": "macro.dbt_snowflake.snowflake__get_catalog_schemas_where_clause_sql", "macro_sql": "{% macro snowflake__get_catalog_schemas_where_clause_sql(schemas) -%}\n    where ({%- for schema in schemas -%}\n        ({{ snowflake__catalog_equals('table_schema', schema) }}){%- if not loop.last %} or {% endif -%}\n    {%- endfor -%})\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__catalog_equals"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.264135, "supported_languages": null}, "macro.dbt_snowflake.snowflake__get_catalog_relations_where_clause_sql": {"name": "snowflake__get_catalog_relations_where_clause_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/catalog.sql", "original_file_path": "macros/catalog.sql", "unique_id": "macro.dbt_snowflake.snowflake__get_catalog_relations_where_clause_sql", "macro_sql": "{% macro snowflake__get_catalog_relations_where_clause_sql(relations) -%}\n    where (\n        {%- for relation in relations -%}\n            {% if relation.schema and relation.identifier %}\n                (\n                    {{ snowflake__catalog_equals('table_schema', relation.schema) }}\n                    and {{ snowflake__catalog_equals('table_name', relation.identifier) }}\n                )\n            {% elif relation.schema %}\n                (\n                    {{ snowflake__catalog_equals('table_schema', relation.schema) }}\n                )\n            {% else %}\n                {% do exceptions.raise_compiler_error(\n                    '`get_catalog_relations` requires a list of relations, each with a schema'\n                ) %}\n            {% endif %}\n\n            {%- if not loop.last %} or {% endif -%}\n        {%- endfor -%}\n    )\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__catalog_equals"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.26447, "supported_languages": null}, "macro.dbt_snowflake.get_column_comment_sql": {"name": "get_column_comment_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_snowflake.get_column_comment_sql", "macro_sql": "{% macro get_column_comment_sql(column_name, column_dict) -%}\n  {% if (column_name|upper in column_dict) -%}\n    {% set matched_column = column_name|upper -%}\n  {% elif (column_name|lower in column_dict) -%}\n    {% set matched_column = column_name|lower -%}\n  {% elif (column_name in column_dict) -%}\n    {% set matched_column = column_name -%}\n  {% else -%}\n    {% set matched_column = None -%}\n  {% endif -%}\n  {% if matched_column -%}\n    {{ adapter.quote(column_name) }} COMMENT $${{ column_dict[matched_column]['description'] | replace('$', '[$]') }}$$\n  {%- else -%}\n    {{ adapter.quote(column_name) }} COMMENT $$$$\n  {%- endif -%}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.265677, "supported_languages": null}, "macro.dbt_snowflake.get_persist_docs_column_list": {"name": "get_persist_docs_column_list", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_snowflake.get_persist_docs_column_list", "macro_sql": "{% macro get_persist_docs_column_list(model_columns, query_columns) %}\n(\n  {% for column_name in query_columns %}\n    {{ get_column_comment_sql(column_name, model_columns) }}\n    {{- \", \" if not loop.last else \"\" }}\n  {% endfor %}\n)\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.get_column_comment_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.265839, "supported_languages": null}, "macro.dbt_snowflake.snowflake__get_columns_in_relation": {"name": "snowflake__get_columns_in_relation", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_snowflake.snowflake__get_columns_in_relation", "macro_sql": "{% macro snowflake__get_columns_in_relation(relation) -%}\n  {%- set sql -%}\n    describe table {{ relation.render() }}\n  {%- endset -%}\n  {%- set result = run_query(sql) -%}\n\n  {% set maximum = 10000 %}\n  {% if (result | length) >= maximum %}\n    {% set msg %}\n      Too many columns in relation {{ relation.render() }}! dbt can only get\n      information about relations with fewer than {{ maximum }} columns.\n    {% endset %}\n    {% do exceptions.raise_compiler_error(msg) %}\n  {% endif %}\n\n  {% set columns = [] %}\n  {% for row in result %}\n    {% do columns.append(api.Column.from_description(row['name'], row['type'])) %}\n  {% endfor %}\n  {% do return(columns) %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.26628, "supported_languages": null}, "macro.dbt_snowflake.snowflake__show_object_metadata": {"name": "snowflake__show_object_metadata", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_snowflake.snowflake__show_object_metadata", "macro_sql": "{% macro snowflake__show_object_metadata(relation) %}\n  {%- set sql -%}\n    show objects in {{ relation.include(identifier=False) }} starts with '{{ relation.identifier }}' limit 1\n  {%- endset -%}\n\n  {%- set result = run_query(sql) -%}\n  {{ return(result) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.266457, "supported_languages": null}, "macro.dbt_snowflake.snowflake__list_schemas": {"name": "snowflake__list_schemas", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_snowflake.snowflake__list_schemas", "macro_sql": "{% macro snowflake__list_schemas(database) -%}\n  {# 10k limit from here: https://docs.snowflake.net/manuals/sql-reference/sql/show-schemas.html#usage-notes #}\n  {% set maximum = 10000 %}\n  {% set sql -%}\n    show terse schemas in database {{ database }}\n    limit {{ maximum }}\n  {%- endset %}\n  {% set result = run_query(sql) %}\n  {% if (result | length) >= maximum %}\n    {% set msg %}\n      Too many schemas in database {{ database }}! dbt can only get\n      information about databases with fewer than {{ maximum }} schemas.\n    {% endset %}\n    {% do exceptions.raise_compiler_error(msg) %}\n  {% endif %}\n  {{ return(result) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.266762, "supported_languages": null}, "macro.dbt_snowflake.snowflake__check_schema_exists": {"name": "snowflake__check_schema_exists", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_snowflake.snowflake__check_schema_exists", "macro_sql": "{% macro snowflake__check_schema_exists(information_schema, schema) -%}\n  {% call statement('check_schema_exists', fetch_result=True) -%}\n        select count(*)\n        from {{ information_schema }}.schemata\n        where upper(schema_name) = upper('{{ schema }}')\n            and upper(catalog_name) = upper('{{ information_schema.database }}')\n  {%- endcall %}\n  {{ return(load_result('check_schema_exists').table) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.2669508, "supported_languages": null}, "macro.dbt_snowflake.snowflake__alter_column_type": {"name": "snowflake__alter_column_type", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_snowflake.snowflake__alter_column_type", "macro_sql": "{% macro snowflake__alter_column_type(relation, column_name, new_column_type) -%}\n  {% call statement('alter_column_type') %}\n    alter {{ relation.get_ddl_prefix_for_alter() }} table {{ relation.render() }} alter {{ adapter.quote(column_name) }} set data type {{ new_column_type }};\n  {% endcall %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.267124, "supported_languages": null}, "macro.dbt_snowflake.snowflake__alter_relation_comment": {"name": "snowflake__alter_relation_comment", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_snowflake.snowflake__alter_relation_comment", "macro_sql": "{% macro snowflake__alter_relation_comment(relation, relation_comment) -%}\n    {%- if relation.is_dynamic_table -%}\n        {%- set relation_type = 'dynamic table' -%}\n    {%- else -%}\n        {%- set relation_type = relation.type -%}\n    {%- endif -%}\n\n    {%- if relation.is_iceberg_format -%}\n        alter iceberg table {{ relation.render() }} set comment = $${{ relation_comment | replace('$', '[$]') }}$$;\n    {%- else -%}\n        comment on {{ relation_type }} {{ relation.render() }} IS $${{ relation_comment | replace('$', '[$]') }}$$;\n    {%- endif -%}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.267421, "supported_languages": null}, "macro.dbt_snowflake.snowflake__alter_column_comment": {"name": "snowflake__alter_column_comment", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_snowflake.snowflake__alter_column_comment", "macro_sql": "{% macro snowflake__alter_column_comment(relation, column_dict) -%}\n    {% set existing_columns = adapter.get_columns_in_relation(relation) | map(attribute=\"name\") | list %}\n    {% if relation.is_dynamic_table -%}\n        {% set relation_type = \"table\" %}\n    {% else -%}\n        {% set relation_type = relation.type %}\n    {% endif %}\n    alter {{ relation.get_ddl_prefix_for_alter() }} {{ relation_type }} {{ relation.render() }} alter\n    {% for column_name in existing_columns if (column_name in existing_columns) or (column_name|lower in existing_columns) %}\n        {{ get_column_comment_sql(column_name, column_dict) }} {{- ',' if not loop.last else ';' }}\n    {% endfor %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.get_column_comment_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.267821, "supported_languages": null}, "macro.dbt_snowflake.get_current_query_tag": {"name": "get_current_query_tag", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_snowflake.get_current_query_tag", "macro_sql": "{% macro get_current_query_tag() -%}\n  {{ return(run_query(\"show parameters like 'query_tag' in session\").rows[0]['value']) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.26794, "supported_languages": null}, "macro.dbt_snowflake.set_query_tag": {"name": "set_query_tag", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_snowflake.set_query_tag", "macro_sql": "{% macro set_query_tag() -%}\n    {{ return(adapter.dispatch('set_query_tag', 'dbt')()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__set_query_tag"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.268034, "supported_languages": null}, "macro.dbt_snowflake.snowflake__set_query_tag": {"name": "snowflake__set_query_tag", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_snowflake.snowflake__set_query_tag", "macro_sql": "{% macro snowflake__set_query_tag() -%}\n  {% set new_query_tag = config.get('query_tag') %}\n  {% if new_query_tag %}\n    {% set original_query_tag = get_current_query_tag() %}\n    {{ log(\"Setting query_tag to '\" ~ new_query_tag ~ \"'. Will reset to '\" ~ original_query_tag ~ \"' after materialization.\") }}\n    {% do run_query(\"alter session set query_tag = '{}'\".format(new_query_tag)) %}\n    {{ return(original_query_tag)}}\n  {% endif %}\n  {{ return(none)}}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.get_current_query_tag", "macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.268299, "supported_languages": null}, "macro.dbt_snowflake.unset_query_tag": {"name": "unset_query_tag", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_snowflake.unset_query_tag", "macro_sql": "{% macro unset_query_tag(original_query_tag) -%}\n    {{ return(adapter.dispatch('unset_query_tag', 'dbt')(original_query_tag)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__unset_query_tag"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.268416, "supported_languages": null}, "macro.dbt_snowflake.snowflake__unset_query_tag": {"name": "snowflake__unset_query_tag", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_snowflake.snowflake__unset_query_tag", "macro_sql": "{% macro snowflake__unset_query_tag(original_query_tag) -%}\n  {% set new_query_tag = config.get('query_tag') %}\n  {% if new_query_tag %}\n    {% if original_query_tag %}\n      {{ log(\"Resetting query_tag to '\" ~ original_query_tag ~ \"'.\") }}\n      {% do run_query(\"alter session set query_tag = '{}'\".format(original_query_tag)) %}\n    {% else %}\n      {{ log(\"No original query_tag, unsetting parameter.\") }}\n      {% do run_query(\"alter session unset query_tag\") %}\n    {% endif %}\n  {% endif %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.268682, "supported_languages": null}, "macro.dbt_snowflake.snowflake__alter_relation_add_remove_columns": {"name": "snowflake__alter_relation_add_remove_columns", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_snowflake.snowflake__alter_relation_add_remove_columns", "macro_sql": "{% macro snowflake__alter_relation_add_remove_columns(relation, add_columns, remove_columns) %}\n\n    {% if relation.is_dynamic_table -%}\n        {% set relation_type = \"dynamic table\" %}\n    {% else -%}\n        {% set relation_type = relation.type %}\n    {% endif %}\n\n    {% if add_columns %}\n\n    {% set sql -%}\n       alter {{ relation.get_ddl_prefix_for_alter() }} {{ relation_type }} {{ relation.render() }} add column\n          {% for column in add_columns %}\n            {{ column.name }} {{ column.data_type }}{{ ',' if not loop.last }}\n          {% endfor %}\n    {%- endset -%}\n\n    {% do run_query(sql) %}\n\n    {% endif %}\n\n    {% if remove_columns %}\n\n    {% set sql -%}\n        alter {{ relation.get_ddl_prefix_for_alter() }} {{ relation_type }} {{ relation.render() }} drop column\n            {% for column in remove_columns %}\n                {{ column.name }}{{ ',' if not loop.last }}\n            {% endfor %}\n    {%- endset -%}\n\n    {% do run_query(sql) %}\n\n    {% endif %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.269223, "supported_languages": null}, "macro.dbt_snowflake.snowflake_dml_explicit_transaction": {"name": "snowflake_dml_explicit_transaction", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_snowflake.snowflake_dml_explicit_transaction", "macro_sql": "{% macro snowflake_dml_explicit_transaction(dml) %}\n  {#\n    Use this macro to wrap all INSERT, MERGE, UPDATE, DELETE, and TRUNCATE\n    statements before passing them into run_query(), or calling in the 'main' statement\n    of a materialization\n  #}\n  {% set dml_transaction -%}\n    begin;\n    {{ dml }};\n    commit;\n  {%- endset %}\n\n  {% do return(dml_transaction) %}\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.269352, "supported_languages": null}, "macro.dbt_snowflake.snowflake__truncate_relation": {"name": "snowflake__truncate_relation", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_snowflake.snowflake__truncate_relation", "macro_sql": "{% macro snowflake__truncate_relation(relation) -%}\n  {% set truncate_dml %}\n    truncate table {{ relation.render() }}\n  {% endset %}\n  {% call statement('truncate_relation') -%}\n    {{ snowflake_dml_explicit_transaction(truncate_dml) }}\n  {%- endcall %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt_snowflake.snowflake_dml_explicit_transaction"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.2695029, "supported_languages": null}, "macro.dbt_snowflake.snowflake__copy_grants": {"name": "snowflake__copy_grants", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/apply_grants.sql", "original_file_path": "macros/apply_grants.sql", "unique_id": "macro.dbt_snowflake.snowflake__copy_grants", "macro_sql": "{% macro snowflake__copy_grants() %}\n    {% set copy_grants = config.get('copy_grants', False) %}\n    {{ return(copy_grants) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.269678, "supported_languages": null}, "macro.dbt_snowflake.snowflake__support_multiple_grantees_per_dcl_statement": {"name": "snowflake__support_multiple_grantees_per_dcl_statement", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/apply_grants.sql", "original_file_path": "macros/apply_grants.sql", "unique_id": "macro.dbt_snowflake.snowflake__support_multiple_grantees_per_dcl_statement", "macro_sql": "\n\n{%- macro snowflake__support_multiple_grantees_per_dcl_statement() -%}\n    {{ return(False) }}\n{%- endmacro -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.269752, "supported_languages": null}, "macro.dbt_snowflake.snowflake__get_relation_last_modified": {"name": "snowflake__get_relation_last_modified", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/metadata.sql", "original_file_path": "macros/metadata.sql", "unique_id": "macro.dbt_snowflake.snowflake__get_relation_last_modified", "macro_sql": "{% macro snowflake__get_relation_last_modified(information_schema, relations) -%}\n\n  {%- call statement('last_modified', fetch_result=True) -%}\n        select table_schema as schema,\n               table_name as identifier,\n               last_altered as last_modified,\n               {{ current_timestamp() }} as snapshotted_at\n        from {{ information_schema }}.tables\n        where (\n          {%- for relation in relations -%}\n            (upper(table_schema) = upper('{{ relation.schema }}') and\n             upper(table_name) = upper('{{ relation.identifier }}')){%- if not loop.last %} or {% endif -%}\n          {%- endfor -%}\n        )\n  {%- endcall -%}\n\n  {{ return(load_result('last_modified')) }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.270106, "supported_languages": null}, "macro.dbt_snowflake.materialization_test_snowflake": {"name": "materialization_test_snowflake", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/materializations/test.sql", "original_file_path": "macros/materializations/test.sql", "unique_id": "macro.dbt_snowflake.materialization_test_snowflake", "macro_sql": "{%- materialization test, adapter='snowflake' -%}\n\n    {% set original_query_tag = set_query_tag() %}\n    {% set relations = materialization_test_default() %}\n    {% do unset_query_tag(original_query_tag) %}\n    {{ return(relations) }}\n\n{%- endmaterialization -%}", "depends_on": {"macros": ["macro.dbt_snowflake.set_query_tag", "macro.dbt.materialization_test_default", "macro.dbt_snowflake.unset_query_tag"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.2703202, "supported_languages": ["sql"]}, "macro.dbt_snowflake.snowflake__load_csv_rows": {"name": "snowflake__load_csv_rows", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/materializations/seed.sql", "original_file_path": "macros/materializations/seed.sql", "unique_id": "macro.dbt_snowflake.snowflake__load_csv_rows", "macro_sql": "{% macro snowflake__load_csv_rows(model, agate_table) %}\n    {% set batch_size = get_batch_size() %}\n    {% set cols_sql = get_seed_column_quoted_csv(model, agate_table.column_names) %}\n    {% set bindings = [] %}\n\n    {% set statements = [] %}\n\n    {% for chunk in agate_table.rows | batch(batch_size) %}\n        {% set bindings = [] %}\n\n        {% for row in chunk %}\n            {% do bindings.extend(row) %}\n        {% endfor %}\n\n        {% set sql %}\n            insert into {{ this.render() }} ({{ cols_sql }}) values\n            {% for row in chunk -%}\n                ({%- for column in agate_table.column_names -%}\n                    %s\n                    {%- if not loop.last%},{%- endif %}\n                {%- endfor -%})\n                {%- if not loop.last%},{%- endif %}\n            {%- endfor %}\n        {% endset %}\n\n        {% do adapter.add_query('BEGIN', auto_begin=False) %}\n        {% do adapter.add_query(sql, bindings=bindings, abridge_sql_log=True) %}\n        {% do adapter.add_query('COMMIT', auto_begin=False) %}\n\n        {% if loop.index0 == 0 %}\n            {% do statements.append(sql) %}\n        {% endif %}\n    {% endfor %}\n\n    {# Return SQL so we can render it out into the compiled files #}\n    {{ return(statements[0]) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_batch_size", "macro.dbt.get_seed_column_quoted_csv"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.2712479, "supported_languages": null}, "macro.dbt_snowflake.materialization_seed_snowflake": {"name": "materialization_seed_snowflake", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/materializations/seed.sql", "original_file_path": "macros/materializations/seed.sql", "unique_id": "macro.dbt_snowflake.materialization_seed_snowflake", "macro_sql": "{% materialization seed, adapter='snowflake' %}\n    {% set original_query_tag = set_query_tag() %}\n\n    {% set relations = materialization_seed_default() %}\n\n    {% do unset_query_tag(original_query_tag) %}\n\n    {{ return(relations) }}\n{% endmaterialization %}", "depends_on": {"macros": ["macro.dbt_snowflake.set_query_tag", "macro.dbt.materialization_seed_default", "macro.dbt_snowflake.unset_query_tag"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.2714229, "supported_languages": ["sql"]}, "macro.dbt_snowflake.materialization_view_snowflake": {"name": "materialization_view_snowflake", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/materializations/view.sql", "original_file_path": "macros/materializations/view.sql", "unique_id": "macro.dbt_snowflake.materialization_view_snowflake", "macro_sql": "{% materialization view, adapter='snowflake' -%}\n\n    {% set original_query_tag = set_query_tag() %}\n    {% set to_return = snowflake__create_or_replace_view() %}\n\n    {% set target_relation = this.incorporate(type='view') %}\n\n    {% do persist_docs(target_relation, model, for_columns=false) %}\n\n    {% do unset_query_tag(original_query_tag) %}\n\n    {% do return(to_return) %}\n\n{%- endmaterialization %}", "depends_on": {"macros": ["macro.dbt_snowflake.set_query_tag", "macro.dbt_snowflake.snowflake__create_or_replace_view", "macro.dbt.persist_docs", "macro.dbt_snowflake.unset_query_tag"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.271724, "supported_languages": ["sql"]}, "macro.dbt_snowflake.materialization_table_snowflake": {"name": "materialization_table_snowflake", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/materializations/table.sql", "original_file_path": "macros/materializations/table.sql", "unique_id": "macro.dbt_snowflake.materialization_table_snowflake", "macro_sql": "{% materialization table, adapter='snowflake', supported_languages=['sql', 'python']%}\n\n  {% set original_query_tag = set_query_tag() %}\n\n  {%- set identifier = model['alias'] -%}\n  {%- set language = model['language'] -%}\n\n  {% set grant_config = config.get('grants') %}\n\n  {%- set existing_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n\n  {%- set catalog_relation = adapter.build_catalog_relation(config.model) -%}\n  {%- set target_relation = api.Relation.create(\n\tidentifier=identifier,\n\tschema=schema,\n\tdatabase=database,\n\ttype='table',\n\ttable_format=catalog_relation.table_format\n   ) -%}\n\n  {{ run_hooks(pre_hooks) }}\n\n  {% if target_relation.needs_to_drop(existing_relation) %}\n    {{ drop_relation_if_exists(existing_relation) }}\n  {% endif %}\n\n  {% call statement('main', language=language) -%}\n      {{ create_table_as(False, target_relation, compiled_code, language) }}\n  {%- endcall %}\n\n  {{ run_hooks(post_hooks) }}\n\n  {% set should_revoke = should_revoke(existing_relation, full_refresh_mode=True) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {% do unset_query_tag(original_query_tag) %}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{% endmaterialization %}", "depends_on": {"macros": ["macro.dbt_snowflake.set_query_tag", "macro.dbt.run_hooks", "macro.dbt.drop_relation_if_exists", "macro.dbt.statement", "macro.dbt.create_table_as", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs", "macro.dbt_snowflake.unset_query_tag"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.2726212, "supported_languages": ["sql", "python"]}, "macro.dbt_snowflake.dbt_snowflake_get_tmp_relation_type": {"name": "dbt_snowflake_get_tmp_relation_type", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/materializations/incremental.sql", "original_file_path": "macros/materializations/incremental.sql", "unique_id": "macro.dbt_snowflake.dbt_snowflake_get_tmp_relation_type", "macro_sql": "{% macro dbt_snowflake_get_tmp_relation_type(strategy, unique_key, language) %}\n{%- set tmp_relation_type = config.get('tmp_relation_type') -%}\n  /* {#\n       High-level principles:\n       If we are running multiple statements (DELETE + INSERT),\n       and we want to guarantee identical inputs to both statements,\n       then we must first save the model query results as a temporary table\n       (which presumably comes with a performance cost).\n       If we are running a single statement (MERGE or INSERT alone),\n       we _may_ save the model query definition as a view instead,\n       for (presumably) faster overall incremental processing.\n\n       Low-level specifics:\n       If an invalid option is specified, then we will raise an\n       excpetion with corresponding message.\n\n       Languages other than SQL (like Python) will use a temporary table.\n       With the default strategy of merge, the user may choose between a temporary\n       table and view (defaulting to view).\n\n       The append strategy can use a view because it will run a single INSERT statement.\n\n       When unique_key is none, the delete+insert and microbatch strategies can use a view beacuse a\n       single INSERT statement is run with no DELETES as part of the statement.\n       Otherwise, play it safe by using a temporary table.\n  #} */\n\n  {% if language == \"python\" and tmp_relation_type is not none %}\n    {% do exceptions.raise_compiler_error(\n      \"Python models currently only support 'table' for tmp_relation_type but \"\n       ~ tmp_relation_type ~ \" was specified.\"\n    ) %}\n  {% endif %}\n\n  {% if strategy in [\"delete+insert\", \"microbatch\"] and tmp_relation_type is not none and tmp_relation_type != \"table\" and unique_key is not none %}\n    {% do exceptions.raise_compiler_error(\n      \"In order to maintain consistent results when `unique_key` is not none,\n      the `\" ~ strategy ~ \"` strategy only supports `table` for `tmp_relation_type` but \"\n      ~ tmp_relation_type ~ \" was specified.\"\n      )\n  %}\n  {% endif %}\n\n  {% if language != \"sql\" %}\n    {{ return(\"table\") }}\n  {% elif tmp_relation_type == \"table\" %}\n    {{ return(\"table\") }}\n  {% elif tmp_relation_type == \"view\" %}\n    {{ return(\"view\") }}\n  {% elif strategy in (\"default\", \"merge\", \"append\", \"insert_overwrite\") %}\n    {{ return(\"view\") }}\n  {% elif strategy in [\"delete+insert\", \"microbatch\"] and unique_key is none %}\n    {{ return(\"view\") }}\n  {% else %}\n    {{ return(\"table\") }}\n  {% endif %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.273966, "supported_languages": null}, "macro.dbt_snowflake.materialization_incremental_snowflake": {"name": "materialization_incremental_snowflake", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/materializations/incremental.sql", "original_file_path": "macros/materializations/incremental.sql", "unique_id": "macro.dbt_snowflake.materialization_incremental_snowflake", "macro_sql": "{% materialization incremental, adapter='snowflake', supported_languages=['sql', 'python'] -%}\n\n  {% set original_query_tag = set_query_tag() %}\n\n  {#-- Set vars --#}\n  {%- set full_refresh_mode = (should_full_refresh()) -%}\n  {%- set language = model['language'] -%}\n\n  {%- set identifier = this.name -%}\n  {%- set catalog_relation = adapter.build_catalog_relation(config.model) -%}\n\n  {%- set target_relation = api.Relation.create(\n\tidentifier=identifier,\n\tschema=schema,\n\tdatabase=database,\n\ttype='table',\n\ttable_format=catalog_relation.table_format\n  ) -%}\n\n  {% set existing_relation = load_relation(this) %}\n\n  {#-- The temp relation will be a view (faster) or temp table, depending on upsert/merge strategy --#}\n  {%- set unique_key = config.get('unique_key') -%}\n  {% set incremental_strategy = config.get('incremental_strategy') or 'default' %}\n  {% set tmp_relation_type = dbt_snowflake_get_tmp_relation_type(incremental_strategy, unique_key, language) %}\n  {% set tmp_relation = make_temp_relation(this).incorporate(type=tmp_relation_type) %}\n\n  {% set grant_config = config.get('grants') %}\n\n  {% set on_schema_change = incremental_validate_on_schema_change(config.get('on_schema_change'), default='ignore') %}\n\n  {{ run_hooks(pre_hooks) }}\n\n  {% if existing_relation is none %}\n    {%- call statement('main', language=language) -%}\n      {{ create_table_as(False, target_relation, compiled_code, language) }}\n    {%- endcall -%}\n\n  {% elif existing_relation.is_view %}\n    {#-- Can't overwrite a view with a table - we must drop --#}\n    {{ log(\"Dropping relation \" ~ target_relation ~ \" because it is a view and this model is a table.\") }}\n    {% do adapter.drop_relation(existing_relation) %}\n    {%- call statement('main', language=language) -%}\n      {{ create_table_as(False, target_relation, compiled_code, language) }}\n    {%- endcall -%}\n\n  {% elif full_refresh_mode %}\n    {% if target_relation.needs_to_drop(existing_relation) %}\n      {{ drop_relation_if_exists(existing_relation) }}\n    {% endif %}\n    {%- call statement('main', language=language) -%}\n      {{ create_table_as(False, target_relation, compiled_code, language) }}\n    {%- endcall -%}\n\n  {% elif target_relation.table_format != existing_relation.table_format %}\n    {% do exceptions.raise_compiler_error(\n        \"Unable to update the incremental model `\" ~ target_relation.identifier ~ \"` from `\" ~ existing_relation.table_format ~ \"` to `\" ~ target_relation.table_format ~ \"` due to Snowflake limitation. Please execute with --full-refresh to drop the table and recreate in the new catalog.'\"\n      )\n    %}\n\n  {% else %}\n    {#-- Create the temp relation, either as a view or as a temp table --#}\n    {% if tmp_relation_type == 'view' %}\n        {%- call statement('create_tmp_relation') -%}\n          {{ snowflake__create_view_as_with_temp_flag(tmp_relation, compiled_code, True) }}\n        {%- endcall -%}\n    {% else %}\n        {%- call statement('create_tmp_relation', language=language) -%}\n          {{ create_table_as(True, tmp_relation, compiled_code, language) }}\n        {%- endcall -%}\n    {% endif %}\n\n    {% do adapter.expand_target_column_types(\n           from_relation=tmp_relation,\n           to_relation=target_relation) %}\n    {#-- Process schema changes. Returns dict of changes if successful. Use source columns for upserting/merging --#}\n    {% set dest_columns = process_schema_changes(on_schema_change, tmp_relation, existing_relation) %}\n    {% if not dest_columns %}\n      {% set dest_columns = adapter.get_columns_in_relation(existing_relation) %}\n    {% endif %}\n\n    {#-- Get the incremental_strategy, the macro to use for the strategy, and build the sql --#}\n    {% set incremental_predicates = config.get('predicates', none) or config.get('incremental_predicates', none) %}\n    {% set strategy_sql_macro_func = adapter.get_incremental_strategy_macro(context, incremental_strategy) %}\n    {% set strategy_arg_dict = ({'target_relation': target_relation, 'temp_relation': tmp_relation, 'unique_key': unique_key, 'dest_columns': dest_columns, 'incremental_predicates': incremental_predicates }) %}\n\n    {%- call statement('main') -%}\n      {{ strategy_sql_macro_func(strategy_arg_dict) }}\n    {%- endcall -%}\n  {% endif %}\n\n  {% do drop_relation_if_exists(tmp_relation) %}\n\n  {{ run_hooks(post_hooks) }}\n\n  {% set target_relation = target_relation.incorporate(type='table') %}\n\n  {% set should_revoke =\n   should_revoke(existing_relation.is_table, full_refresh_mode) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {% do unset_query_tag(original_query_tag) %}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{%- endmaterialization %}", "depends_on": {"macros": ["macro.dbt_snowflake.set_query_tag", "macro.dbt.should_full_refresh", "macro.dbt.load_relation", "macro.dbt_snowflake.dbt_snowflake_get_tmp_relation_type", "macro.dbt.make_temp_relation", "macro.dbt.incremental_validate_on_schema_change", "macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.create_table_as", "macro.dbt.drop_relation_if_exists", "macro.dbt_snowflake.snowflake__create_view_as_with_temp_flag", "macro.dbt.process_schema_changes", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs", "macro.dbt_snowflake.unset_query_tag"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.27646, "supported_languages": ["sql", "python"]}, "macro.dbt_snowflake.snowflake__get_incremental_default_sql": {"name": "snowflake__get_incremental_default_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/materializations/incremental.sql", "original_file_path": "macros/materializations/incremental.sql", "unique_id": "macro.dbt_snowflake.snowflake__get_incremental_default_sql", "macro_sql": "{% macro snowflake__get_incremental_default_sql(arg_dict) %}\n  {{ return(get_incremental_merge_sql(arg_dict)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_incremental_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.276588, "supported_languages": null}, "macro.dbt_snowflake.materialization_snapshot_snowflake": {"name": "materialization_snapshot_snowflake", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/materializations/snapshot.sql", "original_file_path": "macros/materializations/snapshot.sql", "unique_id": "macro.dbt_snowflake.materialization_snapshot_snowflake", "macro_sql": "{% materialization snapshot, adapter='snowflake' %}\n    {% set original_query_tag = set_query_tag() %}\n    {% set relations = materialization_snapshot_default() %}\n\n    {% do unset_query_tag(original_query_tag) %}\n\n    {{ return(relations) }}\n{% endmaterialization %}", "depends_on": {"macros": ["macro.dbt_snowflake.set_query_tag", "macro.dbt.materialization_snapshot_default", "macro.dbt_snowflake.unset_query_tag"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.276823, "supported_languages": ["sql"]}, "macro.dbt_snowflake.materialization_dynamic_table_snowflake": {"name": "materialization_dynamic_table_snowflake", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/materializations/dynamic_table.sql", "original_file_path": "macros/materializations/dynamic_table.sql", "unique_id": "macro.dbt_snowflake.materialization_dynamic_table_snowflake", "macro_sql": "{% materialization dynamic_table, adapter='snowflake' %}\n\n    {% set query_tag = set_query_tag() %}\n\n    {% set existing_relation = load_cached_relation(this) %}\n    {% set target_relation = this.incorporate(type=this.DynamicTable) %}\n\n    {{ run_hooks(pre_hooks) }}\n\n    {% set build_sql = dynamic_table_get_build_sql(existing_relation, target_relation) %}\n\n    {% if build_sql == '' %}\n        {{ dynamic_table_execute_no_op(target_relation) }}\n    {% else %}\n        {{ dynamic_table_execute_build_sql(build_sql, existing_relation, target_relation) }}\n    {% endif %}\n\n    {{ run_hooks(post_hooks) }}\n\n    {% do unset_query_tag(query_tag) %}\n\n    {{ return({'relations': [target_relation]}) }}\n\n{% endmaterialization %}", "depends_on": {"macros": ["macro.dbt_snowflake.set_query_tag", "macro.dbt.load_cached_relation", "macro.dbt.run_hooks", "macro.dbt_snowflake.dynamic_table_get_build_sql", "macro.dbt_snowflake.dynamic_table_execute_no_op", "macro.dbt_snowflake.dynamic_table_execute_build_sql", "macro.dbt_snowflake.unset_query_tag"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.277557, "supported_languages": ["sql"]}, "macro.dbt_snowflake.dynamic_table_get_build_sql": {"name": "dynamic_table_get_build_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/materializations/dynamic_table.sql", "original_file_path": "macros/materializations/dynamic_table.sql", "unique_id": "macro.dbt_snowflake.dynamic_table_get_build_sql", "macro_sql": "{% macro dynamic_table_get_build_sql(existing_relation, target_relation) %}\n\n    {% set full_refresh_mode = should_full_refresh() %}\n\n    -- determine the scenario we're in: create, full_refresh, alter, refresh data\n    {% if existing_relation is none %}\n        {% set build_sql = get_create_sql(target_relation, sql) %}\n    {% elif full_refresh_mode or not existing_relation.is_dynamic_table %}\n        {% set build_sql = get_replace_sql(existing_relation, target_relation, sql) %}\n    {% else %}\n\n        -- get config options\n        {% set on_configuration_change = config.get('on_configuration_change') %}\n        {% set configuration_changes = snowflake__get_dynamic_table_configuration_changes(existing_relation, config) %}\n\n        {% if configuration_changes is none %}\n            {% set build_sql = '' %}\n            {{ exceptions.warn(\"No configuration changes were identified on: `\" ~ target_relation ~ \"`. Continuing.\") }}\n\n        {% elif on_configuration_change == 'apply' %}\n            {% set build_sql = snowflake__get_alter_dynamic_table_as_sql(existing_relation, configuration_changes, target_relation, sql) %}\n        {% elif on_configuration_change == 'continue' %}\n            {% set build_sql = '' %}\n            {{ exceptions.warn(\"Configuration changes were identified and `on_configuration_change` was set to `continue` for `\" ~ target_relation ~ \"`\") }}\n        {% elif on_configuration_change == 'fail' %}\n            {{ exceptions.raise_fail_fast_error(\"Configuration changes were identified and `on_configuration_change` was set to `fail` for `\" ~ target_relation ~ \"`\") }}\n\n        {% else %}\n            -- this only happens if the user provides a value other than `apply`, 'continue', 'fail'\n            {{ exceptions.raise_compiler_error(\"Unexpected configuration scenario: `\" ~ on_configuration_change ~ \"`\") }}\n\n        {% endif %}\n\n    {% endif %}\n\n    {% do return(build_sql) %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.should_full_refresh", "macro.dbt.get_create_sql", "macro.dbt.get_replace_sql", "macro.dbt_snowflake.snowflake__get_dynamic_table_configuration_changes", "macro.dbt_snowflake.snowflake__get_alter_dynamic_table_as_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.278286, "supported_languages": null}, "macro.dbt_snowflake.dynamic_table_execute_no_op": {"name": "dynamic_table_execute_no_op", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/materializations/dynamic_table.sql", "original_file_path": "macros/materializations/dynamic_table.sql", "unique_id": "macro.dbt_snowflake.dynamic_table_execute_no_op", "macro_sql": "{% macro dynamic_table_execute_no_op(relation) %}\n    {% do store_raw_result(\n        name=\"main\",\n        message=\"skip \" ~ relation,\n        code=\"skip\",\n        rows_affected=\"-1\"\n    ) %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.2784262, "supported_languages": null}, "macro.dbt_snowflake.dynamic_table_execute_build_sql": {"name": "dynamic_table_execute_build_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/materializations/dynamic_table.sql", "original_file_path": "macros/materializations/dynamic_table.sql", "unique_id": "macro.dbt_snowflake.dynamic_table_execute_build_sql", "macro_sql": "{% macro dynamic_table_execute_build_sql(build_sql, existing_relation, target_relation) %}\n\n    {% set grant_config = config.get('grants') %}\n\n    {% call statement(name=\"main\") %}\n        {{ build_sql }}\n    {% endcall %}\n\n    {% set should_revoke = should_revoke(existing_relation, full_refresh_mode=True) %}\n    {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n    {% do persist_docs(target_relation, model) %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.278699, "supported_languages": null}, "macro.dbt_snowflake.snowflake__get_dynamic_table_configuration_changes": {"name": "snowflake__get_dynamic_table_configuration_changes", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/materializations/dynamic_table.sql", "original_file_path": "macros/materializations/dynamic_table.sql", "unique_id": "macro.dbt_snowflake.snowflake__get_dynamic_table_configuration_changes", "macro_sql": "{% macro snowflake__get_dynamic_table_configuration_changes(existing_relation, new_config) -%}\n    {% set _existing_dynamic_table = snowflake__describe_dynamic_table(existing_relation) %}\n    {% set _configuration_changes = existing_relation.dynamic_table_config_changeset(_existing_dynamic_table, new_config.model) %}\n    {% do return(_configuration_changes) %}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__describe_dynamic_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.2788649, "supported_languages": null}, "macro.dbt_snowflake.snowflake__can_clone_table": {"name": "snowflake__can_clone_table", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/materializations/clone.sql", "original_file_path": "macros/materializations/clone.sql", "unique_id": "macro.dbt_snowflake.snowflake__can_clone_table", "macro_sql": "{% macro snowflake__can_clone_table() %}\n    {{ return(True) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.278996, "supported_languages": null}, "macro.dbt_snowflake.snowflake__create_or_replace_clone": {"name": "snowflake__create_or_replace_clone", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/materializations/clone.sql", "original_file_path": "macros/materializations/clone.sql", "unique_id": "macro.dbt_snowflake.snowflake__create_or_replace_clone", "macro_sql": "{% macro snowflake__create_or_replace_clone(this_relation, defer_relation) %}\n    create or replace\n      {{ \"transient\" if config.get(\"transient\", true) }}\n      table {{ this_relation }}\n      clone {{ defer_relation }}\n      {{ \"copy grants\" if config.get(\"copy_grants\", false) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.2791622, "supported_languages": null}, "macro.dbt_snowflake.snowflake__get_merge_sql": {"name": "snowflake__get_merge_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/materializations/incremental/merge.sql", "original_file_path": "macros/materializations/incremental/merge.sql", "unique_id": "macro.dbt_snowflake.snowflake__get_merge_sql", "macro_sql": "{% macro snowflake__get_merge_sql(target, source_sql, unique_key, dest_columns, incremental_predicates) -%}\n\n    {#\n       Workaround for Snowflake not being happy with a merge on a constant-false predicate.\n       When no unique_key is provided, this macro will do a regular insert. If a unique_key\n       is provided, then this macro will do a proper merge instead.\n    #}\n\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute='name')) -%}\n    {%- set sql_header = config.get('sql_header', none) -%}\n\n    {%- set dml -%}\n    {%- if unique_key is none -%}\n\n        {{ sql_header if sql_header is not none }}\n\n        insert into {{ target }} ({{ dest_cols_csv }})\n        (\n            select {{ dest_cols_csv }}\n            from {{ source_sql }}\n        )\n\n    {%- else -%}\n\n        {{ default__get_merge_sql(target, source_sql, unique_key, dest_columns, incremental_predicates) }}\n\n    {%- endif -%}\n    {%- endset -%}\n\n    {% do return(snowflake_dml_explicit_transaction(dml)) %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_quoted_csv", "macro.dbt.default__get_merge_sql", "macro.dbt_snowflake.snowflake_dml_explicit_transaction"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.279816, "supported_languages": null}, "macro.dbt_snowflake.snowflake__get_delete_insert_merge_sql": {"name": "snowflake__get_delete_insert_merge_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/materializations/incremental/merge.sql", "original_file_path": "macros/materializations/incremental/merge.sql", "unique_id": "macro.dbt_snowflake.snowflake__get_delete_insert_merge_sql", "macro_sql": "{% macro snowflake__get_delete_insert_merge_sql(target, source, unique_key, dest_columns, incremental_predicates) %}\n    {% set dml = default__get_delete_insert_merge_sql(target, source, unique_key, dest_columns, incremental_predicates) %}\n    {% do return(snowflake_dml_explicit_transaction(dml)) %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_delete_insert_merge_sql", "macro.dbt_snowflake.snowflake_dml_explicit_transaction"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.279993, "supported_languages": null}, "macro.dbt_snowflake.snowflake__snapshot_merge_sql": {"name": "snowflake__snapshot_merge_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/materializations/incremental/merge.sql", "original_file_path": "macros/materializations/incremental/merge.sql", "unique_id": "macro.dbt_snowflake.snowflake__snapshot_merge_sql", "macro_sql": "{% macro snowflake__snapshot_merge_sql(target, source, insert_cols) %}\n    {% set dml = default__snapshot_merge_sql(target, source, insert_cols) %}\n    {% do return(snowflake_dml_explicit_transaction(dml)) %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__snapshot_merge_sql", "macro.dbt_snowflake.snowflake_dml_explicit_transaction"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.280143, "supported_languages": null}, "macro.dbt_snowflake.snowflake__get_incremental_append_sql": {"name": "snowflake__get_incremental_append_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/materializations/incremental/merge.sql", "original_file_path": "macros/materializations/incremental/merge.sql", "unique_id": "macro.dbt_snowflake.snowflake__get_incremental_append_sql", "macro_sql": "{% macro snowflake__get_incremental_append_sql(get_incremental_append_sql) %}\n    {% set dml = default__get_incremental_append_sql(get_incremental_append_sql) %}\n    {% do return(snowflake_dml_explicit_transaction(dml)) %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_incremental_append_sql", "macro.dbt_snowflake.snowflake_dml_explicit_transaction"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.28028, "supported_languages": null}, "macro.dbt_snowflake.snowflake__get_incremental_microbatch_sql": {"name": "snowflake__get_incremental_microbatch_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/materializations/incremental/merge.sql", "original_file_path": "macros/materializations/incremental/merge.sql", "unique_id": "macro.dbt_snowflake.snowflake__get_incremental_microbatch_sql", "macro_sql": "{% macro snowflake__get_incremental_microbatch_sql(arg_dict) %}\n    {%- set target = arg_dict[\"target_relation\"] -%}\n    {%- set source = arg_dict[\"temp_relation\"] -%}\n    {%- set dest_columns = arg_dict[\"dest_columns\"] -%}\n    {%- set incremental_predicates = [] if arg_dict.get('incremental_predicates') is none else arg_dict.get('incremental_predicates') -%}\n\n    {#-- Add additional incremental_predicates to filter for batch --#}\n    {% if model.batch and model.batch.event_time_start -%}\n        {% do incremental_predicates.append(\"DBT_INTERNAL_TARGET.\" ~ model.config.event_time ~ \" >= to_timestamp_tz('\" ~ model.config.__dbt_internal_microbatch_event_time_start ~ \"')\") %}\n    {% endif %}\n    {% if model.batch and model.batch.event_time_end -%}\n        {% do incremental_predicates.append(\"DBT_INTERNAL_TARGET.\" ~ model.config.event_time ~ \" < to_timestamp_tz('\" ~ model.config.__dbt_internal_microbatch_event_time_end ~ \"')\") %}\n    {% endif %}\n    {% do arg_dict.update({'incremental_predicates': incremental_predicates}) %}\n\n    delete from {{ target }} DBT_INTERNAL_TARGET\n    where (\n    {% for predicate in incremental_predicates %}\n        {%- if not loop.first %}and {% endif -%} {{ predicate }}\n    {% endfor %}\n    );\n\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n    insert into {{ target }} ({{ dest_cols_csv }})\n    (\n        select {{ dest_cols_csv }}\n        from {{ source }}\n    )\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_quoted_csv"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.280952, "supported_languages": null}, "macro.dbt_snowflake.get_incremental_insert_overwrite_sql": {"name": "get_incremental_insert_overwrite_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/materializations/incremental/insert_overwrite.sql", "original_file_path": "macros/materializations/incremental/insert_overwrite.sql", "unique_id": "macro.dbt_snowflake.get_incremental_insert_overwrite_sql", "macro_sql": "{% macro get_incremental_insert_overwrite_sql(arg_dict) -%}\n  {{ adapter.dispatch('insert_overwrite_get_sql', 'dbt')(arg_dict[\"target_relation\"], arg_dict[\"temp_relation\"], arg_dict[\"unique_key\"], arg_dict[\"dest_columns\"]) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__insert_overwrite_get_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.2812538, "supported_languages": null}, "macro.dbt_snowflake.snowflake__insert_overwrite_get_sql": {"name": "snowflake__insert_overwrite_get_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/materializations/incremental/insert_overwrite.sql", "original_file_path": "macros/materializations/incremental/insert_overwrite.sql", "unique_id": "macro.dbt_snowflake.snowflake__insert_overwrite_get_sql", "macro_sql": "{% macro snowflake__insert_overwrite_get_sql(target, source, unique_key, dest_columns) -%}\n\n    {%- set dml -%}\n\n    {%- set overwrite_columns = config.get('overwrite_columns', []) -%}\n\n    {{ config.get('sql_header', '') }}\n\n    {% set target_columns_list = '(' ~ ', '.join(overwrite_columns) ~ ')' if overwrite_columns else '' %}\n    {% set source_query_columns_list = ', '.join(overwrite_columns) if overwrite_columns else '*' %}\n    insert overwrite into {{ target.render() }} {{ target_columns_list }}\n        select {{ source_query_columns_list }}\n        from {{ source.render() }}\n\n    {%- endset -%}\n\n    {% do return(snowflake_dml_explicit_transaction(dml)) %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake_dml_explicit_transaction"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.281635, "supported_languages": null}, "macro.dbt_snowflake.snowflake__get_drop_sql": {"name": "snowflake__get_drop_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/relations/drop.sql", "original_file_path": "macros/relations/drop.sql", "unique_id": "macro.dbt_snowflake.snowflake__get_drop_sql", "macro_sql": "{% macro snowflake__get_drop_sql(relation) %}\n\n    {% if relation.is_dynamic_table %}\n        {{ snowflake__get_drop_dynamic_table_sql(relation) }}\n\n    {% else %}\n        {{ default__get_drop_sql(relation) }}\n\n    {% endif %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__get_drop_dynamic_table_sql", "macro.dbt.default__get_drop_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.281813, "supported_languages": null}, "macro.dbt_snowflake.snowflake__get_replace_sql": {"name": "snowflake__get_replace_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/relations/replace.sql", "original_file_path": "macros/relations/replace.sql", "unique_id": "macro.dbt_snowflake.snowflake__get_replace_sql", "macro_sql": "{% macro snowflake__get_replace_sql(existing_relation, target_relation, sql) %}\n\n    {% if existing_relation.is_dynamic_table and target_relation.is_dynamic_table %}\n        {{ snowflake__get_replace_dynamic_table_sql(target_relation, sql) }}\n\n    {% else %}\n        {{ default__get_replace_sql(existing_relation, target_relation, sql) }}\n\n    {% endif %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__get_replace_dynamic_table_sql", "macro.dbt.default__get_replace_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.282037, "supported_languages": null}, "macro.dbt_snowflake.snowflake__rename_relation": {"name": "snowflake__rename_relation", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/relations/rename.sql", "original_file_path": "macros/relations/rename.sql", "unique_id": "macro.dbt_snowflake.snowflake__rename_relation", "macro_sql": "{% macro snowflake__rename_relation(from_relation, to_relation) -%}\n  {% call statement('rename_relation') -%}\n    alter table {{ from_relation }} rename to {{ to_relation }}\n  {%- endcall %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.282186, "supported_languages": null}, "macro.dbt_snowflake.snowflake__get_create_backup_sql": {"name": "snowflake__get_create_backup_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/relations/create_backup.sql", "original_file_path": "macros/relations/create_backup.sql", "unique_id": "macro.dbt_snowflake.snowflake__get_create_backup_sql", "macro_sql": "{%- macro snowflake__get_create_backup_sql(relation) -%}\n\n    -- get the standard backup name\n    {% set backup_relation = make_backup_relation(relation, relation.type) %}\n\n    -- drop any pre-existing backup\n    {{ get_drop_sql(backup_relation) }};\n\n    -- use `render` to ensure that the fully qualified name is used\n    {{ get_rename_sql(relation, backup_relation.render()) }}\n\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt.make_backup_relation", "macro.dbt.get_drop_sql", "macro.dbt.get_rename_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.2823858, "supported_languages": null}, "macro.dbt_snowflake.snowflake__get_create_sql": {"name": "snowflake__get_create_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/relations/create.sql", "original_file_path": "macros/relations/create.sql", "unique_id": "macro.dbt_snowflake.snowflake__get_create_sql", "macro_sql": "{% macro snowflake__get_create_sql(relation, sql) %}\n\n    {% if relation.is_dynamic_table %}\n        {{ snowflake__get_create_dynamic_table_as_sql(relation, sql) }}\n\n    {% else %}\n        {{ default__get_create_sql(relation, sql) }}\n\n    {% endif %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__get_create_dynamic_table_as_sql", "macro.dbt.default__get_create_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.282584, "supported_languages": null}, "macro.dbt_snowflake.snowflake__get_rename_intermediate_sql": {"name": "snowflake__get_rename_intermediate_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/relations/rename_intermediate.sql", "original_file_path": "macros/relations/rename_intermediate.sql", "unique_id": "macro.dbt_snowflake.snowflake__get_rename_intermediate_sql", "macro_sql": "{%- macro snowflake__get_rename_intermediate_sql(relation) -%}\n\n    -- get the standard intermediate name\n    {% set intermediate_relation = make_intermediate_relation(relation) %}\n\n    -- use `render` to ensure that the fully qualified name is used\n    {{ get_rename_sql(intermediate_relation, relation.render()) }}\n\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt.make_intermediate_relation", "macro.dbt.get_rename_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.2828119, "supported_languages": null}, "macro.dbt_snowflake.snowflake__get_drop_table_sql": {"name": "snowflake__get_drop_table_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/relations/table/drop.sql", "original_file_path": "macros/relations/table/drop.sql", "unique_id": "macro.dbt_snowflake.snowflake__get_drop_table_sql", "macro_sql": "{% macro snowflake__get_drop_table_sql(relation) %}\n    drop table if exists {{ relation }} cascade\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.282948, "supported_languages": null}, "macro.dbt_snowflake.snowflake__get_replace_table_sql": {"name": "snowflake__get_replace_table_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/relations/table/replace.sql", "original_file_path": "macros/relations/table/replace.sql", "unique_id": "macro.dbt_snowflake.snowflake__get_replace_table_sql", "macro_sql": "{% macro snowflake__get_replace_table_sql(relation, sql) %}\n    {{ snowflake__create_table_as(False, relation, sql) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__create_table_as"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.283079, "supported_languages": null}, "macro.dbt_snowflake.snowflake__get_rename_table_sql": {"name": "snowflake__get_rename_table_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/relations/table/rename.sql", "original_file_path": "macros/relations/table/rename.sql", "unique_id": "macro.dbt_snowflake.snowflake__get_rename_table_sql", "macro_sql": "{%- macro snowflake__get_rename_table_sql(relation, new_name) -%}\n    /*\n    Rename or move a table to the new name.\n\n    Args:\n        relation: SnowflakeRelation - relation to be renamed\n        new_name: Union[str, SnowflakeRelation] - new name for `relation`\n            if providing a string, the default database/schema will be used if that string is just an identifier\n            if providing a SnowflakeRelation, `render` will be used to produce a fully qualified name\n    Returns: templated string\n    */\n    alter table {{ relation }} rename to {{ new_name }}\n{%- endmacro -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.283227, "supported_languages": null}, "macro.dbt_snowflake.snowflake__create_table_as": {"name": "snowflake__create_table_as", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/relations/table/create.sql", "original_file_path": "macros/relations/table/create.sql", "unique_id": "macro.dbt_snowflake.snowflake__create_table_as", "macro_sql": "{% macro snowflake__create_table_as(temporary, relation, compiled_code, language='sql') -%}\n\n    {%- set catalog_relation = adapter.build_catalog_relation(config.model) -%}\n\n    {%- if language == 'sql' -%}\n        {%- if temporary -%}\n            {{ snowflake__create_table_temporary_sql(relation, compiled_code) }}\n        {%- elif catalog_relation.catalog_type == 'INFO_SCHEMA' -%}\n            {{ snowflake__create_table_info_schema_sql(relation, compiled_code) }}\n        {%- elif catalog_relation.catalog_type == 'BUILT_IN' -%}\n            {{ snowflake__create_table_built_in_sql(relation, compiled_code) }}\n        {%- elif catalog_relation.catalog_type == 'ICEBERG_REST' -%}\n            {{ snowflake__create_table_iceberg_rest_sql(relation, compiled_code) }}\n        {%- else -%}\n            {% do exceptions.raise_compiler_error('Unexpected model config for: ' ~ relation) %}\n        {%- endif -%}\n\n    {%- elif language == 'python' -%}\n        {%- if catalog_relation.catalog_type == 'BUILT_IN' %}\n            {% do exceptions.raise_compiler_error('Iceberg is incompatible with Python models. Please use a SQL model for the iceberg format.') %}\n        {%- else -%}\n            {{ py_write_table(compiled_code, relation) }}\n        {%- endif %}\n\n    {%- else -%}\n        {% do exceptions.raise_compiler_error(\"snowflake__create_table_as macro didn't get supported language, it got %s\" % language) %}\n\n    {%- endif -%}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__create_table_temporary_sql", "macro.dbt_snowflake.snowflake__create_table_info_schema_sql", "macro.dbt_snowflake.snowflake__create_table_built_in_sql", "macro.dbt_snowflake.snowflake__create_table_iceberg_rest_sql", "macro.dbt_snowflake.py_write_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.284653, "supported_languages": null}, "macro.dbt_snowflake.snowflake__create_table_temporary_sql": {"name": "snowflake__create_table_temporary_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/relations/table/create.sql", "original_file_path": "macros/relations/table/create.sql", "unique_id": "macro.dbt_snowflake.snowflake__create_table_temporary_sql", "macro_sql": "{% macro snowflake__create_table_temporary_sql(relation, compiled_code) -%}\n{#-\n    Implements CREATE TEMPORARY TABLE and CREATE TEMPORARY TABLE ... AS SELECT:\n    https://docs.snowflake.com/en/sql-reference/sql/create-table\n    https://docs.snowflake.com/en/sql-reference/sql/create-table#create-table-as-select-also-referred-to-as-ctas\n-#}\n\n{%- set contract_config = config.get('contract') -%}\n{%- if contract_config.enforced -%}\n    {{- get_assert_columns_equivalent(compiled_code) -}}\n    {%- set compiled_code = get_select_subquery(compiled_code) -%}\n{%- endif -%}\n\n{%- set sql_header = config.get('sql_header', none) -%}\n{{ sql_header if sql_header is not none }}\n\ncreate or replace temporary table {{ relation }}\n    {%- if contract_config.enforced %}\n    {{ get_table_columns_and_constraints() }}\n    {%- endif %}\nas (\n    {{ compiled_code }}\n    )\n;\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.get_assert_columns_equivalent", "macro.dbt.get_select_subquery", "macro.dbt.get_table_columns_and_constraints"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.284981, "supported_languages": null}, "macro.dbt_snowflake.snowflake__create_table_info_schema_sql": {"name": "snowflake__create_table_info_schema_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/relations/table/create.sql", "original_file_path": "macros/relations/table/create.sql", "unique_id": "macro.dbt_snowflake.snowflake__create_table_info_schema_sql", "macro_sql": "{% macro snowflake__create_table_info_schema_sql(relation, compiled_code) -%}\n{#-\n    Implements CREATE TABLE and CREATE TABLE ... AS SELECT:\n    https://docs.snowflake.com/en/sql-reference/sql/create-table\n    https://docs.snowflake.com/en/sql-reference/sql/create-table#create-table-as-select-also-referred-to-as-ctas\n-#}\n\n{%- set catalog_relation = adapter.build_catalog_relation(config.model) -%}\n\n{%- if catalog_relation.is_transient -%}\n    {%- set transient='transient ' -%}\n{%- else -%}\n    {%- set transient='' -%}\n{%- endif -%}\n\n{%- set copy_grants = config.get('copy_grants', default=false) -%}\n\n{%- set row_access_policy = config.get('row_access_policy', default=none) -%}\n{%- set table_tag = config.get('table_tag', default=none) -%}\n\n{%- set contract_config = config.get('contract') -%}\n{%- if contract_config.enforced -%}\n    {{- get_assert_columns_equivalent(compiled_code) -}}\n    {%- set compiled_code = get_select_subquery(compiled_code) -%}\n{%- endif -%}\n\n{%- set sql_header = config.get('sql_header', none) -%}\n{{ sql_header if sql_header is not none }}\n\ncreate or replace {{ transient }}table {{ relation }}\n    {%- set contract_config = config.get('contract') -%}\n    {%- if contract_config.enforced %}\n    {{ get_table_columns_and_constraints() }}\n    {%- endif %}\n    {% if copy_grants -%} copy grants {%- endif %}\n    {% if row_access_policy -%} with row access policy {{ row_access_policy }} {%- endif %}\n    {% if table_tag -%} with tag ({{ table_tag }}) {%- endif %}\n    as (\n        {%- if catalog_relation.cluster_by is not none -%}\n        select * from (\n            {{ compiled_code }}\n        )\n        order by (\n            {{ catalog_relation.cluster_by }}\n        )\n        {%- else -%}\n        {{ compiled_code }}\n        {%- endif %}\n    )\n;\n\n{% if catalog_relation.cluster_by is not none -%}\nalter table {{ relation }} cluster by ({{ catalog_relation.cluster_by }});\n{%- endif -%}\n\n{% if catalog_relation.automatic_clustering and catalog_relation.cluster_by is not none %}\nalter table {{ relation }} resume recluster;\n{%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.get_assert_columns_equivalent", "macro.dbt.get_select_subquery", "macro.dbt.get_table_columns_and_constraints"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.2858508, "supported_languages": null}, "macro.dbt_snowflake.snowflake__create_table_built_in_sql": {"name": "snowflake__create_table_built_in_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/relations/table/create.sql", "original_file_path": "macros/relations/table/create.sql", "unique_id": "macro.dbt_snowflake.snowflake__create_table_built_in_sql", "macro_sql": "{% macro snowflake__create_table_built_in_sql(relation, compiled_code) -%}\n{#-\n    Implements CREATE ICEBERG TABLE and CREATE ICEBERG TABLE ... AS SELECT (Snowflake as the Iceberg catalog):\n    https://docs.snowflake.com/en/sql-reference/sql/create-iceberg-table-snowflake\n\n    Limitations:\n    - Iceberg does not support temporary tables (use a standard Snowflake table)\n-#}\n\n{%- set catalog_relation = adapter.build_catalog_relation(config.model) -%}\n\n{%- set copy_grants = config.get('copy_grants', default=false) -%}\n\n{%- set row_access_policy = config.get('row_access_policy', default=none) -%}\n{%- set table_tag = config.get('table_tag', default=none) -%}\n\n{%- set contract_config = config.get('contract') -%}\n{%- if contract_config.enforced -%}\n    {{- get_assert_columns_equivalent(compiled_code) -}}\n    {%- set compiled_code = get_select_subquery(compiled_code) -%}\n{%- endif -%}\n\n{%- set sql_header = config.get('sql_header', none) -%}\n{{ sql_header if sql_header is not none }}\n\ncreate or replace iceberg table {{ relation }}\n    {%- if contract_config.enforced %}\n    {{ get_table_columns_and_constraints() }}\n    {%- endif %}\n    {{ optional('external_volume', catalog_relation.external_volume, \"'\") }}\n    catalog = 'SNOWFLAKE'  -- required, and always SNOWFLAKE for built-in Iceberg tables\n    base_location = '{{ catalog_relation.base_location }}'\n    {{ optional('storage_serialization_policy', catalog_relation.storage_serialization_policy, \"'\")}}\n    {{ optional('max_data_extension_time_in_days', catalog_relation.max_data_extension_time_in_days)}}\n    {{ optional('data_retention_time_in_days', catalog_relation.data_retention_time_in_days)}}\n    {{ optional('change_tracking', catalog_relation.change_tracking)}}\n    {% if row_access_policy -%} with row access policy {{ row_access_policy }} {%- endif %}\n    {% if table_tag -%} with tag ({{ table_tag }}) {%- endif %}\n    {% if copy_grants -%} copy grants {%- endif %}\nas (\n    {%- if catalog_relation.cluster_by is not none -%}\n    select * from (\n        {{ compiled_code }}\n    )\n    order by (\n        {{ catalog_relation.cluster_by }}\n    )\n    {%- else -%}\n    {{ compiled_code }}\n    {%- endif %}\n    )\n;\n\n{% if catalog_relation.cluster_by is not none -%}\nalter iceberg table {{ relation }} cluster by ({{ catalog_relation.cluster_by }});\n{%- endif -%}\n\n{% if catalog_relation.automatic_clustering and catalog_relation.cluster_by is not none %}\nalter iceberg table {{ relation }} resume recluster;\n{%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.get_assert_columns_equivalent", "macro.dbt.get_select_subquery", "macro.dbt.get_table_columns_and_constraints", "macro.dbt_snowflake.optional"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.286819, "supported_languages": null}, "macro.dbt_snowflake.snowflake__create_table_iceberg_rest_sql": {"name": "snowflake__create_table_iceberg_rest_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/relations/table/create.sql", "original_file_path": "macros/relations/table/create.sql", "unique_id": "macro.dbt_snowflake.snowflake__create_table_iceberg_rest_sql", "macro_sql": "{% macro snowflake__create_table_iceberg_rest_sql(relation, compiled_code) -%}\n{#-\n    Implements CREATE ICEBERG TABLE ... CATALOG('catalog_name') (external REST catalog):\n    https://docs.snowflake.com/en/sql-reference/sql/create-iceberg-table-rest\n\n    Limitations:\n    - Iceberg does not support temporary tables (use a standard Snowflake table)\n    - Iceberg REST does not support CREATE OR REPLACE\n    - Iceberg catalogs do not support table renaming operations\n    - For existing tables, we must DROP the table first before creating the new one\n-#}\n\n{%- set catalog_relation = adapter.build_catalog_relation(config.model) -%}\n\n{%- set copy_grants = config.get('copy_grants', default=false) -%}\n\n{%- set row_access_policy = config.get('row_access_policy', default=none) -%}\n{%- set table_tag = config.get('table_tag', default=none) -%}\n\n{%- set contract_config = config.get('contract') -%}\n{%- if contract_config.enforced -%}\n    {{- get_assert_columns_equivalent(compiled_code) -}}\n    {%- set compiled_code = get_select_subquery(compiled_code) -%}\n{%- endif -%}\n\n{%- set sql_header = config.get('sql_header', none) -%}\n{{ sql_header if sql_header is not none }}\n\n{# Check if relation exists #}\n{% set existing_relation = adapter.get_relation(database=relation.database, schema=relation.schema, identifier=relation.identifier) %}\n\n{% if existing_relation %}\n    {# Iceberg catalogs don't support table renaming, so we must drop first #}\n    {# This is less safe but the only option for Iceberg REST catalogs #}\n    drop table if exists {{ existing_relation }};\n\n{% endif %}\n\n{# Create the table (works for both new and replacement scenarios) #}\ncreate iceberg table {{ relation }}\n    {%- if contract_config.enforced %}\n    {{ get_table_columns_and_constraints() }}\n    {%- endif %}\n    {{ optional('external_volume', catalog_relation.external_volume, \"'\") }}\n    {%- if not catalog_relation|attr('catalog_linked_database') -%}\n    catalog = '{{ catalog_relation.catalog_name }}'  -- external REST catalog name\n    {{ optional('base_location', catalog_relation.base_location, \"'\") }}\n    {%- endif %}\n    {{ optional('target_file_size', catalog_relation.target_file_size, \"'\") }}\n    {{ optional('auto_refresh', catalog_relation.auto_refresh) }}\n    {{ optional('max_data_extension_time_in_days', catalog_relation.max_data_extension_time_in_days)}}\n    {% if row_access_policy -%} with row access policy {{ row_access_policy }} {%- endif %}\n    {% if table_tag -%} with tag ({{ table_tag }}) {%- endif %}\n    {% if copy_grants -%} copy grants {%- endif %}\nas (\n    {{ compiled_code }}\n);\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.get_assert_columns_equivalent", "macro.dbt.get_select_subquery", "macro.dbt.get_table_columns_and_constraints", "macro.dbt_snowflake.optional"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.287773, "supported_languages": null}, "macro.dbt_snowflake.py_write_table": {"name": "py_write_table", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/relations/table/create.sql", "original_file_path": "macros/relations/table/create.sql", "unique_id": "macro.dbt_snowflake.py_write_table", "macro_sql": "{% macro py_write_table(compiled_code, target_relation) %}\n\n{%- set catalog_relation = adapter.build_catalog_relation(config.model) -%}\n\n{% if catalog_relation.is_transient %}\n    {%- set table_type='transient' -%}\n{% endif %}\n\n{{ compiled_code }}\n\n\ndef materialize(session, df, target_relation):\n    # make sure pandas exists\n    import importlib.util\n    package_name = 'pandas'\n    if importlib.util.find_spec(package_name):\n        import pandas\n        if isinstance(df, pandas.core.frame.DataFrame):\n            session.use_database(target_relation.database)\n            session.use_schema(target_relation.schema)\n            # session.write_pandas does not have overwrite function\n            df = session.createDataFrame(df)\n    {% set target_relation_name = resolve_model_name(target_relation) %}\n    df.write.mode(\"overwrite\").save_as_table('{{ target_relation_name }}', table_type='{{table_type}}')\n\n\ndef main(session):\n    dbt = dbtObj(session.table)\n    df = model(dbt, session)\n    materialize(session, df, dbt.this)\n    return \"OK\"\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.resolve_model_name"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.288052, "supported_languages": null}, "macro.dbt_snowflake.snowflake__get_drop_view_sql": {"name": "snowflake__get_drop_view_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/relations/view/drop.sql", "original_file_path": "macros/relations/view/drop.sql", "unique_id": "macro.dbt_snowflake.snowflake__get_drop_view_sql", "macro_sql": "{% macro snowflake__get_drop_view_sql(relation) %}\n    drop view if exists {{ relation }} cascade\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.288157, "supported_languages": null}, "macro.dbt_snowflake.snowflake__get_replace_view_sql": {"name": "snowflake__get_replace_view_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/relations/view/replace.sql", "original_file_path": "macros/relations/view/replace.sql", "unique_id": "macro.dbt_snowflake.snowflake__get_replace_view_sql", "macro_sql": "{% macro snowflake__get_replace_view_sql(relation, sql) %}\n    {{ snowflake__create_view_as(relation, sql) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__create_view_as"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.2882729, "supported_languages": null}, "macro.dbt_snowflake.snowflake__get_rename_view_sql": {"name": "snowflake__get_rename_view_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/relations/view/rename.sql", "original_file_path": "macros/relations/view/rename.sql", "unique_id": "macro.dbt_snowflake.snowflake__get_rename_view_sql", "macro_sql": "{%- macro snowflake__get_rename_view_sql(relation, new_name) -%}\n    /*\n    Rename or move a view to the new name.\n\n    Args:\n        relation: SnowflakeRelation - relation to be renamed\n        new_name: Union[str, SnowflakeRelation] - new name for `relation`\n            if providing a string, the default database/schema will be used if that string is just an identifier\n            if providing a SnowflakeRelation, `render` will be used to produce a fully qualified name\n    Returns: templated string\n    */\n    alter view {{ relation }} rename to {{ new_name }}\n{%- endmacro -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.288419, "supported_languages": null}, "macro.dbt_snowflake.snowflake__create_view_as_with_temp_flag": {"name": "snowflake__create_view_as_with_temp_flag", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/relations/view/create.sql", "original_file_path": "macros/relations/view/create.sql", "unique_id": "macro.dbt_snowflake.snowflake__create_view_as_with_temp_flag", "macro_sql": "{% macro snowflake__create_view_as_with_temp_flag(relation, sql, is_temporary=False) -%}\n  {%- set secure = config.get('secure', default=false) -%}\n  {%- set copy_grants = config.get('copy_grants', default=false) -%}\n  {%- set row_access_policy = config.get('row_access_policy', default=none) -%}\n  {%- set table_tag = config.get('table_tag', default=none) -%}\n  {%- set sql_header = config.get('sql_header', none) -%}\n\n  {{ sql_header if sql_header is not none }}\n  create or replace {% if secure -%}\n    secure\n  {%- endif %} {% if is_temporary -%}\n    temporary\n  {%- endif %} view {{ relation }}\n  {% if config.persist_column_docs() -%}\n    {% set model_columns = model.columns %}\n    {% set query_columns = get_columns_in_query(sql) %}\n    {{ get_persist_docs_column_list(model_columns, query_columns) }}\n\n  {%- endif %}\n  {%- set contract_config = config.get('contract') -%}\n  {%- if contract_config.enforced -%}\n    {{ get_assert_columns_equivalent(sql) }}\n  {%- endif %}\n  {% if copy_grants -%} copy grants {%- endif %}\n  {% if row_access_policy -%} with row access policy {{ row_access_policy }} {%- endif %}\n  {% if table_tag -%} with tag ({{ table_tag }}) {%- endif %}\n  as (\n    {{ sql }}\n  );\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_columns_in_query", "macro.dbt_snowflake.get_persist_docs_column_list", "macro.dbt.get_assert_columns_equivalent"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.289361, "supported_languages": null}, "macro.dbt_snowflake.snowflake__create_view_as": {"name": "snowflake__create_view_as", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/relations/view/create.sql", "original_file_path": "macros/relations/view/create.sql", "unique_id": "macro.dbt_snowflake.snowflake__create_view_as", "macro_sql": "{% macro snowflake__create_view_as(relation, sql) -%}\n  {{ snowflake__create_view_as_with_temp_flag(relation, sql) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__create_view_as_with_temp_flag"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.289493, "supported_languages": null}, "macro.dbt_snowflake.snowflake__create_or_replace_view": {"name": "snowflake__create_or_replace_view", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/relations/view/create.sql", "original_file_path": "macros/relations/view/create.sql", "unique_id": "macro.dbt_snowflake.snowflake__create_or_replace_view", "macro_sql": "{% macro snowflake__create_or_replace_view() %}\n  {%- set identifier = model['alias'] -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n  {%- set exists_as_view = (old_relation is not none and old_relation.is_view) -%}\n\n  {%- set target_relation = api.Relation.create(\n      identifier=identifier, schema=schema, database=database,\n      type='view') -%}\n  {% set grant_config = config.get('grants') %}\n\n  {{ run_hooks(pre_hooks) }}\n\n  -- If there's a table with the same name and we weren't told to full refresh,\n  -- that's an error. If we were told to full refresh, drop it. This behavior differs\n  -- for Snowflake and BigQuery, so multiple dispatch is used.\n  {%- if old_relation is not none and not old_relation.is_view -%}\n    {{ handle_existing_table(should_full_refresh(), old_relation) }}\n  {%- endif -%}\n\n  -- build model\n  {% call statement('main') -%}\n    {{ get_create_view_as_sql(target_relation, sql) }}\n  {%- endcall %}\n\n  {% set should_revoke = should_revoke(exists_as_view, full_refresh_mode=True) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n  {{ run_hooks(post_hooks) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.handle_existing_table", "macro.dbt.should_full_refresh", "macro.dbt.statement", "macro.dbt.get_create_view_as_sql", "macro.dbt.should_revoke", "macro.dbt.apply_grants"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.290126, "supported_languages": null}, "macro.dbt_snowflake.snowflake__get_drop_dynamic_table_sql": {"name": "snowflake__get_drop_dynamic_table_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/relations/dynamic_table/drop.sql", "original_file_path": "macros/relations/dynamic_table/drop.sql", "unique_id": "macro.dbt_snowflake.snowflake__get_drop_dynamic_table_sql", "macro_sql": "{% macro snowflake__get_drop_dynamic_table_sql(relation) %}\n    drop dynamic table if exists {{ relation }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.2902231, "supported_languages": null}, "macro.dbt_snowflake.snowflake__get_replace_dynamic_table_sql": {"name": "snowflake__get_replace_dynamic_table_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/relations/dynamic_table/replace.sql", "original_file_path": "macros/relations/dynamic_table/replace.sql", "unique_id": "macro.dbt_snowflake.snowflake__get_replace_dynamic_table_sql", "macro_sql": "{% macro snowflake__get_replace_dynamic_table_sql(relation, sql) -%}\n{#-\n    Produce DDL that replaces a dynamic table with a new dynamic table\n\n    Args:\n    - relation: Union[SnowflakeRelation, str]\n        - SnowflakeRelation - required for relation.render()\n        - str - is already the rendered relation name\n    - sql: str - the code defining the model\n    Globals:\n    - config: NodeConfig - contains the attribution required to produce a SnowflakeDynamicTableConfig\n    Returns:\n        A valid DDL statement which will result in a new dynamic table.\n-#}\n\n    {%- set dynamic_table = relation.from_config(config.model) -%}\n    {%- set catalog_relation = adapter.build_catalog_relation(config.model) -%}\n\n    {%- if catalog_relation.catalog_type == 'INFO_SCHEMA' -%}\n        {{ snowflake__replace_dynamic_table_info_schema_sql(dynamic_table, relation, sql) }}\n    {%- elif catalog_relation.catalog_type == 'BUILT_IN' -%}\n        {{ snowflake__replace_dynamic_table_built_in_sql(dynamic_table, relation, sql) }}\n    {%- else -%}\n        {% do exceptions.raise_compiler_error('Unexpected model config for: ' ~ relation) %}\n    {%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__replace_dynamic_table_info_schema_sql", "macro.dbt_snowflake.snowflake__replace_dynamic_table_built_in_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.290781, "supported_languages": null}, "macro.dbt_snowflake.snowflake__replace_dynamic_table_info_schema_sql": {"name": "snowflake__replace_dynamic_table_info_schema_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/relations/dynamic_table/replace.sql", "original_file_path": "macros/relations/dynamic_table/replace.sql", "unique_id": "macro.dbt_snowflake.snowflake__replace_dynamic_table_info_schema_sql", "macro_sql": "{% macro snowflake__replace_dynamic_table_info_schema_sql(dynamic_table, relation, sql) -%}\n{#-\n    Produce DDL that replaces an info schema dynamic table with a new info schema dynamic table\n\n    This follows the syntax outlined here:\n    https://docs.snowflake.com/en/sql-reference/sql/create-dynamic-table#syntax\n\n    Args:\n    - dynamic_table: SnowflakeDynamicTableConfig - contains all of the configuration for the dynamic table\n    - relation: Union[SnowflakeRelation, str]\n        - SnowflakeRelation - required for relation.render()\n        - str - is already the rendered relation name\n    - sql: str - the code defining the model\n    Returns:\n        A valid DDL statement which will result in a new dynamic info schema table.\n-#}\n\ncreate or replace dynamic table {{ relation }}\n    target_lag = '{{ dynamic_table.target_lag }}'\n    warehouse = {{ dynamic_table.snowflake_warehouse }}\n    {{ optional('refresh_mode', dynamic_table.refresh_mode) }}\n    {{ optional('initialize', dynamic_table.initialize) }}\n    {{ optional('with row access policy', dynamic_table.row_access_policy, equals_char='') }}\n    {{ optional('with tag', dynamic_table.table_tag, quote_char='(', equals_char='') }}\n    as (\n        {{ sql }}\n    )\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.optional"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.29108, "supported_languages": null}, "macro.dbt_snowflake.snowflake__replace_dynamic_table_built_in_sql": {"name": "snowflake__replace_dynamic_table_built_in_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/relations/dynamic_table/replace.sql", "original_file_path": "macros/relations/dynamic_table/replace.sql", "unique_id": "macro.dbt_snowflake.snowflake__replace_dynamic_table_built_in_sql", "macro_sql": "{% macro snowflake__replace_dynamic_table_built_in_sql(dynamic_table, relation, sql) -%}\n{#-\n    Produce DDL that replaces a dynamic iceberg table with a new dynamic iceberg table\n\n    This follows the syntax outlined here:\n    https://docs.snowflake.com/en/sql-reference/sql/create-dynamic-table#create-dynamic-iceberg-table\n\n    Args:\n    - dynamic_table: SnowflakeDynamicTableConfig - contains all of the configuration for the dynamic table\n    - relation: Union[SnowflakeRelation, str]\n        - SnowflakeRelation - required for relation.render()\n        - str - is already the rendered relation name\n    - sql: str - the code defining the model\n    Returns:\n        A valid DDL statement which will result in a new dynamic iceberg table.\n-#}\n\n{%- set catalog_relation = adapter.build_catalog_relation(config.model) -%}\n\ncreate or replace dynamic iceberg table {{ relation }}\n    target_lag = '{{ dynamic_table.target_lag }}'\n    warehouse = {{ dynamic_table.snowflake_warehouse }}\n    {{ optional('external_volume', catalog_relation.external_volume, \"'\") }}\n    catalog = 'snowflake'\n    base_location = '{{ catalog_relation.base_location }}'\n    {{ optional('refresh_mode', dynamic_table.refresh_mode) }}\n    {{ optional('initialize', dynamic_table.initialize) }}\n    {{ optional('row_access_policy', dynamic_table.row_access_policy) }}\n    {{ optional('table_tag', dynamic_table.table_tag) }}\n    as (\n        {{ sql }}\n    )\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.optional"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.2914371, "supported_languages": null}, "macro.dbt_snowflake.snowflake__describe_dynamic_table": {"name": "snowflake__describe_dynamic_table", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/relations/dynamic_table/describe.sql", "original_file_path": "macros/relations/dynamic_table/describe.sql", "unique_id": "macro.dbt_snowflake.snowflake__describe_dynamic_table", "macro_sql": "{% macro snowflake__describe_dynamic_table(relation) %}\n    {%- set results = adapter.describe_dynamic_table(relation) -%}\n    {%- do return(results) -%}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.291577, "supported_languages": null}, "macro.dbt_snowflake.snowflake__refresh_dynamic_table": {"name": "snowflake__refresh_dynamic_table", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/relations/dynamic_table/refresh.sql", "original_file_path": "macros/relations/dynamic_table/refresh.sql", "unique_id": "macro.dbt_snowflake.snowflake__refresh_dynamic_table", "macro_sql": "{% macro snowflake__refresh_dynamic_table(relation) -%}\n    {{- log('Applying REFRESH to: ' ~ relation) -}}\n\n    alter dynamic table {{ relation }} refresh\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.291701, "supported_languages": null}, "macro.dbt_snowflake.snowflake__get_alter_dynamic_table_as_sql": {"name": "snowflake__get_alter_dynamic_table_as_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/relations/dynamic_table/alter.sql", "original_file_path": "macros/relations/dynamic_table/alter.sql", "unique_id": "macro.dbt_snowflake.snowflake__get_alter_dynamic_table_as_sql", "macro_sql": "{% macro snowflake__get_alter_dynamic_table_as_sql(\n    existing_relation,\n    configuration_changes,\n    target_relation,\n    sql\n) -%}\n    {{- log('Applying ALTER to: ' ~ existing_relation) -}}\n\n    {% if configuration_changes.requires_full_refresh %}\n        {{- get_replace_sql(existing_relation, target_relation, sql) -}}\n\n    {% else %}\n\n        {%- set target_lag = configuration_changes.target_lag -%}\n        {%- if target_lag -%}{{- log('Applying UPDATE TARGET_LAG to: ' ~ existing_relation) -}}{%- endif -%}\n        {%- set snowflake_warehouse = configuration_changes.snowflake_warehouse -%}\n        {%- if snowflake_warehouse -%}{{- log('Applying UPDATE WAREHOUSE to: ' ~ existing_relation) -}}{%- endif -%}\n\n        alter dynamic table {{ existing_relation }} set\n            {% if target_lag %}target_lag = '{{ target_lag.context }}'{% endif %}\n            {% if snowflake_warehouse %}warehouse = {{ snowflake_warehouse.context }}{% endif %}\n\n    {%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.get_replace_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.2922099, "supported_languages": null}, "macro.dbt_snowflake.snowflake__get_create_dynamic_table_as_sql": {"name": "snowflake__get_create_dynamic_table_as_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/relations/dynamic_table/create.sql", "original_file_path": "macros/relations/dynamic_table/create.sql", "unique_id": "macro.dbt_snowflake.snowflake__get_create_dynamic_table_as_sql", "macro_sql": "{% macro snowflake__get_create_dynamic_table_as_sql(relation, sql) -%}\n\n    {%- set catalog_relation = adapter.build_catalog_relation(config.model) -%}\n    {%- set dynamic_table = relation.from_config(config.model) -%}\n\n    {%- if catalog_relation.catalog_type == 'INFO_SCHEMA' -%}\n        {{ snowflake__create_dynamic_table_info_schema_sql(dynamic_table, relation, compiled_code) }}\n    {%- elif catalog_relation.catalog_type == 'BUILT_IN' -%}\n        {{ snowflake__create_dynamic_table_built_in_sql(dynamic_table, relation, compiled_code) }}\n    {%- else -%}\n        {% do exceptions.raise_compiler_error('Unexpected model config for: ' ~ relation) %}\n    {%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__create_dynamic_table_info_schema_sql", "macro.dbt_snowflake.snowflake__create_dynamic_table_built_in_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.292761, "supported_languages": null}, "macro.dbt_snowflake.snowflake__create_dynamic_table_info_schema_sql": {"name": "snowflake__create_dynamic_table_info_schema_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/relations/dynamic_table/create.sql", "original_file_path": "macros/relations/dynamic_table/create.sql", "unique_id": "macro.dbt_snowflake.snowflake__create_dynamic_table_info_schema_sql", "macro_sql": "{% macro snowflake__create_dynamic_table_info_schema_sql(dynamic_table, relation, sql) -%}\n{#-\n    Produce DDL that creates an info schema dynamic table\n\n    Implements CREATE DYNAMIC TABLE:\n    https://docs.snowflake.com/en/sql-reference/sql/create-dynamic-table#syntax\n\n    Args:\n    - dynamic_table: SnowflakeDynamicTableConfig - contains all of the configuration for the dynamic table\n    - relation: Union[SnowflakeRelation, str]\n        - SnowflakeRelation - required for relation.render()\n        - str - is already the rendered relation name\n    - sql: str - the code defining the model\n    Returns:\n        A valid DDL statement which will result in a new dynamic info schema table.\n-#}\n\n    create dynamic table {{ relation }}\n        target_lag = '{{ dynamic_table.target_lag }}'\n        warehouse = {{ dynamic_table.snowflake_warehouse }}\n        {{ optional('refresh_mode', dynamic_table.refresh_mode) }}\n        {{ optional('initialize', dynamic_table.initialize) }}\n        {{ optional('with row access policy', dynamic_table.row_access_policy, equals_char='') }}\n        {{ optional('with tag', dynamic_table.table_tag, quote_char='(', equals_char='') }}\n        as (\n            {{ sql }}\n        )\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.optional"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.293061, "supported_languages": null}, "macro.dbt_snowflake.snowflake__create_dynamic_table_built_in_sql": {"name": "snowflake__create_dynamic_table_built_in_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/relations/dynamic_table/create.sql", "original_file_path": "macros/relations/dynamic_table/create.sql", "unique_id": "macro.dbt_snowflake.snowflake__create_dynamic_table_built_in_sql", "macro_sql": "{% macro snowflake__create_dynamic_table_built_in_sql(dynamic_table, relation, sql) -%}\n{#-\n    Produce DDL that creates a dynamic iceberg table\n\n    Implements CREATE DYNAMIC ICEBERG TABLE (Snowflake as the Iceberg catalog):\n    https://docs.snowflake.com/en/sql-reference/sql/create-dynamic-table#create-dynamic-iceberg-table\n\n    Args:\n    - dynamic_table: SnowflakeDynamicTableConfig - contains all of the configuration for the dynamic table\n    - relation: Union[SnowflakeRelation, str]\n        - SnowflakeRelation - required for relation.render()\n        - str - is already the rendered relation name\n    - sql: str - the code defining the model\n    Returns:\n        A valid DDL statement which will result in a new dynamic iceberg table.\n-#}\n\n{%- set catalog_relation = adapter.build_catalog_relation(config.model) -%}\n\n    create dynamic iceberg table {{ relation }}\n        target_lag = '{{ dynamic_table.target_lag }}'\n        warehouse = {{ dynamic_table.snowflake_warehouse }}\n        {{ optional('external_volume', catalog_relation.external_volume, \"'\") }}\n        catalog = 'SNOWFLAKE'  -- required, and always SNOWFLAKE for built-in Iceberg tables\n        base_location = '{{ catalog_relation.base_location }}'\n        {{ optional('refresh_mode', dynamic_table.refresh_mode) }}\n        {{ optional('initialize', dynamic_table.initialize) }}\n        {{ optional('row_access_policy', dynamic_table.row_access_policy) }}\n        {{ optional('table_tag', dynamic_table.table_tag) }}\n        as (\n            {{ sql }}\n        )\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.optional"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.2934148, "supported_languages": null}, "macro.dbt_snowflake.optional": {"name": "optional", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/utils/optional.sql", "original_file_path": "macros/utils/optional.sql", "unique_id": "macro.dbt_snowflake.optional", "macro_sql": "{% macro optional(name, value, quote_char = '', equals_char = '= ') %}\n{#-\n--  Insert optional DDL parameters only when their value is provided; makes DDL statements more readable\n--\n--  Args:\n--  - name: the name of the DDL option\n--  - value: the value of the DDL option, may be None\n--  - quote_char: the quote character to use (e.g. '\"', '(', etc.), leave blank if unnecessary\n--  - equals_char: the equals character to use (e.g. '= ')\n--  Returns:\n--      If the value is not None (e.g. provided by the user), return the option setting DDL\n--      If the value is None, return an empty string\n-#}\n{%- set quote_char_right = ')' if quote_char == '(' else quote_char -%}\n{% if value is not none %}{{ name }} {{ equals_char }}{{ quote_char }}{{ value }}{{ quote_char_right }}{% endif %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.293709, "supported_languages": null}, "macro.dbt_snowflake.snowflake__current_timestamp": {"name": "snowflake__current_timestamp", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/utils/timestamps.sql", "original_file_path": "macros/utils/timestamps.sql", "unique_id": "macro.dbt_snowflake.snowflake__current_timestamp", "macro_sql": "{% macro snowflake__current_timestamp() -%}\n  convert_timezone('UTC', current_timestamp())\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.293838, "supported_languages": null}, "macro.dbt_snowflake.snowflake__snapshot_string_as_time": {"name": "snowflake__snapshot_string_as_time", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/utils/timestamps.sql", "original_file_path": "macros/utils/timestamps.sql", "unique_id": "macro.dbt_snowflake.snowflake__snapshot_string_as_time", "macro_sql": "{% macro snowflake__snapshot_string_as_time(timestamp) -%}\n  {%- set result = \"to_timestamp_ntz('\" ~ timestamp ~ \"')\" -%}\n  {{ return(result) }}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.293946, "supported_languages": null}, "macro.dbt_snowflake.snowflake__snapshot_get_time": {"name": "snowflake__snapshot_get_time", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/utils/timestamps.sql", "original_file_path": "macros/utils/timestamps.sql", "unique_id": "macro.dbt_snowflake.snowflake__snapshot_get_time", "macro_sql": "{% macro snowflake__snapshot_get_time() -%}\n  to_timestamp_ntz({{ current_timestamp() }})\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.2940109, "supported_languages": null}, "macro.dbt_snowflake.snowflake__current_timestamp_backcompat": {"name": "snowflake__current_timestamp_backcompat", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/utils/timestamps.sql", "original_file_path": "macros/utils/timestamps.sql", "unique_id": "macro.dbt_snowflake.snowflake__current_timestamp_backcompat", "macro_sql": "{% macro snowflake__current_timestamp_backcompat() %}\n  current_timestamp::{{ type_timestamp() }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_expectations.type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.294102, "supported_languages": null}, "macro.dbt_snowflake.snowflake__current_timestamp_in_utc_backcompat": {"name": "snowflake__current_timestamp_in_utc_backcompat", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/utils/timestamps.sql", "original_file_path": "macros/utils/timestamps.sql", "unique_id": "macro.dbt_snowflake.snowflake__current_timestamp_in_utc_backcompat", "macro_sql": "{% macro snowflake__current_timestamp_in_utc_backcompat() %}\n  convert_timezone('UTC', {{ snowflake__current_timestamp_backcompat() }})::{{ type_timestamp() }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__current_timestamp_backcompat", "macro.dbt_expectations.type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.2941818, "supported_languages": null}, "macro.dbt_snowflake.snowflake__escape_single_quotes": {"name": "snowflake__escape_single_quotes", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/utils/escape_single_quotes.sql", "original_file_path": "macros/utils/escape_single_quotes.sql", "unique_id": "macro.dbt_snowflake.snowflake__escape_single_quotes", "macro_sql": "{% macro snowflake__escape_single_quotes(expression) -%}\n{{ expression | replace(\"'\", \"\\\\'\") }}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.294303, "supported_languages": null}, "macro.dbt_snowflake.snowflake__right": {"name": "snowflake__right", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/utils/right.sql", "original_file_path": "macros/utils/right.sql", "unique_id": "macro.dbt_snowflake.snowflake__right", "macro_sql": "{% macro snowflake__right(string_text, length_expression) %}\n\n    case when {{ length_expression }} = 0\n        then ''\n    else\n        right(\n            {{ string_text }},\n            {{ length_expression }}\n        )\n    end\n\n{%- endmacro -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.2944288, "supported_languages": null}, "macro.dbt_snowflake.snowflake__safe_cast": {"name": "snowflake__safe_cast", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/utils/safe_cast.sql", "original_file_path": "macros/utils/safe_cast.sql", "unique_id": "macro.dbt_snowflake.snowflake__safe_cast", "macro_sql": "{% macro snowflake__safe_cast(field, type) %}\n    {% if type|upper == \"GEOMETRY\" -%}\n        try_to_geometry({{field}})\n    {% elif type|upper == \"GEOGRAPHY\" -%}\n        try_to_geography({{field}})\n    {% elif type|upper != \"VARIANT\" -%}\n        {#-- Snowflake try_cast does not support casting to variant, and expects the field as a string --#}\n        {% set field_as_string =  dbt.string_literal(field) if field is number else field %}\n        try_cast({{field_as_string}} as {{type}})\n    {% else -%}\n        {{ adapter.dispatch('cast', 'dbt')(field, type) }}\n    {% endif -%}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.string_literal", "macro.dbt.cast", "macro.dbt_snowflake.snowflake__cast"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.294823, "supported_languages": null}, "macro.dbt_snowflake.snowflake__cast": {"name": "snowflake__cast", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/utils/cast.sql", "original_file_path": "macros/utils/cast.sql", "unique_id": "macro.dbt_snowflake.snowflake__cast", "macro_sql": "{% macro snowflake__cast(field, type) %}\n    {% if (type|upper == \"GEOGRAPHY\") -%}\n        to_geography({{field}})\n    {% elif (type|upper == \"GEOMETRY\") -%}\n        to_geometry({{field}})\n    {% else -%}\n        cast({{field}} as {{type}})\n    {% endif -%}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.295079, "supported_languages": null}, "macro.dbt_snowflake.snowflake__bool_or": {"name": "snowflake__bool_or", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/utils/bool_or.sql", "original_file_path": "macros/utils/bool_or.sql", "unique_id": "macro.dbt_snowflake.snowflake__bool_or", "macro_sql": "{% macro snowflake__bool_or(expression) -%}\n\n    boolor_agg({{ expression }})\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.2951849, "supported_languages": null}, "macro.dbt_snowflake.snowflake__array_construct": {"name": "snowflake__array_construct", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/utils/array_construct.sql", "original_file_path": "macros/utils/array_construct.sql", "unique_id": "macro.dbt_snowflake.snowflake__array_construct", "macro_sql": "{% macro snowflake__array_construct(inputs, data_type) -%}\n    array_construct( {{ inputs|join(' , ') }} )\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.295302, "supported_languages": null}, "macro.dbt_snowflake.snowflake__list_relations_without_caching": {"name": "snowflake__list_relations_without_caching", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/metadata/list_relations_without_caching.sql", "original_file_path": "macros/metadata/list_relations_without_caching.sql", "unique_id": "macro.dbt_snowflake.snowflake__list_relations_without_caching", "macro_sql": "{% macro snowflake__list_relations_without_caching(schema_relation, max_iter=10000, max_results_per_iter=10000) %}\n\n    {%- if schema_relation is string -%}\n        {%- set schema = schema_relation -%}\n    {%- else -%}\n        {%- set schema = schema_relation.include(identifier=False) -%}\n    {%- endif -%}\n\n    {%- set max_results_per_iter = adapter.config.flags.get('list_relations_per_page', max_results_per_iter) -%}\n    {%- set max_iter = adapter.config.flags.get('list_relations_page_limit', max_iter) -%}\n    {%- set too_many_relations_msg -%}\n        dbt is currently configured to list a maximum of {{ max_results_per_iter * max_iter }} objects per schema.\n        {{ schema }} exceeds this limit. If this is expected, you may configure this limit\n        by setting list_relations_per_page and list_relations_page_limit in your project flags.\n        It is recommended to start by increasing list_relations_page_limit.\n    {%- endset -%}\n\n    {%- set paginated_state = namespace(paginated_results=[], watermark=none) -%}\n\n    {#-\n        loop an extra time to catch the breach of max iterations\n        Note: while range is 0-based, loop.index starts at 1\n    -#}\n    {%- for _ in range(max_iter + 1) -%}\n\n        {#-\n            raise a warning and break if we still didn't exit and we're beyond the max iterations limit\n            Note: while range is 0-based, loop.index starts at 1\n        -#}\n        {%- if loop.index == max_iter + 1 -%}\n            {%- do exceptions.warn(too_many_relations_msg) -%}\n            {%- break -%}\n        {%- endif -%}\n\n        {%- set show_objects_sql = snowflake__show_objects_sql(schema, max_results_per_iter, paginated_state.watermark) -%}\n        {%- set paginated_result = run_query(show_objects_sql) -%}\n        {%- do paginated_state.paginated_results.append(paginated_result) -%}\n        {%- set paginated_state.watermark = paginated_result.columns.get('name').values()[-1] -%}\n\n        {#- we got less results than the max_results_per_iter (includes 0), meaning we reached the end -#}\n        {%- if (paginated_result | length) < max_results_per_iter -%}\n            {%- break -%}\n        {%- endif -%}\n\n    {%- endfor -%}\n\n    {#- grab the first table in the paginated results to access the `merge` method -#}\n    {%- set agate_table = paginated_state.paginated_results[0] -%}\n    {%- do return(agate_table.merge(paginated_state.paginated_results)) -%}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__show_objects_sql", "macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.2970428, "supported_languages": null}, "macro.dbt_snowflake.snowflake__show_objects_sql": {"name": "snowflake__show_objects_sql", "resource_type": "macro", "package_name": "dbt_snowflake", "path": "macros/metadata/list_relations_without_caching.sql", "original_file_path": "macros/metadata/list_relations_without_caching.sql", "unique_id": "macro.dbt_snowflake.snowflake__show_objects_sql", "macro_sql": "{% macro snowflake__show_objects_sql(schema, max_results_per_iter=10000, watermark=none) %}\n\n{%- set _sql -%}\nshow objects in {{ schema }}\n    limit {{ max_results_per_iter }}\n    {% if watermark is not none -%} from '{{ watermark }}' {%- endif %}\n;\n{%- endset -%}\n\n{%- do return(_sql) -%}\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.297261, "supported_languages": null}, "macro.dbt.run_hooks": {"name": "run_hooks", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/hooks.sql", "original_file_path": "macros/materializations/hooks.sql", "unique_id": "macro.dbt.run_hooks", "macro_sql": "{% macro run_hooks(hooks, inside_transaction=True) %}\n  {% for hook in hooks | selectattr('transaction', 'equalto', inside_transaction)  %}\n    {% if not inside_transaction and loop.first %}\n      {% call statement(auto_begin=inside_transaction) %}\n        commit;\n      {% endcall %}\n    {% endif %}\n    {% set rendered = render(hook.get('sql')) | trim %}\n    {% if (rendered | length) > 0 %}\n      {% call statement(auto_begin=inside_transaction) %}\n        {{ rendered }}\n      {% endcall %}\n    {% endif %}\n  {% endfor %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.297761, "supported_languages": null}, "macro.dbt.make_hook_config": {"name": "make_hook_config", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/hooks.sql", "original_file_path": "macros/materializations/hooks.sql", "unique_id": "macro.dbt.make_hook_config", "macro_sql": "{% macro make_hook_config(sql, inside_transaction) %}\n    {{ tojson({\"sql\": sql, \"transaction\": inside_transaction}) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.297879, "supported_languages": null}, "macro.dbt.before_begin": {"name": "before_begin", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/hooks.sql", "original_file_path": "macros/materializations/hooks.sql", "unique_id": "macro.dbt.before_begin", "macro_sql": "{% macro before_begin(sql) %}\n    {{ make_hook_config(sql, inside_transaction=False) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.make_hook_config"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.297963, "supported_languages": null}, "macro.dbt.in_transaction": {"name": "in_transaction", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/hooks.sql", "original_file_path": "macros/materializations/hooks.sql", "unique_id": "macro.dbt.in_transaction", "macro_sql": "{% macro in_transaction(sql) %}\n    {{ make_hook_config(sql, inside_transaction=True) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.make_hook_config"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.298045, "supported_languages": null}, "macro.dbt.after_commit": {"name": "after_commit", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/hooks.sql", "original_file_path": "macros/materializations/hooks.sql", "unique_id": "macro.dbt.after_commit", "macro_sql": "{% macro after_commit(sql) %}\n    {{ make_hook_config(sql, inside_transaction=False) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.make_hook_config"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.298136, "supported_languages": null}, "macro.dbt.set_sql_header": {"name": "set_sql_header", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/configs.sql", "original_file_path": "macros/materializations/configs.sql", "unique_id": "macro.dbt.set_sql_header", "macro_sql": "{% macro set_sql_header(config) -%}\n  {{ config.set('sql_header', caller()) }}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.298319, "supported_languages": null}, "macro.dbt.should_full_refresh": {"name": "should_full_refresh", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/configs.sql", "original_file_path": "macros/materializations/configs.sql", "unique_id": "macro.dbt.should_full_refresh", "macro_sql": "{% macro should_full_refresh() %}\n  {% set config_full_refresh = config.get('full_refresh') %}\n  {% if config_full_refresh is none %}\n    {% set config_full_refresh = flags.FULL_REFRESH %}\n  {% endif %}\n  {% do return(config_full_refresh) %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.2984939, "supported_languages": null}, "macro.dbt.should_store_failures": {"name": "should_store_failures", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/configs.sql", "original_file_path": "macros/materializations/configs.sql", "unique_id": "macro.dbt.should_store_failures", "macro_sql": "{% macro should_store_failures() %}\n  {% set config_store_failures = config.get('store_failures') %}\n  {% if config_store_failures is none %}\n    {% set config_store_failures = flags.STORE_FAILURES %}\n  {% endif %}\n  {% do return(config_store_failures) %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.2986681, "supported_languages": null}, "macro.dbt.snapshot_merge_sql": {"name": "snapshot_merge_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/snapshot_merge.sql", "original_file_path": "macros/materializations/snapshots/snapshot_merge.sql", "unique_id": "macro.dbt.snapshot_merge_sql", "macro_sql": "{% macro snapshot_merge_sql(target, source, insert_cols) -%}\n  {{ adapter.dispatch('snapshot_merge_sql', 'dbt')(target, source, insert_cols) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__snapshot_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.298911, "supported_languages": null}, "macro.dbt.default__snapshot_merge_sql": {"name": "default__snapshot_merge_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/snapshot_merge.sql", "original_file_path": "macros/materializations/snapshots/snapshot_merge.sql", "unique_id": "macro.dbt.default__snapshot_merge_sql", "macro_sql": "{% macro default__snapshot_merge_sql(target, source, insert_cols) -%}\n    {%- set insert_cols_csv = insert_cols | join(', ') -%}\n\n    {%- set columns = config.get(\"snapshot_table_column_names\") or get_snapshot_table_column_names() -%}\n\n    merge into {{ target.render() }} as DBT_INTERNAL_DEST\n    using {{ source }} as DBT_INTERNAL_SOURCE\n    on DBT_INTERNAL_SOURCE.{{ columns.dbt_scd_id }} = DBT_INTERNAL_DEST.{{ columns.dbt_scd_id }}\n\n    when matched\n     {% if config.get(\"dbt_valid_to_current\") %}\n\t{% set source_unique_key = (\"DBT_INTERNAL_DEST.\" ~ columns.dbt_valid_to) | trim %}\n\t{% set target_unique_key = config.get('dbt_valid_to_current') | trim %}\n\tand ({{ equals(source_unique_key, target_unique_key) }} or {{ source_unique_key }} is null)\n\n     {% else %}\n       and DBT_INTERNAL_DEST.{{ columns.dbt_valid_to }} is null\n     {% endif %}\n     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')\n        then update\n        set {{ columns.dbt_valid_to }} = DBT_INTERNAL_SOURCE.{{ columns.dbt_valid_to }}\n\n    when not matched\n     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'\n        then insert ({{ insert_cols_csv }})\n        values ({{ insert_cols_csv }})\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_snapshot_table_column_names", "macro.dbt.equals"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.299631, "supported_languages": null}, "macro.dbt.strategy_dispatch": {"name": "strategy_dispatch", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "unique_id": "macro.dbt.strategy_dispatch", "macro_sql": "{% macro strategy_dispatch(name) -%}\n{% set original_name = name %}\n  {% if '.' in name %}\n    {% set package_name, name = name.split(\".\", 1) %}\n  {% else %}\n    {% set package_name = none %}\n  {% endif %}\n\n  {% if package_name is none %}\n    {% set package_context = context %}\n  {% elif package_name in context %}\n    {% set package_context = context[package_name] %}\n  {% else %}\n    {% set error_msg %}\n        Could not find package '{{package_name}}', called with '{{original_name}}'\n    {% endset %}\n    {{ exceptions.raise_compiler_error(error_msg | trim) }}\n  {% endif %}\n\n  {%- set search_name = 'snapshot_' ~ name ~ '_strategy' -%}\n\n  {% if search_name not in package_context %}\n    {% set error_msg %}\n        The specified strategy macro '{{name}}' was not found in package '{{ package_name }}'\n    {% endset %}\n    {{ exceptions.raise_compiler_error(error_msg | trim) }}\n  {% endif %}\n  {{ return(package_context[search_name]) }}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.30079, "supported_languages": null}, "macro.dbt.snapshot_hash_arguments": {"name": "snapshot_hash_arguments", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "unique_id": "macro.dbt.snapshot_hash_arguments", "macro_sql": "{% macro snapshot_hash_arguments(args) -%}\n  {{ adapter.dispatch('snapshot_hash_arguments', 'dbt')(args) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__snapshot_hash_arguments"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3008902, "supported_languages": null}, "macro.dbt.default__snapshot_hash_arguments": {"name": "default__snapshot_hash_arguments", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "unique_id": "macro.dbt.default__snapshot_hash_arguments", "macro_sql": "{% macro default__snapshot_hash_arguments(args) -%}\n    md5({%- for arg in args -%}\n        coalesce(cast({{ arg }} as varchar ), '')\n        {% if not loop.last %} || '|' || {% endif %}\n    {%- endfor -%})\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.301018, "supported_languages": null}, "macro.dbt.snapshot_timestamp_strategy": {"name": "snapshot_timestamp_strategy", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "unique_id": "macro.dbt.snapshot_timestamp_strategy", "macro_sql": "{% macro snapshot_timestamp_strategy(node, snapshotted_rel, current_rel, model_config, target_exists) %}\n    {# The model_config parameter is no longer used, but is passed in anyway for compatibility. #}\n    {% set primary_key = config.get('unique_key') %}\n    {% set updated_at = config.get('updated_at') %}\n    {% set hard_deletes = adapter.get_hard_deletes_behavior(config) %}\n    {% set invalidate_hard_deletes = hard_deletes == 'invalidate' %}\n    {% set columns = config.get(\"snapshot_table_column_names\") or get_snapshot_table_column_names() %}\n\n    {#/*\n        The snapshot relation might not have an {{ updated_at }} value if the\n        snapshot strategy is changed from `check` to `timestamp`. We\n        should use a dbt-created column for the comparison in the snapshot\n        table instead of assuming that the user-supplied {{ updated_at }}\n        will be present in the historical data.\n\n        See https://github.com/dbt-labs/dbt-core/issues/2350\n    */ #}\n    {% set row_changed_expr -%}\n        ({{ snapshotted_rel }}.{{ columns.dbt_valid_from }} < {{ current_rel }}.{{ updated_at }})\n    {%- endset %}\n\n    {% set scd_args = api.Relation.scd_args(primary_key, updated_at) %}\n    {% set scd_id_expr = snapshot_hash_arguments(scd_args) %}\n\n    {% do return({\n        \"unique_key\": primary_key,\n        \"updated_at\": updated_at,\n        \"row_changed\": row_changed_expr,\n        \"scd_id\": scd_id_expr,\n        \"invalidate_hard_deletes\": invalidate_hard_deletes,\n        \"hard_deletes\": hard_deletes\n    }) %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_snapshot_table_column_names", "macro.dbt.snapshot_hash_arguments"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.301561, "supported_languages": null}, "macro.dbt.snapshot_string_as_time": {"name": "snapshot_string_as_time", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "unique_id": "macro.dbt.snapshot_string_as_time", "macro_sql": "{% macro snapshot_string_as_time(timestamp) -%}\n    {{ adapter.dispatch('snapshot_string_as_time', 'dbt')(timestamp) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__snapshot_string_as_time"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3016598, "supported_languages": null}, "macro.dbt.default__snapshot_string_as_time": {"name": "default__snapshot_string_as_time", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "unique_id": "macro.dbt.default__snapshot_string_as_time", "macro_sql": "{% macro default__snapshot_string_as_time(timestamp) %}\n    {% do exceptions.raise_not_implemented(\n        'snapshot_string_as_time macro not implemented for adapter '+adapter.type()\n    ) %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.301759, "supported_languages": null}, "macro.dbt.snapshot_check_all_get_existing_columns": {"name": "snapshot_check_all_get_existing_columns", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "unique_id": "macro.dbt.snapshot_check_all_get_existing_columns", "macro_sql": "{% macro snapshot_check_all_get_existing_columns(node, target_exists, check_cols_config) -%}\n    {%- if not target_exists -%}\n        {#-- no table yet -> return whatever the query does --#}\n        {{ return((false, query_columns)) }}\n    {%- endif -%}\n\n    {#-- handle any schema changes --#}\n    {%- set target_relation = adapter.get_relation(database=node.database, schema=node.schema, identifier=node.alias) -%}\n\n    {% if check_cols_config == 'all' %}\n        {%- set query_columns = get_columns_in_query(node['compiled_code']) -%}\n\n    {% elif check_cols_config is iterable and (check_cols_config | length) > 0 %}\n        {#-- query for proper casing/quoting, to support comparison below --#}\n        {%- set select_check_cols_from_target -%}\n            {#-- N.B. The whitespace below is necessary to avoid edge case issue with comments --#}\n            {#-- See: https://github.com/dbt-labs/dbt-core/issues/6781 --#}\n            select {{ check_cols_config | join(', ') }} from (\n                {{ node['compiled_code'] }}\n            ) subq\n        {%- endset -%}\n        {% set query_columns = get_columns_in_query(select_check_cols_from_target) %}\n\n    {% else %}\n        {% do exceptions.raise_compiler_error(\"Invalid value for 'check_cols': \" ~ check_cols_config) %}\n    {% endif %}\n\n    {%- set existing_cols = adapter.get_columns_in_relation(target_relation) | map(attribute = 'name') | list -%}\n    {%- set ns = namespace() -%} {#-- handle for-loop scoping with a namespace --#}\n    {%- set ns.column_added = false -%}\n\n    {%- set intersection = [] -%}\n    {%- for col in query_columns -%}\n        {%- if col in existing_cols -%}\n            {%- do intersection.append(adapter.quote(col)) -%}\n        {%- else -%}\n            {% set ns.column_added = true %}\n        {%- endif -%}\n    {%- endfor -%}\n    {{ return((ns.column_added, intersection)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.get_columns_in_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.302527, "supported_languages": null}, "macro.dbt.snapshot_check_strategy": {"name": "snapshot_check_strategy", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "unique_id": "macro.dbt.snapshot_check_strategy", "macro_sql": "{% macro snapshot_check_strategy(node, snapshotted_rel, current_rel, model_config, target_exists) %}\n    {# The model_config parameter is no longer used, but is passed in anyway for compatibility. #}\n    {% set check_cols_config = config.get('check_cols') %}\n    {% set primary_key = config.get('unique_key') %}\n    {% set hard_deletes = adapter.get_hard_deletes_behavior(config) %}\n    {% set invalidate_hard_deletes = hard_deletes == 'invalidate' %}\n    {% set updated_at = config.get('updated_at') or snapshot_get_time() %}\n\n    {% set column_added = false %}\n\n    {% set column_added, check_cols = snapshot_check_all_get_existing_columns(node, target_exists, check_cols_config) %}\n\n    {%- set row_changed_expr -%}\n    (\n    {%- if column_added -%}\n        {{ get_true_sql() }}\n    {%- else -%}\n    {%- for col in check_cols -%}\n        {{ snapshotted_rel }}.{{ col }} != {{ current_rel }}.{{ col }}\n        or\n        (\n            (({{ snapshotted_rel }}.{{ col }} is null) and not ({{ current_rel }}.{{ col }} is null))\n            or\n            ((not {{ snapshotted_rel }}.{{ col }} is null) and ({{ current_rel }}.{{ col }} is null))\n        )\n        {%- if not loop.last %} or {% endif -%}\n    {%- endfor -%}\n    {%- endif -%}\n    )\n    {%- endset %}\n\n    {% set scd_args = api.Relation.scd_args(primary_key, updated_at) %}\n    {% set scd_id_expr = snapshot_hash_arguments(scd_args) %}\n\n    {% do return({\n        \"unique_key\": primary_key,\n        \"updated_at\": updated_at,\n        \"row_changed\": row_changed_expr,\n        \"scd_id\": scd_id_expr,\n        \"invalidate_hard_deletes\": invalidate_hard_deletes,\n        \"hard_deletes\": hard_deletes\n    }) %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.snapshot_get_time", "macro.dbt.snapshot_check_all_get_existing_columns", "macro.dbt.get_true_sql", "macro.dbt.snapshot_hash_arguments"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.30333, "supported_languages": null}, "macro.dbt.create_columns": {"name": "create_columns", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.create_columns", "macro_sql": "{% macro create_columns(relation, columns) %}\n  {{ adapter.dispatch('create_columns', 'dbt')(relation, columns) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__create_columns"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3045812, "supported_languages": null}, "macro.dbt.default__create_columns": {"name": "default__create_columns", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.default__create_columns", "macro_sql": "{% macro default__create_columns(relation, columns) %}\n  {% for column in columns %}\n    {% call statement() %}\n      alter table {{ relation.render() }} add column {{ adapter.quote(column.name) }} {{ column.data_type }};\n    {% endcall %}\n  {% endfor %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3047712, "supported_languages": null}, "macro.dbt.post_snapshot": {"name": "post_snapshot", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.post_snapshot", "macro_sql": "{% macro post_snapshot(staging_relation) %}\n  {{ adapter.dispatch('post_snapshot', 'dbt')(staging_relation) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__post_snapshot"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.30487, "supported_languages": null}, "macro.dbt.default__post_snapshot": {"name": "default__post_snapshot", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.default__post_snapshot", "macro_sql": "{% macro default__post_snapshot(staging_relation) %}\n    {# no-op #}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.304925, "supported_languages": null}, "macro.dbt.get_true_sql": {"name": "get_true_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.get_true_sql", "macro_sql": "{% macro get_true_sql() %}\n  {{ adapter.dispatch('get_true_sql', 'dbt')() }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_true_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.305013, "supported_languages": null}, "macro.dbt.default__get_true_sql": {"name": "default__get_true_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.default__get_true_sql", "macro_sql": "{% macro default__get_true_sql() %}\n    {{ return('TRUE') }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.305082, "supported_languages": null}, "macro.dbt.snapshot_staging_table": {"name": "snapshot_staging_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.snapshot_staging_table", "macro_sql": "{% macro snapshot_staging_table(strategy, source_sql, target_relation) -%}\n  {{ adapter.dispatch('snapshot_staging_table', 'dbt')(strategy, source_sql, target_relation) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__snapshot_staging_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.305202, "supported_languages": null}, "macro.dbt.get_snapshot_table_column_names": {"name": "get_snapshot_table_column_names", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.get_snapshot_table_column_names", "macro_sql": "{% macro get_snapshot_table_column_names() %}\n    {{ return({'dbt_valid_to': 'dbt_valid_to', 'dbt_valid_from': 'dbt_valid_from', 'dbt_scd_id': 'dbt_scd_id', 'dbt_updated_at': 'dbt_updated_at', 'dbt_is_deleted': 'dbt_is_deleted'}) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.305343, "supported_languages": null}, "macro.dbt.default__snapshot_staging_table": {"name": "default__snapshot_staging_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.default__snapshot_staging_table", "macro_sql": "{% macro default__snapshot_staging_table(strategy, source_sql, target_relation) -%}\n    {% set columns = config.get('snapshot_table_column_names') or get_snapshot_table_column_names() %}\n    {% if strategy.hard_deletes == 'new_record' %}\n        {% set new_scd_id = snapshot_hash_arguments([columns.dbt_scd_id, snapshot_get_time()]) %}\n    {% endif %}\n    with snapshot_query as (\n\n        {{ source_sql }}\n\n    ),\n\n    snapshotted_data as (\n\n        select *, {{ unique_key_fields(strategy.unique_key) }}\n        from {{ target_relation }}\n        where\n            {% if config.get('dbt_valid_to_current') %}\n\t\t{% set source_unique_key = columns.dbt_valid_to | trim %}\n\t\t{% set target_unique_key = config.get('dbt_valid_to_current') | trim %}\n\n\t\t{# The exact equals semantics between NULL values depends on the current behavior flag set. Also, update records if the source field is null #}\n                ( {{ equals(source_unique_key, target_unique_key) }} or {{ source_unique_key }} is null )\n            {% else %}\n                {{ columns.dbt_valid_to }} is null\n            {% endif %}\n\n    ),\n\n    insertions_source_data as (\n\n        select *, {{ unique_key_fields(strategy.unique_key) }},\n            {{ strategy.updated_at }} as {{ columns.dbt_updated_at }},\n            {{ strategy.updated_at }} as {{ columns.dbt_valid_from }},\n            {{ get_dbt_valid_to_current(strategy, columns) }},\n            {{ strategy.scd_id }} as {{ columns.dbt_scd_id }}\n\n        from snapshot_query\n    ),\n\n    updates_source_data as (\n\n        select *, {{ unique_key_fields(strategy.unique_key) }},\n            {{ strategy.updated_at }} as {{ columns.dbt_updated_at }},\n            {{ strategy.updated_at }} as {{ columns.dbt_valid_from }},\n            {{ strategy.updated_at }} as {{ columns.dbt_valid_to }}\n\n        from snapshot_query\n    ),\n\n    {%- if strategy.hard_deletes == 'invalidate' or strategy.hard_deletes == 'new_record' %}\n\n    deletes_source_data as (\n\n        select *, {{ unique_key_fields(strategy.unique_key) }}\n        from snapshot_query\n    ),\n    {% endif %}\n\n    insertions as (\n\n        select\n            'insert' as dbt_change_type,\n            source_data.*\n          {%- if strategy.hard_deletes == 'new_record' -%}\n            ,'False' as {{ columns.dbt_is_deleted }}\n          {%- endif %}\n\n        from insertions_source_data as source_data\n        left outer join snapshotted_data\n            on {{ unique_key_join_on(strategy.unique_key, \"snapshotted_data\", \"source_data\") }}\n            where {{ unique_key_is_null(strategy.unique_key, \"snapshotted_data\") }}\n            or ({{ unique_key_is_not_null(strategy.unique_key, \"snapshotted_data\") }} and (\n               {{ strategy.row_changed }} {%- if strategy.hard_deletes == 'new_record' -%} or snapshotted_data.{{ columns.dbt_is_deleted }} = 'True' {% endif %}\n            )\n\n        )\n\n    ),\n\n    updates as (\n\n        select\n            'update' as dbt_change_type,\n            source_data.*,\n            snapshotted_data.{{ columns.dbt_scd_id }}\n          {%- if strategy.hard_deletes == 'new_record' -%}\n            , snapshotted_data.{{ columns.dbt_is_deleted }}\n          {%- endif %}\n\n        from updates_source_data as source_data\n        join snapshotted_data\n            on {{ unique_key_join_on(strategy.unique_key, \"snapshotted_data\", \"source_data\") }}\n        where (\n            {{ strategy.row_changed }}  {%- if strategy.hard_deletes == 'new_record' -%} or snapshotted_data.{{ columns.dbt_is_deleted }} = 'True' {% endif %}\n        )\n    )\n\n    {%- if strategy.hard_deletes == 'invalidate' or strategy.hard_deletes == 'new_record' %}\n    ,\n    deletes as (\n\n        select\n            'delete' as dbt_change_type,\n            source_data.*,\n            {{ snapshot_get_time() }} as {{ columns.dbt_valid_from }},\n            {{ snapshot_get_time() }} as {{ columns.dbt_updated_at }},\n            {{ snapshot_get_time() }} as {{ columns.dbt_valid_to }},\n            snapshotted_data.{{ columns.dbt_scd_id }}\n          {%- if strategy.hard_deletes == 'new_record' -%}\n            , snapshotted_data.{{ columns.dbt_is_deleted }}\n          {%- endif %}\n        from snapshotted_data\n        left join deletes_source_data as source_data\n            on {{ unique_key_join_on(strategy.unique_key, \"snapshotted_data\", \"source_data\") }}\n            where {{ unique_key_is_null(strategy.unique_key, \"source_data\") }}\n\n            {%- if strategy.hard_deletes == 'new_record' %}\n            and not (\n                --avoid updating the record's valid_to if the latest entry is marked as deleted\n                snapshotted_data.{{ columns.dbt_is_deleted }} = 'True'\n                and\n                {% if config.get('dbt_valid_to_current') -%}\n                    snapshotted_data.{{ columns.dbt_valid_to }} = {{ config.get('dbt_valid_to_current') }}\n                {%- else -%}\n                    snapshotted_data.{{ columns.dbt_valid_to }} is null\n                {%- endif %}\n            )\n            {%- endif %}\n    )\n    {%- endif %}\n\n    {%- if strategy.hard_deletes == 'new_record' %}\n        {% set snapshotted_cols = get_list_of_column_names(get_columns_in_relation(target_relation)) %}\n        {% set source_sql_cols = get_column_schema_from_query(source_sql) %}\n    ,\n    deletion_records as (\n\n        select\n            'insert' as dbt_change_type,\n            {#/*\n                If a column has been added to the source it won't yet exist in the\n                snapshotted table so we insert a null value as a placeholder for the column.\n             */#}\n            {%- for col in source_sql_cols -%}\n            {%- if col.name in snapshotted_cols -%}\n            snapshotted_data.{{ adapter.quote(col.column) }},\n            {%- else -%}\n            NULL as {{ adapter.quote(col.column) }},\n            {%- endif -%}\n            {% endfor -%}\n            {%- if strategy.unique_key | is_list -%}\n                {%- for key in strategy.unique_key -%}\n            snapshotted_data.{{ key }} as dbt_unique_key_{{ loop.index }},\n                {% endfor -%}\n            {%- else -%}\n            snapshotted_data.dbt_unique_key as dbt_unique_key,\n            {% endif -%}\n            {{ snapshot_get_time() }} as {{ columns.dbt_valid_from }},\n            {{ snapshot_get_time() }} as {{ columns.dbt_updated_at }},\n            snapshotted_data.{{ columns.dbt_valid_to }} as {{ columns.dbt_valid_to }},\n            {{ new_scd_id }} as {{ columns.dbt_scd_id }},\n            'True' as {{ columns.dbt_is_deleted }}\n        from snapshotted_data\n        left join deletes_source_data as source_data\n            on {{ unique_key_join_on(strategy.unique_key, \"snapshotted_data\", \"source_data\") }}\n        where {{ unique_key_is_null(strategy.unique_key, \"source_data\") }}\n        and not (\n            --avoid inserting a new record if the latest one is marked as deleted\n            snapshotted_data.{{ columns.dbt_is_deleted }} = 'True'\n            and\n            {% if config.get('dbt_valid_to_current') -%}\n                snapshotted_data.{{ columns.dbt_valid_to }} = {{ config.get('dbt_valid_to_current') }}\n            {%- else -%}\n                snapshotted_data.{{ columns.dbt_valid_to }} is null\n            {%- endif %}\n            )\n\n    )\n    {%- endif %}\n\n    select * from insertions\n    union all\n    select * from updates\n    {%- if strategy.hard_deletes == 'invalidate' or strategy.hard_deletes == 'new_record' %}\n    union all\n    select * from deletes\n    {%- endif %}\n    {%- if strategy.hard_deletes == 'new_record' %}\n    union all\n    select * from deletion_records\n    {%- endif %}\n\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.get_snapshot_table_column_names", "macro.dbt.snapshot_hash_arguments", "macro.dbt.snapshot_get_time", "macro.dbt.unique_key_fields", "macro.dbt.equals", "macro.dbt.get_dbt_valid_to_current", "macro.dbt.unique_key_join_on", "macro.dbt.unique_key_is_null", "macro.dbt.unique_key_is_not_null", "macro.dbt.get_list_of_column_names", "macro.dbt.get_columns_in_relation", "macro.dbt.get_column_schema_from_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.307801, "supported_languages": null}, "macro.dbt.build_snapshot_table": {"name": "build_snapshot_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.build_snapshot_table", "macro_sql": "{% macro build_snapshot_table(strategy, sql) -%}\n  {{ adapter.dispatch('build_snapshot_table', 'dbt')(strategy, sql) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__build_snapshot_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.307932, "supported_languages": null}, "macro.dbt.default__build_snapshot_table": {"name": "default__build_snapshot_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.default__build_snapshot_table", "macro_sql": "{% macro default__build_snapshot_table(strategy, sql) %}\n    {% set columns = config.get('snapshot_table_column_names') or get_snapshot_table_column_names() %}\n\n    select *,\n        {{ strategy.scd_id }} as {{ columns.dbt_scd_id }},\n        {{ strategy.updated_at }} as {{ columns.dbt_updated_at }},\n        {{ strategy.updated_at }} as {{ columns.dbt_valid_from }},\n        {{ get_dbt_valid_to_current(strategy, columns) }}\n      {%- if strategy.hard_deletes == 'new_record' -%}\n        , 'False' as {{ columns.dbt_is_deleted }}\n      {% endif -%}\n    from (\n        {{ sql }}\n    ) sbq\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_snapshot_table_column_names", "macro.dbt.get_dbt_valid_to_current"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.308222, "supported_languages": null}, "macro.dbt.build_snapshot_staging_table": {"name": "build_snapshot_staging_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.build_snapshot_staging_table", "macro_sql": "{% macro build_snapshot_staging_table(strategy, sql, target_relation) %}\n    {% set temp_relation = make_temp_relation(target_relation) %}\n\n    {% set select = snapshot_staging_table(strategy, sql, target_relation) %}\n\n    {% call statement('build_snapshot_staging_relation') %}\n        {{ create_table_as(True, temp_relation, select) }}\n    {% endcall %}\n\n    {% do return(temp_relation) %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.make_temp_relation", "macro.dbt.snapshot_staging_table", "macro.dbt.statement", "macro.dbt.create_table_as"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3084679, "supported_languages": null}, "macro.dbt.get_updated_at_column_data_type": {"name": "get_updated_at_column_data_type", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.get_updated_at_column_data_type", "macro_sql": "{% macro get_updated_at_column_data_type(snapshot_sql) %}\n    {% set snapshot_sql_column_schema = get_column_schema_from_query(snapshot_sql) %}\n    {% set dbt_updated_at_data_type = null %}\n    {% set ns = namespace() -%} {#-- handle for-loop scoping with a namespace --#}\n    {% set ns.dbt_updated_at_data_type = null -%}\n    {% for column in snapshot_sql_column_schema %}\n    {%   if ((column.column == 'dbt_updated_at') or (column.column == 'DBT_UPDATED_AT')) %}\n    {%     set ns.dbt_updated_at_data_type = column.dtype %}\n    {%   endif %}\n    {% endfor %}\n    {{ return(ns.dbt_updated_at_data_type or none)  }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_column_schema_from_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.308811, "supported_languages": null}, "macro.dbt.check_time_data_types": {"name": "check_time_data_types", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.check_time_data_types", "macro_sql": "{% macro check_time_data_types(sql) %}\n  {% set dbt_updated_at_data_type = get_updated_at_column_data_type(sql) %}\n  {% set snapshot_get_time_data_type = get_snapshot_get_time_data_type() %}\n  {% if snapshot_get_time_data_type is not none and dbt_updated_at_data_type is not none and snapshot_get_time_data_type != dbt_updated_at_data_type %}\n  {%   if exceptions.warn_snapshot_timestamp_data_types %}\n  {{     exceptions.warn_snapshot_timestamp_data_types(snapshot_get_time_data_type, dbt_updated_at_data_type) }}\n  {%   endif %}\n  {% endif %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_updated_at_column_data_type", "macro.dbt.get_snapshot_get_time_data_type"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.309061, "supported_languages": null}, "macro.dbt.get_dbt_valid_to_current": {"name": "get_dbt_valid_to_current", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.get_dbt_valid_to_current", "macro_sql": "{% macro get_dbt_valid_to_current(strategy, columns) %}\n  {% set dbt_valid_to_current = config.get('dbt_valid_to_current') or \"null\" %}\n  coalesce(nullif({{ strategy.updated_at }}, {{ strategy.updated_at }}), {{dbt_valid_to_current}})\n  as {{ columns.dbt_valid_to }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.309227, "supported_languages": null}, "macro.dbt.unique_key_fields": {"name": "unique_key_fields", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.unique_key_fields", "macro_sql": "{% macro unique_key_fields(unique_key) %}\n    {% if unique_key | is_list %}\n        {% for key in unique_key %}\n            {{ key }} as dbt_unique_key_{{ loop.index }}\n            {%- if not loop.last %} , {%- endif %}\n        {% endfor %}\n    {% else %}\n        {{ unique_key }} as dbt_unique_key\n    {% endif %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3094258, "supported_languages": null}, "macro.dbt.unique_key_join_on": {"name": "unique_key_join_on", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.unique_key_join_on", "macro_sql": "{% macro unique_key_join_on(unique_key, identifier, from_identifier) %}\n    {% if unique_key | is_list %}\n        {% for key in unique_key %}\n\t    {% set source_unique_key = (identifier ~ \".dbt_unique_key_\" ~ loop.index) | trim %}\n\t    {% set target_unique_key = (from_identifier ~ \".dbt_unique_key_\" ~ loop.index) | trim %}\n\t    {{ equals(source_unique_key, target_unique_key) }}\n            {%- if not loop.last %} and {%- endif %}\n        {% endfor %}\n    {% else %}\n        {{ identifier }}.dbt_unique_key = {{ from_identifier }}.dbt_unique_key\n    {% endif %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.equals"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.309761, "supported_languages": null}, "macro.dbt.unique_key_is_null": {"name": "unique_key_is_null", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.unique_key_is_null", "macro_sql": "{% macro unique_key_is_null(unique_key, identifier) %}\n    {% if unique_key | is_list %}\n        {{ identifier }}.dbt_unique_key_1 is null\n    {% else %}\n        {{ identifier }}.dbt_unique_key is null\n    {% endif %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.309891, "supported_languages": null}, "macro.dbt.unique_key_is_not_null": {"name": "unique_key_is_not_null", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.unique_key_is_not_null", "macro_sql": "{% macro unique_key_is_not_null(unique_key, identifier) %}\n    {% if unique_key | is_list %}\n        {{ identifier }}.dbt_unique_key_1 is not null\n    {% else %}\n        {{ identifier }}.dbt_unique_key is not null\n    {% endif %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3100119, "supported_languages": null}, "macro.dbt.materialization_snapshot_default": {"name": "materialization_snapshot_default", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/snapshot.sql", "original_file_path": "macros/materializations/snapshots/snapshot.sql", "unique_id": "macro.dbt.materialization_snapshot_default", "macro_sql": "{% materialization snapshot, default %}\n\n  {%- set target_table = model.get('alias', model.get('name')) -%}\n\n  {%- set strategy_name = config.get('strategy') -%}\n  {%- set unique_key = config.get('unique_key') %}\n  -- grab current tables grants config for comparision later on\n  {%- set grant_config = config.get('grants') -%}\n\n  {% set target_relation_exists, target_relation = get_or_create_relation(\n          database=model.database,\n          schema=model.schema,\n          identifier=target_table,\n          type='table') -%}\n\n  {%- if not target_relation.is_table -%}\n    {% do exceptions.relation_wrong_type(target_relation, 'table') %}\n  {%- endif -%}\n\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  {% set strategy_macro = strategy_dispatch(strategy_name) %}\n  {# The model['config'] parameter below is no longer used, but passing anyway for compatibility #}\n  {# It was a dictionary of config, instead of the config object from the context #}\n  {% set strategy = strategy_macro(model, \"snapshotted_data\", \"source_data\", model['config'], target_relation_exists) %}\n\n  {% if not target_relation_exists %}\n\n      {% set build_sql = build_snapshot_table(strategy, model['compiled_code']) %}\n      {% set build_or_select_sql = build_sql %}\n      {% set final_sql = create_table_as(False, target_relation, build_sql) %}\n\n  {% else %}\n\n      {% set columns = config.get(\"snapshot_table_column_names\") or get_snapshot_table_column_names() %}\n\n      {{ adapter.assert_valid_snapshot_target_given_strategy(target_relation, columns, strategy) }}\n\n      {% set build_or_select_sql = snapshot_staging_table(strategy, sql, target_relation) %}\n      {% set staging_table = build_snapshot_staging_table(strategy, sql, target_relation) %}\n\n      -- this may no-op if the database does not require column expansion\n      {% do adapter.expand_target_column_types(from_relation=staging_table,\n                                               to_relation=target_relation) %}\n\n      {% set remove_columns = ['dbt_change_type', 'DBT_CHANGE_TYPE', 'dbt_unique_key', 'DBT_UNIQUE_KEY'] %}\n      {% if unique_key | is_list %}\n          {% for key in strategy.unique_key %}\n              {{ remove_columns.append('dbt_unique_key_' + loop.index|string) }}\n              {{ remove_columns.append('DBT_UNIQUE_KEY_' + loop.index|string) }}\n          {% endfor %}\n      {% endif %}\n\n      {% set missing_columns = adapter.get_missing_columns(staging_table, target_relation)\n                                   | rejectattr('name', 'in', remove_columns)\n                                   | list %}\n\n      {% do create_columns(target_relation, missing_columns) %}\n\n      {% set source_columns = adapter.get_columns_in_relation(staging_table)\n                                   | rejectattr('name', 'in', remove_columns)\n                                   | list %}\n\n      {% set quoted_source_columns = [] %}\n      {% for column in source_columns %}\n        {% do quoted_source_columns.append(adapter.quote(column.name)) %}\n      {% endfor %}\n\n      {% set final_sql = snapshot_merge_sql(\n            target = target_relation,\n            source = staging_table,\n            insert_cols = quoted_source_columns\n         )\n      %}\n\n  {% endif %}\n\n\n  {{ check_time_data_types(build_or_select_sql) }}\n\n  {% call statement('main') %}\n      {{ final_sql }}\n  {% endcall %}\n\n  {% set should_revoke = should_revoke(target_relation_exists, full_refresh_mode=False) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {% if not target_relation_exists %}\n    {% do create_indexes(target_relation) %}\n  {% endif %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  {{ adapter.commit() }}\n\n  {% if staging_table is defined %}\n      {% do post_snapshot(staging_table) %}\n  {% endif %}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{% endmaterialization %}", "depends_on": {"macros": ["macro.dbt.get_or_create_relation", "macro.dbt.run_hooks", "macro.dbt.strategy_dispatch", "macro.dbt.build_snapshot_table", "macro.dbt.create_table_as", "macro.dbt.get_snapshot_table_column_names", "macro.dbt.snapshot_staging_table", "macro.dbt.build_snapshot_staging_table", "macro.dbt.create_columns", "macro.dbt.snapshot_merge_sql", "macro.dbt.check_time_data_types", "macro.dbt.statement", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs", "macro.dbt.create_indexes", "macro.dbt.post_snapshot"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.312237, "supported_languages": ["sql"]}, "macro.dbt.materialization_test_default": {"name": "materialization_test_default", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/tests/test.sql", "original_file_path": "macros/materializations/tests/test.sql", "unique_id": "macro.dbt.materialization_test_default", "macro_sql": "{%- materialization test, default -%}\n\n  {% set relations = [] %}\n  {% set limit = config.get('limit') %}\n\n  {% set sql_with_limit %}\n    {{ get_limit_subquery_sql(sql, limit) }}\n  {% endset %}\n\n  {% if should_store_failures() %}\n\n    {% set identifier = model['alias'] %}\n    {% set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) %}\n\n    {% set store_failures_as = config.get('store_failures_as') %}\n    -- if `--store-failures` is invoked via command line and `store_failures_as` is not set,\n    -- config.get('store_failures_as', 'table') returns None, not 'table'\n    {% if store_failures_as == none %}{% set store_failures_as = 'table' %}{% endif %}\n    {% if store_failures_as not in ['table', 'view'] %}\n        {{ exceptions.raise_compiler_error(\n            \"'\" ~ store_failures_as ~ \"' is not a valid value for `store_failures_as`. \"\n            \"Accepted values are: ['ephemeral', 'table', 'view']\"\n        ) }}\n    {% endif %}\n\n    {% set target_relation = api.Relation.create(\n        identifier=identifier, schema=schema, database=database, type=store_failures_as) -%} %}\n\n    {% if old_relation %}\n        {% do adapter.drop_relation(old_relation) %}\n    {% endif %}\n\n    {% call statement(auto_begin=True) %}\n        {{ get_create_sql(target_relation, sql_with_limit) }}\n    {% endcall %}\n\n    {% do relations.append(target_relation) %}\n\n    {# Since the test failures have already been saved to the database, reuse that result rather than querying again #}\n    {% set main_sql %}\n        select *\n        from {{ target_relation }}\n    {% endset %}\n\n    {{ adapter.commit() }}\n\n  {% else %}\n\n      {% set main_sql = sql_with_limit %}\n\n  {% endif %}\n\n  {% set fail_calc = config.get('fail_calc') %}\n  {% set warn_if = config.get('warn_if') %}\n  {% set error_if = config.get('error_if') %}\n\n  {% call statement('main', fetch_result=True) -%}\n\n    {# The limit has already been included above, and we do not want to duplicate it again. We also want to be safe for macro overrides treating `limit` as a required parameter. #}\n    {{ get_test_sql(main_sql, fail_calc, warn_if, error_if, limit=none)}}\n\n  {%- endcall %}\n\n  {{ return({'relations': relations}) }}\n\n{%- endmaterialization -%}", "depends_on": {"macros": ["macro.dbt.get_limit_subquery_sql", "macro.dbt.should_store_failures", "macro.dbt.statement", "macro.dbt.get_create_sql", "macro.dbt.get_test_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.313534, "supported_languages": ["sql"]}, "macro.dbt.get_test_sql": {"name": "get_test_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/tests/helpers.sql", "original_file_path": "macros/materializations/tests/helpers.sql", "unique_id": "macro.dbt.get_test_sql", "macro_sql": "{% macro get_test_sql(main_sql, fail_calc, warn_if, error_if, limit) -%}\n  {{ adapter.dispatch('get_test_sql', 'dbt')(main_sql, fail_calc, warn_if, error_if, limit) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_test_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.313857, "supported_languages": null}, "macro.dbt.default__get_test_sql": {"name": "default__get_test_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/tests/helpers.sql", "original_file_path": "macros/materializations/tests/helpers.sql", "unique_id": "macro.dbt.default__get_test_sql", "macro_sql": "{% macro default__get_test_sql(main_sql, fail_calc, warn_if, error_if, limit) -%}\n    select\n      {{ fail_calc }} as failures,\n      {{ fail_calc }} {{ warn_if }} as should_warn,\n      {{ fail_calc }} {{ error_if }} as should_error\n    from (\n      {{ main_sql }}\n      {{ \"limit \" ~ limit if limit != none }}\n    ) dbt_internal_test\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.31404, "supported_languages": null}, "macro.dbt.get_unit_test_sql": {"name": "get_unit_test_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/tests/helpers.sql", "original_file_path": "macros/materializations/tests/helpers.sql", "unique_id": "macro.dbt.get_unit_test_sql", "macro_sql": "{% macro get_unit_test_sql(main_sql, expected_fixture_sql, expected_column_names) -%}\n  {{ adapter.dispatch('get_unit_test_sql', 'dbt')(main_sql, expected_fixture_sql, expected_column_names) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_unit_test_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.314163, "supported_languages": null}, "macro.dbt.default__get_unit_test_sql": {"name": "default__get_unit_test_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/tests/helpers.sql", "original_file_path": "macros/materializations/tests/helpers.sql", "unique_id": "macro.dbt.default__get_unit_test_sql", "macro_sql": "{% macro default__get_unit_test_sql(main_sql, expected_fixture_sql, expected_column_names) -%}\n-- Build actual result given inputs\nwith dbt_internal_unit_test_actual as (\n  select\n    {% for expected_column_name in expected_column_names %}{{expected_column_name}}{% if not loop.last -%},{% endif %}{%- endfor -%}, {{ dbt.string_literal(\"actual\") }} as {{ adapter.quote(\"actual_or_expected\") }}\n  from (\n    {{ main_sql }}\n  ) _dbt_internal_unit_test_actual\n),\n-- Build expected result\ndbt_internal_unit_test_expected as (\n  select\n    {% for expected_column_name in expected_column_names %}{{expected_column_name}}{% if not loop.last -%}, {% endif %}{%- endfor -%}, {{ dbt.string_literal(\"expected\") }} as {{ adapter.quote(\"actual_or_expected\") }}\n  from (\n    {{ expected_fixture_sql }}\n  ) _dbt_internal_unit_test_expected\n)\n-- Union actual and expected results\nselect * from dbt_internal_unit_test_actual\nunion all\nselect * from dbt_internal_unit_test_expected\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.string_literal"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.314513, "supported_languages": null}, "macro.dbt.get_where_subquery": {"name": "get_where_subquery", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/tests/where_subquery.sql", "original_file_path": "macros/materializations/tests/where_subquery.sql", "unique_id": "macro.dbt.get_where_subquery", "macro_sql": "{% macro get_where_subquery(relation) -%}\n    {% do return(adapter.dispatch('get_where_subquery', 'dbt')(relation)) %}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_where_subquery"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.314711, "supported_languages": null}, "macro.dbt.default__get_where_subquery": {"name": "default__get_where_subquery", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/tests/where_subquery.sql", "original_file_path": "macros/materializations/tests/where_subquery.sql", "unique_id": "macro.dbt.default__get_where_subquery", "macro_sql": "{% macro default__get_where_subquery(relation) -%}\n    {% set where = config.get('where', '') %}\n    {% if where %}\n        {%- set filtered -%}\n            (select * from {{ relation }} where {{ where }}) dbt_subquery\n        {%- endset -%}\n        {% do return(filtered) %}\n    {%- else -%}\n        {% do return(relation) %}\n    {%- endif -%}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.314935, "supported_languages": null}, "macro.dbt.materialization_unit_default": {"name": "materialization_unit_default", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/tests/unit.sql", "original_file_path": "macros/materializations/tests/unit.sql", "unique_id": "macro.dbt.materialization_unit_default", "macro_sql": "{%- materialization unit, default -%}\n\n  {% set relations = [] %}\n\n  {% set expected_rows = config.get('expected_rows') %}\n  {% set expected_sql = config.get('expected_sql') %}\n  {% set tested_expected_column_names = expected_rows[0].keys() if (expected_rows | length ) > 0 else get_columns_in_query(sql) %}\n\n  {%- set target_relation = this.incorporate(type='table') -%}\n  {%- set temp_relation = make_temp_relation(target_relation)-%}\n  {% do run_query(get_create_table_as_sql(True, temp_relation, get_empty_subquery_sql(sql))) %}\n  {%- set columns_in_relation = adapter.get_columns_in_relation(temp_relation) -%}\n  {%- set column_name_to_data_types = {} -%}\n  {%- set column_name_to_quoted = {} -%}\n  {%- for column in columns_in_relation -%}\n  {%-   do column_name_to_data_types.update({column.name|lower: column.data_type}) -%}\n  {%-   do column_name_to_quoted.update({column.name|lower: column.quoted}) -%}\n  {%- endfor -%}\n\n  {%- set expected_column_names_quoted = [] -%}\n  {%- for column_name in tested_expected_column_names -%}\n  {%-   do expected_column_names_quoted.append(column_name_to_quoted[column_name|lower]) -%}\n  {%- endfor -%}\n\n  {% if not expected_sql %}\n  {%   set expected_sql = get_expected_sql(expected_rows, column_name_to_data_types, column_name_to_quoted) %}\n  {% endif %}\n  {% set unit_test_sql = get_unit_test_sql(sql, expected_sql, expected_column_names_quoted) %}\n\n  {% call statement('main', fetch_result=True) -%}\n\n    {{ unit_test_sql }}\n\n  {%- endcall %}\n\n  {% do adapter.drop_relation(temp_relation) %}\n\n  {{ return({'relations': relations}) }}\n\n{%- endmaterialization -%}", "depends_on": {"macros": ["macro.dbt.get_columns_in_query", "macro.dbt.make_temp_relation", "macro.dbt.run_query", "macro.dbt.get_create_table_as_sql", "macro.dbt.get_empty_subquery_sql", "macro.dbt.get_expected_sql", "macro.dbt.get_unit_test_sql", "macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.316119, "supported_languages": ["sql"]}, "macro.dbt.materialization_materialized_view_default": {"name": "materialization_materialized_view_default", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/materialized_view.sql", "original_file_path": "macros/materializations/models/materialized_view.sql", "unique_id": "macro.dbt.materialization_materialized_view_default", "macro_sql": "{% materialization materialized_view, default %}\n    {% set existing_relation = load_cached_relation(this) %}\n    {% set target_relation = this.incorporate(type=this.MaterializedView) %}\n    {% set intermediate_relation = make_intermediate_relation(target_relation) %}\n    {% set backup_relation_type = target_relation.MaterializedView if existing_relation is none else existing_relation.type %}\n    {% set backup_relation = make_backup_relation(target_relation, backup_relation_type) %}\n\n    {{ materialized_view_setup(backup_relation, intermediate_relation, pre_hooks) }}\n\n        {% set build_sql = materialized_view_get_build_sql(existing_relation, target_relation, backup_relation, intermediate_relation) %}\n\n        {% if build_sql == '' %}\n            {{ materialized_view_execute_no_op(target_relation) }}\n        {% else %}\n            {{ materialized_view_execute_build_sql(build_sql, existing_relation, target_relation, post_hooks) }}\n        {% endif %}\n\n    {{ materialized_view_teardown(backup_relation, intermediate_relation, post_hooks) }}\n\n    {{ return({'relations': [target_relation]}) }}\n\n{% endmaterialization %}", "depends_on": {"macros": ["macro.dbt.load_cached_relation", "macro.dbt.make_intermediate_relation", "macro.dbt.make_backup_relation", "macro.dbt.materialized_view_setup", "macro.dbt.materialized_view_get_build_sql", "macro.dbt.materialized_view_execute_no_op", "macro.dbt.materialized_view_execute_build_sql", "macro.dbt.materialized_view_teardown"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.317054, "supported_languages": ["sql"]}, "macro.dbt.materialized_view_setup": {"name": "materialized_view_setup", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/materialized_view.sql", "original_file_path": "macros/materializations/models/materialized_view.sql", "unique_id": "macro.dbt.materialized_view_setup", "macro_sql": "{% macro materialized_view_setup(backup_relation, intermediate_relation, pre_hooks) %}\n\n    -- backup_relation and intermediate_relation should not already exist in the database\n    -- it's possible these exist because of a previous run that exited unexpectedly\n    {% set preexisting_backup_relation = load_cached_relation(backup_relation) %}\n    {% set preexisting_intermediate_relation = load_cached_relation(intermediate_relation) %}\n\n    -- drop the temp relations if they exist already in the database\n    {{ drop_relation_if_exists(preexisting_backup_relation) }}\n    {{ drop_relation_if_exists(preexisting_intermediate_relation) }}\n\n    {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.load_cached_relation", "macro.dbt.drop_relation_if_exists", "macro.dbt.run_hooks"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.317287, "supported_languages": null}, "macro.dbt.materialized_view_teardown": {"name": "materialized_view_teardown", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/materialized_view.sql", "original_file_path": "macros/materializations/models/materialized_view.sql", "unique_id": "macro.dbt.materialized_view_teardown", "macro_sql": "{% macro materialized_view_teardown(backup_relation, intermediate_relation, post_hooks) %}\n\n    -- drop the temp relations if they exist to leave the database clean for the next run\n    {{ drop_relation_if_exists(backup_relation) }}\n    {{ drop_relation_if_exists(intermediate_relation) }}\n\n    {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.drop_relation_if_exists", "macro.dbt.run_hooks"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.317431, "supported_languages": null}, "macro.dbt.materialized_view_get_build_sql": {"name": "materialized_view_get_build_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/materialized_view.sql", "original_file_path": "macros/materializations/models/materialized_view.sql", "unique_id": "macro.dbt.materialized_view_get_build_sql", "macro_sql": "{% macro materialized_view_get_build_sql(existing_relation, target_relation, backup_relation, intermediate_relation) %}\n\n    {% set full_refresh_mode = should_full_refresh() %}\n\n    -- determine the scenario we're in: create, full_refresh, alter, refresh data\n    {% if existing_relation is none %}\n        {% set build_sql = get_create_materialized_view_as_sql(target_relation, sql) %}\n    {% elif full_refresh_mode or not existing_relation.is_materialized_view %}\n        {% set build_sql = get_replace_sql(existing_relation, target_relation, sql) %}\n    {% else %}\n\n        -- get config options\n        {% set on_configuration_change = config.get('on_configuration_change') %}\n        {% set configuration_changes = get_materialized_view_configuration_changes(existing_relation, config) %}\n\n        {% if configuration_changes is none %}\n            {% set build_sql = refresh_materialized_view(target_relation) %}\n\n        {% elif on_configuration_change == 'apply' %}\n            {% set build_sql = get_alter_materialized_view_as_sql(target_relation, configuration_changes, sql, existing_relation, backup_relation, intermediate_relation) %}\n        {% elif on_configuration_change == 'continue' %}\n            {% set build_sql = '' %}\n            {{ exceptions.warn(\"Configuration changes were identified and `on_configuration_change` was set to `continue` for `\" ~ target_relation.render() ~ \"`\") }}\n        {% elif on_configuration_change == 'fail' %}\n            {{ exceptions.raise_fail_fast_error(\"Configuration changes were identified and `on_configuration_change` was set to `fail` for `\" ~ target_relation.render() ~ \"`\") }}\n\n        {% else %}\n            -- this only happens if the user provides a value other than `apply`, 'skip', 'fail'\n            {{ exceptions.raise_compiler_error(\"Unexpected configuration scenario\") }}\n\n        {% endif %}\n\n    {% endif %}\n\n    {% do return(build_sql) %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.should_full_refresh", "macro.dbt.get_create_materialized_view_as_sql", "macro.dbt.get_replace_sql", "macro.dbt.get_materialized_view_configuration_changes", "macro.dbt.refresh_materialized_view", "macro.dbt.get_alter_materialized_view_as_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.318144, "supported_languages": null}, "macro.dbt.materialized_view_execute_no_op": {"name": "materialized_view_execute_no_op", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/materialized_view.sql", "original_file_path": "macros/materializations/models/materialized_view.sql", "unique_id": "macro.dbt.materialized_view_execute_no_op", "macro_sql": "{% macro materialized_view_execute_no_op(target_relation) %}\n    {% do store_raw_result(\n        name=\"main\",\n        message=\"skip \" ~ target_relation,\n        code=\"skip\",\n        rows_affected=\"-1\"\n    ) %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.31828, "supported_languages": null}, "macro.dbt.materialized_view_execute_build_sql": {"name": "materialized_view_execute_build_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/materialized_view.sql", "original_file_path": "macros/materializations/models/materialized_view.sql", "unique_id": "macro.dbt.materialized_view_execute_build_sql", "macro_sql": "{% macro materialized_view_execute_build_sql(build_sql, existing_relation, target_relation, post_hooks) %}\n\n    -- `BEGIN` happens here:\n    {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n    {% set grant_config = config.get('grants') %}\n\n    {% call statement(name=\"main\") %}\n        {{ build_sql }}\n    {% endcall %}\n\n    {% set should_revoke = should_revoke(existing_relation, full_refresh_mode=True) %}\n    {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n    {% do persist_docs(target_relation, model) %}\n\n    {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n    {{ adapter.commit() }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.318645, "supported_languages": null}, "macro.dbt.materialization_view_default": {"name": "materialization_view_default", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/view.sql", "original_file_path": "macros/materializations/models/view.sql", "unique_id": "macro.dbt.materialization_view_default", "macro_sql": "{%- materialization view, default -%}\n\n  {%- set existing_relation = load_cached_relation(this) -%}\n  {%- set target_relation = this.incorporate(type='view') -%}\n  {%- set intermediate_relation =  make_intermediate_relation(target_relation) -%}\n\n  -- the intermediate_relation should not already exist in the database; get_relation\n  -- will return None in that case. Otherwise, we get a relation that we can drop\n  -- later, before we try to use this name for the current operation\n  {%- set preexisting_intermediate_relation = load_cached_relation(intermediate_relation) -%}\n  /*\n     This relation (probably) doesn't exist yet. If it does exist, it's a leftover from\n     a previous run, and we're going to try to drop it immediately. At the end of this\n     materialization, we're going to rename the \"existing_relation\" to this identifier,\n     and then we're going to drop it. In order to make sure we run the correct one of:\n       - drop view ...\n       - drop table ...\n\n     We need to set the type of this relation to be the type of the existing_relation, if it exists,\n     or else \"view\" as a sane default if it does not. Note that if the existing_relation does not\n     exist, then there is nothing to move out of the way and subsequentally drop. In that case,\n     this relation will be effectively unused.\n  */\n  {%- set backup_relation_type = 'view' if existing_relation is none else existing_relation.type -%}\n  {%- set backup_relation = make_backup_relation(target_relation, backup_relation_type) -%}\n  -- as above, the backup_relation should not already exist\n  {%- set preexisting_backup_relation = load_cached_relation(backup_relation) -%}\n  -- grab current tables grants config for comparision later on\n  {% set grant_config = config.get('grants') %}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- drop the temp relations if they exist already in the database\n  {{ drop_relation_if_exists(preexisting_intermediate_relation) }}\n  {{ drop_relation_if_exists(preexisting_backup_relation) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  -- build model\n  {% call statement('main') -%}\n    {{ get_create_view_as_sql(intermediate_relation, sql) }}\n  {%- endcall %}\n\n  -- cleanup\n  -- move the existing view out of the way\n  {% if existing_relation is not none %}\n     /* Do the equivalent of rename_if_exists. 'existing_relation' could have been dropped\n        since the variable was first set. */\n    {% set existing_relation = load_cached_relation(existing_relation) %}\n    {% if existing_relation is not none %}\n        {{ adapter.rename_relation(existing_relation, backup_relation) }}\n    {% endif %}\n  {% endif %}\n  {{ adapter.rename_relation(intermediate_relation, target_relation) }}\n\n  {% set should_revoke = should_revoke(existing_relation, full_refresh_mode=True) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  {{ adapter.commit() }}\n\n  {{ drop_relation_if_exists(backup_relation) }}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{%- endmaterialization -%}", "depends_on": {"macros": ["macro.dbt.load_cached_relation", "macro.dbt.make_intermediate_relation", "macro.dbt.make_backup_relation", "macro.dbt.run_hooks", "macro.dbt.drop_relation_if_exists", "macro.dbt.statement", "macro.dbt.get_create_view_as_sql", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.319839, "supported_languages": ["sql"]}, "macro.dbt.materialization_table_default": {"name": "materialization_table_default", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/table.sql", "original_file_path": "macros/materializations/models/table.sql", "unique_id": "macro.dbt.materialization_table_default", "macro_sql": "{% materialization table, default %}\n\n  {%- set existing_relation = load_cached_relation(this) -%}\n  {%- set target_relation = this.incorporate(type='table') %}\n  {%- set intermediate_relation =  make_intermediate_relation(target_relation) -%}\n  -- the intermediate_relation should not already exist in the database; get_relation\n  -- will return None in that case. Otherwise, we get a relation that we can drop\n  -- later, before we try to use this name for the current operation\n  {%- set preexisting_intermediate_relation = load_cached_relation(intermediate_relation) -%}\n  /*\n      See ../view/view.sql for more information about this relation.\n  */\n  {%- set backup_relation_type = 'table' if existing_relation is none else existing_relation.type -%}\n  {%- set backup_relation = make_backup_relation(target_relation, backup_relation_type) -%}\n  -- as above, the backup_relation should not already exist\n  {%- set preexisting_backup_relation = load_cached_relation(backup_relation) -%}\n  -- grab current tables grants config for comparision later on\n  {% set grant_config = config.get('grants') %}\n\n  -- drop the temp relations if they exist already in the database\n  {{ drop_relation_if_exists(preexisting_intermediate_relation) }}\n  {{ drop_relation_if_exists(preexisting_backup_relation) }}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  -- build model\n  {% call statement('main') -%}\n    {{ get_create_table_as_sql(False, intermediate_relation, sql) }}\n  {%- endcall %}\n\n  {% do create_indexes(intermediate_relation) %}\n\n  -- cleanup\n  {% if existing_relation is not none %}\n     /* Do the equivalent of rename_if_exists. 'existing_relation' could have been dropped\n        since the variable was first set. */\n    {% set existing_relation = load_cached_relation(existing_relation) %}\n    {% if existing_relation is not none %}\n        {{ adapter.rename_relation(existing_relation, backup_relation) }}\n    {% endif %}\n  {% endif %}\n\n  {{ adapter.rename_relation(intermediate_relation, target_relation) }}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  {% set should_revoke = should_revoke(existing_relation, full_refresh_mode=True) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  -- `COMMIT` happens here\n  {{ adapter.commit() }}\n\n  -- finally, drop the existing/backup relation after the commit\n  {{ drop_relation_if_exists(backup_relation) }}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n{% endmaterialization %}", "depends_on": {"macros": ["macro.dbt.load_cached_relation", "macro.dbt.make_intermediate_relation", "macro.dbt.make_backup_relation", "macro.dbt.drop_relation_if_exists", "macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.get_create_table_as_sql", "macro.dbt.create_indexes", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3215418, "supported_languages": ["sql"]}, "macro.dbt.get_quoted_csv": {"name": "get_quoted_csv", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/column_helpers.sql", "original_file_path": "macros/materializations/models/incremental/column_helpers.sql", "unique_id": "macro.dbt.get_quoted_csv", "macro_sql": "{% macro get_quoted_csv(column_names) %}\n\n    {% set quoted = [] %}\n    {% for col in column_names -%}\n        {%- do quoted.append(adapter.quote(col)) -%}\n    {%- endfor %}\n\n    {%- set dest_cols_csv = quoted | join(', ') -%}\n    {{ return(dest_cols_csv) }}\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3220532, "supported_languages": null}, "macro.dbt.diff_columns": {"name": "diff_columns", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/column_helpers.sql", "original_file_path": "macros/materializations/models/incremental/column_helpers.sql", "unique_id": "macro.dbt.diff_columns", "macro_sql": "{% macro diff_columns(source_columns, target_columns) %}\n\n  {% set result = [] %}\n  {% set source_names = source_columns | map(attribute = 'column') | list %}\n  {% set target_names = target_columns | map(attribute = 'column') | list %}\n\n   {# --check whether the name attribute exists in the target - this does not perform a data type check #}\n   {% for sc in source_columns %}\n     {% if sc.name not in target_names %}\n        {{ result.append(sc) }}\n     {% endif %}\n   {% endfor %}\n\n  {{ return(result) }}\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3223748, "supported_languages": null}, "macro.dbt.diff_column_data_types": {"name": "diff_column_data_types", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/column_helpers.sql", "original_file_path": "macros/materializations/models/incremental/column_helpers.sql", "unique_id": "macro.dbt.diff_column_data_types", "macro_sql": "{% macro diff_column_data_types(source_columns, target_columns) %}\n\n  {% set result = [] %}\n  {% for sc in source_columns %}\n    {% set tc = target_columns | selectattr(\"name\", \"equalto\", sc.name) | list | first %}\n    {% if tc %}\n      {% if sc.data_type != tc.data_type and not sc.can_expand_to(other_column=tc) %}\n        {{ result.append( { 'column_name': tc.name, 'new_type': sc.data_type } ) }}\n      {% endif %}\n    {% endif %}\n  {% endfor %}\n\n  {{ return(result) }}\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.322788, "supported_languages": null}, "macro.dbt.get_merge_update_columns": {"name": "get_merge_update_columns", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/column_helpers.sql", "original_file_path": "macros/materializations/models/incremental/column_helpers.sql", "unique_id": "macro.dbt.get_merge_update_columns", "macro_sql": "{% macro get_merge_update_columns(merge_update_columns, merge_exclude_columns, dest_columns) %}\n  {{ return(adapter.dispatch('get_merge_update_columns', 'dbt')(merge_update_columns, merge_exclude_columns, dest_columns)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_merge_update_columns"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.322931, "supported_languages": null}, "macro.dbt.default__get_merge_update_columns": {"name": "default__get_merge_update_columns", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/column_helpers.sql", "original_file_path": "macros/materializations/models/incremental/column_helpers.sql", "unique_id": "macro.dbt.default__get_merge_update_columns", "macro_sql": "{% macro default__get_merge_update_columns(merge_update_columns, merge_exclude_columns, dest_columns) %}\n  {%- set default_cols = dest_columns | map(attribute=\"quoted\") | list -%}\n\n  {%- if merge_update_columns and merge_exclude_columns -%}\n    {{ exceptions.raise_compiler_error(\n        'Model cannot specify merge_update_columns and merge_exclude_columns. Please update model to use only one config'\n    )}}\n  {%- elif merge_update_columns -%}\n    {%- set update_columns = merge_update_columns -%}\n  {%- elif merge_exclude_columns -%}\n    {%- set update_columns = [] -%}\n    {%- for column in dest_columns -%}\n      {% if column.column | lower not in merge_exclude_columns | map(\"lower\") | list %}\n        {%- do update_columns.append(column.quoted) -%}\n      {% endif %}\n    {%- endfor -%}\n  {%- else -%}\n    {%- set update_columns = default_cols -%}\n  {%- endif -%}\n\n  {{ return(update_columns) }}\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.323335, "supported_languages": null}, "macro.dbt.get_merge_sql": {"name": "get_merge_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/merge.sql", "original_file_path": "macros/materializations/models/incremental/merge.sql", "unique_id": "macro.dbt.get_merge_sql", "macro_sql": "{% macro get_merge_sql(target, source, unique_key, dest_columns, incremental_predicates=none) -%}\n   -- back compat for old kwarg name\n  {% set incremental_predicates = kwargs.get('predicates', incremental_predicates) %}\n  {{ adapter.dispatch('get_merge_sql', 'dbt')(target, source, unique_key, dest_columns, incremental_predicates) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__get_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.323963, "supported_languages": null}, "macro.dbt.default__get_merge_sql": {"name": "default__get_merge_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/merge.sql", "original_file_path": "macros/materializations/models/incremental/merge.sql", "unique_id": "macro.dbt.default__get_merge_sql", "macro_sql": "{% macro default__get_merge_sql(target, source, unique_key, dest_columns, incremental_predicates=none) -%}\n    {%- set predicates = [] if incremental_predicates is none else [] + incremental_predicates -%}\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n    {%- set merge_update_columns = config.get('merge_update_columns') -%}\n    {%- set merge_exclude_columns = config.get('merge_exclude_columns') -%}\n    {%- set update_columns = get_merge_update_columns(merge_update_columns, merge_exclude_columns, dest_columns) -%}\n    {%- set sql_header = config.get('sql_header', none) -%}\n\n    {% if unique_key %}\n        {% if unique_key is sequence and unique_key is not mapping and unique_key is not string %}\n            {% for key in unique_key %}\n                {% set this_key_match %}\n                    DBT_INTERNAL_SOURCE.{{ key }} = DBT_INTERNAL_DEST.{{ key }}\n                {% endset %}\n                {% do predicates.append(this_key_match) %}\n            {% endfor %}\n        {% else %}\n            {% set source_unique_key = (\"DBT_INTERNAL_SOURCE.\" ~ unique_key) | trim %}\n\t    {% set target_unique_key = (\"DBT_INTERNAL_DEST.\" ~ unique_key) | trim %}\n\t    {% set unique_key_match = equals(source_unique_key, target_unique_key) | trim %}\n            {% do predicates.append(unique_key_match) %}\n        {% endif %}\n    {% else %}\n        {% do predicates.append('FALSE') %}\n    {% endif %}\n\n    {{ sql_header if sql_header is not none }}\n\n    merge into {{ target }} as DBT_INTERNAL_DEST\n        using {{ source }} as DBT_INTERNAL_SOURCE\n        on {{\"(\" ~ predicates | join(\") and (\") ~ \")\"}}\n\n    {% if unique_key %}\n    when matched then update set\n        {% for column_name in update_columns -%}\n            {{ column_name }} = DBT_INTERNAL_SOURCE.{{ column_name }}\n            {%- if not loop.last %}, {%- endif %}\n        {%- endfor %}\n    {% endif %}\n\n    when not matched then insert\n        ({{ dest_cols_csv }})\n    values\n        ({{ dest_cols_csv }})\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_quoted_csv", "macro.dbt.get_merge_update_columns", "macro.dbt.equals"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.32494, "supported_languages": null}, "macro.dbt.get_delete_insert_merge_sql": {"name": "get_delete_insert_merge_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/merge.sql", "original_file_path": "macros/materializations/models/incremental/merge.sql", "unique_id": "macro.dbt.get_delete_insert_merge_sql", "macro_sql": "{% macro get_delete_insert_merge_sql(target, source, unique_key, dest_columns, incremental_predicates) -%}\n  {{ adapter.dispatch('get_delete_insert_merge_sql', 'dbt')(target, source, unique_key, dest_columns, incremental_predicates) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__get_delete_insert_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3251, "supported_languages": null}, "macro.dbt.default__get_delete_insert_merge_sql": {"name": "default__get_delete_insert_merge_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/merge.sql", "original_file_path": "macros/materializations/models/incremental/merge.sql", "unique_id": "macro.dbt.default__get_delete_insert_merge_sql", "macro_sql": "{% macro default__get_delete_insert_merge_sql(target, source, unique_key, dest_columns, incremental_predicates) -%}\n\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n\n    {% if unique_key %}\n        {% if unique_key is string %}\n        {% set unique_key = [unique_key] %}\n        {% endif %}\n\n        {%- set unique_key_str = unique_key|join(', ') -%}\n\n        delete from {{ target }} as DBT_INTERNAL_DEST\n        where ({{ unique_key_str }}) in (\n            select distinct {{ unique_key_str }}\n            from {{ source }} as DBT_INTERNAL_SOURCE\n        )\n        {%- if incremental_predicates %}\n            {% for predicate in incremental_predicates %}\n                and {{ predicate }}\n            {% endfor %}\n        {%- endif -%};\n\n    {% endif %}\n\n    insert into {{ target }} ({{ dest_cols_csv }})\n    (\n        select {{ dest_cols_csv }}\n        from {{ source }}\n    )\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.get_quoted_csv"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.325504, "supported_languages": null}, "macro.dbt.get_insert_overwrite_merge_sql": {"name": "get_insert_overwrite_merge_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/merge.sql", "original_file_path": "macros/materializations/models/incremental/merge.sql", "unique_id": "macro.dbt.get_insert_overwrite_merge_sql", "macro_sql": "{% macro get_insert_overwrite_merge_sql(target, source, dest_columns, predicates, include_sql_header=false) -%}\n  {{ adapter.dispatch('get_insert_overwrite_merge_sql', 'dbt')(target, source, dest_columns, predicates, include_sql_header) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_insert_overwrite_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.325658, "supported_languages": null}, "macro.dbt.default__get_insert_overwrite_merge_sql": {"name": "default__get_insert_overwrite_merge_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/merge.sql", "original_file_path": "macros/materializations/models/incremental/merge.sql", "unique_id": "macro.dbt.default__get_insert_overwrite_merge_sql", "macro_sql": "{% macro default__get_insert_overwrite_merge_sql(target, source, dest_columns, predicates, include_sql_header) -%}\n    {#-- The only time include_sql_header is True: --#}\n    {#-- BigQuery + insert_overwrite strategy + \"static\" partitions config --#}\n    {#-- We should consider including the sql header at the materialization level instead --#}\n\n    {%- set predicates = [] if predicates is none else [] + predicates -%}\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n    {%- set sql_header = config.get('sql_header', none) -%}\n\n    {{ sql_header if sql_header is not none and include_sql_header }}\n\n    merge into {{ target }} as DBT_INTERNAL_DEST\n        using {{ source }} as DBT_INTERNAL_SOURCE\n        on FALSE\n\n    when not matched by source\n        {% if predicates %} and {{ predicates | join(' and ') }} {% endif %}\n        then delete\n\n    when not matched then insert\n        ({{ dest_cols_csv }})\n    values\n        ({{ dest_cols_csv }})\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_quoted_csv"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3260238, "supported_languages": null}, "macro.dbt.is_incremental": {"name": "is_incremental", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/is_incremental.sql", "original_file_path": "macros/materializations/models/incremental/is_incremental.sql", "unique_id": "macro.dbt.is_incremental", "macro_sql": "{% macro is_incremental() %}\n    {#-- do not run introspective queries in parsing #}\n    {% if not execute %}\n        {{ return(False) }}\n    {% else %}\n        {% set relation = adapter.get_relation(this.database, this.schema, this.table) %}\n        {{ return(relation is not none\n                  and relation.type == 'table'\n                  and model.config.materialized == 'incremental'\n                  and not should_full_refresh()) }}\n    {% endif %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.should_full_refresh"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.326367, "supported_languages": null}, "macro.dbt.get_incremental_append_sql": {"name": "get_incremental_append_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.get_incremental_append_sql", "macro_sql": "{% macro get_incremental_append_sql(arg_dict) %}\n\n  {{ return(adapter.dispatch('get_incremental_append_sql', 'dbt')(arg_dict)) }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__get_incremental_append_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.326828, "supported_languages": null}, "macro.dbt.default__get_incremental_append_sql": {"name": "default__get_incremental_append_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.default__get_incremental_append_sql", "macro_sql": "{% macro default__get_incremental_append_sql(arg_dict) %}\n\n  {% do return(get_insert_into_sql(arg_dict[\"target_relation\"], arg_dict[\"temp_relation\"], arg_dict[\"dest_columns\"])) %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_insert_into_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.326964, "supported_languages": null}, "macro.dbt.get_incremental_delete_insert_sql": {"name": "get_incremental_delete_insert_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.get_incremental_delete_insert_sql", "macro_sql": "{% macro get_incremental_delete_insert_sql(arg_dict) %}\n\n  {{ return(adapter.dispatch('get_incremental_delete_insert_sql', 'dbt')(arg_dict)) }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_incremental_delete_insert_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.327169, "supported_languages": null}, "macro.dbt.default__get_incremental_delete_insert_sql": {"name": "default__get_incremental_delete_insert_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.default__get_incremental_delete_insert_sql", "macro_sql": "{% macro default__get_incremental_delete_insert_sql(arg_dict) %}\n\n  {% do return(get_delete_insert_merge_sql(arg_dict[\"target_relation\"], arg_dict[\"temp_relation\"], arg_dict[\"unique_key\"], arg_dict[\"dest_columns\"], arg_dict[\"incremental_predicates\"])) %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_delete_insert_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.327446, "supported_languages": null}, "macro.dbt.get_incremental_merge_sql": {"name": "get_incremental_merge_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.get_incremental_merge_sql", "macro_sql": "{% macro get_incremental_merge_sql(arg_dict) %}\n\n  {{ return(adapter.dispatch('get_incremental_merge_sql', 'dbt')(arg_dict)) }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_incremental_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.327563, "supported_languages": null}, "macro.dbt.default__get_incremental_merge_sql": {"name": "default__get_incremental_merge_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.default__get_incremental_merge_sql", "macro_sql": "{% macro default__get_incremental_merge_sql(arg_dict) %}\n\n  {% do return(get_merge_sql(arg_dict[\"target_relation\"], arg_dict[\"temp_relation\"], arg_dict[\"unique_key\"], arg_dict[\"dest_columns\"], arg_dict[\"incremental_predicates\"])) %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.327729, "supported_languages": null}, "macro.dbt.get_incremental_insert_overwrite_sql": {"name": "get_incremental_insert_overwrite_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.get_incremental_insert_overwrite_sql", "macro_sql": "{% macro get_incremental_insert_overwrite_sql(arg_dict) %}\n\n  {{ return(adapter.dispatch('get_incremental_insert_overwrite_sql', 'dbt')(arg_dict)) }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_incremental_insert_overwrite_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.327839, "supported_languages": null}, "macro.dbt.default__get_incremental_insert_overwrite_sql": {"name": "default__get_incremental_insert_overwrite_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.default__get_incremental_insert_overwrite_sql", "macro_sql": "{% macro default__get_incremental_insert_overwrite_sql(arg_dict) %}\n\n  {% do return(get_insert_overwrite_merge_sql(arg_dict[\"target_relation\"], arg_dict[\"temp_relation\"], arg_dict[\"dest_columns\"], arg_dict[\"incremental_predicates\"])) %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_insert_overwrite_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.327987, "supported_languages": null}, "macro.dbt.get_incremental_default_sql": {"name": "get_incremental_default_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.get_incremental_default_sql", "macro_sql": "{% macro get_incremental_default_sql(arg_dict) %}\n\n  {{ return(adapter.dispatch('get_incremental_default_sql', 'dbt')(arg_dict)) }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__get_incremental_default_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.328096, "supported_languages": null}, "macro.dbt.default__get_incremental_default_sql": {"name": "default__get_incremental_default_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.default__get_incremental_default_sql", "macro_sql": "{% macro default__get_incremental_default_sql(arg_dict) %}\n\n  {% do return(get_incremental_append_sql(arg_dict)) %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_incremental_append_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3281841, "supported_languages": null}, "macro.dbt.get_incremental_microbatch_sql": {"name": "get_incremental_microbatch_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.get_incremental_microbatch_sql", "macro_sql": "{% macro get_incremental_microbatch_sql(arg_dict) %}\n\n  {{ return(adapter.dispatch('get_incremental_microbatch_sql', 'dbt')(arg_dict)) }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__get_incremental_microbatch_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3282912, "supported_languages": null}, "macro.dbt.default__get_incremental_microbatch_sql": {"name": "default__get_incremental_microbatch_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.default__get_incremental_microbatch_sql", "macro_sql": "{% macro default__get_incremental_microbatch_sql(arg_dict) %}\n\n  {{ exceptions.raise_not_implemented('microbatch materialization strategy not implemented for adapter ' + adapter.type()) }}\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.328386, "supported_languages": null}, "macro.dbt.get_insert_into_sql": {"name": "get_insert_into_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.get_insert_into_sql", "macro_sql": "{% macro get_insert_into_sql(target_relation, temp_relation, dest_columns) %}\n\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n\n    insert into {{ target_relation }} ({{ dest_cols_csv }})\n    (\n        select {{ dest_cols_csv }}\n        from {{ temp_relation }}\n    )\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_quoted_csv"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3285491, "supported_languages": null}, "macro.dbt.materialization_incremental_default": {"name": "materialization_incremental_default", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/incremental.sql", "original_file_path": "macros/materializations/models/incremental/incremental.sql", "unique_id": "macro.dbt.materialization_incremental_default", "macro_sql": "{% materialization incremental, default -%}\n\n  -- relations\n  {%- set existing_relation = load_cached_relation(this) -%}\n  {%- set target_relation = this.incorporate(type='table') -%}\n  {%- set temp_relation = make_temp_relation(target_relation)-%}\n  {%- set intermediate_relation = make_intermediate_relation(target_relation)-%}\n  {%- set backup_relation_type = 'table' if existing_relation is none else existing_relation.type -%}\n  {%- set backup_relation = make_backup_relation(target_relation, backup_relation_type) -%}\n\n  -- configs\n  {%- set unique_key = config.get('unique_key') -%}\n  {%- set full_refresh_mode = (should_full_refresh()  or existing_relation.is_view) -%}\n  {%- set on_schema_change = incremental_validate_on_schema_change(config.get('on_schema_change'), default='ignore') -%}\n\n  -- the temp_ and backup_ relations should not already exist in the database; get_relation\n  -- will return None in that case. Otherwise, we get a relation that we can drop\n  -- later, before we try to use this name for the current operation. This has to happen before\n  -- BEGIN, in a separate transaction\n  {%- set preexisting_intermediate_relation = load_cached_relation(intermediate_relation)-%}\n  {%- set preexisting_backup_relation = load_cached_relation(backup_relation) -%}\n   -- grab current tables grants config for comparision later on\n  {% set grant_config = config.get('grants') %}\n  {{ drop_relation_if_exists(preexisting_intermediate_relation) }}\n  {{ drop_relation_if_exists(preexisting_backup_relation) }}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  {% set to_drop = [] %}\n\n  {% set incremental_strategy = config.get('incremental_strategy') or 'default' %}\n  {% set strategy_sql_macro_func = adapter.get_incremental_strategy_macro(context, incremental_strategy) %}\n\n  {% if existing_relation is none %}\n      {% set build_sql = get_create_table_as_sql(False, target_relation, sql) %}\n      {% set relation_for_indexes = target_relation %}\n  {% elif full_refresh_mode %}\n      {% set build_sql = get_create_table_as_sql(False, intermediate_relation, sql) %}\n      {% set relation_for_indexes = intermediate_relation %}\n      {% set need_swap = true %}\n  {% else %}\n    {% do run_query(get_create_table_as_sql(True, temp_relation, sql)) %}\n    {% set relation_for_indexes = temp_relation %}\n    {% set contract_config = config.get('contract') %}\n    {% if not contract_config or not contract_config.enforced %}\n      {% do adapter.expand_target_column_types(\n               from_relation=temp_relation,\n               to_relation=target_relation) %}\n    {% endif %}\n    {#-- Process schema changes. Returns dict of changes if successful. Use source columns for upserting/merging --#}\n    {% set dest_columns = process_schema_changes(on_schema_change, temp_relation, existing_relation) %}\n    {% if not dest_columns %}\n      {% set dest_columns = adapter.get_columns_in_relation(existing_relation) %}\n    {% endif %}\n\n    {#-- Get the incremental_strategy, the macro to use for the strategy, and build the sql --#}\n    {% set incremental_predicates = config.get('predicates', none) or config.get('incremental_predicates', none) %}\n    {% set strategy_arg_dict = ({'target_relation': target_relation, 'temp_relation': temp_relation, 'unique_key': unique_key, 'dest_columns': dest_columns, 'incremental_predicates': incremental_predicates }) %}\n    {% set build_sql = strategy_sql_macro_func(strategy_arg_dict) %}\n\n  {% endif %}\n\n  {% call statement(\"main\") %}\n      {{ build_sql }}\n  {% endcall %}\n\n  {% if existing_relation is none or existing_relation.is_view or should_full_refresh() %}\n    {% do create_indexes(relation_for_indexes) %}\n  {% endif %}\n\n  {% if need_swap %}\n      {% do adapter.rename_relation(target_relation, backup_relation) %}\n      {% do adapter.rename_relation(intermediate_relation, target_relation) %}\n      {% do to_drop.append(backup_relation) %}\n  {% endif %}\n\n  {% set should_revoke = should_revoke(existing_relation, full_refresh_mode) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  -- `COMMIT` happens here\n  {% do adapter.commit() %}\n\n  {% for rel in to_drop %}\n      {% do adapter.drop_relation(rel) %}\n  {% endfor %}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{%- endmaterialization %}", "depends_on": {"macros": ["macro.dbt.load_cached_relation", "macro.dbt.make_temp_relation", "macro.dbt.make_intermediate_relation", "macro.dbt.make_backup_relation", "macro.dbt.should_full_refresh", "macro.dbt.incremental_validate_on_schema_change", "macro.dbt.drop_relation_if_exists", "macro.dbt.run_hooks", "macro.dbt.get_create_table_as_sql", "macro.dbt.run_query", "macro.dbt.process_schema_changes", "macro.dbt.statement", "macro.dbt.create_indexes", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.331198, "supported_languages": ["sql"]}, "macro.dbt.incremental_validate_on_schema_change": {"name": "incremental_validate_on_schema_change", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/on_schema_change.sql", "original_file_path": "macros/materializations/models/incremental/on_schema_change.sql", "unique_id": "macro.dbt.incremental_validate_on_schema_change", "macro_sql": "{% macro incremental_validate_on_schema_change(on_schema_change, default='ignore') %}\n\n   {% if on_schema_change not in ['sync_all_columns', 'append_new_columns', 'fail', 'ignore'] %}\n\n     {% set log_message = 'Invalid value for on_schema_change (%s) specified. Setting default value of %s.' % (on_schema_change, default) %}\n     {% do log(log_message) %}\n\n     {{ return(default) }}\n\n   {% else %}\n\n     {{ return(on_schema_change) }}\n\n   {% endif %}\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3319008, "supported_languages": null}, "macro.dbt.check_for_schema_changes": {"name": "check_for_schema_changes", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/on_schema_change.sql", "original_file_path": "macros/materializations/models/incremental/on_schema_change.sql", "unique_id": "macro.dbt.check_for_schema_changes", "macro_sql": "{% macro check_for_schema_changes(source_relation, target_relation) %}\n\n  {% set schema_changed = False %}\n\n  {%- set source_columns = adapter.get_columns_in_relation(source_relation) -%}\n  {%- set target_columns = adapter.get_columns_in_relation(target_relation) -%}\n  {%- set source_not_in_target = diff_columns(source_columns, target_columns) -%}\n  {%- set target_not_in_source = diff_columns(target_columns, source_columns) -%}\n\n  {% set new_target_types = diff_column_data_types(source_columns, target_columns) %}\n\n  {% if source_not_in_target != [] %}\n    {% set schema_changed = True %}\n  {% elif target_not_in_source != [] or new_target_types != [] %}\n    {% set schema_changed = True %}\n  {% elif new_target_types != [] %}\n    {% set schema_changed = True %}\n  {% endif %}\n\n  {% set changes_dict = {\n    'schema_changed': schema_changed,\n    'source_not_in_target': source_not_in_target,\n    'target_not_in_source': target_not_in_source,\n    'source_columns': source_columns,\n    'target_columns': target_columns,\n    'new_target_types': new_target_types\n  } %}\n\n  {% set msg %}\n    In {{ target_relation }}:\n        Schema changed: {{ schema_changed }}\n        Source columns not in target: {{ source_not_in_target }}\n        Target columns not in source: {{ target_not_in_source }}\n        New column types: {{ new_target_types }}\n  {% endset %}\n\n  {% do log(msg) %}\n\n  {{ return(changes_dict) }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.diff_columns", "macro.dbt.diff_column_data_types"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.332572, "supported_languages": null}, "macro.dbt.sync_column_schemas": {"name": "sync_column_schemas", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/on_schema_change.sql", "original_file_path": "macros/materializations/models/incremental/on_schema_change.sql", "unique_id": "macro.dbt.sync_column_schemas", "macro_sql": "{% macro sync_column_schemas(on_schema_change, target_relation, schema_changes_dict) %}\n\n  {%- set add_to_target_arr = schema_changes_dict['source_not_in_target'] -%}\n\n  {%- if on_schema_change == 'append_new_columns'-%}\n     {%- if add_to_target_arr | length > 0 -%}\n       {%- do alter_relation_add_remove_columns(target_relation, add_to_target_arr, none) -%}\n     {%- endif -%}\n\n  {% elif on_schema_change == 'sync_all_columns' %}\n     {%- set remove_from_target_arr = schema_changes_dict['target_not_in_source'] -%}\n     {%- set new_target_types = schema_changes_dict['new_target_types'] -%}\n\n     {% if add_to_target_arr | length > 0 or remove_from_target_arr | length > 0 %}\n       {%- do alter_relation_add_remove_columns(target_relation, add_to_target_arr, remove_from_target_arr) -%}\n     {% endif %}\n\n     {% if new_target_types != [] %}\n       {% for ntt in new_target_types %}\n         {% set column_name = ntt['column_name'] %}\n         {% set new_type = ntt['new_type'] %}\n         {% do alter_column_type(target_relation, column_name, new_type) %}\n       {% endfor %}\n     {% endif %}\n\n  {% endif %}\n\n  {% set schema_change_message %}\n    In {{ target_relation }}:\n        Schema change approach: {{ on_schema_change }}\n        Columns added: {{ add_to_target_arr }}\n        Columns removed: {{ remove_from_target_arr }}\n        Data types changed: {{ new_target_types }}\n  {% endset %}\n\n  {% do log(schema_change_message) %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.alter_relation_add_remove_columns", "macro.dbt.alter_column_type"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3334148, "supported_languages": null}, "macro.dbt.process_schema_changes": {"name": "process_schema_changes", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/on_schema_change.sql", "original_file_path": "macros/materializations/models/incremental/on_schema_change.sql", "unique_id": "macro.dbt.process_schema_changes", "macro_sql": "{% macro process_schema_changes(on_schema_change, source_relation, target_relation) %}\n\n    {% if on_schema_change == 'ignore' %}\n\n     {{ return({}) }}\n\n    {% else %}\n\n      {% set schema_changes_dict = check_for_schema_changes(source_relation, target_relation) %}\n\n      {% if schema_changes_dict['schema_changed'] %}\n\n        {% if on_schema_change == 'fail' %}\n\n          {% set fail_msg %}\n              The source and target schemas on this incremental model are out of sync!\n              They can be reconciled in several ways:\n                - set the `on_schema_change` config to either append_new_columns or sync_all_columns, depending on your situation.\n                - Re-run the incremental model with `full_refresh: True` to update the target schema.\n                - update the schema manually and re-run the process.\n\n              Additional troubleshooting context:\n                 Source columns not in target: {{ schema_changes_dict['source_not_in_target'] }}\n                 Target columns not in source: {{ schema_changes_dict['target_not_in_source'] }}\n                 New column types: {{ schema_changes_dict['new_target_types'] }}\n          {% endset %}\n\n          {% do exceptions.raise_compiler_error(fail_msg) %}\n\n        {# -- unless we ignore, run the sync operation per the config #}\n        {% else %}\n\n          {% do sync_column_schemas(on_schema_change, target_relation, schema_changes_dict) %}\n\n        {% endif %}\n\n      {% endif %}\n\n      {{ return(schema_changes_dict['source_columns']) }}\n\n    {% endif %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.check_for_schema_changes", "macro.dbt.sync_column_schemas"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.333932, "supported_languages": null}, "macro.dbt.can_clone_table": {"name": "can_clone_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/clone/can_clone_table.sql", "original_file_path": "macros/materializations/models/clone/can_clone_table.sql", "unique_id": "macro.dbt.can_clone_table", "macro_sql": "{% macro can_clone_table() %}\n    {{ return(adapter.dispatch('can_clone_table', 'dbt')()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__can_clone_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.334094, "supported_languages": null}, "macro.dbt.default__can_clone_table": {"name": "default__can_clone_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/clone/can_clone_table.sql", "original_file_path": "macros/materializations/models/clone/can_clone_table.sql", "unique_id": "macro.dbt.default__can_clone_table", "macro_sql": "{% macro default__can_clone_table() %}\n    {{ return(False) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.334167, "supported_languages": null}, "macro.dbt.create_or_replace_clone": {"name": "create_or_replace_clone", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/clone/create_or_replace_clone.sql", "original_file_path": "macros/materializations/models/clone/create_or_replace_clone.sql", "unique_id": "macro.dbt.create_or_replace_clone", "macro_sql": "{% macro create_or_replace_clone(this_relation, defer_relation) %}\n    {{ return(adapter.dispatch('create_or_replace_clone', 'dbt')(this_relation, defer_relation)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__create_or_replace_clone"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.334341, "supported_languages": null}, "macro.dbt.default__create_or_replace_clone": {"name": "default__create_or_replace_clone", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/clone/create_or_replace_clone.sql", "original_file_path": "macros/materializations/models/clone/create_or_replace_clone.sql", "unique_id": "macro.dbt.default__create_or_replace_clone", "macro_sql": "{% macro default__create_or_replace_clone(this_relation, defer_relation) %}\n    create or replace table {{ this_relation.render() }} clone {{ defer_relation.render() }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.334441, "supported_languages": null}, "macro.dbt.materialization_clone_default": {"name": "materialization_clone_default", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/clone/clone.sql", "original_file_path": "macros/materializations/models/clone/clone.sql", "unique_id": "macro.dbt.materialization_clone_default", "macro_sql": "{%- materialization clone, default -%}\n\n  {%- set relations = {'relations': []} -%}\n\n  {%- if not defer_relation -%}\n      -- nothing to do\n      {{ log(\"No relation found in state manifest for \" ~ model.unique_id, info=True) }}\n      {{ return(relations) }}\n  {%- endif -%}\n\n  {%- set existing_relation = load_cached_relation(this) -%}\n\n  {%- if existing_relation and not flags.FULL_REFRESH -%}\n      -- noop!\n      {{ log(\"Relation \" ~ existing_relation ~ \" already exists\", info=True) }}\n      {{ return(relations) }}\n  {%- endif -%}\n\n  {%- set other_existing_relation = load_cached_relation(defer_relation) -%}\n\n  -- If this is a database that can do zero-copy cloning of tables, and the other relation is a table, then this will be a table\n  -- Otherwise, this will be a view\n\n  {% set can_clone_table = can_clone_table() %}\n\n  {%- if other_existing_relation and other_existing_relation.type == 'table' and can_clone_table -%}\n\n      {%- set target_relation = this.incorporate(type='table') -%}\n      {% if existing_relation is not none and not existing_relation.is_table %}\n        {{ log(\"Dropping relation \" ~ existing_relation.render() ~ \" because it is of type \" ~ existing_relation.type) }}\n        {{ drop_relation_if_exists(existing_relation) }}\n      {% endif %}\n\n      -- as a general rule, data platforms that can clone tables can also do atomic 'create or replace'\n      {% if target_relation.database == defer_relation.database and\n            target_relation.schema == defer_relation.schema and\n            target_relation.identifier == defer_relation.identifier %}\n        {{ log(\"Target relation and defer relation are the same, skipping clone for relation: \" ~ target_relation.render()) }}\n      {% else %}\n        {% call statement('main') %}\n            {{ create_or_replace_clone(target_relation, defer_relation) }}\n        {% endcall %}\n      {% endif %}\n      {% set should_revoke = should_revoke(existing_relation, full_refresh_mode=True) %}\n      {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n      {% do persist_docs(target_relation, model) %}\n\n      {{ return({'relations': [target_relation]}) }}\n\n  {%- else -%}\n\n      {%- set target_relation = this.incorporate(type='view') -%}\n\n      -- reuse the view materialization\n      -- TODO: support actual dispatch for materialization macros\n      -- Tracking ticket: https://github.com/dbt-labs/dbt-core/issues/7799\n      {% set search_name = \"materialization_view_\" ~ adapter.type() %}\n      {% if not search_name in context %}\n          {% set search_name = \"materialization_view_default\" %}\n      {% endif %}\n      {% set materialization_macro = context[search_name] %}\n      {% set relations = materialization_macro() %}\n      {{ return(relations) }}\n\n  {%- endif -%}\n\n{%- endmaterialization -%}", "depends_on": {"macros": ["macro.dbt.load_cached_relation", "macro.dbt.can_clone_table", "macro.dbt.drop_relation_if_exists", "macro.dbt.statement", "macro.dbt.create_or_replace_clone", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.33587, "supported_languages": ["sql"]}, "macro.dbt.materialization_seed_default": {"name": "materialization_seed_default", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/seed.sql", "original_file_path": "macros/materializations/seeds/seed.sql", "unique_id": "macro.dbt.materialization_seed_default", "macro_sql": "{% materialization seed, default %}\n\n  {%- set identifier = model['alias'] -%}\n  {%- set full_refresh_mode = (should_full_refresh()) -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n\n  {%- set exists_as_table = (old_relation is not none and old_relation.is_table) -%}\n  {%- set exists_as_view = (old_relation is not none and old_relation.is_view) -%}\n\n  {%- set grant_config = config.get('grants') -%}\n  {%- set agate_table = load_agate_table() -%}\n  -- grab current tables grants config for comparison later on\n\n  {%- do store_result('agate_table', response='OK', agate_table=agate_table) -%}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  -- build model\n  {% set create_table_sql = \"\" %}\n  {% if exists_as_view %}\n    {{ exceptions.raise_compiler_error(\"Cannot seed to '{}', it is a view\".format(old_relation.render())) }}\n  {% elif exists_as_table %}\n    {% set create_table_sql = reset_csv_table(model, full_refresh_mode, old_relation, agate_table) %}\n  {% else %}\n    {% set create_table_sql = create_csv_table(model, agate_table) %}\n  {% endif %}\n\n  {% set code = 'CREATE' if full_refresh_mode else 'INSERT' %}\n  {% set rows_affected = (agate_table.rows | length) %}\n  {% set sql = load_csv_rows(model, agate_table) %}\n\n  {% call noop_statement('main', code ~ ' ' ~ rows_affected, code, rows_affected) %}\n    {{ get_csv_sql(create_table_sql, sql) }};\n  {% endcall %}\n\n  {% set target_relation = this.incorporate(type='table') %}\n\n  {% set should_revoke = should_revoke(old_relation, full_refresh_mode) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {% if full_refresh_mode or not exists_as_table %}\n    {% do create_indexes(target_relation) %}\n  {% endif %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  -- `COMMIT` happens here\n  {{ adapter.commit() }}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{% endmaterialization %}", "depends_on": {"macros": ["macro.dbt.should_full_refresh", "macro.dbt.run_hooks", "macro.dbt.reset_csv_table", "macro.dbt.create_csv_table", "macro.dbt.load_csv_rows", "macro.dbt.noop_statement", "macro.dbt.get_csv_sql", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs", "macro.dbt.create_indexes"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.337405, "supported_languages": ["sql"]}, "macro.dbt.create_csv_table": {"name": "create_csv_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.create_csv_table", "macro_sql": "{% macro create_csv_table(model, agate_table) -%}\n  {{ adapter.dispatch('create_csv_table', 'dbt')(model, agate_table) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__create_csv_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3379688, "supported_languages": null}, "macro.dbt.default__create_csv_table": {"name": "default__create_csv_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.default__create_csv_table", "macro_sql": "{% macro default__create_csv_table(model, agate_table) %}\n  {%- set column_override = model['config'].get('column_types', {}) -%}\n  {%- set quote_seed_column = model['config'].get('quote_columns', None) -%}\n\n  {% set sql %}\n    create table {{ this.render() }} (\n        {%- for col_name in agate_table.column_names -%}\n            {%- set inferred_type = adapter.convert_type(agate_table, loop.index0) -%}\n            {%- set type = column_override.get(col_name, inferred_type) -%}\n            {%- set column_name = (col_name | string) -%}\n            {{ adapter.quote_seed_column(column_name, quote_seed_column) }} {{ type }} {%- if not loop.last -%}, {%- endif -%}\n        {%- endfor -%}\n    )\n  {% endset %}\n\n  {% call statement('_') -%}\n    {{ sql }}\n  {%- endcall %}\n\n  {{ return(sql) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.338481, "supported_languages": null}, "macro.dbt.reset_csv_table": {"name": "reset_csv_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.reset_csv_table", "macro_sql": "{% macro reset_csv_table(model, full_refresh, old_relation, agate_table) -%}\n  {{ adapter.dispatch('reset_csv_table', 'dbt')(model, full_refresh, old_relation, agate_table) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__reset_csv_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.33862, "supported_languages": null}, "macro.dbt.default__reset_csv_table": {"name": "default__reset_csv_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.default__reset_csv_table", "macro_sql": "{% macro default__reset_csv_table(model, full_refresh, old_relation, agate_table) %}\n    {% set sql = \"\" %}\n    {% if full_refresh %}\n        {{ adapter.drop_relation(old_relation) }}\n        {% set sql = create_csv_table(model, agate_table) %}\n    {% else %}\n        {{ adapter.truncate_relation(old_relation) }}\n        {% set sql = \"truncate table \" ~ old_relation.render() %}\n    {% endif %}\n\n    {{ return(sql) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.create_csv_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.338905, "supported_languages": null}, "macro.dbt.get_csv_sql": {"name": "get_csv_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.get_csv_sql", "macro_sql": "{% macro get_csv_sql(create_or_truncate_sql, insert_sql) %}\n    {{ adapter.dispatch('get_csv_sql', 'dbt')(create_or_truncate_sql, insert_sql) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_csv_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.33902, "supported_languages": null}, "macro.dbt.default__get_csv_sql": {"name": "default__get_csv_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.default__get_csv_sql", "macro_sql": "{% macro default__get_csv_sql(create_or_truncate_sql, insert_sql) %}\n    {{ create_or_truncate_sql }};\n    -- dbt seed --\n    {{ insert_sql }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3391, "supported_languages": null}, "macro.dbt.get_binding_char": {"name": "get_binding_char", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.get_binding_char", "macro_sql": "{% macro get_binding_char() -%}\n  {{ adapter.dispatch('get_binding_char', 'dbt')() }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_binding_char"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.339185, "supported_languages": null}, "macro.dbt.default__get_binding_char": {"name": "default__get_binding_char", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.default__get_binding_char", "macro_sql": "{% macro default__get_binding_char() %}\n  {{ return('%s') }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.339259, "supported_languages": null}, "macro.dbt.get_batch_size": {"name": "get_batch_size", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.get_batch_size", "macro_sql": "{% macro get_batch_size() -%}\n  {{ return(adapter.dispatch('get_batch_size', 'dbt')()) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_batch_size"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.339356, "supported_languages": null}, "macro.dbt.default__get_batch_size": {"name": "default__get_batch_size", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.default__get_batch_size", "macro_sql": "{% macro default__get_batch_size() %}\n  {{ return(10000) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3394282, "supported_languages": null}, "macro.dbt.get_seed_column_quoted_csv": {"name": "get_seed_column_quoted_csv", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.get_seed_column_quoted_csv", "macro_sql": "{% macro get_seed_column_quoted_csv(model, column_names) %}\n  {%- set quote_seed_column = model['config'].get('quote_columns', None) -%}\n    {% set quoted = [] %}\n    {% for col in column_names -%}\n        {%- do quoted.append(adapter.quote_seed_column(col, quote_seed_column)) -%}\n    {%- endfor %}\n\n    {%- set dest_cols_csv = quoted | join(', ') -%}\n    {{ return(dest_cols_csv) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3397062, "supported_languages": null}, "macro.dbt.load_csv_rows": {"name": "load_csv_rows", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.load_csv_rows", "macro_sql": "{% macro load_csv_rows(model, agate_table) -%}\n  {{ adapter.dispatch('load_csv_rows', 'dbt')(model, agate_table) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__load_csv_rows"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.339819, "supported_languages": null}, "macro.dbt.default__load_csv_rows": {"name": "default__load_csv_rows", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.default__load_csv_rows", "macro_sql": "{% macro default__load_csv_rows(model, agate_table) %}\n\n  {% set batch_size = get_batch_size() %}\n\n  {% set cols_sql = get_seed_column_quoted_csv(model, agate_table.column_names) %}\n  {% set bindings = [] %}\n\n  {% set statements = [] %}\n\n  {% for chunk in agate_table.rows | batch(batch_size) %}\n      {% set bindings = [] %}\n\n      {% for row in chunk %}\n          {% do bindings.extend(row) %}\n      {% endfor %}\n\n      {% set sql %}\n          insert into {{ this.render() }} ({{ cols_sql }}) values\n          {% for row in chunk -%}\n              ({%- for column in agate_table.column_names -%}\n                  {{ get_binding_char() }}\n                  {%- if not loop.last%},{%- endif %}\n              {%- endfor -%})\n              {%- if not loop.last%},{%- endif %}\n          {%- endfor %}\n      {% endset %}\n\n      {% do adapter.add_query(sql, bindings=bindings, abridge_sql_log=True) %}\n\n      {% if loop.index0 == 0 %}\n          {% do statements.append(sql) %}\n      {% endif %}\n  {% endfor %}\n\n  {# Return SQL so we can render it out into the compiled files #}\n  {{ return(statements[0]) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_batch_size", "macro.dbt.get_seed_column_quoted_csv", "macro.dbt.get_binding_char"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.340516, "supported_languages": null}, "macro.dbt.scalar_function_sql": {"name": "scalar_function_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/functions/scalar.sql", "original_file_path": "macros/materializations/functions/scalar.sql", "unique_id": "macro.dbt.scalar_function_sql", "macro_sql": "{% macro scalar_function_sql(target_relation) %}\n    {{ return(adapter.dispatch('scalar_function_sql', 'dbt')(target_relation)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__scalar_function_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.340975, "supported_languages": null}, "macro.dbt.default__scalar_function_sql": {"name": "default__scalar_function_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/functions/scalar.sql", "original_file_path": "macros/materializations/functions/scalar.sql", "unique_id": "macro.dbt.default__scalar_function_sql", "macro_sql": "{% macro default__scalar_function_sql(target_relation) %}\n    {{ scalar_function_create_replace_signature_sql(target_relation) }}\n    {{ scalar_function_body_sql() }};\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.scalar_function_create_replace_signature_sql", "macro.dbt.scalar_function_body_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.341077, "supported_languages": null}, "macro.dbt.scalar_function_create_replace_signature_sql": {"name": "scalar_function_create_replace_signature_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/functions/scalar.sql", "original_file_path": "macros/materializations/functions/scalar.sql", "unique_id": "macro.dbt.scalar_function_create_replace_signature_sql", "macro_sql": "{% macro scalar_function_create_replace_signature_sql(target_relation) %}\n    {{ return(adapter.dispatch('scalar_function_create_replace_signature_sql', 'dbt')(target_relation)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__scalar_function_create_replace_signature_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3411908, "supported_languages": null}, "macro.dbt.default__scalar_function_create_replace_signature_sql": {"name": "default__scalar_function_create_replace_signature_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/functions/scalar.sql", "original_file_path": "macros/materializations/functions/scalar.sql", "unique_id": "macro.dbt.default__scalar_function_create_replace_signature_sql", "macro_sql": "{% macro default__scalar_function_create_replace_signature_sql(target_relation) %}\n    CREATE OR REPLACE FUNCTION {{ target_relation.render() }} ({{ formatted_scalar_function_args_sql()}})\n    RETURNS {{ model.returns.data_type }}\n    {{ scalar_function_volatility_sql() }}\n    AS\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.formatted_scalar_function_args_sql", "macro.dbt.scalar_function_volatility_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.341318, "supported_languages": null}, "macro.dbt.formatted_scalar_function_args_sql": {"name": "formatted_scalar_function_args_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/functions/scalar.sql", "original_file_path": "macros/materializations/functions/scalar.sql", "unique_id": "macro.dbt.formatted_scalar_function_args_sql", "macro_sql": "{% macro formatted_scalar_function_args_sql() %}\n    {{ return(adapter.dispatch('formatted_scalar_function_args_sql', 'dbt')()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__formatted_scalar_function_args_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3414211, "supported_languages": null}, "macro.dbt.default__formatted_scalar_function_args_sql": {"name": "default__formatted_scalar_function_args_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/functions/scalar.sql", "original_file_path": "macros/materializations/functions/scalar.sql", "unique_id": "macro.dbt.default__formatted_scalar_function_args_sql", "macro_sql": "{% macro default__formatted_scalar_function_args_sql() %}\n    {% set args = [] %}\n    {% for arg in model.arguments -%}\n        {%- do args.append(arg.name ~ ' ' ~ arg.data_type) -%}\n    {%- endfor %}\n    {{ args | join(', ') }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.341614, "supported_languages": null}, "macro.dbt.scalar_function_body_sql": {"name": "scalar_function_body_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/functions/scalar.sql", "original_file_path": "macros/materializations/functions/scalar.sql", "unique_id": "macro.dbt.scalar_function_body_sql", "macro_sql": "{% macro scalar_function_body_sql() %}\n    {{ return(adapter.dispatch('scalar_function_body_sql', 'dbt')()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__scalar_function_body_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3417149, "supported_languages": null}, "macro.dbt.default__scalar_function_body_sql": {"name": "default__scalar_function_body_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/functions/scalar.sql", "original_file_path": "macros/materializations/functions/scalar.sql", "unique_id": "macro.dbt.default__scalar_function_body_sql", "macro_sql": "{% macro default__scalar_function_body_sql() %}\n    $$\n       {{ model.compiled_code }}\n    $$ LANGUAGE SQL\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.341779, "supported_languages": null}, "macro.dbt.scalar_function_volatility_sql": {"name": "scalar_function_volatility_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/functions/scalar.sql", "original_file_path": "macros/materializations/functions/scalar.sql", "unique_id": "macro.dbt.scalar_function_volatility_sql", "macro_sql": "{% macro scalar_function_volatility_sql() %}\n    {{ return(adapter.dispatch('scalar_function_volatility_sql', 'dbt')()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__scalar_function_volatility_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.341876, "supported_languages": null}, "macro.dbt.default__scalar_function_volatility_sql": {"name": "default__scalar_function_volatility_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/functions/scalar.sql", "original_file_path": "macros/materializations/functions/scalar.sql", "unique_id": "macro.dbt.default__scalar_function_volatility_sql", "macro_sql": "{% macro default__scalar_function_volatility_sql() %}\n    {% set volatility = model.config.get('volatility') %}\n    {% if volatility == 'deterministic' %}\n        IMMUTABLE\n    {% elif volatility == 'stable' %}\n        STABLE\n    {% elif volatility == 'non-deterministic' %}\n        VOLATILE\n    {% elif volatility != none %}\n        {# This shouldn't happen unless a new volatility is invented #}\n        {% do unsupported_volatility_warning(volatility) %}\n    {% endif %}\n    {# If no volatility is set, don't add anything and let the data warehouse default it #}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.unsupported_volatility_warning"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.342121, "supported_languages": null}, "macro.dbt.unsupported_volatility_warning": {"name": "unsupported_volatility_warning", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/functions/scalar.sql", "original_file_path": "macros/materializations/functions/scalar.sql", "unique_id": "macro.dbt.unsupported_volatility_warning", "macro_sql": "{% macro unsupported_volatility_warning(volatility) %}\n    {{ return(adapter.dispatch('unsupported_volatility_warning', 'dbt')(volatility)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__unsupported_volatility_warning"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3422348, "supported_languages": null}, "macro.dbt.default__unsupported_volatility_warning": {"name": "default__unsupported_volatility_warning", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/functions/scalar.sql", "original_file_path": "macros/materializations/functions/scalar.sql", "unique_id": "macro.dbt.default__unsupported_volatility_warning", "macro_sql": "{% macro default__unsupported_volatility_warning(volatility) %}\n    {% set msg = \"Found `\" ~ volatility ~ \"` volatility specified on function `\" ~ model.name ~ \"`. This volatility is not supported by \" ~ adapter.type() ~ \", and will be ignored\" %}\n    {% do exceptions.warn(msg) %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.342392, "supported_languages": null}, "macro.dbt.function_execute_build_sql": {"name": "function_execute_build_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/functions/helpers.sql", "original_file_path": "macros/materializations/functions/helpers.sql", "unique_id": "macro.dbt.function_execute_build_sql", "macro_sql": "{% macro function_execute_build_sql(build_sql, existing_relation, target_relation) %}\n    {{ return(adapter.dispatch('function_execute_build_sql', 'dbt')(build_sql, existing_relation, target_relation)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__function_execute_build_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3426151, "supported_languages": null}, "macro.dbt.default__function_execute_build_sql": {"name": "default__function_execute_build_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/functions/helpers.sql", "original_file_path": "macros/materializations/functions/helpers.sql", "unique_id": "macro.dbt.default__function_execute_build_sql", "macro_sql": "{% macro default__function_execute_build_sql(build_sql, existing_relation, target_relation) %}\n\n    {% set grant_config = config.get('grants') %}\n\n    {% call statement(name=\"main\") %}\n        {{ build_sql }}\n    {% endcall %}\n\n    {% set should_revoke = should_revoke(existing_relation, full_refresh_mode=True) %}\n    {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n    {% do persist_docs(target_relation, model) %}\n\n    {{ adapter.commit() }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.342965, "supported_languages": null}, "macro.dbt.get_aggregate_function_create_replace_signature": {"name": "get_aggregate_function_create_replace_signature", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/functions/aggregate.sql", "original_file_path": "macros/materializations/functions/aggregate.sql", "unique_id": "macro.dbt.get_aggregate_function_create_replace_signature", "macro_sql": "{% macro get_aggregate_function_create_replace_signature(target_relation) %}\n    {{ return(adapter.dispatch('get_aggregate_function_create_replace_signature', 'dbt')(target_relation)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_aggregate_function_create_replace_signature"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.343331, "supported_languages": null}, "macro.dbt.default__get_aggregate_function_create_replace_signature": {"name": "default__get_aggregate_function_create_replace_signature", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/functions/aggregate.sql", "original_file_path": "macros/materializations/functions/aggregate.sql", "unique_id": "macro.dbt.default__get_aggregate_function_create_replace_signature", "macro_sql": "{% macro default__get_aggregate_function_create_replace_signature(target_relation) %}\n    CREATE OR REPLACE AGGREGATE FUNCTION {{ target_relation.render() }} ({{ get_formatted_aggregate_function_args()}})\n    RETURNS {{ model.returns.data_type }}\n    {{ get_function_language_specifier() }}\n    {% if model.get('language') == 'python' %}\n        {{ get_function_python_options() }}\n    {% endif %}\n    {{ scalar_function_volatility_sql() }}\n    AS\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_formatted_aggregate_function_args", "macro.dbt.get_function_language_specifier", "macro.dbt.get_function_python_options", "macro.dbt.scalar_function_volatility_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.34355, "supported_languages": null}, "macro.dbt.get_formatted_aggregate_function_args": {"name": "get_formatted_aggregate_function_args", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/functions/aggregate.sql", "original_file_path": "macros/materializations/functions/aggregate.sql", "unique_id": "macro.dbt.get_formatted_aggregate_function_args", "macro_sql": "{% macro get_formatted_aggregate_function_args() %}\n    {{ return(adapter.dispatch('get_formatted_aggregate_function_args', 'dbt')()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_formatted_aggregate_function_args"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.343658, "supported_languages": null}, "macro.dbt.default__get_formatted_aggregate_function_args": {"name": "default__get_formatted_aggregate_function_args", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/functions/aggregate.sql", "original_file_path": "macros/materializations/functions/aggregate.sql", "unique_id": "macro.dbt.default__get_formatted_aggregate_function_args", "macro_sql": "{% macro default__get_formatted_aggregate_function_args() %}\n    {# conveniently we can reuse the sql scalar function args #}\n    {{ formatted_scalar_function_args_sql() }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.formatted_scalar_function_args_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.34373, "supported_languages": null}, "macro.dbt.get_function_language_specifier": {"name": "get_function_language_specifier", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/functions/aggregate.sql", "original_file_path": "macros/materializations/functions/aggregate.sql", "unique_id": "macro.dbt.get_function_language_specifier", "macro_sql": "{% macro get_function_language_specifier() %}\n    {{ return(adapter.dispatch('get_function_language_specifier', 'dbt')()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_function_language_specifier"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.343828, "supported_languages": null}, "macro.dbt.default__get_function_language_specifier": {"name": "default__get_function_language_specifier", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/functions/aggregate.sql", "original_file_path": "macros/materializations/functions/aggregate.sql", "unique_id": "macro.dbt.default__get_function_language_specifier", "macro_sql": "{% macro default__get_function_language_specifier() %}\n    {% set language = model.get('language') %}\n    {% if language == 'sql' %}\n        {# generally you dont need to specify the language for sql functions #}\n    {% elif language == 'python' %}\n        LANGUAGE PYTHON\n    {% else %}\n        {{ 'LANGUAGE ' ~ language.upper() }}\n    {% endif %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.344021, "supported_languages": null}, "macro.dbt.get_aggregate_function_volatility_specifier": {"name": "get_aggregate_function_volatility_specifier", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/functions/aggregate.sql", "original_file_path": "macros/materializations/functions/aggregate.sql", "unique_id": "macro.dbt.get_aggregate_function_volatility_specifier", "macro_sql": "{% macro get_aggregate_function_volatility_specifier() %}\n    {{ return(adapter.dispatch('get_aggregate_function_volatility_specifier', 'dbt')()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_aggregate_function_volatility_specifier"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.344126, "supported_languages": null}, "macro.dbt.default__get_aggregate_function_volatility_specifier": {"name": "default__get_aggregate_function_volatility_specifier", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/functions/aggregate.sql", "original_file_path": "macros/materializations/functions/aggregate.sql", "unique_id": "macro.dbt.default__get_aggregate_function_volatility_specifier", "macro_sql": "{% macro default__get_aggregate_function_volatility_specifier() %}\n    {{ scalar_function_volatility_sql() }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.scalar_function_volatility_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.344191, "supported_languages": null}, "macro.dbt.get_function_python_options": {"name": "get_function_python_options", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/functions/aggregate.sql", "original_file_path": "macros/materializations/functions/aggregate.sql", "unique_id": "macro.dbt.get_function_python_options", "macro_sql": "{% macro get_function_python_options() %}\n    {{ return(adapter.dispatch('get_function_python_options', 'dbt')()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_function_python_options"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.344288, "supported_languages": null}, "macro.dbt.default__get_function_python_options": {"name": "default__get_function_python_options", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/functions/aggregate.sql", "original_file_path": "macros/materializations/functions/aggregate.sql", "unique_id": "macro.dbt.default__get_function_python_options", "macro_sql": "{% macro default__get_function_python_options() %}\n    RUNTIME_VERSION = '{{ model.config.get('runtime_version') }}'\n    HANDLER = '{{ model.config.get('entry_point') }}'\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3443992, "supported_languages": null}, "macro.dbt.materialization_function_default": {"name": "materialization_function_default", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/functions/function.sql", "original_file_path": "macros/materializations/functions/function.sql", "unique_id": "macro.dbt.materialization_function_default", "macro_sql": "{% materialization function, default, supported_languages=['sql', 'python'] %}\n    {% set existing_relation = load_cached_relation(this) %}\n    {% set target_relation = this.incorporate(type=this.Function) %}\n\n    {{ run_hooks(pre_hooks) }}\n\n    {% set function_config = this.get_function_config(model) %}\n    {% set macro_name = this.get_function_macro_name(function_config) %}\n\n    {# Doing this aliasing of adapter.dispatch is a hacky way to disable the static analysis of actually calling adapter.dispatch #}\n    {# This is necessary because the static analysis breaks being able to dynamically pass a macro_name #}\n    {% set _dispatch = adapter.dispatch %}\n\n    {% set build_sql = _dispatch(macro_name, 'dbt')(target_relation) %}\n    {{ function_execute_build_sql(build_sql, existing_relation, target_relation) }}\n    {{ run_hooks(post_hooks) }}\n\n    {{ return({'relations': [target_relation]}) }}\n\n{% endmaterialization %}", "depends_on": {"macros": ["macro.dbt.load_cached_relation", "macro.dbt.run_hooks", "macro.dbt.function_execute_build_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3449311, "supported_languages": ["sql", "python"]}, "macro.dbt.generate_alias_name": {"name": "generate_alias_name", "resource_type": "macro", "package_name": "dbt", "path": "macros/get_custom_name/get_custom_alias.sql", "original_file_path": "macros/get_custom_name/get_custom_alias.sql", "unique_id": "macro.dbt.generate_alias_name", "macro_sql": "{% macro generate_alias_name(custom_alias_name=none, node=none) -%}\n    {% do return(adapter.dispatch('generate_alias_name', 'dbt')(custom_alias_name, node)) %}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__generate_alias_name"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3451579, "supported_languages": null}, "macro.dbt.default__generate_alias_name": {"name": "default__generate_alias_name", "resource_type": "macro", "package_name": "dbt", "path": "macros/get_custom_name/get_custom_alias.sql", "original_file_path": "macros/get_custom_name/get_custom_alias.sql", "unique_id": "macro.dbt.default__generate_alias_name", "macro_sql": "{% macro default__generate_alias_name(custom_alias_name=none, node=none) -%}\n\n    {%- if custom_alias_name -%}\n\n        {{ custom_alias_name | trim }}\n\n    {%- elif node.version -%}\n\n        {{ return(node.name ~ \"_v\" ~ (node.version | replace(\".\", \"_\"))) }}\n\n    {%- else -%}\n\n        {{ node.name }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3454258, "supported_languages": null}, "macro.dbt.generate_schema_name": {"name": "generate_schema_name", "resource_type": "macro", "package_name": "dbt", "path": "macros/get_custom_name/get_custom_schema.sql", "original_file_path": "macros/get_custom_name/get_custom_schema.sql", "unique_id": "macro.dbt.generate_schema_name", "macro_sql": "{% macro generate_schema_name(custom_schema_name=none, node=none) -%}\n    {{ return(adapter.dispatch('generate_schema_name', 'dbt')(custom_schema_name, node)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__generate_schema_name"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.345726, "supported_languages": null}, "macro.dbt.default__generate_schema_name": {"name": "default__generate_schema_name", "resource_type": "macro", "package_name": "dbt", "path": "macros/get_custom_name/get_custom_schema.sql", "original_file_path": "macros/get_custom_name/get_custom_schema.sql", "unique_id": "macro.dbt.default__generate_schema_name", "macro_sql": "{% macro default__generate_schema_name(custom_schema_name, node) -%}\n\n    {%- set default_schema = target.schema -%}\n    {%- if custom_schema_name is none -%}\n\n        {{ default_schema }}\n\n    {%- else -%}\n\n        {{ default_schema }}_{{ custom_schema_name | trim }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.345899, "supported_languages": null}, "macro.dbt.generate_schema_name_for_env": {"name": "generate_schema_name_for_env", "resource_type": "macro", "package_name": "dbt", "path": "macros/get_custom_name/get_custom_schema.sql", "original_file_path": "macros/get_custom_name/get_custom_schema.sql", "unique_id": "macro.dbt.generate_schema_name_for_env", "macro_sql": "{% macro generate_schema_name_for_env(custom_schema_name, node) -%}\n\n    {%- set default_schema = target.schema -%}\n    {%- if target.name == 'prod' and custom_schema_name is not none -%}\n\n        {{ custom_schema_name | trim }}\n\n    {%- else -%}\n\n        {{ default_schema }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.346077, "supported_languages": null}, "macro.dbt.generate_database_name": {"name": "generate_database_name", "resource_type": "macro", "package_name": "dbt", "path": "macros/get_custom_name/get_custom_database.sql", "original_file_path": "macros/get_custom_name/get_custom_database.sql", "unique_id": "macro.dbt.generate_database_name", "macro_sql": "{% macro generate_database_name(custom_database_name=none, node=none) -%}\n    {% do return(adapter.dispatch('generate_database_name', 'dbt')(custom_database_name, node)) %}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__generate_database_name"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.346299, "supported_languages": null}, "macro.dbt.default__generate_database_name": {"name": "default__generate_database_name", "resource_type": "macro", "package_name": "dbt", "path": "macros/get_custom_name/get_custom_database.sql", "original_file_path": "macros/get_custom_name/get_custom_database.sql", "unique_id": "macro.dbt.default__generate_database_name", "macro_sql": "{% macro default__generate_database_name(custom_database_name=none, node=none) -%}\n    {%- set default_database = target.database -%}\n    {%- if custom_database_name is none -%}\n\n        {{ default_database }}\n\n    {%- else -%}\n\n        {{ custom_database_name }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.346449, "supported_languages": null}, "macro.dbt.get_drop_sql": {"name": "get_drop_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/drop.sql", "original_file_path": "macros/relations/drop.sql", "unique_id": "macro.dbt.get_drop_sql", "macro_sql": "{%- macro get_drop_sql(relation) -%}\n    {{- log('Applying DROP to: ' ~ relation) -}}\n    {{- adapter.dispatch('get_drop_sql', 'dbt')(relation) -}}\n{%- endmacro -%}\n\n\n", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__get_drop_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.34675, "supported_languages": null}, "macro.dbt.default__get_drop_sql": {"name": "default__get_drop_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/drop.sql", "original_file_path": "macros/relations/drop.sql", "unique_id": "macro.dbt.default__get_drop_sql", "macro_sql": "{%- macro default__get_drop_sql(relation) -%}\n\n    {%- if relation.is_view -%}\n        {{ drop_view(relation) }}\n\n    {%- elif relation.is_table -%}\n        {{ drop_table(relation) }}\n\n    {%- elif relation.is_materialized_view -%}\n        {{ drop_materialized_view(relation) }}\n\n    {%- else -%}\n        drop {{ relation.type }} if exists {{ relation.render() }} cascade\n\n    {%- endif -%}\n\n{%- endmacro -%}\n\n\n", "depends_on": {"macros": ["macro.dbt.drop_view", "macro.dbt.drop_table", "macro.dbt.drop_materialized_view"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.346978, "supported_languages": null}, "macro.dbt.drop_relation": {"name": "drop_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/drop.sql", "original_file_path": "macros/relations/drop.sql", "unique_id": "macro.dbt.drop_relation", "macro_sql": "{% macro drop_relation(relation) -%}\n    {{ return(adapter.dispatch('drop_relation', 'dbt')(relation)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__drop_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3470879, "supported_languages": null}, "macro.dbt.default__drop_relation": {"name": "default__drop_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/drop.sql", "original_file_path": "macros/relations/drop.sql", "unique_id": "macro.dbt.default__drop_relation", "macro_sql": "{% macro default__drop_relation(relation) -%}\n    {% call statement('drop_relation', auto_begin=False) -%}\n        {{ get_drop_sql(relation) }}\n    {%- endcall %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt.get_drop_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3472059, "supported_languages": null}, "macro.dbt.drop_relation_if_exists": {"name": "drop_relation_if_exists", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/drop.sql", "original_file_path": "macros/relations/drop.sql", "unique_id": "macro.dbt.drop_relation_if_exists", "macro_sql": "{% macro drop_relation_if_exists(relation) %}\n  {% if relation is not none %}\n    {{ adapter.drop_relation(relation) }}\n  {% endif %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.347318, "supported_languages": null}, "macro.dbt.get_replace_sql": {"name": "get_replace_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/replace.sql", "original_file_path": "macros/relations/replace.sql", "unique_id": "macro.dbt.get_replace_sql", "macro_sql": "{% macro get_replace_sql(existing_relation, target_relation, sql) %}\n    {{- log('Applying REPLACE to: ' ~ existing_relation) -}}\n    {{- adapter.dispatch('get_replace_sql', 'dbt')(existing_relation, target_relation, sql) -}}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__get_replace_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.347648, "supported_languages": null}, "macro.dbt.default__get_replace_sql": {"name": "default__get_replace_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/replace.sql", "original_file_path": "macros/relations/replace.sql", "unique_id": "macro.dbt.default__get_replace_sql", "macro_sql": "{% macro default__get_replace_sql(existing_relation, target_relation, sql) %}\n\n    {# /* use a create or replace statement if possible */ #}\n\n    {% set is_replaceable = existing_relation.type == target_relation.type and existing_relation.can_be_replaced %}\n\n    {% if is_replaceable and existing_relation.is_view %}\n        {{ get_replace_view_sql(target_relation, sql) }}\n\n    {% elif is_replaceable and existing_relation.is_table %}\n        {{ get_replace_table_sql(target_relation, sql) }}\n\n    {% elif is_replaceable and existing_relation.is_materialized_view %}\n        {{ get_replace_materialized_view_sql(target_relation, sql) }}\n\n    {# /* a create or replace statement is not possible, so try to stage and/or backup to be safe */ #}\n\n    {# /* create target_relation as an intermediate relation, then swap it out with the existing one using a backup */ #}\n    {%- elif target_relation.can_be_renamed and existing_relation.can_be_renamed -%}\n        {{ get_create_intermediate_sql(target_relation, sql) }};\n        {{ get_create_backup_sql(existing_relation) }};\n        {{ get_rename_intermediate_sql(target_relation) }};\n        {{ get_drop_backup_sql(existing_relation) }}\n\n    {# /* create target_relation as an intermediate relation, then swap it out with the existing one without using a backup */ #}\n    {%- elif target_relation.can_be_renamed -%}\n        {{ get_create_intermediate_sql(target_relation, sql) }};\n        {{ get_drop_sql(existing_relation) }};\n        {{ get_rename_intermediate_sql(target_relation) }}\n\n    {# /* create target_relation in place by first backing up the existing relation */ #}\n    {%- elif existing_relation.can_be_renamed -%}\n        {{ get_create_backup_sql(existing_relation) }};\n        {{ get_create_sql(target_relation, sql) }};\n        {{ get_drop_backup_sql(existing_relation) }}\n\n    {# /* no renaming is allowed, so just drop and create */ #}\n    {%- else -%}\n        {{ get_drop_sql(existing_relation) }};\n        {{ get_create_sql(target_relation, sql) }}\n\n    {%- endif -%}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_replace_view_sql", "macro.dbt.get_replace_table_sql", "macro.dbt.get_replace_materialized_view_sql", "macro.dbt.get_create_intermediate_sql", "macro.dbt.get_create_backup_sql", "macro.dbt.get_rename_intermediate_sql", "macro.dbt.get_drop_backup_sql", "macro.dbt.get_drop_sql", "macro.dbt.get_create_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.348308, "supported_languages": null}, "macro.dbt.get_create_intermediate_sql": {"name": "get_create_intermediate_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/create_intermediate.sql", "original_file_path": "macros/relations/create_intermediate.sql", "unique_id": "macro.dbt.get_create_intermediate_sql", "macro_sql": "{%- macro get_create_intermediate_sql(relation, sql) -%}\n    {{- log('Applying CREATE INTERMEDIATE to: ' ~ relation) -}}\n    {{- adapter.dispatch('get_create_intermediate_sql', 'dbt')(relation, sql) -}}\n{%- endmacro -%}\n\n\n", "depends_on": {"macros": ["macro.dbt.default__get_create_intermediate_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3485088, "supported_languages": null}, "macro.dbt.default__get_create_intermediate_sql": {"name": "default__get_create_intermediate_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/create_intermediate.sql", "original_file_path": "macros/relations/create_intermediate.sql", "unique_id": "macro.dbt.default__get_create_intermediate_sql", "macro_sql": "{%- macro default__get_create_intermediate_sql(relation, sql) -%}\n\n    -- get the standard intermediate name\n    {% set intermediate_relation = make_intermediate_relation(relation) %}\n\n    -- drop any pre-existing intermediate\n    {{ get_drop_sql(intermediate_relation) }};\n\n    {{ get_create_sql(intermediate_relation, sql) }}\n\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt.make_intermediate_relation", "macro.dbt.get_drop_sql", "macro.dbt.get_create_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.348661, "supported_languages": null}, "macro.dbt.drop_schema_named": {"name": "drop_schema_named", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/schema.sql", "original_file_path": "macros/relations/schema.sql", "unique_id": "macro.dbt.drop_schema_named", "macro_sql": "{% macro drop_schema_named(schema_name) %}\n    {{ return(adapter.dispatch('drop_schema_named', 'dbt') (schema_name)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__drop_schema_named"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3488152, "supported_languages": null}, "macro.dbt.default__drop_schema_named": {"name": "default__drop_schema_named", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/schema.sql", "original_file_path": "macros/relations/schema.sql", "unique_id": "macro.dbt.default__drop_schema_named", "macro_sql": "{% macro default__drop_schema_named(schema_name) %}\n  {% set schema_relation = api.Relation.create(schema=schema_name) %}\n  {{ adapter.drop_schema(schema_relation) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3489401, "supported_languages": null}, "macro.dbt.get_drop_backup_sql": {"name": "get_drop_backup_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/drop_backup.sql", "original_file_path": "macros/relations/drop_backup.sql", "unique_id": "macro.dbt.get_drop_backup_sql", "macro_sql": "{%- macro get_drop_backup_sql(relation) -%}\n    {{- log('Applying DROP BACKUP to: ' ~ relation) -}}\n    {{- adapter.dispatch('get_drop_backup_sql', 'dbt')(relation) -}}\n{%- endmacro -%}\n\n\n", "depends_on": {"macros": ["macro.dbt.default__get_drop_backup_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3491142, "supported_languages": null}, "macro.dbt.default__get_drop_backup_sql": {"name": "default__get_drop_backup_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/drop_backup.sql", "original_file_path": "macros/relations/drop_backup.sql", "unique_id": "macro.dbt.default__get_drop_backup_sql", "macro_sql": "{%- macro default__get_drop_backup_sql(relation) -%}\n\n    -- get the standard backup name\n    {% set backup_relation = make_backup_relation(relation, relation.type) %}\n\n    {{ get_drop_sql(backup_relation) }}\n\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt.make_backup_relation", "macro.dbt.get_drop_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.349237, "supported_languages": null}, "macro.dbt.get_rename_sql": {"name": "get_rename_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/rename.sql", "original_file_path": "macros/relations/rename.sql", "unique_id": "macro.dbt.get_rename_sql", "macro_sql": "{%- macro get_rename_sql(relation, new_name) -%}\n    {{- log('Applying RENAME to: ' ~ relation) -}}\n    {{- adapter.dispatch('get_rename_sql', 'dbt')(relation, new_name) -}}\n{%- endmacro -%}\n\n\n", "depends_on": {"macros": ["macro.dbt.default__get_rename_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.349497, "supported_languages": null}, "macro.dbt.default__get_rename_sql": {"name": "default__get_rename_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/rename.sql", "original_file_path": "macros/relations/rename.sql", "unique_id": "macro.dbt.default__get_rename_sql", "macro_sql": "{%- macro default__get_rename_sql(relation, new_name) -%}\n\n    {%- if relation.is_view -%}\n        {{ get_rename_view_sql(relation, new_name) }}\n\n    {%- elif relation.is_table -%}\n        {{ get_rename_table_sql(relation, new_name) }}\n\n    {%- elif relation.is_materialized_view -%}\n        {{ get_rename_materialized_view_sql(relation, new_name) }}\n\n    {%- else -%}\n        {{- exceptions.raise_compiler_error(\"`get_rename_sql` has not been implemented for: \" ~ relation.type ) -}}\n\n    {%- endif -%}\n\n{%- endmacro -%}\n\n\n", "depends_on": {"macros": ["macro.dbt.get_rename_view_sql", "macro.dbt.get_rename_table_sql", "macro.dbt.get_rename_materialized_view_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.349747, "supported_languages": null}, "macro.dbt.rename_relation": {"name": "rename_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/rename.sql", "original_file_path": "macros/relations/rename.sql", "unique_id": "macro.dbt.rename_relation", "macro_sql": "{% macro rename_relation(from_relation, to_relation) -%}\n  {{ return(adapter.dispatch('rename_relation', 'dbt')(from_relation, to_relation)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__rename_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.350111, "supported_languages": null}, "macro.dbt.default__rename_relation": {"name": "default__rename_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/rename.sql", "original_file_path": "macros/relations/rename.sql", "unique_id": "macro.dbt.default__rename_relation", "macro_sql": "{% macro default__rename_relation(from_relation, to_relation) -%}\n  {% set target_name = adapter.quote_as_configured(to_relation.identifier, 'identifier') %}\n  {% call statement('rename_relation') -%}\n    alter table {{ from_relation.render() }} rename to {{ target_name }}\n  {%- endcall %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.350288, "supported_languages": null}, "macro.dbt.get_create_backup_sql": {"name": "get_create_backup_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/create_backup.sql", "original_file_path": "macros/relations/create_backup.sql", "unique_id": "macro.dbt.get_create_backup_sql", "macro_sql": "{%- macro get_create_backup_sql(relation) -%}\n    {{- log('Applying CREATE BACKUP to: ' ~ relation) -}}\n    {{- adapter.dispatch('get_create_backup_sql', 'dbt')(relation) -}}\n{%- endmacro -%}\n\n\n", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__get_create_backup_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.350467, "supported_languages": null}, "macro.dbt.default__get_create_backup_sql": {"name": "default__get_create_backup_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/create_backup.sql", "original_file_path": "macros/relations/create_backup.sql", "unique_id": "macro.dbt.default__get_create_backup_sql", "macro_sql": "{%- macro default__get_create_backup_sql(relation) -%}\n\n    -- get the standard backup name\n    {% set backup_relation = make_backup_relation(relation, relation.type) %}\n\n    -- drop any pre-existing backup\n    {{ get_drop_sql(backup_relation) }};\n\n    {{ get_rename_sql(relation, backup_relation.identifier) }}\n\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt.make_backup_relation", "macro.dbt.get_drop_sql", "macro.dbt.get_rename_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.350625, "supported_languages": null}, "macro.dbt.get_create_sql": {"name": "get_create_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/create.sql", "original_file_path": "macros/relations/create.sql", "unique_id": "macro.dbt.get_create_sql", "macro_sql": "{%- macro get_create_sql(relation, sql) -%}\n    {{- log('Applying CREATE to: ' ~ relation) -}}\n    {{- adapter.dispatch('get_create_sql', 'dbt')(relation, sql) -}}\n{%- endmacro -%}\n\n\n", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__get_create_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3508391, "supported_languages": null}, "macro.dbt.default__get_create_sql": {"name": "default__get_create_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/create.sql", "original_file_path": "macros/relations/create.sql", "unique_id": "macro.dbt.default__get_create_sql", "macro_sql": "{%- macro default__get_create_sql(relation, sql) -%}\n\n    {%- if relation.is_view -%}\n        {{ get_create_view_as_sql(relation, sql) }}\n\n    {%- elif relation.is_table -%}\n        {{ get_create_table_as_sql(False, relation, sql) }}\n\n    {%- elif relation.is_materialized_view -%}\n        {{ get_create_materialized_view_as_sql(relation, sql) }}\n\n    {%- else -%}\n        {{- exceptions.raise_compiler_error(\"`get_create_sql` has not been implemented for: \" ~ relation.type ) -}}\n\n    {%- endif -%}\n\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt.get_create_view_as_sql", "macro.dbt.get_create_table_as_sql", "macro.dbt.get_create_materialized_view_as_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.351091, "supported_languages": null}, "macro.dbt.get_rename_intermediate_sql": {"name": "get_rename_intermediate_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/rename_intermediate.sql", "original_file_path": "macros/relations/rename_intermediate.sql", "unique_id": "macro.dbt.get_rename_intermediate_sql", "macro_sql": "{%- macro get_rename_intermediate_sql(relation) -%}\n    {{- log('Applying RENAME INTERMEDIATE to: ' ~ relation) -}}\n    {{- adapter.dispatch('get_rename_intermediate_sql', 'dbt')(relation) -}}\n{%- endmacro -%}\n\n\n", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__get_rename_intermediate_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3512661, "supported_languages": null}, "macro.dbt.default__get_rename_intermediate_sql": {"name": "default__get_rename_intermediate_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/rename_intermediate.sql", "original_file_path": "macros/relations/rename_intermediate.sql", "unique_id": "macro.dbt.default__get_rename_intermediate_sql", "macro_sql": "{%- macro default__get_rename_intermediate_sql(relation) -%}\n\n    -- get the standard intermediate name\n    {% set intermediate_relation = make_intermediate_relation(relation) %}\n\n    {{ get_rename_sql(intermediate_relation, relation.identifier) }}\n\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt.make_intermediate_relation", "macro.dbt.get_rename_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.351386, "supported_languages": null}, "macro.dbt.drop_materialized_view": {"name": "drop_materialized_view", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/materialized_view/drop.sql", "original_file_path": "macros/relations/materialized_view/drop.sql", "unique_id": "macro.dbt.drop_materialized_view", "macro_sql": "{% macro drop_materialized_view(relation) -%}\n    {{- adapter.dispatch('drop_materialized_view', 'dbt')(relation) -}}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__drop_materialized_view"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.351527, "supported_languages": null}, "macro.dbt.default__drop_materialized_view": {"name": "default__drop_materialized_view", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/materialized_view/drop.sql", "original_file_path": "macros/relations/materialized_view/drop.sql", "unique_id": "macro.dbt.default__drop_materialized_view", "macro_sql": "{% macro default__drop_materialized_view(relation) -%}\n    drop materialized view if exists {{ relation.render() }} cascade\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3516002, "supported_languages": null}, "macro.dbt.get_replace_materialized_view_sql": {"name": "get_replace_materialized_view_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/materialized_view/replace.sql", "original_file_path": "macros/relations/materialized_view/replace.sql", "unique_id": "macro.dbt.get_replace_materialized_view_sql", "macro_sql": "{% macro get_replace_materialized_view_sql(relation, sql) %}\n    {{- adapter.dispatch('get_replace_materialized_view_sql', 'dbt')(relation, sql) -}}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_replace_materialized_view_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.351753, "supported_languages": null}, "macro.dbt.default__get_replace_materialized_view_sql": {"name": "default__get_replace_materialized_view_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/materialized_view/replace.sql", "original_file_path": "macros/relations/materialized_view/replace.sql", "unique_id": "macro.dbt.default__get_replace_materialized_view_sql", "macro_sql": "{% macro default__get_replace_materialized_view_sql(relation, sql) %}\n    {{ exceptions.raise_compiler_error(\n        \"`get_replace_materialized_view_sql` has not been implemented for this adapter.\"\n    ) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.351841, "supported_languages": null}, "macro.dbt.refresh_materialized_view": {"name": "refresh_materialized_view", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/materialized_view/refresh.sql", "original_file_path": "macros/relations/materialized_view/refresh.sql", "unique_id": "macro.dbt.refresh_materialized_view", "macro_sql": "{% macro refresh_materialized_view(relation) %}\n    {{- log('Applying REFRESH to: ' ~ relation) -}}\n    {{- adapter.dispatch('refresh_materialized_view', 'dbt')(relation) -}}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__refresh_materialized_view"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.352013, "supported_languages": null}, "macro.dbt.default__refresh_materialized_view": {"name": "default__refresh_materialized_view", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/materialized_view/refresh.sql", "original_file_path": "macros/relations/materialized_view/refresh.sql", "unique_id": "macro.dbt.default__refresh_materialized_view", "macro_sql": "{% macro default__refresh_materialized_view(relation) %}\n    {{ exceptions.raise_compiler_error(\"`refresh_materialized_view` has not been implemented for this adapter.\") }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.352096, "supported_languages": null}, "macro.dbt.get_rename_materialized_view_sql": {"name": "get_rename_materialized_view_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/materialized_view/rename.sql", "original_file_path": "macros/relations/materialized_view/rename.sql", "unique_id": "macro.dbt.get_rename_materialized_view_sql", "macro_sql": "{% macro get_rename_materialized_view_sql(relation, new_name) %}\n    {{- adapter.dispatch('get_rename_materialized_view_sql', 'dbt')(relation, new_name) -}}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_rename_materialized_view_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.352247, "supported_languages": null}, "macro.dbt.default__get_rename_materialized_view_sql": {"name": "default__get_rename_materialized_view_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/materialized_view/rename.sql", "original_file_path": "macros/relations/materialized_view/rename.sql", "unique_id": "macro.dbt.default__get_rename_materialized_view_sql", "macro_sql": "{% macro default__get_rename_materialized_view_sql(relation, new_name) %}\n    {{ exceptions.raise_compiler_error(\n        \"`get_rename_materialized_view_sql` has not been implemented for this adapter.\"\n    ) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.352334, "supported_languages": null}, "macro.dbt.get_alter_materialized_view_as_sql": {"name": "get_alter_materialized_view_as_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/materialized_view/alter.sql", "original_file_path": "macros/relations/materialized_view/alter.sql", "unique_id": "macro.dbt.get_alter_materialized_view_as_sql", "macro_sql": "{% macro get_alter_materialized_view_as_sql(\n    relation,\n    configuration_changes,\n    sql,\n    existing_relation,\n    backup_relation,\n    intermediate_relation\n) %}\n    {{- log('Applying ALTER to: ' ~ relation) -}}\n    {{- adapter.dispatch('get_alter_materialized_view_as_sql', 'dbt')(\n        relation,\n        configuration_changes,\n        sql,\n        existing_relation,\n        backup_relation,\n        intermediate_relation\n    ) -}}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_alter_materialized_view_as_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3526452, "supported_languages": null}, "macro.dbt.default__get_alter_materialized_view_as_sql": {"name": "default__get_alter_materialized_view_as_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/materialized_view/alter.sql", "original_file_path": "macros/relations/materialized_view/alter.sql", "unique_id": "macro.dbt.default__get_alter_materialized_view_as_sql", "macro_sql": "{% macro default__get_alter_materialized_view_as_sql(\n    relation,\n    configuration_changes,\n    sql,\n    existing_relation,\n    backup_relation,\n    intermediate_relation\n) %}\n    {{ exceptions.raise_compiler_error(\"Materialized views have not been implemented for this adapter.\") }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3527539, "supported_languages": null}, "macro.dbt.get_materialized_view_configuration_changes": {"name": "get_materialized_view_configuration_changes", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/materialized_view/alter.sql", "original_file_path": "macros/relations/materialized_view/alter.sql", "unique_id": "macro.dbt.get_materialized_view_configuration_changes", "macro_sql": "{% macro get_materialized_view_configuration_changes(existing_relation, new_config) %}\n    /* {#\n    It's recommended that configuration changes be formatted as follows:\n    {\"<change_category>\": [{\"action\": \"<name>\", \"context\": ...}]}\n\n    For example:\n    {\n        \"indexes\": [\n            {\"action\": \"drop\", \"context\": \"index_abc\"},\n            {\"action\": \"create\", \"context\": {\"columns\": [\"column_1\", \"column_2\"], \"type\": \"hash\", \"unique\": True}},\n        ],\n    }\n\n    Either way, `get_materialized_view_configuration_changes` needs to align with `get_alter_materialized_view_as_sql`.\n    #} */\n    {{- log('Determining configuration changes on: ' ~ existing_relation) -}}\n    {%- do return(adapter.dispatch('get_materialized_view_configuration_changes', 'dbt')(existing_relation, new_config)) -%}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_materialized_view_configuration_changes"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.352999, "supported_languages": null}, "macro.dbt.default__get_materialized_view_configuration_changes": {"name": "default__get_materialized_view_configuration_changes", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/materialized_view/alter.sql", "original_file_path": "macros/relations/materialized_view/alter.sql", "unique_id": "macro.dbt.default__get_materialized_view_configuration_changes", "macro_sql": "{% macro default__get_materialized_view_configuration_changes(existing_relation, new_config) %}\n    {{ exceptions.raise_compiler_error(\"Materialized views have not been implemented for this adapter.\") }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3531232, "supported_languages": null}, "macro.dbt.get_create_materialized_view_as_sql": {"name": "get_create_materialized_view_as_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/materialized_view/create.sql", "original_file_path": "macros/relations/materialized_view/create.sql", "unique_id": "macro.dbt.get_create_materialized_view_as_sql", "macro_sql": "{% macro get_create_materialized_view_as_sql(relation, sql) -%}\n    {{- adapter.dispatch('get_create_materialized_view_as_sql', 'dbt')(relation, sql) -}}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_create_materialized_view_as_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3533068, "supported_languages": null}, "macro.dbt.default__get_create_materialized_view_as_sql": {"name": "default__get_create_materialized_view_as_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/materialized_view/create.sql", "original_file_path": "macros/relations/materialized_view/create.sql", "unique_id": "macro.dbt.default__get_create_materialized_view_as_sql", "macro_sql": "{% macro default__get_create_materialized_view_as_sql(relation, sql) -%}\n    {{ exceptions.raise_compiler_error(\n        \"`get_create_materialized_view_as_sql` has not been implemented for this adapter.\"\n    ) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3534021, "supported_languages": null}, "macro.dbt.get_table_columns_and_constraints": {"name": "get_table_columns_and_constraints", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/column/columns_spec_ddl.sql", "original_file_path": "macros/relations/column/columns_spec_ddl.sql", "unique_id": "macro.dbt.get_table_columns_and_constraints", "macro_sql": "{%- macro get_table_columns_and_constraints() -%}\n  {{ adapter.dispatch('get_table_columns_and_constraints', 'dbt')() }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__get_table_columns_and_constraints"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.353836, "supported_languages": null}, "macro.dbt.default__get_table_columns_and_constraints": {"name": "default__get_table_columns_and_constraints", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/column/columns_spec_ddl.sql", "original_file_path": "macros/relations/column/columns_spec_ddl.sql", "unique_id": "macro.dbt.default__get_table_columns_and_constraints", "macro_sql": "{% macro default__get_table_columns_and_constraints() -%}\n  {{ return(table_columns_and_constraints()) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.table_columns_and_constraints"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.353911, "supported_languages": null}, "macro.dbt.table_columns_and_constraints": {"name": "table_columns_and_constraints", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/column/columns_spec_ddl.sql", "original_file_path": "macros/relations/column/columns_spec_ddl.sql", "unique_id": "macro.dbt.table_columns_and_constraints", "macro_sql": "{% macro table_columns_and_constraints() %}\n  {# loop through user_provided_columns to create DDL with data types and constraints #}\n    {%- set raw_column_constraints = adapter.render_raw_columns_constraints(raw_columns=model['columns']) -%}\n    {%- set raw_model_constraints = adapter.render_raw_model_constraints(raw_constraints=model['constraints']) -%}\n    (\n    {% for c in raw_column_constraints -%}\n      {{ c }}{{ \",\" if not loop.last or raw_model_constraints }}\n    {% endfor %}\n    {% for c in raw_model_constraints -%}\n        {{ c }}{{ \",\" if not loop.last }}\n    {% endfor -%}\n    )\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.354229, "supported_languages": null}, "macro.dbt.get_assert_columns_equivalent": {"name": "get_assert_columns_equivalent", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/column/columns_spec_ddl.sql", "original_file_path": "macros/relations/column/columns_spec_ddl.sql", "unique_id": "macro.dbt.get_assert_columns_equivalent", "macro_sql": "\n\n{%- macro get_assert_columns_equivalent(sql) -%}\n  {{ adapter.dispatch('get_assert_columns_equivalent', 'dbt')(sql) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__get_assert_columns_equivalent"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.354337, "supported_languages": null}, "macro.dbt.default__get_assert_columns_equivalent": {"name": "default__get_assert_columns_equivalent", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/column/columns_spec_ddl.sql", "original_file_path": "macros/relations/column/columns_spec_ddl.sql", "unique_id": "macro.dbt.default__get_assert_columns_equivalent", "macro_sql": "{% macro default__get_assert_columns_equivalent(sql) -%}\n  {{ return(assert_columns_equivalent(sql)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.assert_columns_equivalent"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.354419, "supported_languages": null}, "macro.dbt.assert_columns_equivalent": {"name": "assert_columns_equivalent", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/column/columns_spec_ddl.sql", "original_file_path": "macros/relations/column/columns_spec_ddl.sql", "unique_id": "macro.dbt.assert_columns_equivalent", "macro_sql": "{% macro assert_columns_equivalent(sql) %}\n\n  {#-- First ensure the user has defined 'columns' in yaml specification --#}\n  {%- set user_defined_columns = model['columns'] -%}\n  {%- if not user_defined_columns -%}\n      {{ exceptions.raise_contract_error([], []) }}\n  {%- endif -%}\n\n  {#-- Obtain the column schema provided by sql file. #}\n  {%- set sql_file_provided_columns = get_column_schema_from_query(sql, config.get('sql_header', none)) -%}\n  {#--Obtain the column schema provided by the schema file by generating an 'empty schema' query from the model's columns. #}\n  {%- set schema_file_provided_columns = get_column_schema_from_query(get_empty_schema_sql(user_defined_columns)) -%}\n\n  {#-- create dictionaries with name and formatted data type and strings for exception #}\n  {%- set sql_columns = format_columns(sql_file_provided_columns) -%}\n  {%- set yaml_columns = format_columns(schema_file_provided_columns)  -%}\n\n  {%- if sql_columns|length != yaml_columns|length -%}\n    {%- do exceptions.raise_contract_error(yaml_columns, sql_columns) -%}\n  {%- endif -%}\n\n  {%- for sql_col in sql_columns -%}\n    {%- set yaml_col = [] -%}\n    {%- for this_col in yaml_columns -%}\n      {%- if this_col['name'] == sql_col['name'] -%}\n        {%- do yaml_col.append(this_col) -%}\n        {%- break -%}\n      {%- endif -%}\n    {%- endfor -%}\n    {%- if not yaml_col -%}\n      {#-- Column with name not found in yaml #}\n      {%- do exceptions.raise_contract_error(yaml_columns, sql_columns) -%}\n    {%- endif -%}\n    {%- if sql_col['formatted'] != yaml_col[0]['formatted'] -%}\n      {#-- Column data types don't match #}\n      {%- do exceptions.raise_contract_error(yaml_columns, sql_columns) -%}\n    {%- endif -%}\n  {%- endfor -%}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_column_schema_from_query", "macro.dbt.get_empty_schema_sql", "macro.dbt.format_columns"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.355207, "supported_languages": null}, "macro.dbt.format_columns": {"name": "format_columns", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/column/columns_spec_ddl.sql", "original_file_path": "macros/relations/column/columns_spec_ddl.sql", "unique_id": "macro.dbt.format_columns", "macro_sql": "{% macro format_columns(columns) %}\n  {% set formatted_columns = [] %}\n  {% for column in columns %}\n    {%- set formatted_column = adapter.dispatch('format_column', 'dbt')(column) -%}\n    {%- do formatted_columns.append(formatted_column) -%}\n  {% endfor %}\n  {{ return(formatted_columns) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__format_column"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.355456, "supported_languages": null}, "macro.dbt.default__format_column": {"name": "default__format_column", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/column/columns_spec_ddl.sql", "original_file_path": "macros/relations/column/columns_spec_ddl.sql", "unique_id": "macro.dbt.default__format_column", "macro_sql": "{% macro default__format_column(column) -%}\n  {% set data_type = column.dtype %}\n  {% set formatted = column.column.lower() ~ \" \" ~ data_type %}\n  {{ return({'name': column.name, 'data_type': data_type, 'formatted': formatted}) }}\n{%- endmacro -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.355659, "supported_languages": null}, "macro.dbt.drop_table": {"name": "drop_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/table/drop.sql", "original_file_path": "macros/relations/table/drop.sql", "unique_id": "macro.dbt.drop_table", "macro_sql": "{% macro drop_table(relation) -%}\n    {{- adapter.dispatch('drop_table', 'dbt')(relation) -}}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__drop_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.355807, "supported_languages": null}, "macro.dbt.default__drop_table": {"name": "default__drop_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/table/drop.sql", "original_file_path": "macros/relations/table/drop.sql", "unique_id": "macro.dbt.default__drop_table", "macro_sql": "{% macro default__drop_table(relation) -%}\n    drop table if exists {{ relation.render() }} cascade\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.355881, "supported_languages": null}, "macro.dbt.get_replace_table_sql": {"name": "get_replace_table_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/table/replace.sql", "original_file_path": "macros/relations/table/replace.sql", "unique_id": "macro.dbt.get_replace_table_sql", "macro_sql": "{% macro get_replace_table_sql(relation, sql) %}\n    {{- adapter.dispatch('get_replace_table_sql', 'dbt')(relation, sql) -}}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__get_replace_table_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3560362, "supported_languages": null}, "macro.dbt.default__get_replace_table_sql": {"name": "default__get_replace_table_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/table/replace.sql", "original_file_path": "macros/relations/table/replace.sql", "unique_id": "macro.dbt.default__get_replace_table_sql", "macro_sql": "{% macro default__get_replace_table_sql(relation, sql) %}\n    {{ exceptions.raise_compiler_error(\n        \"`get_replace_table_sql` has not been implemented for this adapter.\"\n    ) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.356123, "supported_languages": null}, "macro.dbt.get_rename_table_sql": {"name": "get_rename_table_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/table/rename.sql", "original_file_path": "macros/relations/table/rename.sql", "unique_id": "macro.dbt.get_rename_table_sql", "macro_sql": "{% macro get_rename_table_sql(relation, new_name) %}\n    {{- adapter.dispatch('get_rename_table_sql', 'dbt')(relation, new_name) -}}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__get_rename_table_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.356307, "supported_languages": null}, "macro.dbt.default__get_rename_table_sql": {"name": "default__get_rename_table_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/table/rename.sql", "original_file_path": "macros/relations/table/rename.sql", "unique_id": "macro.dbt.default__get_rename_table_sql", "macro_sql": "{% macro default__get_rename_table_sql(relation, new_name) %}\n    {{ exceptions.raise_compiler_error(\n        \"`get_rename_table_sql` has not been implemented for this adapter.\"\n    ) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.356408, "supported_languages": null}, "macro.dbt.get_create_table_as_sql": {"name": "get_create_table_as_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/table/create.sql", "original_file_path": "macros/relations/table/create.sql", "unique_id": "macro.dbt.get_create_table_as_sql", "macro_sql": "{% macro get_create_table_as_sql(temporary, relation, sql) -%}\n  {{ adapter.dispatch('get_create_table_as_sql', 'dbt')(temporary, relation, sql) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_create_table_as_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.356768, "supported_languages": null}, "macro.dbt.default__get_create_table_as_sql": {"name": "default__get_create_table_as_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/table/create.sql", "original_file_path": "macros/relations/table/create.sql", "unique_id": "macro.dbt.default__get_create_table_as_sql", "macro_sql": "{% macro default__get_create_table_as_sql(temporary, relation, sql) -%}\n  {{ return(create_table_as(temporary, relation, sql)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.create_table_as"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.356879, "supported_languages": null}, "macro.dbt.create_table_as": {"name": "create_table_as", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/table/create.sql", "original_file_path": "macros/relations/table/create.sql", "unique_id": "macro.dbt.create_table_as", "macro_sql": "{% macro create_table_as(temporary, relation, compiled_code, language='sql') -%}\n  {# backward compatibility for create_table_as that does not support language #}\n  {% if language == \"sql\" %}\n    {{ adapter.dispatch('create_table_as', 'dbt')(temporary, relation, compiled_code)}}\n  {% else %}\n    {{ adapter.dispatch('create_table_as', 'dbt')(temporary, relation, compiled_code, language) }}\n  {% endif %}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__create_table_as"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.357125, "supported_languages": null}, "macro.dbt.default__create_table_as": {"name": "default__create_table_as", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/table/create.sql", "original_file_path": "macros/relations/table/create.sql", "unique_id": "macro.dbt.default__create_table_as", "macro_sql": "{% macro default__create_table_as(temporary, relation, sql) -%}\n  {%- set sql_header = config.get('sql_header', none) -%}\n\n  {{ sql_header if sql_header is not none }}\n\n  create {% if temporary: -%}temporary{%- endif %} table\n    {{ relation.include(database=(not temporary), schema=(not temporary)) }}\n  {% set contract_config = config.get('contract') %}\n  {% if contract_config.enforced and (not temporary) %}\n    {{ get_assert_columns_equivalent(sql) }}\n    {{ get_table_columns_and_constraints() }}\n    {%- set sql = get_select_subquery(sql) %}\n  {% endif %}\n  as (\n    {{ sql }}\n  );\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.get_assert_columns_equivalent", "macro.dbt.get_table_columns_and_constraints", "macro.dbt.get_select_subquery"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3575199, "supported_languages": null}, "macro.dbt.default__get_column_names": {"name": "default__get_column_names", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/table/create.sql", "original_file_path": "macros/relations/table/create.sql", "unique_id": "macro.dbt.default__get_column_names", "macro_sql": "{% macro default__get_column_names() %}\n  {#- loop through user_provided_columns to get column names -#}\n    {%- set user_provided_columns = model['columns'] -%}\n    {%- for i in user_provided_columns %}\n      {%- set col = user_provided_columns[i] -%}\n      {%- set col_name = adapter.quote(col['name']) if col.get('quote') else col['name'] -%}\n      {{ col_name }}{{ \", \" if not loop.last }}\n    {%- endfor -%}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.357791, "supported_languages": null}, "macro.dbt.get_select_subquery": {"name": "get_select_subquery", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/table/create.sql", "original_file_path": "macros/relations/table/create.sql", "unique_id": "macro.dbt.get_select_subquery", "macro_sql": "{% macro get_select_subquery(sql) %}\n  {{ return(adapter.dispatch('get_select_subquery', 'dbt')(sql)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_select_subquery"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.357902, "supported_languages": null}, "macro.dbt.default__get_select_subquery": {"name": "default__get_select_subquery", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/table/create.sql", "original_file_path": "macros/relations/table/create.sql", "unique_id": "macro.dbt.default__get_select_subquery", "macro_sql": "{% macro default__get_select_subquery(sql) %}\n    select {{ adapter.dispatch('get_column_names', 'dbt')() }}\n    from (\n        {{ sql }}\n    ) as model_subq\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_column_names"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.358006, "supported_languages": null}, "macro.dbt.drop_view": {"name": "drop_view", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/view/drop.sql", "original_file_path": "macros/relations/view/drop.sql", "unique_id": "macro.dbt.drop_view", "macro_sql": "{% macro drop_view(relation) -%}\n    {{- adapter.dispatch('drop_view', 'dbt')(relation) -}}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__drop_view"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.358154, "supported_languages": null}, "macro.dbt.default__drop_view": {"name": "default__drop_view", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/view/drop.sql", "original_file_path": "macros/relations/view/drop.sql", "unique_id": "macro.dbt.default__drop_view", "macro_sql": "{% macro default__drop_view(relation) -%}\n    drop view if exists {{ relation.render() }} cascade\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.358229, "supported_languages": null}, "macro.dbt.get_replace_view_sql": {"name": "get_replace_view_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/view/replace.sql", "original_file_path": "macros/relations/view/replace.sql", "unique_id": "macro.dbt.get_replace_view_sql", "macro_sql": "{% macro get_replace_view_sql(relation, sql) %}\n    {{- adapter.dispatch('get_replace_view_sql', 'dbt')(relation, sql) -}}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__get_replace_view_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.358526, "supported_languages": null}, "macro.dbt.default__get_replace_view_sql": {"name": "default__get_replace_view_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/view/replace.sql", "original_file_path": "macros/relations/view/replace.sql", "unique_id": "macro.dbt.default__get_replace_view_sql", "macro_sql": "{% macro default__get_replace_view_sql(relation, sql) %}\n    {{ exceptions.raise_compiler_error(\n        \"`get_replace_view_sql` has not been implemented for this adapter.\"\n    ) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.358621, "supported_languages": null}, "macro.dbt.create_or_replace_view": {"name": "create_or_replace_view", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/view/replace.sql", "original_file_path": "macros/relations/view/replace.sql", "unique_id": "macro.dbt.create_or_replace_view", "macro_sql": "{% macro create_or_replace_view() %}\n  {%- set identifier = model['alias'] -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n  {%- set exists_as_view = (old_relation is not none and old_relation.is_view) -%}\n\n  {%- set target_relation = api.Relation.create(\n      identifier=identifier, schema=schema, database=database,\n      type='view') -%}\n  {% set grant_config = config.get('grants') %}\n\n  {{ run_hooks(pre_hooks) }}\n\n  -- If there's a table with the same name and we weren't told to full refresh,\n  -- that's an error. If we were told to full refresh, drop it. This behavior differs\n  -- for Snowflake and BigQuery, so multiple dispatch is used.\n  {%- if old_relation is not none and old_relation.is_table -%}\n    {{ handle_existing_table(should_full_refresh(), old_relation) }}\n  {%- endif -%}\n\n  -- build model\n  {% call statement('main') -%}\n    {{ get_create_view_as_sql(target_relation, sql) }}\n  {%- endcall %}\n\n  {% set should_revoke = should_revoke(exists_as_view, full_refresh_mode=True) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n  {{ run_hooks(post_hooks) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.handle_existing_table", "macro.dbt.should_full_refresh", "macro.dbt.statement", "macro.dbt.get_create_view_as_sql", "macro.dbt.should_revoke", "macro.dbt.apply_grants"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.359243, "supported_languages": null}, "macro.dbt.handle_existing_table": {"name": "handle_existing_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/view/replace.sql", "original_file_path": "macros/relations/view/replace.sql", "unique_id": "macro.dbt.handle_existing_table", "macro_sql": "{% macro handle_existing_table(full_refresh, old_relation) %}\n    {{ adapter.dispatch('handle_existing_table', 'dbt')(full_refresh, old_relation) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__handle_existing_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.35936, "supported_languages": null}, "macro.dbt.default__handle_existing_table": {"name": "default__handle_existing_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/view/replace.sql", "original_file_path": "macros/relations/view/replace.sql", "unique_id": "macro.dbt.default__handle_existing_table", "macro_sql": "{% macro default__handle_existing_table(full_refresh, old_relation) %}\n    {{ log(\"Dropping relation \" ~ old_relation.render() ~ \" because it is of type \" ~ old_relation.type) }}\n    {{ adapter.drop_relation(old_relation) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.359497, "supported_languages": null}, "macro.dbt.get_rename_view_sql": {"name": "get_rename_view_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/view/rename.sql", "original_file_path": "macros/relations/view/rename.sql", "unique_id": "macro.dbt.get_rename_view_sql", "macro_sql": "{% macro get_rename_view_sql(relation, new_name) %}\n    {{- adapter.dispatch('get_rename_view_sql', 'dbt')(relation, new_name) -}}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__get_rename_view_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3596532, "supported_languages": null}, "macro.dbt.default__get_rename_view_sql": {"name": "default__get_rename_view_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/view/rename.sql", "original_file_path": "macros/relations/view/rename.sql", "unique_id": "macro.dbt.default__get_rename_view_sql", "macro_sql": "{% macro default__get_rename_view_sql(relation, new_name) %}\n    {{ exceptions.raise_compiler_error(\n        \"`get_rename_view_sql` has not been implemented for this adapter.\"\n    ) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.359741, "supported_languages": null}, "macro.dbt.get_create_view_as_sql": {"name": "get_create_view_as_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/view/create.sql", "original_file_path": "macros/relations/view/create.sql", "unique_id": "macro.dbt.get_create_view_as_sql", "macro_sql": "{% macro get_create_view_as_sql(relation, sql) -%}\n  {{ adapter.dispatch('get_create_view_as_sql', 'dbt')(relation, sql) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_create_view_as_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.359949, "supported_languages": null}, "macro.dbt.default__get_create_view_as_sql": {"name": "default__get_create_view_as_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/view/create.sql", "original_file_path": "macros/relations/view/create.sql", "unique_id": "macro.dbt.default__get_create_view_as_sql", "macro_sql": "{% macro default__get_create_view_as_sql(relation, sql) -%}\n  {{ return(create_view_as(relation, sql)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.create_view_as"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.360047, "supported_languages": null}, "macro.dbt.create_view_as": {"name": "create_view_as", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/view/create.sql", "original_file_path": "macros/relations/view/create.sql", "unique_id": "macro.dbt.create_view_as", "macro_sql": "{% macro create_view_as(relation, sql) -%}\n  {{ adapter.dispatch('create_view_as', 'dbt')(relation, sql) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__create_view_as"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.360152, "supported_languages": null}, "macro.dbt.default__create_view_as": {"name": "default__create_view_as", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/view/create.sql", "original_file_path": "macros/relations/view/create.sql", "unique_id": "macro.dbt.default__create_view_as", "macro_sql": "{% macro default__create_view_as(relation, sql) -%}\n  {%- set sql_header = config.get('sql_header', none) -%}\n\n  {{ sql_header if sql_header is not none }}\n  create view {{ relation.render() }}\n    {% set contract_config = config.get('contract') %}\n    {% if contract_config.enforced %}\n      {{ get_assert_columns_equivalent(sql) }}\n    {%- endif %}\n  as (\n    {{ sql }}\n  );\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.get_assert_columns_equivalent"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.360401, "supported_languages": null}, "macro.dbt.default__test_relationships": {"name": "default__test_relationships", "resource_type": "macro", "package_name": "dbt", "path": "macros/generic_test_sql/relationships.sql", "original_file_path": "macros/generic_test_sql/relationships.sql", "unique_id": "macro.dbt.default__test_relationships", "macro_sql": "{% macro default__test_relationships(model, column_name, to, field) %}\n\nwith child as (\n    select {{ column_name }} as from_field\n    from {{ model }}\n    where {{ column_name }} is not null\n),\n\nparent as (\n    select {{ field }} as to_field\n    from {{ to }}\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.360579, "supported_languages": null}, "macro.dbt.default__test_not_null": {"name": "default__test_not_null", "resource_type": "macro", "package_name": "dbt", "path": "macros/generic_test_sql/not_null.sql", "original_file_path": "macros/generic_test_sql/not_null.sql", "unique_id": "macro.dbt.default__test_not_null", "macro_sql": "{% macro default__test_not_null(model, column_name) %}\n\n{% set column_list = '*' if should_store_failures() else column_name %}\n\nselect {{ column_list }}\nfrom {{ model }}\nwhere {{ column_name }} is null\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.should_store_failures"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.360752, "supported_languages": null}, "macro.dbt.default__test_unique": {"name": "default__test_unique", "resource_type": "macro", "package_name": "dbt", "path": "macros/generic_test_sql/unique.sql", "original_file_path": "macros/generic_test_sql/unique.sql", "unique_id": "macro.dbt.default__test_unique", "macro_sql": "{% macro default__test_unique(model, column_name) %}\n\nselect\n    {{ column_name }} as unique_field,\n    count(*) as n_records\n\nfrom {{ model }}\nwhere {{ column_name }} is not null\ngroup by {{ column_name }}\nhaving count(*) > 1\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3608892, "supported_languages": null}, "macro.dbt.default__test_accepted_values": {"name": "default__test_accepted_values", "resource_type": "macro", "package_name": "dbt", "path": "macros/generic_test_sql/accepted_values.sql", "original_file_path": "macros/generic_test_sql/accepted_values.sql", "unique_id": "macro.dbt.default__test_accepted_values", "macro_sql": "{% macro default__test_accepted_values(model, column_name, values, quote=True) %}\n\nwith all_values as (\n\n    select\n        {{ column_name }} as value_field,\n        count(*) as n_records\n\n    from {{ model }}\n    group by {{ column_name }}\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    {% for value in values -%}\n        {% if quote -%}\n        '{{ value }}'\n        {%- else -%}\n        {{ value }}\n        {%- endif -%}\n        {%- if not loop.last -%},{%- endif %}\n    {%- endfor %}\n)\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.361182, "supported_languages": null}, "macro.dbt.statement": {"name": "statement", "resource_type": "macro", "package_name": "dbt", "path": "macros/etc/statement.sql", "original_file_path": "macros/etc/statement.sql", "unique_id": "macro.dbt.statement", "macro_sql": "\n{%- macro statement(name=None, fetch_result=False, auto_begin=True, language='sql') -%}\n  {%- if execute: -%}\n    {%- set compiled_code = caller() -%}\n\n    {%- if name == 'main' -%}\n      {{ log('Writing runtime {} for node \"{}\"'.format(language, model['unique_id'])) }}\n      {{ write(compiled_code) }}\n    {%- endif -%}\n    {%- if language == 'sql'-%}\n      {%- set res, table = adapter.execute(compiled_code, auto_begin=auto_begin, fetch=fetch_result) -%}\n    {%- elif language == 'python' -%}\n      {%- set res = submit_python_job(model, compiled_code) -%}\n      {#-- TODO: What should table be for python models? --#}\n      {%- set table = None -%}\n    {%- else -%}\n      {% do exceptions.raise_compiler_error(\"statement macro didn't get supported language\") %}\n    {%- endif -%}\n\n    {%- if name is not none -%}\n      {{ store_result(name, response=res, agate_table=table) }}\n    {%- endif -%}\n\n  {%- endif -%}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.361892, "supported_languages": null}, "macro.dbt.noop_statement": {"name": "noop_statement", "resource_type": "macro", "package_name": "dbt", "path": "macros/etc/statement.sql", "original_file_path": "macros/etc/statement.sql", "unique_id": "macro.dbt.noop_statement", "macro_sql": "{% macro noop_statement(name=None, message=None, code=None, rows_affected=None, res=None) -%}\n  {%- set sql = caller() -%}\n\n  {%- if name == 'main' -%}\n    {{ log('Writing runtime SQL for node \"{}\"'.format(model['unique_id'])) }}\n    {{ write(sql) }}\n  {%- endif -%}\n\n  {%- if name is not none -%}\n    {{ store_raw_result(name, message=message, code=code, rows_affected=rows_affected, agate_table=res) }}\n  {%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3622131, "supported_languages": null}, "macro.dbt.run_query": {"name": "run_query", "resource_type": "macro", "package_name": "dbt", "path": "macros/etc/statement.sql", "original_file_path": "macros/etc/statement.sql", "unique_id": "macro.dbt.run_query", "macro_sql": "{% macro run_query(sql) %}\n  {% call statement(\"run_query_statement\", fetch_result=true, auto_begin=false) %}\n    {{ sql }}\n  {% endcall %}\n\n  {% do return(load_result(\"run_query_statement\").table) %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.362381, "supported_languages": null}, "macro.dbt.convert_datetime": {"name": "convert_datetime", "resource_type": "macro", "package_name": "dbt", "path": "macros/etc/datetime.sql", "original_file_path": "macros/etc/datetime.sql", "unique_id": "macro.dbt.convert_datetime", "macro_sql": "{% macro convert_datetime(date_str, date_fmt) %}\n\n  {% set error_msg -%}\n      The provided partition date '{{ date_str }}' does not match the expected format '{{ date_fmt }}'\n  {%- endset %}\n\n  {% set res = try_or_compiler_error(error_msg, modules.datetime.datetime.strptime, date_str.strip(), date_fmt) %}\n  {{ return(res) }}\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.362793, "supported_languages": null}, "macro.dbt.dates_in_range": {"name": "dates_in_range", "resource_type": "macro", "package_name": "dbt", "path": "macros/etc/datetime.sql", "original_file_path": "macros/etc/datetime.sql", "unique_id": "macro.dbt.dates_in_range", "macro_sql": "{% macro dates_in_range(start_date_str, end_date_str=none, in_fmt=\"%Y%m%d\", out_fmt=\"%Y%m%d\") %}\n    {% set end_date_str = start_date_str if end_date_str is none else end_date_str %}\n\n    {% set start_date = convert_datetime(start_date_str, in_fmt) %}\n    {% set end_date = convert_datetime(end_date_str, in_fmt) %}\n\n    {% set day_count = (end_date - start_date).days %}\n    {% if day_count < 0 %}\n        {% set msg -%}\n            Partition start date is after the end date ({{ start_date }}, {{ end_date }})\n        {%- endset %}\n\n        {{ exceptions.raise_compiler_error(msg, model) }}\n    {% endif %}\n\n    {% set date_list = [] %}\n    {% for i in range(0, day_count + 1) %}\n        {% set the_date = (modules.datetime.timedelta(days=i) + start_date) %}\n        {% if not out_fmt %}\n            {% set _ = date_list.append(the_date) %}\n        {% else %}\n            {% set _ = date_list.append(the_date.strftime(out_fmt)) %}\n        {% endif %}\n    {% endfor %}\n\n    {{ return(date_list) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.convert_datetime"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3635478, "supported_languages": null}, "macro.dbt.partition_range": {"name": "partition_range", "resource_type": "macro", "package_name": "dbt", "path": "macros/etc/datetime.sql", "original_file_path": "macros/etc/datetime.sql", "unique_id": "macro.dbt.partition_range", "macro_sql": "{% macro partition_range(raw_partition_date, date_fmt='%Y%m%d') %}\n    {% set partition_range = (raw_partition_date | string).split(\",\") %}\n\n    {% if (partition_range | length) == 1 %}\n      {% set start_date = partition_range[0] %}\n      {% set end_date = none %}\n    {% elif (partition_range | length) == 2 %}\n      {% set start_date = partition_range[0] %}\n      {% set end_date = partition_range[1] %}\n    {% else %}\n      {{ exceptions.raise_compiler_error(\"Invalid partition time. Expected format: {Start Date}[,{End Date}]. Got: \" ~ raw_partition_date) }}\n    {% endif %}\n\n    {{ return(dates_in_range(start_date, end_date, in_fmt=date_fmt)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.dates_in_range"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.364228, "supported_languages": null}, "macro.dbt.py_current_timestring": {"name": "py_current_timestring", "resource_type": "macro", "package_name": "dbt", "path": "macros/etc/datetime.sql", "original_file_path": "macros/etc/datetime.sql", "unique_id": "macro.dbt.py_current_timestring", "macro_sql": "{% macro py_current_timestring() %}\n    {% set dt = modules.datetime.datetime.now() %}\n    {% do return(dt.strftime(\"%Y%m%d%H%M%S%f\")) %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.364372, "supported_languages": null}, "macro.dbt.except": {"name": "except", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/except.sql", "original_file_path": "macros/utils/except.sql", "unique_id": "macro.dbt.except", "macro_sql": "{% macro except() %}\n  {{ return(adapter.dispatch('except', 'dbt')()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__except"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3645198, "supported_languages": null}, "macro.dbt.default__except": {"name": "default__except", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/except.sql", "original_file_path": "macros/utils/except.sql", "unique_id": "macro.dbt.default__except", "macro_sql": "{% macro default__except() %}\n\n    except\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.364568, "supported_languages": null}, "macro.dbt.get_intervals_between": {"name": "get_intervals_between", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/date_spine.sql", "original_file_path": "macros/utils/date_spine.sql", "unique_id": "macro.dbt.get_intervals_between", "macro_sql": "{% macro get_intervals_between(start_date, end_date, datepart) -%}\n    {{ return(adapter.dispatch('get_intervals_between', 'dbt')(start_date, end_date, datepart)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_intervals_between"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.364861, "supported_languages": null}, "macro.dbt.default__get_intervals_between": {"name": "default__get_intervals_between", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/date_spine.sql", "original_file_path": "macros/utils/date_spine.sql", "unique_id": "macro.dbt.default__get_intervals_between", "macro_sql": "{% macro default__get_intervals_between(start_date, end_date, datepart) -%}\n    {%- call statement('get_intervals_between', fetch_result=True) %}\n\n        select {{ dbt.datediff(start_date, end_date, datepart) }}\n\n    {%- endcall -%}\n\n    {%- set value_list = load_result('get_intervals_between') -%}\n\n    {%- if value_list and value_list['data'] -%}\n        {%- set values = value_list['data'] | map(attribute=0) | list %}\n        {{ return(values[0]) }}\n    {%- else -%}\n        {{ return(1) }}\n    {%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt.datediff"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.365199, "supported_languages": null}, "macro.dbt.date_spine": {"name": "date_spine", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/date_spine.sql", "original_file_path": "macros/utils/date_spine.sql", "unique_id": "macro.dbt.date_spine", "macro_sql": "{% macro date_spine(datepart, start_date, end_date) %}\n    {{ return(adapter.dispatch('date_spine', 'dbt')(datepart, start_date, end_date)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__date_spine"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.365335, "supported_languages": null}, "macro.dbt.default__date_spine": {"name": "default__date_spine", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/date_spine.sql", "original_file_path": "macros/utils/date_spine.sql", "unique_id": "macro.dbt.default__date_spine", "macro_sql": "{% macro default__date_spine(datepart, start_date, end_date) %}\n\n\n    {# call as follows:\n\n    date_spine(\n        \"day\",\n        \"to_date('01/01/2016', 'mm/dd/yyyy')\",\n        \"dbt.dateadd(week, 1, current_date)\"\n    ) #}\n\n\n    with rawdata as (\n\n        {{dbt.generate_series(\n            dbt.get_intervals_between(start_date, end_date, datepart)\n        )}}\n\n    ),\n\n    all_periods as (\n\n        select (\n            {{\n                dbt.dateadd(\n                    datepart,\n                    \"row_number() over (order by 1) - 1\",\n                    start_date\n                )\n            }}\n        ) as date_{{datepart}}\n        from rawdata\n\n    ),\n\n    filtered as (\n\n        select *\n        from all_periods\n        where date_{{datepart}} <= {{ end_date }}\n\n    )\n\n    select * from filtered\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.generate_series", "macro.dbt.get_intervals_between", "macro.dbt.dateadd"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.365549, "supported_languages": null}, "macro.dbt.date": {"name": "date", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/date.sql", "original_file_path": "macros/utils/date.sql", "unique_id": "macro.dbt.date", "macro_sql": "{% macro date(year, month, day) %}\n  {{ return(adapter.dispatch('date', 'dbt') (year, month, day)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__date"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3657348, "supported_languages": null}, "macro.dbt.default__date": {"name": "default__date", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/date.sql", "original_file_path": "macros/utils/date.sql", "unique_id": "macro.dbt.default__date", "macro_sql": "{% macro default__date(year, month, day) -%}\n    {%- set dt = modules.datetime.date(year, month, day) -%}\n    {%- set iso_8601_formatted_date = dt.strftime('%Y-%m-%d') -%}\n    to_date('{{ iso_8601_formatted_date }}', 'YYYY-MM-DD')\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3659048, "supported_languages": null}, "macro.dbt.replace": {"name": "replace", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/replace.sql", "original_file_path": "macros/utils/replace.sql", "unique_id": "macro.dbt.replace", "macro_sql": "{% macro replace(field, old_chars, new_chars) -%}\n    {{ return(adapter.dispatch('replace', 'dbt') (field, old_chars, new_chars)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__replace"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.366084, "supported_languages": null}, "macro.dbt.default__replace": {"name": "default__replace", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/replace.sql", "original_file_path": "macros/utils/replace.sql", "unique_id": "macro.dbt.default__replace", "macro_sql": "{% macro default__replace(field, old_chars, new_chars) %}\n\n    replace(\n        {{ field }},\n        {{ old_chars }},\n        {{ new_chars }}\n    )\n\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.366184, "supported_languages": null}, "macro.dbt.concat": {"name": "concat", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/concat.sql", "original_file_path": "macros/utils/concat.sql", "unique_id": "macro.dbt.concat", "macro_sql": "{% macro concat(fields) -%}\n  {{ return(adapter.dispatch('concat', 'dbt')(fields)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__concat"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.366328, "supported_languages": null}, "macro.dbt.default__concat": {"name": "default__concat", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/concat.sql", "original_file_path": "macros/utils/concat.sql", "unique_id": "macro.dbt.default__concat", "macro_sql": "{% macro default__concat(fields) -%}\n    {{ fields|join(' || ') }}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.366405, "supported_languages": null}, "macro.dbt.get_powers_of_two": {"name": "get_powers_of_two", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/generate_series.sql", "original_file_path": "macros/utils/generate_series.sql", "unique_id": "macro.dbt.get_powers_of_two", "macro_sql": "{% macro get_powers_of_two(upper_bound) %}\n    {{ return(adapter.dispatch('get_powers_of_two', 'dbt')(upper_bound)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_powers_of_two"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.366656, "supported_languages": null}, "macro.dbt.default__get_powers_of_two": {"name": "default__get_powers_of_two", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/generate_series.sql", "original_file_path": "macros/utils/generate_series.sql", "unique_id": "macro.dbt.default__get_powers_of_two", "macro_sql": "{% macro default__get_powers_of_two(upper_bound) %}\n\n    {% if upper_bound <= 0 %}\n    {{ exceptions.raise_compiler_error(\"upper bound must be positive\") }}\n    {% endif %}\n\n    {% for _ in range(1, 100) %}\n       {% if upper_bound <= 2 ** loop.index %}{{ return(loop.index) }}{% endif %}\n    {% endfor %}\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.366944, "supported_languages": null}, "macro.dbt.generate_series": {"name": "generate_series", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/generate_series.sql", "original_file_path": "macros/utils/generate_series.sql", "unique_id": "macro.dbt.generate_series", "macro_sql": "{% macro generate_series(upper_bound) %}\n    {{ return(adapter.dispatch('generate_series', 'dbt')(upper_bound)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__generate_series"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3670661, "supported_languages": null}, "macro.dbt.default__generate_series": {"name": "default__generate_series", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/generate_series.sql", "original_file_path": "macros/utils/generate_series.sql", "unique_id": "macro.dbt.default__generate_series", "macro_sql": "{% macro default__generate_series(upper_bound) %}\n\n    {% set n = dbt.get_powers_of_two(upper_bound) %}\n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    {% for i in range(n) %}\n    p{{i}}.generated_number * power(2, {{i}})\n    {% if not loop.last %} + {% endif %}\n    {% endfor %}\n    + 1\n    as generated_number\n\n    from\n\n    {% for i in range(n) %}\n    p as p{{i}}\n    {% if not loop.last %} cross join {% endif %}\n    {% endfor %}\n\n    )\n\n    select *\n    from unioned\n    where generated_number <= {{upper_bound}}\n    order by generated_number\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_powers_of_two"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3673658, "supported_languages": null}, "macro.dbt.length": {"name": "length", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/length.sql", "original_file_path": "macros/utils/length.sql", "unique_id": "macro.dbt.length", "macro_sql": "{% macro length(expression) -%}\n    {{ return(adapter.dispatch('length', 'dbt') (expression)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__length"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.367519, "supported_languages": null}, "macro.dbt.default__length": {"name": "default__length", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/length.sql", "original_file_path": "macros/utils/length.sql", "unique_id": "macro.dbt.default__length", "macro_sql": "{% macro default__length(expression) %}\n\n    length(\n        {{ expression }}\n    )\n\n{%- endmacro -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3675861, "supported_languages": null}, "macro.dbt.dateadd": {"name": "dateadd", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/dateadd.sql", "original_file_path": "macros/utils/dateadd.sql", "unique_id": "macro.dbt.dateadd", "macro_sql": "{% macro dateadd(datepart, interval, from_date_or_timestamp) %}\n  {{ return(adapter.dispatch('dateadd', 'dbt')(datepart, interval, from_date_or_timestamp)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__dateadd"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.367767, "supported_languages": null}, "macro.dbt.default__dateadd": {"name": "default__dateadd", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/dateadd.sql", "original_file_path": "macros/utils/dateadd.sql", "unique_id": "macro.dbt.default__dateadd", "macro_sql": "{% macro default__dateadd(datepart, interval, from_date_or_timestamp) %}\n\n    dateadd(\n        {{ datepart }},\n        {{ interval }},\n        {{ from_date_or_timestamp }}\n        )\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3678699, "supported_languages": null}, "macro.dbt.intersect": {"name": "intersect", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/intersect.sql", "original_file_path": "macros/utils/intersect.sql", "unique_id": "macro.dbt.intersect", "macro_sql": "{% macro intersect() %}\n  {{ return(adapter.dispatch('intersect', 'dbt')()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__intersect"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3680031, "supported_languages": null}, "macro.dbt.default__intersect": {"name": "default__intersect", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/intersect.sql", "original_file_path": "macros/utils/intersect.sql", "unique_id": "macro.dbt.default__intersect", "macro_sql": "{% macro default__intersect() %}\n\n    intersect\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.368051, "supported_languages": null}, "macro.dbt.escape_single_quotes": {"name": "escape_single_quotes", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/escape_single_quotes.sql", "original_file_path": "macros/utils/escape_single_quotes.sql", "unique_id": "macro.dbt.escape_single_quotes", "macro_sql": "{% macro escape_single_quotes(expression) %}\n      {{ return(adapter.dispatch('escape_single_quotes', 'dbt') (expression)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__escape_single_quotes"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.368209, "supported_languages": null}, "macro.dbt.default__escape_single_quotes": {"name": "default__escape_single_quotes", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/escape_single_quotes.sql", "original_file_path": "macros/utils/escape_single_quotes.sql", "unique_id": "macro.dbt.default__escape_single_quotes", "macro_sql": "{% macro default__escape_single_quotes(expression) -%}\n{{ expression | replace(\"'\",\"''\") }}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.368296, "supported_languages": null}, "macro.dbt.right": {"name": "right", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/right.sql", "original_file_path": "macros/utils/right.sql", "unique_id": "macro.dbt.right", "macro_sql": "{% macro right(string_text, length_expression) -%}\n    {{ return(adapter.dispatch('right', 'dbt') (string_text, length_expression)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__right"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.368459, "supported_languages": null}, "macro.dbt.default__right": {"name": "default__right", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/right.sql", "original_file_path": "macros/utils/right.sql", "unique_id": "macro.dbt.default__right", "macro_sql": "{% macro default__right(string_text, length_expression) %}\n\n    right(\n        {{ string_text }},\n        {{ length_expression }}\n    )\n\n{%- endmacro -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.368546, "supported_languages": null}, "macro.dbt.listagg": {"name": "listagg", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/listagg.sql", "original_file_path": "macros/utils/listagg.sql", "unique_id": "macro.dbt.listagg", "macro_sql": "{% macro listagg(measure, delimiter_text=\"','\", order_by_clause=none, limit_num=none) -%}\n    {{ return(adapter.dispatch('listagg', 'dbt') (measure, delimiter_text, order_by_clause, limit_num)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__listagg"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.368804, "supported_languages": null}, "macro.dbt.default__listagg": {"name": "default__listagg", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/listagg.sql", "original_file_path": "macros/utils/listagg.sql", "unique_id": "macro.dbt.default__listagg", "macro_sql": "{% macro default__listagg(measure, delimiter_text, order_by_clause, limit_num) -%}\n\n    {% if limit_num -%}\n    array_to_string(\n        array_slice(\n            array_agg(\n                {{ measure }}\n            ){% if order_by_clause -%}\n            within group ({{ order_by_clause }})\n            {%- endif %}\n            ,0\n            ,{{ limit_num }}\n        ),\n        {{ delimiter_text }}\n        )\n    {%- else %}\n    listagg(\n        {{ measure }},\n        {{ delimiter_text }}\n        )\n        {% if order_by_clause -%}\n        within group ({{ order_by_clause }})\n        {%- endif %}\n    {%- endif %}\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.369035, "supported_languages": null}, "macro.dbt.datediff": {"name": "datediff", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/datediff.sql", "original_file_path": "macros/utils/datediff.sql", "unique_id": "macro.dbt.datediff", "macro_sql": "{% macro datediff(first_date, second_date, datepart) %}\n  {{ return(adapter.dispatch('datediff', 'dbt')(first_date, second_date, datepart)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__datediff"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.369215, "supported_languages": null}, "macro.dbt.default__datediff": {"name": "default__datediff", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/datediff.sql", "original_file_path": "macros/utils/datediff.sql", "unique_id": "macro.dbt.default__datediff", "macro_sql": "{% macro default__datediff(first_date, second_date, datepart) -%}\n\n    datediff(\n        {{ datepart }},\n        {{ first_date }},\n        {{ second_date }}\n        )\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.369313, "supported_languages": null}, "macro.dbt.safe_cast": {"name": "safe_cast", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/safe_cast.sql", "original_file_path": "macros/utils/safe_cast.sql", "unique_id": "macro.dbt.safe_cast", "macro_sql": "{% macro safe_cast(field, type) %}\n  {{ return(adapter.dispatch('safe_cast', 'dbt') (field, type)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__safe_cast"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3694808, "supported_languages": null}, "macro.dbt.default__safe_cast": {"name": "default__safe_cast", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/safe_cast.sql", "original_file_path": "macros/utils/safe_cast.sql", "unique_id": "macro.dbt.default__safe_cast", "macro_sql": "{% macro default__safe_cast(field, type) %}\n    {# most databases don't support this function yet\n    so we just need to use cast #}\n    cast({{field}} as {{type}})\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.369569, "supported_languages": null}, "macro.dbt.equals": {"name": "equals", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/equals.sql", "original_file_path": "macros/utils/equals.sql", "unique_id": "macro.dbt.equals", "macro_sql": "{% macro equals(expr1, expr2) %}\n    {{ return(adapter.dispatch('equals', 'dbt') (expr1, expr2)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__equals"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3697522, "supported_languages": null}, "macro.dbt.default__equals": {"name": "default__equals", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/equals.sql", "original_file_path": "macros/utils/equals.sql", "unique_id": "macro.dbt.default__equals", "macro_sql": "{% macro default__equals(expr1, expr2) -%}\n{%- if adapter.behavior.enable_truthy_nulls_equals_macro.no_warn %}\n    case when (({{ expr1 }} = {{ expr2 }}) or ({{ expr1 }} is null and {{ expr2 }} is null))\n        then 0\n        else 1\n    end = 0\n{%- else -%}\n    ({{ expr1 }} = {{ expr2 }})\n{%- endif %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.369924, "supported_languages": null}, "macro.dbt.hash": {"name": "hash", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/hash.sql", "original_file_path": "macros/utils/hash.sql", "unique_id": "macro.dbt.hash", "macro_sql": "{% macro hash(field) -%}\n  {{ return(adapter.dispatch('hash', 'dbt') (field)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__hash"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.37007, "supported_languages": null}, "macro.dbt.default__hash": {"name": "default__hash", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/hash.sql", "original_file_path": "macros/utils/hash.sql", "unique_id": "macro.dbt.default__hash", "macro_sql": "{% macro default__hash(field) -%}\n    md5(cast({{ field }} as {{ api.Column.translate_type('string') }}))\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.370163, "supported_languages": null}, "macro.dbt.cast_bool_to_text": {"name": "cast_bool_to_text", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/cast_bool_to_text.sql", "original_file_path": "macros/utils/cast_bool_to_text.sql", "unique_id": "macro.dbt.cast_bool_to_text", "macro_sql": "{% macro cast_bool_to_text(field) %}\n  {{ adapter.dispatch('cast_bool_to_text', 'dbt') (field) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__cast_bool_to_text"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.370303, "supported_languages": null}, "macro.dbt.default__cast_bool_to_text": {"name": "default__cast_bool_to_text", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/cast_bool_to_text.sql", "original_file_path": "macros/utils/cast_bool_to_text.sql", "unique_id": "macro.dbt.default__cast_bool_to_text", "macro_sql": "{% macro default__cast_bool_to_text(field) %}\n    cast({{ field }} as {{ api.Column.translate_type('string') }})\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.370395, "supported_languages": null}, "macro.dbt.cast": {"name": "cast", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/cast.sql", "original_file_path": "macros/utils/cast.sql", "unique_id": "macro.dbt.cast", "macro_sql": "{% macro cast(field, type) %}\n  {{ return(adapter.dispatch('cast', 'dbt') (field, type)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__cast"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3705542, "supported_languages": null}, "macro.dbt.default__cast": {"name": "default__cast", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/cast.sql", "original_file_path": "macros/utils/cast.sql", "unique_id": "macro.dbt.default__cast", "macro_sql": "{% macro default__cast(field, type) %}\n    cast({{field}} as {{type}})\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.370635, "supported_languages": null}, "macro.dbt.any_value": {"name": "any_value", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/any_value.sql", "original_file_path": "macros/utils/any_value.sql", "unique_id": "macro.dbt.any_value", "macro_sql": "{% macro any_value(expression) -%}\n    {{ return(adapter.dispatch('any_value', 'dbt') (expression)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__any_value"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.370775, "supported_languages": null}, "macro.dbt.default__any_value": {"name": "default__any_value", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/any_value.sql", "original_file_path": "macros/utils/any_value.sql", "unique_id": "macro.dbt.default__any_value", "macro_sql": "{% macro default__any_value(expression) -%}\n\n    any_value({{ expression }})\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.370838, "supported_languages": null}, "macro.dbt.position": {"name": "position", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/position.sql", "original_file_path": "macros/utils/position.sql", "unique_id": "macro.dbt.position", "macro_sql": "{% macro position(substring_text, string_text) -%}\n    {{ return(adapter.dispatch('position', 'dbt') (substring_text, string_text)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__position"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.371, "supported_languages": null}, "macro.dbt.default__position": {"name": "default__position", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/position.sql", "original_file_path": "macros/utils/position.sql", "unique_id": "macro.dbt.default__position", "macro_sql": "{% macro default__position(substring_text, string_text) %}\n\n    position(\n        {{ substring_text }} in {{ string_text }}\n    )\n\n{%- endmacro -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3710809, "supported_languages": null}, "macro.dbt.string_literal": {"name": "string_literal", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/literal.sql", "original_file_path": "macros/utils/literal.sql", "unique_id": "macro.dbt.string_literal", "macro_sql": "{%- macro string_literal(value) -%}\n  {{ return(adapter.dispatch('string_literal', 'dbt') (value)) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__string_literal"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.371223, "supported_languages": null}, "macro.dbt.default__string_literal": {"name": "default__string_literal", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/literal.sql", "original_file_path": "macros/utils/literal.sql", "unique_id": "macro.dbt.default__string_literal", "macro_sql": "{% macro default__string_literal(value) -%}\n    '{{ value }}'\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.371286, "supported_languages": null}, "macro.dbt.type_string": {"name": "type_string", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.type_string", "macro_sql": "\n\n{%- macro type_string() -%}\n  {{ return(adapter.dispatch('type_string', 'dbt')()) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__type_string"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.371695, "supported_languages": null}, "macro.dbt.default__type_string": {"name": "default__type_string", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.default__type_string", "macro_sql": "{% macro default__type_string() %}\n    {{ return(api.Column.translate_type(\"string\")) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3717818, "supported_languages": null}, "macro.dbt.type_timestamp": {"name": "type_timestamp", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.type_timestamp", "macro_sql": "\n\n{%- macro type_timestamp() -%}\n  {{ return(adapter.dispatch('type_timestamp', 'dbt')()) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.371876, "supported_languages": null}, "macro.dbt.default__type_timestamp": {"name": "default__type_timestamp", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.default__type_timestamp", "macro_sql": "{% macro default__type_timestamp() %}\n    {{ return(api.Column.translate_type(\"timestamp\")) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.371966, "supported_languages": null}, "macro.dbt.type_float": {"name": "type_float", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.type_float", "macro_sql": "\n\n{%- macro type_float() -%}\n  {{ return(adapter.dispatch('type_float', 'dbt')()) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__type_float"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3720582, "supported_languages": null}, "macro.dbt.default__type_float": {"name": "default__type_float", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.default__type_float", "macro_sql": "{% macro default__type_float() %}\n    {{ return(api.Column.translate_type(\"float\")) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3721442, "supported_languages": null}, "macro.dbt.type_numeric": {"name": "type_numeric", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.type_numeric", "macro_sql": "\n\n{%- macro type_numeric() -%}\n  {{ return(adapter.dispatch('type_numeric', 'dbt')()) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__type_numeric"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3722339, "supported_languages": null}, "macro.dbt.default__type_numeric": {"name": "default__type_numeric", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.default__type_numeric", "macro_sql": "{% macro default__type_numeric() %}\n    {{ return(api.Column.numeric_type(\"numeric\", 28, 6)) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3723352, "supported_languages": null}, "macro.dbt.type_bigint": {"name": "type_bigint", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.type_bigint", "macro_sql": "\n\n{%- macro type_bigint() -%}\n  {{ return(adapter.dispatch('type_bigint', 'dbt')()) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__type_bigint"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.37243, "supported_languages": null}, "macro.dbt.default__type_bigint": {"name": "default__type_bigint", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.default__type_bigint", "macro_sql": "{% macro default__type_bigint() %}\n    {{ return(api.Column.translate_type(\"bigint\")) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3725162, "supported_languages": null}, "macro.dbt.type_int": {"name": "type_int", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.type_int", "macro_sql": "\n\n{%- macro type_int() -%}\n  {{ return(adapter.dispatch('type_int', 'dbt')()) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__type_int"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.372607, "supported_languages": null}, "macro.dbt.default__type_int": {"name": "default__type_int", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.default__type_int", "macro_sql": "{%- macro default__type_int() -%}\n  {{ return(api.Column.translate_type(\"integer\")) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.37269, "supported_languages": null}, "macro.dbt.type_boolean": {"name": "type_boolean", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.type_boolean", "macro_sql": "\n\n{%- macro type_boolean() -%}\n  {{ return(adapter.dispatch('type_boolean', 'dbt')()) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__type_boolean"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.372781, "supported_languages": null}, "macro.dbt.default__type_boolean": {"name": "default__type_boolean", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.default__type_boolean", "macro_sql": "{%- macro default__type_boolean() -%}\n  {{ return(api.Column.translate_type(\"boolean\")) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.372889, "supported_languages": null}, "macro.dbt.array_concat": {"name": "array_concat", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/array_concat.sql", "original_file_path": "macros/utils/array_concat.sql", "unique_id": "macro.dbt.array_concat", "macro_sql": "{% macro array_concat(array_1, array_2) -%}\n  {{ return(adapter.dispatch('array_concat', 'dbt')(array_1, array_2)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__array_concat"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.373099, "supported_languages": null}, "macro.dbt.default__array_concat": {"name": "default__array_concat", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/array_concat.sql", "original_file_path": "macros/utils/array_concat.sql", "unique_id": "macro.dbt.default__array_concat", "macro_sql": "{% macro default__array_concat(array_1, array_2) -%}\n    array_cat({{ array_1 }}, {{ array_2 }})\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.373186, "supported_languages": null}, "macro.dbt.bool_or": {"name": "bool_or", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/bool_or.sql", "original_file_path": "macros/utils/bool_or.sql", "unique_id": "macro.dbt.bool_or", "macro_sql": "{% macro bool_or(expression) -%}\n    {{ return(adapter.dispatch('bool_or', 'dbt') (expression)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__bool_or"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3733382, "supported_languages": null}, "macro.dbt.default__bool_or": {"name": "default__bool_or", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/bool_or.sql", "original_file_path": "macros/utils/bool_or.sql", "unique_id": "macro.dbt.default__bool_or", "macro_sql": "{% macro default__bool_or(expression) -%}\n\n    bool_or({{ expression }})\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.373405, "supported_languages": null}, "macro.dbt.last_day": {"name": "last_day", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/last_day.sql", "original_file_path": "macros/utils/last_day.sql", "unique_id": "macro.dbt.last_day", "macro_sql": "{% macro last_day(date, datepart) %}\n  {{ return(adapter.dispatch('last_day', 'dbt') (date, datepart)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__last_day"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3739011, "supported_languages": null}, "macro.dbt.default_last_day": {"name": "default_last_day", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/last_day.sql", "original_file_path": "macros/utils/last_day.sql", "unique_id": "macro.dbt.default_last_day", "macro_sql": "\n\n{%- macro default_last_day(date, datepart) -%}\n    cast(\n        {{dbt.dateadd('day', '-1',\n        dbt.dateadd(datepart, '1', dbt.date_trunc(datepart, date))\n        )}}\n        as date)\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.dateadd", "macro.dbt.date_trunc"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.374061, "supported_languages": null}, "macro.dbt.default__last_day": {"name": "default__last_day", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/last_day.sql", "original_file_path": "macros/utils/last_day.sql", "unique_id": "macro.dbt.default__last_day", "macro_sql": "{% macro default__last_day(date, datepart) -%}\n    {{dbt.default_last_day(date, datepart)}}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default_last_day"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3741498, "supported_languages": null}, "macro.dbt.split_part": {"name": "split_part", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/split_part.sql", "original_file_path": "macros/utils/split_part.sql", "unique_id": "macro.dbt.split_part", "macro_sql": "{% macro split_part(string_text, delimiter_text, part_number) %}\n  {{ return(adapter.dispatch('split_part', 'dbt') (string_text, delimiter_text, part_number)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__split_part"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.374418, "supported_languages": null}, "macro.dbt.default__split_part": {"name": "default__split_part", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/split_part.sql", "original_file_path": "macros/utils/split_part.sql", "unique_id": "macro.dbt.default__split_part", "macro_sql": "{% macro default__split_part(string_text, delimiter_text, part_number) %}\n\n    split_part(\n        {{ string_text }},\n        {{ delimiter_text }},\n        {{ part_number }}\n        )\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.374528, "supported_languages": null}, "macro.dbt._split_part_negative": {"name": "_split_part_negative", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/split_part.sql", "original_file_path": "macros/utils/split_part.sql", "unique_id": "macro.dbt._split_part_negative", "macro_sql": "{% macro _split_part_negative(string_text, delimiter_text, part_number) %}\n\n    split_part(\n        {{ string_text }},\n        {{ delimiter_text }},\n          length({{ string_text }})\n          - length(\n              replace({{ string_text }},  {{ delimiter_text }}, '')\n          ) + 2 + {{ part_number }}\n        )\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3746612, "supported_languages": null}, "macro.dbt.date_trunc": {"name": "date_trunc", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/date_trunc.sql", "original_file_path": "macros/utils/date_trunc.sql", "unique_id": "macro.dbt.date_trunc", "macro_sql": "{% macro date_trunc(datepart, date) -%}\n  {{ return(adapter.dispatch('date_trunc', 'dbt') (datepart, date)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__date_trunc"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.374829, "supported_languages": null}, "macro.dbt.default__date_trunc": {"name": "default__date_trunc", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/date_trunc.sql", "original_file_path": "macros/utils/date_trunc.sql", "unique_id": "macro.dbt.default__date_trunc", "macro_sql": "{% macro default__date_trunc(datepart, date) -%}\n    date_trunc('{{datepart}}', {{date}})\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.374912, "supported_languages": null}, "macro.dbt.array_construct": {"name": "array_construct", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/array_construct.sql", "original_file_path": "macros/utils/array_construct.sql", "unique_id": "macro.dbt.array_construct", "macro_sql": "{% macro array_construct(inputs=[], data_type=api.Column.translate_type('integer')) -%}\n  {{ return(adapter.dispatch('array_construct', 'dbt')(inputs, data_type)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__array_construct"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.37515, "supported_languages": null}, "macro.dbt.default__array_construct": {"name": "default__array_construct", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/array_construct.sql", "original_file_path": "macros/utils/array_construct.sql", "unique_id": "macro.dbt.default__array_construct", "macro_sql": "{% macro default__array_construct(inputs, data_type) -%}\n    {% if inputs|length > 0 %}\n    array[ {{ inputs|join(' , ') }} ]\n    {% else %}\n    array[]::{{data_type}}[]\n    {% endif %}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.376527, "supported_languages": null}, "macro.dbt.array_append": {"name": "array_append", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/array_append.sql", "original_file_path": "macros/utils/array_append.sql", "unique_id": "macro.dbt.array_append", "macro_sql": "{% macro array_append(array, new_element) -%}\n  {{ return(adapter.dispatch('array_append', 'dbt')(array, new_element)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__array_append"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.376707, "supported_languages": null}, "macro.dbt.default__array_append": {"name": "default__array_append", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/array_append.sql", "original_file_path": "macros/utils/array_append.sql", "unique_id": "macro.dbt.default__array_append", "macro_sql": "{% macro default__array_append(array, new_element) -%}\n    array_append({{ array }}, {{ new_element }})\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.376791, "supported_languages": null}, "macro.dbt.create_schema": {"name": "create_schema", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/schema.sql", "original_file_path": "macros/adapters/schema.sql", "unique_id": "macro.dbt.create_schema", "macro_sql": "{% macro create_schema(relation) -%}\n  {{ adapter.dispatch('create_schema', 'dbt')(relation) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__create_schema"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.376974, "supported_languages": null}, "macro.dbt.default__create_schema": {"name": "default__create_schema", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/schema.sql", "original_file_path": "macros/adapters/schema.sql", "unique_id": "macro.dbt.default__create_schema", "macro_sql": "{% macro default__create_schema(relation) -%}\n  {%- call statement('create_schema') -%}\n    create schema if not exists {{ relation.without_identifier() }}\n  {% endcall %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.377084, "supported_languages": null}, "macro.dbt.drop_schema": {"name": "drop_schema", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/schema.sql", "original_file_path": "macros/adapters/schema.sql", "unique_id": "macro.dbt.drop_schema", "macro_sql": "{% macro drop_schema(relation) -%}\n  {{ adapter.dispatch('drop_schema', 'dbt')(relation) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__drop_schema"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.377182, "supported_languages": null}, "macro.dbt.default__drop_schema": {"name": "default__drop_schema", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/schema.sql", "original_file_path": "macros/adapters/schema.sql", "unique_id": "macro.dbt.default__drop_schema", "macro_sql": "{% macro default__drop_schema(relation) -%}\n  {%- call statement('drop_schema') -%}\n    drop schema if exists {{ relation.without_identifier() }} cascade\n  {% endcall %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.377289, "supported_languages": null}, "macro.dbt.current_timestamp": {"name": "current_timestamp", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/timestamps.sql", "original_file_path": "macros/adapters/timestamps.sql", "unique_id": "macro.dbt.current_timestamp", "macro_sql": "{%- macro current_timestamp() -%}\n    {{ adapter.dispatch('current_timestamp', 'dbt')() }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.377555, "supported_languages": null}, "macro.dbt.default__current_timestamp": {"name": "default__current_timestamp", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/timestamps.sql", "original_file_path": "macros/adapters/timestamps.sql", "unique_id": "macro.dbt.default__current_timestamp", "macro_sql": "{% macro default__current_timestamp() -%}\n  {{ exceptions.raise_not_implemented(\n    'current_timestamp macro not implemented for adapter ' + adapter.type()) }}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.377645, "supported_languages": null}, "macro.dbt.snapshot_get_time": {"name": "snapshot_get_time", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/timestamps.sql", "original_file_path": "macros/adapters/timestamps.sql", "unique_id": "macro.dbt.snapshot_get_time", "macro_sql": "\n\n{%- macro snapshot_get_time() -%}\n    {{ adapter.dispatch('snapshot_get_time', 'dbt')() }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__snapshot_get_time"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.377729, "supported_languages": null}, "macro.dbt.default__snapshot_get_time": {"name": "default__snapshot_get_time", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/timestamps.sql", "original_file_path": "macros/adapters/timestamps.sql", "unique_id": "macro.dbt.default__snapshot_get_time", "macro_sql": "{% macro default__snapshot_get_time() %}\n    {{ current_timestamp() }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.377791, "supported_languages": null}, "macro.dbt.get_snapshot_get_time_data_type": {"name": "get_snapshot_get_time_data_type", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/timestamps.sql", "original_file_path": "macros/adapters/timestamps.sql", "unique_id": "macro.dbt.get_snapshot_get_time_data_type", "macro_sql": "{% macro get_snapshot_get_time_data_type() %}\n    {% set snapshot_time = adapter.dispatch('snapshot_get_time', 'dbt')() %}\n    {% set time_data_type_sql = 'select ' ~ snapshot_time ~ ' as dbt_snapshot_time' %}\n    {% set snapshot_time_column_schema = get_column_schema_from_query(time_data_type_sql) %}\n    {% set time_data_type = snapshot_time_column_schema[0].dtype %}\n    {{ return(time_data_type or none) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.snapshot_get_time", "macro.dbt_snowflake.snowflake__snapshot_get_time", "macro.dbt.get_column_schema_from_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3780322, "supported_languages": null}, "macro.dbt.current_timestamp_backcompat": {"name": "current_timestamp_backcompat", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/timestamps.sql", "original_file_path": "macros/adapters/timestamps.sql", "unique_id": "macro.dbt.current_timestamp_backcompat", "macro_sql": "{% macro current_timestamp_backcompat() %}\n    {{ return(adapter.dispatch('current_timestamp_backcompat', 'dbt')()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__current_timestamp_backcompat"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.378134, "supported_languages": null}, "macro.dbt.default__current_timestamp_backcompat": {"name": "default__current_timestamp_backcompat", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/timestamps.sql", "original_file_path": "macros/adapters/timestamps.sql", "unique_id": "macro.dbt.default__current_timestamp_backcompat", "macro_sql": "{% macro default__current_timestamp_backcompat() %}\n    current_timestamp::timestamp\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3781812, "supported_languages": null}, "macro.dbt.current_timestamp_in_utc_backcompat": {"name": "current_timestamp_in_utc_backcompat", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/timestamps.sql", "original_file_path": "macros/adapters/timestamps.sql", "unique_id": "macro.dbt.current_timestamp_in_utc_backcompat", "macro_sql": "{% macro current_timestamp_in_utc_backcompat() %}\n    {{ return(adapter.dispatch('current_timestamp_in_utc_backcompat', 'dbt')()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__current_timestamp_in_utc_backcompat"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.378277, "supported_languages": null}, "macro.dbt.default__current_timestamp_in_utc_backcompat": {"name": "default__current_timestamp_in_utc_backcompat", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/timestamps.sql", "original_file_path": "macros/adapters/timestamps.sql", "unique_id": "macro.dbt.default__current_timestamp_in_utc_backcompat", "macro_sql": "{% macro default__current_timestamp_in_utc_backcompat() %}\n    {{ return(adapter.dispatch('current_timestamp_backcompat', 'dbt')()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.current_timestamp_backcompat", "macro.dbt_snowflake.snowflake__current_timestamp_backcompat"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3783731, "supported_languages": null}, "macro.dbt.get_create_index_sql": {"name": "get_create_index_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/indexes.sql", "original_file_path": "macros/adapters/indexes.sql", "unique_id": "macro.dbt.get_create_index_sql", "macro_sql": "{% macro get_create_index_sql(relation, index_dict) -%}\n  {{ return(adapter.dispatch('get_create_index_sql', 'dbt')(relation, index_dict)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_create_index_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.378643, "supported_languages": null}, "macro.dbt.default__get_create_index_sql": {"name": "default__get_create_index_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/indexes.sql", "original_file_path": "macros/adapters/indexes.sql", "unique_id": "macro.dbt.default__get_create_index_sql", "macro_sql": "{% macro default__get_create_index_sql(relation, index_dict) -%}\n  {% do return(None) %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.378725, "supported_languages": null}, "macro.dbt.create_indexes": {"name": "create_indexes", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/indexes.sql", "original_file_path": "macros/adapters/indexes.sql", "unique_id": "macro.dbt.create_indexes", "macro_sql": "{% macro create_indexes(relation) -%}\n  {{ adapter.dispatch('create_indexes', 'dbt')(relation) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__create_indexes"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.378816, "supported_languages": null}, "macro.dbt.default__create_indexes": {"name": "default__create_indexes", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/indexes.sql", "original_file_path": "macros/adapters/indexes.sql", "unique_id": "macro.dbt.default__create_indexes", "macro_sql": "{% macro default__create_indexes(relation) -%}\n  {%- set _indexes = config.get('indexes', default=[]) -%}\n\n  {% for _index_dict in _indexes %}\n    {% set create_index_sql = get_create_index_sql(relation, _index_dict) %}\n    {% if create_index_sql %}\n      {% do run_query(create_index_sql) %}\n    {% endif %}\n  {% endfor %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_create_index_sql", "macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.379044, "supported_languages": null}, "macro.dbt.get_drop_index_sql": {"name": "get_drop_index_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/indexes.sql", "original_file_path": "macros/adapters/indexes.sql", "unique_id": "macro.dbt.get_drop_index_sql", "macro_sql": "{% macro get_drop_index_sql(relation, index_name) -%}\n    {{ adapter.dispatch('get_drop_index_sql', 'dbt')(relation, index_name) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_drop_index_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.379154, "supported_languages": null}, "macro.dbt.default__get_drop_index_sql": {"name": "default__get_drop_index_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/indexes.sql", "original_file_path": "macros/adapters/indexes.sql", "unique_id": "macro.dbt.default__get_drop_index_sql", "macro_sql": "{% macro default__get_drop_index_sql(relation, index_name) -%}\n    {{ exceptions.raise_compiler_error(\"`get_drop_index_sql has not been implemented for this adapter.\") }}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.379235, "supported_languages": null}, "macro.dbt.get_show_indexes_sql": {"name": "get_show_indexes_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/indexes.sql", "original_file_path": "macros/adapters/indexes.sql", "unique_id": "macro.dbt.get_show_indexes_sql", "macro_sql": "{% macro get_show_indexes_sql(relation) -%}\n    {{ adapter.dispatch('get_show_indexes_sql', 'dbt')(relation) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_show_indexes_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3793259, "supported_languages": null}, "macro.dbt.default__get_show_indexes_sql": {"name": "default__get_show_indexes_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/indexes.sql", "original_file_path": "macros/adapters/indexes.sql", "unique_id": "macro.dbt.default__get_show_indexes_sql", "macro_sql": "{% macro default__get_show_indexes_sql(relation) -%}\n    {{ exceptions.raise_compiler_error(\"`get_show_indexes_sql has not been implemented for this adapter.\") }}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3793988, "supported_languages": null}, "macro.dbt.make_intermediate_relation": {"name": "make_intermediate_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.make_intermediate_relation", "macro_sql": "{% macro make_intermediate_relation(base_relation, suffix='__dbt_tmp') %}\n  {{ return(adapter.dispatch('make_intermediate_relation', 'dbt')(base_relation, suffix)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__make_intermediate_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.379786, "supported_languages": null}, "macro.dbt.default__make_intermediate_relation": {"name": "default__make_intermediate_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.default__make_intermediate_relation", "macro_sql": "{% macro default__make_intermediate_relation(base_relation, suffix) %}\n    {{ return(default__make_temp_relation(base_relation, suffix)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__make_temp_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.379885, "supported_languages": null}, "macro.dbt.make_temp_relation": {"name": "make_temp_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.make_temp_relation", "macro_sql": "{% macro make_temp_relation(base_relation, suffix='__dbt_tmp') %}\n  {#-- This ensures microbatch batches get unique temp relations to avoid clobbering --#}\n  {% if suffix == '__dbt_tmp' and model.batch %}\n    {% set suffix = suffix ~ '_' ~ model.batch.id %}\n  {% endif %}\n\n  {{ return(adapter.dispatch('make_temp_relation', 'dbt')(base_relation, suffix)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__make_temp_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.380108, "supported_languages": null}, "macro.dbt.default__make_temp_relation": {"name": "default__make_temp_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.default__make_temp_relation", "macro_sql": "{% macro default__make_temp_relation(base_relation, suffix) %}\n    {%- set temp_identifier = base_relation.identifier ~ suffix -%}\n    {%- set temp_relation = base_relation.incorporate(\n                                path={\"identifier\": temp_identifier}) -%}\n\n    {{ return(temp_relation) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.380281, "supported_languages": null}, "macro.dbt.make_backup_relation": {"name": "make_backup_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.make_backup_relation", "macro_sql": "{% macro make_backup_relation(base_relation, backup_relation_type, suffix='__dbt_backup') %}\n    {{ return(adapter.dispatch('make_backup_relation', 'dbt')(base_relation, backup_relation_type, suffix)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__make_backup_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3804219, "supported_languages": null}, "macro.dbt.default__make_backup_relation": {"name": "default__make_backup_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.default__make_backup_relation", "macro_sql": "{% macro default__make_backup_relation(base_relation, backup_relation_type, suffix) %}\n    {%- set backup_identifier = base_relation.identifier ~ suffix -%}\n    {%- set backup_relation = base_relation.incorporate(\n                                  path={\"identifier\": backup_identifier},\n                                  type=backup_relation_type\n    ) -%}\n    {{ return(backup_relation) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3806038, "supported_languages": null}, "macro.dbt.truncate_relation": {"name": "truncate_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.truncate_relation", "macro_sql": "{% macro truncate_relation(relation) -%}\n  {{ return(adapter.dispatch('truncate_relation', 'dbt')(relation)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__truncate_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.38071, "supported_languages": null}, "macro.dbt.default__truncate_relation": {"name": "default__truncate_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.default__truncate_relation", "macro_sql": "{% macro default__truncate_relation(relation) -%}\n  {% call statement('truncate_relation') -%}\n    truncate table {{ relation.render() }}\n  {%- endcall %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3808131, "supported_languages": null}, "macro.dbt.get_or_create_relation": {"name": "get_or_create_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.get_or_create_relation", "macro_sql": "{% macro get_or_create_relation(database, schema, identifier, type) -%}\n  {{ return(adapter.dispatch('get_or_create_relation', 'dbt')(database, schema, identifier, type)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_or_create_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.380951, "supported_languages": null}, "macro.dbt.default__get_or_create_relation": {"name": "default__get_or_create_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.default__get_or_create_relation", "macro_sql": "{% macro default__get_or_create_relation(database, schema, identifier, type) %}\n  {%- set target_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) %}\n\n  {% if target_relation %}\n    {% do return([true, target_relation]) %}\n  {% endif %}\n\n  {%- set new_relation = api.Relation.create(\n      database=database,\n      schema=schema,\n      identifier=identifier,\n      type=type\n  ) -%}\n  {% do return([false, new_relation]) %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.381257, "supported_languages": null}, "macro.dbt.load_cached_relation": {"name": "load_cached_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.load_cached_relation", "macro_sql": "{% macro load_cached_relation(relation) %}\n  {% do return(adapter.get_relation(\n    database=relation.database,\n    schema=relation.schema,\n    identifier=relation.identifier\n  )) -%}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.38139, "supported_languages": null}, "macro.dbt.load_relation": {"name": "load_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.load_relation", "macro_sql": "{% macro load_relation(relation) %}\n    {{ return(load_cached_relation(relation)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.load_cached_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.381472, "supported_languages": null}, "macro.dbt.collect_freshness": {"name": "collect_freshness", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/freshness.sql", "original_file_path": "macros/adapters/freshness.sql", "unique_id": "macro.dbt.collect_freshness", "macro_sql": "{% macro collect_freshness(source, loaded_at_field, filter) %}\n  {{ return(adapter.dispatch('collect_freshness', 'dbt')(source, loaded_at_field, filter))}}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__collect_freshness"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.381737, "supported_languages": null}, "macro.dbt.default__collect_freshness": {"name": "default__collect_freshness", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/freshness.sql", "original_file_path": "macros/adapters/freshness.sql", "unique_id": "macro.dbt.default__collect_freshness", "macro_sql": "{% macro default__collect_freshness(source, loaded_at_field, filter) %}\n  {% call statement('collect_freshness', fetch_result=True, auto_begin=False) -%}\n    select\n      max({{ loaded_at_field }}) as max_loaded_at,\n      {{ current_timestamp() }} as snapshotted_at\n    from {{ source }}\n    {% if filter %}\n    where {{ filter }}\n    {% endif %}\n  {% endcall %}\n  {{ return(load_result('collect_freshness')) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.381969, "supported_languages": null}, "macro.dbt.collect_freshness_custom_sql": {"name": "collect_freshness_custom_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/freshness.sql", "original_file_path": "macros/adapters/freshness.sql", "unique_id": "macro.dbt.collect_freshness_custom_sql", "macro_sql": "{% macro collect_freshness_custom_sql(source, loaded_at_query) %}\n  {{ return(adapter.dispatch('collect_freshness_custom_sql', 'dbt')(source, loaded_at_query))}}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__collect_freshness_custom_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.382093, "supported_languages": null}, "macro.dbt.default__collect_freshness_custom_sql": {"name": "default__collect_freshness_custom_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/freshness.sql", "original_file_path": "macros/adapters/freshness.sql", "unique_id": "macro.dbt.default__collect_freshness_custom_sql", "macro_sql": "{% macro default__collect_freshness_custom_sql(source, loaded_at_query) %}\n  {% call statement('collect_freshness_custom_sql', fetch_result=True, auto_begin=False) -%}\n  with source_query as (\n    {{ loaded_at_query }}\n  )\n  select\n    (select * from source_query) as max_loaded_at,\n    {{ current_timestamp() }} as snapshotted_at\n  {% endcall %}\n  {{ return(load_result('collect_freshness_custom_sql')) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.382273, "supported_languages": null}, "macro.dbt.validate_sql": {"name": "validate_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/validate_sql.sql", "original_file_path": "macros/adapters/validate_sql.sql", "unique_id": "macro.dbt.validate_sql", "macro_sql": "{% macro validate_sql(sql) -%}\n  {{ return(adapter.dispatch('validate_sql', 'dbt')(sql)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__validate_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3824341, "supported_languages": null}, "macro.dbt.default__validate_sql": {"name": "default__validate_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/validate_sql.sql", "original_file_path": "macros/adapters/validate_sql.sql", "unique_id": "macro.dbt.default__validate_sql", "macro_sql": "{% macro default__validate_sql(sql) -%}\n  {% call statement('validate_sql') -%}\n    explain {{ sql }}\n  {% endcall %}\n  {{ return(load_result('validate_sql')) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.382563, "supported_languages": null}, "macro.dbt.copy_grants": {"name": "copy_grants", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.copy_grants", "macro_sql": "{% macro copy_grants() %}\n    {{ return(adapter.dispatch('copy_grants', 'dbt')()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__copy_grants"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3831942, "supported_languages": null}, "macro.dbt.default__copy_grants": {"name": "default__copy_grants", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.default__copy_grants", "macro_sql": "{% macro default__copy_grants() %}\n    {{ return(True) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.383266, "supported_languages": null}, "macro.dbt.support_multiple_grantees_per_dcl_statement": {"name": "support_multiple_grantees_per_dcl_statement", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.support_multiple_grantees_per_dcl_statement", "macro_sql": "{% macro support_multiple_grantees_per_dcl_statement() %}\n    {{ return(adapter.dispatch('support_multiple_grantees_per_dcl_statement', 'dbt')()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__support_multiple_grantees_per_dcl_statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3833642, "supported_languages": null}, "macro.dbt.default__support_multiple_grantees_per_dcl_statement": {"name": "default__support_multiple_grantees_per_dcl_statement", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.default__support_multiple_grantees_per_dcl_statement", "macro_sql": "\n\n{%- macro default__support_multiple_grantees_per_dcl_statement() -%}\n    {{ return(True) }}\n{%- endmacro -%}\n\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.38343, "supported_languages": null}, "macro.dbt.should_revoke": {"name": "should_revoke", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.should_revoke", "macro_sql": "{% macro should_revoke(existing_relation, full_refresh_mode=True) %}\n\n    {% if not existing_relation %}\n        {#-- The table doesn't already exist, so no grants to copy over --#}\n        {{ return(False) }}\n    {% elif full_refresh_mode %}\n        {#-- The object is being REPLACED -- whether grants are copied over depends on the value of user config --#}\n        {{ return(copy_grants()) }}\n    {% else %}\n        {#-- The table is being merged/upserted/inserted -- grants will be carried over --#}\n        {{ return(True) }}\n    {% endif %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.copy_grants"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.383625, "supported_languages": null}, "macro.dbt.get_show_grant_sql": {"name": "get_show_grant_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.get_show_grant_sql", "macro_sql": "{% macro get_show_grant_sql(relation) %}\n    {{ return(adapter.dispatch(\"get_show_grant_sql\", \"dbt\")(relation)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_show_grant_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.383733, "supported_languages": null}, "macro.dbt.default__get_show_grant_sql": {"name": "default__get_show_grant_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.default__get_show_grant_sql", "macro_sql": "{% macro default__get_show_grant_sql(relation) %}\n    show grants on {{ relation.render() }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.383803, "supported_languages": null}, "macro.dbt.get_grant_sql": {"name": "get_grant_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.get_grant_sql", "macro_sql": "{% macro get_grant_sql(relation, privilege, grantees) %}\n    {{ return(adapter.dispatch('get_grant_sql', 'dbt')(relation, privilege, grantees)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_grant_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.383931, "supported_languages": null}, "macro.dbt.default__get_grant_sql": {"name": "default__get_grant_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.default__get_grant_sql", "macro_sql": "\n\n{%- macro default__get_grant_sql(relation, privilege, grantees) -%}\n    grant {{ privilege }} on {{ relation.render() }} to {{ grantees | join(', ') }}\n{%- endmacro -%}\n\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.384049, "supported_languages": null}, "macro.dbt.get_revoke_sql": {"name": "get_revoke_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.get_revoke_sql", "macro_sql": "{% macro get_revoke_sql(relation, privilege, grantees) %}\n    {{ return(adapter.dispatch('get_revoke_sql', 'dbt')(relation, privilege, grantees)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_revoke_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.384177, "supported_languages": null}, "macro.dbt.default__get_revoke_sql": {"name": "default__get_revoke_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.default__get_revoke_sql", "macro_sql": "\n\n{%- macro default__get_revoke_sql(relation, privilege, grantees) -%}\n    revoke {{ privilege }} on {{ relation.render() }} from {{ grantees | join(', ') }}\n{%- endmacro -%}\n\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.384387, "supported_languages": null}, "macro.dbt.get_dcl_statement_list": {"name": "get_dcl_statement_list", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.get_dcl_statement_list", "macro_sql": "{% macro get_dcl_statement_list(relation, grant_config, get_dcl_macro) %}\n    {{ return(adapter.dispatch('get_dcl_statement_list', 'dbt')(relation, grant_config, get_dcl_macro)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_dcl_statement_list"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3845341, "supported_languages": null}, "macro.dbt.default__get_dcl_statement_list": {"name": "default__get_dcl_statement_list", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.default__get_dcl_statement_list", "macro_sql": "\n\n{%- macro default__get_dcl_statement_list(relation, grant_config, get_dcl_macro) -%}\n    {#\n      -- Unpack grant_config into specific privileges and the set of users who need them granted/revoked.\n      -- Depending on whether this database supports multiple grantees per statement, pass in the list of\n      -- all grantees per privilege, or (if not) template one statement per privilege-grantee pair.\n      -- `get_dcl_macro` will be either `get_grant_sql` or `get_revoke_sql`\n    #}\n    {%- set dcl_statements = [] -%}\n    {%- for privilege, grantees in grant_config.items() %}\n        {%- if support_multiple_grantees_per_dcl_statement() and grantees -%}\n          {%- set dcl = get_dcl_macro(relation, privilege, grantees) -%}\n          {%- do dcl_statements.append(dcl) -%}\n        {%- else -%}\n          {%- for grantee in grantees -%}\n              {% set dcl = get_dcl_macro(relation, privilege, [grantee]) %}\n              {%- do dcl_statements.append(dcl) -%}\n          {% endfor -%}\n        {%- endif -%}\n    {%- endfor -%}\n    {{ return(dcl_statements) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.support_multiple_grantees_per_dcl_statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.384928, "supported_languages": null}, "macro.dbt.call_dcl_statements": {"name": "call_dcl_statements", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.call_dcl_statements", "macro_sql": "{% macro call_dcl_statements(dcl_statement_list) %}\n    {{ return(adapter.dispatch(\"call_dcl_statements\", \"dbt\")(dcl_statement_list)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__call_dcl_statements"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3850439, "supported_languages": null}, "macro.dbt.default__call_dcl_statements": {"name": "default__call_dcl_statements", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.default__call_dcl_statements", "macro_sql": "{% macro default__call_dcl_statements(dcl_statement_list) %}\n    {#\n      -- By default, supply all grant + revoke statements in a single semicolon-separated block,\n      -- so that they're all processed together.\n\n      -- Some databases do not support this. Those adapters will need to override this macro\n      -- to run each statement individually.\n    #}\n    {% call statement('grants') %}\n        {% for dcl_statement in dcl_statement_list %}\n            {{ dcl_statement }};\n        {% endfor %}\n    {% endcall %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.385189, "supported_languages": null}, "macro.dbt.apply_grants": {"name": "apply_grants", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.apply_grants", "macro_sql": "{% macro apply_grants(relation, grant_config, should_revoke) %}\n    {{ return(adapter.dispatch(\"apply_grants\", \"dbt\")(relation, grant_config, should_revoke)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__apply_grants"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.385321, "supported_languages": null}, "macro.dbt.default__apply_grants": {"name": "default__apply_grants", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.default__apply_grants", "macro_sql": "{% macro default__apply_grants(relation, grant_config, should_revoke=True) %}\n    {#-- If grant_config is {} or None, this is a no-op --#}\n    {% if grant_config %}\n        {% if should_revoke %}\n            {#-- We think previous grants may have carried over --#}\n            {#-- Show current grants and calculate diffs --#}\n            {% set current_grants_table = run_query(get_show_grant_sql(relation)) %}\n            {% set current_grants_dict = adapter.standardize_grants_dict(current_grants_table) %}\n            {% set needs_granting = diff_of_two_dicts(grant_config, current_grants_dict) %}\n            {% set needs_revoking = diff_of_two_dicts(current_grants_dict, grant_config) %}\n            {% if not (needs_granting or needs_revoking) %}\n                {{ log('On ' ~ relation.render() ~': All grants are in place, no revocation or granting needed.')}}\n            {% endif %}\n        {% else %}\n            {#-- We don't think there's any chance of previous grants having carried over. --#}\n            {#-- Jump straight to granting what the user has configured. --#}\n            {% set needs_revoking = {} %}\n            {% set needs_granting = grant_config %}\n        {% endif %}\n        {% if needs_granting or needs_revoking %}\n            {% set revoke_statement_list = get_dcl_statement_list(relation, needs_revoking, get_revoke_sql) %}\n            {% set grant_statement_list = get_dcl_statement_list(relation, needs_granting, get_grant_sql) %}\n            {% set dcl_statement_list = revoke_statement_list + grant_statement_list %}\n            {% if dcl_statement_list %}\n                {{ call_dcl_statements(dcl_statement_list) }}\n            {% endif %}\n        {% endif %}\n    {% endif %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.run_query", "macro.dbt.get_show_grant_sql", "macro.dbt.get_dcl_statement_list", "macro.dbt.call_dcl_statements"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.386306, "supported_languages": null}, "macro.dbt.get_show_sql": {"name": "get_show_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/show.sql", "original_file_path": "macros/adapters/show.sql", "unique_id": "macro.dbt.get_show_sql", "macro_sql": "{% macro get_show_sql(compiled_code, sql_header, limit) -%}\n  {%- if sql_header is not none -%}\n  {{ sql_header }}\n  {%- endif %}\n  {{ get_limit_subquery_sql(compiled_code, limit) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_limit_subquery_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.386549, "supported_languages": null}, "macro.dbt.get_limit_subquery_sql": {"name": "get_limit_subquery_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/show.sql", "original_file_path": "macros/adapters/show.sql", "unique_id": "macro.dbt.get_limit_subquery_sql", "macro_sql": "\n{%- macro get_limit_subquery_sql(sql, limit) -%}\n  {{ adapter.dispatch('get_limit_sql', 'dbt')(sql, limit) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__get_limit_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.38666, "supported_languages": null}, "macro.dbt.default__get_limit_sql": {"name": "default__get_limit_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/show.sql", "original_file_path": "macros/adapters/show.sql", "unique_id": "macro.dbt.default__get_limit_sql", "macro_sql": "{% macro default__get_limit_sql(sql, limit) %}\n  {{ sql }}\n  {% if limit is not none %}\n  limit {{ limit }}\n  {%- endif -%}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.386771, "supported_languages": null}, "macro.dbt.alter_column_comment": {"name": "alter_column_comment", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/persist_docs.sql", "original_file_path": "macros/adapters/persist_docs.sql", "unique_id": "macro.dbt.alter_column_comment", "macro_sql": "{% macro alter_column_comment(relation, column_dict) -%}\n  {{ return(adapter.dispatch('alter_column_comment', 'dbt')(relation, column_dict)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__alter_column_comment"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.38702, "supported_languages": null}, "macro.dbt.default__alter_column_comment": {"name": "default__alter_column_comment", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/persist_docs.sql", "original_file_path": "macros/adapters/persist_docs.sql", "unique_id": "macro.dbt.default__alter_column_comment", "macro_sql": "{% macro default__alter_column_comment(relation, column_dict) -%}\n  {{ exceptions.raise_not_implemented(\n    'alter_column_comment macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3871229, "supported_languages": null}, "macro.dbt.alter_relation_comment": {"name": "alter_relation_comment", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/persist_docs.sql", "original_file_path": "macros/adapters/persist_docs.sql", "unique_id": "macro.dbt.alter_relation_comment", "macro_sql": "{% macro alter_relation_comment(relation, relation_comment) -%}\n  {{ return(adapter.dispatch('alter_relation_comment', 'dbt')(relation, relation_comment)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__alter_relation_comment"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.387244, "supported_languages": null}, "macro.dbt.default__alter_relation_comment": {"name": "default__alter_relation_comment", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/persist_docs.sql", "original_file_path": "macros/adapters/persist_docs.sql", "unique_id": "macro.dbt.default__alter_relation_comment", "macro_sql": "{% macro default__alter_relation_comment(relation, relation_comment) -%}\n  {{ exceptions.raise_not_implemented(\n    'alter_relation_comment macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3873432, "supported_languages": null}, "macro.dbt.persist_docs": {"name": "persist_docs", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/persist_docs.sql", "original_file_path": "macros/adapters/persist_docs.sql", "unique_id": "macro.dbt.persist_docs", "macro_sql": "{% macro persist_docs(relation, model, for_relation=true, for_columns=true) -%}\n  {{ return(adapter.dispatch('persist_docs', 'dbt')(relation, model, for_relation, for_columns)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3874948, "supported_languages": null}, "macro.dbt.default__persist_docs": {"name": "default__persist_docs", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/persist_docs.sql", "original_file_path": "macros/adapters/persist_docs.sql", "unique_id": "macro.dbt.default__persist_docs", "macro_sql": "{% macro default__persist_docs(relation, model, for_relation, for_columns) -%}\n  {% if for_relation and config.persist_relation_docs() and model.description %}\n    {% do run_query(alter_relation_comment(relation, model.description)) %}\n  {% endif %}\n\n  {% if for_columns and config.persist_column_docs() and model.columns %}\n    {% do run_query(alter_column_comment(relation, model.columns)) %}\n  {% endif %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.run_query", "macro.dbt.alter_relation_comment", "macro.dbt.alter_column_comment"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.387763, "supported_languages": null}, "macro.dbt.get_catalog_relations": {"name": "get_catalog_relations", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.get_catalog_relations", "macro_sql": "{% macro get_catalog_relations(information_schema, relations) -%}\n  {{ return(adapter.dispatch('get_catalog_relations', 'dbt')(information_schema, relations)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__get_catalog_relations"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.388223, "supported_languages": null}, "macro.dbt.default__get_catalog_relations": {"name": "default__get_catalog_relations", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.default__get_catalog_relations", "macro_sql": "{% macro default__get_catalog_relations(information_schema, relations) -%}\n  {% set typename = adapter.type() %}\n  {% set msg -%}\n    get_catalog_relations not implemented for {{ typename }}\n  {%- endset %}\n\n  {{ exceptions.raise_compiler_error(msg) }}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.388374, "supported_languages": null}, "macro.dbt.get_catalog": {"name": "get_catalog", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.get_catalog", "macro_sql": "{% macro get_catalog(information_schema, schemas) -%}\n  {{ return(adapter.dispatch('get_catalog', 'dbt')(information_schema, schemas)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__get_catalog"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.38872, "supported_languages": null}, "macro.dbt.default__get_catalog": {"name": "default__get_catalog", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.default__get_catalog", "macro_sql": "{% macro default__get_catalog(information_schema, schemas) -%}\n\n  {% set typename = adapter.type() %}\n  {% set msg -%}\n    get_catalog not implemented for {{ typename }}\n  {%- endset %}\n\n  {{ exceptions.raise_compiler_error(msg) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.388874, "supported_languages": null}, "macro.dbt.information_schema_name": {"name": "information_schema_name", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.information_schema_name", "macro_sql": "{% macro information_schema_name(database) %}\n  {{ return(adapter.dispatch('information_schema_name', 'dbt')(database)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__information_schema_name"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.388983, "supported_languages": null}, "macro.dbt.default__information_schema_name": {"name": "default__information_schema_name", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.default__information_schema_name", "macro_sql": "{% macro default__information_schema_name(database) -%}\n  {%- if database -%}\n    {{ database }}.INFORMATION_SCHEMA\n  {%- else -%}\n    INFORMATION_SCHEMA\n  {%- endif -%}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.389076, "supported_languages": null}, "macro.dbt.list_schemas": {"name": "list_schemas", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.list_schemas", "macro_sql": "{% macro list_schemas(database) -%}\n  {{ return(adapter.dispatch('list_schemas', 'dbt')(database)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__list_schemas"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.389179, "supported_languages": null}, "macro.dbt.default__list_schemas": {"name": "default__list_schemas", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.default__list_schemas", "macro_sql": "{% macro default__list_schemas(database) -%}\n  {% set sql %}\n    select distinct schema_name\n    from {{ information_schema_name(database) }}.SCHEMATA\n    where catalog_name ilike '{{ database }}'\n  {% endset %}\n  {{ return(run_query(sql)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.information_schema_name", "macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.389316, "supported_languages": null}, "macro.dbt.check_schema_exists": {"name": "check_schema_exists", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.check_schema_exists", "macro_sql": "{% macro check_schema_exists(information_schema, schema) -%}\n  {{ return(adapter.dispatch('check_schema_exists', 'dbt')(information_schema, schema)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__check_schema_exists"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.389432, "supported_languages": null}, "macro.dbt.default__check_schema_exists": {"name": "default__check_schema_exists", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.default__check_schema_exists", "macro_sql": "{% macro default__check_schema_exists(information_schema, schema) -%}\n  {% set sql -%}\n        select count(*)\n        from {{ information_schema.replace(information_schema_view='SCHEMATA') }}\n        where catalog_name='{{ information_schema.database }}'\n          and schema_name='{{ schema }}'\n  {%- endset %}\n  {{ return(run_query(sql)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.replace", "macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3896089, "supported_languages": null}, "macro.dbt.list_relations_without_caching": {"name": "list_relations_without_caching", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.list_relations_without_caching", "macro_sql": "{% macro list_relations_without_caching(schema_relation) %}\n  {{ return(adapter.dispatch('list_relations_without_caching', 'dbt')(schema_relation)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__list_relations_without_caching"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.389718, "supported_languages": null}, "macro.dbt.default__list_relations_without_caching": {"name": "default__list_relations_without_caching", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.default__list_relations_without_caching", "macro_sql": "{% macro default__list_relations_without_caching(schema_relation) %}\n  {{ exceptions.raise_not_implemented(\n    'list_relations_without_caching macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.389812, "supported_languages": null}, "macro.dbt.get_catalog_for_single_relation": {"name": "get_catalog_for_single_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.get_catalog_for_single_relation", "macro_sql": "{% macro get_catalog_for_single_relation(relation) %}\n  {{ return(adapter.dispatch('get_catalog_for_single_relation', 'dbt')(relation)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_catalog_for_single_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.389915, "supported_languages": null}, "macro.dbt.default__get_catalog_for_single_relation": {"name": "default__get_catalog_for_single_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.default__get_catalog_for_single_relation", "macro_sql": "{% macro default__get_catalog_for_single_relation(relation) %}\n  {{ exceptions.raise_not_implemented(\n    'get_catalog_for_single_relation macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3900118, "supported_languages": null}, "macro.dbt.get_relations": {"name": "get_relations", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.get_relations", "macro_sql": "{% macro get_relations() %}\n  {{ return(adapter.dispatch('get_relations', 'dbt')()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_relations"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.390111, "supported_languages": null}, "macro.dbt.default__get_relations": {"name": "default__get_relations", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.default__get_relations", "macro_sql": "{% macro default__get_relations() %}\n  {{ exceptions.raise_not_implemented(\n    'get_relations macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3902001, "supported_languages": null}, "macro.dbt.get_relation_last_modified": {"name": "get_relation_last_modified", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.get_relation_last_modified", "macro_sql": "{% macro get_relation_last_modified(information_schema, relations) %}\n  {{ return(adapter.dispatch('get_relation_last_modified', 'dbt')(information_schema, relations)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__get_relation_last_modified"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.390316, "supported_languages": null}, "macro.dbt.default__get_relation_last_modified": {"name": "default__get_relation_last_modified", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.default__get_relation_last_modified", "macro_sql": "{% macro default__get_relation_last_modified(information_schema, relations) %}\n  {{ exceptions.raise_not_implemented(\n    'get_relation_last_modified macro not implemented for adapter ' + adapter.type()) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.390421, "supported_languages": null}, "macro.dbt.get_columns_in_relation": {"name": "get_columns_in_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.get_columns_in_relation", "macro_sql": "{% macro get_columns_in_relation(relation) -%}\n  {{ return(adapter.dispatch('get_columns_in_relation', 'dbt')(relation)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__get_columns_in_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.391801, "supported_languages": null}, "macro.dbt.default__get_columns_in_relation": {"name": "default__get_columns_in_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.default__get_columns_in_relation", "macro_sql": "{% macro default__get_columns_in_relation(relation) -%}\n  {{ exceptions.raise_not_implemented(\n    'get_columns_in_relation macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.391902, "supported_languages": null}, "macro.dbt.sql_convert_columns_in_relation": {"name": "sql_convert_columns_in_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.sql_convert_columns_in_relation", "macro_sql": "{% macro sql_convert_columns_in_relation(table) -%}\n  {% set columns = [] %}\n  {% for row in table %}\n    {% do columns.append(api.Column(*row)) %}\n  {% endfor %}\n  {{ return(columns) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.392085, "supported_languages": null}, "macro.dbt.get_list_of_column_names": {"name": "get_list_of_column_names", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.get_list_of_column_names", "macro_sql": "\n\n{%- macro get_list_of_column_names(columns) -%}\n  {% set col_names = [] %}\n  {% for col in columns %}\n    {% do col_names.append(col.name) %}\n  {% endfor %}\n  {{ return(col_names) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3922508, "supported_languages": null}, "macro.dbt.get_empty_subquery_sql": {"name": "get_empty_subquery_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.get_empty_subquery_sql", "macro_sql": "{% macro get_empty_subquery_sql(select_sql, select_sql_header=none) -%}\n  {{ return(adapter.dispatch('get_empty_subquery_sql', 'dbt')(select_sql, select_sql_header)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_empty_subquery_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.392378, "supported_languages": null}, "macro.dbt.default__get_empty_subquery_sql": {"name": "default__get_empty_subquery_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.default__get_empty_subquery_sql", "macro_sql": "{% macro default__get_empty_subquery_sql(select_sql, select_sql_header=none) %}\n    {%- if select_sql_header is not none -%}\n    {{ select_sql_header }}\n    {%- endif -%}\n    select * from (\n        {{ select_sql }}\n    ) as __dbt_sbq\n    where false\n    limit 0\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.392498, "supported_languages": null}, "macro.dbt.get_empty_schema_sql": {"name": "get_empty_schema_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.get_empty_schema_sql", "macro_sql": "{% macro get_empty_schema_sql(columns) -%}\n  {{ return(adapter.dispatch('get_empty_schema_sql', 'dbt')(columns)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_empty_schema_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.392603, "supported_languages": null}, "macro.dbt.default__get_empty_schema_sql": {"name": "default__get_empty_schema_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.default__get_empty_schema_sql", "macro_sql": "{% macro default__get_empty_schema_sql(columns) %}\n    {%- set col_err = [] -%}\n    {%- set col_naked_numeric = [] -%}\n    select\n    {% for i in columns %}\n      {%- set col = columns[i] -%}\n      {%- if col['data_type'] is not defined -%}\n        {%- do col_err.append(col['name']) -%}\n      {#-- If this column's type is just 'numeric' then it is missing precision/scale, raise a warning --#}\n      {%- elif col['data_type'].strip().lower() in ('numeric', 'decimal', 'number') -%}\n        {%- do col_naked_numeric.append(col['name']) -%}\n      {%- endif -%}\n      {% set col_name = adapter.quote(col['name']) if col.get('quote') else col['name'] %}\n      {{ cast('null', col['data_type']) }} as {{ col_name }}{{ \", \" if not loop.last }}\n    {%- endfor -%}\n    {%- if (col_err | length) > 0 -%}\n      {{ exceptions.column_type_missing(column_names=col_err) }}\n    {%- elif (col_naked_numeric | length) > 0 -%}\n      {{ exceptions.warn(\"Detected columns with numeric type and unspecified precision/scale, this can lead to unintended rounding: \" ~ col_naked_numeric ~ \"`\") }}\n    {%- endif -%}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.cast"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.393307, "supported_languages": null}, "macro.dbt.get_column_schema_from_query": {"name": "get_column_schema_from_query", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.get_column_schema_from_query", "macro_sql": "{% macro get_column_schema_from_query(select_sql, select_sql_header=none) -%}\n    {% set columns = [] %}\n    {# -- Using an 'empty subquery' here to get the same schema as the given select_sql statement, without necessitating a data scan.#}\n    {% set sql = get_empty_subquery_sql(select_sql, select_sql_header) %}\n    {% set column_schema = adapter.get_column_schema_from_query(sql) %}\n    {{ return(column_schema) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_empty_subquery_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3935091, "supported_languages": null}, "macro.dbt.get_columns_in_query": {"name": "get_columns_in_query", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.get_columns_in_query", "macro_sql": "{% macro get_columns_in_query(select_sql) -%}\n  {{ return(adapter.dispatch('get_columns_in_query', 'dbt')(select_sql)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_columns_in_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.393619, "supported_languages": null}, "macro.dbt.default__get_columns_in_query": {"name": "default__get_columns_in_query", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.default__get_columns_in_query", "macro_sql": "{% macro default__get_columns_in_query(select_sql) %}\n    {% call statement('get_columns_in_query', fetch_result=True, auto_begin=False) -%}\n        {{ get_empty_subquery_sql(select_sql) }}\n    {% endcall %}\n    {{ return(load_result('get_columns_in_query').table.columns | map(attribute='name') | list) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt.get_empty_subquery_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.393815, "supported_languages": null}, "macro.dbt.alter_column_type": {"name": "alter_column_type", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.alter_column_type", "macro_sql": "{% macro alter_column_type(relation, column_name, new_column_type) -%}\n  {{ return(adapter.dispatch('alter_column_type', 'dbt')(relation, column_name, new_column_type)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__alter_column_type"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3939478, "supported_languages": null}, "macro.dbt.default__alter_column_type": {"name": "default__alter_column_type", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.default__alter_column_type", "macro_sql": "{% macro default__alter_column_type(relation, column_name, new_column_type) -%}\n  {#\n    1. Create a new column (w/ temp name and correct type)\n    2. Copy data over to it\n    3. Drop the existing column (cascade!)\n    4. Rename the new column to existing column\n  #}\n  {%- set tmp_column = column_name + \"__dbt_alter\" -%}\n\n  {% call statement('alter_column_type') %}\n    alter table {{ relation.render() }} add column {{ adapter.quote(tmp_column) }} {{ new_column_type }};\n    update {{ relation.render() }} set {{ adapter.quote(tmp_column) }} = {{ adapter.quote(column_name) }};\n    alter table {{ relation.render() }} drop column {{ adapter.quote(column_name) }} cascade;\n    alter table {{ relation.render() }} rename column {{ adapter.quote(tmp_column) }} to {{ adapter.quote(column_name) }}\n  {% endcall %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.394309, "supported_languages": null}, "macro.dbt.alter_relation_add_remove_columns": {"name": "alter_relation_add_remove_columns", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.alter_relation_add_remove_columns", "macro_sql": "{% macro alter_relation_add_remove_columns(relation, add_columns = none, remove_columns = none) -%}\n  {{ return(adapter.dispatch('alter_relation_add_remove_columns', 'dbt')(relation, add_columns, remove_columns)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__alter_relation_add_remove_columns"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.394454, "supported_languages": null}, "macro.dbt.default__alter_relation_add_remove_columns": {"name": "default__alter_relation_add_remove_columns", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.default__alter_relation_add_remove_columns", "macro_sql": "{% macro default__alter_relation_add_remove_columns(relation, add_columns, remove_columns) %}\n\n  {% if add_columns is none %}\n    {% set add_columns = [] %}\n  {% endif %}\n  {% if remove_columns is none %}\n    {% set remove_columns = [] %}\n  {% endif %}\n\n  {% set sql -%}\n\n     alter {{ relation.type }} {{ relation.render() }}\n\n            {% for column in add_columns %}\n               add column {{ column.quoted }} {{ column.data_type }}{{ ',' if not loop.last }}\n            {% endfor %}{{ ',' if add_columns and remove_columns }}\n\n            {% for column in remove_columns %}\n                drop column {{ column.quoted }}{{ ',' if not loop.last }}\n            {% endfor %}\n\n  {%- endset -%}\n\n  {% do run_query(sql) %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.394897, "supported_languages": null}, "macro.dbt.get_fixture_sql": {"name": "get_fixture_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/unit_test_sql/get_fixture_sql.sql", "original_file_path": "macros/unit_test_sql/get_fixture_sql.sql", "unique_id": "macro.dbt.get_fixture_sql", "macro_sql": "{% macro get_fixture_sql(rows, column_name_to_data_types) %}\n-- Fixture for {{ model.name }}\n{% set default_row = {} %}\n\n{%- if not column_name_to_data_types -%}\n{#-- Use defer_relation IFF it is available in the manifest and 'this' is missing from the database --#}\n{%-   set this_or_defer_relation = defer_relation if (defer_relation and not load_relation(this)) else this -%}\n{%-   set columns_in_relation = adapter.get_columns_in_relation(this_or_defer_relation) -%}\n\n{%-   set column_name_to_data_types = {} -%}\n{%-   set column_name_to_quoted = {} -%}\n{%-   for column in columns_in_relation -%}\n\n{#-- This needs to be a case-insensitive comparison --#}\n{%-     do column_name_to_data_types.update({column.name|lower: column.data_type}) -%}\n{%-     do column_name_to_quoted.update({column.name|lower: column.quoted}) -%}\n{%-   endfor -%}\n{%- endif -%}\n\n{%- if not column_name_to_data_types -%}\n    {{ exceptions.raise_compiler_error(\"Not able to get columns for unit test '\" ~ model.name ~ \"' from relation \" ~ this ~ \" because the relation doesn't exist\") }}\n{%- endif -%}\n\n{%- for column_name, column_type in column_name_to_data_types.items() -%}\n    {%- do default_row.update({column_name: (safe_cast(\"null\", column_type) | trim )}) -%}\n{%- endfor -%}\n\n{{ validate_fixture_rows(rows, row_number) }}\n\n{%- for row in rows -%}\n{%-   set formatted_row = format_row(row, column_name_to_data_types) -%}\n{%-   set default_row_copy = default_row.copy() -%}\n{%-   do default_row_copy.update(formatted_row) -%}\nselect\n{%-   for column_name, column_value in default_row_copy.items() %} {{ column_value }} as {{ column_name_to_quoted[column_name] }}{% if not loop.last -%}, {%- endif %}\n{%-   endfor %}\n{%-   if not loop.last %}\nunion all\n{%    endif %}\n{%- endfor -%}\n\n{%- if (rows | length) == 0 -%}\n    select\n    {%- for column_name, column_value in default_row.items() %} {{ column_value }} as {{ column_name_to_quoted[column_name] }}{% if not loop.last -%},{%- endif %}\n    {%- endfor %}\n    limit 0\n{%- endif -%}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.load_relation", "macro.dbt.safe_cast", "macro.dbt.validate_fixture_rows", "macro.dbt.format_row"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3969102, "supported_languages": null}, "macro.dbt.get_expected_sql": {"name": "get_expected_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/unit_test_sql/get_fixture_sql.sql", "original_file_path": "macros/unit_test_sql/get_fixture_sql.sql", "unique_id": "macro.dbt.get_expected_sql", "macro_sql": "{% macro get_expected_sql(rows, column_name_to_data_types, column_name_to_quoted) %}\n\n{%- if (rows | length) == 0 -%}\n    select * from dbt_internal_unit_test_actual\n    limit 0\n{%- else -%}\n{%- for row in rows -%}\n{%- set formatted_row = format_row(row, column_name_to_data_types) -%}\nselect\n{%- for column_name, column_value in formatted_row.items() %} {{ column_value }} as {{ column_name_to_quoted[column_name] }}{% if not loop.last -%}, {%- endif %}\n{%- endfor %}\n{%- if not loop.last %}\nunion all\n{% endif %}\n{%- endfor -%}\n{%- endif -%}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.format_row"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.397272, "supported_languages": null}, "macro.dbt.format_row": {"name": "format_row", "resource_type": "macro", "package_name": "dbt", "path": "macros/unit_test_sql/get_fixture_sql.sql", "original_file_path": "macros/unit_test_sql/get_fixture_sql.sql", "unique_id": "macro.dbt.format_row", "macro_sql": "\n\n{%- macro format_row(row, column_name_to_data_types) -%}\n    {#-- generate case-insensitive formatted row --#}\n    {% set formatted_row = {} %}\n    {%- for column_name, column_value in row.items() -%}\n        {% set column_name = column_name|lower %}\n\n        {%- if column_name not in column_name_to_data_types %}\n            {#-- if user-provided row contains column name that relation does not contain, raise an error --#}\n            {% set fixture_name = \"expected output\" if model.resource_type == 'unit_test' else (\"'\" ~ model.name ~ \"'\") %}\n            {{ exceptions.raise_compiler_error(\n                \"Invalid column name: '\" ~ column_name ~ \"' in unit test fixture for \" ~ fixture_name ~ \".\"\n                \"\\nAccepted columns for \" ~ fixture_name ~ \" are: \" ~ (column_name_to_data_types.keys()|list)\n            ) }}\n        {%- endif -%}\n\n        {%- set column_type = column_name_to_data_types[column_name] %}\n\n        {#-- sanitize column_value: wrap yaml strings in quotes, apply cast --#}\n        {%- set column_value_clean = column_value -%}\n        {%- if column_value is string -%}\n            {%- set column_value_clean = dbt.string_literal(dbt.escape_single_quotes(column_value)) -%}\n        {%- elif column_value is none -%}\n            {%- set column_value_clean = 'null' -%}\n        {%- endif -%}\n\n        {%- set row_update = {column_name: safe_cast(column_value_clean, column_type) } -%}\n        {%- do formatted_row.update(row_update) -%}\n    {%- endfor -%}\n    {{ return(formatted_row) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.string_literal", "macro.dbt.escape_single_quotes", "macro.dbt.safe_cast"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.397912, "supported_languages": null}, "macro.dbt.validate_fixture_rows": {"name": "validate_fixture_rows", "resource_type": "macro", "package_name": "dbt", "path": "macros/unit_test_sql/get_fixture_sql.sql", "original_file_path": "macros/unit_test_sql/get_fixture_sql.sql", "unique_id": "macro.dbt.validate_fixture_rows", "macro_sql": "{%- macro validate_fixture_rows(rows, row_number) -%}\n  {{ return(adapter.dispatch('validate_fixture_rows', 'dbt')(rows, row_number)) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__validate_fixture_rows"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.39804, "supported_languages": null}, "macro.dbt.default__validate_fixture_rows": {"name": "default__validate_fixture_rows", "resource_type": "macro", "package_name": "dbt", "path": "macros/unit_test_sql/get_fixture_sql.sql", "original_file_path": "macros/unit_test_sql/get_fixture_sql.sql", "unique_id": "macro.dbt.default__validate_fixture_rows", "macro_sql": "{%- macro default__validate_fixture_rows(rows, row_number) -%}\n  {# This is an abstract method for adapter overrides as needed #}\n{%- endmacro -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.3981, "supported_languages": null}, "macro.dbt.resolve_model_name": {"name": "resolve_model_name", "resource_type": "macro", "package_name": "dbt", "path": "macros/python_model/python.sql", "original_file_path": "macros/python_model/python.sql", "unique_id": "macro.dbt.resolve_model_name", "macro_sql": "{% macro resolve_model_name(input_model_name) %}\n    {{ return(adapter.dispatch('resolve_model_name', 'dbt')(input_model_name)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__resolve_model_name"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.398533, "supported_languages": null}, "macro.dbt.default__resolve_model_name": {"name": "default__resolve_model_name", "resource_type": "macro", "package_name": "dbt", "path": "macros/python_model/python.sql", "original_file_path": "macros/python_model/python.sql", "unique_id": "macro.dbt.default__resolve_model_name", "macro_sql": "\n\n{%- macro default__resolve_model_name(input_model_name) -%}\n    {{  input_model_name | string | replace('\"', '\\\"') }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.398626, "supported_languages": null}, "macro.dbt.build_ref_function": {"name": "build_ref_function", "resource_type": "macro", "package_name": "dbt", "path": "macros/python_model/python.sql", "original_file_path": "macros/python_model/python.sql", "unique_id": "macro.dbt.build_ref_function", "macro_sql": "{% macro build_ref_function(model) %}\n\n    {%- set ref_dict = {} -%}\n    {%- for _ref in model.refs -%}\n        {% set _ref_args = [_ref.get('package'), _ref['name']] if _ref.get('package') else [_ref['name'],] %}\n        {%- set resolved = ref(*_ref_args, v=_ref.get('version')) -%}\n\n        {#\n            We want to get the string of the returned relation by calling .render() in order to skip sample/empty\n            mode rendering logic. However, people override the default ref macro, and often return a string instead\n            of a relation (like the ref macro does by default). Thus, to make sure we dont blow things up, we have\n            to ensure the resolved relation has a .render() method.\n        #}\n        {%- if resolved.render is defined and resolved.render is callable -%}\n            {%- set resolved = resolved.render() -%}\n        {%- endif -%}\n\n        {%- if _ref.get('version') -%}\n            {% do _ref_args.extend([\"v\" ~ _ref['version']]) %}\n        {%- endif -%}\n       {%- do ref_dict.update({_ref_args | join('.'): resolve_model_name(resolved)}) -%}\n    {%- endfor -%}\n\ndef ref(*args, **kwargs):\n    refs = {{ ref_dict | tojson }}\n    key = '.'.join(args)\n    version = kwargs.get(\"v\") or kwargs.get(\"version\")\n    if version:\n        key += f\".v{version}\"\n    dbt_load_df_function = kwargs.get(\"dbt_load_df_function\")\n    return dbt_load_df_function(refs[key])\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.resolve_model_name"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.399171, "supported_languages": null}, "macro.dbt.build_source_function": {"name": "build_source_function", "resource_type": "macro", "package_name": "dbt", "path": "macros/python_model/python.sql", "original_file_path": "macros/python_model/python.sql", "unique_id": "macro.dbt.build_source_function", "macro_sql": "{% macro build_source_function(model) %}\n\n    {%- set source_dict = {} -%}\n    {%- for _source in model.sources -%}\n        {%- set resolved = source(*_source) -%}\n        {%- do source_dict.update({_source | join('.'): resolve_model_name(resolved)}) -%}\n    {%- endfor -%}\n\ndef source(*args, dbt_load_df_function):\n    sources = {{ source_dict | tojson }}\n    key = '.'.join(args)\n    return dbt_load_df_function(sources[key])\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.resolve_model_name"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.399411, "supported_languages": null}, "macro.dbt.build_config_dict": {"name": "build_config_dict", "resource_type": "macro", "package_name": "dbt", "path": "macros/python_model/python.sql", "original_file_path": "macros/python_model/python.sql", "unique_id": "macro.dbt.build_config_dict", "macro_sql": "{% macro build_config_dict(model) %}\n    {%- set config_dict = {} -%}\n    {% set config_dbt_used = zip(model.config.config_keys_used, model.config.config_keys_defaults) | list %}\n    {%- for key, default in config_dbt_used -%}\n        {# weird type testing with enum, would be much easier to write this logic in Python! #}\n        {%- if key == \"language\" -%}\n          {%- set value = \"python\" -%}\n        {%- endif -%}\n        {%- set value = model.config.get(key, default) -%}\n        {%- do config_dict.update({key: value}) -%}\n    {%- endfor -%}\nconfig_dict = {{ config_dict }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.399745, "supported_languages": null}, "macro.dbt.py_script_postfix": {"name": "py_script_postfix", "resource_type": "macro", "package_name": "dbt", "path": "macros/python_model/python.sql", "original_file_path": "macros/python_model/python.sql", "unique_id": "macro.dbt.py_script_postfix", "macro_sql": "{% macro py_script_postfix(model) %}\n# This part is user provided model code\n# you will need to copy the next section to run the code\n# COMMAND ----------\n# this part is dbt logic for get ref work, do not modify\n\n{{ build_ref_function(model ) }}\n{{ build_source_function(model ) }}\n{{ build_config_dict(model) }}\n\nclass config:\n    def __init__(self, *args, **kwargs):\n        pass\n\n    @staticmethod\n    def get(key, default=None):\n        return config_dict.get(key, default)\n\nclass this:\n    \"\"\"dbt.this() or dbt.this.identifier\"\"\"\n    database = \"{{ this.database }}\"\n    schema = \"{{ this.schema }}\"\n    identifier = \"{{ this.identifier }}\"\n    {% set this_relation_name = resolve_model_name(this) %}\n    def __repr__(self):\n        return '{{ this_relation_name  }}'\n\n\nclass dbtObj:\n    def __init__(self, load_df_function) -> None:\n        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)\n        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)\n        self.config = config\n        self.this = this()\n        self.is_incremental = {{ is_incremental() }}\n\n# COMMAND ----------\n{{py_script_comment()}}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.build_ref_function", "macro.dbt.build_source_function", "macro.dbt.build_config_dict", "macro.dbt.resolve_model_name", "macro.dbt.is_incremental", "macro.dbt.py_script_comment"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.400019, "supported_languages": null}, "macro.dbt.py_script_comment": {"name": "py_script_comment", "resource_type": "macro", "package_name": "dbt", "path": "macros/python_model/python.sql", "original_file_path": "macros/python_model/python.sql", "unique_id": "macro.dbt.py_script_comment", "macro_sql": "{%macro py_script_comment()%}\n{%endmacro%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4000661, "supported_languages": null}, "macro.dbt.test_unique": {"name": "test_unique", "resource_type": "macro", "package_name": "dbt", "path": "tests/generic/builtin.sql", "original_file_path": "tests/generic/builtin.sql", "unique_id": "macro.dbt.test_unique", "macro_sql": "{% test unique(model, column_name) %}\n    {% set macro = adapter.dispatch('test_unique', 'dbt') %}\n    {{ macro(model, column_name) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt.default__test_unique"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4003341, "supported_languages": null}, "macro.dbt.test_not_null": {"name": "test_not_null", "resource_type": "macro", "package_name": "dbt", "path": "tests/generic/builtin.sql", "original_file_path": "tests/generic/builtin.sql", "unique_id": "macro.dbt.test_not_null", "macro_sql": "{% test not_null(model, column_name) %}\n    {% set macro = adapter.dispatch('test_not_null', 'dbt') %}\n    {{ macro(model, column_name) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt.default__test_not_null"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.400484, "supported_languages": null}, "macro.dbt.test_accepted_values": {"name": "test_accepted_values", "resource_type": "macro", "package_name": "dbt", "path": "tests/generic/builtin.sql", "original_file_path": "tests/generic/builtin.sql", "unique_id": "macro.dbt.test_accepted_values", "macro_sql": "{% test accepted_values(model, column_name, values, quote=True) %}\n    {% set macro = adapter.dispatch('test_accepted_values', 'dbt') %}\n    {{ macro(model, column_name, values, quote) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt.default__test_accepted_values"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.400665, "supported_languages": null}, "macro.dbt.test_relationships": {"name": "test_relationships", "resource_type": "macro", "package_name": "dbt", "path": "tests/generic/builtin.sql", "original_file_path": "tests/generic/builtin.sql", "unique_id": "macro.dbt.test_relationships", "macro_sql": "{% test relationships(model, column_name, to, field) %}\n    {% set macro = adapter.dispatch('test_relationships', 'dbt') %}\n    {{ macro(model, column_name, to, field) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt.default__test_relationships"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4008372, "supported_languages": null}, "macro.dbt_utils.get_url_host": {"name": "get_url_host", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/web/get_url_host.sql", "original_file_path": "macros/web/get_url_host.sql", "unique_id": "macro.dbt_utils.get_url_host", "macro_sql": "{% macro get_url_host(field) -%}\n    {{ return(adapter.dispatch('get_url_host', 'dbt_utils')(field)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.default__get_url_host"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4010181, "supported_languages": null}, "macro.dbt_utils.default__get_url_host": {"name": "default__get_url_host", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/web/get_url_host.sql", "original_file_path": "macros/web/get_url_host.sql", "unique_id": "macro.dbt_utils.default__get_url_host", "macro_sql": "{% macro default__get_url_host(field) -%}\n\n{%- set parsed =\n    dbt.split_part(\n        dbt.split_part(\n            dbt.replace(\n                dbt.replace(\n                    dbt.replace(field, \"'android-app://'\", \"''\"\n                    ), \"'http://'\", \"''\"\n                ), \"'https://'\", \"''\"\n            ), \"'/'\", 1\n        ), \"'?'\", 1\n    )\n\n-%}\n\n\n    {{ dbt.safe_cast(\n        parsed,\n        dbt.type_string()\n        )}}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.split_part", "macro.dbt.replace", "macro.dbt.safe_cast", "macro.dbt.type_string"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.401283, "supported_languages": null}, "macro.dbt_utils.get_url_path": {"name": "get_url_path", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/web/get_url_path.sql", "original_file_path": "macros/web/get_url_path.sql", "unique_id": "macro.dbt_utils.get_url_path", "macro_sql": "{% macro get_url_path(field) -%}\n    {{ return(adapter.dispatch('get_url_path', 'dbt_utils')(field)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.default__get_url_path"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.401481, "supported_languages": null}, "macro.dbt_utils.default__get_url_path": {"name": "default__get_url_path", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/web/get_url_path.sql", "original_file_path": "macros/web/get_url_path.sql", "unique_id": "macro.dbt_utils.default__get_url_path", "macro_sql": "{% macro default__get_url_path(field) -%}\n\n    {%- set stripped_url =\n        dbt.replace(\n            dbt.replace(field, \"'http://'\", \"''\"), \"'https://'\", \"''\")\n    -%}\n\n    {%- set first_slash_pos -%}\n        coalesce(\n            nullif({{ dbt.position(\"'/'\", stripped_url) }}, 0),\n            {{ dbt.position(\"'?'\", stripped_url) }} - 1\n            )\n    {%- endset -%}\n\n    {%- set parsed_path =\n        dbt.split_part(\n            dbt.right(\n                stripped_url,\n                dbt.length(stripped_url) ~ \"-\" ~ first_slash_pos\n                ),\n            \"'?'\", 1\n            )\n    -%}\n\n    {{ dbt.safe_cast(\n        parsed_path,\n        dbt.type_string()\n    )}}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.replace", "macro.dbt.position", "macro.dbt.split_part", "macro.dbt.right", "macro.dbt.length", "macro.dbt.safe_cast", "macro.dbt.type_string"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.401846, "supported_languages": null}, "macro.dbt_utils.get_url_parameter": {"name": "get_url_parameter", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/web/get_url_parameter.sql", "original_file_path": "macros/web/get_url_parameter.sql", "unique_id": "macro.dbt_utils.get_url_parameter", "macro_sql": "{% macro get_url_parameter(field, url_parameter) -%}\n    {{ return(adapter.dispatch('get_url_parameter', 'dbt_utils')(field, url_parameter)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.default__get_url_parameter"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4020228, "supported_languages": null}, "macro.dbt_utils.default__get_url_parameter": {"name": "default__get_url_parameter", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/web/get_url_parameter.sql", "original_file_path": "macros/web/get_url_parameter.sql", "unique_id": "macro.dbt_utils.default__get_url_parameter", "macro_sql": "{% macro default__get_url_parameter(field, url_parameter) -%}\n\n{%- set formatted_url_parameter = \"'\" + url_parameter + \"='\" -%}\n\n{%- set split = dbt.split_part(dbt.split_part(field, formatted_url_parameter, 2), \"'&'\", 1) -%}\n\nnullif({{ split }},'')\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.split_part"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.402209, "supported_languages": null}, "macro.dbt_utils.test_fewer_rows_than": {"name": "test_fewer_rows_than", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/generic_tests/fewer_rows_than.sql", "original_file_path": "macros/generic_tests/fewer_rows_than.sql", "unique_id": "macro.dbt_utils.test_fewer_rows_than", "macro_sql": "{% test fewer_rows_than(model, compare_model, group_by_columns = []) %}\n  {{ return(adapter.dispatch('test_fewer_rows_than', 'dbt_utils')(model, compare_model, group_by_columns)) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_utils.default__test_fewer_rows_than"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.402535, "supported_languages": null}, "macro.dbt_utils.default__test_fewer_rows_than": {"name": "default__test_fewer_rows_than", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/generic_tests/fewer_rows_than.sql", "original_file_path": "macros/generic_tests/fewer_rows_than.sql", "unique_id": "macro.dbt_utils.default__test_fewer_rows_than", "macro_sql": "{% macro default__test_fewer_rows_than(model, compare_model, group_by_columns) %}\n\n{{ config(fail_calc = 'sum(coalesce(row_count_delta, 0))') }}\n\n{% if group_by_columns|length() > 0 %}\n  {% set select_gb_cols = group_by_columns|join(' ,') + ', ' %}\n  {% set join_gb_cols %}\n    {% for c in group_by_columns %}\n      and a.{{c}} = b.{{c}}\n    {% endfor %}\n  {% endset %}\n  {% set groupby_gb_cols = 'group by ' + group_by_columns|join(',') %}\n{% endif %}\n\n{#-- We must add a fake join key in case additional grouping variables are not provided --#}\n{#-- Redshift does not allow for dynamically created join conditions (e.g. full join on 1 = 1 --#}\n{#-- The same logic is used in equal_rowcount. In case of changes, maintain consistent logic --#}\n{% set group_by_columns = ['id_dbtutils_test_fewer_rows_than'] + group_by_columns %}\n{% set groupby_gb_cols = 'group by ' + group_by_columns|join(',') %}\n\n\nwith a as (\n\n    select \n      {{select_gb_cols}}\n      1 as id_dbtutils_test_fewer_rows_than,\n      count(*) as count_our_model \n    from {{ model }}\n    {{ groupby_gb_cols }}\n\n),\nb as (\n\n    select \n      {{select_gb_cols}}\n      1 as id_dbtutils_test_fewer_rows_than,\n      count(*) as count_comparison_model \n    from {{ compare_model }}\n    {{ groupby_gb_cols }}\n\n),\ncounts as (\n\n    select\n\n        {% for c in group_by_columns -%}\n          a.{{c}} as {{c}}_a,\n          b.{{c}} as {{c}}_b,\n        {% endfor %}\n\n        count_our_model,\n        count_comparison_model\n    from a\n    full join b on \n    a.id_dbtutils_test_fewer_rows_than = b.id_dbtutils_test_fewer_rows_than\n    {{ join_gb_cols }}\n\n),\nfinal as (\n\n    select *,\n        case\n            -- fail the test if we have more rows than the reference model and return the row count delta\n            when count_our_model > count_comparison_model then (count_our_model - count_comparison_model)\n            -- fail the test if they are the same number\n            when count_our_model = count_comparison_model then 1\n            -- pass the test if the delta is positive (i.e. return the number 0)\n            else 0\n    end as row_count_delta\n    from counts\n\n)\n\nselect * from final\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.403119, "supported_languages": null}, "macro.dbt_utils.test_equal_rowcount": {"name": "test_equal_rowcount", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/generic_tests/equal_rowcount.sql", "original_file_path": "macros/generic_tests/equal_rowcount.sql", "unique_id": "macro.dbt_utils.test_equal_rowcount", "macro_sql": "{% test equal_rowcount(model, compare_model, group_by_columns = []) %}\n  {{ return(adapter.dispatch('test_equal_rowcount', 'dbt_utils')(model, compare_model, group_by_columns)) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_utils.default__test_equal_rowcount"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.40345, "supported_languages": null}, "macro.dbt_utils.default__test_equal_rowcount": {"name": "default__test_equal_rowcount", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/generic_tests/equal_rowcount.sql", "original_file_path": "macros/generic_tests/equal_rowcount.sql", "unique_id": "macro.dbt_utils.default__test_equal_rowcount", "macro_sql": "{% macro default__test_equal_rowcount(model, compare_model, group_by_columns) %}\n\n{#-- Needs to be set at parse time, before we return '' below --#}\n{{ config(fail_calc = 'sum(coalesce(diff_count, 0))') }}\n\n{#-- Prevent querying of db in parsing mode. This works because this macro does not create any new refs. #}\n{%- if not execute -%}\n    {{ return('') }}\n{% endif %}\n\n{% if group_by_columns|length() > 0 %}\n  {% set select_gb_cols = group_by_columns|join(', ') + ', ' %}\n  {% set join_gb_cols %}\n    {% for c in group_by_columns %}\n      and a.{{c}} = b.{{c}}\n    {% endfor %}\n  {% endset %}\n  {% set groupby_gb_cols = 'group by ' + group_by_columns|join(',') %}\n{% endif %}\n\n{#-- We must add a fake join key in case additional grouping variables are not provided --#}\n{#-- Redshift does not allow for dynamically created join conditions (e.g. full join on 1 = 1 --#}\n{#-- The same logic is used in fewer_rows_than. In case of changes, maintain consistent logic --#}\n{% set group_by_columns = ['id_dbtutils_test_equal_rowcount'] + group_by_columns %}\n{% set groupby_gb_cols = 'group by ' + group_by_columns|join(',') %}\n\nwith a as (\n\n    select \n      {{select_gb_cols}}\n      1 as id_dbtutils_test_equal_rowcount,\n      count(*) as count_a \n    from {{ model }}\n    {{groupby_gb_cols}}\n\n\n),\nb as (\n\n    select \n      {{select_gb_cols}}\n      1 as id_dbtutils_test_equal_rowcount,\n      count(*) as count_b \n    from {{ compare_model }}\n    {{groupby_gb_cols}}\n\n),\nfinal as (\n\n    select\n    \n        {% for c in group_by_columns -%}\n          a.{{c}} as {{c}}_a,\n          b.{{c}} as {{c}}_b,\n        {% endfor %}\n\n        count_a,\n        count_b,\n        abs(count_a - count_b) as diff_count\n\n    from a\n    full join b\n    on\n    a.id_dbtutils_test_equal_rowcount = b.id_dbtutils_test_equal_rowcount\n    {{join_gb_cols}}\n\n\n)\n\nselect * from final\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4040582, "supported_languages": null}, "macro.dbt_utils.test_relationships_where": {"name": "test_relationships_where", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/generic_tests/relationships_where.sql", "original_file_path": "macros/generic_tests/relationships_where.sql", "unique_id": "macro.dbt_utils.test_relationships_where", "macro_sql": "{% test relationships_where(model, column_name, to, field, from_condition=\"1=1\", to_condition=\"1=1\") %}\n  {{ return(adapter.dispatch('test_relationships_where', 'dbt_utils')(model, column_name, to, field, from_condition, to_condition)) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_utils.default__test_relationships_where"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.40433, "supported_languages": null}, "macro.dbt_utils.default__test_relationships_where": {"name": "default__test_relationships_where", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/generic_tests/relationships_where.sql", "original_file_path": "macros/generic_tests/relationships_where.sql", "unique_id": "macro.dbt_utils.default__test_relationships_where", "macro_sql": "{% macro default__test_relationships_where(model, column_name, to, field, from_condition=\"1=1\", to_condition=\"1=1\") %}\n\n{# T-SQL has no boolean data type so we use 1=1 which returns TRUE #}\n{# ref https://stackoverflow.com/a/7170753/3842610 #}\n\nwith left_table as (\n\n  select\n    {{column_name}} as id\n\n  from {{model}}\n\n  where {{column_name}} is not null\n    and {{from_condition}}\n\n),\n\nright_table as (\n\n  select\n    {{field}} as id\n\n  from {{to}}\n\n  where {{field}} is not null\n    and {{to_condition}}\n\n),\n\nexceptions as (\n\n  select\n    left_table.id,\n    right_table.id as right_id\n\n  from left_table\n\n  left join right_table\n         on left_table.id = right_table.id\n\n  where right_table.id is null\n\n)\n\nselect * from exceptions\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.404536, "supported_languages": null}, "macro.dbt_utils.test_recency": {"name": "test_recency", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/generic_tests/recency.sql", "original_file_path": "macros/generic_tests/recency.sql", "unique_id": "macro.dbt_utils.test_recency", "macro_sql": "{% test recency(model, field, datepart, interval, ignore_time_component=False, group_by_columns = []) %}\n  {{ return(adapter.dispatch('test_recency', 'dbt_utils')(model, field, datepart, interval, ignore_time_component, group_by_columns)) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_utils.default__test_recency"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4048362, "supported_languages": null}, "macro.dbt_utils.default__test_recency": {"name": "default__test_recency", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/generic_tests/recency.sql", "original_file_path": "macros/generic_tests/recency.sql", "unique_id": "macro.dbt_utils.default__test_recency", "macro_sql": "{% macro default__test_recency(model, field, datepart, interval, ignore_time_component, group_by_columns) %}\n\n{% set threshold = 'cast(' ~ dbt.dateadd(datepart, interval * -1, dbt.current_timestamp()) ~ ' as ' ~ ('date' if ignore_time_component else dbt.type_timestamp()) ~ ')'  %}\n\n{% if group_by_columns|length() > 0 %}\n  {% set select_gb_cols = group_by_columns|join(' ,') + ', ' %}\n  {% set groupby_gb_cols = 'group by ' + group_by_columns|join(',') %}\n{% endif %}\n\n\nwith recency as (\n\n    select \n\n      {{ select_gb_cols }}\n      {% if ignore_time_component %}\n        cast(max({{ field }}) as date) as most_recent\n      {%- else %}\n        max({{ field }}) as most_recent\n      {%- endif %}\n\n    from {{ model }}\n\n    {{ groupby_gb_cols }}\n\n)\n\nselect\n\n    {{ select_gb_cols }}\n    most_recent,\n    {{ threshold }} as threshold\n\nfrom recency\nwhere most_recent < {{ threshold }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.dateadd", "macro.dbt.current_timestamp", "macro.dbt.type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4053152, "supported_languages": null}, "macro.dbt_utils.test_not_constant": {"name": "test_not_constant", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/generic_tests/not_constant.sql", "original_file_path": "macros/generic_tests/not_constant.sql", "unique_id": "macro.dbt_utils.test_not_constant", "macro_sql": "{% test not_constant(model, column_name, group_by_columns = []) %}\n  {{ return(adapter.dispatch('test_not_constant', 'dbt_utils')(model, column_name, group_by_columns)) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_utils.default__test_not_constant"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.405545, "supported_languages": null}, "macro.dbt_utils.default__test_not_constant": {"name": "default__test_not_constant", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/generic_tests/not_constant.sql", "original_file_path": "macros/generic_tests/not_constant.sql", "unique_id": "macro.dbt_utils.default__test_not_constant", "macro_sql": "{% macro default__test_not_constant(model, column_name, group_by_columns) %}\n\n{% if group_by_columns|length() > 0 %}\n  {% set select_gb_cols = group_by_columns|join(' ,') + ', ' %}\n  {% set groupby_gb_cols = 'group by ' + group_by_columns|join(',') %}\n{% endif %}\n\n\nselect\n    {# In TSQL, subquery aggregate columns need aliases #}\n    {# thus: a filler col name, 'filler_column' #}\n    {{select_gb_cols}}\n    count(distinct {{ column_name }}) as filler_column\n\nfrom {{ model }}\n\n  {{groupby_gb_cols}}\n\nhaving count(distinct {{ column_name }}) = 1\n\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.405809, "supported_languages": null}, "macro.dbt_utils.test_accepted_range": {"name": "test_accepted_range", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/generic_tests/accepted_range.sql", "original_file_path": "macros/generic_tests/accepted_range.sql", "unique_id": "macro.dbt_utils.test_accepted_range", "macro_sql": "{% test accepted_range(model, column_name, min_value=none, max_value=none, inclusive=true) %}\n  {{ return(adapter.dispatch('test_accepted_range', 'dbt_utils')(model, column_name, min_value, max_value, inclusive)) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_utils.default__test_accepted_range"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.406077, "supported_languages": null}, "macro.dbt_utils.default__test_accepted_range": {"name": "default__test_accepted_range", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/generic_tests/accepted_range.sql", "original_file_path": "macros/generic_tests/accepted_range.sql", "unique_id": "macro.dbt_utils.default__test_accepted_range", "macro_sql": "{% macro default__test_accepted_range(model, column_name, min_value=none, max_value=none, inclusive=true) %}\n\nwith meet_condition as(\n  select *\n  from {{ model }}\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n\n  {%- if min_value is not none %}\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not {{ column_name }} > {{- \"=\" if inclusive }} {{ min_value }}\n  {%- endif %}\n\n  {%- if max_value is not none %}\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not {{ column_name }} < {{- \"=\" if inclusive }} {{ max_value }}\n  {%- endif %}\n)\n\nselect *\nfrom validation_errors\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4064178, "supported_languages": null}, "macro.dbt_utils.test_not_accepted_values": {"name": "test_not_accepted_values", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/generic_tests/not_accepted_values.sql", "original_file_path": "macros/generic_tests/not_accepted_values.sql", "unique_id": "macro.dbt_utils.test_not_accepted_values", "macro_sql": "{% test not_accepted_values(model, column_name, values, quote=True) %}\n  {{ return(adapter.dispatch('test_not_accepted_values', 'dbt_utils')(model, column_name, values, quote)) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_utils.default__test_not_accepted_values"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.406684, "supported_languages": null}, "macro.dbt_utils.default__test_not_accepted_values": {"name": "default__test_not_accepted_values", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/generic_tests/not_accepted_values.sql", "original_file_path": "macros/generic_tests/not_accepted_values.sql", "unique_id": "macro.dbt_utils.default__test_not_accepted_values", "macro_sql": "{% macro default__test_not_accepted_values(model, column_name, values, quote=True) %}\nwith all_values as (\n\n    select distinct\n        {{ column_name }} as value_field\n\n    from {{ model }}\n\n),\n\nvalidation_errors as (\n\n    select\n        value_field\n\n    from all_values\n    where value_field in (\n        {% for value in values -%}\n            {% if quote -%}\n            '{{ value }}'\n            {%- else -%}\n            {{ value }}\n            {%- endif -%}\n            {%- if not loop.last -%},{%- endif %}\n        {%- endfor %}\n        )\n\n)\n\nselect *\nfrom validation_errors\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.406912, "supported_languages": null}, "macro.dbt_utils.test_at_least_one": {"name": "test_at_least_one", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/generic_tests/at_least_one.sql", "original_file_path": "macros/generic_tests/at_least_one.sql", "unique_id": "macro.dbt_utils.test_at_least_one", "macro_sql": "{% test at_least_one(model, column_name, group_by_columns = []) %}\n  {{ return(adapter.dispatch('test_at_least_one', 'dbt_utils')(model, column_name, group_by_columns)) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_utils.default__test_at_least_one"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.407187, "supported_languages": null}, "macro.dbt_utils.default__test_at_least_one": {"name": "default__test_at_least_one", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/generic_tests/at_least_one.sql", "original_file_path": "macros/generic_tests/at_least_one.sql", "unique_id": "macro.dbt_utils.default__test_at_least_one", "macro_sql": "{% macro default__test_at_least_one(model, column_name, group_by_columns) %}\n\n{% set pruned_cols = [column_name] %}\n\n{% if group_by_columns|length() > 0 %}\n\n  {% set select_gb_cols = group_by_columns|join(' ,') + ', ' %}\n  {% set groupby_gb_cols = 'group by ' + group_by_columns|join(',') %}\n  {% set pruned_cols = group_by_columns %}\n\n  {% if column_name not in pruned_cols %}\n    {% do pruned_cols.append(column_name) %}\n  {% endif %}\n\n{% endif %}\n\n{% set select_pruned_cols = pruned_cols|join(' ,') %}\n\nselect *\nfrom (\n    with pruned_rows as (\n      select\n        {{ select_pruned_cols }}\n      from {{ model }}\n      {% if group_by_columns|length() == 0 %}\n        where {{ column_name }} is not null\n        limit 1\n      {% endif %}\n    )\n    select\n        {# In TSQL, subquery aggregate columns need aliases #}\n        {# thus: a filler col name, 'filler_column' #}\n      {{select_gb_cols}}\n      count({{ column_name }}) as filler_column\n\n    from pruned_rows\n\n    {{groupby_gb_cols}}\n\n    having count({{ column_name }}) = 0\n\n) validation_errors\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.407682, "supported_languages": null}, "macro.dbt_utils.test_unique_combination_of_columns": {"name": "test_unique_combination_of_columns", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/generic_tests/unique_combination_of_columns.sql", "original_file_path": "macros/generic_tests/unique_combination_of_columns.sql", "unique_id": "macro.dbt_utils.test_unique_combination_of_columns", "macro_sql": "{% test unique_combination_of_columns(model, combination_of_columns, quote_columns=false) %}\n  {{ return(adapter.dispatch('test_unique_combination_of_columns', 'dbt_utils')(model, combination_of_columns, quote_columns)) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_utils.default__test_unique_combination_of_columns"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4079292, "supported_languages": null}, "macro.dbt_utils.default__test_unique_combination_of_columns": {"name": "default__test_unique_combination_of_columns", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/generic_tests/unique_combination_of_columns.sql", "original_file_path": "macros/generic_tests/unique_combination_of_columns.sql", "unique_id": "macro.dbt_utils.default__test_unique_combination_of_columns", "macro_sql": "{% macro default__test_unique_combination_of_columns(model, combination_of_columns, quote_columns=false) %}\n\n{% if not quote_columns %}\n    {%- set column_list=combination_of_columns %}\n{% elif quote_columns %}\n    {%- set column_list=[] %}\n        {% for column in combination_of_columns -%}\n            {% do column_list.append( adapter.quote(column) ) %}\n        {%- endfor %}\n{% else %}\n    {{ exceptions.raise_compiler_error(\n        \"`quote_columns` argument for unique_combination_of_columns test must be one of [True, False] Got: '\" ~ quote ~\"'.'\"\n    ) }}\n{% endif %}\n\n{%- set columns_csv=column_list | join(', ') %}\n\n\nwith validation_errors as (\n\n    select\n        {{ columns_csv }}\n    from {{ model }}\n    group by {{ columns_csv }}\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.408288, "supported_languages": null}, "macro.dbt_utils.test_cardinality_equality": {"name": "test_cardinality_equality", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/generic_tests/cardinality_equality.sql", "original_file_path": "macros/generic_tests/cardinality_equality.sql", "unique_id": "macro.dbt_utils.test_cardinality_equality", "macro_sql": "{% test cardinality_equality(model, column_name, to, field) %}\n    {{ return(adapter.dispatch('test_cardinality_equality', 'dbt_utils')(model, column_name, to, field)) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_utils.default__test_cardinality_equality"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.408513, "supported_languages": null}, "macro.dbt_utils.default__test_cardinality_equality": {"name": "default__test_cardinality_equality", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/generic_tests/cardinality_equality.sql", "original_file_path": "macros/generic_tests/cardinality_equality.sql", "unique_id": "macro.dbt_utils.default__test_cardinality_equality", "macro_sql": "{% macro default__test_cardinality_equality(model, column_name, to, field) %}\n\n{# T-SQL does not let you use numbers as aliases for columns #}\n{# Thus, no \"GROUP BY 1\" #}\n\nwith table_a as (\nselect\n  {{ column_name }},\n  count(*) as num_rows\nfrom {{ model }}\ngroup by {{ column_name }}\n),\n\ntable_b as (\nselect\n  {{ field }},\n  count(*) as num_rows\nfrom {{ to }}\ngroup by {{ field }}\n),\n\nexcept_a as (\n  select *\n  from table_a\n  {{ dbt.except() }}\n  select *\n  from table_b\n),\n\nexcept_b as (\n  select *\n  from table_b\n  {{ dbt.except() }}\n  select *\n  from table_a\n),\n\nunioned as (\n  select *\n  from except_a\n  union all\n  select *\n  from except_b\n)\n\nselect *\nfrom unioned\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.except"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.408712, "supported_languages": null}, "macro.dbt_utils.test_expression_is_true": {"name": "test_expression_is_true", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/generic_tests/expression_is_true.sql", "original_file_path": "macros/generic_tests/expression_is_true.sql", "unique_id": "macro.dbt_utils.test_expression_is_true", "macro_sql": "{% test expression_is_true(model, expression, column_name=None) %}\n  {{ return(adapter.dispatch('test_expression_is_true', 'dbt_utils')(model, expression, column_name)) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_utils.default__test_expression_is_true"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4089239, "supported_languages": null}, "macro.dbt_utils.default__test_expression_is_true": {"name": "default__test_expression_is_true", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/generic_tests/expression_is_true.sql", "original_file_path": "macros/generic_tests/expression_is_true.sql", "unique_id": "macro.dbt_utils.default__test_expression_is_true", "macro_sql": "{% macro default__test_expression_is_true(model, expression, column_name) %}\n\n{% set column_list = '*' if should_store_failures() else \"1\" %}\n\nselect\n    {{ column_list }}\nfrom {{ model }}\n{% if column_name is none %}\nwhere not({{ expression }})\n{%- else %}\nwhere not({{ column_name }} {{ expression }})\n{%- endif %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.should_store_failures"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4094641, "supported_languages": null}, "macro.dbt_utils.test_not_null_proportion": {"name": "test_not_null_proportion", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/generic_tests/not_null_proportion.sql", "original_file_path": "macros/generic_tests/not_null_proportion.sql", "unique_id": "macro.dbt_utils.test_not_null_proportion", "macro_sql": "{% macro test_not_null_proportion(model, group_by_columns = []) %}\n  {{ return(adapter.dispatch('test_not_null_proportion', 'dbt_utils')(model, group_by_columns, **kwargs)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.default__test_not_null_proportion"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.409739, "supported_languages": null}, "macro.dbt_utils.default__test_not_null_proportion": {"name": "default__test_not_null_proportion", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/generic_tests/not_null_proportion.sql", "original_file_path": "macros/generic_tests/not_null_proportion.sql", "unique_id": "macro.dbt_utils.default__test_not_null_proportion", "macro_sql": "{% macro default__test_not_null_proportion(model, group_by_columns) %}\n\n{% set column_name = kwargs.get('column_name', kwargs.get('arg')) %}\n{% set at_least = kwargs.get('at_least', kwargs.get('arg')) %}\n{% set at_most = kwargs.get('at_most', kwargs.get('arg', 1)) %}\n\n{% if group_by_columns|length() > 0 %}\n  {% set select_gb_cols = group_by_columns|join(' ,') + ', ' %}\n  {% set groupby_gb_cols = 'group by ' + group_by_columns|join(',') %}\n{% endif %}\n\nwith validation as (\n  select\n    {{select_gb_cols}}\n    sum(case when {{ column_name }} is null then 0 else 1 end) / cast(count(*) as {{ dbt.type_numeric() }}) as not_null_proportion\n  from {{ model }}\n  {{groupby_gb_cols}}\n),\nvalidation_errors as (\n  select\n    {{select_gb_cols}}\n    not_null_proportion\n  from validation\n  where not_null_proportion < {{ at_least }} or not_null_proportion > {{ at_most }}\n)\nselect\n  *\nfrom validation_errors\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.type_numeric"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.410223, "supported_languages": null}, "macro.dbt_utils.test_sequential_values": {"name": "test_sequential_values", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/generic_tests/sequential_values.sql", "original_file_path": "macros/generic_tests/sequential_values.sql", "unique_id": "macro.dbt_utils.test_sequential_values", "macro_sql": "{% test sequential_values(model, column_name, interval=1, datepart=None, group_by_columns = []) %}\n\n  {{ return(adapter.dispatch('test_sequential_values', 'dbt_utils')(model, column_name, interval, datepart, group_by_columns)) }}\n\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_utils.default__test_sequential_values"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.410579, "supported_languages": null}, "macro.dbt_utils.default__test_sequential_values": {"name": "default__test_sequential_values", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/generic_tests/sequential_values.sql", "original_file_path": "macros/generic_tests/sequential_values.sql", "unique_id": "macro.dbt_utils.default__test_sequential_values", "macro_sql": "{% macro default__test_sequential_values(model, column_name, interval=1, datepart=None, group_by_columns = []) %}\n\n{% set previous_column_name = \"previous_\" ~ dbt_utils.slugify(column_name) %}\n\n{% if group_by_columns|length() > 0 %}\n  {% set select_gb_cols = group_by_columns|join(',') + ', ' %}\n  {% set partition_gb_cols = 'partition by ' + group_by_columns|join(',') %}\n{% endif %}\n\nwith windowed as (\n\n    select\n        {{ select_gb_cols }}\n        {{ column_name }},\n        lag({{ column_name }}) over (\n            {{partition_gb_cols}}\n            order by {{ column_name }}\n        ) as {{ previous_column_name }}\n    from {{ model }}\n),\n\nvalidation_errors as (\n    select\n        *\n    from windowed\n    {% if datepart %}\n    where not(cast({{ column_name }} as {{ dbt.type_timestamp() }})= cast({{ dbt.dateadd(datepart, interval, previous_column_name) }} as {{ dbt.type_timestamp() }}))\n    {% else %}\n    where not({{ column_name }} = {{ previous_column_name }} + {{ interval }})\n    {% endif %}\n)\n\nselect *\nfrom validation_errors\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.slugify", "macro.dbt.type_timestamp", "macro.dbt.dateadd"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.411123, "supported_languages": null}, "macro.dbt_utils.test_equality": {"name": "test_equality", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/generic_tests/equality.sql", "original_file_path": "macros/generic_tests/equality.sql", "unique_id": "macro.dbt_utils.test_equality", "macro_sql": "{% test equality(model, compare_model, compare_columns=None, exclude_columns=None, precision = None) %}\n  {{ return(adapter.dispatch('test_equality', 'dbt_utils')(model, compare_model, compare_columns, exclude_columns, precision)) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_utils.default__test_equality"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.411807, "supported_languages": null}, "macro.dbt_utils.default__test_equality": {"name": "default__test_equality", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/generic_tests/equality.sql", "original_file_path": "macros/generic_tests/equality.sql", "unique_id": "macro.dbt_utils.default__test_equality", "macro_sql": "{% macro default__test_equality(model, compare_model, compare_columns=None, exclude_columns=None, precision = None) %}\n\n{%- if compare_columns and exclude_columns -%}\n    {{ exceptions.raise_compiler_error(\"Both a compare and an ignore list were provided to the `equality` macro. Only one is allowed\") }}\n{%- endif -%}\n\n{% set set_diff %}\n    count(*) + coalesce(abs(\n        sum(case when which_diff = 'a_minus_b' then 1 else 0 end) -\n        sum(case when which_diff = 'b_minus_a' then 1 else 0 end)\n    ), 0)\n{% endset %}\n\n{#-- Needs to be set at parse time, before we return '' below --#}\n{{ config(fail_calc = set_diff) }}\n\n{#-- Prevent querying of db in parsing mode. This works because this macro does not create any new refs. #}\n{%- if not execute -%}\n    {{ return('') }}\n{% endif %}\n\n\n\n-- setup\n{%- do dbt_utils._is_relation(model, 'test_equality') -%}\n\n{# Ensure there are no extra columns in the compare_model vs model #}\n{%- if not compare_columns -%}\n    {%- do dbt_utils._is_ephemeral(model, 'test_equality') -%}\n    {%- do dbt_utils._is_ephemeral(compare_model, 'test_equality') -%}\n\n    {%- set model_columns = adapter.get_columns_in_relation(model) -%}\n    {%- set compare_model_columns = adapter.get_columns_in_relation(compare_model) -%}\n\n\n    {%- if exclude_columns -%}\n        {#-- Lower case ignore columns for easier comparison --#}\n        {%- set exclude_columns = exclude_columns | map(\"lower\") | list %}\n\n        {# Filter out the excluded columns #}\n        {%- set include_columns = [] %}\n        {%- set include_model_columns = [] %}\n        {%- for column in model_columns -%}\n            {%- if column.name | lower not in exclude_columns -%}\n                {% do include_columns.append(column) %}\n            {%- endif %}\n        {%- endfor %}\n        {%- for column in compare_model_columns -%}\n            {%- if column.name | lower not in exclude_columns -%}\n                {% do include_model_columns.append(column) %}\n            {%- endif %}\n        {%- endfor %}\n\n        {%- set compare_columns_set = set(include_columns | map(attribute='quoted') | map(\"lower\")) %}\n        {%- set compare_model_columns_set = set(include_model_columns | map(attribute='quoted') | map(\"lower\")) %}\n    {%- else -%}\n        {%- set compare_columns_set = set(model_columns | map(attribute='quoted') | map(\"lower\")) %}\n        {%- set compare_model_columns_set = set(compare_model_columns | map(attribute='quoted') | map(\"lower\")) %}\n    {%- endif -%}\n\n    {% if compare_columns_set != compare_model_columns_set %}\n        {{ exceptions.raise_compiler_error(compare_model ~\" has less columns than \" ~ model ~ \", please ensure they have the same columns or use the `compare_columns` or `exclude_columns` arguments to subset them.\") }}\n    {% endif %}\n\n\n{% endif %}\n\n{%- if not precision -%}\n    {%- if not compare_columns -%}\n        {# \n            You cannot get the columns in an ephemeral model (due to not existing in the information schema),\n            so if the user does not provide an explicit list of columns we must error in the case it is ephemeral\n        #}\n        {%- do dbt_utils._is_ephemeral(model, 'test_equality') -%}\n        {%- set compare_columns = adapter.get_columns_in_relation(model)-%}\n\n        {%- if exclude_columns -%}\n            {#-- Lower case ignore columns for easier comparison --#}\n            {%- set exclude_columns = exclude_columns | map(\"lower\") | list %}\n\n            {# Filter out the excluded columns #}\n            {%- set include_columns = [] %}\n            {%- for column in compare_columns -%}\n                {%- if column.name | lower not in exclude_columns -%}\n                    {% do include_columns.append(column) %}\n                {%- endif %}\n            {%- endfor %}\n\n            {%- set compare_columns = include_columns | map(attribute='quoted') %}\n        {%- else -%} {# Compare columns provided #}\n            {%- set compare_columns = compare_columns | map(attribute='quoted') %}\n        {%- endif -%}\n    {%- endif -%}\n\n    {% set compare_cols_csv = compare_columns | join(', ') %}\n\n{% else %} {# Precision required #}\n    {#-\n        If rounding is required, we need to get the types, so it cannot be ephemeral even if they provide column names\n    -#}\n    {%- do dbt_utils._is_ephemeral(model, 'test_equality') -%}\n    {%- set columns = adapter.get_columns_in_relation(model) -%}\n\n    {% set columns_list = [] %}\n    {%- for col in columns -%}\n        {%- if (\n                (col.name|lower in compare_columns|map('lower') or not compare_columns) and\n                (col.name|lower not in exclude_columns|map('lower') or not exclude_columns)\n                ) -%}\n            {# Databricks double type is not picked up by any number type checks in dbt #}\n            {%- if col.is_float() or col.is_numeric() or col.data_type == 'double' -%}\n                {# Cast is required due to postgres not having round for a double precision number #}\n                {%- do columns_list.append('round(cast(' ~ col.quoted ~ ' as ' ~ dbt.type_numeric() ~ '),' ~ precision ~ ') as ' ~ col.quoted) -%}\n            {%- else -%} {# Non-numeric type #}\n                {%- do columns_list.append(col.quoted) -%}\n            {%- endif -%}\n        {% endif %}\n    {%- endfor -%}\n\n    {% set compare_cols_csv = columns_list | join(', ') %}\n\n{% endif %}\n\nwith a as (\n\n    select * from {{ model }}\n\n),\n\nb as (\n\n    select * from {{ compare_model }}\n\n),\n\na_minus_b as (\n\n    select {{compare_cols_csv}} from a\n    {{ dbt.except() }}\n    select {{compare_cols_csv}} from b\n\n),\n\nb_minus_a as (\n\n    select {{compare_cols_csv}} from b\n    {{ dbt.except() }}\n    select {{compare_cols_csv}} from a\n\n),\n\nunioned as (\n\n    select 'a_minus_b' as which_diff, a_minus_b.* from a_minus_b\n    union all\n    select 'b_minus_a' as which_diff, b_minus_a.* from b_minus_a\n\n)\n\nselect * from unioned\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils._is_relation", "macro.dbt_utils._is_ephemeral", "macro.dbt.type_numeric", "macro.dbt.except"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4143171, "supported_languages": null}, "macro.dbt_utils.test_not_empty_string": {"name": "test_not_empty_string", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/generic_tests/not_empty_string.sql", "original_file_path": "macros/generic_tests/not_empty_string.sql", "unique_id": "macro.dbt_utils.test_not_empty_string", "macro_sql": "{% test not_empty_string(model, column_name, trim_whitespace=true) %}\n\n  {{ return(adapter.dispatch('test_not_empty_string', 'dbt_utils')(model, column_name, trim_whitespace)) }}\n\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_utils.default__test_not_empty_string"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.414554, "supported_languages": null}, "macro.dbt_utils.default__test_not_empty_string": {"name": "default__test_not_empty_string", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/generic_tests/not_empty_string.sql", "original_file_path": "macros/generic_tests/not_empty_string.sql", "unique_id": "macro.dbt_utils.default__test_not_empty_string", "macro_sql": "{% macro default__test_not_empty_string(model, column_name, trim_whitespace=true) %}\n\n    with\n    \n    all_values as (\n\n        select \n\n\n            {% if trim_whitespace == true -%}\n\n                trim({{ column_name }}) as {{ column_name }}\n\n            {%- else -%}\n\n                {{ column_name }}\n\n            {%- endif %}\n            \n        from {{ model }}\n\n    ),\n\n    errors as (\n\n        select * from all_values\n        where {{ column_name }} = ''\n\n    )\n\n    select * from errors\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4147332, "supported_languages": null}, "macro.dbt_utils.test_mutually_exclusive_ranges": {"name": "test_mutually_exclusive_ranges", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/generic_tests/mutually_exclusive_ranges.sql", "original_file_path": "macros/generic_tests/mutually_exclusive_ranges.sql", "unique_id": "macro.dbt_utils.test_mutually_exclusive_ranges", "macro_sql": "{% test mutually_exclusive_ranges(model, lower_bound_column, upper_bound_column, partition_by=None, gaps='allowed', zero_length_range_allowed=False) %}\n  {{ return(adapter.dispatch('test_mutually_exclusive_ranges', 'dbt_utils')(model, lower_bound_column, upper_bound_column, partition_by, gaps, zero_length_range_allowed)) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_utils.default__test_mutually_exclusive_ranges"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.415227, "supported_languages": null}, "macro.dbt_utils.default__test_mutually_exclusive_ranges": {"name": "default__test_mutually_exclusive_ranges", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/generic_tests/mutually_exclusive_ranges.sql", "original_file_path": "macros/generic_tests/mutually_exclusive_ranges.sql", "unique_id": "macro.dbt_utils.default__test_mutually_exclusive_ranges", "macro_sql": "{% macro default__test_mutually_exclusive_ranges(model, lower_bound_column, upper_bound_column, partition_by=None, gaps='allowed', zero_length_range_allowed=False) %}\n{% if gaps == 'not_allowed' %}\n    {% set allow_gaps_operator='=' %}\n    {% set allow_gaps_operator_in_words='equal_to' %}\n{% elif gaps == 'allowed' %}\n    {% set allow_gaps_operator='<=' %}\n    {% set allow_gaps_operator_in_words='less_than_or_equal_to' %}\n{% elif gaps == 'required' %}\n    {% set allow_gaps_operator='<' %}\n    {% set allow_gaps_operator_in_words='less_than' %}\n{% else %}\n    {{ exceptions.raise_compiler_error(\n        \"`gaps` argument for mutually_exclusive_ranges test must be one of ['not_allowed', 'allowed', 'required'] Got: '\" ~ gaps ~\"'.'\"\n    ) }}\n{% endif %}\n{% if not zero_length_range_allowed %}\n    {% set allow_zero_length_operator='<' %}\n    {% set allow_zero_length_operator_in_words='less_than' %}\n{% elif zero_length_range_allowed %}\n    {% set allow_zero_length_operator='<=' %}\n    {% set allow_zero_length_operator_in_words='less_than_or_equal_to' %}\n{% else %}\n    {{ exceptions.raise_compiler_error(\n        \"`zero_length_range_allowed` argument for mutually_exclusive_ranges test must be one of [true, false] Got: '\" ~ zero_length_range_allowed ~\"'.'\"\n    ) }}\n{% endif %}\n\n{% set partition_clause=\"partition by \" ~ partition_by if partition_by else '' %}\n\nwith window_functions as (\n\n    select\n        {% if partition_by %}\n        {{ partition_by }} as partition_by_col,\n        {% endif %}\n        {{ lower_bound_column }} as lower_bound,\n        {{ upper_bound_column }} as upper_bound,\n\n        lead({{ lower_bound_column }}) over (\n            {{ partition_clause }}\n            order by {{ lower_bound_column }}, {{ upper_bound_column }}\n        ) as next_lower_bound,\n\n        row_number() over (\n            {{ partition_clause }}\n            order by {{ lower_bound_column }} desc, {{ upper_bound_column }} desc\n        ) = 1 as is_last_record\n\n    from {{ model }}\n\n),\n\ncalc as (\n    -- We want to return records where one of our assumptions fails, so we'll use\n    -- the `not` function with `and` statements so we can write our assumptions more cleanly\n    select\n        *,\n\n        -- For each record: lower_bound should be < upper_bound.\n        -- Coalesce it to return an error on the null case (implicit assumption\n        -- these columns are not_null)\n        coalesce(\n            lower_bound {{ allow_zero_length_operator }} upper_bound,\n            false\n        ) as lower_bound_{{ allow_zero_length_operator_in_words }}_upper_bound,\n\n        -- For each record: upper_bound {{ allow_gaps_operator }} the next lower_bound.\n        -- Coalesce it to handle null cases for the last record.\n        coalesce(\n            upper_bound {{ allow_gaps_operator }} next_lower_bound,\n            is_last_record,\n            false\n        ) as upper_bound_{{ allow_gaps_operator_in_words }}_next_lower_bound\n\n    from window_functions\n\n),\n\nvalidation_errors as (\n\n    select\n        *\n    from calc\n\n    where not(\n        -- THE FOLLOWING SHOULD BE TRUE --\n        lower_bound_{{ allow_zero_length_operator_in_words }}_upper_bound\n        and upper_bound_{{ allow_gaps_operator_in_words }}_next_lower_bound\n    )\n)\n\nselect * from validation_errors\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.416354, "supported_languages": null}, "macro.dbt_utils.pretty_log_format": {"name": "pretty_log_format", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/jinja_helpers/pretty_log_format.sql", "original_file_path": "macros/jinja_helpers/pretty_log_format.sql", "unique_id": "macro.dbt_utils.pretty_log_format", "macro_sql": "{% macro pretty_log_format(message) %}\n    {{ return(adapter.dispatch('pretty_log_format', 'dbt_utils')(message)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.default__pretty_log_format"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4165592, "supported_languages": null}, "macro.dbt_utils.default__pretty_log_format": {"name": "default__pretty_log_format", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/jinja_helpers/pretty_log_format.sql", "original_file_path": "macros/jinja_helpers/pretty_log_format.sql", "unique_id": "macro.dbt_utils.default__pretty_log_format", "macro_sql": "{% macro default__pretty_log_format(message) %}\n    {{ return( dbt_utils.pretty_time() ~ ' + ' ~ message) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.pretty_time"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.416662, "supported_languages": null}, "macro.dbt_utils._is_relation": {"name": "_is_relation", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/jinja_helpers/_is_relation.sql", "original_file_path": "macros/jinja_helpers/_is_relation.sql", "unique_id": "macro.dbt_utils._is_relation", "macro_sql": "{% macro _is_relation(obj, macro) %}\n    {%- if not (obj is mapping and obj.get('metadata', {}).get('type', '').endswith('Relation')) -%}\n        {%- do exceptions.raise_compiler_error(\"Macro \" ~ macro ~ \" expected a Relation but received the value: \" ~ obj) -%}\n    {%- endif -%}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.41693, "supported_languages": null}, "macro.dbt_utils.pretty_time": {"name": "pretty_time", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/jinja_helpers/pretty_time.sql", "original_file_path": "macros/jinja_helpers/pretty_time.sql", "unique_id": "macro.dbt_utils.pretty_time", "macro_sql": "{% macro pretty_time(format='%H:%M:%S') %}\n    {{ return(adapter.dispatch('pretty_time', 'dbt_utils')(format)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.default__pretty_time"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.417093, "supported_languages": null}, "macro.dbt_utils.default__pretty_time": {"name": "default__pretty_time", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/jinja_helpers/pretty_time.sql", "original_file_path": "macros/jinja_helpers/pretty_time.sql", "unique_id": "macro.dbt_utils.default__pretty_time", "macro_sql": "{% macro default__pretty_time(format='%H:%M:%S') %}\n    {{ return(modules.datetime.datetime.now().strftime(format)) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.417205, "supported_languages": null}, "macro.dbt_utils.log_info": {"name": "log_info", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/jinja_helpers/log_info.sql", "original_file_path": "macros/jinja_helpers/log_info.sql", "unique_id": "macro.dbt_utils.log_info", "macro_sql": "{% macro log_info(message) %}\n    {{ return(adapter.dispatch('log_info', 'dbt_utils')(message)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.default__log_info"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.417352, "supported_languages": null}, "macro.dbt_utils.default__log_info": {"name": "default__log_info", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/jinja_helpers/log_info.sql", "original_file_path": "macros/jinja_helpers/log_info.sql", "unique_id": "macro.dbt_utils.default__log_info", "macro_sql": "{% macro default__log_info(message) %}\n    {{ log(dbt_utils.pretty_log_format(message), info=True) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.pretty_log_format"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.417453, "supported_languages": null}, "macro.dbt_utils.slugify": {"name": "slugify", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/jinja_helpers/slugify.sql", "original_file_path": "macros/jinja_helpers/slugify.sql", "unique_id": "macro.dbt_utils.slugify", "macro_sql": "{% macro slugify(string) %}\n\n{% if not string %}\n{{ return('') }}\n{% endif %}\n\n{#- Lower case the string -#}\n{% set string = string | lower %}\n{#- Replace spaces and dashes with underscores -#}\n{% set string = modules.re.sub('[ -]+', '_', string) %}\n{#- Only take letters, numbers, and underscores -#}\n{% set string = modules.re.sub('[^a-z0-9_]+', '', string) %}\n{#- Prepends \"_\" if string begins with a number -#}\n{% set string = modules.re.sub('^[0-9]', '_' + string[0], string) %}\n\n{{ return(string) }}\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.417878, "supported_languages": null}, "macro.dbt_utils._is_ephemeral": {"name": "_is_ephemeral", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/jinja_helpers/_is_ephemeral.sql", "original_file_path": "macros/jinja_helpers/_is_ephemeral.sql", "unique_id": "macro.dbt_utils._is_ephemeral", "macro_sql": "{% macro _is_ephemeral(obj, macro) %}\n    {%- if obj.is_cte -%}\n        {% set ephemeral_prefix = api.Relation.add_ephemeral_prefix('') %}\n        {% if obj.name.startswith(ephemeral_prefix) %}\n            {% set model_name = obj.name[(ephemeral_prefix|length):] %}\n        {% else %}\n            {% set model_name = obj.name %}\n        {%- endif -%}\n        {% set error_message %}\nThe `{{ macro }}` macro cannot be used with ephemeral models, as it relies on the information schema.\n\n`{{ model_name }}` is an ephemeral model. Consider making it a view or table instead.\n        {% endset %}\n        {%- do exceptions.raise_compiler_error(error_message) -%}\n    {%- endif -%}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.418289, "supported_languages": null}, "macro.dbt_utils.get_intervals_between": {"name": "get_intervals_between", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/date_spine.sql", "original_file_path": "macros/sql/date_spine.sql", "unique_id": "macro.dbt_utils.get_intervals_between", "macro_sql": "{% macro get_intervals_between(start_date, end_date, datepart) -%}\n    {{ return(adapter.dispatch('get_intervals_between', 'dbt_utils')(start_date, end_date, datepart)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.default__get_intervals_between"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.418567, "supported_languages": null}, "macro.dbt_utils.default__get_intervals_between": {"name": "default__get_intervals_between", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/date_spine.sql", "original_file_path": "macros/sql/date_spine.sql", "unique_id": "macro.dbt_utils.default__get_intervals_between", "macro_sql": "{% macro default__get_intervals_between(start_date, end_date, datepart) -%}\n    {%- call statement('get_intervals_between', fetch_result=True) %}\n\n        select {{ dbt.datediff(start_date, end_date, datepart) }}\n\n    {%- endcall -%}\n\n    {%- set value_list = load_result('get_intervals_between') -%}\n\n    {%- if value_list and value_list['data'] -%}\n        {%- set values = value_list['data'] | map(attribute=0) | list %}\n        {{ return(values[0]) }}\n    {%- else -%}\n        {{ return(1) }}\n    {%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt.datediff"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.418901, "supported_languages": null}, "macro.dbt_utils.date_spine": {"name": "date_spine", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/date_spine.sql", "original_file_path": "macros/sql/date_spine.sql", "unique_id": "macro.dbt_utils.date_spine", "macro_sql": "{% macro date_spine(datepart, start_date, end_date) %}\n    {{ return(adapter.dispatch('date_spine', 'dbt_utils')(datepart, start_date, end_date)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.default__date_spine"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.419038, "supported_languages": null}, "macro.dbt_utils.default__date_spine": {"name": "default__date_spine", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/date_spine.sql", "original_file_path": "macros/sql/date_spine.sql", "unique_id": "macro.dbt_utils.default__date_spine", "macro_sql": "{% macro default__date_spine(datepart, start_date, end_date) %}\n\n\n{# call as follows:\n\ndate_spine(\n    \"day\",\n    \"to_date('01/01/2016', 'mm/dd/yyyy')\",\n    \"dbt.dateadd(week, 1, current_date)\"\n) #}\n\n\nwith rawdata as (\n\n    {{dbt_utils.generate_series(\n        dbt_utils.get_intervals_between(start_date, end_date, datepart)\n    )}}\n\n),\n\nall_periods as (\n\n    select (\n        {{\n            dbt.dateadd(\n                datepart,\n                \"row_number() over (order by generated_number) - 1\",\n                start_date\n            )\n        }}\n    ) as date_{{datepart}}\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_{{datepart}} <= {{ end_date }}\n\n)\n\nselect * from filtered\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.generate_series", "macro.dbt_utils.get_intervals_between", "macro.dbt.dateadd"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.419248, "supported_languages": null}, "macro.dbt_utils.safe_subtract": {"name": "safe_subtract", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/safe_subtract.sql", "original_file_path": "macros/sql/safe_subtract.sql", "unique_id": "macro.dbt_utils.safe_subtract", "macro_sql": "{%- macro safe_subtract(field_list) -%}\n    {{ return(adapter.dispatch('safe_subtract', 'dbt_utils')(field_list)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.default__safe_subtract"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.419441, "supported_languages": null}, "macro.dbt_utils.default__safe_subtract": {"name": "default__safe_subtract", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/safe_subtract.sql", "original_file_path": "macros/sql/safe_subtract.sql", "unique_id": "macro.dbt_utils.default__safe_subtract", "macro_sql": "\n\n{%- macro default__safe_subtract(field_list) -%}\n\n{%- if field_list is not iterable or field_list is string or field_list is mapping -%}\n\n{%- set error_message = '\nWarning: the `safe_subtract` macro takes a single list argument instead of \\\nstring arguments. The {}.{} model triggered this warning. \\\n'.format(model.package_name, model.name) -%}\n\n{%- do exceptions.raise_compiler_error(error_message) -%}\n\n{%- endif -%}\n\n{% set fields = [] %}\n\n{%- for field in field_list -%}\n\n    {% do fields.append(\"coalesce(\" ~ field ~ \", 0)\") %}\n\n{%- endfor -%}\n\n{{ fields|join(' -\\n  ') }}\n\n{%- endmacro -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.419755, "supported_languages": null}, "macro.dbt_utils.nullcheck_table": {"name": "nullcheck_table", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/nullcheck_table.sql", "original_file_path": "macros/sql/nullcheck_table.sql", "unique_id": "macro.dbt_utils.nullcheck_table", "macro_sql": "{% macro nullcheck_table(relation) %}\n    {{ return(adapter.dispatch('nullcheck_table', 'dbt_utils')(relation)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.default__nullcheck_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.419928, "supported_languages": null}, "macro.dbt_utils.default__nullcheck_table": {"name": "default__nullcheck_table", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/nullcheck_table.sql", "original_file_path": "macros/sql/nullcheck_table.sql", "unique_id": "macro.dbt_utils.default__nullcheck_table", "macro_sql": "{% macro default__nullcheck_table(relation) %}\n\n  {%- do dbt_utils._is_relation(relation, 'nullcheck_table') -%}\n  {%- do dbt_utils._is_ephemeral(relation, 'nullcheck_table') -%}\n  {% set cols = adapter.get_columns_in_relation(relation) %}\n\n  select {{ dbt_utils.nullcheck(cols) }}\n  from {{relation}}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils._is_relation", "macro.dbt_utils._is_ephemeral", "macro.dbt_utils.nullcheck"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.420126, "supported_languages": null}, "macro.dbt_utils.get_relations_by_pattern": {"name": "get_relations_by_pattern", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/get_relations_by_pattern.sql", "original_file_path": "macros/sql/get_relations_by_pattern.sql", "unique_id": "macro.dbt_utils.get_relations_by_pattern", "macro_sql": "{% macro get_relations_by_pattern(schema_pattern, table_pattern, exclude='', database=target.database) %}\n    {{ return(adapter.dispatch('get_relations_by_pattern', 'dbt_utils')(schema_pattern, table_pattern, exclude, database)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.default__get_relations_by_pattern"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.420398, "supported_languages": null}, "macro.dbt_utils.default__get_relations_by_pattern": {"name": "default__get_relations_by_pattern", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/get_relations_by_pattern.sql", "original_file_path": "macros/sql/get_relations_by_pattern.sql", "unique_id": "macro.dbt_utils.default__get_relations_by_pattern", "macro_sql": "{% macro default__get_relations_by_pattern(schema_pattern, table_pattern, exclude='', database=target.database) %}\n\n    {%- call statement('get_tables', fetch_result=True) %}\n\n      {{ dbt_utils.get_tables_by_pattern_sql(schema_pattern, table_pattern, exclude, database) }}\n\n    {%- endcall -%}\n\n    {%- set table_list = load_result('get_tables') -%}\n\n    {%- if table_list and table_list['table'] -%}\n        {%- set tbl_relations = [] -%}\n        {%- for row in table_list['table'] -%}\n            {%- set tbl_relation = api.Relation.create(\n                database=database,\n                schema=row.table_schema,\n                identifier=row.table_name,\n                type=row.table_type\n            ) -%}\n            {%- do tbl_relations.append(tbl_relation) -%}\n        {%- endfor -%}\n\n        {{ return(tbl_relations) }}\n    {%- else -%}\n        {{ return([]) }}\n    {%- endif -%}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt_utils.get_tables_by_pattern_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.420892, "supported_languages": null}, "macro.dbt_utils.get_powers_of_two": {"name": "get_powers_of_two", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/generate_series.sql", "original_file_path": "macros/sql/generate_series.sql", "unique_id": "macro.dbt_utils.get_powers_of_two", "macro_sql": "{% macro get_powers_of_two(upper_bound) %}\n    {{ return(adapter.dispatch('get_powers_of_two', 'dbt_utils')(upper_bound)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.default__get_powers_of_two"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4211462, "supported_languages": null}, "macro.dbt_utils.default__get_powers_of_two": {"name": "default__get_powers_of_two", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/generate_series.sql", "original_file_path": "macros/sql/generate_series.sql", "unique_id": "macro.dbt_utils.default__get_powers_of_two", "macro_sql": "{% macro default__get_powers_of_two(upper_bound) %}\n\n    {% if upper_bound <= 0 %}\n    {{ exceptions.raise_compiler_error(\"upper bound must be positive\") }}\n    {% endif %}\n\n    {% for _ in range(1, 100) %}\n       {% if upper_bound <= 2 ** loop.index %}{{ return(loop.index) }}{% endif %}\n    {% endfor %}\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.42139, "supported_languages": null}, "macro.dbt_utils.generate_series": {"name": "generate_series", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/generate_series.sql", "original_file_path": "macros/sql/generate_series.sql", "unique_id": "macro.dbt_utils.generate_series", "macro_sql": "{% macro generate_series(upper_bound) %}\n    {{ return(adapter.dispatch('generate_series', 'dbt_utils')(upper_bound)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.default__generate_series"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4215019, "supported_languages": null}, "macro.dbt_utils.default__generate_series": {"name": "default__generate_series", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/generate_series.sql", "original_file_path": "macros/sql/generate_series.sql", "unique_id": "macro.dbt_utils.default__generate_series", "macro_sql": "{% macro default__generate_series(upper_bound) %}\n\n    {% set n = dbt_utils.get_powers_of_two(upper_bound) %}\n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    {% for i in range(n) %}\n    p{{i}}.generated_number * power(2, {{i}})\n    {% if not loop.last %} + {% endif %}\n    {% endfor %}\n    + 1\n    as generated_number\n\n    from\n\n    {% for i in range(n) %}\n    p as p{{i}}\n    {% if not loop.last %} cross join {% endif %}\n    {% endfor %}\n\n    )\n\n    select *\n    from unioned\n    where generated_number <= {{upper_bound}}\n    order by generated_number\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.get_powers_of_two"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4218, "supported_languages": null}, "macro.dbt_utils.get_relations_by_prefix": {"name": "get_relations_by_prefix", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/get_relations_by_prefix.sql", "original_file_path": "macros/sql/get_relations_by_prefix.sql", "unique_id": "macro.dbt_utils.get_relations_by_prefix", "macro_sql": "{% macro get_relations_by_prefix(schema, prefix, exclude='', database=target.database) %}\n    {{ return(adapter.dispatch('get_relations_by_prefix', 'dbt_utils')(schema, prefix, exclude, database)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.default__get_relations_by_prefix"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4220731, "supported_languages": null}, "macro.dbt_utils.default__get_relations_by_prefix": {"name": "default__get_relations_by_prefix", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/get_relations_by_prefix.sql", "original_file_path": "macros/sql/get_relations_by_prefix.sql", "unique_id": "macro.dbt_utils.default__get_relations_by_prefix", "macro_sql": "{% macro default__get_relations_by_prefix(schema, prefix, exclude='', database=target.database) %}\n\n    {%- call statement('get_tables', fetch_result=True) %}\n\n      {{ dbt_utils.get_tables_by_prefix_sql(schema, prefix, exclude, database) }}\n\n    {%- endcall -%}\n\n    {%- set table_list = load_result('get_tables') -%}\n\n    {%- if table_list and table_list['table'] -%}\n        {%- set tbl_relations = [] -%}\n        {%- for row in table_list['table'] -%}\n            {%- set tbl_relation = api.Relation.create(\n                database=database,\n                schema=row.table_schema,\n                identifier=row.table_name,\n                type=row.table_type\n            ) -%}\n            {%- do tbl_relations.append(tbl_relation) -%}\n        {%- endfor -%}\n\n        {{ return(tbl_relations) }}\n    {%- else -%}\n        {{ return([]) }}\n    {%- endif -%}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt_utils.get_tables_by_prefix_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.422543, "supported_languages": null}, "macro.dbt_utils.get_tables_by_prefix_sql": {"name": "get_tables_by_prefix_sql", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/get_tables_by_prefix_sql.sql", "original_file_path": "macros/sql/get_tables_by_prefix_sql.sql", "unique_id": "macro.dbt_utils.get_tables_by_prefix_sql", "macro_sql": "{% macro get_tables_by_prefix_sql(schema, prefix, exclude='', database=target.database) %}\n    {{ return(adapter.dispatch('get_tables_by_prefix_sql', 'dbt_utils')(schema, prefix, exclude, database)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.default__get_tables_by_prefix_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4227672, "supported_languages": null}, "macro.dbt_utils.default__get_tables_by_prefix_sql": {"name": "default__get_tables_by_prefix_sql", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/get_tables_by_prefix_sql.sql", "original_file_path": "macros/sql/get_tables_by_prefix_sql.sql", "unique_id": "macro.dbt_utils.default__get_tables_by_prefix_sql", "macro_sql": "{% macro default__get_tables_by_prefix_sql(schema, prefix, exclude='', database=target.database) %}\n\n    {{ dbt_utils.get_tables_by_pattern_sql(\n        schema_pattern = schema,\n        table_pattern = prefix ~ '%',\n        exclude = exclude,\n        database = database\n    ) }}\n    \n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.get_tables_by_pattern_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.422934, "supported_languages": null}, "macro.dbt_utils.star": {"name": "star", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/star.sql", "original_file_path": "macros/sql/star.sql", "unique_id": "macro.dbt_utils.star", "macro_sql": "{% macro star(from, relation_alias=False, except=[], prefix='', suffix='', quote_identifiers=True) -%}\r\n    {{ return(adapter.dispatch('star', 'dbt_utils')(from, relation_alias, except, prefix, suffix, quote_identifiers)) }}\r\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.default__star"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4233432, "supported_languages": null}, "macro.dbt_utils.default__star": {"name": "default__star", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/star.sql", "original_file_path": "macros/sql/star.sql", "unique_id": "macro.dbt_utils.default__star", "macro_sql": "{% macro default__star(from, relation_alias=False, except=[], prefix='', suffix='', quote_identifiers=True) -%}\r\n    {%- do dbt_utils._is_relation(from, 'star') -%}\r\n    {%- do dbt_utils._is_ephemeral(from, 'star') -%}\r\n\r\n    {#-- Prevent querying of db in parsing mode. This works because this macro does not create any new refs. #}\r\n    {%- if not execute -%}\r\n        {% do return('*') %}\r\n    {%- endif -%}\r\n\r\n    {% set cols = dbt_utils.get_filtered_columns_in_relation(from, except) %}\r\n\r\n    {%- if cols|length <= 0 -%}\r\n        {% if flags.WHICH == 'compile' %}\r\n            {% set response %}\r\n*\r\n/* No columns were returned. Maybe the relation doesn't exist yet \r\nor all columns were excluded. This star is only output during  \r\ndbt compile, and exists to keep SQLFluff happy. */\r\n            {% endset %}\r\n            {% do return(response) %}\r\n        {% else %}\r\n            {% do return(\"/* no columns returned from star() macro */\") %}\r\n        {% endif %}\r\n    {%- else -%}\r\n        {%- for col in cols %}\r\n            {%- if relation_alias %}{{ relation_alias }}.{% else %}{%- endif -%}\r\n                {%- if quote_identifiers -%}\r\n                    {{ adapter.quote(col)|trim }} {%- if prefix!='' or suffix!='' %} as {{ adapter.quote(prefix ~ col ~ suffix)|trim }} {%- endif -%}\r\n                {%- else -%}\r\n                    {{ col|trim }} {%- if prefix!='' or suffix!='' %} as {{ (prefix ~ col ~ suffix)|trim }} {%- endif -%}\r\n                {% endif %}\r\n            {%- if not loop.last %},{{ '\\n  ' }}{%- endif -%}\r\n        {%- endfor -%}\r\n    {% endif %}\r\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_utils._is_relation", "macro.dbt_utils._is_ephemeral", "macro.dbt_utils.get_filtered_columns_in_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4241369, "supported_languages": null}, "macro.dbt_utils.unpivot": {"name": "unpivot", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/unpivot.sql", "original_file_path": "macros/sql/unpivot.sql", "unique_id": "macro.dbt_utils.unpivot", "macro_sql": "{% macro unpivot(relation=none, cast_to='varchar', exclude=none, remove=none, field_name='field_name', value_name='value', quote_identifiers=False) -%}\n    {{ return(adapter.dispatch('unpivot', 'dbt_utils')(relation, cast_to, exclude, remove, field_name, value_name, quote_identifiers)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.default__unpivot"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.424584, "supported_languages": null}, "macro.dbt_utils.default__unpivot": {"name": "default__unpivot", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/unpivot.sql", "original_file_path": "macros/sql/unpivot.sql", "unique_id": "macro.dbt_utils.default__unpivot", "macro_sql": "{% macro default__unpivot(relation=none, cast_to='varchar', exclude=none, remove=none, field_name='field_name', value_name='value', quote_identifiers=False) -%}\n\n    {% if not relation %}\n        {{ exceptions.raise_compiler_error(\"Error: argument `relation` is required for `unpivot` macro.\") }}\n    {% endif %}\n\n  {%- set exclude = exclude if exclude is not none else [] %}\n  {%- set remove = remove if remove is not none else [] %}\n\n  {%- set include_cols = [] %}\n\n  {%- set table_columns = {} %}\n\n  {%- do table_columns.update({relation: []}) %}\n\n  {%- do dbt_utils._is_relation(relation, 'unpivot') -%}\n  {%- do dbt_utils._is_ephemeral(relation, 'unpivot') -%}\n  {%- set cols = adapter.get_columns_in_relation(relation) %}\n\n  {%- for col in cols -%}\n    {%- if col.column.lower() not in remove|map('lower') and col.column.lower() not in exclude|map('lower') -%}\n      {% do include_cols.append(col) %}\n    {%- endif %}\n  {%- endfor %}\n\n\n  {%- for col in include_cols -%}\n    {%- set current_col_name = adapter.quote(col.column) if quote_identifiers else col.column -%}\n    select\n      {%- for exclude_col in exclude %}\n        {{ adapter.quote(exclude_col) if quote_identifiers else exclude_col }},\n      {%- endfor %}\n\n      cast('{{ col.column }}' as {{ dbt.type_string() }}) as {{ adapter.quote(field_name) if quote_identifiers else field_name  }},\n      cast(  {% if col.data_type == 'boolean' %}\n           {{ dbt.cast_bool_to_text(current_col_name) }}\n             {% else %}\n           {{ current_col_name }}\n             {% endif %}\n           as {{ cast_to }}) as {{ adapter.quote(value_name) if quote_identifiers else value_name }}\n\n    from {{ relation }}\n\n    {% if not loop.last -%}\n      union all\n    {% endif -%}\n  {%- endfor -%}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_utils._is_relation", "macro.dbt_utils._is_ephemeral", "macro.dbt.type_string", "macro.dbt.cast_bool_to_text"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.425621, "supported_languages": null}, "macro.dbt_utils.safe_divide": {"name": "safe_divide", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/safe_divide.sql", "original_file_path": "macros/sql/safe_divide.sql", "unique_id": "macro.dbt_utils.safe_divide", "macro_sql": "{% macro safe_divide(numerator, denominator) -%}\n  {{ return(adapter.dispatch('safe_divide', 'dbt_utils')(numerator, denominator)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.default__safe_divide"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.425792, "supported_languages": null}, "macro.dbt_utils.default__safe_divide": {"name": "default__safe_divide", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/safe_divide.sql", "original_file_path": "macros/sql/safe_divide.sql", "unique_id": "macro.dbt_utils.default__safe_divide", "macro_sql": "{% macro default__safe_divide(numerator, denominator) %}\n    ( {{ numerator }} ) / nullif( ( {{ denominator }} ), 0)\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.425876, "supported_languages": null}, "macro.dbt_utils.union_relations": {"name": "union_relations", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/union.sql", "original_file_path": "macros/sql/union.sql", "unique_id": "macro.dbt_utils.union_relations", "macro_sql": "{%- macro union_relations(relations, column_override=none, include=[], exclude=[], source_column_name='_dbt_source_relation', where=none) -%}\n    {{ return(adapter.dispatch('union_relations', 'dbt_utils')(relations, column_override, include, exclude, source_column_name, where)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.default__union_relations"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.426493, "supported_languages": null}, "macro.dbt_utils.default__union_relations": {"name": "default__union_relations", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/union.sql", "original_file_path": "macros/sql/union.sql", "unique_id": "macro.dbt_utils.default__union_relations", "macro_sql": "\n\n{%- macro default__union_relations(relations, column_override=none, include=[], exclude=[], source_column_name='_dbt_source_relation', where=none) -%}\n\n    {%- if exclude and include -%}\n        {{ exceptions.raise_compiler_error(\"Both an exclude and include list were provided to the `union` macro. Only one is allowed\") }}\n    {%- endif -%}\n\n    {#-- Prevent querying of db in parsing mode. This works because this macro does not create any new refs. -#}\n    {%- if not execute %}\n        {{ return('') }}\n    {% endif -%}\n\n    {%- set column_override = column_override if column_override is not none else {} -%}\n\n    {%- set relation_columns = {} -%}\n    {%- set column_superset = {} -%}\n    {%- set all_excludes = [] -%}\n    {%- set all_includes = [] -%}\n\n    {%- if exclude -%}\n        {%- for exc in exclude -%}\n            {%- do all_excludes.append(exc | lower) -%}\n        {%- endfor -%}\n    {%- endif -%}\n\n    {%- if include -%}\n        {%- for inc in include -%}\n            {%- do all_includes.append(inc | lower) -%}\n        {%- endfor -%}\n    {%- endif -%}\n\n    {%- for relation in relations -%}\n\n        {%- do relation_columns.update({relation: []}) -%}\n\n        {%- do dbt_utils._is_relation(relation, 'union_relations') -%}\n        {%- do dbt_utils._is_ephemeral(relation, 'union_relations') -%}\n        {%- set cols = adapter.get_columns_in_relation(relation) -%}\n        {%- for col in cols -%}\n\n        {#- If an exclude list was provided and the column is in the list, do nothing -#}\n        {%- if exclude and col.column | lower in all_excludes -%}\n\n        {#- If an include list was provided and the column is not in the list, do nothing -#}\n        {%- elif include and col.column | lower not in all_includes -%}\n\n        {#- Otherwise add the column to the column superset -#}\n        {%- else -%}\n\n            {#- update the list of columns in this relation -#}\n            {%- do relation_columns[relation].append(col.column) -%}\n\n            {%- if col.column in column_superset -%}\n\n                {%- set stored = column_superset[col.column] -%}\n                {%- if col.is_string() and stored.is_string() and col.string_size() > stored.string_size() -%}\n\n                    {%- do column_superset.update({col.column: col}) -%}\n\n                {%- endif %}\n\n            {%- else -%}\n\n                {%- do column_superset.update({col.column: col}) -%}\n\n            {%- endif -%}\n\n        {%- endif -%}\n\n        {%- endfor -%}\n    {%- endfor -%}\n\n    {%- set ordered_column_names = column_superset.keys() -%}\n    {%- set dbt_command = flags.WHICH -%}\n\n\n    {% if dbt_command in ['run', 'build'] %}\n    {% if (include | length > 0 or exclude | length > 0) and not column_superset.keys() %}\n        {%- set relations_string -%}\n            {%- for relation in relations -%}\n                {{ relation.name }}\n            {%- if not loop.last %}, {% endif -%}\n            {%- endfor -%}\n        {%- endset -%}\n\n        {%- set error_message -%}\n            There were no columns found to union for relations {{ relations_string }}\n        {%- endset -%}\n\n        {{ exceptions.raise_compiler_error(error_message) }}\n    {%- endif -%}\n    {%- endif -%}\n\n    {%- for relation in relations %}\n\n        (\n            select\n\n                {%- if source_column_name is not none %}\n                cast({{ dbt.string_literal(relation.render()) }} as {{ dbt.type_string() }}) as {{ source_column_name }},\n                {%- endif %}\n\n                /* No columns from any of the relations.\n                   This star is only output during dbt compile, and exists to keep SQLFluff happy. */\n                {% if dbt_command == 'compile' and ordered_column_names|length == 0 %}\n                    *\n                {% endif %}\n\n                {% for col_name in ordered_column_names -%}\n\n                    {%- set col = column_superset[col_name] %}\n                    {%- set col_type = column_override.get(col.column, col.data_type) %}\n                    {%- set col_name = adapter.quote(col_name) if col_name in relation_columns[relation] else 'null' %}\n                    cast({{ col_name }} as {{ col_type }}) as {{ col.quoted }} {% if not loop.last %},{% endif -%}\n\n                {%- endfor %}\n\n            from {{ relation }}\n\n            {% if where -%}\n            where {{ where }}\n            {%- endif %}\n        )\n\n        {% if not loop.last -%}\n            union all\n        {% endif -%}\n\n    {%- endfor -%}\n\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt_utils._is_relation", "macro.dbt_utils._is_ephemeral", "macro.dbt.string_literal", "macro.dbt.type_string"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.428789, "supported_languages": null}, "macro.dbt_utils.group_by": {"name": "group_by", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/groupby.sql", "original_file_path": "macros/sql/groupby.sql", "unique_id": "macro.dbt_utils.group_by", "macro_sql": "{%- macro group_by(n) -%}\n    {{ return(adapter.dispatch('group_by', 'dbt_utils')(n)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.default__group_by"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.428975, "supported_languages": null}, "macro.dbt_utils.default__group_by": {"name": "default__group_by", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/groupby.sql", "original_file_path": "macros/sql/groupby.sql", "unique_id": "macro.dbt_utils.default__group_by", "macro_sql": "\n\n{%- macro default__group_by(n) -%}\n\n  group by {% for i in range(1, n + 1) -%}\n      {{ i }}{{ ',' if not loop.last }}   \n   {%- endfor -%}\n\n{%- endmacro -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.429128, "supported_languages": null}, "macro.dbt_utils.deduplicate": {"name": "deduplicate", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/deduplicate.sql", "original_file_path": "macros/sql/deduplicate.sql", "unique_id": "macro.dbt_utils.deduplicate", "macro_sql": "{%- macro deduplicate(relation, partition_by, order_by) -%}\n    {{ return(adapter.dispatch('deduplicate', 'dbt_utils')(relation, partition_by, order_by)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.snowflake__deduplicate"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4294689, "supported_languages": null}, "macro.dbt_utils.default__deduplicate": {"name": "default__deduplicate", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/deduplicate.sql", "original_file_path": "macros/sql/deduplicate.sql", "unique_id": "macro.dbt_utils.default__deduplicate", "macro_sql": "\n\n{%- macro default__deduplicate(relation, partition_by, order_by) -%}\n\n    with row_numbered as (\n        select\n            _inner.*,\n            row_number() over (\n                partition by {{ partition_by }}\n                order by {{ order_by }}\n            ) as rn\n        from {{ relation }} as _inner\n    )\n\n    select\n        distinct data.*\n    from {{ relation }} as data\n    {#\n    -- Not all DBs will support natural joins but the ones that do include:\n    -- Oracle, MySQL, SQLite, Redshift, Teradata, Materialize, Databricks\n    -- Apache Spark, SingleStore, Vertica\n    -- Those that do not appear to support natural joins include:\n    -- SQLServer, Trino, Presto, Rockset, Athena\n    #}\n    natural join row_numbered\n    where row_numbered.rn = 1\n\n{%- endmacro -%}\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.429599, "supported_languages": null}, "macro.dbt_utils.redshift__deduplicate": {"name": "redshift__deduplicate", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/deduplicate.sql", "original_file_path": "macros/sql/deduplicate.sql", "unique_id": "macro.dbt_utils.redshift__deduplicate", "macro_sql": "{% macro redshift__deduplicate(relation, partition_by, order_by) -%}\n\n    select *\n    from {{ relation }} as tt\n    qualify\n        row_number() over (\n            partition by {{ partition_by }}\n            order by {{ order_by }}\n        ) = 1\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4297018, "supported_languages": null}, "macro.dbt_utils.postgres__deduplicate": {"name": "postgres__deduplicate", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/deduplicate.sql", "original_file_path": "macros/sql/deduplicate.sql", "unique_id": "macro.dbt_utils.postgres__deduplicate", "macro_sql": "\n{%- macro postgres__deduplicate(relation, partition_by, order_by) -%}\n\n    select\n        distinct on ({{ partition_by }}) *\n    from {{ relation }}\n    order by {{ partition_by }}{{ ',' ~ order_by }}\n\n{%- endmacro -%}\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.429814, "supported_languages": null}, "macro.dbt_utils.snowflake__deduplicate": {"name": "snowflake__deduplicate", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/deduplicate.sql", "original_file_path": "macros/sql/deduplicate.sql", "unique_id": "macro.dbt_utils.snowflake__deduplicate", "macro_sql": "\n{%- macro snowflake__deduplicate(relation, partition_by, order_by) -%}\n\n    select *\n    from {{ relation }}\n    qualify\n        row_number() over (\n            partition by {{ partition_by }}\n            order by {{ order_by }}\n        ) = 1\n\n{%- endmacro -%}\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.429912, "supported_languages": null}, "macro.dbt_utils.databricks__deduplicate": {"name": "databricks__deduplicate", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/deduplicate.sql", "original_file_path": "macros/sql/deduplicate.sql", "unique_id": "macro.dbt_utils.databricks__deduplicate", "macro_sql": "\n{%- macro databricks__deduplicate(relation, partition_by, order_by) -%}\n\n    select *\n    from {{ relation }}\n    qualify\n        row_number() over (\n            partition by {{ partition_by }}\n            order by {{ order_by }}\n        ) = 1\n\n{%- endmacro -%}\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4300108, "supported_languages": null}, "macro.dbt_utils.bigquery__deduplicate": {"name": "bigquery__deduplicate", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/deduplicate.sql", "original_file_path": "macros/sql/deduplicate.sql", "unique_id": "macro.dbt_utils.bigquery__deduplicate", "macro_sql": "\n{%- macro bigquery__deduplicate(relation, partition_by, order_by) -%}\n\n    select unique.*\n    from (\n        select\n            array_agg (\n                original\n                order by {{ order_by }}\n                limit 1\n            )[offset(0)] unique\n        from {{ relation }} original\n        group by {{ partition_by }}\n    )\n\n{%- endmacro -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.430113, "supported_languages": null}, "macro.dbt_utils.surrogate_key": {"name": "surrogate_key", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/surrogate_key.sql", "original_file_path": "macros/sql/surrogate_key.sql", "unique_id": "macro.dbt_utils.surrogate_key", "macro_sql": "{%- macro surrogate_key(field_list) -%}\n    {% set frustrating_jinja_feature = varargs %}\n    {{ return(adapter.dispatch('surrogate_key', 'dbt_utils')(field_list, *varargs)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.default__surrogate_key"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.430314, "supported_languages": null}, "macro.dbt_utils.default__surrogate_key": {"name": "default__surrogate_key", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/surrogate_key.sql", "original_file_path": "macros/sql/surrogate_key.sql", "unique_id": "macro.dbt_utils.default__surrogate_key", "macro_sql": "\n\n{%- macro default__surrogate_key(field_list) -%}\n\n{%- set error_message = '\nWarning: `dbt_utils.surrogate_key` has been replaced by \\\n`dbt_utils.generate_surrogate_key`. The new macro treats null values \\\ndifferently to empty strings. To restore the behaviour of the original \\\nmacro, add a global variable in dbt_project.yml called \\\n`surrogate_key_treat_nulls_as_empty_strings` to your \\\ndbt_project.yml file with a value of True. \\\nThe {}.{} model triggered this warning. \\\n'.format(model.package_name, model.name) -%}\n\n{%- do exceptions.raise_compiler_error(error_message) -%}\n\n{%- endmacro -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4304562, "supported_languages": null}, "macro.dbt_utils.safe_add": {"name": "safe_add", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/safe_add.sql", "original_file_path": "macros/sql/safe_add.sql", "unique_id": "macro.dbt_utils.safe_add", "macro_sql": "{%- macro safe_add(field_list) -%}\n    {{ return(adapter.dispatch('safe_add', 'dbt_utils')(field_list)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.default__safe_add"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.430645, "supported_languages": null}, "macro.dbt_utils.default__safe_add": {"name": "default__safe_add", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/safe_add.sql", "original_file_path": "macros/sql/safe_add.sql", "unique_id": "macro.dbt_utils.default__safe_add", "macro_sql": "\n\n{%- macro default__safe_add(field_list) -%}\n\n{%- if field_list is not iterable or field_list is string or field_list is mapping -%}\n\n{%- set error_message = '\nWarning: the `safe_add` macro now takes a single list argument instead of \\\nstring arguments. The {}.{} model triggered this warning. \\\n'.format(model.package_name, model.name) -%}\n\n{%- do exceptions.warn(error_message) -%}\n\n{%- endif -%}\n\n{% set fields = [] %}\n\n{%- for field in field_list -%}\n\n    {% do fields.append(\"coalesce(\" ~ field ~ \", 0)\") %}\n\n{%- endfor -%}\n\n{{ fields|join(' +\\n  ') }}\n\n{%- endmacro -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4309518, "supported_languages": null}, "macro.dbt_utils.nullcheck": {"name": "nullcheck", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/nullcheck.sql", "original_file_path": "macros/sql/nullcheck.sql", "unique_id": "macro.dbt_utils.nullcheck", "macro_sql": "{% macro nullcheck(cols) %}\n    {{ return(adapter.dispatch('nullcheck', 'dbt_utils')(cols)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.default__nullcheck"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.431133, "supported_languages": null}, "macro.dbt_utils.default__nullcheck": {"name": "default__nullcheck", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/nullcheck.sql", "original_file_path": "macros/sql/nullcheck.sql", "unique_id": "macro.dbt_utils.default__nullcheck", "macro_sql": "{% macro default__nullcheck(cols) %}\n{%- for col in cols %}\n\n    {% if col.is_string() -%}\n\n    nullif({{col.name}},'') as {{col.name}}\n\n    {%- else -%}\n\n    {{col.name}}\n\n    {%- endif -%}\n\n{%- if not loop.last -%} , {%- endif -%}\n\n{%- endfor -%}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.431328, "supported_languages": null}, "macro.dbt_utils.get_tables_by_pattern_sql": {"name": "get_tables_by_pattern_sql", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/get_tables_by_pattern_sql.sql", "original_file_path": "macros/sql/get_tables_by_pattern_sql.sql", "unique_id": "macro.dbt_utils.get_tables_by_pattern_sql", "macro_sql": "{% macro get_tables_by_pattern_sql(schema_pattern, table_pattern, exclude='', database=target.database) %}\n    {{ return(adapter.dispatch('get_tables_by_pattern_sql', 'dbt_utils')\n        (schema_pattern, table_pattern, exclude, database)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.default__get_tables_by_pattern_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.431792, "supported_languages": null}, "macro.dbt_utils.default__get_tables_by_pattern_sql": {"name": "default__get_tables_by_pattern_sql", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/get_tables_by_pattern_sql.sql", "original_file_path": "macros/sql/get_tables_by_pattern_sql.sql", "unique_id": "macro.dbt_utils.default__get_tables_by_pattern_sql", "macro_sql": "{% macro default__get_tables_by_pattern_sql(schema_pattern, table_pattern, exclude='', database=target.database) %}\n\n        select distinct\n            table_schema as {{ adapter.quote('table_schema') }},\n            table_name as {{ adapter.quote('table_name') }},\n            {{ dbt_utils.get_table_types_sql() }}\n        from {{ database }}.information_schema.tables\n        where table_schema ilike '{{ schema_pattern }}'\n        and table_name ilike '{{ table_pattern }}'\n        and table_name not ilike '{{ exclude }}'\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.get_table_types_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.431999, "supported_languages": null}, "macro.dbt_utils.redshift__get_tables_by_pattern_sql": {"name": "redshift__get_tables_by_pattern_sql", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/get_tables_by_pattern_sql.sql", "original_file_path": "macros/sql/get_tables_by_pattern_sql.sql", "unique_id": "macro.dbt_utils.redshift__get_tables_by_pattern_sql", "macro_sql": "{% macro redshift__get_tables_by_pattern_sql(schema_pattern, table_pattern, exclude='', database=target.database) %}\n\n    {% set sql %}\n        select distinct\n            table_schema as {{ adapter.quote('table_schema') }},\n            table_name as {{ adapter.quote('table_name') }},\n            {{ dbt_utils.get_table_types_sql() }}\n        from \"{{ database }}\".\"information_schema\".\"tables\"\n        where table_schema ilike '{{ schema_pattern }}'\n        and table_name ilike '{{ table_pattern }}'\n        and table_name not ilike '{{ exclude }}'\n        union all\n        select distinct\n            schemaname as {{ adapter.quote('table_schema') }},\n            tablename as {{ adapter.quote('table_name') }},\n            'external' as {{ adapter.quote('table_type') }}\n        from svv_external_tables\n        where redshift_database_name = '{{ database }}'\n        and schemaname ilike '{{ schema_pattern }}'\n        and table_name ilike '{{ table_pattern }}'\n        and table_name not ilike '{{ exclude }}'\n    {% endset %}\n\n    {{ return(sql) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.get_table_types_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.432385, "supported_languages": null}, "macro.dbt_utils.bigquery__get_tables_by_pattern_sql": {"name": "bigquery__get_tables_by_pattern_sql", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/get_tables_by_pattern_sql.sql", "original_file_path": "macros/sql/get_tables_by_pattern_sql.sql", "unique_id": "macro.dbt_utils.bigquery__get_tables_by_pattern_sql", "macro_sql": "{% macro bigquery__get_tables_by_pattern_sql(schema_pattern, table_pattern, exclude='', database=target.database) %}\n\n    {% if '%' in schema_pattern %}\n        {% set schemata=dbt_utils._bigquery__get_matching_schemata(schema_pattern, database) %}\n    {% else %}\n        {% set schemata=[schema_pattern] %}\n    {% endif %}\n\n    {% set sql %}\n        {% for schema in schemata %}\n            select distinct\n                table_schema,\n                table_name,\n                {{ dbt_utils.get_table_types_sql() }}\n\n            from {{ adapter.quote(database) }}.{{ schema }}.INFORMATION_SCHEMA.TABLES\n            where lower(table_name) like lower ('{{ table_pattern }}')\n                and lower(table_name) not like lower ('{{ exclude }}')\n\n            {% if not loop.last %} union all {% endif %}\n\n        {% endfor %}\n    {% endset %}\n\n    {{ return(sql) }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils._bigquery__get_matching_schemata", "macro.dbt_utils.get_table_types_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4328, "supported_languages": null}, "macro.dbt_utils._bigquery__get_matching_schemata": {"name": "_bigquery__get_matching_schemata", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/get_tables_by_pattern_sql.sql", "original_file_path": "macros/sql/get_tables_by_pattern_sql.sql", "unique_id": "macro.dbt_utils._bigquery__get_matching_schemata", "macro_sql": "{% macro _bigquery__get_matching_schemata(schema_pattern, database) %}\n    {% if execute %}\n\n        {% set sql %}\n        select schema_name from {{ adapter.quote(database) }}.INFORMATION_SCHEMA.SCHEMATA\n        where lower(schema_name) like lower('{{ schema_pattern }}')\n        {% endset %}\n\n        {% set results=run_query(sql) %}\n\n        {% set schemata=results.columns['schema_name'].values() %}\n\n        {{ return(schemata) }}\n\n    {% else %}\n\n        {{ return([]) }}\n\n    {% endif %}\n\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.433093, "supported_languages": null}, "macro.dbt_utils.get_column_values": {"name": "get_column_values", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/get_column_values.sql", "original_file_path": "macros/sql/get_column_values.sql", "unique_id": "macro.dbt_utils.get_column_values", "macro_sql": "{% macro get_column_values(table, column, order_by='count(*) desc', max_records=none, default=none, where=none) -%}\n    {{ return(adapter.dispatch('get_column_values', 'dbt_utils')(table, column, order_by, max_records, default, where)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.default__get_column_values"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4334989, "supported_languages": null}, "macro.dbt_utils.default__get_column_values": {"name": "default__get_column_values", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/get_column_values.sql", "original_file_path": "macros/sql/get_column_values.sql", "unique_id": "macro.dbt_utils.default__get_column_values", "macro_sql": "{% macro default__get_column_values(table, column, order_by='count(*) desc', max_records=none, default=none, where=none) -%}\n    {#-- Prevent querying of db in parsing mode. This works because this macro does not create any new refs. #}\n    {%- if not execute -%}\n        {% set default = [] if not default %}\n        {{ return(default) }}\n    {% endif %}\n\n    {%- do dbt_utils._is_ephemeral(table, 'get_column_values') -%}\n\n    {# Not all relations are tables. Renaming for internal clarity without breaking functionality for anyone using named arguments #}\n    {# TODO: Change the method signature in a future 0.x.0 release #}\n    {%- set target_relation = table -%}\n\n    {# adapter.load_relation is a convenience wrapper to avoid building a Relation when we already have one #}\n    {% set relation_exists = (load_relation(target_relation)) is not none %}\n\n    {%- call statement('get_column_values', fetch_result=true) %}\n\n        {%- if not relation_exists and default is none -%}\n\n          {{ exceptions.raise_compiler_error(\"In get_column_values(): relation \" ~ target_relation ~ \" does not exist and no default value was provided.\") }}\n\n        {%- elif not relation_exists and default is not none -%}\n\n          {{ log(\"Relation \" ~ target_relation ~ \" does not exist. Returning the default value: \" ~ default) }}\n\n          {{ return(default) }}\n\n        {%- else -%}\n\n\n            select\n                {{ column }} as value\n\n            from {{ target_relation }}\n\n            {% if where is not none %}\n            where {{ where }}\n            {% endif %}\n\n            group by {{ column }}\n            order by {{ order_by }}\n\n            {% if max_records is not none %}\n            limit {{ max_records }}\n            {% endif %}\n\n        {% endif %}\n\n    {%- endcall -%}\n\n    {%- set value_list = load_result('get_column_values') -%}\n\n    {%- if value_list and value_list['data'] -%}\n        {%- set values = value_list['data'] | map(attribute=0) | list %}\n        {{ return(values) }}\n    {%- else -%}\n        {{ return(default) }}\n    {%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_utils._is_ephemeral", "macro.dbt.load_relation", "macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.434588, "supported_languages": null}, "macro.dbt_utils.pivot": {"name": "pivot", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/pivot.sql", "original_file_path": "macros/sql/pivot.sql", "unique_id": "macro.dbt_utils.pivot", "macro_sql": "{% macro pivot(column,\n               values,\n               alias=True,\n               agg='sum',\n               cmp='=',\n               prefix='',\n               suffix='',\n               then_value=1,\n               else_value=0,\n               quote_identifiers=True,\n               distinct=False) %}\n    {{ return(adapter.dispatch('pivot', 'dbt_utils')(column, values, alias, agg, cmp, prefix, suffix, then_value, else_value, quote_identifiers, distinct)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.default__pivot"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.435065, "supported_languages": null}, "macro.dbt_utils.default__pivot": {"name": "default__pivot", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/pivot.sql", "original_file_path": "macros/sql/pivot.sql", "unique_id": "macro.dbt_utils.default__pivot", "macro_sql": "{% macro default__pivot(column,\n               values,\n               alias=True,\n               agg='sum',\n               cmp='=',\n               prefix='',\n               suffix='',\n               then_value=1,\n               else_value=0,\n               quote_identifiers=True,\n               distinct=False) %}\n  {% for value in values %}\n    {{ agg }}(\n      {% if distinct %} distinct {% endif %}\n      case\n      when {{ column }} {{ cmp }} '{{ dbt.escape_single_quotes(value) }}'\n        then {{ then_value }}\n      else {{ else_value }}\n      end\n    )\n    {% if alias %}\n      {% if quote_identifiers %}\n            as {{ adapter.quote(prefix ~ value ~ suffix) }}\n      {% else %}\n        as {{ dbt_utils.slugify(prefix ~ value ~ suffix) }}\n      {% endif %}\n    {% endif %}\n    {% if not loop.last %},{% endif %}\n  {% endfor %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.escape_single_quotes", "macro.dbt_utils.slugify"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.435572, "supported_languages": null}, "macro.dbt_utils.get_filtered_columns_in_relation": {"name": "get_filtered_columns_in_relation", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/get_filtered_columns_in_relation.sql", "original_file_path": "macros/sql/get_filtered_columns_in_relation.sql", "unique_id": "macro.dbt_utils.get_filtered_columns_in_relation", "macro_sql": "{% macro get_filtered_columns_in_relation(from, except=[]) -%}\n    {{ return(adapter.dispatch('get_filtered_columns_in_relation', 'dbt_utils')(from, except)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.default__get_filtered_columns_in_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.435916, "supported_languages": null}, "macro.dbt_utils.default__get_filtered_columns_in_relation": {"name": "default__get_filtered_columns_in_relation", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/get_filtered_columns_in_relation.sql", "original_file_path": "macros/sql/get_filtered_columns_in_relation.sql", "unique_id": "macro.dbt_utils.default__get_filtered_columns_in_relation", "macro_sql": "{% macro default__get_filtered_columns_in_relation(from, except=[]) -%}\n    {%- do dbt_utils._is_relation(from, 'get_filtered_columns_in_relation') -%}\n    {%- do dbt_utils._is_ephemeral(from, 'get_filtered_columns_in_relation') -%}\n\n    {# -- Prevent querying of db in parsing mode. This works because this macro does not create any new refs. #}\n    {%- if not execute -%}\n        {{ return([]) }}\n    {% endif %}\n\n    {%- set include_cols = [] %}\n    {%- set cols = adapter.get_columns_in_relation(from) -%}\n    {%- set except = except | map(\"lower\") | list %}\n    {%- for col in cols -%}\n        {%- if col.column|lower not in except -%}\n            {% do include_cols.append(col.column) %}\n        {%- endif %}\n    {%- endfor %}\n\n    {{ return(include_cols) }}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_utils._is_relation", "macro.dbt_utils._is_ephemeral"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.436377, "supported_languages": null}, "macro.dbt_utils.width_bucket": {"name": "width_bucket", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/width_bucket.sql", "original_file_path": "macros/sql/width_bucket.sql", "unique_id": "macro.dbt_utils.width_bucket", "macro_sql": "{% macro width_bucket(expr, min_value, max_value, num_buckets) %}\n  {{ return(adapter.dispatch('width_bucket', 'dbt_utils') (expr, min_value, max_value, num_buckets)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.snowflake__width_bucket"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.436648, "supported_languages": null}, "macro.dbt_utils.default__width_bucket": {"name": "default__width_bucket", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/width_bucket.sql", "original_file_path": "macros/sql/width_bucket.sql", "unique_id": "macro.dbt_utils.default__width_bucket", "macro_sql": "{% macro default__width_bucket(expr, min_value, max_value, num_buckets) -%}\n\n    {% set bin_size -%}\n    (( {{ max_value }} - {{ min_value }} ) / {{ num_buckets }} )\n    {%- endset %}\n    (\n        -- to break ties when the amount is eaxtly at the bucket egde\n        case\n            when\n                mod(\n                    {{ dbt.safe_cast(expr, dbt.type_numeric() ) }},\n                    {{ dbt.safe_cast(bin_size, dbt.type_numeric() ) }}\n                ) = 0\n            then 1\n            else 0\n        end\n    ) +\n      -- Anything over max_value goes the N+1 bucket\n    least(\n        ceil(\n            ({{ expr }} - {{ min_value }})/{{ bin_size }}\n        ),\n        {{ num_buckets }} + 1\n    )\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.safe_cast", "macro.dbt.type_numeric"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.436917, "supported_languages": null}, "macro.dbt_utils.snowflake__width_bucket": {"name": "snowflake__width_bucket", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/width_bucket.sql", "original_file_path": "macros/sql/width_bucket.sql", "unique_id": "macro.dbt_utils.snowflake__width_bucket", "macro_sql": "{% macro snowflake__width_bucket(expr, min_value, max_value, num_buckets) %}\n    width_bucket({{ expr }}, {{ min_value }}, {{ max_value }}, {{ num_buckets }} )\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4370282, "supported_languages": null}, "macro.dbt_utils.get_query_results_as_dict": {"name": "get_query_results_as_dict", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/get_query_results_as_dict.sql", "original_file_path": "macros/sql/get_query_results_as_dict.sql", "unique_id": "macro.dbt_utils.get_query_results_as_dict", "macro_sql": "{% macro get_query_results_as_dict(query) %}\n    {{ return(adapter.dispatch('get_query_results_as_dict', 'dbt_utils')(query)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.default__get_query_results_as_dict"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4372292, "supported_languages": null}, "macro.dbt_utils.default__get_query_results_as_dict": {"name": "default__get_query_results_as_dict", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/get_query_results_as_dict.sql", "original_file_path": "macros/sql/get_query_results_as_dict.sql", "unique_id": "macro.dbt_utils.default__get_query_results_as_dict", "macro_sql": "{% macro default__get_query_results_as_dict(query) %}\n\n{# This macro returns a dictionary of the form {column_name: (tuple_of_results)} #}\n\n    {%- call statement('get_query_results', fetch_result=True,auto_begin=false) -%}\n\n        {{ query }}\n\n    {%- endcall -%}\n\n    {% set sql_results={} %}\n\n    {%- if execute -%}\n        {% set sql_results_table = load_result('get_query_results').table.columns %}\n        {% for column_name, column in sql_results_table.items() %}\n            {% do sql_results.update({column_name: column.values()}) %}\n        {% endfor %}\n    {%- endif -%}\n\n    {{ return(sql_results) }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4375691, "supported_languages": null}, "macro.dbt_utils.generate_surrogate_key": {"name": "generate_surrogate_key", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/generate_surrogate_key.sql", "original_file_path": "macros/sql/generate_surrogate_key.sql", "unique_id": "macro.dbt_utils.generate_surrogate_key", "macro_sql": "{%- macro generate_surrogate_key(field_list) -%}\n    {{ return(adapter.dispatch('generate_surrogate_key', 'dbt_utils')(field_list)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.default__generate_surrogate_key"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4377851, "supported_languages": null}, "macro.dbt_utils.default__generate_surrogate_key": {"name": "default__generate_surrogate_key", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/generate_surrogate_key.sql", "original_file_path": "macros/sql/generate_surrogate_key.sql", "unique_id": "macro.dbt_utils.default__generate_surrogate_key", "macro_sql": "\n\n{%- macro default__generate_surrogate_key(field_list) -%}\n\n{%- if var('surrogate_key_treat_nulls_as_empty_strings', False) -%}\n    {%- set default_null_value = \"\" -%}\n{%- else -%}\n    {%- set default_null_value = '_dbt_utils_surrogate_key_null_' -%}\n{%- endif -%}\n\n{%- set fields = [] -%}\n\n{%- for field in field_list -%}\n\n    {%- do fields.append(\n        \"coalesce(cast(\" ~ field ~ \" as \" ~ dbt.type_string() ~ \"), '\" ~ default_null_value  ~\"')\"\n    ) -%}\n\n    {%- if not loop.last %}\n        {%- do fields.append(\"'-'\") -%}\n    {%- endif -%}\n\n{%- endfor -%}\n\n{{ dbt.hash(dbt.concat(fields)) }}\n\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt.type_string", "macro.dbt.hash", "macro.dbt.concat"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4381492, "supported_languages": null}, "macro.dbt_utils.get_table_types_sql": {"name": "get_table_types_sql", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/get_table_types_sql.sql", "original_file_path": "macros/sql/get_table_types_sql.sql", "unique_id": "macro.dbt_utils.get_table_types_sql", "macro_sql": "{%- macro get_table_types_sql() -%}\n  {{ return(adapter.dispatch('get_table_types_sql', 'dbt_utils')()) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt_utils.default__get_table_types_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.438347, "supported_languages": null}, "macro.dbt_utils.default__get_table_types_sql": {"name": "default__get_table_types_sql", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/get_table_types_sql.sql", "original_file_path": "macros/sql/get_table_types_sql.sql", "unique_id": "macro.dbt_utils.default__get_table_types_sql", "macro_sql": "{% macro default__get_table_types_sql() %}\n            case table_type\n                when 'BASE TABLE' then 'table'\n                when 'EXTERNAL TABLE' then 'external'\n                when 'MATERIALIZED VIEW' then 'materializedview'\n                else lower(table_type)\n            end as {{ adapter.quote('table_type') }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.438433, "supported_languages": null}, "macro.dbt_utils.postgres__get_table_types_sql": {"name": "postgres__get_table_types_sql", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/get_table_types_sql.sql", "original_file_path": "macros/sql/get_table_types_sql.sql", "unique_id": "macro.dbt_utils.postgres__get_table_types_sql", "macro_sql": "{% macro postgres__get_table_types_sql() %}\n            case table_type\n                when 'BASE TABLE' then 'table'\n                when 'FOREIGN' then 'external'\n                when 'MATERIALIZED VIEW' then 'materializedview'\n                else lower(table_type)\n            end as {{ adapter.quote('table_type') }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.438516, "supported_languages": null}, "macro.dbt_utils.databricks__get_table_types_sql": {"name": "databricks__get_table_types_sql", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/get_table_types_sql.sql", "original_file_path": "macros/sql/get_table_types_sql.sql", "unique_id": "macro.dbt_utils.databricks__get_table_types_sql", "macro_sql": "{% macro databricks__get_table_types_sql() %}\n            case table_type\n                when 'MANAGED' then 'table'\n                when 'BASE TABLE' then 'table'\n                when 'MATERIALIZED VIEW' then 'materializedview'\n                else lower(table_type)\n            end as {{ adapter.quote('table_type') }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.438604, "supported_languages": null}, "macro.dbt_utils.get_single_value": {"name": "get_single_value", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/get_single_value.sql", "original_file_path": "macros/sql/get_single_value.sql", "unique_id": "macro.dbt_utils.get_single_value", "macro_sql": "{% macro get_single_value(query, default=none) %}\n    {{ return(adapter.dispatch('get_single_value', 'dbt_utils')(query, default)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.default__get_single_value"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.438839, "supported_languages": null}, "macro.dbt_utils.default__get_single_value": {"name": "default__get_single_value", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/get_single_value.sql", "original_file_path": "macros/sql/get_single_value.sql", "unique_id": "macro.dbt_utils.default__get_single_value", "macro_sql": "{% macro default__get_single_value(query, default) %}\n\n{# This macro returns the (0, 0) record in a query, i.e. the first row of the first column #}\n\n    {%- call statement('get_query_result', fetch_result=True, auto_begin=false) -%}\n\n        {{ query }}\n\n    {%- endcall -%}\n\n    {%- if execute -%}\n\n        {% set r = load_result('get_query_result').table.columns[0].values() %}\n        {% if r | length == 0 %}\n            {% do print('Query `' ~ query ~ '` returned no rows. Using the default value: ' ~ default) %}\n            {% set sql_result = default %}\n        {% else %}\n            {% set sql_result = r[0] %}\n        {% endif %}\n        \n    {%- else -%}\n    \n        {% set sql_result = default %}\n    \n    {%- endif -%}\n\n    {% do return(sql_result) %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4392672, "supported_languages": null}, "macro.dbt_utils.degrees_to_radians": {"name": "degrees_to_radians", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/haversine_distance.sql", "original_file_path": "macros/sql/haversine_distance.sql", "unique_id": "macro.dbt_utils.degrees_to_radians", "macro_sql": "{% macro degrees_to_radians(degrees) -%}\n    acos(-1) * {{degrees}} / 180\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.439528, "supported_languages": null}, "macro.dbt_utils.haversine_distance": {"name": "haversine_distance", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/haversine_distance.sql", "original_file_path": "macros/sql/haversine_distance.sql", "unique_id": "macro.dbt_utils.haversine_distance", "macro_sql": "{% macro haversine_distance(lat1, lon1, lat2, lon2, unit='mi') -%}\n    {{ return(adapter.dispatch('haversine_distance', 'dbt_utils')(lat1,lon1,lat2,lon2,unit)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.default__haversine_distance"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.439689, "supported_languages": null}, "macro.dbt_utils.default__haversine_distance": {"name": "default__haversine_distance", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/haversine_distance.sql", "original_file_path": "macros/sql/haversine_distance.sql", "unique_id": "macro.dbt_utils.default__haversine_distance", "macro_sql": "{% macro default__haversine_distance(lat1, lon1, lat2, lon2, unit='mi') -%}\n{%- if unit == 'mi' %}\n    {% set conversion_rate = 1 %}\n{% elif unit == 'km' %}\n    {% set conversion_rate = 1.60934 %}\n{% else %}\n    {{ exceptions.raise_compiler_error(\"unit input must be one of 'mi' or 'km'. Got \" ~ unit) }}\n{% endif %}\n\n    2 * 3961 * asin(sqrt(power((sin(radians(({{ lat2 }} - {{ lat1 }}) / 2))), 2) +\n    cos(radians({{lat1}})) * cos(radians({{lat2}})) *\n    power((sin(radians(({{ lon2 }} - {{ lon1 }}) / 2))), 2))) * {{ conversion_rate }}\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.440039, "supported_languages": null}, "macro.dbt_utils.bigquery__haversine_distance": {"name": "bigquery__haversine_distance", "resource_type": "macro", "package_name": "dbt_utils", "path": "macros/sql/haversine_distance.sql", "original_file_path": "macros/sql/haversine_distance.sql", "unique_id": "macro.dbt_utils.bigquery__haversine_distance", "macro_sql": "{% macro bigquery__haversine_distance(lat1, lon1, lat2, lon2, unit='mi') -%}\n{% set radians_lat1 = dbt_utils.degrees_to_radians(lat1) %}\n{% set radians_lat2 = dbt_utils.degrees_to_radians(lat2) %}\n{% set radians_lon1 = dbt_utils.degrees_to_radians(lon1) %}\n{% set radians_lon2 = dbt_utils.degrees_to_radians(lon2) %}\n{%- if unit == 'mi' %}\n    {% set conversion_rate = 1 %}\n{% elif unit == 'km' %}\n    {% set conversion_rate = 1.60934 %}\n{% else %}\n    {{ exceptions.raise_compiler_error(\"unit input must be one of 'mi' or 'km'. Got \" ~ unit) }}\n{% endif %}\n    2 * 3961 * asin(sqrt(power(sin(({{ radians_lat2 }} - {{ radians_lat1 }}) / 2), 2) +\n    cos({{ radians_lat1 }}) * cos({{ radians_lat2 }}) *\n    power(sin(({{ radians_lon2 }} - {{ radians_lon1 }}) / 2), 2))) * {{ conversion_rate }}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_utils.degrees_to_radians"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.440502, "supported_languages": null}, "macro.dbt_date.get_date_dimension": {"name": "get_date_dimension", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/get_date_dimension.sql", "original_file_path": "macros/get_date_dimension.sql", "unique_id": "macro.dbt_date.get_date_dimension", "macro_sql": "{% macro get_date_dimension(start_date, end_date) %}\n    {{ adapter.dispatch(\"get_date_dimension\", \"dbt_date\")(start_date, end_date) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_date.default__get_date_dimension"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4412742, "supported_languages": null}, "macro.dbt_date.default__get_date_dimension": {"name": "default__get_date_dimension", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/get_date_dimension.sql", "original_file_path": "macros/get_date_dimension.sql", "unique_id": "macro.dbt_date.default__get_date_dimension", "macro_sql": "{% macro default__get_date_dimension(start_date, end_date) %}\n    with\n        base_dates as ({{ dbt_date.get_base_dates(start_date, end_date) }}),\n        dates_with_prior_year_dates as (\n\n            select\n                cast(d.date_day as date) as date_day,\n                cast(\n                    {{ dbt.dateadd(\"year\", -1, \"d.date_day\") }} as date\n                ) as prior_year_date_day,\n                cast(\n                    {{ dbt.dateadd(\"day\", -364, \"d.date_day\") }} as date\n                ) as prior_year_over_year_date_day\n            from base_dates d\n\n        )\n    select\n        d.date_day,\n        {{ dbt_date.yesterday(\"d.date_day\") }} as prior_date_day,\n        {{ dbt_date.tomorrow(\"d.date_day\") }} as next_date_day,\n        d.prior_year_date_day as prior_year_date_day,\n        d.prior_year_over_year_date_day,\n        {{ dbt_date.day_of_week(\"d.date_day\", isoweek=false) }} as day_of_week,\n        {{ dbt_date.day_of_week(\"d.date_day\", isoweek=true) }} as day_of_week_iso,\n        {{ dbt_date.day_name(\"d.date_day\", short=false) }} as day_of_week_name,\n        {{ dbt_date.day_name(\"d.date_day\", short=true) }} as day_of_week_name_short,\n        {{ dbt_date.day_of_month(\"d.date_day\") }} as day_of_month,\n        {{ dbt_date.day_of_year(\"d.date_day\") }} as day_of_year,\n\n        {{ dbt_date.week_start(\"d.date_day\") }} as week_start_date,\n        {{ dbt_date.week_end(\"d.date_day\") }} as week_end_date,\n        {{ dbt_date.week_start(\"d.prior_year_over_year_date_day\") }}\n        as prior_year_week_start_date,\n        {{ dbt_date.week_end(\"d.prior_year_over_year_date_day\") }}\n        as prior_year_week_end_date,\n        {{ dbt_date.week_of_year(\"d.date_day\") }} as week_of_year,\n\n        {{ dbt_date.iso_week_start(\"d.date_day\") }} as iso_week_start_date,\n        {{ dbt_date.iso_week_end(\"d.date_day\") }} as iso_week_end_date,\n        {{ dbt_date.iso_week_start(\"d.prior_year_over_year_date_day\") }}\n        as prior_year_iso_week_start_date,\n        {{ dbt_date.iso_week_end(\"d.prior_year_over_year_date_day\") }}\n        as prior_year_iso_week_end_date,\n        {{ dbt_date.iso_week_of_year(\"d.date_day\") }} as iso_week_of_year,\n        {{ dbt_date.iso_year_week(\"d.date_day\") }} as iso_year_week,\n\n        {{ dbt_date.week_of_year(\"d.prior_year_over_year_date_day\") }}\n        as prior_year_week_of_year,\n        {{ dbt_date.iso_week_of_year(\"d.prior_year_over_year_date_day\") }}\n        as prior_year_iso_week_of_year,\n\n        cast(\n            {{ dbt_date.date_part(\"month\", \"d.date_day\") }} as {{ dbt.type_int() }}\n        ) as month_of_year,\n        {{ dbt_date.month_name(\"d.date_day\", short=false) }} as month_name,\n        {{ dbt_date.month_name(\"d.date_day\", short=true) }} as month_name_short,\n\n        cast({{ dbt.date_trunc(\"month\", \"d.date_day\") }} as date) as month_start_date,\n        cast({{ last_day(\"d.date_day\", \"month\") }} as date) as month_end_date,\n\n        cast(\n            {{ dbt.date_trunc(\"month\", \"d.prior_year_date_day\") }} as date\n        ) as prior_year_month_start_date,\n        cast(\n            {{ last_day(\"d.prior_year_date_day\", \"month\") }} as date\n        ) as prior_year_month_end_date,\n\n        cast(\n            {{ dbt_date.date_part(\"quarter\", \"d.date_day\") }} as {{ dbt.type_int() }}\n        ) as quarter_of_year,\n        cast(\n            {{ dbt.date_trunc(\"quarter\", \"d.date_day\") }} as date\n        ) as quarter_start_date,\n        cast({{ last_day(\"d.date_day\", \"quarter\") }} as date) as quarter_end_date,\n\n        cast(\n            {{ dbt_date.date_part(\"year\", \"d.date_day\") }} as {{ dbt.type_int() }}\n        ) as year_number,\n        cast({{ dbt.date_trunc(\"year\", \"d.date_day\") }} as date) as year_start_date,\n        cast({{ last_day(\"d.date_day\", \"year\") }} as date) as year_end_date\n    from dates_with_prior_year_dates d\n    order by 1\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_date.get_base_dates", "macro.dbt.dateadd", "macro.dbt_date.yesterday", "macro.dbt_date.tomorrow", "macro.dbt_date.day_of_week", "macro.dbt_date.day_name", "macro.dbt_date.day_of_month", "macro.dbt_date.day_of_year", "macro.dbt_date.week_start", "macro.dbt_date.week_end", "macro.dbt_date.week_of_year", "macro.dbt_date.iso_week_start", "macro.dbt_date.iso_week_end", "macro.dbt_date.iso_week_of_year", "macro.dbt_date.iso_year_week", "macro.dbt_date.date_part", "macro.dbt.type_int", "macro.dbt_date.month_name", "macro.dbt.date_trunc", "macro.dbt.last_day"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.442539, "supported_languages": null}, "macro.dbt_date.postgres__get_date_dimension": {"name": "postgres__get_date_dimension", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/get_date_dimension.sql", "original_file_path": "macros/get_date_dimension.sql", "unique_id": "macro.dbt_date.postgres__get_date_dimension", "macro_sql": "{% macro postgres__get_date_dimension(start_date, end_date) %}\n    with\n        base_dates as ({{ dbt_date.get_base_dates(start_date, end_date) }}),\n        dates_with_prior_year_dates as (\n\n            select\n                cast(d.date_day as date) as date_day,\n                cast(\n                    {{ dbt.dateadd(\"year\", -1, \"d.date_day\") }} as date\n                ) as prior_year_date_day,\n                cast(\n                    {{ dbt.dateadd(\"day\", -364, \"d.date_day\") }} as date\n                ) as prior_year_over_year_date_day\n            from base_dates d\n\n        )\n    select\n        d.date_day,\n        {{ dbt_date.yesterday(\"d.date_day\") }} as prior_date_day,\n        {{ dbt_date.tomorrow(\"d.date_day\") }} as next_date_day,\n        d.prior_year_date_day as prior_year_date_day,\n        d.prior_year_over_year_date_day,\n        {{ dbt_date.day_of_week(\"d.date_day\", isoweek=true) }} as day_of_week,\n\n        {{ dbt_date.day_name(\"d.date_day\", short=false) }} as day_of_week_name,\n        {{ dbt_date.day_name(\"d.date_day\", short=true) }} as day_of_week_name_short,\n        {{ dbt_date.day_of_month(\"d.date_day\") }} as day_of_month,\n        {{ dbt_date.day_of_year(\"d.date_day\") }} as day_of_year,\n\n        {{ dbt_date.week_start(\"d.date_day\") }} as week_start_date,\n        {{ dbt_date.week_end(\"d.date_day\") }} as week_end_date,\n        {{ dbt_date.week_start(\"d.prior_year_over_year_date_day\") }}\n        as prior_year_week_start_date,\n        {{ dbt_date.week_end(\"d.prior_year_over_year_date_day\") }}\n        as prior_year_week_end_date,\n        {{ dbt_date.week_of_year(\"d.date_day\") }} as week_of_year,\n\n        {{ dbt_date.iso_week_start(\"d.date_day\") }} as iso_week_start_date,\n        {{ dbt_date.iso_week_end(\"d.date_day\") }} as iso_week_end_date,\n        {{ dbt_date.iso_week_start(\"d.prior_year_over_year_date_day\") }}\n        as prior_year_iso_week_start_date,\n        {{ dbt_date.iso_week_end(\"d.prior_year_over_year_date_day\") }}\n        as prior_year_iso_week_end_date,\n        {{ dbt_date.iso_week_of_year(\"d.date_day\") }} as iso_week_of_year,\n\n        {{ dbt_date.week_of_year(\"d.prior_year_over_year_date_day\") }}\n        as prior_year_week_of_year,\n        {{ dbt_date.iso_week_of_year(\"d.prior_year_over_year_date_day\") }}\n        as prior_year_iso_week_of_year,\n\n        cast(\n            {{ dbt_date.date_part(\"month\", \"d.date_day\") }} as {{ dbt.type_int() }}\n        ) as month_of_year,\n        {{ dbt_date.month_name(\"d.date_day\", short=false) }} as month_name,\n        {{ dbt_date.month_name(\"d.date_day\", short=true) }} as month_name_short,\n\n        cast({{ dbt.date_trunc(\"month\", \"d.date_day\") }} as date) as month_start_date,\n        cast({{ last_day(\"d.date_day\", \"month\") }} as date) as month_end_date,\n\n        cast(\n            {{ dbt.date_trunc(\"month\", \"d.prior_year_date_day\") }} as date\n        ) as prior_year_month_start_date,\n        cast(\n            {{ last_day(\"d.prior_year_date_day\", \"month\") }} as date\n        ) as prior_year_month_end_date,\n\n        cast(\n            {{ dbt_date.date_part(\"quarter\", \"d.date_day\") }} as {{ dbt.type_int() }}\n        ) as quarter_of_year,\n        cast(\n            {{ dbt.date_trunc(\"quarter\", \"d.date_day\") }} as date\n        ) as quarter_start_date,\n        {# last_day does not support quarter because postgresql does not support quarter interval. #}\n        cast(\n            {{\n                dbt.dateadd(\n                    \"day\",\n                    \"-1\",\n                    dbt.dateadd(\n                        \"month\", \"3\", dbt.date_trunc(\"quarter\", \"d.date_day\")\n                    ),\n                )\n            }} as date\n        ) as quarter_end_date,\n\n        cast(\n            {{ dbt_date.date_part(\"year\", \"d.date_day\") }} as {{ dbt.type_int() }}\n        ) as year_number,\n        cast({{ dbt.date_trunc(\"year\", \"d.date_day\") }} as date) as year_start_date,\n        cast({{ last_day(\"d.date_day\", \"year\") }} as date) as year_end_date\n    from dates_with_prior_year_dates d\n    order by 1\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_date.get_base_dates", "macro.dbt.dateadd", "macro.dbt_date.yesterday", "macro.dbt_date.tomorrow", "macro.dbt_date.day_of_week", "macro.dbt_date.day_name", "macro.dbt_date.day_of_month", "macro.dbt_date.day_of_year", "macro.dbt_date.week_start", "macro.dbt_date.week_end", "macro.dbt_date.week_of_year", "macro.dbt_date.iso_week_start", "macro.dbt_date.iso_week_end", "macro.dbt_date.iso_week_of_year", "macro.dbt_date.date_part", "macro.dbt.type_int", "macro.dbt_date.month_name", "macro.dbt.date_trunc", "macro.dbt.last_day"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4438221, "supported_languages": null}, "macro.dbt_date.get_base_dates": {"name": "get_base_dates", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/get_base_dates.sql", "original_file_path": "macros/get_base_dates.sql", "unique_id": "macro.dbt_date.get_base_dates", "macro_sql": "{% macro get_base_dates(\n    start_date=None, end_date=None, n_dateparts=None, datepart=\"day\"\n) %}\n    {{\n        adapter.dispatch(\"get_base_dates\", \"dbt_date\")(\n            start_date, end_date, n_dateparts, datepart\n        )\n    }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_date.default__get_base_dates"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.444261, "supported_languages": null}, "macro.dbt_date.default__get_base_dates": {"name": "default__get_base_dates", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/get_base_dates.sql", "original_file_path": "macros/get_base_dates.sql", "unique_id": "macro.dbt_date.default__get_base_dates", "macro_sql": "{% macro default__get_base_dates(start_date, end_date, n_dateparts, datepart) %}\n\n    {%- if start_date and end_date -%}\n        {%- set start_date = (\n            \"cast('\" ~ start_date ~ \"' as \" ~ dbt.type_timestamp() ~ \")\"\n        ) -%}\n        {%- set end_date = (\n            \"cast('\" ~ end_date ~ \"' as \" ~ dbt.type_timestamp() ~ \")\"\n        ) -%}\n\n    {%- elif n_dateparts and datepart -%}\n\n        {%- set start_date = dbt.dateadd(\n            datepart, -1 * n_dateparts, dbt_date.today()\n        ) -%}\n        {%- set end_date = dbt_date.tomorrow() -%}\n    {%- endif -%}\n\n    with\n        date_spine as (\n\n            {{\n                dbt_date.date_spine(\n                    datepart=datepart,\n                    start_date=start_date,\n                    end_date=end_date,\n                )\n            }}\n\n        )\n    select\n        cast(d.date_{{ datepart }} as {{ dbt.type_timestamp() }}) as date_{{ datepart }}\n    from date_spine d\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.type_timestamp", "macro.dbt.dateadd", "macro.dbt_date.today", "macro.dbt_date.tomorrow", "macro.dbt_date.date_spine"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.44472, "supported_languages": null}, "macro.dbt_date.bigquery__get_base_dates": {"name": "bigquery__get_base_dates", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/get_base_dates.sql", "original_file_path": "macros/get_base_dates.sql", "unique_id": "macro.dbt_date.bigquery__get_base_dates", "macro_sql": "{% macro bigquery__get_base_dates(start_date, end_date, n_dateparts, datepart) %}\n\n    {%- if start_date and end_date -%}\n        {%- set start_date = \"cast('\" ~ start_date ~ \"' as datetime )\" -%}\n        {%- set end_date = \"cast('\" ~ end_date ~ \"' as datetime )\" -%}\n\n    {%- elif n_dateparts and datepart -%}\n\n        {%- set start_date = dbt.dateadd(\n            datepart, -1 * n_dateparts, dbt_date.today()\n        ) -%}\n        {%- set end_date = dbt_date.tomorrow() -%}\n    {%- endif -%}\n\n    with\n        date_spine as (\n\n            {{\n                dbt_date.date_spine(\n                    datepart=datepart,\n                    start_date=start_date,\n                    end_date=end_date,\n                )\n            }}\n\n        )\n    select\n        cast(d.date_{{ datepart }} as {{ dbt.type_timestamp() }}) as date_{{ datepart }}\n    from date_spine d\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.dateadd", "macro.dbt_date.today", "macro.dbt_date.tomorrow", "macro.dbt_date.date_spine", "macro.dbt.type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.445108, "supported_languages": null}, "macro.dbt_date.trino__get_base_dates": {"name": "trino__get_base_dates", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/get_base_dates.sql", "original_file_path": "macros/get_base_dates.sql", "unique_id": "macro.dbt_date.trino__get_base_dates", "macro_sql": "{% macro trino__get_base_dates(start_date, end_date, n_dateparts, datepart) %}\n\n    {%- if start_date and end_date -%}\n        {%- set start_date = (\n            \"cast('\" ~ start_date ~ \"' as \" ~ dbt.type_timestamp() ~ \")\"\n        ) -%}\n        {%- set end_date = (\n            \"cast('\" ~ end_date ~ \"' as \" ~ dbt.type_timestamp() ~ \")\"\n        ) -%}\n\n    {%- elif n_dateparts and datepart -%}\n\n        {%- set start_date = dbt.dateadd(datepart, -1 * n_dateparts, dbt_date.now()) -%}\n        {%- set end_date = dbt_date.tomorrow() -%}\n    {%- endif -%}\n\n    with\n        date_spine as (\n\n            {{\n                dbt_date.date_spine(\n                    datepart=datepart,\n                    start_date=start_date,\n                    end_date=end_date,\n                )\n            }}\n\n        )\n    select\n        cast(d.date_{{ datepart }} as {{ dbt.type_timestamp() }}) as date_{{ datepart }}\n    from date_spine d\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.type_timestamp", "macro.dbt.dateadd", "macro.dbt_date.now", "macro.dbt_date.tomorrow", "macro.dbt_date.date_spine"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.445559, "supported_languages": null}, "macro.dbt_date.get_intervals_between": {"name": "get_intervals_between", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/_utils/date_spine.sql", "original_file_path": "macros/_utils/date_spine.sql", "unique_id": "macro.dbt_date.get_intervals_between", "macro_sql": "{% macro get_intervals_between(start_date, end_date, datepart) -%}\n    {{\n        return(\n            adapter.dispatch(\"get_intervals_between\", \"dbt_date\")(\n                start_date, end_date, datepart\n            )\n        )\n    }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.default__get_intervals_between"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.445884, "supported_languages": null}, "macro.dbt_date.default__get_intervals_between": {"name": "default__get_intervals_between", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/_utils/date_spine.sql", "original_file_path": "macros/_utils/date_spine.sql", "unique_id": "macro.dbt_date.default__get_intervals_between", "macro_sql": "{% macro default__get_intervals_between(start_date, end_date, datepart) -%}\n    {%- call statement(\"get_intervals_between\", fetch_result=True) %}\n\n        select {{ dbt.datediff(start_date, end_date, datepart) }}\n\n    {%- endcall -%}\n\n    {%- set value_list = load_result(\"get_intervals_between\") -%}\n\n    {%- if value_list and value_list[\"data\"] -%}\n        {%- set values = value_list[\"data\"] | map(attribute=0) | list %}\n        {{ return(values[0]) }}\n    {%- else -%} {{ return(1) }}\n    {%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt.datediff"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.446223, "supported_languages": null}, "macro.dbt_date.date_spine": {"name": "date_spine", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/_utils/date_spine.sql", "original_file_path": "macros/_utils/date_spine.sql", "unique_id": "macro.dbt_date.date_spine", "macro_sql": "{% macro date_spine(datepart, start_date, end_date) %}\n    {{\n        return(\n            adapter.dispatch(\"date_spine\", \"dbt_date\")(datepart, start_date, end_date)\n        )\n    }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.default__date_spine"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.446363, "supported_languages": null}, "macro.dbt_date.default__date_spine": {"name": "default__date_spine", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/_utils/date_spine.sql", "original_file_path": "macros/_utils/date_spine.sql", "unique_id": "macro.dbt_date.default__date_spine", "macro_sql": "{% macro default__date_spine(datepart, start_date, end_date) %}\n\n    {# call as follows:\n\ndate_spine(\n    \"day\",\n    \"to_date('01/01/2016', 'mm/dd/yyyy')\",\n    \"dbt.dateadd(week, 1, current_date)\"\n) #}\n    with\n        rawdata as (\n\n            {{\n                dbt_date.generate_series(\n                    dbt_date.get_intervals_between(start_date, end_date, datepart)\n                )\n            }}\n\n        ),\n\n        all_periods as (\n\n            select\n                (\n                    {{\n                        dbt.dateadd(\n                            datepart,\n                            \"(row_number() over (order by 1) - 1)\",\n                            start_date,\n                        )\n                    }}\n                ) as date_{{ datepart }}\n            from rawdata\n\n        ),\n\n        filtered as (\n\n            select * from all_periods where date_{{ datepart }} <= {{ end_date }}\n\n        )\n\n    select *\n    from filtered\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_date.generate_series", "macro.dbt_date.get_intervals_between", "macro.dbt.dateadd"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.446584, "supported_languages": null}, "macro.dbt_date.get_powers_of_two": {"name": "get_powers_of_two", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/_utils/generate_series.sql", "original_file_path": "macros/_utils/generate_series.sql", "unique_id": "macro.dbt_date.get_powers_of_two", "macro_sql": "{% macro get_powers_of_two(upper_bound) %}\n    {{ return(adapter.dispatch(\"get_powers_of_two\", \"dbt_date\")(upper_bound)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_date.default__get_powers_of_two"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4468539, "supported_languages": null}, "macro.dbt_date.default__get_powers_of_two": {"name": "default__get_powers_of_two", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/_utils/generate_series.sql", "original_file_path": "macros/_utils/generate_series.sql", "unique_id": "macro.dbt_date.default__get_powers_of_two", "macro_sql": "{% macro default__get_powers_of_two(upper_bound) %}\n\n    {% if upper_bound <= 0 %}\n        {{ exceptions.raise_compiler_error(\"upper bound must be positive\") }}\n    {% endif %}\n\n    {% for _ in range(1, 100) %}\n        {% if upper_bound <= 2**loop.index %} {{ return(loop.index) }}{% endif %}\n    {% endfor %}\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.447094, "supported_languages": null}, "macro.dbt_date.generate_series": {"name": "generate_series", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/_utils/generate_series.sql", "original_file_path": "macros/_utils/generate_series.sql", "unique_id": "macro.dbt_date.generate_series", "macro_sql": "{% macro generate_series(upper_bound) %}\n    {{ return(adapter.dispatch(\"generate_series\", \"dbt_date\")(upper_bound)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_date.default__generate_series"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.447207, "supported_languages": null}, "macro.dbt_date.default__generate_series": {"name": "default__generate_series", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/_utils/generate_series.sql", "original_file_path": "macros/_utils/generate_series.sql", "unique_id": "macro.dbt_date.default__generate_series", "macro_sql": "{% macro default__generate_series(upper_bound) %}\n\n    {% set n = dbt_date.get_powers_of_two(upper_bound) %}\n\n    with\n        p as (\n            select 0 as generated_number\n            union all\n            select 1\n        ),\n        unioned as (\n\n            select\n\n                {% for i in range(n) %}\n                    p{{ i }}.generated_number * power(2, {{ i }})\n                    {% if not loop.last %} + {% endif %}\n                {% endfor %}\n                + 1 as generated_number\n\n            from\n\n            {% for i in range(n) %}\n                    p as p{{ i }} {% if not loop.last %} cross join {% endif %}\n            {% endfor %}\n\n        )\n\n    select *\n    from unioned\n    where generated_number <= {{ upper_bound }}\n    order by generated_number\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_date.get_powers_of_two"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.447506, "supported_languages": null}, "macro.dbt_date.get_localized_datepart_names": {"name": "get_localized_datepart_names", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/_utils/get_localized_datepart_names.sql", "original_file_path": "macros/_utils/get_localized_datepart_names.sql", "unique_id": "macro.dbt_date.get_localized_datepart_names", "macro_sql": "{% macro get_localized_datepart_names(language, datepart) %}\n    {{\n        return(\n            adapter.dispatch(\"get_localized_datepart_names\", \"dbt_date\")(\n                language, datepart\n            )\n        )\n    }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_date.default__get_localized_datepart_names"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.450436, "supported_languages": null}, "macro.dbt_date.default__get_localized_datepart_names": {"name": "default__get_localized_datepart_names", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/_utils/get_localized_datepart_names.sql", "original_file_path": "macros/_utils/get_localized_datepart_names.sql", "unique_id": "macro.dbt_date.default__get_localized_datepart_names", "macro_sql": "{% macro default__get_localized_datepart_names(language, datepart) %}\n    {% set datepart_names_by_language = {\n        \"en\": {\n            \"weekdays\": {\n                \"long\": {\n                    \"1\": \"Monday\",\n                    \"2\": \"Tuesday\",\n                    \"3\": \"Wednesday\",\n                    \"4\": \"Thursday\",\n                    \"5\": \"Friday\",\n                    \"6\": \"Saturday\",\n                    \"7\": \"Sunday\",\n                },\n                \"short\": {\n                    \"1\": \"Mon\",\n                    \"2\": \"Tue\",\n                    \"3\": \"Wed\",\n                    \"4\": \"Thu\",\n                    \"5\": \"Fri\",\n                    \"6\": \"Sat\",\n                    \"7\": \"Sun\",\n                },\n            },\n            \"months\": {\n                \"long\": {\n                    \"1\": \"January\",\n                    \"2\": \"February\",\n                    \"3\": \"March\",\n                    \"4\": \"April\",\n                    \"5\": \"May\",\n                    \"6\": \"June\",\n                    \"7\": \"July\",\n                    \"8\": \"August\",\n                    \"9\": \"September\",\n                    \"10\": \"October\",\n                    \"11\": \"November\",\n                    \"12\": \"December\",\n                },\n                \"short\": {\n                    \"1\": \"Jan\",\n                    \"2\": \"Feb\",\n                    \"3\": \"Mar\",\n                    \"4\": \"Apr\",\n                    \"5\": \"May\",\n                    \"6\": \"Jun\",\n                    \"7\": \"Jul\",\n                    \"8\": \"Aug\",\n                    \"9\": \"Sep\",\n                    \"10\": \"Oct\",\n                    \"11\": \"Nov\",\n                    \"12\": \"Dec\",\n                },\n            },\n            \"seasons\": {\n                \"1\": \"winter\",\n                \"2\": \"spring\",\n                \"3\": \"summer\",\n                \"4\": \"autumn\",\n            },\n        },\n        \"nl\": {\n            \"weekdays\": {\n                \"long\": {\n                    \"1\": \"maandag\",\n                    \"2\": \"dinsdag\",\n                    \"3\": \"woensdag\",\n                    \"4\": \"donderdag\",\n                    \"5\": \"vrijdag\",\n                    \"6\": \"zaterdag\",\n                    \"7\": \"zondag\",\n                },\n                \"short\": {\n                    \"1\": \"ma\",\n                    \"2\": \"di\",\n                    \"3\": \"wo\",\n                    \"4\": \"do\",\n                    \"5\": \"vr\",\n                    \"6\": \"za\",\n                    \"7\": \"zo\",\n                },\n            },\n            \"months\": {\n                \"long\": {\n                    \"1\": \"januari\",\n                    \"2\": \"februari\",\n                    \"3\": \"maart\",\n                    \"4\": \"april\",\n                    \"5\": \"mei\",\n                    \"6\": \"juni\",\n                    \"7\": \"juli\",\n                    \"8\": \"augustus\",\n                    \"9\": \"september\",\n                    \"10\": \"oktober\",\n                    \"11\": \"november\",\n                    \"12\": \"december\",\n                },\n                \"short\": {\n                    \"1\": \"jan\",\n                    \"2\": \"feb\",\n                    \"3\": \"mrt\",\n                    \"4\": \"apr\",\n                    \"5\": \"mei\",\n                    \"6\": \"jun\",\n                    \"7\": \"jul\",\n                    \"8\": \"aug\",\n                    \"9\": \"sep\",\n                    \"10\": \"okt\",\n                    \"11\": \"nov\",\n                    \"12\": \"dec\",\n                },\n            },\n            \"seasons\": {\n                \"1\": \"winter\",\n                \"2\": \"lente\",\n                \"3\": \"zomer\",\n                \"4\": \"herfst\",\n            },\n        },\n        \"de\": {\n            \"weekdays\": {\n                \"long\": {\n                    \"1\": \"Montag\",\n                    \"2\": \"Dienstag\",\n                    \"3\": \"Mittwoch\",\n                    \"4\": \"Donnerstag\",\n                    \"5\": \"Freitag\",\n                    \"6\": \"Samstag\",\n                    \"7\": \"Sonntag\",\n                },\n                \"short\": {\n                    \"1\": \"Mo\",\n                    \"2\": \"Di\",\n                    \"3\": \"Mi\",\n                    \"4\": \"Do\",\n                    \"5\": \"Fr\",\n                    \"6\": \"Sa\",\n                    \"7\": \"So\",\n                },\n            },\n            \"months\": {\n                \"long\": {\n                    \"1\": \"Januar\",\n                    \"2\": \"Februar\",\n                    \"3\": \"M\u00e4rz\",\n                    \"4\": \"April\",\n                    \"5\": \"Mai\",\n                    \"6\": \"Juni\",\n                    \"7\": \"Juli\",\n                    \"8\": \"August\",\n                    \"9\": \"September\",\n                    \"10\": \"Oktober\",\n                    \"11\": \"November\",\n                    \"12\": \"Dezember\",\n                },\n                \"short\": {\n                    \"1\": \"Jan\",\n                    \"2\": \"Feb\",\n                    \"3\": \"M\u00e4r\",\n                    \"4\": \"Apr\",\n                    \"5\": \"Mai\",\n                    \"6\": \"Jun\",\n                    \"7\": \"Jul\",\n                    \"8\": \"Aug\",\n                    \"9\": \"Sep\",\n                    \"10\": \"Okt\",\n                    \"11\": \"Nov\",\n                    \"12\": \"Dez\",\n                },\n            },\n            \"seasons\": {\n                \"1\": \"Winter\",\n                \"2\": \"Fr\u00fchling\",\n                \"3\": \"Sommer\",\n                \"4\": \"Herbst\",\n            },\n        },\n        \"fr\": {\n            \"weekdays\": {\n                \"long\": {\n                    \"1\": \"lundi\",\n                    \"2\": \"mardi\",\n                    \"3\": \"mercredi\",\n                    \"4\": \"jeudi\",\n                    \"5\": \"vendredi\",\n                    \"6\": \"samedi\",\n                    \"7\": \"dimanche\",\n                },\n                \"short\": {\n                    \"1\": \"lun\",\n                    \"2\": \"mar\",\n                    \"3\": \"mer\",\n                    \"4\": \"jeu\",\n                    \"5\": \"ven\",\n                    \"6\": \"sam\",\n                    \"7\": \"dim\",\n                },\n            },\n            \"months\": {\n                \"long\": {\n                    \"1\": \"janvier\",\n                    \"2\": \"f\u00e9vrier\",\n                    \"3\": \"mars\",\n                    \"4\": \"avril\",\n                    \"5\": \"mai\",\n                    \"6\": \"juin\",\n                    \"7\": \"juillet\",\n                    \"8\": \"ao\u00fbt\",\n                    \"9\": \"septembre\",\n                    \"10\": \"octobre\",\n                    \"11\": \"novembre\",\n                    \"12\": \"d\u00e9cembre\",\n                },\n                \"short\": {\n                    \"1\": \"janv\",\n                    \"2\": \"f\u00e9vr\",\n                    \"3\": \"mars\",\n                    \"4\": \"avr\",\n                    \"5\": \"mai\",\n                    \"6\": \"juin\",\n                    \"7\": \"juil\",\n                    \"8\": \"ao\u00fbt\",\n                    \"9\": \"sept\",\n                    \"10\": \"oct\",\n                    \"11\": \"nov\",\n                    \"12\": \"d\u00e9c\",\n                },\n            },\n            \"seasons\": {\n                \"1\": \"hiver\",\n                \"2\": \"printemps\",\n                \"3\": \"\u00e9t\u00e9\",\n                \"4\": \"automne\",\n            },\n        },\n        \"es\": {\n            \"weekdays\": {\n                \"long\": {\n                    \"1\": \"lunes\",\n                    \"2\": \"martes\",\n                    \"3\": \"mi\u00e9rcoles\",\n                    \"4\": \"jueves\",\n                    \"5\": \"viernes\",\n                    \"6\": \"s\u00e1bado\",\n                    \"7\": \"domingo\",\n                },\n                \"short\": {\n                    \"1\": \"lun\",\n                    \"2\": \"mar\",\n                    \"3\": \"mi\u00e9\",\n                    \"4\": \"jue\",\n                    \"5\": \"vie\",\n                    \"6\": \"s\u00e1b\",\n                    \"7\": \"dom\",\n                },\n            },\n            \"months\": {\n                \"long\": {\n                    \"1\": \"enero\",\n                    \"2\": \"febrero\",\n                    \"3\": \"marzo\",\n                    \"4\": \"abril\",\n                    \"5\": \"mayo\",\n                    \"6\": \"junio\",\n                    \"7\": \"julio\",\n                    \"8\": \"agosto\",\n                    \"9\": \"septiembre\",\n                    \"10\": \"octubre\",\n                    \"11\": \"noviembre\",\n                    \"12\": \"diciembre\",\n                },\n                \"short\": {\n                    \"1\": \"ene\",\n                    \"2\": \"feb\",\n                    \"3\": \"mar\",\n                    \"4\": \"abr\",\n                    \"5\": \"may\",\n                    \"6\": \"jun\",\n                    \"7\": \"jul\",\n                    \"8\": \"ago\",\n                    \"9\": \"sept\",\n                    \"10\": \"oct\",\n                    \"11\": \"nov\",\n                    \"12\": \"dic\",\n                },\n            },\n            \"seasons\": {\n                \"1\": \"invierno\",\n                \"2\": \"primavera\",\n                \"3\": \"verano\",\n                \"4\": \"oto\u00f1o\",\n            },\n        },\n        \"it\": {\n            \"weekdays\": {\n                \"long\": {\n                    \"1\": \"luned\u00ec\",\n                    \"2\": \"marted\u00ec\",\n                    \"3\": \"mercoled\u00ec\",\n                    \"4\": \"gioved\u00ec\",\n                    \"5\": \"venerd\u00ec\",\n                    \"6\": \"sabato\",\n                    \"7\": \"domenica\",\n                },\n                \"short\": {\n                    \"1\": \"lun\",\n                    \"2\": \"mar\",\n                    \"3\": \"mer\",\n                    \"4\": \"gio\",\n                    \"5\": \"ven\",\n                    \"6\": \"sab\",\n                    \"7\": \"dom\",\n                },\n            },\n            \"months\": {\n                \"long\": {\n                    \"1\": \"gennaio\",\n                    \"2\": \"febbraio\",\n                    \"3\": \"marzo\",\n                    \"4\": \"aprile\",\n                    \"5\": \"maggio\",\n                    \"6\": \"giugno\",\n                    \"7\": \"luglio\",\n                    \"8\": \"agosto\",\n                    \"9\": \"settembre\",\n                    \"10\": \"ottobre\",\n                    \"11\": \"novembre\",\n                    \"12\": \"dicembre\",\n                },\n                \"short\": {\n                    \"1\": \"gen\",\n                    \"2\": \"feb\",\n                    \"3\": \"mar\",\n                    \"4\": \"apr\",\n                    \"5\": \"mag\",\n                    \"6\": \"giu\",\n                    \"7\": \"lug\",\n                    \"8\": \"ago\",\n                    \"9\": \"set\",\n                    \"10\": \"ott\",\n                    \"11\": \"nov\",\n                    \"12\": \"dic\",\n                },\n            },\n            \"seasons\": {\n                \"1\": \"inverno\",\n                \"2\": \"primavera\",\n                \"3\": \"estate\",\n                \"4\": \"autunno\",\n            },\n        },\n        \"pt\": {\n            \"weekdays\": {\n                \"long\": {\n                    \"1\": \"segunda-feira\",\n                    \"2\": \"ter\u00e7a-feira\",\n                    \"3\": \"quarta-feira\",\n                    \"4\": \"quinta-feira\",\n                    \"5\": \"sexta-feira\",\n                    \"6\": \"s\u00e1bado\",\n                    \"7\": \"domingo\",\n                },\n                \"short\": {\n                    \"1\": \"seg\",\n                    \"2\": \"ter\",\n                    \"3\": \"qua\",\n                    \"4\": \"qui\",\n                    \"5\": \"sex\",\n                    \"6\": \"s\u00e1b\",\n                    \"7\": \"dom\",\n                },\n            },\n            \"months\": {\n                \"long\": {\n                    \"1\": \"janeiro\",\n                    \"2\": \"fevereiro\",\n                    \"3\": \"mar\u00e7o\",\n                    \"4\": \"abril\",\n                    \"5\": \"maio\",\n                    \"6\": \"junho\",\n                    \"7\": \"julho\",\n                    \"8\": \"agosto\",\n                    \"9\": \"setembro\",\n                    \"10\": \"outubro\",\n                    \"11\": \"novembro\",\n                    \"12\": \"dezembro\",\n                },\n                \"short\": {\n                    \"1\": \"jan\",\n                    \"2\": \"fev\",\n                    \"3\": \"mar\",\n                    \"4\": \"abr\",\n                    \"5\": \"mai\",\n                    \"6\": \"jun\",\n                    \"7\": \"jul\",\n                    \"8\": \"ago\",\n                    \"9\": \"set\",\n                    \"10\": \"out\",\n                    \"11\": \"nov\",\n                    \"12\": \"dez\",\n                },\n            },\n            \"seasons\": {\n                \"1\": \"inverno\",\n                \"2\": \"primavera\",\n                \"3\": \"ver\u00e3o\",\n                \"4\": \"outono\",\n            },\n        },\n        \"pl\": {\n            \"weekdays\": {\n                \"long\": {\n                    \"1\": \"poniedzia\u0142ek\",\n                    \"2\": \"wtorek\",\n                    \"3\": \"\u015broda\",\n                    \"4\": \"czwartek\",\n                    \"5\": \"pi\u0105tek\",\n                    \"6\": \"sobota\",\n                    \"7\": \"niedziela\",\n                },\n                \"short\": {\n                    \"1\": \"pon\",\n                    \"2\": \"wt\",\n                    \"3\": \"\u015br\",\n                    \"4\": \"czw\",\n                    \"5\": \"pt\",\n                    \"6\": \"sob\",\n                    \"7\": \"niedz\",\n                },\n            },\n            \"months\": {\n                \"long\": {\n                    \"1\": \"stycze\u0144\",\n                    \"2\": \"luty\",\n                    \"3\": \"marzec\",\n                    \"4\": \"kwiecie\u0144\",\n                    \"5\": \"maj\",\n                    \"6\": \"czerwiec\",\n                    \"7\": \"lipiec\",\n                    \"8\": \"sierpie\u0144\",\n                    \"9\": \"wrzesie\u0144\",\n                    \"10\": \"pa\u017adziernik\",\n                    \"11\": \"listopad\",\n                    \"12\": \"grudzie\u0144\",\n                },\n                \"short\": {\n                    \"1\": \"sty\",\n                    \"2\": \"lut\",\n                    \"3\": \"mar\",\n                    \"4\": \"kwi\",\n                    \"5\": \"maj\",\n                    \"6\": \"cze\",\n                    \"7\": \"lip\",\n                    \"8\": \"sie\",\n                    \"9\": \"wrz\",\n                    \"10\": \"pa\u017a\",\n                    \"11\": \"lis\",\n                    \"12\": \"gru\",\n                },\n            },\n            \"seasons\": {\n                \"1\": \"zima\",\n                \"2\": \"wiosna\",\n                \"3\": \"lato\",\n                \"4\": \"jesie\u0144\",\n            },\n        },\n        \"da\": {\n            \"weekdays\": {\n                \"long\": {\n                    \"1\": \"mandag\",\n                    \"2\": \"tirsdag\",\n                    \"3\": \"onsdag\",\n                    \"4\": \"torsdag\",\n                    \"5\": \"fredag\",\n                    \"6\": \"l\u00f8rdag\",\n                    \"7\": \"s\u00f8ndag\",\n                },\n                \"short\": {\n                    \"1\": \"man\",\n                    \"2\": \"tir\",\n                    \"3\": \"ons\",\n                    \"4\": \"tor\",\n                    \"5\": \"fre\",\n                    \"6\": \"l\u00f8r\",\n                    \"7\": \"s\u00f8n\",\n                },\n            },\n            \"months\": {\n                \"long\": {\n                    \"1\": \"januar\",\n                    \"2\": \"februar\",\n                    \"3\": \"marts\",\n                    \"4\": \"april\",\n                    \"5\": \"maj\",\n                    \"6\": \"juni\",\n                    \"7\": \"juli\",\n                    \"8\": \"august\",\n                    \"9\": \"september\",\n                    \"10\": \"oktober\",\n                    \"11\": \"november\",\n                    \"12\": \"december\",\n                },\n                \"short\": {\n                    \"1\": \"jan\",\n                    \"2\": \"feb\",\n                    \"3\": \"mar\",\n                    \"4\": \"apr\",\n                    \"5\": \"maj\",\n                    \"6\": \"jun\",\n                    \"7\": \"jul\",\n                    \"8\": \"aug\",\n                    \"9\": \"sep\",\n                    \"10\": \"okt\",\n                    \"11\": \"nov\",\n                    \"12\": \"dec\",\n                },\n            },\n            \"seasons\": {\n                \"1\": \"vinter\",\n                \"2\": \"for\u00e5r\",\n                \"3\": \"sommer\",\n                \"4\": \"efter\u00e5r\",\n            },\n        },\n        \"sv\": {\n            \"weekdays\": {\n                \"long\": {\n                    \"1\": \"m\u00e5ndag\",\n                    \"2\": \"tisdag\",\n                    \"3\": \"onsdag\",\n                    \"4\": \"torsdag\",\n                    \"5\": \"fredag\",\n                    \"6\": \"l\u00f6rdag\",\n                    \"7\": \"s\u00f6ndag\",\n                },\n                \"short\": {\n                    \"1\": \"m\u00e5n\",\n                    \"2\": \"tis\",\n                    \"3\": \"ons\",\n                    \"4\": \"tor\",\n                    \"5\": \"fre\",\n                    \"6\": \"l\u00f6r\",\n                    \"7\": \"s\u00f6n\",\n                },\n            },\n            \"months\": {\n                \"long\": {\n                    \"1\": \"januari\",\n                    \"2\": \"februari\",\n                    \"3\": \"mars\",\n                    \"4\": \"april\",\n                    \"5\": \"maj\",\n                    \"6\": \"juni\",\n                    \"7\": \"juli\",\n                    \"8\": \"augusti\",\n                    \"9\": \"september\",\n                    \"10\": \"oktober\",\n                    \"11\": \"november\",\n                    \"12\": \"december\",\n                },\n                \"short\": {\n                    \"1\": \"jan\",\n                    \"2\": \"feb\",\n                    \"3\": \"mar\",\n                    \"4\": \"apr\",\n                    \"5\": \"maj\",\n                    \"6\": \"jun\",\n                    \"7\": \"jul\",\n                    \"8\": \"aug\",\n                    \"9\": \"sep\",\n                    \"10\": \"okt\",\n                    \"11\": \"nov\",\n                    \"12\": \"dec\",\n                },\n            },\n            \"seasons\": {\n                \"1\": \"vinter\",\n                \"2\": \"v\u00e5r\",\n                \"3\": \"sommar\",\n                \"4\": \"h\u00f6st\",\n            },\n        },\n        \"tr\": {\n            \"weekdays\": {\n                \"long\": {\n                    \"1\": \"Pazartesi\",\n                    \"2\": \"Sal\u0131\",\n                    \"3\": \"\u00c7ar\u015famba\",\n                    \"4\": \"Per\u015fembe\",\n                    \"5\": \"Cuma\",\n                    \"6\": \"Cumartesi\",\n                    \"7\": \"Pazar\",\n                },\n                \"short\": {\n                    \"1\": \"Pzt\",\n                    \"2\": \"Sal\",\n                    \"3\": \"\u00c7ar\",\n                    \"4\": \"Per\",\n                    \"5\": \"Cum\",\n                    \"6\": \"Cmt\",\n                    \"7\": \"Paz\",\n                },\n            },\n            \"months\": {\n                \"long\": {\n                    \"1\": \"Ocak\",\n                    \"2\": \"\u015eubat\",\n                    \"3\": \"Mart\",\n                    \"4\": \"Nisan\",\n                    \"5\": \"May\u0131s\",\n                    \"6\": \"Haziran\",\n                    \"7\": \"Temmuz\",\n                    \"8\": \"A\u011fustos\",\n                    \"9\": \"Eyl\u00fcl\",\n                    \"10\": \"Ekim\",\n                    \"11\": \"Kas\u0131m\",\n                    \"12\": \"Aral\u0131k\",\n                },\n                \"short\": {\n                    \"1\": \"Oca\",\n                    \"2\": \"\u015eub\",\n                    \"3\": \"Mar\",\n                    \"4\": \"Nis\",\n                    \"5\": \"May\",\n                    \"6\": \"Haz\",\n                    \"7\": \"Tem\",\n                    \"8\": \"A\u011fu\",\n                    \"9\": \"Eyl\",\n                    \"10\": \"Eki\",\n                    \"11\": \"Kas\",\n                    \"12\": \"Ara\",\n                },\n            },\n            \"seasons\": {\n                \"1\": \"k\u0131\u015f\",\n                \"2\": \"ilkbahar\",\n                \"3\": \"yaz\",\n                \"4\": \"sonbahar\",\n            },\n        },\n        \"cs\": {\n            \"weekdays\": {\n                \"long\": {\n                    \"1\": \"pond\u011bl\u00ed\",\n                    \"2\": \"\u00fater\u00fd\",\n                    \"3\": \"st\u0159eda\",\n                    \"4\": \"\u010dtvrtek\",\n                    \"5\": \"p\u00e1tek\",\n                    \"6\": \"sobota\",\n                    \"7\": \"ned\u011ble\",\n                },\n                \"short\": {\n                    \"1\": \"po\",\n                    \"2\": \"\u00fat\",\n                    \"3\": \"st\",\n                    \"4\": \"\u010dt\",\n                    \"5\": \"p\u00e1\",\n                    \"6\": \"so\",\n                    \"7\": \"ne\",\n                },\n            },\n            \"months\": {\n                \"long\": {\n                    \"1\": \"leden\",\n                    \"2\": \"\u00fanor\",\n                    \"3\": \"b\u0159ezen\",\n                    \"4\": \"duben\",\n                    \"5\": \"kv\u011bten\",\n                    \"6\": \"\u010derven\",\n                    \"7\": \"\u010dervenec\",\n                    \"8\": \"srpen\",\n                    \"9\": \"z\u00e1\u0159\u00ed\",\n                    \"10\": \"\u0159\u00edjen\",\n                    \"11\": \"listopad\",\n                    \"12\": \"prosinec\",\n                },\n                \"short\": {\n                    \"1\": \"led\",\n                    \"2\": \"\u00fano\",\n                    \"3\": \"b\u0159e\",\n                    \"4\": \"dub\",\n                    \"5\": \"kv\u011b\",\n                    \"6\": \"\u010der\",\n                    \"7\": \"\u010dvc\",\n                    \"8\": \"srp\",\n                    \"9\": \"z\u00e1\u0159\",\n                    \"10\": \"\u0159\u00edj\",\n                    \"11\": \"lis\",\n                    \"12\": \"pro\",\n                },\n            },\n            \"seasons\": {\"1\": \"zima\", \"2\": \"jaro\", \"3\": \"l\u00e9to\", \"4\": \"podzim\"},\n        },\n        \"fi\": {\n            \"weekdays\": {\n                \"long\": {\n                    \"1\": \"maanantai\",\n                    \"2\": \"tiistai\",\n                    \"3\": \"keskiviikko\",\n                    \"4\": \"torstai\",\n                    \"5\": \"perjantai\",\n                    \"6\": \"lauantai\",\n                    \"7\": \"sunnuntai\",\n                },\n                \"short\": {\n                    \"1\": \"ma\",\n                    \"2\": \"ti\",\n                    \"3\": \"ke\",\n                    \"4\": \"to\",\n                    \"5\": \"pe\",\n                    \"6\": \"la\",\n                    \"7\": \"su\",\n                },\n            },\n            \"months\": {\n                \"long\": {\n                    \"1\": \"tammikuu\",\n                    \"2\": \"helmikuu\",\n                    \"3\": \"maaliskuu\",\n                    \"4\": \"huhtikuu\",\n                    \"5\": \"toukokuu\",\n                    \"6\": \"kes\u00e4kuu\",\n                    \"7\": \"hein\u00e4kuu\",\n                    \"8\": \"elokuu\",\n                    \"9\": \"syyskuu\",\n                    \"10\": \"lokakuu\",\n                    \"11\": \"marraskuu\",\n                    \"12\": \"joulukuu\",\n                },\n                \"short\": {\n                    \"1\": \"tammi\",\n                    \"2\": \"helmi\",\n                    \"3\": \"maalis\",\n                    \"4\": \"huhti\",\n                    \"5\": \"touko\",\n                    \"6\": \"kes\u00e4\",\n                    \"7\": \"hein\u00e4\",\n                    \"8\": \"elo\",\n                    \"9\": \"syys\",\n                    \"10\": \"loka\",\n                    \"11\": \"marras\",\n                    \"12\": \"joulu\",\n                },\n            },\n            \"seasons\": {\n                \"1\": \"talvi\",\n                \"2\": \"kev\u00e4t\",\n                \"3\": \"kes\u00e4\",\n                \"4\": \"syksy\",\n            },\n        },\n    } %}\n\n    {{ return(datepart_names_by_language[language][datepart]) }}\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.460473, "supported_languages": null}, "macro.dbt_date.date": {"name": "date", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/_utils/modules_datetime.sql", "original_file_path": "macros/_utils/modules_datetime.sql", "unique_id": "macro.dbt_date.date", "macro_sql": "{% macro date(year, month, day) %}\n    {{ return(modules.datetime.date(year, month, day)) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.460715, "supported_languages": null}, "macro.dbt_date.datetime": {"name": "datetime", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/_utils/modules_datetime.sql", "original_file_path": "macros/_utils/modules_datetime.sql", "unique_id": "macro.dbt_date.datetime", "macro_sql": "{% macro datetime(\n    year, month, day, hour=0, minute=0, second=0, microsecond=0, tz=None\n) %}\n    {% set tz = tz if tz else var(\"dbt_date:time_zone\") %}\n    {{\n        return(\n            modules.datetime.datetime(\n                year=year,\n                month=month,\n                day=day,\n                hour=hour,\n                minute=minute,\n                second=second,\n                microsecond=microsecond,\n                tzinfo=modules.pytz.timezone(tz),\n            )\n        )\n    }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.461038, "supported_languages": null}, "macro.dbt_date.get_fiscal_year_dates": {"name": "get_fiscal_year_dates", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/fiscal_date/get_fiscal_year_dates.sql", "original_file_path": "macros/fiscal_date/get_fiscal_year_dates.sql", "unique_id": "macro.dbt_date.get_fiscal_year_dates", "macro_sql": "{% macro get_fiscal_year_dates(\n    dates, year_end_month=12, week_start_day=1, shift_year=1\n) %}\n    {{\n        adapter.dispatch(\"get_fiscal_year_dates\", \"dbt_date\")(\n            dates, year_end_month, week_start_day, shift_year\n        )\n    }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_date.default__get_fiscal_year_dates"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4614332, "supported_languages": null}, "macro.dbt_date.default__get_fiscal_year_dates": {"name": "default__get_fiscal_year_dates", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/fiscal_date/get_fiscal_year_dates.sql", "original_file_path": "macros/fiscal_date/get_fiscal_year_dates.sql", "unique_id": "macro.dbt_date.default__get_fiscal_year_dates", "macro_sql": "{% macro default__get_fiscal_year_dates(\n    dates, year_end_month, week_start_day, shift_year\n) %}\n    -- this gets all the dates within a fiscal year\n    -- determined by the given year-end-month\n    -- ending on the saturday closest to that month's end date\n    with\n        fsc_date_dimension as (select * from {{ dates }}),\n        year_month_end as (\n\n            select\n                d.year_number - {{ shift_year }} as fiscal_year_number, d.month_end_date\n            from fsc_date_dimension d\n            where d.month_of_year = {{ year_end_month }}\n            group by 1, 2\n\n        ),\n        weeks as (\n\n            select\n                d.year_number,\n                d.month_of_year,\n                d.date_day as week_start_date,\n                cast({{ dbt.dateadd(\"day\", 6, \"d.date_day\") }} as date) as week_end_date\n            from fsc_date_dimension d\n            where d.day_of_week = {{ week_start_day }}\n\n        ),\n        -- get all the weeks that start in the month the year ends\n        year_week_ends as (\n\n            select\n                d.year_number - {{ shift_year }} as fiscal_year_number, d.week_end_date\n            from weeks d\n            where d.month_of_year = {{ year_end_month }}\n            group by 1, 2\n\n        ),\n        -- then calculate which Saturday is closest to month end\n        weeks_at_month_end as (\n\n            select\n                d.fiscal_year_number,\n                d.week_end_date,\n                m.month_end_date,\n                rank() over (\n                    partition by d.fiscal_year_number\n                    order by\n                        abs(\n                            {{\n                                dbt.datediff(\n                                    \"d.week_end_date\", \"m.month_end_date\", \"day\"\n                                )\n                            }}\n                        )\n\n                ) as closest_to_month_end\n            from year_week_ends d\n            join year_month_end m on d.fiscal_year_number = m.fiscal_year_number\n        ),\n        fiscal_year_range as (\n\n            select\n                w.fiscal_year_number,\n                cast(\n                    {{\n                        dbt.dateadd(\n                            \"day\",\n                            1,\n                            \"lag(w.week_end_date) over(order by w.week_end_date)\",\n                        )\n                    }} as date\n                ) as fiscal_year_start_date,\n                w.week_end_date as fiscal_year_end_date\n            from weeks_at_month_end w\n            where w.closest_to_month_end = 1\n\n        ),\n        fiscal_year_dates as (\n\n            select\n                d.date_day,\n                m.fiscal_year_number,\n                m.fiscal_year_start_date,\n                m.fiscal_year_end_date,\n                w.week_start_date,\n                w.week_end_date,\n                -- we reset the weeks of the year starting with the merch year start\n                -- date\n                dense_rank() over (\n                    partition by m.fiscal_year_number order by w.week_start_date\n                ) as fiscal_week_of_year\n            from fsc_date_dimension d\n            join\n                fiscal_year_range m\n                on d.date_day\n                between m.fiscal_year_start_date and m.fiscal_year_end_date\n            join weeks w on d.date_day between w.week_start_date and w.week_end_date\n\n        )\n    select *\n    from fiscal_year_dates\n    order by 1\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.dateadd", "macro.dbt.datediff"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.461805, "supported_languages": null}, "macro.dbt_date.get_fiscal_periods": {"name": "get_fiscal_periods", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/fiscal_date/get_fiscal_periods.sql", "original_file_path": "macros/fiscal_date/get_fiscal_periods.sql", "unique_id": "macro.dbt_date.get_fiscal_periods", "macro_sql": "{% macro get_fiscal_periods(dates, year_end_month, week_start_day, shift_year=1) %}\n    {#\nThis macro requires you to pass in a ref to a date dimension, created via\ndbt_date.get_date_dimension()s\n#}\n    with\n        fscl_year_dates_for_periods as (\n            {{\n                dbt_date.get_fiscal_year_dates(\n                    dates, year_end_month, week_start_day, shift_year\n                )\n            }}\n        ),\n        fscl_year_w13 as (\n\n            select\n                f.*,\n                -- We count the weeks in a 13 week period\n                -- and separate the 4-5-4 week sequences\n                mod(\n                    cast((f.fiscal_week_of_year - 1) as {{ dbt.type_int() }}), 13\n                ) as w13_number,\n                -- Chop weeks into 13 week merch quarters\n                cast(\n                    least(\n                        floor((f.fiscal_week_of_year - 1) / 13.0), 3\n                    ) as {{ dbt.type_int() }}\n                ) as quarter_number\n            from fscl_year_dates_for_periods f\n\n        ),\n        fscl_periods as (\n\n            select\n                f.date_day,\n                f.fiscal_year_number,\n                f.week_start_date,\n                f.week_end_date,\n                f.fiscal_week_of_year,\n                case\n                    -- we move week 53 into the 3rd period of the quarter\n                    when f.fiscal_week_of_year = 53\n                    then 3\n                    when f.w13_number between 0 and 3\n                    then 1\n                    when f.w13_number between 4 and 8\n                    then 2\n                    when f.w13_number between 9 and 12\n                    then 3\n                end as period_of_quarter,\n                f.quarter_number\n            from fscl_year_w13 f\n\n        ),\n        fscl_periods_quarters as (\n\n            select\n                f.*,\n                cast(\n                    (\n                        (f.quarter_number * 3) + f.period_of_quarter\n                    ) as {{ dbt.type_int() }}\n                ) as fiscal_period_number\n            from fscl_periods f\n\n        )\n    select\n        date_day,\n        fiscal_year_number,\n        week_start_date,\n        week_end_date,\n        fiscal_week_of_year,\n        dense_rank() over (\n            partition by fiscal_period_number order by fiscal_week_of_year\n        ) as fiscal_week_of_period,\n        fiscal_period_number,\n        quarter_number + 1 as fiscal_quarter_number,\n        period_of_quarter as fiscal_period_of_quarter\n    from fscl_periods_quarters\n    order by 1, 2\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_date.get_fiscal_year_dates", "macro.dbt.type_int"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.462232, "supported_languages": null}, "macro.dbt_date.tomorrow": {"name": "tomorrow", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/tomorrow.sql", "original_file_path": "macros/calendar_date/tomorrow.sql", "unique_id": "macro.dbt_date.tomorrow", "macro_sql": "{%- macro tomorrow(date=None, tz=None) -%}\n    {{ dbt_date.n_days_away(1, date, tz) }}\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt_date.n_days_away"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4623628, "supported_languages": null}, "macro.dbt_date.next_week": {"name": "next_week", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/next_week.sql", "original_file_path": "macros/calendar_date/next_week.sql", "unique_id": "macro.dbt_date.next_week", "macro_sql": "{%- macro next_week(tz=None) -%} {{ dbt_date.n_weeks_away(1, tz) }} {%- endmacro -%}", "depends_on": {"macros": ["macro.dbt_date.n_weeks_away"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4624698, "supported_languages": null}, "macro.dbt_date.next_month_name": {"name": "next_month_name", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/next_month_name.sql", "original_file_path": "macros/calendar_date/next_month_name.sql", "unique_id": "macro.dbt_date.next_month_name", "macro_sql": "{%- macro next_month_name(short=True, tz=None) -%}\n    {{ dbt_date.month_name(dbt_date.next_month(tz), short=short) }}\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt_date.month_name", "macro.dbt_date.next_month"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4626079, "supported_languages": null}, "macro.dbt_date.next_month": {"name": "next_month", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/next_month.sql", "original_file_path": "macros/calendar_date/next_month.sql", "unique_id": "macro.dbt_date.next_month", "macro_sql": "{%- macro next_month(tz=None) -%} {{ dbt_date.n_months_away(1, tz) }} {%- endmacro -%}", "depends_on": {"macros": ["macro.dbt_date.n_months_away"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4627159, "supported_languages": null}, "macro.dbt_date.month_name_localized": {"name": "month_name_localized", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/month_name_localized.sql", "original_file_path": "macros/calendar_date/month_name_localized.sql", "unique_id": "macro.dbt_date.month_name_localized", "macro_sql": "{%- macro month_name_localized(date, short=True, language=\"default\") -%}\n    {{ adapter.dispatch(\"month_name_localized\", \"dbt_date\")(date, short, language) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt_date.default__month_name_localized"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.462919, "supported_languages": null}, "macro.dbt_date.default__month_name_localized": {"name": "default__month_name_localized", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/month_name_localized.sql", "original_file_path": "macros/calendar_date/month_name_localized.sql", "unique_id": "macro.dbt_date.default__month_name_localized", "macro_sql": "{%- macro default__month_name_localized(date, short, language) -%}\n    case\n        {% for month_num in range(1, 13) %}\n            when {{ dbt_date.date_part(\"month\", date) }} = {{ month_num }}\n            then\n                '{{ dbt_date.get_localized_datepart_names(language, \"months\")[\"short\" if short else \"long\"][\"\" ~ month_num] }}'\n        {% endfor %}\n    end\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt_date.date_part", "macro.dbt_date.get_localized_datepart_names"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.463161, "supported_languages": null}, "macro.dbt_date.day_name": {"name": "day_name", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/day_name.sql", "original_file_path": "macros/calendar_date/day_name.sql", "unique_id": "macro.dbt_date.day_name", "macro_sql": "{%- macro day_name(date, short=True, language=\"default\") -%}\n    {{ adapter.dispatch(\"day_name\", \"dbt_date\")(date, short, language) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt_date.snowflake__day_name"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.463572, "supported_languages": null}, "macro.dbt_date.default__day_name": {"name": "default__day_name", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/day_name.sql", "original_file_path": "macros/calendar_date/day_name.sql", "unique_id": "macro.dbt_date.default__day_name", "macro_sql": "{%- macro default__day_name(date, short, language) -%}\n    {%- if language == \"default\" -%}\n        {%- set f = \"Dy\" if short else \"Day\" -%} to_char({{ date }}, '{{ f }}')\n    {%- else -%} {{ dbt_date.day_name_localized(date, short, language) }}\n    {%- endif -%}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt_date.day_name_localized"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4637802, "supported_languages": null}, "macro.dbt_date.snowflake__day_name": {"name": "snowflake__day_name", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/day_name.sql", "original_file_path": "macros/calendar_date/day_name.sql", "unique_id": "macro.dbt_date.snowflake__day_name", "macro_sql": "{%- macro snowflake__day_name(date, short, language) -%}\n    {%- if language == \"default\" -%}\n        {{ dbt_date.day_name_localized(date, short, \"en\") }}\n    {%- else -%} {{ dbt_date.day_name_localized(date, short, language) }}\n    {%- endif -%}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt_date.day_name_localized"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.463959, "supported_languages": null}, "macro.dbt_date.bigquery__day_name": {"name": "bigquery__day_name", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/day_name.sql", "original_file_path": "macros/calendar_date/day_name.sql", "unique_id": "macro.dbt_date.bigquery__day_name", "macro_sql": "{%- macro bigquery__day_name(date, short, language) -%}\n    {%- if language == \"default\" -%}\n        {%- set f = \"%a\" if short else \"%A\" -%}\n        format_date('{{ f }}', cast({{ date }} as date))\n    {%- else -%} {{ dbt_date.day_name_localized(date, short, language) }}\n    {%- endif -%}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt_date.day_name_localized"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.464163, "supported_languages": null}, "macro.dbt_date.postgres__day_name": {"name": "postgres__day_name", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/day_name.sql", "original_file_path": "macros/calendar_date/day_name.sql", "unique_id": "macro.dbt_date.postgres__day_name", "macro_sql": "{%- macro postgres__day_name(date, short, language) -%}\n    {%- if language == \"default\" -%}\n        {# FM = Fill mode, which suppresses padding blanks #}\n        {%- set f = \"FMDy\" if short else \"FMDay\" -%} to_char({{ date }}, '{{ f }}')\n    {%- else -%} {{ dbt_date.day_name_localized(date, short, language) }}\n    {%- endif -%}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt_date.day_name_localized"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4643688, "supported_languages": null}, "macro.dbt_date.duckdb__day_name": {"name": "duckdb__day_name", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/day_name.sql", "original_file_path": "macros/calendar_date/day_name.sql", "unique_id": "macro.dbt_date.duckdb__day_name", "macro_sql": "{%- macro duckdb__day_name(date, short, language) -%}\n    {%- if language == \"default\" -%}\n        {%- if short -%} substr(dayname({{ date }}), 1, 3)\n        {%- else -%} dayname({{ date }})\n        {%- endif -%}\n    {%- else -%} {{ dbt_date.day_name_localized(date, short, language) }}\n    {%- endif -%}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt_date.day_name_localized"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.464567, "supported_languages": null}, "macro.dbt_date.spark__day_name": {"name": "spark__day_name", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/day_name.sql", "original_file_path": "macros/calendar_date/day_name.sql", "unique_id": "macro.dbt_date.spark__day_name", "macro_sql": "{%- macro spark__day_name(date, short, language) -%}\n    {%- if language == \"default\" -%}\n        {%- set f = \"E\" if short else \"EEEE\" -%} date_format({{ date }}, '{{ f }}')\n    {%- else -%} {{ dbt_date.day_name_localized(date, short, language) }}\n    {%- endif -%}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt_date.day_name_localized"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4647639, "supported_languages": null}, "macro.dbt_date.trino__day_name": {"name": "trino__day_name", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/day_name.sql", "original_file_path": "macros/calendar_date/day_name.sql", "unique_id": "macro.dbt_date.trino__day_name", "macro_sql": "{%- macro trino__day_name(date, short, language) -%}\n    {%- if language == \"default\" -%}\n        {%- set f = \"a\" if short else \"W\" -%} date_format({{ date }}, '%{{ f }}')\n    {%- else -%} {{ dbt_date.day_name_localized(date, short, language) }}\n    {%- endif -%}\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt_date.day_name_localized"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.464965, "supported_languages": null}, "macro.dbt_date.to_unixtimestamp": {"name": "to_unixtimestamp", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/to_unixtimestamp.sql", "original_file_path": "macros/calendar_date/to_unixtimestamp.sql", "unique_id": "macro.dbt_date.to_unixtimestamp", "macro_sql": "{%- macro to_unixtimestamp(timestamp) -%}\n    {{ adapter.dispatch(\"to_unixtimestamp\", \"dbt_date\")(timestamp) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.snowflake__to_unixtimestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.465148, "supported_languages": null}, "macro.dbt_date.default__to_unixtimestamp": {"name": "default__to_unixtimestamp", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/to_unixtimestamp.sql", "original_file_path": "macros/calendar_date/to_unixtimestamp.sql", "unique_id": "macro.dbt_date.default__to_unixtimestamp", "macro_sql": "\n\n{%- macro default__to_unixtimestamp(timestamp) -%}\n    {{ dbt_date.date_part(\"epoch\", timestamp) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.date_part"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.465287, "supported_languages": null}, "macro.dbt_date.snowflake__to_unixtimestamp": {"name": "snowflake__to_unixtimestamp", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/to_unixtimestamp.sql", "original_file_path": "macros/calendar_date/to_unixtimestamp.sql", "unique_id": "macro.dbt_date.snowflake__to_unixtimestamp", "macro_sql": "\n\n{%- macro snowflake__to_unixtimestamp(timestamp) -%}\n    {{ dbt_date.date_part(\"epoch_seconds\", timestamp) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.date_part"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4654021, "supported_languages": null}, "macro.dbt_date.bigquery__to_unixtimestamp": {"name": "bigquery__to_unixtimestamp", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/to_unixtimestamp.sql", "original_file_path": "macros/calendar_date/to_unixtimestamp.sql", "unique_id": "macro.dbt_date.bigquery__to_unixtimestamp", "macro_sql": "\n\n{%- macro bigquery__to_unixtimestamp(timestamp) -%}\n    unix_seconds({{ timestamp }})\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.465473, "supported_languages": null}, "macro.dbt_date.spark__to_unixtimestamp": {"name": "spark__to_unixtimestamp", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/to_unixtimestamp.sql", "original_file_path": "macros/calendar_date/to_unixtimestamp.sql", "unique_id": "macro.dbt_date.spark__to_unixtimestamp", "macro_sql": "\n\n{%- macro spark__to_unixtimestamp(timestamp) -%}\n    unix_timestamp({{ timestamp }})\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.465537, "supported_languages": null}, "macro.dbt_date.trino__to_unixtimestamp": {"name": "trino__to_unixtimestamp", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/to_unixtimestamp.sql", "original_file_path": "macros/calendar_date/to_unixtimestamp.sql", "unique_id": "macro.dbt_date.trino__to_unixtimestamp", "macro_sql": "\n\n{%- macro trino__to_unixtimestamp(timestamp) -%}\n    to_unixtime({{ timestamp }} at time zone 'UTC')\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4656022, "supported_languages": null}, "macro.dbt_date.day_name_localized": {"name": "day_name_localized", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/day_name_localized.sql", "original_file_path": "macros/calendar_date/day_name_localized.sql", "unique_id": "macro.dbt_date.day_name_localized", "macro_sql": "{%- macro day_name_localized(date, short=True, language=\"default\") -%}\n    {{ adapter.dispatch(\"day_name_localized\", \"dbt_date\")(date, short, language) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt_date.default__day_name_localized"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4658282, "supported_languages": null}, "macro.dbt_date.default__day_name_localized": {"name": "default__day_name_localized", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/day_name_localized.sql", "original_file_path": "macros/calendar_date/day_name_localized.sql", "unique_id": "macro.dbt_date.default__day_name_localized", "macro_sql": "{%- macro default__day_name_localized(date, short, language) -%}\n    case\n        {% for day_num in range(1, 8) %}  -- Similar to python, last argument is not included\n            when {{ dbt_date.day_of_week(date) }} = {{ day_num }}\n            then\n                '{{ dbt_date.get_localized_datepart_names(language, \"weekdays\")[\"short\" if short else \"long\"][\"\" ~ day_num] }}'\n        {% endfor %}\n    end\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt_date.day_of_week", "macro.dbt_date.get_localized_datepart_names"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.466078, "supported_languages": null}, "macro.dbt_date.n_days_away": {"name": "n_days_away", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/n_days_away.sql", "original_file_path": "macros/calendar_date/n_days_away.sql", "unique_id": "macro.dbt_date.n_days_away", "macro_sql": "{%- macro n_days_away(n, date=None, tz=None) -%}\n    {{ dbt_date.n_days_ago(-1 * n, date, tz) }}\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt_date.n_days_ago"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4662359, "supported_languages": null}, "macro.dbt_date.week_start": {"name": "week_start", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/week_start.sql", "original_file_path": "macros/calendar_date/week_start.sql", "unique_id": "macro.dbt_date.week_start", "macro_sql": "{%- macro week_start(date=None, tz=None) -%}\n    {%- set dt = date if date else dbt_date.today(tz) -%}\n    {{ adapter.dispatch(\"week_start\", \"dbt_date\")(dt) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt_date.today", "macro.dbt_date.snowflake__week_start"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.466517, "supported_languages": null}, "macro.dbt_date.default__week_start": {"name": "default__week_start", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/week_start.sql", "original_file_path": "macros/calendar_date/week_start.sql", "unique_id": "macro.dbt_date.default__week_start", "macro_sql": "{%- macro default__week_start(date) -%}\n    cast({{ dbt.date_trunc(\"week\", date) }} as date)\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.date_trunc"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.466605, "supported_languages": null}, "macro.dbt_date.snowflake__week_start": {"name": "snowflake__week_start", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/week_start.sql", "original_file_path": "macros/calendar_date/week_start.sql", "unique_id": "macro.dbt_date.snowflake__week_start", "macro_sql": "\n\n{%- macro snowflake__week_start(date) -%}\n    {#\n        Get the day of week offset: e.g. if the date is a Sunday,\n        dbt_date.day_of_week returns 1, so we subtract 1 to get a 0 offset\n    #}\n    {% set off_set = dbt_date.day_of_week(date, isoweek=False) ~ \" - 1\" %}\n    cast({{ dbt.dateadd(\"day\", \"-1 * (\" ~ off_set ~ \")\", date) }} as date)\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.day_of_week", "macro.dbt.dateadd"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.466778, "supported_languages": null}, "macro.dbt_date.postgres__week_start": {"name": "postgres__week_start", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/week_start.sql", "original_file_path": "macros/calendar_date/week_start.sql", "unique_id": "macro.dbt_date.postgres__week_start", "macro_sql": "\n\n{%- macro postgres__week_start(date) -%}\n    -- Sunday as week start date\n    cast(\n        {{\n            dbt.dateadd(\n                \"day\", -1, dbt.date_trunc(\"week\", dbt.dateadd(\"day\", 1, date))\n            )\n        }} as date\n    )\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.dateadd", "macro.dbt.date_trunc"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4669418, "supported_languages": null}, "macro.dbt_date.duckdb__week_start": {"name": "duckdb__week_start", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/week_start.sql", "original_file_path": "macros/calendar_date/week_start.sql", "unique_id": "macro.dbt_date.duckdb__week_start", "macro_sql": "\n\n{%- macro duckdb__week_start(date) -%}\n    {{ return(dbt_date.postgres__week_start(date)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.postgres__week_start"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.467029, "supported_languages": null}, "macro.dbt_date.iso_week_start": {"name": "iso_week_start", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/iso_week_start.sql", "original_file_path": "macros/calendar_date/iso_week_start.sql", "unique_id": "macro.dbt_date.iso_week_start", "macro_sql": "{%- macro iso_week_start(date=None, tz=None) -%}\n    {%- set dt = date if date else dbt_date.today(tz) -%}\n    {{ adapter.dispatch(\"iso_week_start\", \"dbt_date\")(dt) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt_date.today", "macro.dbt_date.snowflake__iso_week_start"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4673111, "supported_languages": null}, "macro.dbt_date._iso_week_start": {"name": "_iso_week_start", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/iso_week_start.sql", "original_file_path": "macros/calendar_date/iso_week_start.sql", "unique_id": "macro.dbt_date._iso_week_start", "macro_sql": "{%- macro _iso_week_start(date, week_type) -%}\n    cast({{ dbt.date_trunc(week_type, date) }} as date)\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.date_trunc"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.467402, "supported_languages": null}, "macro.dbt_date.default__iso_week_start": {"name": "default__iso_week_start", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/iso_week_start.sql", "original_file_path": "macros/calendar_date/iso_week_start.sql", "unique_id": "macro.dbt_date.default__iso_week_start", "macro_sql": "\n\n{%- macro default__iso_week_start(date) -%}\n    {{ dbt_date._iso_week_start(date, \"isoweek\") }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date._iso_week_start"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.467484, "supported_languages": null}, "macro.dbt_date.snowflake__iso_week_start": {"name": "snowflake__iso_week_start", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/iso_week_start.sql", "original_file_path": "macros/calendar_date/iso_week_start.sql", "unique_id": "macro.dbt_date.snowflake__iso_week_start", "macro_sql": "\n\n{%- macro snowflake__iso_week_start(date) -%}\n    {{ dbt_date._iso_week_start(date, \"week\") }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date._iso_week_start"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.467564, "supported_languages": null}, "macro.dbt_date.postgres__iso_week_start": {"name": "postgres__iso_week_start", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/iso_week_start.sql", "original_file_path": "macros/calendar_date/iso_week_start.sql", "unique_id": "macro.dbt_date.postgres__iso_week_start", "macro_sql": "\n\n{%- macro postgres__iso_week_start(date) -%}\n    {{ dbt_date._iso_week_start(date, \"week\") }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date._iso_week_start"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.467644, "supported_languages": null}, "macro.dbt_date.duckdb__iso_week_start": {"name": "duckdb__iso_week_start", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/iso_week_start.sql", "original_file_path": "macros/calendar_date/iso_week_start.sql", "unique_id": "macro.dbt_date.duckdb__iso_week_start", "macro_sql": "\n\n{%- macro duckdb__iso_week_start(date) -%}\n    {{ return(dbt_date.postgres__iso_week_start(date)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.postgres__iso_week_start"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4677272, "supported_languages": null}, "macro.dbt_date.spark__iso_week_start": {"name": "spark__iso_week_start", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/iso_week_start.sql", "original_file_path": "macros/calendar_date/iso_week_start.sql", "unique_id": "macro.dbt_date.spark__iso_week_start", "macro_sql": "\n\n{%- macro spark__iso_week_start(date) -%}\n    {{ dbt_date._iso_week_start(date, \"week\") }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date._iso_week_start"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.467812, "supported_languages": null}, "macro.dbt_date.trino__iso_week_start": {"name": "trino__iso_week_start", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/iso_week_start.sql", "original_file_path": "macros/calendar_date/iso_week_start.sql", "unique_id": "macro.dbt_date.trino__iso_week_start", "macro_sql": "\n\n{%- macro trino__iso_week_start(date) -%}\n    {{ dbt_date._iso_week_start(date, \"week\") }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date._iso_week_start"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.467893, "supported_languages": null}, "macro.dbt_date.iso_year_week": {"name": "iso_year_week", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/iso_year_week.sql", "original_file_path": "macros/calendar_date/iso_year_week.sql", "unique_id": "macro.dbt_date.iso_year_week", "macro_sql": "\n{%- macro iso_year_week(date) -%}\n    {{ adapter.dispatch(\"iso_year_week\", \"dbt_date\")(date) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt_date.default__iso_year_week"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.46813, "supported_languages": null}, "macro.dbt_date.default__iso_year_week": {"name": "default__iso_year_week", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/iso_year_week.sql", "original_file_path": "macros/calendar_date/iso_year_week.sql", "unique_id": "macro.dbt_date.default__iso_year_week", "macro_sql": "{%- macro default__iso_year_week(date) -%}\n    case\n        when {{ dbt_date.iso_week_of_year(date) }} = 1\n        then\n            concat(\n                {{ dbt_date.date_part(\"year\", dbt_date.iso_week_end(date)) }},\n                '-W',\n                lpad(concat('',{{ dbt_date.iso_week_of_year(date) }}), 2, '0')\n            )\n        else\n            concat(\n                {{ dbt_date.date_part(\"year\", dbt_date.iso_week_start(date)) }},\n                '-W',\n                lpad(concat('', {{ dbt_date.iso_week_of_year(date) }}), 2, '0')\n            )\n    end\n\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt_date.iso_week_of_year", "macro.dbt_date.date_part", "macro.dbt_date.iso_week_end", "macro.dbt_date.iso_week_start"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.468365, "supported_languages": null}, "macro.dbt_date.trino__iso_year_week": {"name": "trino__iso_year_week", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/iso_year_week.sql", "original_file_path": "macros/calendar_date/iso_year_week.sql", "unique_id": "macro.dbt_date.trino__iso_year_week", "macro_sql": "{%- macro trino__iso_year_week(date) -%}\n    case\n        when {{ dbt_date.iso_week_of_year(date) }} = 1\n        then\n            concat(\n                cast(\n                    {{ dbt_date.date_part(\"year\", dbt_date.iso_week_end(date)) }}\n                    as varchar\n                ),\n                '-W',\n                lpad(cast({{ dbt_date.iso_week_of_year(date) }} as varchar), 2, '0')\n            )\n        else\n            concat(\n                cast(\n                    {{ dbt_date.date_part(\"year\", dbt_date.iso_week_start(date)) }}\n                    as varchar\n                ),\n                '-W',\n                lpad(cast({{ dbt_date.iso_week_of_year(date) }} as varchar), 2, '0')\n            )\n    end\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt_date.iso_week_of_year", "macro.dbt_date.date_part", "macro.dbt_date.iso_week_end", "macro.dbt_date.iso_week_start"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.468605, "supported_languages": null}, "macro.dbt_date.n_days_ago": {"name": "n_days_ago", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/n_days_ago.sql", "original_file_path": "macros/calendar_date/n_days_ago.sql", "unique_id": "macro.dbt_date.n_days_ago", "macro_sql": "{%- macro n_days_ago(n, date=None, tz=None) -%}\n    {%- set dt = date if date else dbt_date.today(tz) -%}\n    {%- set n = n | int -%}\n    cast({{ dbt.dateadd(\"day\", -1 * n, dt) }} as date)\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt_date.today", "macro.dbt.dateadd"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.468846, "supported_languages": null}, "macro.dbt_date.last_week": {"name": "last_week", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/last_week.sql", "original_file_path": "macros/calendar_date/last_week.sql", "unique_id": "macro.dbt_date.last_week", "macro_sql": "{%- macro last_week(tz=None) -%} {{ dbt_date.n_weeks_ago(1, tz) }} {%- endmacro -%}", "depends_on": {"macros": ["macro.dbt_date.n_weeks_ago"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4689631, "supported_languages": null}, "macro.dbt_date.now": {"name": "now", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/now.sql", "original_file_path": "macros/calendar_date/now.sql", "unique_id": "macro.dbt_date.now", "macro_sql": "{%- macro now(tz=None) -%}\n    {{ dbt_date.convert_timezone(dbt.current_timestamp(), tz) }}\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt_date.convert_timezone", "macro.dbt.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.46908, "supported_languages": null}, "macro.dbt_date.periods_since": {"name": "periods_since", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/periods_since.sql", "original_file_path": "macros/calendar_date/periods_since.sql", "unique_id": "macro.dbt_date.periods_since", "macro_sql": "{%- macro periods_since(date_col, period_name=\"day\", tz=None) -%}\n    {{ dbt.datediff(date_col, dbt_date.now(tz), period_name) }}\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt.datediff", "macro.dbt_date.now"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.469234, "supported_languages": null}, "macro.dbt_date.today": {"name": "today", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/today.sql", "original_file_path": "macros/calendar_date/today.sql", "unique_id": "macro.dbt_date.today", "macro_sql": "{%- macro today(tz=None) -%} cast({{ dbt_date.now(tz) }} as date) {%- endmacro -%}", "depends_on": {"macros": ["macro.dbt_date.now"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.469342, "supported_languages": null}, "macro.dbt_date.last_month": {"name": "last_month", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/last_month.sql", "original_file_path": "macros/calendar_date/last_month.sql", "unique_id": "macro.dbt_date.last_month", "macro_sql": "{%- macro last_month(tz=None) -%} {{ dbt_date.n_months_ago(1, tz) }} {%- endmacro -%}", "depends_on": {"macros": ["macro.dbt_date.n_months_ago"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.469451, "supported_languages": null}, "macro.dbt_date.day_of_year": {"name": "day_of_year", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/day_of_year.sql", "original_file_path": "macros/calendar_date/day_of_year.sql", "unique_id": "macro.dbt_date.day_of_year", "macro_sql": "{%- macro day_of_year(date) -%}\n    {{ adapter.dispatch(\"day_of_year\", \"dbt_date\")(date) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.default__day_of_year"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.469932, "supported_languages": null}, "macro.dbt_date.default__day_of_year": {"name": "default__day_of_year", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/day_of_year.sql", "original_file_path": "macros/calendar_date/day_of_year.sql", "unique_id": "macro.dbt_date.default__day_of_year", "macro_sql": "\n\n{%- macro default__day_of_year(date) -%}\n    {{ dbt_date.date_part(\"dayofyear\", date) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.date_part"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4700181, "supported_languages": null}, "macro.dbt_date.postgres__day_of_year": {"name": "postgres__day_of_year", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/day_of_year.sql", "original_file_path": "macros/calendar_date/day_of_year.sql", "unique_id": "macro.dbt_date.postgres__day_of_year", "macro_sql": "\n\n{%- macro postgres__day_of_year(date) -%}\n    {{ dbt_date.date_part(\"doy\", date) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.date_part"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.470098, "supported_languages": null}, "macro.dbt_date.redshift__day_of_year": {"name": "redshift__day_of_year", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/day_of_year.sql", "original_file_path": "macros/calendar_date/day_of_year.sql", "unique_id": "macro.dbt_date.redshift__day_of_year", "macro_sql": "\n\n{%- macro redshift__day_of_year(date) -%}\n    cast({{ dbt_date.date_part(\"dayofyear\", date) }} as {{ dbt.type_bigint() }})\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.date_part", "macro.dbt.type_bigint"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4702022, "supported_languages": null}, "macro.dbt_date.spark__day_of_year": {"name": "spark__day_of_year", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/day_of_year.sql", "original_file_path": "macros/calendar_date/day_of_year.sql", "unique_id": "macro.dbt_date.spark__day_of_year", "macro_sql": "\n\n{%- macro spark__day_of_year(date) -%} dayofyear({{ date }}) {%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.470264, "supported_languages": null}, "macro.dbt_date.trino__day_of_year": {"name": "trino__day_of_year", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/day_of_year.sql", "original_file_path": "macros/calendar_date/day_of_year.sql", "unique_id": "macro.dbt_date.trino__day_of_year", "macro_sql": "\n\n{%- macro trino__day_of_year(date) -%}\n    {{ dbt_date.date_part(\"day_of_year\", date) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.date_part"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4703438, "supported_languages": null}, "macro.dbt_date.round_timestamp": {"name": "round_timestamp", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/round_timestamp.sql", "original_file_path": "macros/calendar_date/round_timestamp.sql", "unique_id": "macro.dbt_date.round_timestamp", "macro_sql": "{% macro round_timestamp(timestamp) %}\n    {{ dbt.date_trunc(\"day\", dbt.dateadd(\"hour\", 12, timestamp)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.date_trunc", "macro.dbt.dateadd"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.470487, "supported_languages": null}, "macro.dbt_date.from_unixtimestamp": {"name": "from_unixtimestamp", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/from_unixtimestamp.sql", "original_file_path": "macros/calendar_date/from_unixtimestamp.sql", "unique_id": "macro.dbt_date.from_unixtimestamp", "macro_sql": "{%- macro from_unixtimestamp(epochs, format=\"seconds\") -%}\n    {{ adapter.dispatch(\"from_unixtimestamp\", \"dbt_date\")(epochs, format) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.snowflake__from_unixtimestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4709601, "supported_languages": null}, "macro.dbt_date.default__from_unixtimestamp": {"name": "default__from_unixtimestamp", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/from_unixtimestamp.sql", "original_file_path": "macros/calendar_date/from_unixtimestamp.sql", "unique_id": "macro.dbt_date.default__from_unixtimestamp", "macro_sql": "\n\n{%- macro default__from_unixtimestamp(epochs, format=\"seconds\") -%}\n    {%- if format != \"seconds\" -%}\n        {{\n            exceptions.raise_compiler_error(\n                \"value \"\n                ~ format\n                ~ \" for `format` for from_unixtimestamp is not supported.\"\n            )\n        }}\n    {% endif -%}\n    to_timestamp({{ epochs }})\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.471122, "supported_languages": null}, "macro.dbt_date.postgres__from_unixtimestamp": {"name": "postgres__from_unixtimestamp", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/from_unixtimestamp.sql", "original_file_path": "macros/calendar_date/from_unixtimestamp.sql", "unique_id": "macro.dbt_date.postgres__from_unixtimestamp", "macro_sql": "\n\n{%- macro postgres__from_unixtimestamp(epochs, format=\"seconds\") -%}\n    {%- if format != \"seconds\" -%}\n        {{\n            exceptions.raise_compiler_error(\n                \"value \"\n                ~ format\n                ~ \" for `format` for from_unixtimestamp is not supported.\"\n            )\n        }}\n    {% endif -%}\n    cast(to_timestamp({{ epochs }}) at time zone 'UTC' as timestamp)\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.471315, "supported_languages": null}, "macro.dbt_date.snowflake__from_unixtimestamp": {"name": "snowflake__from_unixtimestamp", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/from_unixtimestamp.sql", "original_file_path": "macros/calendar_date/from_unixtimestamp.sql", "unique_id": "macro.dbt_date.snowflake__from_unixtimestamp", "macro_sql": "\n\n{%- macro snowflake__from_unixtimestamp(epochs, format) -%}\n    {%- if format == \"seconds\" -%} {%- set scale = 0 -%}\n    {%- elif format == \"milliseconds\" -%} {%- set scale = 3 -%}\n    {%- elif format == \"microseconds\" -%} {%- set scale = 6 -%}\n    {%- else -%}\n        {{\n            exceptions.raise_compiler_error(\n                \"value \"\n                ~ format\n                ~ \" for `format` for from_unixtimestamp is not supported.\"\n            )\n        }}\n    {% endif -%}\n    to_timestamp_ntz({{ epochs }}, {{ scale }})\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4716039, "supported_languages": null}, "macro.dbt_date.bigquery__from_unixtimestamp": {"name": "bigquery__from_unixtimestamp", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/from_unixtimestamp.sql", "original_file_path": "macros/calendar_date/from_unixtimestamp.sql", "unique_id": "macro.dbt_date.bigquery__from_unixtimestamp", "macro_sql": "\n\n{%- macro bigquery__from_unixtimestamp(epochs, format) -%}\n    {%- if format == \"seconds\" -%} timestamp_seconds({{ epochs }})\n    {%- elif format == \"milliseconds\" -%} timestamp_millis({{ epochs }})\n    {%- elif format == \"microseconds\" -%} timestamp_micros({{ epochs }})\n    {%- else -%}\n        {{\n            exceptions.raise_compiler_error(\n                \"value \"\n                ~ format\n                ~ \" for `format` for from_unixtimestamp is not supported.\"\n            )\n        }}\n    {% endif -%}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4718342, "supported_languages": null}, "macro.dbt_date.trino__from_unixtimestamp": {"name": "trino__from_unixtimestamp", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/from_unixtimestamp.sql", "original_file_path": "macros/calendar_date/from_unixtimestamp.sql", "unique_id": "macro.dbt_date.trino__from_unixtimestamp", "macro_sql": "\n\n{%- macro trino__from_unixtimestamp(epochs, format) -%}\n    {%- if format == \"seconds\" -%}\n        cast(\n            from_unixtime({{ epochs }}) at time zone 'UTC' as {{ dbt.type_timestamp() }}\n        )\n    {%- elif format == \"milliseconds\" -%}\n        cast(\n            from_unixtime_nanos(\n                {{ epochs }} * pow(10, 6)\n            ) at time zone 'UTC' as {{ dbt.type_timestamp() }}\n        )\n    {%- elif format == \"microseconds\" -%}\n        cast(\n            from_unixtime_nanos(\n                {{ epochs }} * pow(10, 3)\n            ) at time zone 'UTC' as {{ dbt.type_timestamp() }}\n        )\n    {%- elif format == \"nanoseconds\" -%}\n        cast(\n            from_unixtime_nanos(\n                {{ epochs }}\n            ) at time zone 'UTC' as {{ dbt.type_timestamp() }}\n        )\n    {%- else -%}\n        {{\n            exceptions.raise_compiler_error(\n                \"value \"\n                ~ format\n                ~ \" for `format` for from_unixtimestamp is not supported.\"\n            )\n        }}\n    {% endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.47218, "supported_languages": null}, "macro.dbt_date.duckdb__from_unixtimestamp": {"name": "duckdb__from_unixtimestamp", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/from_unixtimestamp.sql", "original_file_path": "macros/calendar_date/from_unixtimestamp.sql", "unique_id": "macro.dbt_date.duckdb__from_unixtimestamp", "macro_sql": "\n\n\n{%- macro duckdb__from_unixtimestamp(epochs, format=\"seconds\") -%}\n    {%- if format != \"seconds\" -%}\n        {{\n            exceptions.raise_compiler_error(\n                \"value \"\n                ~ format\n                ~ \" for `format` for from_unixtimestamp is not supported.\"\n            )\n        }}\n    {% endif -%}\n    cast(to_timestamp({{ epochs }}) at time zone 'UTC' as timestamp)\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.472333, "supported_languages": null}, "macro.dbt_date.n_months_ago": {"name": "n_months_ago", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/n_months_ago.sql", "original_file_path": "macros/calendar_date/n_months_ago.sql", "unique_id": "macro.dbt_date.n_months_ago", "macro_sql": "{%- macro n_months_ago(n, tz=None) -%}\n    {%- set n = n | int -%}\n    {{ dbt.date_trunc(\"month\", dbt.dateadd(\"month\", -1 * n, dbt_date.today(tz))) }}\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt.date_trunc", "macro.dbt.dateadd", "macro.dbt_date.today"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4725518, "supported_languages": null}, "macro.dbt_date.date_part": {"name": "date_part", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/date_part.sql", "original_file_path": "macros/calendar_date/date_part.sql", "unique_id": "macro.dbt_date.date_part", "macro_sql": "{% macro date_part(datepart, date) -%}\n    {{ adapter.dispatch(\"date_part\", \"dbt_date\")(datepart, date) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.default__date_part"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.472748, "supported_languages": null}, "macro.dbt_date.default__date_part": {"name": "default__date_part", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/date_part.sql", "original_file_path": "macros/calendar_date/date_part.sql", "unique_id": "macro.dbt_date.default__date_part", "macro_sql": "{% macro default__date_part(datepart, date) -%}\n    date_part('{{ datepart }}', {{ date }})\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.472827, "supported_languages": null}, "macro.dbt_date.bigquery__date_part": {"name": "bigquery__date_part", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/date_part.sql", "original_file_path": "macros/calendar_date/date_part.sql", "unique_id": "macro.dbt_date.bigquery__date_part", "macro_sql": "{% macro bigquery__date_part(datepart, date) -%}\n    extract({{ datepart }} from {{ date }})\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4729018, "supported_languages": null}, "macro.dbt_date.trino__date_part": {"name": "trino__date_part", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/date_part.sql", "original_file_path": "macros/calendar_date/date_part.sql", "unique_id": "macro.dbt_date.trino__date_part", "macro_sql": "{% macro trino__date_part(datepart, date) -%}\n    extract({{ datepart }} from {{ date }})\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.472977, "supported_languages": null}, "macro.dbt_date.n_weeks_away": {"name": "n_weeks_away", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/n_weeks_away.sql", "original_file_path": "macros/calendar_date/n_weeks_away.sql", "unique_id": "macro.dbt_date.n_weeks_away", "macro_sql": "{%- macro n_weeks_away(n, tz=None) -%}\n    {%- set n = n | int -%}\n    {{ dbt.date_trunc(\"week\", dbt.dateadd(\"week\", n, dbt_date.today(tz))) }}\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt.date_trunc", "macro.dbt.dateadd", "macro.dbt_date.today"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.473176, "supported_languages": null}, "macro.dbt_date.day_of_month": {"name": "day_of_month", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/day_of_month.sql", "original_file_path": "macros/calendar_date/day_of_month.sql", "unique_id": "macro.dbt_date.day_of_month", "macro_sql": "{%- macro day_of_month(date) -%} {{ dbt_date.date_part(\"day\", date) }} {%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.date_part"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4733021, "supported_languages": null}, "macro.dbt_date.redshift__day_of_month": {"name": "redshift__day_of_month", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/day_of_month.sql", "original_file_path": "macros/calendar_date/day_of_month.sql", "unique_id": "macro.dbt_date.redshift__day_of_month", "macro_sql": "\n\n{%- macro redshift__day_of_month(date) -%}\n    cast({{ dbt_date.date_part(\"day\", date) }} as {{ dbt.type_bigint() }})\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.date_part", "macro.dbt.type_bigint"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.473409, "supported_languages": null}, "macro.dbt_date.yesterday": {"name": "yesterday", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/yesterday.sql", "original_file_path": "macros/calendar_date/yesterday.sql", "unique_id": "macro.dbt_date.yesterday", "macro_sql": "{%- macro yesterday(date=None, tz=None) -%}\n    {{ dbt_date.n_days_ago(1, date, tz) }}\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt_date.n_days_ago"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4740732, "supported_languages": null}, "macro.dbt_date.day_of_week": {"name": "day_of_week", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/day_of_week.sql", "original_file_path": "macros/calendar_date/day_of_week.sql", "unique_id": "macro.dbt_date.day_of_week", "macro_sql": "{%- macro day_of_week(date, isoweek=true) -%}\n    {{ adapter.dispatch(\"day_of_week\", \"dbt_date\")(date, isoweek) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.snowflake__day_of_week"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.474499, "supported_languages": null}, "macro.dbt_date.default__day_of_week": {"name": "default__day_of_week", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/day_of_week.sql", "original_file_path": "macros/calendar_date/day_of_week.sql", "unique_id": "macro.dbt_date.default__day_of_week", "macro_sql": "\n\n{%- macro default__day_of_week(date, isoweek) -%}\n\n    {%- set dow = dbt_date.date_part(\"dayofweek\", date) -%}\n\n    {%- if isoweek -%}\n        case\n            -- Shift start of week from Sunday (0) to Monday (1)\n            when {{ dow }} = 0 then 7 else {{ dow }}\n        end\n    {%- else -%} {{ dow }} + 1\n    {%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.date_part"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.474678, "supported_languages": null}, "macro.dbt_date.snowflake__day_of_week": {"name": "snowflake__day_of_week", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/day_of_week.sql", "original_file_path": "macros/calendar_date/day_of_week.sql", "unique_id": "macro.dbt_date.snowflake__day_of_week", "macro_sql": "\n\n{%- macro snowflake__day_of_week(date, isoweek) -%}\n\n    {%- if isoweek -%}\n        {%- set dow_part = \"dayofweekiso\" -%} {{ dbt_date.date_part(dow_part, date) }}\n    {%- else -%}\n        {%- set dow_part = \"dayofweek\" -%}\n        case\n            when {{ dbt_date.date_part(dow_part, date) }} = 7\n            then 1\n            else {{ dbt_date.date_part(dow_part, date) }} + 1\n        end\n    {%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.date_part"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.47491, "supported_languages": null}, "macro.dbt_date.bigquery__day_of_week": {"name": "bigquery__day_of_week", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/day_of_week.sql", "original_file_path": "macros/calendar_date/day_of_week.sql", "unique_id": "macro.dbt_date.bigquery__day_of_week", "macro_sql": "\n\n{%- macro bigquery__day_of_week(date, isoweek) -%}\n\n    {%- set dow = dbt_date.date_part(\"dayofweek\", date) -%}\n\n    {%- if isoweek -%}\n        case\n            -- Shift start of week from Sunday (1) to Monday (2)\n            when {{ dow }} = 1 then 7 else {{ dow }} - 1\n        end\n    {%- else -%} {{ dow }}\n    {%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.date_part"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4750779, "supported_languages": null}, "macro.dbt_date.postgres__day_of_week": {"name": "postgres__day_of_week", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/day_of_week.sql", "original_file_path": "macros/calendar_date/day_of_week.sql", "unique_id": "macro.dbt_date.postgres__day_of_week", "macro_sql": "\n\n\n{%- macro postgres__day_of_week(date, isoweek) -%}\n\n    {%- if isoweek -%}\n        {%- set dow_part = \"isodow\" -%}\n        -- Monday(1) to Sunday (7)\n        cast({{ dbt_date.date_part(dow_part, date) }} as {{ dbt.type_int() }})\n    {%- else -%}\n        {%- set dow_part = \"dow\" -%}\n        -- Sunday(1) to Saturday (7)\n        cast({{ dbt_date.date_part(dow_part, date) }} + 1 as {{ dbt.type_int() }})\n    {%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.date_part", "macro.dbt.type_int"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4753568, "supported_languages": null}, "macro.dbt_date.redshift__day_of_week": {"name": "redshift__day_of_week", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/day_of_week.sql", "original_file_path": "macros/calendar_date/day_of_week.sql", "unique_id": "macro.dbt_date.redshift__day_of_week", "macro_sql": "\n\n\n{%- macro redshift__day_of_week(date, isoweek) -%}\n\n    {%- set dow = dbt_date.date_part(\"dayofweek\", date) -%}\n\n    {%- if isoweek -%}\n        case\n            -- Shift start of week from Sunday (0) to Monday (1)\n            when {{ dow }} = 0 then 7 else cast({{ dow }} as {{ dbt.type_bigint() }})\n        end\n    {%- else -%} cast({{ dow }} + 1 as {{ dbt.type_bigint() }})\n    {%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.date_part", "macro.dbt.type_bigint"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.475569, "supported_languages": null}, "macro.dbt_date.duckdb__day_of_week": {"name": "duckdb__day_of_week", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/day_of_week.sql", "original_file_path": "macros/calendar_date/day_of_week.sql", "unique_id": "macro.dbt_date.duckdb__day_of_week", "macro_sql": "\n\n{%- macro duckdb__day_of_week(date, isoweek) -%}\n    {{ return(dbt_date.postgres__day_of_week(date, isoweek)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.postgres__day_of_week"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.475669, "supported_languages": null}, "macro.dbt_date.spark__day_of_week": {"name": "spark__day_of_week", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/day_of_week.sql", "original_file_path": "macros/calendar_date/day_of_week.sql", "unique_id": "macro.dbt_date.spark__day_of_week", "macro_sql": "\n\n\n{%- macro spark__day_of_week(date, isoweek) -%}\n\n    {%- set dow = \"dayofweek_iso\" if isoweek else \"dayofweek\" -%}\n\n    {{ dbt_date.date_part(dow, date) }}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.date_part"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.475904, "supported_languages": null}, "macro.dbt_date.trino__day_of_week": {"name": "trino__day_of_week", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/day_of_week.sql", "original_file_path": "macros/calendar_date/day_of_week.sql", "unique_id": "macro.dbt_date.trino__day_of_week", "macro_sql": "\n\n\n{%- macro trino__day_of_week(date, isoweek) -%}\n\n    {%- set dow = dbt_date.date_part(\"day_of_week\", date) -%}\n\n    {%- if isoweek -%} {{ dow }}\n    {%- else -%} case when {{ dow }} = 7 then 1 else {{ dow }} + 1 end\n    {%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.date_part"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4761002, "supported_languages": null}, "macro.dbt_date.iso_week_end": {"name": "iso_week_end", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/iso_week_end.sql", "original_file_path": "macros/calendar_date/iso_week_end.sql", "unique_id": "macro.dbt_date.iso_week_end", "macro_sql": "{%- macro iso_week_end(date=None, tz=None) -%}\n    {%- set dt = date if date else dbt_date.today(tz) -%}\n    {{ adapter.dispatch(\"iso_week_end\", \"dbt_date\")(dt) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt_date.today", "macro.dbt_date.snowflake__iso_week_end"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.476385, "supported_languages": null}, "macro.dbt_date._iso_week_end": {"name": "_iso_week_end", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/iso_week_end.sql", "original_file_path": "macros/calendar_date/iso_week_end.sql", "unique_id": "macro.dbt_date._iso_week_end", "macro_sql": "{%- macro _iso_week_end(date, week_type) -%}\n    {%- set dt = dbt_date.iso_week_start(date) -%} {{ dbt_date.n_days_away(6, dt) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.iso_week_start", "macro.dbt_date.n_days_away"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.476514, "supported_languages": null}, "macro.dbt_date.default__iso_week_end": {"name": "default__iso_week_end", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/iso_week_end.sql", "original_file_path": "macros/calendar_date/iso_week_end.sql", "unique_id": "macro.dbt_date.default__iso_week_end", "macro_sql": "\n\n{%- macro default__iso_week_end(date) -%}\n    {{ dbt_date._iso_week_end(date, \"isoweek\") }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date._iso_week_end"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.476598, "supported_languages": null}, "macro.dbt_date.snowflake__iso_week_end": {"name": "snowflake__iso_week_end", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/iso_week_end.sql", "original_file_path": "macros/calendar_date/iso_week_end.sql", "unique_id": "macro.dbt_date.snowflake__iso_week_end", "macro_sql": "\n\n{%- macro snowflake__iso_week_end(date) -%}\n    {{ dbt_date._iso_week_end(date, \"weekiso\") }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date._iso_week_end"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.47668, "supported_languages": null}, "macro.dbt_date.n_weeks_ago": {"name": "n_weeks_ago", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/n_weeks_ago.sql", "original_file_path": "macros/calendar_date/n_weeks_ago.sql", "unique_id": "macro.dbt_date.n_weeks_ago", "macro_sql": "{%- macro n_weeks_ago(n, tz=None) -%}\n    {%- set n = n | int -%}\n    {{ dbt.date_trunc(\"week\", dbt.dateadd(\"week\", -1 * n, dbt_date.today(tz))) }}\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt.date_trunc", "macro.dbt.dateadd", "macro.dbt_date.today"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.476895, "supported_languages": null}, "macro.dbt_date.month_name": {"name": "month_name", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/month_name.sql", "original_file_path": "macros/calendar_date/month_name.sql", "unique_id": "macro.dbt_date.month_name", "macro_sql": "{%- macro month_name(date, short=True, language=\"default\") -%}\n    {{ adapter.dispatch(\"month_name\", \"dbt_date\")(date, short, language) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.snowflake__month_name"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.477319, "supported_languages": null}, "macro.dbt_date.default__month_name": {"name": "default__month_name", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/month_name.sql", "original_file_path": "macros/calendar_date/month_name.sql", "unique_id": "macro.dbt_date.default__month_name", "macro_sql": "\n\n{%- macro default__month_name(date, short, language) -%}\n    {%- if language == \"default\" -%}\n        {%- set f = \"MON\" if short else \"MONTH\" -%} to_char({{ date }}, '{{ f }}')\n    {%- else -%} {{ dbt_date.month_name_localized(date, short, language) }}\n    {%- endif -%}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.month_name_localized"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.477525, "supported_languages": null}, "macro.dbt_date.bigquery__month_name": {"name": "bigquery__month_name", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/month_name.sql", "original_file_path": "macros/calendar_date/month_name.sql", "unique_id": "macro.dbt_date.bigquery__month_name", "macro_sql": "\n\n{%- macro bigquery__month_name(date, short, language) -%}\n    {%- if language == \"default\" -%}\n        {%- set f = \"%b\" if short else \"%B\" -%}\n        format_date('{{ f }}', cast({{ date }} as date))\n    {%- else -%} {{ dbt_date.month_name_localized(date, short, language) }}\n    {%- endif -%}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.month_name_localized"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.477729, "supported_languages": null}, "macro.dbt_date.snowflake__month_name": {"name": "snowflake__month_name", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/month_name.sql", "original_file_path": "macros/calendar_date/month_name.sql", "unique_id": "macro.dbt_date.snowflake__month_name", "macro_sql": "\n\n{%- macro snowflake__month_name(date, short, language) -%}\n    {%- if language == \"default\" -%}\n        {%- set f = \"MON\" if short else \"MMMM\" -%} to_char({{ date }}, '{{ f }}')\n    {%- else -%} {{ dbt_date.month_name_localized(date, short, language) }}\n    {%- endif -%}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.month_name_localized"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.47793, "supported_languages": null}, "macro.dbt_date.postgres__month_name": {"name": "postgres__month_name", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/month_name.sql", "original_file_path": "macros/calendar_date/month_name.sql", "unique_id": "macro.dbt_date.postgres__month_name", "macro_sql": "\n\n{%- macro postgres__month_name(date, short, language) -%}\n    {%- if language == \"default\" -%}\n        {# FM = Fill mode, which suppresses padding blanks #}\n        {%- set f = \"FMMon\" if short else \"FMMonth\" -%} to_char({{ date }}, '{{ f }}')\n    {%- else -%} {{ dbt_date.month_name_localized(date, short, language) }}\n    {%- endif -%}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.month_name_localized"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.478137, "supported_languages": null}, "macro.dbt_date.duckdb__month_name": {"name": "duckdb__month_name", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/month_name.sql", "original_file_path": "macros/calendar_date/month_name.sql", "unique_id": "macro.dbt_date.duckdb__month_name", "macro_sql": "\n\n{%- macro duckdb__month_name(date, short, language) -%}\n    {%- if language == \"default\" -%}\n        {%- if short -%} substr(monthname({{ date }}), 1, 3)\n        {%- else -%} monthname({{ date }})\n        {%- endif -%}\n    {%- else -%} {{ dbt_date.month_name_localized(date, short, language) }}\n    {%- endif -%}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.month_name_localized"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.478333, "supported_languages": null}, "macro.dbt_date.spark__month_name": {"name": "spark__month_name", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/month_name.sql", "original_file_path": "macros/calendar_date/month_name.sql", "unique_id": "macro.dbt_date.spark__month_name", "macro_sql": "\n\n{%- macro spark__month_name(date, short, language) -%}\n    {%- if language == \"default\" -%}\n        {%- set f = \"MMM\" if short else \"MMMM\" -%} date_format({{ date }}, '{{ f }}')\n    {%- else -%} {{ dbt_date.month_name_localized(date, short, language) }}\n    {%- endif -%}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.month_name_localized"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.478536, "supported_languages": null}, "macro.dbt_date.trino__month_name": {"name": "trino__month_name", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/month_name.sql", "original_file_path": "macros/calendar_date/month_name.sql", "unique_id": "macro.dbt_date.trino__month_name", "macro_sql": "\n\n{%- macro trino__month_name(date, short, language) -%}\n    {%- if language == \"default\" -%}\n        {%- set f = \"b\" if short else \"M\" -%} date_format({{ date }}, '%{{ f }}')\n    {%- else -%} {{ dbt_date.month_name_localized(date, short, language) }}\n    {%- endif -%}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.month_name_localized"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.47874, "supported_languages": null}, "macro.dbt_date.last_month_name": {"name": "last_month_name", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/last_month_name.sql", "original_file_path": "macros/calendar_date/last_month_name.sql", "unique_id": "macro.dbt_date.last_month_name", "macro_sql": "{%- macro last_month_name(short=True, tz=None) -%}\n    {{ dbt_date.month_name(dbt_date.last_month(tz), short=short) }}\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt_date.month_name", "macro.dbt_date.last_month"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.47889, "supported_languages": null}, "macro.dbt_date.week_of_year": {"name": "week_of_year", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/week_of_year.sql", "original_file_path": "macros/calendar_date/week_of_year.sql", "unique_id": "macro.dbt_date.week_of_year", "macro_sql": "{%- macro week_of_year(date=None, tz=None) -%}\n    {%- set dt = date if date else dbt_date.today(tz) -%}\n    {{ adapter.dispatch(\"week_of_year\", \"dbt_date\")(dt) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt_date.today", "macro.dbt_date.default__week_of_year"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.479146, "supported_languages": null}, "macro.dbt_date.default__week_of_year": {"name": "default__week_of_year", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/week_of_year.sql", "original_file_path": "macros/calendar_date/week_of_year.sql", "unique_id": "macro.dbt_date.default__week_of_year", "macro_sql": "{%- macro default__week_of_year(date) -%}\n    cast({{ dbt_date.date_part(\"week\", date) }} as {{ dbt.type_int() }})\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.date_part", "macro.dbt.type_int"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.479274, "supported_languages": null}, "macro.dbt_date.postgres__week_of_year": {"name": "postgres__week_of_year", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/week_of_year.sql", "original_file_path": "macros/calendar_date/week_of_year.sql", "unique_id": "macro.dbt_date.postgres__week_of_year", "macro_sql": "\n\n{%- macro postgres__week_of_year(date) -%}\n    {# postgresql 'week' returns isoweek. Use to_char instead.\n   WW = the first week starts on the first day of the year #}\n    cast(to_char({{ date }}, 'WW') as {{ dbt.type_int() }})\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.type_int"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.479367, "supported_languages": null}, "macro.dbt_date.duckdb__week_of_year": {"name": "duckdb__week_of_year", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/week_of_year.sql", "original_file_path": "macros/calendar_date/week_of_year.sql", "unique_id": "macro.dbt_date.duckdb__week_of_year", "macro_sql": "\n\n{%- macro duckdb__week_of_year(date) -%}\n    cast(ceil(dayofyear({{ date }}) / 7) as int)\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.479431, "supported_languages": null}, "macro.dbt_date.convert_timezone": {"name": "convert_timezone", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/convert_timezone.sql", "original_file_path": "macros/calendar_date/convert_timezone.sql", "unique_id": "macro.dbt_date.convert_timezone", "macro_sql": "{%- macro convert_timezone(column, target_tz=None, source_tz=None) -%}\n    {%- set source_tz = \"UTC\" if not source_tz else source_tz -%}\n    {%- set target_tz = var(\"dbt_date:time_zone\") if not target_tz else target_tz -%}\n    {{ adapter.dispatch(\"convert_timezone\", \"dbt_date\")(column, target_tz, source_tz) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt_date.default__convert_timezone"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4798222, "supported_languages": null}, "macro.dbt_date.default__convert_timezone": {"name": "default__convert_timezone", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/convert_timezone.sql", "original_file_path": "macros/calendar_date/convert_timezone.sql", "unique_id": "macro.dbt_date.default__convert_timezone", "macro_sql": "{% macro default__convert_timezone(column, target_tz, source_tz) -%}\n    convert_timezone(\n        '{{ source_tz }}',\n        '{{ target_tz }}',\n        cast({{ column }} as {{ dbt.type_timestamp() }})\n    )\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4799428, "supported_languages": null}, "macro.dbt_date.bigquery__convert_timezone": {"name": "bigquery__convert_timezone", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/convert_timezone.sql", "original_file_path": "macros/calendar_date/convert_timezone.sql", "unique_id": "macro.dbt_date.bigquery__convert_timezone", "macro_sql": "{%- macro bigquery__convert_timezone(column, target_tz, source_tz=None) -%}\n    timestamp(datetime({{ column }}, '{{ target_tz}}'))\n{%- endmacro -%}\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.480033, "supported_languages": null}, "macro.dbt_date.postgres__convert_timezone": {"name": "postgres__convert_timezone", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/convert_timezone.sql", "original_file_path": "macros/calendar_date/convert_timezone.sql", "unique_id": "macro.dbt_date.postgres__convert_timezone", "macro_sql": "{% macro postgres__convert_timezone(column, target_tz, source_tz) -%}\n    cast(\n        cast({{ column }} as {{ dbt.type_timestamp() }})\n        at time zone '{{ source_tz }}' at time zone '{{ target_tz }}'\n        as {{ dbt.type_timestamp() }}\n    )\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.480171, "supported_languages": null}, "macro.dbt_date.redshift__convert_timezone": {"name": "redshift__convert_timezone", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/convert_timezone.sql", "original_file_path": "macros/calendar_date/convert_timezone.sql", "unique_id": "macro.dbt_date.redshift__convert_timezone", "macro_sql": "{%- macro redshift__convert_timezone(column, target_tz, source_tz) -%}\n    {{ return(dbt_date.default__convert_timezone(column, target_tz, source_tz)) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt_date.default__convert_timezone"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.480281, "supported_languages": null}, "macro.dbt_date.duckdb__convert_timezone": {"name": "duckdb__convert_timezone", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/convert_timezone.sql", "original_file_path": "macros/calendar_date/convert_timezone.sql", "unique_id": "macro.dbt_date.duckdb__convert_timezone", "macro_sql": "{% macro duckdb__convert_timezone(column, target_tz, source_tz) -%}\n    {{ return(dbt_date.postgres__convert_timezone(column, target_tz, source_tz)) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt_date.postgres__convert_timezone"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.480387, "supported_languages": null}, "macro.dbt_date.spark__convert_timezone": {"name": "spark__convert_timezone", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/convert_timezone.sql", "original_file_path": "macros/calendar_date/convert_timezone.sql", "unique_id": "macro.dbt_date.spark__convert_timezone", "macro_sql": "{%- macro spark__convert_timezone(column, target_tz, source_tz) -%}\n    from_utc_timestamp(\n        to_utc_timestamp({{ column }}, '{{ source_tz }}'), '{{ target_tz }}'\n    )\n{%- endmacro -%}\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.480486, "supported_languages": null}, "macro.dbt_date.trino__convert_timezone": {"name": "trino__convert_timezone", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/convert_timezone.sql", "original_file_path": "macros/calendar_date/convert_timezone.sql", "unique_id": "macro.dbt_date.trino__convert_timezone", "macro_sql": "{%- macro trino__convert_timezone(column, target_tz, source_tz) -%}\n    cast(\n        (\n            at_timezone(\n                with_timezone(\n                    cast({{ column }} as {{ dbt.type_timestamp() }}), '{{ source_tz }}'\n                ),\n                '{{ target_tz }}'\n            )\n        ) as {{ dbt.type_timestamp() }}\n    )\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt.type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.480625, "supported_languages": null}, "macro.dbt_date.n_months_away": {"name": "n_months_away", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/n_months_away.sql", "original_file_path": "macros/calendar_date/n_months_away.sql", "unique_id": "macro.dbt_date.n_months_away", "macro_sql": "{%- macro n_months_away(n, tz=None) -%}\n    {%- set n = n | int -%}\n    {{ dbt.date_trunc(\"month\", dbt.dateadd(\"month\", n, dbt_date.today(tz))) }}\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt.date_trunc", "macro.dbt.dateadd", "macro.dbt_date.today"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4808278, "supported_languages": null}, "macro.dbt_date.iso_week_of_year": {"name": "iso_week_of_year", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/iso_week_of_year.sql", "original_file_path": "macros/calendar_date/iso_week_of_year.sql", "unique_id": "macro.dbt_date.iso_week_of_year", "macro_sql": "{%- macro iso_week_of_year(date=None, tz=None) -%}\n    {%- set dt = date if date else dbt_date.today(tz) -%}\n    {{ adapter.dispatch(\"iso_week_of_year\", \"dbt_date\")(dt) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt_date.today", "macro.dbt_date.snowflake__iso_week_of_year"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.48112, "supported_languages": null}, "macro.dbt_date._iso_week_of_year": {"name": "_iso_week_of_year", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/iso_week_of_year.sql", "original_file_path": "macros/calendar_date/iso_week_of_year.sql", "unique_id": "macro.dbt_date._iso_week_of_year", "macro_sql": "{%- macro _iso_week_of_year(date, week_type) -%}\n    cast({{ dbt_date.date_part(week_type, date) }} as {{ dbt.type_int() }})\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.date_part", "macro.dbt.type_int"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.481235, "supported_languages": null}, "macro.dbt_date.default__iso_week_of_year": {"name": "default__iso_week_of_year", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/iso_week_of_year.sql", "original_file_path": "macros/calendar_date/iso_week_of_year.sql", "unique_id": "macro.dbt_date.default__iso_week_of_year", "macro_sql": "\n\n{%- macro default__iso_week_of_year(date) -%}\n    {{ dbt_date._iso_week_of_year(date, \"isoweek\") }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date._iso_week_of_year"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.481317, "supported_languages": null}, "macro.dbt_date.snowflake__iso_week_of_year": {"name": "snowflake__iso_week_of_year", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/iso_week_of_year.sql", "original_file_path": "macros/calendar_date/iso_week_of_year.sql", "unique_id": "macro.dbt_date.snowflake__iso_week_of_year", "macro_sql": "\n\n{%- macro snowflake__iso_week_of_year(date) -%}\n    {{ dbt_date._iso_week_of_year(date, \"weekiso\") }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date._iso_week_of_year"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.481397, "supported_languages": null}, "macro.dbt_date.postgres__iso_week_of_year": {"name": "postgres__iso_week_of_year", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/iso_week_of_year.sql", "original_file_path": "macros/calendar_date/iso_week_of_year.sql", "unique_id": "macro.dbt_date.postgres__iso_week_of_year", "macro_sql": "\n\n{%- macro postgres__iso_week_of_year(date) -%}\n    {#\n        postgresql week is isoweek, the first week of a year containing\n        January 4 of that year.\n    #}\n    {{ dbt_date._iso_week_of_year(date, \"week\") }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date._iso_week_of_year"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.481486, "supported_languages": null}, "macro.dbt_date.duckdb__iso_week_of_year": {"name": "duckdb__iso_week_of_year", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/iso_week_of_year.sql", "original_file_path": "macros/calendar_date/iso_week_of_year.sql", "unique_id": "macro.dbt_date.duckdb__iso_week_of_year", "macro_sql": "\n\n{%- macro duckdb__iso_week_of_year(date) -%}\n    {{ return(dbt_date.postgres__iso_week_of_year(date)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.postgres__iso_week_of_year"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.481566, "supported_languages": null}, "macro.dbt_date.spark__iso_week_of_year": {"name": "spark__iso_week_of_year", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/iso_week_of_year.sql", "original_file_path": "macros/calendar_date/iso_week_of_year.sql", "unique_id": "macro.dbt_date.spark__iso_week_of_year", "macro_sql": "\n\n{%- macro spark__iso_week_of_year(date) -%}\n    {{ dbt_date._iso_week_of_year(date, \"week\") }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date._iso_week_of_year"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.481646, "supported_languages": null}, "macro.dbt_date.trino__iso_week_of_year": {"name": "trino__iso_week_of_year", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/iso_week_of_year.sql", "original_file_path": "macros/calendar_date/iso_week_of_year.sql", "unique_id": "macro.dbt_date.trino__iso_week_of_year", "macro_sql": "\n\n{%- macro trino__iso_week_of_year(date) -%}\n    {{ dbt_date._iso_week_of_year(date, \"week\") }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date._iso_week_of_year"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.481725, "supported_languages": null}, "macro.dbt_date.week_end": {"name": "week_end", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/week_end.sql", "original_file_path": "macros/calendar_date/week_end.sql", "unique_id": "macro.dbt_date.week_end", "macro_sql": "{%- macro week_end(date=None, tz=None) -%}\n    {%- set dt = date if date else dbt_date.today(tz) -%}\n    {{ adapter.dispatch(\"week_end\", \"dbt_date\")(dt) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt_date.today", "macro.dbt_date.snowflake__week_end"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4819698, "supported_languages": null}, "macro.dbt_date.default__week_end": {"name": "default__week_end", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/week_end.sql", "original_file_path": "macros/calendar_date/week_end.sql", "unique_id": "macro.dbt_date.default__week_end", "macro_sql": "{%- macro default__week_end(date) -%} {{ last_day(date, \"week\") }} {%- endmacro %}", "depends_on": {"macros": ["macro.dbt.last_day"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.482049, "supported_languages": null}, "macro.dbt_date.snowflake__week_end": {"name": "snowflake__week_end", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/week_end.sql", "original_file_path": "macros/calendar_date/week_end.sql", "unique_id": "macro.dbt_date.snowflake__week_end", "macro_sql": "\n\n{%- macro snowflake__week_end(date) -%}\n    {%- set dt = dbt_date.week_start(date) -%} {{ dbt_date.n_days_away(6, dt) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.week_start", "macro.dbt_date.n_days_away"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.482167, "supported_languages": null}, "macro.dbt_date.postgres__week_end": {"name": "postgres__week_end", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/week_end.sql", "original_file_path": "macros/calendar_date/week_end.sql", "unique_id": "macro.dbt_date.postgres__week_end", "macro_sql": "\n\n{%- macro postgres__week_end(date) -%}\n    {%- set dt = dbt_date.week_start(date) -%} {{ dbt_date.n_days_away(6, dt) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.week_start", "macro.dbt_date.n_days_away"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4822788, "supported_languages": null}, "macro.dbt_date.duckdb__week_end": {"name": "duckdb__week_end", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/week_end.sql", "original_file_path": "macros/calendar_date/week_end.sql", "unique_id": "macro.dbt_date.duckdb__week_end", "macro_sql": "\n\n{%- macro duckdb__week_end(date) -%}\n    {{ return(dbt_date.postgres__week_end(date)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_date.postgres__week_end"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.482365, "supported_languages": null}, "macro.dbt_date.next_month_number": {"name": "next_month_number", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/next_month_number.sql", "original_file_path": "macros/calendar_date/next_month_number.sql", "unique_id": "macro.dbt_date.next_month_number", "macro_sql": "{%- macro next_month_number(tz=None) -%}\n    {{ dbt_date.date_part(\"month\", dbt_date.next_month(tz)) }}\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt_date.date_part", "macro.dbt_date.next_month"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.482498, "supported_languages": null}, "macro.dbt_date.last_month_number": {"name": "last_month_number", "resource_type": "macro", "package_name": "dbt_date", "path": "macros/calendar_date/last_month_number.sql", "original_file_path": "macros/calendar_date/last_month_number.sql", "unique_id": "macro.dbt_date.last_month_number", "macro_sql": "{%- macro last_month_number(tz=None) -%}\n    {{ dbt_date.date_part(\"month\", dbt_date.last_month(tz)) }}\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt_date.date_part", "macro.dbt_date.last_month"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.482631, "supported_languages": null}, "macro.dbt_expectations.type_timestamp": {"name": "type_timestamp", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/utils/datatypes.sql", "original_file_path": "macros/utils/datatypes.sql", "unique_id": "macro.dbt_expectations.type_timestamp", "macro_sql": "\n{%- macro type_timestamp() -%}\n  {{ return(adapter.dispatch('type_timestamp', 'dbt_expectations')()) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt_expectations.snowflake__type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4828649, "supported_languages": null}, "macro.dbt_expectations.default__type_timestamp": {"name": "default__type_timestamp", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/utils/datatypes.sql", "original_file_path": "macros/utils/datatypes.sql", "unique_id": "macro.dbt_expectations.default__type_timestamp", "macro_sql": "{% macro default__type_timestamp() -%}\n    timestamp\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.482916, "supported_languages": null}, "macro.dbt_expectations.snowflake__type_timestamp": {"name": "snowflake__type_timestamp", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/utils/datatypes.sql", "original_file_path": "macros/utils/datatypes.sql", "unique_id": "macro.dbt_expectations.snowflake__type_timestamp", "macro_sql": "{% macro snowflake__type_timestamp() -%}\n    timestamp_ntz\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.482961, "supported_languages": null}, "macro.dbt_expectations.postgres__type_timestamp": {"name": "postgres__type_timestamp", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/utils/datatypes.sql", "original_file_path": "macros/utils/datatypes.sql", "unique_id": "macro.dbt_expectations.postgres__type_timestamp", "macro_sql": "{% macro postgres__type_timestamp() -%}\n    timestamp without time zone\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.483006, "supported_languages": null}, "macro.dbt_expectations.trino__type_timestamp": {"name": "trino__type_timestamp", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/utils/datatypes.sql", "original_file_path": "macros/utils/datatypes.sql", "unique_id": "macro.dbt_expectations.trino__type_timestamp", "macro_sql": "{% macro trino__type_timestamp() -%}\n    timestamp(3)\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.483048, "supported_languages": null}, "macro.dbt_expectations.type_datetime": {"name": "type_datetime", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/utils/datatypes.sql", "original_file_path": "macros/utils/datatypes.sql", "unique_id": "macro.dbt_expectations.type_datetime", "macro_sql": "{% macro type_datetime() -%}\n  {{ return(adapter.dispatch('type_datetime', 'dbt_expectations')()) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_expectations.snowflake__type_datetime"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.483142, "supported_languages": null}, "macro.dbt_expectations.default__type_datetime": {"name": "default__type_datetime", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/utils/datatypes.sql", "original_file_path": "macros/utils/datatypes.sql", "unique_id": "macro.dbt_expectations.default__type_datetime", "macro_sql": "{% macro default__type_datetime() -%}\n    datetime\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.483188, "supported_languages": null}, "macro.dbt_expectations.snowflake__type_datetime": {"name": "snowflake__type_datetime", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/utils/datatypes.sql", "original_file_path": "macros/utils/datatypes.sql", "unique_id": "macro.dbt_expectations.snowflake__type_datetime", "macro_sql": "{% macro snowflake__type_datetime() -%}\n    timestamp_ntz\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4832342, "supported_languages": null}, "macro.dbt_expectations.postgres__type_datetime": {"name": "postgres__type_datetime", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/utils/datatypes.sql", "original_file_path": "macros/utils/datatypes.sql", "unique_id": "macro.dbt_expectations.postgres__type_datetime", "macro_sql": "{% macro postgres__type_datetime() -%}\n    timestamp without time zone\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.483277, "supported_languages": null}, "macro.dbt_expectations.duckdb__type_datetime": {"name": "duckdb__type_datetime", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/utils/datatypes.sql", "original_file_path": "macros/utils/datatypes.sql", "unique_id": "macro.dbt_expectations.duckdb__type_datetime", "macro_sql": "{% macro duckdb__type_datetime() -%}\n    timestamp\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.483318, "supported_languages": null}, "macro.dbt_expectations.spark__type_datetime": {"name": "spark__type_datetime", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/utils/datatypes.sql", "original_file_path": "macros/utils/datatypes.sql", "unique_id": "macro.dbt_expectations.spark__type_datetime", "macro_sql": "{% macro spark__type_datetime() -%}\n    timestamp\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.48336, "supported_languages": null}, "macro.dbt_expectations.trino__type_datetime": {"name": "trino__type_datetime", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/utils/datatypes.sql", "original_file_path": "macros/utils/datatypes.sql", "unique_id": "macro.dbt_expectations.trino__type_datetime", "macro_sql": "{% macro trino__type_datetime() -%}\n    timestamp(3)\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.483401, "supported_languages": null}, "macro.dbt_expectations.md5": {"name": "md5", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/utils/md5.sql", "original_file_path": "macros/utils/md5.sql", "unique_id": "macro.dbt_expectations.md5", "macro_sql": "{%- macro md5(string_value) -%}\n    {{ return(adapter.dispatch('md5', 'dbt_expectations')(string_value)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_expectations.default__md5"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.483559, "supported_languages": null}, "macro.dbt_expectations.default__md5": {"name": "default__md5", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/utils/md5.sql", "original_file_path": "macros/utils/md5.sql", "unique_id": "macro.dbt_expectations.default__md5", "macro_sql": "\n\n{%- macro default__md5(string_value) -%}\n\n  {{ dbt.hash(string_value) }}\n\n{%- endmacro -%}\n\n\n", "depends_on": {"macros": ["macro.dbt.hash"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.483637, "supported_languages": null}, "macro.dbt_expectations.trino__md5": {"name": "trino__md5", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/utils/md5.sql", "original_file_path": "macros/utils/md5.sql", "unique_id": "macro.dbt_expectations.trino__md5", "macro_sql": "{%- macro trino__md5(string_value) -%}\n\n  md5(cast({{ string_value }} as varbinary))\n\n{%- endmacro -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4836988, "supported_languages": null}, "macro.dbt_expectations.group_by": {"name": "group_by", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/utils/groupby.sql", "original_file_path": "macros/utils/groupby.sql", "unique_id": "macro.dbt_expectations.group_by", "macro_sql": "{%- macro group_by(n) -%}\n    {{ return(adapter.dispatch('group_by', 'dbt_expectations')(n)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_expectations.default__group_by"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4838579, "supported_languages": null}, "macro.dbt_expectations.default__group_by": {"name": "default__group_by", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/utils/groupby.sql", "original_file_path": "macros/utils/groupby.sql", "unique_id": "macro.dbt_expectations.default__group_by", "macro_sql": "\n\n{%- macro default__group_by(n) -%}\n\n  group by {% for i in range(1, n + 1) -%}\n      {{ i }}{{ ',' if not loop.last }}\n   {%- endfor -%}\n\n{%- endmacro -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4840078, "supported_languages": null}, "macro.dbt_expectations.regexp_instr": {"name": "regexp_instr", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/regex/regexp_instr.sql", "original_file_path": "macros/regex/regexp_instr.sql", "unique_id": "macro.dbt_expectations.regexp_instr", "macro_sql": "{% macro regexp_instr(source_value, regexp, position=1, occurrence=1, is_raw=False, flags=\"\") %}\n\n    {{ adapter.dispatch('regexp_instr', 'dbt_expectations')(\n        source_value, regexp, position, occurrence, is_raw, flags\n    ) }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_expectations.snowflake__regexp_instr"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.484701, "supported_languages": null}, "macro.dbt_expectations.default__regexp_instr": {"name": "default__regexp_instr", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/regex/regexp_instr.sql", "original_file_path": "macros/regex/regexp_instr.sql", "unique_id": "macro.dbt_expectations.default__regexp_instr", "macro_sql": "{% macro default__regexp_instr(source_value, regexp, position, occurrence, is_raw, flags) %}\n{# unclear if other databases support raw strings or flags #}\n{% if is_raw or flags %}\n    {{ exceptions.warn(\n            \"is_raw and flags options are not supported for this adapter \"\n            ~ \"and are being ignored.\"\n    ) }}\n{% endif %}\nregexp_instr({{ source_value }}, '{{ regexp }}', {{ position }}, {{ occurrence }})\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.484906, "supported_languages": null}, "macro.dbt_expectations.snowflake__regexp_instr": {"name": "snowflake__regexp_instr", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/regex/regexp_instr.sql", "original_file_path": "macros/regex/regexp_instr.sql", "unique_id": "macro.dbt_expectations.snowflake__regexp_instr", "macro_sql": "{% macro snowflake__regexp_instr(source_value, regexp, position, occurrence, is_raw, flags) %}\n{%- set regexp = \"$$\" ~ regexp ~ \"$$\" if is_raw else \"'\" ~ regexp ~ \"'\" -%}\n{% if flags %}{{ dbt_expectations._validate_flags(flags, 'cimes') }}{% endif %}\nregexp_instr({{ source_value }}, {{ regexp }}, {{ position }}, {{ occurrence }}, 0, '{{ flags }}')\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_expectations._validate_flags"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.48525, "supported_languages": null}, "macro.dbt_expectations.bigquery__regexp_instr": {"name": "bigquery__regexp_instr", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/regex/regexp_instr.sql", "original_file_path": "macros/regex/regexp_instr.sql", "unique_id": "macro.dbt_expectations.bigquery__regexp_instr", "macro_sql": "{% macro bigquery__regexp_instr(source_value, regexp, position, occurrence, is_raw, flags) %}\n{% if flags %}\n    {{ dbt_expectations._validate_re2_flags(flags) }}\n    {# BigQuery prepends \"(?flags)\" to set flags for current group #}\n    {%- set regexp = \"(?\" ~ flags ~ \")\" ~ regexp -%}\n{% endif %}\n{%- set regexp = \"r'\" ~ regexp ~ \"'\" if is_raw else \"'\" ~ regexp ~ \"'\" -%}\nregexp_instr({{ source_value }}, {{ regexp }}, {{ position }}, {{ occurrence }})\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_expectations._validate_re2_flags"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.48575, "supported_languages": null}, "macro.dbt_expectations.postgres__regexp_instr": {"name": "postgres__regexp_instr", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/regex/regexp_instr.sql", "original_file_path": "macros/regex/regexp_instr.sql", "unique_id": "macro.dbt_expectations.postgres__regexp_instr", "macro_sql": "{% macro postgres__regexp_instr(source_value, regexp, position, occurrence, is_raw, flags) %}\n{% if flags %}{{ dbt_expectations._validate_flags(flags, 'bcegimnpqstwx') }}{% endif %}\ncoalesce(array_length((select regexp_matches({{ source_value }}, '{{ regexp }}', '{{ flags }}')), 1), 0)\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_expectations._validate_flags"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.485921, "supported_languages": null}, "macro.dbt_expectations.redshift__regexp_instr": {"name": "redshift__regexp_instr", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/regex/regexp_instr.sql", "original_file_path": "macros/regex/regexp_instr.sql", "unique_id": "macro.dbt_expectations.redshift__regexp_instr", "macro_sql": "{% macro redshift__regexp_instr(source_value, regexp, position, occurrence, is_raw, flags) %}\n{% if flags %}{{ dbt_expectations._validate_flags(flags, 'ciep') }}{% endif %}\nregexp_instr({{ source_value }}, '{{ regexp }}', {{ position }}, {{ occurrence }}, 0, '{{ flags }}')\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_expectations._validate_flags"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.486103, "supported_languages": null}, "macro.dbt_expectations.duckdb__regexp_instr": {"name": "duckdb__regexp_instr", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/regex/regexp_instr.sql", "original_file_path": "macros/regex/regexp_instr.sql", "unique_id": "macro.dbt_expectations.duckdb__regexp_instr", "macro_sql": "{% macro duckdb__regexp_instr(source_value, regexp, position, occurrence, is_raw, flags) %}\n{% if flags %}{{ dbt_expectations._validate_flags(flags, 'ciep') }}{% endif %}\nregexp_matches({{ source_value }}, '{{ regexp }}', '{{ flags }}')\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_expectations._validate_flags"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4862661, "supported_languages": null}, "macro.dbt_expectations.spark__regexp_instr": {"name": "spark__regexp_instr", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/regex/regexp_instr.sql", "original_file_path": "macros/regex/regexp_instr.sql", "unique_id": "macro.dbt_expectations.spark__regexp_instr", "macro_sql": "{% macro spark__regexp_instr(source_value, regexp, position, occurrence, is_raw, flags) %}\n{% if is_raw or flags %}\n    {{ exceptions.warn(\n            \"is_raw and flags options are not supported for this adapter \"\n            ~ \"and are being ignored.\"\n    ) }}\n{% endif %}\nlength(regexp_extract({{ source_value }}, '{{ regexp }}', 0))\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.486434, "supported_languages": null}, "macro.dbt_expectations.trino__regexp_instr": {"name": "trino__regexp_instr", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/regex/regexp_instr.sql", "original_file_path": "macros/regex/regexp_instr.sql", "unique_id": "macro.dbt_expectations.trino__regexp_instr", "macro_sql": "{% macro trino__regexp_instr(source_value, regexp, position, occurrence, is_raw, flags) %}\n    {% if flags %}\n        {{ dbt_expectations._validate_re2_flags(flags) }}\n        {# Trino prepends \"(?flags)\" to set flags for current group #}\n        {%- set regexp = \"(?\" ~ flags ~ \")\" ~ regexp -%}\n    {% endif %}\n    {% if is_raw %}\n        {{ exceptions.warn(\n                \"is_raw option is not supported for this adapter \"\n                ~ \"and is being ignored.\"\n        ) }}\n    {% endif %}\n    {%- set regexp_query = \"regexp_position(\" ~ source_value ~ \", '\" ~ regexp ~ \"', \" ~ position ~ \", \" ~ occurrence ~ \")\" -%}\n    {# Trino regexp_position returns -1 if not found. Change it to 0, to be consistent with other adapters #}\n    if({{ regexp_query}} = -1, 0, {{ regexp_query}})\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_expectations._validate_re2_flags"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.48677, "supported_languages": null}, "macro.dbt_expectations._validate_flags": {"name": "_validate_flags", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/regex/regexp_instr.sql", "original_file_path": "macros/regex/regexp_instr.sql", "unique_id": "macro.dbt_expectations._validate_flags", "macro_sql": "{% macro _validate_flags(flags, alphabet) %}\n{% for flag in flags %}\n    {% if flag not in alphabet %}\n    {# Using raise_compiler_error causes disabled tests with invalid flags to fail compilation #}\n    {{ exceptions.warn(\n        \"flag \" ~ flag ~ \" not in list of allowed flags for this adapter: \" ~ alphabet | join(\", \")\n    ) }}\n    {% endif %}\n{% endfor %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.486974, "supported_languages": null}, "macro.dbt_expectations._validate_re2_flags": {"name": "_validate_re2_flags", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/regex/regexp_instr.sql", "original_file_path": "macros/regex/regexp_instr.sql", "unique_id": "macro.dbt_expectations._validate_re2_flags", "macro_sql": "{% macro _validate_re2_flags(flags) %}\n{# Re2 supports following flags: #}\n{# i  :  case-insensitive (default fault) #}\n{# m  :  multi-line mode: ^ and $ match begin/end line in addition to begin/end text (default false) #}\n{# s  :  let . match \\n (default false) #}\n{# U  :  ungreedy: swap meaning of x* and x*?, x+ and x+?, etc (default false) #}\n{# Flag syntax is xyz (set) or -xyz (clear) or xy-z (set xy, clear z).  #}\n\n{# Regex explanation: do not allow consecutive dashes, accept all re2 flags and clear operator, do not end with a dash  #}\n{% set re2_flags_pattern = '^(?!.*--)[-imsU]*(?<!-)$' %}\n{% set re = modules.re %}\n{% set is_match = re.match(re2_flags_pattern, flags) %}\n{% if not is_match %}\n    {# Using raise_compiler_error causes disabled tests with invalid flags to fail compilation #}\n    {{ exceptions.warn(\n        \"flags \" ~ flags ~ \" isn't a valid re2 flag pattern\"\n    ) }}\n{% endif %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.487231, "supported_languages": null}, "macro.dbt_expectations.log_natural": {"name": "log_natural", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/math/log_natural.sql", "original_file_path": "macros/math/log_natural.sql", "unique_id": "macro.dbt_expectations.log_natural", "macro_sql": "{% macro log_natural(x) -%}\n    {{ adapter.dispatch('log_natural', 'dbt_expectations') (x) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_expectations.snowflake__log_natural"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.487403, "supported_languages": null}, "macro.dbt_expectations.default__log_natural": {"name": "default__log_natural", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/math/log_natural.sql", "original_file_path": "macros/math/log_natural.sql", "unique_id": "macro.dbt_expectations.default__log_natural", "macro_sql": "{% macro default__log_natural(x) -%}\n\n    ln({{ x }})\n\n{%- endmacro -%}\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.487467, "supported_languages": null}, "macro.dbt_expectations.bigquery__log_natural": {"name": "bigquery__log_natural", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/math/log_natural.sql", "original_file_path": "macros/math/log_natural.sql", "unique_id": "macro.dbt_expectations.bigquery__log_natural", "macro_sql": "{% macro bigquery__log_natural(x) -%}\n\n    ln({{ x }})\n\n{%- endmacro -%}\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.487527, "supported_languages": null}, "macro.dbt_expectations.snowflake__log_natural": {"name": "snowflake__log_natural", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/math/log_natural.sql", "original_file_path": "macros/math/log_natural.sql", "unique_id": "macro.dbt_expectations.snowflake__log_natural", "macro_sql": "{% macro snowflake__log_natural(x) -%}\n\n    ln({{ x }})\n\n{%- endmacro -%}\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.487587, "supported_languages": null}, "macro.dbt_expectations.spark__log_natural": {"name": "spark__log_natural", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/math/log_natural.sql", "original_file_path": "macros/math/log_natural.sql", "unique_id": "macro.dbt_expectations.spark__log_natural", "macro_sql": "{% macro spark__log_natural(x) -%}\n\n    ln({{ x }})\n\n{%- endmacro -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.487648, "supported_languages": null}, "macro.dbt_expectations.rand": {"name": "rand", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/math/rand.sql", "original_file_path": "macros/math/rand.sql", "unique_id": "macro.dbt_expectations.rand", "macro_sql": "{% macro rand() -%}\n    {{ adapter.dispatch('rand', 'dbt_expectations') () }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_expectations.snowflake__rand"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.487805, "supported_languages": null}, "macro.dbt_expectations.default__rand": {"name": "default__rand", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/math/rand.sql", "original_file_path": "macros/math/rand.sql", "unique_id": "macro.dbt_expectations.default__rand", "macro_sql": "{% macro default__rand() -%}\n\n    rand()\n\n{%- endmacro -%}\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.487851, "supported_languages": null}, "macro.dbt_expectations.bigquery__rand": {"name": "bigquery__rand", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/math/rand.sql", "original_file_path": "macros/math/rand.sql", "unique_id": "macro.dbt_expectations.bigquery__rand", "macro_sql": "{% macro bigquery__rand() -%}\n\n    rand()\n\n{%- endmacro -%}\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.487896, "supported_languages": null}, "macro.dbt_expectations.snowflake__rand": {"name": "snowflake__rand", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/math/rand.sql", "original_file_path": "macros/math/rand.sql", "unique_id": "macro.dbt_expectations.snowflake__rand", "macro_sql": "{% macro snowflake__rand(seed) -%}\n\n    uniform(0::float, 1::float, random())\n\n{%- endmacro -%}\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.487943, "supported_languages": null}, "macro.dbt_expectations.postgres__rand": {"name": "postgres__rand", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/math/rand.sql", "original_file_path": "macros/math/rand.sql", "unique_id": "macro.dbt_expectations.postgres__rand", "macro_sql": "{% macro postgres__rand() -%}\n\n    random()\n\n{%- endmacro -%}\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4879858, "supported_languages": null}, "macro.dbt_expectations.redshift__rand": {"name": "redshift__rand", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/math/rand.sql", "original_file_path": "macros/math/rand.sql", "unique_id": "macro.dbt_expectations.redshift__rand", "macro_sql": "{% macro redshift__rand() -%}\n\n    random()\n\n{%- endmacro -%}\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4880261, "supported_languages": null}, "macro.dbt_expectations.duckdb__rand": {"name": "duckdb__rand", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/math/rand.sql", "original_file_path": "macros/math/rand.sql", "unique_id": "macro.dbt_expectations.duckdb__rand", "macro_sql": "{% macro duckdb__rand() -%}\n\n    random()\n\n{%- endmacro -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4880672, "supported_languages": null}, "macro.dbt_expectations.median": {"name": "median", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/math/median.sql", "original_file_path": "macros/math/median.sql", "unique_id": "macro.dbt_expectations.median", "macro_sql": "{% macro median(field) %}\n{{ dbt_expectations.percentile_cont(field, 0.5) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_expectations.percentile_cont"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4881878, "supported_languages": null}, "macro.dbt_expectations.percentile_cont": {"name": "percentile_cont", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/math/percentile_cont.sql", "original_file_path": "macros/math/percentile_cont.sql", "unique_id": "macro.dbt_expectations.percentile_cont", "macro_sql": "{% macro percentile_cont(field, quantile, partition=None) %}\n  {{ adapter.dispatch('quantile', 'dbt_expectations') (field, quantile, partition) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_expectations.default__quantile"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.488416, "supported_languages": null}, "macro.dbt_expectations.default__quantile": {"name": "default__quantile", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/math/percentile_cont.sql", "original_file_path": "macros/math/percentile_cont.sql", "unique_id": "macro.dbt_expectations.default__quantile", "macro_sql": "{% macro default__quantile(field, quantile, partition)  -%}\n    percentile_cont({{ quantile }}) within group (order by {{ field }})\n    {%- if partition %}over(partition by {{ partition }}){% endif -%}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4885361, "supported_languages": null}, "macro.dbt_expectations.bigquery__quantile": {"name": "bigquery__quantile", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/math/percentile_cont.sql", "original_file_path": "macros/math/percentile_cont.sql", "unique_id": "macro.dbt_expectations.bigquery__quantile", "macro_sql": "{% macro bigquery__quantile(field, quantile, partition) -%}\n    percentile_cont({{ field }}, {{ quantile }})\n    over({%- if partition %}partition by {{ partition }}{% endif -%})\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.488653, "supported_languages": null}, "macro.dbt_expectations.spark__quantile": {"name": "spark__quantile", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/math/percentile_cont.sql", "original_file_path": "macros/math/percentile_cont.sql", "unique_id": "macro.dbt_expectations.spark__quantile", "macro_sql": "{% macro spark__quantile(field, quantile, partition) -%}\n    percentile({{ field }}, {{ quantile }})\n    over({%- if partition %}partition by {{ partition }}{% endif -%})\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.488768, "supported_languages": null}, "macro.dbt_expectations.ignore_row_if_expression": {"name": "ignore_row_if_expression", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/_generalized/_ignore_row_if_expression.sql", "original_file_path": "macros/schema_tests/_generalized/_ignore_row_if_expression.sql", "unique_id": "macro.dbt_expectations.ignore_row_if_expression", "macro_sql": "{% macro ignore_row_if_expression(ignore_row_if, columns) %}\n    {{ adapter.dispatch('ignore_row_if_expression', 'dbt_expectations') (ignore_row_if, columns) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_expectations.default__ignore_row_if_expression"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.488986, "supported_languages": null}, "macro.dbt_expectations.default__ignore_row_if_expression": {"name": "default__ignore_row_if_expression", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/_generalized/_ignore_row_if_expression.sql", "original_file_path": "macros/schema_tests/_generalized/_ignore_row_if_expression.sql", "unique_id": "macro.dbt_expectations.default__ignore_row_if_expression", "macro_sql": "{% macro default__ignore_row_if_expression(ignore_row_if, columns) %}\n  {%- set ignore_row_if_values = [\"all_values_are_missing\", \"any_value_is_missing\"] -%}\n    {% if ignore_row_if not in ignore_row_if_values %}\n        {{ exceptions.raise_compiler_error(\n            \"`ignore_row_if` must be one of \" ~ (ignore_row_if_values | join(\", \")) ~ \". Got: '\" ~ ignore_row_if ~\"'.'\"\n        ) }}\n    {% endif %}\n\n    {%- set op = \"and\" if ignore_row_if == \"all_values_are_missing\" else \"or\" -%}\n    not (\n        {% for column in columns -%}\n        {{ column }} is null{% if not loop.last %} {{ op }} {% endif %}\n        {% endfor %}\n    )\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4893281, "supported_languages": null}, "macro.dbt_expectations.test_expression_between": {"name": "test_expression_between", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/_generalized/expression_between.sql", "original_file_path": "macros/schema_tests/_generalized/expression_between.sql", "unique_id": "macro.dbt_expectations.test_expression_between", "macro_sql": "{% test expression_between(model,\n                                 expression,\n                                 min_value=None,\n                                 max_value=None,\n                                 group_by_columns=None,\n                                 row_condition=None,\n                                 strictly=False\n                                 ) %}\n\n    {{ dbt_expectations.expression_between(model, expression, min_value, max_value, group_by_columns, row_condition, strictly) }}\n\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.expression_between"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.489674, "supported_languages": null}, "macro.dbt_expectations.expression_between": {"name": "expression_between", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/_generalized/expression_between.sql", "original_file_path": "macros/schema_tests/_generalized/expression_between.sql", "unique_id": "macro.dbt_expectations.expression_between", "macro_sql": "{% macro expression_between(model,\n                            expression,\n                            min_value,\n                            max_value,\n                            group_by_columns,\n                            row_condition,\n                            strictly\n                            ) %}\n\n{%- if min_value is none and max_value is none -%}\n{{ exceptions.raise_compiler_error(\n    \"You have to provide either a min_value, max_value or both.\"\n) }}\n{%- endif -%}\n\n{%- set strict_operator = \"\" if strictly else \"=\" -%}\n\n{% set expression_min_max %}\n( 1=1\n{%- if min_value is not none %} and {{ expression | trim }} >{{ strict_operator }} {{ min_value }}{% endif %}\n{%- if max_value is not none %} and {{ expression | trim }} <{{ strict_operator }} {{ max_value }}{% endif %}\n)\n{% endset %}\n\n{{ dbt_expectations.expression_is_true(model,\n                                        expression=expression_min_max,\n                                        group_by_columns=group_by_columns,\n                                        row_condition=row_condition)\n                                        }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_expectations.expression_is_true"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.490093, "supported_languages": null}, "macro.dbt_expectations.test_expression_is_true": {"name": "test_expression_is_true", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/_generalized/expression_is_true.sql", "original_file_path": "macros/schema_tests/_generalized/expression_is_true.sql", "unique_id": "macro.dbt_expectations.test_expression_is_true", "macro_sql": "{% test expression_is_true(model,\n                                 expression,\n                                 test_condition=\"= true\",\n                                 group_by_columns=None,\n                                 row_condition=None\n                                 ) %}\n\n    {{ dbt_expectations.expression_is_true(model, expression, test_condition, group_by_columns, row_condition) }}\n\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.expression_is_true"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.490551, "supported_languages": null}, "macro.dbt_expectations.expression_is_true": {"name": "expression_is_true", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/_generalized/expression_is_true.sql", "original_file_path": "macros/schema_tests/_generalized/expression_is_true.sql", "unique_id": "macro.dbt_expectations.expression_is_true", "macro_sql": "{% macro expression_is_true(model,\n                                 expression,\n                                 test_condition=\"= true\",\n                                 group_by_columns=None,\n                                 row_condition=None\n                                 ) %}\n    {{ adapter.dispatch('expression_is_true', 'dbt_expectations') (model, expression, test_condition, group_by_columns, row_condition) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_expectations.default__expression_is_true"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.490743, "supported_languages": null}, "macro.dbt_expectations.default__expression_is_true": {"name": "default__expression_is_true", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/_generalized/expression_is_true.sql", "original_file_path": "macros/schema_tests/_generalized/expression_is_true.sql", "unique_id": "macro.dbt_expectations.default__expression_is_true", "macro_sql": "{% macro default__expression_is_true(model, expression, test_condition, group_by_columns, row_condition) -%}\nwith grouped_expression as (\n    select\n        {% if group_by_columns %}\n        {% for group_by_column in group_by_columns -%}\n        {{ group_by_column }} as col_{{ loop.index }},\n        {% endfor -%}\n        {% endif %}\n        {{ dbt_expectations.truth_expression(expression) }}\n    from {{ model }}\n     {%- if row_condition %}\n    where\n        {{ row_condition }}\n    {% endif %}\n    {% if group_by_columns %}\n    group by\n    {% for group_by_column in group_by_columns -%}\n        {{ group_by_column }}{% if not loop.last %},{% endif %}\n    {% endfor %}\n    {% endif %}\n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression {{ test_condition }})\n\n)\n\nselect *\nfrom validation_errors\n\n\n{% endmacro -%}", "depends_on": {"macros": ["macro.dbt_expectations.truth_expression"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4911091, "supported_languages": null}, "macro.dbt_expectations.get_select": {"name": "get_select", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/_generalized/equal_expression.sql", "original_file_path": "macros/schema_tests/_generalized/equal_expression.sql", "unique_id": "macro.dbt_expectations.get_select", "macro_sql": "{% macro get_select(model, expression, row_condition, group_by) -%}\n    {{ adapter.dispatch('get_select', 'dbt_expectations') (model, expression, row_condition, group_by) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_expectations.default__get_select"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4916081, "supported_languages": null}, "macro.dbt_expectations.default__get_select": {"name": "default__get_select", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/_generalized/equal_expression.sql", "original_file_path": "macros/schema_tests/_generalized/equal_expression.sql", "unique_id": "macro.dbt_expectations.default__get_select", "macro_sql": "\n\n{%- macro default__get_select(model, expression, row_condition, group_by) %}\n    select\n        {% if group_by %}\n        {% for g in group_by -%}\n            {{ g }} as col_{{ loop.index }},\n        {% endfor -%}\n        {% endif %}\n        {{ expression }} as expression\n    from\n        {{ model }}\n    {%- if row_condition %}\n    where\n        {{ row_condition }}\n    {% endif %}\n    {% if group_by %}\n    group by\n        {% for g in group_by -%}\n            {{ loop.index }}{% if not loop.last %},{% endif %}\n        {% endfor %}\n    {% endif %}\n{% endmacro -%}\n\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.491931, "supported_languages": null}, "macro.dbt_expectations.test_equal_expression": {"name": "test_equal_expression", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/_generalized/equal_expression.sql", "original_file_path": "macros/schema_tests/_generalized/equal_expression.sql", "unique_id": "macro.dbt_expectations.test_equal_expression", "macro_sql": "{% test equal_expression(model, expression,\n                                compare_model=None,\n                                compare_expression=None,\n                                group_by=None,\n                                compare_group_by=None,\n                                row_condition=None,\n                                compare_row_condition=None,\n                                tolerance=0.0,\n                                tolerance_percent=None\n                                ) -%}\n\n    {{ adapter.dispatch('test_equal_expression', 'dbt_expectations') (\n                                model,\n                                expression,\n                                compare_model,\n                                compare_expression,\n                                group_by,\n                                compare_group_by,\n                                row_condition,\n                                compare_row_condition,\n                                tolerance,\n                                tolerance_percent) }}\n{%- endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.default__test_equal_expression"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.49221, "supported_languages": null}, "macro.dbt_expectations.default__test_equal_expression": {"name": "default__test_equal_expression", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/_generalized/equal_expression.sql", "original_file_path": "macros/schema_tests/_generalized/equal_expression.sql", "unique_id": "macro.dbt_expectations.default__test_equal_expression", "macro_sql": "\n\n{%- macro default__test_equal_expression(\n                                model,\n                                expression,\n                                compare_model,\n                                compare_expression,\n                                group_by,\n                                compare_group_by,\n                                row_condition,\n                                compare_row_condition,\n                                tolerance,\n                                tolerance_percent) -%}\n\n    {%- set compare_model = model if not compare_model else compare_model -%}\n    {%- set compare_expression = expression if not compare_expression else compare_expression -%}\n    {%- set compare_row_condition = row_condition if not compare_row_condition else compare_row_condition -%}\n    {%- set compare_group_by = group_by if not compare_group_by else compare_group_by -%}\n\n    {%- set n_cols = (group_by|length) if group_by else 0 %}\n    with a as (\n        {{ dbt_expectations.get_select(model, expression, row_condition, group_by) }}\n    ),\n    b as (\n        {{ dbt_expectations.get_select(compare_model, compare_expression, compare_row_condition, compare_group_by) }}\n    ),\n    final as (\n\n        select\n            {% for i in range(1, n_cols + 1) -%}\n            coalesce(a.col_{{ i }}, b.col_{{ i }}) as col_{{ i }},\n            {% endfor %}\n            a.expression,\n            b.expression as compare_expression,\n            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0)) as expression_difference,\n            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0))/\n                nullif(a.expression * 1.0, 0) as expression_difference_percent\n        from\n        {% if n_cols > 0 %}\n            a\n            full outer join\n            b on\n            {% for i in range(1, n_cols + 1) -%}\n                a.col_{{ i }} = b.col_{{ i }} {% if not loop.last %}and{% endif %}\n            {% endfor -%}\n        {% else %}\n            a cross join b\n        {% endif %}\n    )\n    -- DEBUG:\n    -- select * from final\n    select\n        *\n    from final\n    where\n        {% if tolerance_percent %}\n        expression_difference_percent > {{ tolerance_percent }}\n        {% else %}\n        expression_difference > {{ tolerance }}\n        {% endif %}\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt_expectations.get_select"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.492934, "supported_languages": null}, "macro.dbt_expectations.truth_expression": {"name": "truth_expression", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/_generalized/_truth_expression.sql", "original_file_path": "macros/schema_tests/_generalized/_truth_expression.sql", "unique_id": "macro.dbt_expectations.truth_expression", "macro_sql": "{% macro truth_expression(expression) %}\n    {{ adapter.dispatch('truth_expression', 'dbt_expectations') (expression) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_expectations.default__truth_expression"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.493088, "supported_languages": null}, "macro.dbt_expectations.default__truth_expression": {"name": "default__truth_expression", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/_generalized/_truth_expression.sql", "original_file_path": "macros/schema_tests/_generalized/_truth_expression.sql", "unique_id": "macro.dbt_expectations.default__truth_expression", "macro_sql": "{% macro default__truth_expression(expression) %}\n  {{ expression }} as expression\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.493154, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_values_to_match_like_pattern": {"name": "test_expect_column_values_to_match_like_pattern", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/string_matching/expect_column_values_to_match_like_pattern.sql", "original_file_path": "macros/schema_tests/string_matching/expect_column_values_to_match_like_pattern.sql", "unique_id": "macro.dbt_expectations.test_expect_column_values_to_match_like_pattern", "macro_sql": "{% test expect_column_values_to_match_like_pattern(model, column_name,\n                                                    like_pattern,\n                                                    row_condition=None\n                                                    ) %}\n\n{% set expression = dbt_expectations._get_like_pattern_expression(column_name, like_pattern, positive=True) %}\n\n{{ dbt_expectations.expression_is_true(model,\n                                        expression=expression,\n                                        group_by_columns=None,\n                                        row_condition=row_condition\n                                        )\n                                        }}\n\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_expectations._get_like_pattern_expression", "macro.dbt_expectations.expression_is_true"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4934368, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_values_to_match_like_pattern_list": {"name": "test_expect_column_values_to_match_like_pattern_list", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/string_matching/expect_column_values_to_match_like_pattern_list.sql", "original_file_path": "macros/schema_tests/string_matching/expect_column_values_to_match_like_pattern_list.sql", "unique_id": "macro.dbt_expectations.test_expect_column_values_to_match_like_pattern_list", "macro_sql": "{% test expect_column_values_to_match_like_pattern_list(model, column_name,\n                                                    like_pattern_list,\n                                                    match_on=\"any\",\n                                                    row_condition=None\n                                                    ) %}\n\n{% set expression %}\n    {% for like_pattern in like_pattern_list %}\n    {{ dbt_expectations._get_like_pattern_expression(column_name, like_pattern, positive=True) }}\n    {%- if not loop.last %}\n    {{ \" and \" if match_on == \"all\" else \" or \"}}\n    {% endif -%}\n    {% endfor %}\n{% endset %}\n\n{{ dbt_expectations.expression_is_true(model,\n                                        expression=expression,\n                                        group_by_columns=None,\n                                        row_condition=row_condition\n                                        )\n                                        }}\n\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_expectations._get_like_pattern_expression", "macro.dbt_expectations.expression_is_true"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.49389, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_values_to_match_regex": {"name": "test_expect_column_values_to_match_regex", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/string_matching/expect_column_values_to_match_regex.sql", "original_file_path": "macros/schema_tests/string_matching/expect_column_values_to_match_regex.sql", "unique_id": "macro.dbt_expectations.test_expect_column_values_to_match_regex", "macro_sql": "{% test expect_column_values_to_match_regex(model, column_name,\n                                                    regex,\n                                                    row_condition=None,\n                                                    is_raw=False,\n                                                    flags=\"\"\n                                                    ) %}\n\n{% set expression %}\n{{ dbt_expectations.regexp_instr(column_name, regex, is_raw=is_raw, flags=flags) }} > 0\n{% endset %}\n\n{{ dbt_expectations.expression_is_true(model,\n                                        expression=expression,\n                                        group_by_columns=None,\n                                        row_condition=row_condition\n                                        )\n                                        }}\n\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.regexp_instr", "macro.dbt_expectations.expression_is_true"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.494241, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_value_lengths_to_equal": {"name": "test_expect_column_value_lengths_to_equal", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/string_matching/expect_column_value_lengths_to_equal.sql", "original_file_path": "macros/schema_tests/string_matching/expect_column_value_lengths_to_equal.sql", "unique_id": "macro.dbt_expectations.test_expect_column_value_lengths_to_equal", "macro_sql": "{% test expect_column_value_lengths_to_equal(model, column_name,\n                                                    value,\n                                                    row_condition=None\n                                                    ) %}\n\n{% set expression = dbt.length(column_name) ~ \" = \" ~ value %}\n\n{{ dbt_expectations.expression_is_true(model,\n                                        expression=expression,\n                                        group_by_columns=None,\n                                        row_condition=row_condition\n                                        )\n                                        }}\n\n{% endtest %}", "depends_on": {"macros": ["macro.dbt.length", "macro.dbt_expectations.expression_is_true"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.49452, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_value_lengths_to_be_between": {"name": "test_expect_column_value_lengths_to_be_between", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/string_matching/expect_column_value_lengths_to_be_between.sql", "original_file_path": "macros/schema_tests/string_matching/expect_column_value_lengths_to_be_between.sql", "unique_id": "macro.dbt_expectations.test_expect_column_value_lengths_to_be_between", "macro_sql": "{% test expect_column_value_lengths_to_be_between(model, column_name,\n                                                         min_value=None,\n                                                         max_value=None,\n                                                         row_condition=None,\n                                                         strictly=False\n                                                      ) %}\n{% set expression %}\n{{ dbt.length(column_name) }}\n{% endset %}\n\n{{ dbt_expectations.expression_between(model,\n                                        expression=expression,\n                                        min_value=min_value,\n                                        max_value=max_value,\n                                        group_by_columns=None,\n                                        row_condition=row_condition,\n                                        strictly=strictly\n                                        ) }}\n\n{% endtest %}", "depends_on": {"macros": ["macro.dbt.length", "macro.dbt_expectations.expression_between"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.494894, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_values_to_not_match_regex": {"name": "test_expect_column_values_to_not_match_regex", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/string_matching/expect_column_values_to_not_match_regex.sql", "original_file_path": "macros/schema_tests/string_matching/expect_column_values_to_not_match_regex.sql", "unique_id": "macro.dbt_expectations.test_expect_column_values_to_not_match_regex", "macro_sql": "{% test expect_column_values_to_not_match_regex(model, column_name,\n                                                    regex,\n                                                    row_condition=None,\n                                                    is_raw=False,\n                                                    flags=\"\"\n                                                    ) %}\n\n{% set expression %}\n{{ dbt_expectations.regexp_instr(column_name, regex, is_raw=is_raw, flags=flags) }} = 0\n{% endset %}\n\n{{ dbt_expectations.expression_is_true(model,\n                                        expression=expression,\n                                        group_by_columns=None,\n                                        row_condition=row_condition\n                                        )\n                                        }}\n\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.regexp_instr", "macro.dbt_expectations.expression_is_true"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.495311, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_values_to_not_match_regex_list": {"name": "test_expect_column_values_to_not_match_regex_list", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/string_matching/expect_column_values_to_not_match_regex_list.sql", "original_file_path": "macros/schema_tests/string_matching/expect_column_values_to_not_match_regex_list.sql", "unique_id": "macro.dbt_expectations.test_expect_column_values_to_not_match_regex_list", "macro_sql": "{% test expect_column_values_to_not_match_regex_list(model, column_name,\n                                                    regex_list,\n                                                    match_on=\"any\",\n                                                    row_condition=None,\n                                                    is_raw=False,\n                                                    flags=\"\"\n                                                    ) %}\n\n{% set expression %}\n{% for regex in regex_list %}\n{{ dbt_expectations.regexp_instr(column_name, regex, is_raw=is_raw, flags=flags) }} = 0\n{%- if not loop.last %}\n{{ \" and \" if match_on == \"all\" else \" or \"}}\n{% endif -%}\n{% endfor %}\n{% endset %}\n\n{{ dbt_expectations.expression_is_true(model,\n                                        expression=expression,\n                                        group_by_columns=None,\n                                        row_condition=row_condition\n                                        )\n                                        }}\n\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.regexp_instr", "macro.dbt_expectations.expression_is_true"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.495869, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_values_to_match_regex_list": {"name": "test_expect_column_values_to_match_regex_list", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/string_matching/expect_column_values_to_match_regex_list.sql", "original_file_path": "macros/schema_tests/string_matching/expect_column_values_to_match_regex_list.sql", "unique_id": "macro.dbt_expectations.test_expect_column_values_to_match_regex_list", "macro_sql": "{% test expect_column_values_to_match_regex_list(model, column_name,\n                                                    regex_list,\n                                                    match_on=\"any\",\n                                                    row_condition=None,\n                                                    is_raw=False,\n                                                    flags=\"\"\n                                                    ) %}\n\n{% set expression %}\n    {% for regex in regex_list %}\n    {{ dbt_expectations.regexp_instr(column_name, regex, is_raw=is_raw, flags=flags) }} > 0\n    {%- if not loop.last %}\n    {{ \" and \" if match_on == \"all\" else \" or \"}}\n    {% endif -%}\n    {% endfor %}\n{% endset %}\n\n{{ dbt_expectations.expression_is_true(model,\n                                        expression=expression,\n                                        group_by_columns=None,\n                                        row_condition=row_condition\n                                        )\n                                        }}\n\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.regexp_instr", "macro.dbt_expectations.expression_is_true"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.496375, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_values_to_not_match_like_pattern_list": {"name": "test_expect_column_values_to_not_match_like_pattern_list", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/string_matching/expect_column_values_to_not_match_like_pattern_list.sql", "original_file_path": "macros/schema_tests/string_matching/expect_column_values_to_not_match_like_pattern_list.sql", "unique_id": "macro.dbt_expectations.test_expect_column_values_to_not_match_like_pattern_list", "macro_sql": "{% test expect_column_values_to_not_match_like_pattern_list(model, column_name,\n                                                    like_pattern_list,\n                                                    match_on=\"any\",\n                                                    row_condition=None\n                                                    ) %}\n\n{% set expression %}\n    {% for like_pattern in like_pattern_list %}\n    {{ dbt_expectations._get_like_pattern_expression(column_name, like_pattern, positive=False) }}\n    {%- if not loop.last %}\n    {{ \" and \" if match_on == \"all\" else \" or \"}}\n    {% endif -%}\n    {% endfor %}\n{% endset %}\n\n{{ dbt_expectations.expression_is_true(model,\n                                        expression=expression,\n                                        group_by_columns=None,\n                                        row_condition=row_condition\n                                        )\n                                        }}\n\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_expectations._get_like_pattern_expression", "macro.dbt_expectations.expression_is_true"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.496829, "supported_languages": null}, "macro.dbt_expectations._get_like_pattern_expression": {"name": "_get_like_pattern_expression", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/string_matching/_get_like_pattern_expression.sql", "original_file_path": "macros/schema_tests/string_matching/_get_like_pattern_expression.sql", "unique_id": "macro.dbt_expectations._get_like_pattern_expression", "macro_sql": "{% macro _get_like_pattern_expression(column_name, like_pattern, positive) %}\n{{ column_name }} {{ \"not\" if not positive else \"\" }} like '{{ like_pattern }}'\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4969878, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_values_to_not_match_like_pattern": {"name": "test_expect_column_values_to_not_match_like_pattern", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/string_matching/expect_column_values_to_not_match_like_pattern.sql", "original_file_path": "macros/schema_tests/string_matching/expect_column_values_to_not_match_like_pattern.sql", "unique_id": "macro.dbt_expectations.test_expect_column_values_to_not_match_like_pattern", "macro_sql": "{% test expect_column_values_to_not_match_like_pattern(model, column_name,\n                                                    like_pattern,\n                                                    row_condition=None\n                                                    ) %}\n\n{% set expression = dbt_expectations._get_like_pattern_expression(column_name, like_pattern, positive=False) %}\n\n{{ dbt_expectations.expression_is_true(model,\n                                        expression=expression,\n                                        group_by_columns=None,\n                                        row_condition=row_condition\n                                        )\n                                        }}\n\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_expectations._get_like_pattern_expression", "macro.dbt_expectations.expression_is_true"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.49727, "supported_languages": null}, "macro.dbt_expectations.test_expect_row_values_to_have_recent_data": {"name": "test_expect_row_values_to_have_recent_data", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/table_shape/expect_row_values_to_have_recent_data.sql", "original_file_path": "macros/schema_tests/table_shape/expect_row_values_to_have_recent_data.sql", "unique_id": "macro.dbt_expectations.test_expect_row_values_to_have_recent_data", "macro_sql": "{% test expect_row_values_to_have_recent_data(model,\n                                                column_name,\n                                                datepart,\n                                                interval,\n                                                row_condition=None) %}\n\n {{ adapter.dispatch('test_expect_row_values_to_have_recent_data', 'dbt_expectations') (model,\n                                                                                        column_name,\n                                                                                        datepart,\n                                                                                        interval,\n                                                                                        row_condition) }}\n\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.default__test_expect_row_values_to_have_recent_data"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.497671, "supported_languages": null}, "macro.dbt_expectations.default__test_expect_row_values_to_have_recent_data": {"name": "default__test_expect_row_values_to_have_recent_data", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/table_shape/expect_row_values_to_have_recent_data.sql", "original_file_path": "macros/schema_tests/table_shape/expect_row_values_to_have_recent_data.sql", "unique_id": "macro.dbt_expectations.default__test_expect_row_values_to_have_recent_data", "macro_sql": "{% macro default__test_expect_row_values_to_have_recent_data(model, column_name, datepart, interval, row_condition) %}\n{%- set default_start_date = '1970-01-01' -%}\nwith max_recency as (\n\n    select max(cast({{ column_name }} as {{ dbt_expectations.type_timestamp() }})) as max_timestamp\n    from\n        {{ model }}\n    where\n        -- to exclude erroneous future dates\n        cast({{ column_name }} as {{ dbt_expectations.type_timestamp() }}) <= {{ dbt_date.now() }}\n        {% if row_condition %}\n        and {{ row_condition }}\n        {% endif %}\n)\nselect\n    *\nfrom\n    max_recency\nwhere\n    -- if the row_condition excludes all rows, we need to compare against a default date\n    -- to avoid false negatives\n    coalesce(max_timestamp, cast('{{ default_start_date }}' as {{ dbt_expectations.type_timestamp() }}))\n        <\n        cast({{ dbt.dateadd(datepart, interval * -1, dbt_date.now()) }} as {{ dbt_expectations.type_timestamp() }})\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_expectations.type_timestamp", "macro.dbt_date.now", "macro.dbt.dateadd"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.498034, "supported_languages": null}, "macro.dbt_expectations.test_expect_table_columns_to_contain_set": {"name": "test_expect_table_columns_to_contain_set", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/table_shape/expect_table_columns_to_contain_set.sql", "original_file_path": "macros/schema_tests/table_shape/expect_table_columns_to_contain_set.sql", "unique_id": "macro.dbt_expectations.test_expect_table_columns_to_contain_set", "macro_sql": "{%- test expect_table_columns_to_contain_set(model, column_list, transform=\"upper\") -%}\n{%- if execute -%}\n    {%- set column_list = column_list | map(transform) | list -%}\n    {%- set relation_column_names = dbt_expectations._get_column_list(model, transform) -%}\n    {%- set matching_columns = dbt_expectations._list_intersect(column_list, relation_column_names) -%}\n    with relation_columns as (\n\n        {% for col_name in relation_column_names %}\n        select cast('{{ col_name }}' as {{ dbt.type_string() }}) as relation_column\n        {% if not loop.last %}union all{% endif %}\n        {% endfor %}\n    ),\n    input_columns as (\n\n        {% for col_name in column_list %}\n        select cast('{{ col_name }}' as {{ dbt.type_string() }}) as input_column\n        {% if not loop.last %}union all{% endif %}\n        {% endfor %}\n    )\n    select *\n    from\n        input_columns i\n        left join\n        relation_columns r on r.relation_column = i.input_column\n    where\n        -- catch any column in input list that is not in the list of table columns\n        r.relation_column is null\n{%- endif -%}\n{%- endtest -%}", "depends_on": {"macros": ["macro.dbt_expectations._get_column_list", "macro.dbt_expectations._list_intersect", "macro.dbt.type_string"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.498574, "supported_languages": null}, "macro.dbt_expectations.test_expect_table_row_count_to_equal_other_table": {"name": "test_expect_table_row_count_to_equal_other_table", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/table_shape/expect_table_row_count_to_equal_other_table.sql", "original_file_path": "macros/schema_tests/table_shape/expect_table_row_count_to_equal_other_table.sql", "unique_id": "macro.dbt_expectations.test_expect_table_row_count_to_equal_other_table", "macro_sql": "{%- test expect_table_row_count_to_equal_other_table(model,\n                                            compare_model,\n                                            group_by=None,\n                                            compare_group_by=None,\n                                            factor=1,\n                                            row_condition=None,\n                                            compare_row_condition=None\n                                        ) -%}\n\n    {{ adapter.dispatch('test_expect_table_row_count_to_equal_other_table',\n                        'dbt_expectations') (model,\n                                                compare_model,\n                                                group_by,\n                                                compare_group_by,\n                                                factor,\n                                                row_condition,\n                                                compare_row_condition\n                                            ) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.default__test_expect_table_row_count_to_equal_other_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.498975, "supported_languages": null}, "macro.dbt_expectations.default__test_expect_table_row_count_to_equal_other_table": {"name": "default__test_expect_table_row_count_to_equal_other_table", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/table_shape/expect_table_row_count_to_equal_other_table.sql", "original_file_path": "macros/schema_tests/table_shape/expect_table_row_count_to_equal_other_table.sql", "unique_id": "macro.dbt_expectations.default__test_expect_table_row_count_to_equal_other_table", "macro_sql": "\n\n{%- macro default__test_expect_table_row_count_to_equal_other_table(model,\n                                                    compare_model,\n                                                    group_by,\n                                                    compare_group_by,\n                                                    factor,\n                                                    row_condition,\n                                                    compare_row_condition\n                                                    ) -%}\n{{ dbt_expectations.test_equal_expression(model, \"count(*)\",\n    compare_model=compare_model,\n    compare_expression=\"count(*) * \" + factor|string,\n    group_by=group_by,\n    compare_group_by=compare_group_by,\n    row_condition=row_condition,\n    compare_row_condition=compare_row_condition\n) }}\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt_expectations.test_equal_expression"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4991791, "supported_languages": null}, "macro.dbt_expectations.test_expect_table_columns_to_not_contain_set": {"name": "test_expect_table_columns_to_not_contain_set", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/table_shape/expect_table_columns_to_not_contain_set.sql", "original_file_path": "macros/schema_tests/table_shape/expect_table_columns_to_not_contain_set.sql", "unique_id": "macro.dbt_expectations.test_expect_table_columns_to_not_contain_set", "macro_sql": "{%- test expect_table_columns_to_not_contain_set(model, column_list, transform=\"upper\") -%}\n{%- if execute -%}\n    {%- set column_list = column_list | map(transform) | list -%}\n    {%- set relation_column_names = dbt_expectations._get_column_list(model, transform) -%}\n    {%- set matching_columns = dbt_expectations._list_intersect(column_list, relation_column_names) -%}\n    with relation_columns as (\n\n        {% for col_name in relation_column_names %}\n        select cast('{{ col_name }}' as {{ dbt.type_string() }}) as relation_column\n        {% if not loop.last %}union all{% endif %}\n        {% endfor %}\n    ),\n    input_columns as (\n\n        {% for col_name in column_list %}\n        select cast('{{ col_name }}' as {{ dbt.type_string() }}) as input_column\n        {% if not loop.last %}union all{% endif %}\n        {% endfor %}\n    )\n    -- catch any column in input list that is in the list of table columns\n    select *\n    from\n        input_columns i\n        inner join\n        relation_columns r on r.relation_column = i.input_column\n\n{%- endif -%}\n{%- endtest -%}", "depends_on": {"macros": ["macro.dbt_expectations._get_column_list", "macro.dbt_expectations._list_intersect", "macro.dbt.type_string"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.4997, "supported_languages": null}, "macro.dbt_expectations.test_expect_grouped_row_values_to_have_recent_data": {"name": "test_expect_grouped_row_values_to_have_recent_data", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/table_shape/expect_grouped_row_values_to_have_recent_data.sql", "original_file_path": "macros/schema_tests/table_shape/expect_grouped_row_values_to_have_recent_data.sql", "unique_id": "macro.dbt_expectations.test_expect_grouped_row_values_to_have_recent_data", "macro_sql": "{% test expect_grouped_row_values_to_have_recent_data(model,\n                                                        group_by,\n                                                        timestamp_column,\n                                                        datepart,\n                                                        interval,\n                                                        row_condition=None) %}\n\n {{ adapter.dispatch('test_expect_grouped_row_values_to_have_recent_data', 'dbt_expectations') (model,\n                                                                                                group_by,\n                                                                                                timestamp_column,\n                                                                                                datepart,\n                                                                                                interval,\n                                                                                                row_condition) }}\n\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.default__test_expect_grouped_row_values_to_have_recent_data"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.500279, "supported_languages": null}, "macro.dbt_expectations.default__test_expect_grouped_row_values_to_have_recent_data": {"name": "default__test_expect_grouped_row_values_to_have_recent_data", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/table_shape/expect_grouped_row_values_to_have_recent_data.sql", "original_file_path": "macros/schema_tests/table_shape/expect_grouped_row_values_to_have_recent_data.sql", "unique_id": "macro.dbt_expectations.default__test_expect_grouped_row_values_to_have_recent_data", "macro_sql": "{% macro default__test_expect_grouped_row_values_to_have_recent_data(model,\n                                                                        group_by,\n                                                                        timestamp_column,\n                                                                        datepart,\n                                                                        interval,\n                                                                        row_condition) %}\nwith latest_grouped_timestamps as (\n\n    select\n        {{ group_by | join(\",\") ~ \",\" if group_by }}\n        max(1) as join_key,\n        max(cast({{ timestamp_column }} as {{ dbt_expectations.type_timestamp() }})) as latest_timestamp_column\n    from\n        {{ model }}\n    where\n        -- to exclude erroneous future dates\n        cast({{ timestamp_column }} as {{ dbt_expectations.type_timestamp() }}) <= {{ dbt_date.now() }}\n        {% if row_condition %}\n        and {{ row_condition }}\n        {% endif %}\n\n    {% if group_by -%}\n    {{  dbt_expectations.group_by(group_by | length) }}\n    {%- endif %}\n),\ntotal_row_counts as (\n\n    select\n        {{ group_by | join(\",\") ~ \",\" if group_by }}\n        max(1) as join_key,\n        count(*) as row_count\n    from\n        latest_grouped_timestamps\n    {% if group_by -%}\n    {{  dbt_expectations.group_by(group_by | length) }}\n    {%- endif %}\n\n\n),\noutdated_grouped_timestamps as (\n\n    select *\n    from\n        latest_grouped_timestamps\n    where\n        -- are the max timestamps per group older than the specified cutoff?\n        latest_timestamp_column <\n            cast(\n                {{ dbt.dateadd(datepart, interval * -1, dbt_date.now()) }}\n                as {{ dbt_expectations.type_timestamp() }}\n            )\n\n),\nvalidation_errors as (\n\n    select\n        r.row_count,\n        t.*\n    from\n        total_row_counts r\n        left join\n        outdated_grouped_timestamps t\n        on\n            {% for g in group_by %}\n            r.{{ g }} = t.{{ g }} and\n            {% endfor %}\n            r.join_key = t.join_key\n    where\n        -- fail if either no rows were returned due to row_condition,\n        -- or the recency test returned failed rows\n        r.row_count = 0\n        or\n        t.join_key is not null\n\n)\nselect * from validation_errors\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_expectations.type_timestamp", "macro.dbt_date.now", "macro.dbt_expectations.group_by", "macro.dbt.dateadd"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.500931, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_to_exist": {"name": "test_expect_column_to_exist", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/table_shape/expect_column_to_exist.sql", "original_file_path": "macros/schema_tests/table_shape/expect_column_to_exist.sql", "unique_id": "macro.dbt_expectations.test_expect_column_to_exist", "macro_sql": "{%- test expect_column_to_exist(model, column_name, column_index=None, transform=\"upper\") -%}\n{%- if execute -%}\n\n    {%- set column_name = column_name | map(transform) | join -%}\n    {%- set relation_column_names = dbt_expectations._get_column_list(model, transform) -%}\n\n    {%- set matching_column_index = relation_column_names.index(column_name) if column_name in relation_column_names else -1 %}\n\n    {%- if column_index -%}\n\n        {%- set column_index_0 = column_index - 1 if column_index > 0 else 0 -%}\n\n        {%- set column_index_matches = true if matching_column_index == column_index_0 else false %}\n\n    {%- else -%}\n\n        {%- set column_index_matches = true -%}\n\n    {%- endif %}\n\n    with test_data as (\n\n        select\n            cast('{{ column_name }}' as {{ dbt.type_string() }}) as column_name,\n            {{ matching_column_index }} as matching_column_index,\n            {{ column_index_matches }} as column_index_matches\n\n    )\n    select *\n    from test_data\n    where\n        not(matching_column_index >= 0 and column_index_matches)\n\n{%- endif -%}\n{%- endtest -%}", "depends_on": {"macros": ["macro.dbt_expectations._get_column_list", "macro.dbt.type_string"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.5015051, "supported_languages": null}, "macro.dbt_expectations.test_expect_table_row_count_to_equal": {"name": "test_expect_table_row_count_to_equal", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/table_shape/expect_table_row_count_to_equal.sql", "original_file_path": "macros/schema_tests/table_shape/expect_table_row_count_to_equal.sql", "unique_id": "macro.dbt_expectations.test_expect_table_row_count_to_equal", "macro_sql": "{%- test expect_table_row_count_to_equal(model,\n                                            value,\n                                            group_by=None,\n                                            row_condition=None\n                                            ) -%}\n    {{ adapter.dispatch('test_expect_table_row_count_to_equal',\n                        'dbt_expectations') (model,\n                                                value,\n                                                group_by,\n                                                row_condition\n                                                ) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.default__test_expect_table_row_count_to_equal"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.501795, "supported_languages": null}, "macro.dbt_expectations.default__test_expect_table_row_count_to_equal": {"name": "default__test_expect_table_row_count_to_equal", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/table_shape/expect_table_row_count_to_equal.sql", "original_file_path": "macros/schema_tests/table_shape/expect_table_row_count_to_equal.sql", "unique_id": "macro.dbt_expectations.default__test_expect_table_row_count_to_equal", "macro_sql": "\n\n\n\n{%- macro default__test_expect_table_row_count_to_equal(model,\n                                                value,\n                                                group_by,\n                                                row_condition\n                                                ) -%}\n{% set expression %}\ncount(*) = {{ value }}\n{% endset %}\n{{ dbt_expectations.expression_is_true(model,\n    expression=expression,\n    group_by_columns=group_by,\n    row_condition=row_condition)\n    }}\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt_expectations.expression_is_true"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.501965, "supported_languages": null}, "macro.dbt_expectations.test_expect_table_row_count_to_be_between": {"name": "test_expect_table_row_count_to_be_between", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/table_shape/expect_table_row_count_to_be_between.sql", "original_file_path": "macros/schema_tests/table_shape/expect_table_row_count_to_be_between.sql", "unique_id": "macro.dbt_expectations.test_expect_table_row_count_to_be_between", "macro_sql": "{%- test expect_table_row_count_to_be_between(model,\n                                                min_value=None,\n                                                max_value=None,\n                                                group_by=None,\n                                                row_condition=None,\n                                                strictly=False\n                                            ) -%}\n    {{ adapter.dispatch('test_expect_table_row_count_to_be_between',\n                        'dbt_expectations') (model,\n                                                min_value,\n                                                max_value,\n                                                group_by,\n                                                row_condition,\n                                                strictly\n                                                ) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.default__test_expect_table_row_count_to_be_between"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.5023282, "supported_languages": null}, "macro.dbt_expectations.default__test_expect_table_row_count_to_be_between": {"name": "default__test_expect_table_row_count_to_be_between", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/table_shape/expect_table_row_count_to_be_between.sql", "original_file_path": "macros/schema_tests/table_shape/expect_table_row_count_to_be_between.sql", "unique_id": "macro.dbt_expectations.default__test_expect_table_row_count_to_be_between", "macro_sql": "\n\n{%- macro default__test_expect_table_row_count_to_be_between(model,\n                                                min_value,\n                                                max_value,\n                                                group_by,\n                                                row_condition,\n                                                strictly\n                                                ) -%}\n{% set expression %}\ncount(*)\n{% endset %}\n{{ dbt_expectations.expression_between(model,\n    expression=expression,\n    min_value=min_value,\n    max_value=max_value,\n    group_by_columns=group_by,\n    row_condition=row_condition,\n    strictly=strictly\n    ) }}\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt_expectations.expression_between"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.502527, "supported_languages": null}, "macro.dbt_expectations.test_expect_table_row_count_to_equal_other_table_times_factor": {"name": "test_expect_table_row_count_to_equal_other_table_times_factor", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/table_shape/expect_table_row_count_to_equal_other_table_times_factor.sql", "original_file_path": "macros/schema_tests/table_shape/expect_table_row_count_to_equal_other_table_times_factor.sql", "unique_id": "macro.dbt_expectations.test_expect_table_row_count_to_equal_other_table_times_factor", "macro_sql": "{%- test expect_table_row_count_to_equal_other_table_times_factor(model,\n                                                                    compare_model,\n                                                                    factor,\n                                                                    group_by=None,\n                                                                    compare_group_by=None,\n                                                                    row_condition=None,\n                                                                    compare_row_condition=None\n                                            ) -%}\n    {{ adapter.dispatch('test_expect_table_row_count_to_equal_other_table_times_factor',\n                        'dbt_expectations') (model,\n                                                compare_model,\n                                                factor,\n                                                group_by,\n                                                compare_group_by,\n                                                row_condition,\n                                                compare_row_condition\n                                            ) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.default__test_expect_table_row_count_to_equal_other_table_times_factor"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.502951, "supported_languages": null}, "macro.dbt_expectations.default__test_expect_table_row_count_to_equal_other_table_times_factor": {"name": "default__test_expect_table_row_count_to_equal_other_table_times_factor", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/table_shape/expect_table_row_count_to_equal_other_table_times_factor.sql", "original_file_path": "macros/schema_tests/table_shape/expect_table_row_count_to_equal_other_table_times_factor.sql", "unique_id": "macro.dbt_expectations.default__test_expect_table_row_count_to_equal_other_table_times_factor", "macro_sql": "\n\n{%- macro default__test_expect_table_row_count_to_equal_other_table_times_factor(model,\n                                                                    compare_model,\n                                                                    factor,\n                                                                    group_by,\n                                                                    compare_group_by,\n                                                                    row_condition,\n                                                                    compare_row_condition\n                                                                    ) -%}\n\n{{ dbt_expectations.test_expect_table_row_count_to_equal_other_table(model,\n    compare_model,\n    group_by=group_by,\n    compare_group_by=compare_group_by,\n    factor=factor,\n    row_condition=row_condition,\n    compare_row_condition=compare_row_condition\n) }}\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt_expectations.test_expect_table_row_count_to_equal_other_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.503137, "supported_languages": null}, "macro.dbt_expectations.test_expect_table_columns_to_match_set": {"name": "test_expect_table_columns_to_match_set", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/table_shape/expect_table_columns_to_match_set.sql", "original_file_path": "macros/schema_tests/table_shape/expect_table_columns_to_match_set.sql", "unique_id": "macro.dbt_expectations.test_expect_table_columns_to_match_set", "macro_sql": "{%- test expect_table_columns_to_match_set(model, column_list, transform=\"upper\") -%}\n{%- if execute -%}\n    {%- set column_list = column_list | map(transform) | list -%}\n    {%- set relation_column_names = dbt_expectations._get_column_list(model, transform) -%}\n    {%- set matching_columns = dbt_expectations._list_intersect(column_list, relation_column_names) -%}\n    with relation_columns as (\n\n        {% for col_name in relation_column_names %}\n        select cast('{{ col_name }}' as {{ dbt.type_string() }}) as relation_column\n        {% if not loop.last %}union all{% endif %}\n        {% endfor %}\n    ),\n    input_columns as (\n\n        {% for col_name in column_list %}\n        select cast('{{ col_name }}' as {{ dbt.type_string() }}) as input_column\n        {% if not loop.last %}union all{% endif %}\n        {% endfor %}\n    )\n    select *\n    from\n        relation_columns r\n        full outer join\n        input_columns i on r.relation_column = i.input_column\n    where\n        -- catch any column in input list that is not in the list of table columns\n        -- or any table column that is not in the input list\n        r.relation_column is null or\n        i.input_column is null\n\n{%- endif -%}\n{%- endtest -%}", "depends_on": {"macros": ["macro.dbt_expectations._get_column_list", "macro.dbt_expectations._list_intersect", "macro.dbt.type_string"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.503674, "supported_languages": null}, "macro.dbt_expectations._get_column_list": {"name": "_get_column_list", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/table_shape/_get_column_list.sql", "original_file_path": "macros/schema_tests/table_shape/_get_column_list.sql", "unique_id": "macro.dbt_expectations._get_column_list", "macro_sql": "{%- macro _get_column_list(model, transform=\"upper\") -%}\n{%- set relation_columns = adapter.get_columns_in_relation(model) -%}\n{%- set relation_column_names = relation_columns | map(attribute=\"name\") | map(transform) | list -%}\n{%- do return(relation_column_names) -%}\n{%- endmacro -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.503901, "supported_languages": null}, "macro.dbt_expectations.test_expect_table_columns_to_match_ordered_list": {"name": "test_expect_table_columns_to_match_ordered_list", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/table_shape/expect_table_columns_to_match_ordered_list.sql", "original_file_path": "macros/schema_tests/table_shape/expect_table_columns_to_match_ordered_list.sql", "unique_id": "macro.dbt_expectations.test_expect_table_columns_to_match_ordered_list", "macro_sql": "{%- test expect_table_columns_to_match_ordered_list(model, column_list, transform=\"upper\") -%}\n{%- if execute -%}\n    {%- set column_list = column_list | map(transform) | list -%}\n    {%- set relation_column_names = dbt_expectations._get_column_list(model, transform) -%}\n    {%- set matching_columns = dbt_expectations._list_intersect(column_list, relation_column_names) -%}\n    with relation_columns as (\n\n        {% for col_name in relation_column_names %}\n        select\n            {{ loop.index }} as relation_column_idx,\n            cast('{{ col_name }}' as {{ dbt.type_string() }}) as relation_column\n        {% if not loop.last %}union all{% endif %}\n        {% endfor %}\n    ),\n    input_columns as (\n\n        {% for col_name in column_list %}\n        select\n            {{ loop.index }} as input_column_idx,\n            cast('{{ col_name }}' as {{ dbt.type_string() }}) as input_column\n        {% if not loop.last %}union all{% endif %}\n        {% endfor %}\n    )\n    select *\n    from\n        relation_columns r\n        full outer join\n        input_columns i on r.relation_column = i.input_column and r.relation_column_idx = i.input_column_idx\n    where\n        -- catch any column in input list that is not in the sequence of table columns\n        -- or any table column that is not in the input sequence\n        r.relation_column is null or\n        i.input_column is null\n\n{%- endif -%}\n{%- endtest -%}", "depends_on": {"macros": ["macro.dbt_expectations._get_column_list", "macro.dbt_expectations._list_intersect", "macro.dbt.type_string"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.504491, "supported_languages": null}, "macro.dbt_expectations.test_expect_table_aggregation_to_equal_other_table": {"name": "test_expect_table_aggregation_to_equal_other_table", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/table_shape/expect_table_aggregation_to_equal_other_table.sql", "original_file_path": "macros/schema_tests/table_shape/expect_table_aggregation_to_equal_other_table.sql", "unique_id": "macro.dbt_expectations.test_expect_table_aggregation_to_equal_other_table", "macro_sql": "{%- test expect_table_aggregation_to_equal_other_table(model,\n                                                expression,\n                                                compare_model,\n                                                compare_expression=None,\n                                                group_by=None,\n                                                compare_group_by=None,\n                                                row_condition=None,\n                                                compare_row_condition=None,\n                                                tolerance=0.0,\n                                                tolerance_percent=None\n                                                ) -%}\n\n\n{{ dbt_expectations.test_equal_expression(\n    model,\n    expression=expression,\n    compare_model=compare_model,\n    compare_expression=compare_expression,\n    group_by=group_by,\n    compare_group_by=compare_group_by,\n    row_condition=row_condition,\n    compare_row_condition=compare_row_condition,\n    tolerance=tolerance,\n    tolerance_percent=tolerance_percent\n) }}\n\n{%- endtest -%}", "depends_on": {"macros": ["macro.dbt_expectations.test_equal_expression"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.504856, "supported_languages": null}, "macro.dbt_expectations._list_intersect": {"name": "_list_intersect", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/table_shape/_list_intersect.sql", "original_file_path": "macros/schema_tests/table_shape/_list_intersect.sql", "unique_id": "macro.dbt_expectations._list_intersect", "macro_sql": "{%- macro _list_intersect(list1, list2) -%}\n{%- set matching_items = [] -%}\n{%- for itm in list1 -%}\n    {%- if itm in list2 -%}\n        {%- do matching_items.append(itm) -%}\n    {%- endif -%}\n{%- endfor -%}\n{%- do return(matching_items) -%}\n{%- endmacro -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.505093, "supported_languages": null}, "macro.dbt_expectations.test_expect_table_column_count_to_equal_other_table": {"name": "test_expect_table_column_count_to_equal_other_table", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/table_shape/expect_table_column_count_to_equal_other_table.sql", "original_file_path": "macros/schema_tests/table_shape/expect_table_column_count_to_equal_other_table.sql", "unique_id": "macro.dbt_expectations.test_expect_table_column_count_to_equal_other_table", "macro_sql": "{%- test expect_table_column_count_to_equal_other_table(model, compare_model) -%}\n{%- if execute -%}\n{%- set number_columns = (adapter.get_columns_in_relation(model) | length) -%}\n{%- set compare_number_columns = (adapter.get_columns_in_relation(compare_model) | length) -%}\nwith test_data as (\n\n    select\n        {{ number_columns }} as number_columns,\n        {{ compare_number_columns }} as compare_number_columns\n\n)\nselect *\nfrom test_data\nwhere\n    number_columns != compare_number_columns\n{%- endif -%}\n{%- endtest -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.505346, "supported_languages": null}, "macro.dbt_expectations.test_expect_table_column_count_to_equal": {"name": "test_expect_table_column_count_to_equal", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/table_shape/expect_table_column_count_to_equal.sql", "original_file_path": "macros/schema_tests/table_shape/expect_table_column_count_to_equal.sql", "unique_id": "macro.dbt_expectations.test_expect_table_column_count_to_equal", "macro_sql": "{%- test expect_table_column_count_to_equal(model, value) -%}\n{%- if execute -%}\n{%- set number_actual_columns = (adapter.get_columns_in_relation(model) | length) -%}\nwith test_data as (\n\n    select\n        {{ number_actual_columns }} as number_actual_columns,\n        {{ value }} as value\n\n)\nselect *\nfrom test_data\nwhere\n    number_actual_columns != value\n{%- endif -%}\n{%- endtest -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.505548, "supported_languages": null}, "macro.dbt_expectations.test_expect_table_column_count_to_be_between": {"name": "test_expect_table_column_count_to_be_between", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/table_shape/expect_table_column_count_to_be_between.sql", "original_file_path": "macros/schema_tests/table_shape/expect_table_column_count_to_be_between.sql", "unique_id": "macro.dbt_expectations.test_expect_table_column_count_to_be_between", "macro_sql": "{%- test expect_table_column_count_to_be_between(model,\n                                                    min_value=None,\n                                                    max_value=None\n                                                    ) -%}\n{%- if min_value is none and max_value is none -%}\n{{ exceptions.raise_compiler_error(\n    \"You have to provide either a min_value, max_value or both.\"\n) }}\n{%- endif -%}\n{%- if execute -%}\n{%- set number_actual_columns = (adapter.get_columns_in_relation(model) | length) -%}\n\n{%- set expression %}\n( 1=1\n{%- if min_value %} and number_actual_columns >= min_value{% endif %}\n{%- if max_value %} and number_actual_columns <= max_value{% endif %}\n)\n{% endset -%}\n\nwith test_data as (\n\n    select\n        {{ number_actual_columns }} as number_actual_columns,\n        {{ min_value if min_value else 0 }} as min_value,\n        {{ max_value if max_value else 0 }} as max_value\n\n)\nselect *\nfrom test_data\nwhere\n    not {{ expression }}\n{%- endif -%}\n{%- endtest -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.5062752, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_values_to_not_be_in_set": {"name": "test_expect_column_values_to_not_be_in_set", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/column_values_basic/expect_column_values_to_not_be_in_set.sql", "original_file_path": "macros/schema_tests/column_values_basic/expect_column_values_to_not_be_in_set.sql", "unique_id": "macro.dbt_expectations.test_expect_column_values_to_not_be_in_set", "macro_sql": "{% test expect_column_values_to_not_be_in_set(model, column_name,\n                                                   value_set,\n                                                   quote_values=True,\n                                                   row_condition=None\n                                                   ) %}\n\nwith all_values as (\n\n    select\n        {{ column_name }} as value_field\n\n    from {{ model }}\n    {% if row_condition %}\n    where {{ row_condition }}\n    {% endif %}\n\n),\nset_values as (\n\n    {% for value in value_set -%}\n    select\n        {% if quote_values -%}\n        cast('{{ value }}' as {{ dbt.type_string() }})\n        {%- else -%}\n        {{ value }}\n        {%- endif %} as value_field\n    {% if not loop.last %}union all{% endif %}\n    {% endfor %}\n),\nvalidation_errors as (\n    -- values from the model that match the set\n    select\n        v.value_field\n    from\n        all_values v\n        join\n        set_values s on v.value_field = s.value_field\n\n)\n\nselect *\nfrom validation_errors\n\n{% endtest %}", "depends_on": {"macros": ["macro.dbt.type_string"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.506691, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_values_to_be_in_set": {"name": "test_expect_column_values_to_be_in_set", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/column_values_basic/expect_column_values_to_be_in_set.sql", "original_file_path": "macros/schema_tests/column_values_basic/expect_column_values_to_be_in_set.sql", "unique_id": "macro.dbt_expectations.test_expect_column_values_to_be_in_set", "macro_sql": "{% test expect_column_values_to_be_in_set(model, column_name,\n                                                   value_set,\n                                                   quote_values=True,\n                                                   row_condition=None\n                                                   ) %}\n\nwith all_values as (\n\n    select\n        {{ column_name }} as value_field\n\n    from {{ model }}\n    {% if row_condition %}\n    where {{ row_condition }}\n    {% endif %}\n\n),\nset_values as (\n\n    {% for value in value_set -%}\n    select\n        {% if quote_values -%}\n        cast('{{ value }}' as {{ dbt.type_string() }})\n        {%- else -%}\n        {{ value }}\n        {%- endif %} as value_field\n    {% if not loop.last %}union all{% endif %}\n    {% endfor %}\n),\nvalidation_errors as (\n    -- values from the model that are not in the set\n    select\n        v.value_field\n    from\n        all_values v\n        left join\n        set_values s on v.value_field = s.value_field\n    where\n        s.value_field is null\n\n)\n\nselect *\nfrom validation_errors\n\n{% endtest %}", "depends_on": {"macros": ["macro.dbt.type_string"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.507096, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_values_to_be_increasing": {"name": "test_expect_column_values_to_be_increasing", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/column_values_basic/expect_column_values_to_be_increasing.sql", "original_file_path": "macros/schema_tests/column_values_basic/expect_column_values_to_be_increasing.sql", "unique_id": "macro.dbt_expectations.test_expect_column_values_to_be_increasing", "macro_sql": "{% test expect_column_values_to_be_increasing(model, column_name,\n                                                   sort_column=None,\n                                                   strictly=True,\n                                                   row_condition=None,\n                                                   group_by=None,\n                                                   step=None) %}\n\n{%- set sort_column = column_name if not sort_column else sort_column -%}\n{%- set operator = \">\" if strictly else \">=\" -%}\nwith all_values as (\n\n    select\n        {{ sort_column }} as sort_column,\n        {%- if group_by -%}\n        {{ group_by | join(\", \") }},\n        {%- endif %}\n        {{ column_name }} as value_field\n    from {{ model }}\n    {% if row_condition %}\n    where {{ row_condition }}\n    {% endif %}\n\n),\nadd_lag_values as (\n\n    select\n        sort_column,\n        {%- if group_by -%}\n        {{ group_by | join(\", \") }},\n        {%- endif %}\n        value_field,\n        lag(value_field) over\n            {%- if not group_by -%}\n                (order by sort_column)\n            {%- else -%}\n                (partition by {{ group_by | join(\", \") }} order by sort_column)\n            {%- endif  %} as value_field_lag\n    from\n        all_values\n\n),\nvalidation_errors as (\n    select\n        *\n    from\n        add_lag_values\n    where\n        value_field_lag is not null\n        and\n        not (\n            (value_field {{ operator }} value_field_lag)\n            {%- if step %}\n            and ((value_field - value_field_lag) = {{ step }})\n            {%- endif %}\n        )\n\n)\nselect *\nfrom validation_errors\n{% endtest %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.507734, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_values_to_be_null": {"name": "test_expect_column_values_to_be_null", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/column_values_basic/expect_column_values_to_be_null.sql", "original_file_path": "macros/schema_tests/column_values_basic/expect_column_values_to_be_null.sql", "unique_id": "macro.dbt_expectations.test_expect_column_values_to_be_null", "macro_sql": "{% test expect_column_values_to_be_null(model, column_name, row_condition=None) %}\n\n{% set expression = column_name ~ \" is null\" %}\n\n{{ dbt_expectations.expression_is_true(model,\n                                        expression=expression,\n                                        group_by_columns=None,\n                                        row_condition=row_condition\n                                        )\n                                        }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.expression_is_true"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.507972, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_values_to_be_unique": {"name": "test_expect_column_values_to_be_unique", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/column_values_basic/expect_column_values_to_be_unique.sql", "original_file_path": "macros/schema_tests/column_values_basic/expect_column_values_to_be_unique.sql", "unique_id": "macro.dbt_expectations.test_expect_column_values_to_be_unique", "macro_sql": "{% test expect_column_values_to_be_unique(model, column_name, row_condition=None) %}\n{{ dbt_expectations.test_expect_compound_columns_to_be_unique(model, [column_name], row_condition=row_condition) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.test_expect_compound_columns_to_be_unique"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.5081222, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_values_to_be_between": {"name": "test_expect_column_values_to_be_between", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/column_values_basic/expect_column_values_to_be_between.sql", "original_file_path": "macros/schema_tests/column_values_basic/expect_column_values_to_be_between.sql", "unique_id": "macro.dbt_expectations.test_expect_column_values_to_be_between", "macro_sql": "{% test expect_column_values_to_be_between(model, column_name,\n                                                   min_value=None,\n                                                   max_value=None,\n                                                   row_condition=None,\n                                                   strictly=False\n                                                   ) %}\n\n{% set expression %}\n{{ column_name }}\n{% endset %}\n\n{{ dbt_expectations.expression_between(model,\n                                        expression=expression,\n                                        min_value=min_value,\n                                        max_value=max_value,\n                                        group_by_columns=None,\n                                        row_condition=row_condition,\n                                        strictly=strictly\n                                        ) }}\n\n\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.expression_between"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.508472, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_values_to_be_decreasing": {"name": "test_expect_column_values_to_be_decreasing", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/column_values_basic/expect_column_values_to_be_decreasing.sql", "original_file_path": "macros/schema_tests/column_values_basic/expect_column_values_to_be_decreasing.sql", "unique_id": "macro.dbt_expectations.test_expect_column_values_to_be_decreasing", "macro_sql": "{% test expect_column_values_to_be_decreasing(model, column_name,\n                                                   sort_column=None,\n                                                   strictly=True,\n                                                   row_condition=None,\n                                                   group_by=None,\n                                                   step=None) %}\n\n{%- set sort_column = column_name if not sort_column else sort_column -%}\n{%- set operator = \"<\" if strictly else \"<=\" %}\nwith all_values as (\n\n    select\n        {{ sort_column }} as sort_column,\n        {%- if group_by -%}\n        {{ group_by | join(\", \") }},\n        {%- endif %}\n        {{ column_name }} as value_field\n    from {{ model }}\n    {% if row_condition %}\n    where {{ row_condition }}\n    {% endif %}\n\n),\nadd_lag_values as (\n\n    select\n        sort_column,\n        value_field,\n        lag(value_field) over\n            {%- if not group_by -%}\n                (order by sort_column)\n            {%- else -%}\n                (partition by {{ group_by | join(\", \") }} order by sort_column)\n            {%- endif  %} as value_field_lag\n    from\n        all_values\n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        add_lag_values\n    where\n        value_field_lag is not null\n        and\n        not (\n            (value_field {{ operator }} value_field_lag)\n            {%- if step %}\n            and ((value_field_lag - value_field) = {{ step }})\n            {%- endif %}\n        )\n\n)\nselect *\nfrom validation_errors\n{% endtest %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.509048, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_values_to_be_in_type_list": {"name": "test_expect_column_values_to_be_in_type_list", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/column_values_basic/expect_column_values_to_be_in_type_list.sql", "original_file_path": "macros/schema_tests/column_values_basic/expect_column_values_to_be_in_type_list.sql", "unique_id": "macro.dbt_expectations.test_expect_column_values_to_be_in_type_list", "macro_sql": "{%- test expect_column_values_to_be_in_type_list(model, column_name, column_type_list) -%}\n{%- if execute -%}\n\n    {%- set column_name = column_name | upper -%}\n    {%- set columns_in_relation = adapter.get_columns_in_relation(model) -%}\n    {%- set column_type_list = column_type_list| map(\"upper\") | list -%}\n    with relation_columns as (\n\n        {% for column in columns_in_relation %}\n        select\n            cast('{{ escape_single_quotes(column.name | upper) }}' as {{ dbt.type_string() }}) as relation_column,\n            cast('{{ column.dtype | upper }}' as {{ dbt.type_string() }}) as relation_column_type\n        {% if not loop.last %}union all{% endif %}\n        {% endfor %}\n    ),\n    test_data as (\n\n        select\n            *\n        from\n            relation_columns\n        where\n            relation_column = '{{ column_name }}'\n            and\n            relation_column_type not in ('{{ column_type_list | join(\"', '\") }}')\n\n    )\n    select *\n    from test_data\n\n{%- endif -%}\n{%- endtest -%}", "depends_on": {"macros": ["macro.dbt.escape_single_quotes", "macro.dbt.type_string"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.509541, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_values_to_be_of_type": {"name": "test_expect_column_values_to_be_of_type", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/column_values_basic/expect_column_values_to_be_of_type.sql", "original_file_path": "macros/schema_tests/column_values_basic/expect_column_values_to_be_of_type.sql", "unique_id": "macro.dbt_expectations.test_expect_column_values_to_be_of_type", "macro_sql": "{%- test expect_column_values_to_be_of_type(model, column_name, column_type) -%}\n{{ dbt_expectations.test_expect_column_values_to_be_in_type_list(model, column_name, [column_type]) }}\n{%- endtest -%}", "depends_on": {"macros": ["macro.dbt_expectations.test_expect_column_values_to_be_in_type_list"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.5096781, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_values_to_have_consistent_casing": {"name": "test_expect_column_values_to_have_consistent_casing", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/column_values_basic/expect_column_values_to_have_consistent_casing.sql", "original_file_path": "macros/schema_tests/column_values_basic/expect_column_values_to_have_consistent_casing.sql", "unique_id": "macro.dbt_expectations.test_expect_column_values_to_have_consistent_casing", "macro_sql": "{% test expect_column_values_to_have_consistent_casing(model, column_name, display_inconsistent_columns=False) %}\n\nwith test_data as (\n\n    select\n        distinct {{ column_name }} as distinct_values\n    from\n        {{ model }}\n\n ),\n {% if display_inconsistent_columns %}\n validation_errors as (\n\n    select\n        lower(distinct_values) as inconsistent_columns,\n        count(distinct_values) as set_count_case_insensitive\n    from\n        test_data\n    group by 1\n    having\n        count(distinct_values) > 1\n\n )\n select * from validation_errors\n {% else %}\n validation_errors as (\n\n    select\n        count(1) as set_count,\n        count(distinct lower(distinct_values)) as set_count_case_insensitive\n    from\n        test_data\n\n )\n select *\n from\n    validation_errors\n where\n    set_count != set_count_case_insensitive\n {% endif %}\n {%- endtest -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.509888, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_values_to_not_be_null": {"name": "test_expect_column_values_to_not_be_null", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/column_values_basic/expect_column_values_to_not_be_null.sql", "original_file_path": "macros/schema_tests/column_values_basic/expect_column_values_to_not_be_null.sql", "unique_id": "macro.dbt_expectations.test_expect_column_values_to_not_be_null", "macro_sql": "{% test expect_column_values_to_not_be_null(model, column_name, row_condition=None) %}\n\n{% set expression = column_name ~ \" is not null\" %}\n\n{{ dbt_expectations.expression_is_true(model,\n                                        expression=expression,\n                                        group_by_columns=None,\n                                        row_condition=row_condition\n                                        )\n                                        }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.expression_is_true"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.5101209, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_min_to_be_between": {"name": "test_expect_column_min_to_be_between", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/aggregate_functions/expect_column_min_to_be_between.sql", "original_file_path": "macros/schema_tests/aggregate_functions/expect_column_min_to_be_between.sql", "unique_id": "macro.dbt_expectations.test_expect_column_min_to_be_between", "macro_sql": "{% test expect_column_min_to_be_between(model, column_name,\n                                                    min_value=None,\n                                                    max_value=None,\n                                                    group_by=None,\n                                                    row_condition=None,\n                                                    strictly=False\n                                                    ) %}\n{% set expression %}\nmin({{ column_name }})\n{% endset %}\n{{ dbt_expectations.expression_between(model,\n                                        expression=expression,\n                                        min_value=min_value,\n                                        max_value=max_value,\n                                        group_by_columns=group_by,\n                                        row_condition=row_condition,\n                                        strictly=strictly\n                                        ) }}\n\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.expression_between"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.5104918, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_unique_value_count_to_be_between": {"name": "test_expect_column_unique_value_count_to_be_between", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/aggregate_functions/expect_column_unique_value_count_to_be_between.sql", "original_file_path": "macros/schema_tests/aggregate_functions/expect_column_unique_value_count_to_be_between.sql", "unique_id": "macro.dbt_expectations.test_expect_column_unique_value_count_to_be_between", "macro_sql": "{% test expect_column_unique_value_count_to_be_between(model, column_name,\n                                                            min_value=None,\n                                                            max_value=None,\n                                                            group_by=None,\n                                                            row_condition=None,\n                                                            strictly=False\n                                                            ) %}\n{% set expression %}\ncount(distinct {{ column_name }})\n{% endset %}\n{{ dbt_expectations.expression_between(model,\n                                        expression=expression,\n                                        min_value=min_value,\n                                        max_value=max_value,\n                                        group_by_columns=group_by,\n                                        row_condition=row_condition,\n                                        strictly=strictly\n                                        ) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.expression_between"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.510868, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_quantile_values_to_be_between": {"name": "test_expect_column_quantile_values_to_be_between", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/aggregate_functions/expect_column_quantile_values_to_be_between.sql", "original_file_path": "macros/schema_tests/aggregate_functions/expect_column_quantile_values_to_be_between.sql", "unique_id": "macro.dbt_expectations.test_expect_column_quantile_values_to_be_between", "macro_sql": "{% test expect_column_quantile_values_to_be_between(model, column_name,\n                                                            quantile,\n                                                            min_value=None,\n                                                            max_value=None,\n                                                            group_by=None,\n                                                            row_condition=None,\n                                                            strictly=False\n                                                            ) %}\n\n{% set expression %}\n{{ dbt_expectations.percentile_cont(column_name, quantile) }}\n{% endset %}\n{{ dbt_expectations.expression_between(model,\n                                        expression=expression,\n                                        min_value=min_value,\n                                        max_value=max_value,\n                                        group_by_columns=group_by,\n                                        row_condition=row_condition,\n                                        strictly=strictly\n                                        ) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.percentile_cont", "macro.dbt_expectations.expression_between"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.511273, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_median_to_be_between": {"name": "test_expect_column_median_to_be_between", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/aggregate_functions/expect_column_median_to_be_between.sql", "original_file_path": "macros/schema_tests/aggregate_functions/expect_column_median_to_be_between.sql", "unique_id": "macro.dbt_expectations.test_expect_column_median_to_be_between", "macro_sql": "{% test expect_column_median_to_be_between(model, column_name,\n                                                    min_value=None,\n                                                    max_value=None,\n                                                    group_by=None,\n                                                    row_condition=None,\n                                                    strictly=False\n                                                    ) %}\n\n{% set expression %}\n{{ dbt_expectations.median(column_name) }}\n{% endset %}\n{{ dbt_expectations.expression_between(model,\n                                        expression=expression,\n                                        min_value=min_value,\n                                        max_value=max_value,\n                                        group_by_columns=group_by,\n                                        row_condition=row_condition,\n                                        strictly=strictly\n                                        ) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.median", "macro.dbt_expectations.expression_between"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.511652, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_proportion_of_unique_values_to_be_between": {"name": "test_expect_column_proportion_of_unique_values_to_be_between", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/aggregate_functions/expect_column_proportion_of_unique_values_to_be_between.sql", "original_file_path": "macros/schema_tests/aggregate_functions/expect_column_proportion_of_unique_values_to_be_between.sql", "unique_id": "macro.dbt_expectations.test_expect_column_proportion_of_unique_values_to_be_between", "macro_sql": "{% test expect_column_proportion_of_unique_values_to_be_between(model, column_name,\n                                                            min_value=None,\n                                                            max_value=None,\n                                                            group_by=None,\n                                                            row_condition=None,\n                                                            strictly=False\n                                                            ) %}\n{% set expression %}\ncase \n  when count({{ column_name }}) = 0 then 1 -- Return 1 if division by zero\n  else cast(count(distinct {{ column_name }}) as {{ dbt.type_float() }})/count({{ column_name }})\nend\n{% endset %}\n{{ dbt_expectations.expression_between(model,\n                                        expression=expression,\n                                        min_value=min_value,\n                                        max_value=max_value,\n                                        group_by_columns=group_by,\n                                        row_condition=row_condition,\n                                        strictly=strictly\n                                        ) }}\n\n{% endtest %}", "depends_on": {"macros": ["macro.dbt.type_float", "macro.dbt_expectations.expression_between"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.512106, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_distinct_values_to_equal_set": {"name": "test_expect_column_distinct_values_to_equal_set", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/aggregate_functions/expect_column_distinct_values_to_equal_set.sql", "original_file_path": "macros/schema_tests/aggregate_functions/expect_column_distinct_values_to_equal_set.sql", "unique_id": "macro.dbt_expectations.test_expect_column_distinct_values_to_equal_set", "macro_sql": "{% test expect_column_distinct_values_to_equal_set(model, column_name,\n                                                            value_set,\n                                                            quote_values=True,\n                                                            row_condition=None\n                                                            ) %}\n\nwith all_values as (\n\n    select distinct\n        {{ column_name }} as column_value\n\n    from {{ model }}\n    {% if row_condition %}\n    where {{ row_condition }}\n    {% endif %}\n\n),\nset_values as (\n\n    {% for value in value_set -%}\n    select\n        {% if quote_values -%}\n        '{{ value }}'\n        {%- else -%}\n        {{ value }}\n        {%- endif %} as value_field\n    {% if not loop.last %}union all{% endif %}\n    {% endfor %}\n\n),\nunique_set_values as (\n\n    select distinct value_field\n    from\n        set_values\n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        all_values v\n        full outer join\n        unique_set_values s on v.column_value = s.value_field\n    where\n        v.column_value is null or\n        s.value_field is null\n\n)\n\nselect *\nfrom validation_errors\n\n{% endtest %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.512518, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_most_common_value_to_be_in_set": {"name": "test_expect_column_most_common_value_to_be_in_set", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/aggregate_functions/expect_column_most_common_value_to_be_in_set.sql", "original_file_path": "macros/schema_tests/aggregate_functions/expect_column_most_common_value_to_be_in_set.sql", "unique_id": "macro.dbt_expectations.test_expect_column_most_common_value_to_be_in_set", "macro_sql": "{% test expect_column_most_common_value_to_be_in_set(model,\n                                                       column_name,\n                                                       value_set,\n                                                       top_n,\n                                                       quote_values=True,\n                                                       data_type=\"decimal\",\n                                                       row_condition=None\n                                                       ) -%}\n\n    {{ adapter.dispatch('test_expect_column_most_common_value_to_be_in_set', 'dbt_expectations') (\n            model, column_name, value_set, top_n, quote_values, data_type, row_condition\n        ) }}\n\n{%- endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.default__test_expect_column_most_common_value_to_be_in_set"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.512955, "supported_languages": null}, "macro.dbt_expectations.default__test_expect_column_most_common_value_to_be_in_set": {"name": "default__test_expect_column_most_common_value_to_be_in_set", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/aggregate_functions/expect_column_most_common_value_to_be_in_set.sql", "original_file_path": "macros/schema_tests/aggregate_functions/expect_column_most_common_value_to_be_in_set.sql", "unique_id": "macro.dbt_expectations.default__test_expect_column_most_common_value_to_be_in_set", "macro_sql": "{% macro default__test_expect_column_most_common_value_to_be_in_set(model,\n                                                                      column_name,\n                                                                      value_set,\n                                                                      top_n,\n                                                                      quote_values,\n                                                                      data_type,\n                                                                      row_condition\n                                                                      ) %}\n\nwith value_counts as (\n\n    select\n        {% if quote_values -%}\n        {{ column_name }}\n        {%- else -%}\n        cast({{ column_name }} as {{ data_type }})\n        {%- endif %} as value_field,\n        count(*) as value_count\n\n    from {{ model }}\n    {% if row_condition %}\n    where {{ row_condition }}\n    {% endif %}\n\n    group by {% if quote_values -%}\n                {{ column_name }}\n            {%- else -%}\n                cast({{ column_name }} as {{ data_type }})\n            {%- endif %}\n\n),\nvalue_counts_ranked as (\n\n    select\n        *,\n        row_number() over(order by value_count desc) as value_count_rank\n    from\n        value_counts\n\n),\nvalue_count_top_n as (\n\n    select\n        value_field\n    from\n        value_counts_ranked\n    where\n        value_count_rank = {{ top_n }}\n\n),\nset_values as (\n\n    {% for value in value_set -%}\n    select\n        {% if quote_values -%}\n        '{{ value }}'\n        {%- else -%}\n        cast({{ value }} as {{ data_type }})\n        {%- endif %} as value_field\n    {% if not loop.last %}union all{% endif %}\n    {% endfor %}\n\n),\nunique_set_values as (\n\n    select distinct value_field\n    from\n        set_values\n\n),\nvalidation_errors as (\n    -- values from the model that are not in the set\n    select\n        value_field\n    from\n        value_count_top_n\n    where\n        value_field not in (select value_field from unique_set_values)\n\n)\n\nselect *\nfrom validation_errors\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.5134022, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_distinct_values_to_contain_set": {"name": "test_expect_column_distinct_values_to_contain_set", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/aggregate_functions/expect_column_distinct_values_to_contain_set.sql", "original_file_path": "macros/schema_tests/aggregate_functions/expect_column_distinct_values_to_contain_set.sql", "unique_id": "macro.dbt_expectations.test_expect_column_distinct_values_to_contain_set", "macro_sql": "{% test expect_column_distinct_values_to_contain_set(model, column_name,\n                                                            value_set,\n                                                            quote_values=True,\n                                                            row_condition=None\n                                                            ) %}\n\nwith all_values as (\n\n    select distinct\n        {{ column_name }} as value_field\n\n    from {{ model }}\n    {% if row_condition %}\n    where {{ row_condition }}\n    {% endif %}\n\n),\nset_values as (\n\n    {% for value in value_set -%}\n    select\n        {% if quote_values -%}\n        '{{ value }}'\n        {%- else -%}\n        {{ value }}\n        {%- endif %} as value_field\n    {% if not loop.last %}union all{% endif %}\n    {% endfor %}\n\n),\nunique_set_values as (\n\n    select distinct value_field\n    from\n        set_values\n\n),\nvalidation_errors as (\n    -- values in set that are not in the list of values from the model\n    select\n        s.value_field\n    from\n        unique_set_values s\n        left join\n        all_values v on s.value_field = v.value_field\n    where\n        v.value_field is null\n\n)\n\nselect *\nfrom validation_errors\n\n{% endtest %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.513802, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_distinct_count_to_equal": {"name": "test_expect_column_distinct_count_to_equal", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/aggregate_functions/expect_column_distinct_count_to_equal.sql", "original_file_path": "macros/schema_tests/aggregate_functions/expect_column_distinct_count_to_equal.sql", "unique_id": "macro.dbt_expectations.test_expect_column_distinct_count_to_equal", "macro_sql": "{% test expect_column_distinct_count_to_equal(model,\n                                                column_name,\n                                                value,\n                                                group_by=None,\n                                                row_condition=None\n                                                ) %}\n{% set expression %}\ncount(distinct {{ column_name }}) = {{ value }}\n{% endset %}\n{{ dbt_expectations.expression_is_true(model,\n                                        expression=expression,\n                                        group_by_columns=group_by,\n                                        row_condition=row_condition)\n                                        }}\n{%- endtest -%}", "depends_on": {"macros": ["macro.dbt_expectations.expression_is_true"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.5140889, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_distinct_count_to_be_less_than": {"name": "test_expect_column_distinct_count_to_be_less_than", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/aggregate_functions/expect_column_distinct_count_to_be_less_than.sql", "original_file_path": "macros/schema_tests/aggregate_functions/expect_column_distinct_count_to_be_less_than.sql", "unique_id": "macro.dbt_expectations.test_expect_column_distinct_count_to_be_less_than", "macro_sql": "{% test expect_column_distinct_count_to_be_less_than(model,\n                                                       column_name,\n                                                       value,\n                                                       group_by=None,\n                                                       row_condition=None\n                                                       ) %}\n{% set expression %}\ncount(distinct {{ column_name }}) < {{ value }}\n{% endset %}\n{{ dbt_expectations.expression_is_true(model,\n                                        expression=expression,\n                                        group_by_columns=group_by,\n                                        row_condition=row_condition)\n                                        }}\n{%- endtest -%}", "depends_on": {"macros": ["macro.dbt_expectations.expression_is_true"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.514379, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_sum_to_be_between": {"name": "test_expect_column_sum_to_be_between", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/aggregate_functions/expect_column_sum_to_be_between.sql", "original_file_path": "macros/schema_tests/aggregate_functions/expect_column_sum_to_be_between.sql", "unique_id": "macro.dbt_expectations.test_expect_column_sum_to_be_between", "macro_sql": "{% test expect_column_sum_to_be_between(model, column_name,\n                                                min_value=None,\n                                                max_value=None,\n                                                group_by=None,\n                                                row_condition=None,\n                                                strictly=False\n                                                ) %}\n{% set expression %}\nsum({{ column_name }})\n{% endset %}\n{{ dbt_expectations.expression_between(model,\n                                        expression=expression,\n                                        min_value=min_value,\n                                        max_value=max_value,\n                                        group_by_columns=group_by,\n                                        row_condition=row_condition,\n                                        strictly=strictly\n                                        ) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.expression_between"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.514741, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_stdev_to_be_between": {"name": "test_expect_column_stdev_to_be_between", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/aggregate_functions/expect_column_stdev_to_be_between.sql", "original_file_path": "macros/schema_tests/aggregate_functions/expect_column_stdev_to_be_between.sql", "unique_id": "macro.dbt_expectations.test_expect_column_stdev_to_be_between", "macro_sql": "{% test expect_column_stdev_to_be_between(model, column_name,\n                                                    min_value=None,\n                                                    max_value=None,\n                                                    group_by=None,\n                                                    row_condition=None,\n                                                    strictly=False\n                                                    ) -%}\n    {{ adapter.dispatch('test_expect_column_stdev_to_be_between', 'dbt_expectations') (\n                                                    model, column_name,\n                                                    min_value,\n                                                    max_value,\n                                                    group_by,\n                                                    row_condition,\n                                                    strictly\n                                                    ) }}\n{%- endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.default__test_expect_column_stdev_to_be_between"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.515245, "supported_languages": null}, "macro.dbt_expectations.default__test_expect_column_stdev_to_be_between": {"name": "default__test_expect_column_stdev_to_be_between", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/aggregate_functions/expect_column_stdev_to_be_between.sql", "original_file_path": "macros/schema_tests/aggregate_functions/expect_column_stdev_to_be_between.sql", "unique_id": "macro.dbt_expectations.default__test_expect_column_stdev_to_be_between", "macro_sql": "{% macro default__test_expect_column_stdev_to_be_between(\n                                                    model, column_name,\n                                                    min_value,\n                                                    max_value,\n                                                    group_by,\n                                                    row_condition,\n                                                    strictly\n                                                    ) %}\n\n{% set expression %}\nstddev({{ column_name }})\n{% endset %}\n{{ dbt_expectations.expression_between(model,\n                                        expression=expression,\n                                        min_value=min_value,\n                                        max_value=max_value,\n                                        group_by_columns=group_by,\n                                        row_condition=row_condition,\n                                        strictly=strictly\n                                        ) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_expectations.expression_between"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.515511, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_mean_to_be_between": {"name": "test_expect_column_mean_to_be_between", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/aggregate_functions/expect_column_mean_to_be_between.sql", "original_file_path": "macros/schema_tests/aggregate_functions/expect_column_mean_to_be_between.sql", "unique_id": "macro.dbt_expectations.test_expect_column_mean_to_be_between", "macro_sql": "{% test expect_column_mean_to_be_between(model, column_name,\n                                                    min_value=None,\n                                                    max_value=None,\n                                                    group_by=None,\n                                                    row_condition=None,\n                                                    strictly=False\n                                                    ) %}\n{% set expression %}\navg({{ column_name }})\n{% endset %}\n{{ dbt_expectations.expression_between(model,\n                                        expression=expression,\n                                        min_value=min_value,\n                                        max_value=max_value,\n                                        group_by_columns=group_by,\n                                        row_condition=row_condition,\n                                        strictly=strictly\n                                        ) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.expression_between"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.515906, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_max_to_be_between": {"name": "test_expect_column_max_to_be_between", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/aggregate_functions/expect_column_max_to_be_between.sql", "original_file_path": "macros/schema_tests/aggregate_functions/expect_column_max_to_be_between.sql", "unique_id": "macro.dbt_expectations.test_expect_column_max_to_be_between", "macro_sql": "{% test expect_column_max_to_be_between(model, column_name,\n                                                min_value=None,\n                                                max_value=None,\n                                                group_by=None,\n                                                row_condition=None,\n                                                strictly=False\n                                                ) %}\n{% set expression %}\nmax({{ column_name }})\n{% endset %}\n{{ dbt_expectations.expression_between(model,\n                                        expression=expression,\n                                        min_value=min_value,\n                                        max_value=max_value,\n                                        group_by_columns=group_by,\n                                        row_condition=row_condition,\n                                        strictly=strictly\n                                        ) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.expression_between"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.516285, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_distinct_count_to_be_greater_than": {"name": "test_expect_column_distinct_count_to_be_greater_than", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/aggregate_functions/expect_column_distinct_count_to_be_greater_than.sql", "original_file_path": "macros/schema_tests/aggregate_functions/expect_column_distinct_count_to_be_greater_than.sql", "unique_id": "macro.dbt_expectations.test_expect_column_distinct_count_to_be_greater_than", "macro_sql": "{% test expect_column_distinct_count_to_be_greater_than(model,\n                                                          column_name,\n                                                          value,\n                                                          group_by=None,\n                                                          row_condition=None\n                                                          ) %}\n{% set expression %}\ncount(distinct {{ column_name }}) > {{ value }}\n{% endset %}\n{{ dbt_expectations.expression_is_true(model,\n                                        expression=expression,\n                                        group_by_columns=group_by,\n                                        row_condition=row_condition)\n                                        }}\n{%- endtest -%}", "depends_on": {"macros": ["macro.dbt_expectations.expression_is_true"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.5165892, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_distinct_values_to_be_in_set": {"name": "test_expect_column_distinct_values_to_be_in_set", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/aggregate_functions/expect_column_distinct_values_to_be_in_set.sql", "original_file_path": "macros/schema_tests/aggregate_functions/expect_column_distinct_values_to_be_in_set.sql", "unique_id": "macro.dbt_expectations.test_expect_column_distinct_values_to_be_in_set", "macro_sql": "{% test expect_column_distinct_values_to_be_in_set(model,\n                                                     column_name,\n                                                     value_set,\n                                                     quote_values=True,\n                                                     row_condition=None\n                                                     ) %}\n\nwith all_values as (\n\n    select distinct\n        {{ column_name }} as value_field\n\n    from {{ model }}\n    {% if row_condition %}\n    where {{ row_condition }}\n    {% endif %}\n\n),\nset_values as (\n\n    {% for value in value_set -%}\n    select\n        {% if quote_values -%}\n        '{{ value }}'\n        {%- else -%}\n        {{ value }}\n        {%- endif %} as value_field\n    {% if not loop.last %}union all{% endif %}\n    {% endfor %}\n\n),\nunique_set_values as (\n\n    select distinct value_field\n    from\n        set_values\n\n),\nvalidation_errors as (\n    -- values from the model that are not in the set\n    select\n        v.value_field\n    from\n        all_values v\n        left join\n        unique_set_values s on v.value_field = s.value_field\n    where\n        s.value_field is null\n\n)\n\nselect *\nfrom validation_errors\n\n{% endtest %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.5170019, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_distinct_count_to_equal_other_table": {"name": "test_expect_column_distinct_count_to_equal_other_table", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/aggregate_functions/expect_column_distinct_count_to_equal_other_table.sql", "original_file_path": "macros/schema_tests/aggregate_functions/expect_column_distinct_count_to_equal_other_table.sql", "unique_id": "macro.dbt_expectations.test_expect_column_distinct_count_to_equal_other_table", "macro_sql": "{% test expect_column_distinct_count_to_equal_other_table(model,\n                                                                compare_model,\n                                                                column_name,\n                                                                compare_column_name,\n                                                                row_condition=None,\n                                                                compare_row_condition=None\n                                                                ) %}\n{%- set expression -%}\ncount(distinct {{ column_name }})\n{%- endset -%}\n{%- set compare_expression -%}\n{%- if compare_column_name -%}\ncount(distinct {{ compare_column_name }})\n{%- else -%}\n{{ expression }}\n{%- endif -%}\n{%- endset -%}\n{{ dbt_expectations.test_equal_expression(\n    model,\n    expression=expression,\n    compare_model=compare_model,\n    compare_expression=compare_expression,\n    row_condition=row_condition,\n    compare_row_condition=compare_row_condition\n) }}\n{%- endtest -%}", "depends_on": {"macros": ["macro.dbt_expectations.test_equal_expression"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.517392, "supported_languages": null}, "macro.dbt_expectations.test_expect_row_values_to_have_data_for_every_n_datepart": {"name": "test_expect_row_values_to_have_data_for_every_n_datepart", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/distributional/expect_row_values_to_have_data_for_every_n_datepart.sql", "original_file_path": "macros/schema_tests/distributional/expect_row_values_to_have_data_for_every_n_datepart.sql", "unique_id": "macro.dbt_expectations.test_expect_row_values_to_have_data_for_every_n_datepart", "macro_sql": "{%- test expect_row_values_to_have_data_for_every_n_datepart(model,\n                                                            date_col,\n                                                            date_part=\"day\",\n                                                            interval=None,\n                                                            row_condition=None,\n                                                            exclusion_condition=None,\n                                                            test_start_date=None,\n                                                            test_end_date=None) -%}\n{% if not execute %}\n    {{ return('') }}\n{% endif %}\n\n{% if not test_start_date or not test_end_date %}\n    {% set sql %}\n\n        select\n            min(cast({{ date_col }} as date)) as start_{{ date_part }},\n            max(cast({{ date_col }} as date)) as end_{{ date_part }}\n        from {{ model }}\n        {% if row_condition %}\n        where {{ row_condition }}\n        {% endif %}\n\n    {% endset %}\n\n    {%- set dr = run_query(sql) -%}\n\n    {%- set db_start_date = dr.columns[0].values()[0] -%}\n    {%- set db_end_date = dr.columns[1].values()[0] -%}\n\n    {% if db_start_date is not string %}\n        {%- set db_start_date = db_start_date.strftime('%Y-%m-%d') -%}\n        {%- set db_end_date = db_end_date.strftime('%Y-%m-%d') -%}\n    {% endif %}\n\n{% endif %}\n\n{% if not test_start_date %}\n{% set start_date = db_start_date %}\n{% else %}\n{% set start_date = test_start_date %}\n{% endif %}\n\n\n{% if not test_end_date %}\n{% set end_date = db_end_date %}\n{% else %}\n{% set end_date = test_end_date %}\n{% endif %}\n\nwith base_dates as (\n\n    {{ dbt_date.get_base_dates(start_date=start_date, end_date=end_date, datepart=date_part) }}\n    {% if interval %}\n    {#\n        Filter the date spine created above down to the interval granularity using a modulo operation.\n        The number of date_parts after the start_date divided by the integer interval will produce no remainder for the desired intervals,\n        e.g. for 2-day interval from a starting Jan 1, 2020:\n            params: start_date = '2020-01-01', date_part = 'day', interval = 2\n            date spine created above: [2020-01-01, 2020-01-02, 2020-01-03, 2020-01-04, 2020-01-05, ...]\n            The first parameter to the `mod` function would be the number of days between the start_date and the spine date, i.e. [0, 1, 2, 3, 4 ...]\n            The second parameter to the `mod` function would be the integer interval, i.e. 2\n            This modulo operation produces the following remainders: [0, 1, 0, 1, 0, ...]\n            Filtering the spine only where this remainder == 0 will return a spine with every other day as desired, i.e. [2020-01-01, 2020-01-03, 2020-01-05, ...]\n    #}\n    where mod(\n            cast({{ dbt.datediff(\"'\" ~ start_date ~ \"'\", 'date_' ~ date_part, date_part) }} as {{ dbt.type_int() }}),\n            cast({{interval}} as {{ dbt.type_int() }})\n        ) = 0\n    {% endif %}\n\n),\nmodel_data as (\n\n    select\n    {% if not interval %}\n\n        cast({{ dbt.date_trunc(date_part, date_col) }} as {{ dbt_expectations.type_datetime() }}) as date_{{ date_part }},\n\n    {% else %}\n        {#\n            Use a modulo operator to determine the number of intervals that a date_col is away from the interval-date spine\n            and subtracts that amount to effectively slice each date_col record into its corresponding spine bucket,\n            e.g. given a date_col of with records [2020-01-01, 2020-01-02, 2020-01-03, 2020-01-11, 2020-01-12]\n                if we want to slice these dates into their 2-day buckets starting Jan 1, 2020 (start_date = '2020-01-01', date_part='day', interval=2),\n                the modulo operation described above will produce these remainders: [0, 1, 0, 0, 1]\n                subtracting that number of days from the observations will produce records [2020-01-01, 2020-01-01, 2020-01-03, 2020-01-11, 2020-01-11],\n                all of which align with records from the interval-date spine\n        #}\n        {{ dbt.dateadd(\n            date_part,\n            \"mod(\n                cast(\" ~ dbt.datediff(\"'\" ~ start_date ~ \"'\", date_col, date_part) ~ \" as \" ~ dbt.type_int() ~ \" ),\n                cast(\" ~ interval ~ \" as  \" ~ dbt.type_int() ~ \" )\n            ) * (-1)\",\n            \"cast( \" ~ dbt.date_trunc(date_part, date_col) ~ \" as  \" ~ dbt_expectations.type_datetime() ~ \")\"\n        )}} as date_{{ date_part }},\n\n    {% endif %}\n\n        count(*) as row_cnt\n    from\n        {{ model }} f\n    {% if row_condition %}\n    where {{ row_condition }}\n    {% endif %}\n    group by\n        date_{{date_part}}\n\n),\n\nfinal as (\n\n    select\n        cast(d.date_{{ date_part }} as {{ dbt_expectations.type_datetime() }}) as date_{{ date_part }},\n        case when f.date_{{ date_part }} is null then true else false end as is_missing,\n        coalesce(f.row_cnt, 0) as row_cnt\n    from\n        base_dates d\n        left join\n        model_data f on cast(d.date_{{ date_part }} as {{ dbt_expectations.type_datetime() }}) = f.date_{{ date_part }}\n)\nselect\n    *\nfrom final\nwhere row_cnt = 0\n{% if exclusion_condition %}\n  and {{ exclusion_condition }}\n{% endif %}\n{%- endtest -%}", "depends_on": {"macros": ["macro.dbt.run_query", "macro.dbt_date.get_base_dates", "macro.dbt.datediff", "macro.dbt.type_int", "macro.dbt.date_trunc", "macro.dbt_expectations.type_datetime", "macro.dbt.dateadd"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.519265, "supported_languages": null}, "macro.dbt_expectations._get_metric_expression": {"name": "_get_metric_expression", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/distributional/expect_column_values_to_be_within_n_moving_stdevs.sql", "original_file_path": "macros/schema_tests/distributional/expect_column_values_to_be_within_n_moving_stdevs.sql", "unique_id": "macro.dbt_expectations._get_metric_expression", "macro_sql": "{%- macro _get_metric_expression(metric_column, take_logs) -%}\n\n{%- if take_logs %}\n{%- set expr = \"nullif(\" ~ metric_column ~ \", 0)\" -%}\ncoalesce({{ dbt_expectations.log_natural(expr) }}, 0)\n{%- else -%}\ncoalesce({{ metric_column }}, 0)\n{%- endif %}\n\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt_expectations.log_natural"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.519837, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_values_to_be_within_n_moving_stdevs": {"name": "test_expect_column_values_to_be_within_n_moving_stdevs", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/distributional/expect_column_values_to_be_within_n_moving_stdevs.sql", "original_file_path": "macros/schema_tests/distributional/expect_column_values_to_be_within_n_moving_stdevs.sql", "unique_id": "macro.dbt_expectations.test_expect_column_values_to_be_within_n_moving_stdevs", "macro_sql": "{% test expect_column_values_to_be_within_n_moving_stdevs(model,\n                                  column_name,\n                                  date_column_name,\n                                  group_by=None,\n                                  period='day',\n                                  lookback_periods=1,\n                                  trend_periods=7,\n                                  test_periods=14,\n                                  sigma_threshold=3,\n                                  sigma_threshold_upper=None,\n                                  sigma_threshold_lower=None,\n                                  take_diffs=true,\n                                  take_logs=true\n                                ) -%}\n    {{ adapter.dispatch('test_expect_column_values_to_be_within_n_moving_stdevs', 'dbt_expectations') (model,\n                                  column_name,\n                                  date_column_name,\n                                  group_by,\n                                  period,\n                                  lookback_periods,\n                                  trend_periods,\n                                  test_periods,\n                                  sigma_threshold,\n                                  sigma_threshold_upper,\n                                  sigma_threshold_lower,\n                                  take_diffs,\n                                  take_logs\n                                ) }}\n{%- endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.default__test_expect_column_values_to_be_within_n_moving_stdevs"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.5201511, "supported_languages": null}, "macro.dbt_expectations.default__test_expect_column_values_to_be_within_n_moving_stdevs": {"name": "default__test_expect_column_values_to_be_within_n_moving_stdevs", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/distributional/expect_column_values_to_be_within_n_moving_stdevs.sql", "original_file_path": "macros/schema_tests/distributional/expect_column_values_to_be_within_n_moving_stdevs.sql", "unique_id": "macro.dbt_expectations.default__test_expect_column_values_to_be_within_n_moving_stdevs", "macro_sql": "{% macro default__test_expect_column_values_to_be_within_n_moving_stdevs(model,\n                                  column_name,\n                                  date_column_name,\n                                  group_by,\n                                  period,\n                                  lookback_periods,\n                                  trend_periods,\n                                  test_periods,\n                                  sigma_threshold,\n                                  sigma_threshold_upper,\n                                  sigma_threshold_lower,\n                                  take_diffs,\n                                  take_logs\n                                ) %}\n\n{%- set sigma_threshold_upper = sigma_threshold_upper if sigma_threshold_upper else sigma_threshold -%}\n{%- set sigma_threshold_lower = sigma_threshold_lower if sigma_threshold_lower else -1 * sigma_threshold -%}\n{%- set partition_by = \"partition by \" ~ (group_by | join(\",\")) if group_by -%}\n{%- set group_by_length = (group_by | length ) if group_by else 0 -%}\n\nwith metric_values as (\n\n    with grouped_metric_values as (\n\n        select\n            {{ dbt.date_trunc(period, date_column_name) }} as metric_period,\n            {{ group_by | join(\",\") ~ \",\" if group_by }}\n            sum({{ column_name }}) as agg_metric_value\n        from\n            {{ model }}\n        {{  dbt_expectations.group_by(1 + group_by_length) }}\n\n    )\n    {%- if take_diffs %}\n    , grouped_metric_values_with_priors as (\n\n        select\n            *,\n            lag(agg_metric_value, {{ lookback_periods }}) over(\n                {{ partition_by }}\n                order by metric_period) as prior_agg_metric_value\n    from\n        grouped_metric_values d\n\n    )\n    select\n        *,\n        {{ dbt_expectations._get_metric_expression(\"agg_metric_value\", take_logs) }}\n        -\n        {{ dbt_expectations._get_metric_expression(\"prior_agg_metric_value\", take_logs) }}\n        as metric_test_value\n    from\n        grouped_metric_values_with_priors d\n\n    {%- else %}\n\n    select\n        *,\n        {{ dbt_expectations._get_metric_expression(\"agg_metric_value\", take_logs) }}\n        as metric_test_value\n    from\n        grouped_metric_values\n\n    {%- endif %}\n\n),\nmetric_moving_calcs as (\n\n    select\n        *,\n        avg(metric_test_value)\n            over({{ partition_by }}\n                    order by metric_period rows\n                    between {{ trend_periods }} preceding and 1 preceding) as metric_test_rolling_average,\n        stddev(metric_test_value)\n            over({{ partition_by }}\n                    order by metric_period rows\n                    between {{ trend_periods }} preceding and 1 preceding) as metric_test_rolling_stddev\n    from\n        metric_values\n\n),\nmetric_sigma as (\n\n    select\n        *,\n        (metric_test_value - metric_test_rolling_average) as metric_test_delta,\n        (metric_test_value - metric_test_rolling_average)/\n            nullif(metric_test_rolling_stddev, 0) as metric_test_sigma\n    from\n        metric_moving_calcs\n\n)\nselect\n    *\nfrom\n    metric_sigma\nwhere\n\n    metric_period >= cast(\n            {{ dbt.dateadd(period, -test_periods, dbt.date_trunc(period, dbt_date.now())) }}\n            as {{ dbt_expectations.type_timestamp() }})\n    and\n    metric_period < {{ dbt.date_trunc(period, dbt_date.now()) }}\n    and\n\n    not (\n        metric_test_sigma >= {{ sigma_threshold_lower }} and\n        metric_test_sigma <= {{ sigma_threshold_upper }}\n    )\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt.date_trunc", "macro.dbt_expectations.group_by", "macro.dbt_expectations._get_metric_expression", "macro.dbt.dateadd", "macro.dbt_date.now", "macro.dbt_expectations.type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.5210009, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_values_to_be_within_n_stdevs": {"name": "test_expect_column_values_to_be_within_n_stdevs", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/distributional/expect_column_values_to_be_within_n_stdevs.sql", "original_file_path": "macros/schema_tests/distributional/expect_column_values_to_be_within_n_stdevs.sql", "unique_id": "macro.dbt_expectations.test_expect_column_values_to_be_within_n_stdevs", "macro_sql": "{% test expect_column_values_to_be_within_n_stdevs(model,\n                                  column_name,\n                                  group_by=None,\n                                  sigma_threshold=3\n                                ) -%}\n    {{\n        adapter.dispatch('test_expect_column_values_to_be_within_n_stdevs', 'dbt_expectations') (\n            model, column_name, group_by, sigma_threshold\n        )\n    }}\n{%- endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.default__test_expect_column_values_to_be_within_n_stdevs"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.521285, "supported_languages": null}, "macro.dbt_expectations.default__test_expect_column_values_to_be_within_n_stdevs": {"name": "default__test_expect_column_values_to_be_within_n_stdevs", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/distributional/expect_column_values_to_be_within_n_stdevs.sql", "original_file_path": "macros/schema_tests/distributional/expect_column_values_to_be_within_n_stdevs.sql", "unique_id": "macro.dbt_expectations.default__test_expect_column_values_to_be_within_n_stdevs", "macro_sql": "{% macro default__test_expect_column_values_to_be_within_n_stdevs(model,\n                                  column_name,\n                                  group_by,\n                                  sigma_threshold\n                                ) %}\n\nwith metric_values as (\n\n    select\n        {{ group_by | join(\",\") ~ \",\" if group_by }}\n        sum({{ column_name }}) as {{ column_name }}\n    from\n        {{ model }}\n    {% if group_by -%}\n    {{  dbt_expectations.group_by(group_by | length) }}\n    {%- endif %}\n\n),\nmetric_values_with_statistics as (\n\n    select\n        *,\n        avg({{ column_name }}) over() as {{ column_name }}_average,\n        stddev({{ column_name }}) over() as {{ column_name }}_stddev\n    from\n        metric_values\n\n),\nmetric_values_z_scores as (\n\n    select\n        *,\n        ({{ column_name }} - {{ column_name }}_average)/\n            nullif({{ column_name }}_stddev, 0) as {{ column_name }}_sigma\n    from\n        metric_values_with_statistics\n\n)\nselect\n    *\nfrom\n    metric_values_z_scores\nwhere\n    abs({{ column_name }}_sigma) > {{ sigma_threshold }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_expectations.group_by"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.5216022, "supported_languages": null}, "macro.dbt_expectations.test_expect_select_column_values_to_be_unique_within_record": {"name": "test_expect_select_column_values_to_be_unique_within_record", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/multi-column/expect_select_column_values_to_be_unique_within_record.sql", "original_file_path": "macros/schema_tests/multi-column/expect_select_column_values_to_be_unique_within_record.sql", "unique_id": "macro.dbt_expectations.test_expect_select_column_values_to_be_unique_within_record", "macro_sql": "{% test expect_select_column_values_to_be_unique_within_record(model,\n                                                    column_list,\n                                                    quote_columns=False,\n                                                    ignore_row_if=\"all_values_are_missing\",\n                                                    row_condition=None\n                                                    )  -%}\n    {{ adapter.dispatch('test_expect_select_column_values_to_be_unique_within_record', 'dbt_expectations') (model, column_list, quote_columns, ignore_row_if, row_condition) }}\n{%- endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.default__test_expect_select_column_values_to_be_unique_within_record"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.522086, "supported_languages": null}, "macro.dbt_expectations.default__test_expect_select_column_values_to_be_unique_within_record": {"name": "default__test_expect_select_column_values_to_be_unique_within_record", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/multi-column/expect_select_column_values_to_be_unique_within_record.sql", "original_file_path": "macros/schema_tests/multi-column/expect_select_column_values_to_be_unique_within_record.sql", "unique_id": "macro.dbt_expectations.default__test_expect_select_column_values_to_be_unique_within_record", "macro_sql": "{% macro default__test_expect_select_column_values_to_be_unique_within_record(model,\n                                                    column_list,\n                                                    quote_columns,\n                                                    ignore_row_if,\n                                                    row_condition\n                                                    ) %}\n\n{% if not quote_columns %}\n    {%- set columns=column_list %}\n{% elif quote_columns %}\n    {%- set columns=[] %}\n        {% for column in column_list -%}\n            {% do columns.append( adapter.quote(column) ) %}\n        {%- endfor %}\n{% else %}\n    {{ exceptions.raise_compiler_error(\n        \"`quote_columns` argument for unique_combination_of_columns test must be one of [True, False] Got: '\" ~ quote_columns ~\"'.'\"\n    ) }}\n{% endif %}\n\n{%- set row_condition_ext -%}\n\n    {%- if row_condition  %}\n    {{ row_condition }} and\n    {% endif -%}\n\n    {{ dbt_expectations.ignore_row_if_expression(ignore_row_if, columns) }}\n\n{%- endset -%}\n\nwith column_values as (\n\n    select\n        row_number() over(order by {{ columns|join(', ') }}) as row_index,\n        {% for column in columns -%}\n        {{ column }}{% if not loop.last %},{% endif %}\n        {%- endfor %}\n    from {{ model }}\n    where\n        1=1\n    {%- if row_condition_ext %}\n        and {{ row_condition_ext }}\n    {% endif %}\n\n),\nunpivot_columns as (\n\n    {% for column in columns %}\n    select row_index, '{{ column }}' as column_name, {{ dbt_expectations.md5(column) }} as column_value from column_values\n    {% if not loop.last %}union all{% endif %}\n    {% endfor %}\n),\nvalidation_errors as (\n\n    select\n        row_index,\n        count(distinct column_value) as column_values\n    from unpivot_columns\n    group by 1\n    having count(distinct column_value) < {{ columns | length }}\n\n)\nselect * from validation_errors\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_expectations.ignore_row_if_expression", "macro.dbt_expectations.md5"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.52277, "supported_languages": null}, "macro.dbt_expectations.test_expect_compound_columns_to_be_unique": {"name": "test_expect_compound_columns_to_be_unique", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/multi-column/expect_compound_columns_to_be_unique.sql", "original_file_path": "macros/schema_tests/multi-column/expect_compound_columns_to_be_unique.sql", "unique_id": "macro.dbt_expectations.test_expect_compound_columns_to_be_unique", "macro_sql": "{% test expect_compound_columns_to_be_unique(model,\n                                                column_list,\n                                                quote_columns=False,\n                                                ignore_row_if=\"all_values_are_missing\",\n                                                row_condition=None\n                                                ) %}\n{% if not column_list %}\n    {{ exceptions.raise_compiler_error(\n        \"`column_list` must be specified as a list of columns. Got: '\" ~ column_list ~\"'.'\"\n    ) }}\n{% endif %}\n\n{% if not quote_columns %}\n    {%- set columns=column_list %}\n{% elif quote_columns %}\n    {%- set columns=[] %}\n        {% for column in column_list -%}\n            {% do columns.append( adapter.quote(column) ) %}\n        {%- endfor %}\n{% else %}\n    {{ exceptions.raise_compiler_error(\n        \"`quote_columns` argument for expect_compound_columns_to_be_unique test must be one of [True, False] Got: '\" ~ quote_columns ~\"'.'\"\n    ) }}\n{% endif %}\n\n{%- set row_condition_ext -%}\n\n    {%- if row_condition  %}\n    {{ row_condition }} and\n    {% endif -%}\n\n    {{ dbt_expectations.ignore_row_if_expression(ignore_row_if, columns) }}\n\n{%- endset -%}\n\nwith validation_errors as (\n\n    select\n        {% for column in columns -%}\n        {{ column }},\n        {%- endfor %}\n        count(*) as {{adapter.quote(\"n_records\")}}\n    from {{ model }}\n    where\n        1=1\n    {%- if row_condition_ext %}\n        and {{ row_condition_ext }}\n    {% endif %}\n    group by\n        {% for column in columns -%}\n        {{ column }}{% if not loop.last %},{% endif %}\n        {%- endfor %}\n    having count(*) > 1\n\n)\nselect * from validation_errors\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.ignore_row_if_expression"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.523615, "supported_languages": null}, "macro.dbt_expectations.test_expect_multicolumn_sum_to_equal": {"name": "test_expect_multicolumn_sum_to_equal", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/multi-column/expect_multicolumn_sum_to_equal.sql", "original_file_path": "macros/schema_tests/multi-column/expect_multicolumn_sum_to_equal.sql", "unique_id": "macro.dbt_expectations.test_expect_multicolumn_sum_to_equal", "macro_sql": "{% test expect_multicolumn_sum_to_equal(model,\n                                                column_list,\n                                                sum_total,\n                                                group_by=None,\n                                                row_condition=None\n                                                ) %}\n\n{% set expression %}\n{% for column in column_list %}\nsum({{ column }}){% if not loop.last %} + {% endif %}\n{# the if just allows for column names or literal numbers #}\n{% endfor %} = {% if sum_total is number %}{{sum_total}}{% else %}sum({{ sum_total }}){% endif %}\n{% endset %}\n\n{{ dbt_expectations.expression_is_true(model,\n                                        expression=expression,\n                                        group_by_columns=group_by,\n                                        row_condition=row_condition\n                                        )\n                                        }}\n\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.expression_is_true"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.524065, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_pair_values_to_be_equal": {"name": "test_expect_column_pair_values_to_be_equal", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/multi-column/expect_column_pair_values_to_be_equal.sql", "original_file_path": "macros/schema_tests/multi-column/expect_column_pair_values_to_be_equal.sql", "unique_id": "macro.dbt_expectations.test_expect_column_pair_values_to_be_equal", "macro_sql": "{% test expect_column_pair_values_to_be_equal(model,\n                                                        column_A,\n                                                        column_B,\n                                                        row_condition=None\n                                                        ) %}\n\n{% set operator = \"=\" %}\n{% set expression = column_A ~ \" \" ~ operator ~ \" \" ~ column_B %}\n\n{{ dbt_expectations.expression_is_true(model,\n                                        expression=expression,\n                                        group_by_columns=None,\n                                        row_condition=row_condition\n                                        )\n                                        }}\n\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.expression_is_true"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.5243788, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_pair_values_A_to_be_greater_than_B": {"name": "test_expect_column_pair_values_A_to_be_greater_than_B", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/multi-column/expect_column_pair_values_A_to_be_greater_than_B.sql", "original_file_path": "macros/schema_tests/multi-column/expect_column_pair_values_A_to_be_greater_than_B.sql", "unique_id": "macro.dbt_expectations.test_expect_column_pair_values_A_to_be_greater_than_B", "macro_sql": "{% test expect_column_pair_values_A_to_be_greater_than_B(model,\n                                                                column_A,\n                                                                column_B,\n                                                                or_equal=False,\n                                                                row_condition=None\n                                                                ) %}\n\n{% set operator = \">=\" if or_equal else \">\" %}\n{% set expression = column_A ~ \" \" ~ operator ~ \" \" ~ column_B %}\n\n{{ dbt_expectations.expression_is_true(model,\n                                        expression=expression,\n                                        group_by_columns=None,\n                                        row_condition=row_condition\n                                        )\n                                        }}\n\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.expression_is_true"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.524727, "supported_languages": null}, "macro.dbt_expectations.test_expect_column_pair_values_to_be_in_set": {"name": "test_expect_column_pair_values_to_be_in_set", "resource_type": "macro", "package_name": "dbt_expectations", "path": "macros/schema_tests/multi-column/expect_column_pair_values_to_be_in_set.sql", "original_file_path": "macros/schema_tests/multi-column/expect_column_pair_values_to_be_in_set.sql", "unique_id": "macro.dbt_expectations.test_expect_column_pair_values_to_be_in_set", "macro_sql": "{% test expect_column_pair_values_to_be_in_set(model,\n                                                        column_A,\n                                                        column_B,\n                                                        value_pairs_set,\n                                                        row_condition=None\n                                                        ) %}\n\n{% set expression %}\n{% for pair in value_pairs_set %}\n{%- if (pair | length) == 2 %}\n({{ column_A }} = {{ pair[0] }} and {{ column_B }} = {{ pair[1] }}){% if not loop.last %} or {% endif %}\n{% else %}\n{{ exceptions.raise_compiler_error(\n        \"`value_pairs_set` argument for expect_column_pair_values_to_be_in_set test cannot have more than 2 item per element.\n        Got: '\" ~ pair ~ \"'.'\"\n    ) }}\n{% endif %}\n{% endfor %}\n{% endset %}\n{{ dbt_expectations.expression_is_true(model,\n                                        expression=expression,\n                                        group_by_columns=None,\n                                        row_condition=row_condition\n                                        )\n                                        }}\n\n{% endtest %}", "depends_on": {"macros": ["macro.dbt_expectations.expression_is_true"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1770177078.52527, "supported_languages": null}}, "docs": {"doc.dbt.__overview__": {"name": "__overview__", "resource_type": "doc", "package_name": "dbt", "path": "overview.md", "original_file_path": "docs/overview.md", "unique_id": "doc.dbt.__overview__", "block_contents": "### Welcome!\n\nWelcome to the auto-generated documentation for your dbt project!\n\n### Navigation\n\nYou can use the `Project` and `Database` navigation tabs on the left side of the window to explore the models\nin your project.\n\n#### Project Tab\nThe `Project` tab mirrors the directory structure of your dbt project. In this tab, you can see all of the\nmodels defined in your dbt project, as well as models imported from dbt packages.\n\n#### Database Tab\nThe `Database` tab also exposes your models, but in a format that looks more like a database explorer. This view\nshows relations (tables and views) grouped into database schemas. Note that ephemeral models are _not_ shown\nin this interface, as they do not exist in the database.\n\n### Graph Exploration\nYou can click the blue icon on the bottom-right corner of the page to view the lineage graph of your models.\n\nOn model pages, you'll see the immediate parents and children of the model you're exploring. By clicking the `Expand`\nbutton at the top-right of this lineage pane, you'll be able to see all of the models that are used to build,\nor are built from, the model you're exploring.\n\nOnce expanded, you'll be able to use the `--select` and `--exclude` model selection syntax to filter the\nmodels in the graph. For more information on model selection, check out the [dbt docs](https://docs.getdbt.com/docs/model-selection-syntax).\n\nNote that you can also right-click on models to interactively filter and explore the graph.\n\n---\n\n### More information\n\n- [What is dbt](https://docs.getdbt.com/docs/introduction)?\n- Read the [dbt viewpoint](https://docs.getdbt.com/docs/viewpoint)\n- [Installation](https://docs.getdbt.com/docs/installation)\n- Join the [dbt Community](https://www.getdbt.com/community/) for questions and discussion"}}, "exposures": {}, "metrics": {}, "groups": {}, "selectors": {}, "disabled": {"model.CGOncology_MDM.data_points": [{"database": "CGONCOLOGY_TEST", "schema": "APT", "name": "data_points", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "apt/data_points.sql", "original_file_path": "models/apt/data_points.sql", "unique_id": "model.CGOncology_MDM.data_points", "fqn": ["CGOncology_MDM", "apt", "data_points"], "alias": "data_points", "checksum": {"name": "sha256", "checksum": "3ad7942daa41156c91cc1461f5f43045f162a997dd3673a0664bbff033ba7de7"}, "config": {"enabled": false, "alias": null, "schema": "APT", "database": null, "tags": ["layer_5_apt", "customer_backbone", "customer_backbone", "apt", "customer_backbone", "apt"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_5_apt", "customer_backbone", "apt"], "description": "Time period reference for UI", "columns": {"code": {"name": "code", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/apt/schema.yml", "build_path": null, "unrendered_config": {"schema": "APT", "materialized": "table", "tags": ["customer_backbone", "apt"], "enabled": false}, "created_at": 1770177079.739625, "relation_name": "CGONCOLOGY_TEST.APT.data_points", "raw_code": "{{\n    config(\n        schema='APT',\n        materialized='table',\n        tags=['customer_backbone', 'apt']\n    )\n}}\n\n/*\nPROC-APT-010: apt_data_points - Time Period Reference for UI\nSource: apt_account_metric_value\nBusiness Rules: APT-010\n\nGenerates rolling 12-month period labels for UI display.\nFormat: YYYY-Mon (e.g., '2025-Oct').\nOnly includes the most recent 12 distinct months.\n*/\n\nWITH distinct_dates AS (\n    SELECT DISTINCT\n        x_value,\n        TO_CHAR(x_value, 'YYYY-Mon') AS name\n    FROM {{ ref('account_metric_value') }}\n),\n\nranked_dates AS (\n    SELECT\n        x_value,\n        name,\n        ROW_NUMBER() OVER (ORDER BY x_value DESC) AS rn\n    FROM distinct_dates\n)\n\nSELECT\n    x_value::VARCHAR(20) AS code,\n    name::VARCHAR(50) AS name,\n    ROW_NUMBER() OVER (ORDER BY x_value)::INT AS sort_num\nFROM ranked_dates\nWHERE rn <= 12\nORDER BY x_value", "doc_blocks": [], "language": "sql", "refs": [{"name": "account_metric_value", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}], "model.CGOncology_MDM.account_types": [{"database": "CGONCOLOGY_TEST", "schema": "APT", "name": "account_types", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "apt/account_types.sql", "original_file_path": "models/apt/account_types.sql", "unique_id": "model.CGOncology_MDM.account_types", "fqn": ["CGOncology_MDM", "apt", "account_types"], "alias": "account_types", "checksum": {"name": "sha256", "checksum": "77a94ab07afe54d88fae9a7901444fda4a30df97c633c3237166cd4462569fb9"}, "config": {"enabled": false, "alias": null, "schema": "APT", "database": null, "tags": ["layer_5_apt", "customer_backbone", "customer_backbone", "apt", "customer_backbone", "apt"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_5_apt", "customer_backbone", "apt"], "description": "Account type reference", "columns": {"code": {"name": "code", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/apt/schema.yml", "build_path": null, "unrendered_config": {"schema": "APT", "materialized": "table", "tags": ["customer_backbone", "apt"], "enabled": false}, "created_at": 1770177079.732105, "relation_name": "CGONCOLOGY_TEST.APT.account_types", "raw_code": "{{\n    config(\n        schema='APT',\n        materialized='table',\n        tags=['customer_backbone', 'apt']\n    )\n}}\n\n/*\nPROC-APT-018: apt_account_types - Account Types Reference Table\nSource: Static reference data\nBusiness Rules: APT-018\n\nAccount type definitions matching APT Import Format v15.\n*/\n\nSELECT 'P1_LUGPA'::VARCHAR(100) AS code, 'P1 - LUGPA'::VARCHAR(100) AS name, 1::INT AS sort_num\nUNION ALL SELECT 'P2_ACADEMIC', 'P2 - Academic', 2\nUNION ALL SELECT 'P2_NON-ACADEMIC', 'P2 - Non-Academic', 3\nUNION ALL SELECT 'P3_CCS', 'P3 - Comprehensive Care System', 4\nUNION ALL SELECT 'P3_ FEDERAL', 'P3 - Federal', 5\nUNION ALL SELECT 'P4_SMALL_INDEP_Ctr', 'P4 - Independent Practice', 6\nUNION ALL SELECT 'Payor', 'Payor', 7", "doc_blocks": [], "language": "sql", "refs": [], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}], "model.CGOncology_MDM.metric_list": [{"database": "CGONCOLOGY_TEST", "schema": "APT", "name": "metric_list", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "apt/metric_list.sql", "original_file_path": "models/apt/metric_list.sql", "unique_id": "model.CGOncology_MDM.metric_list", "fqn": ["CGOncology_MDM", "apt", "metric_list"], "alias": "metric_list", "checksum": {"name": "sha256", "checksum": "992043531ba0ed0e3eb63ddfd2921f00a621944015fa72b0a5ea682f637e9be3"}, "config": {"enabled": false, "alias": null, "schema": "APT", "database": null, "tags": ["layer_5_apt", "customer_backbone", "customer_backbone", "apt", "customer_backbone", "apt"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_5_apt", "customer_backbone", "apt"], "description": "Metric definitions", "columns": {"code": {"name": "code", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/apt/schema.yml", "build_path": null, "unrendered_config": {"schema": "APT", "materialized": "table", "tags": ["customer_backbone", "apt"], "enabled": false}, "created_at": 1770177079.734879, "relation_name": "CGONCOLOGY_TEST.APT.metric_list", "raw_code": "{{\n    config(\n        schema='APT',\n        materialized='table',\n        tags=['customer_backbone', 'apt']\n    )\n}}\n\n/*\nPROC-APT-016: apt_metric_list - Metric List Reference Table\nSource: apt_metric_list seed\nBusiness Rules: APT-016\n\nMetric definitions for APT (TURBT_PROC, TURBT_PTS, TICE_BCG_PTS, TICE_BCG_SALE, etc.).\nExposed as view for feed export.\n*/\n\nSELECT\n    code,\n    name,\n    product,\n    data_source,\n    update_date,\n    aggregation_required,\n    aggr_func,\n    aggr_min_x,\n    aggr_max_x\nFROM {{ ref('seed_metric_list') }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "seed_metric_list", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}], "model.CGOncology_MDM.account_payer_types": [{"database": "CGONCOLOGY_TEST", "schema": "APT", "name": "account_payer_types", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "apt/account_payer_types.sql", "original_file_path": "models/apt/account_payer_types.sql", "unique_id": "model.CGOncology_MDM.account_payer_types", "fqn": ["CGOncology_MDM", "apt", "account_payer_types"], "alias": "account_payer_types", "checksum": {"name": "sha256", "checksum": "d794499ee1e025470a974381e47ffb50bbbf41b07e2c3d7703b94a310b747bb2"}, "config": {"enabled": false, "alias": null, "schema": "APT", "database": null, "tags": ["layer_5_apt", "customer_backbone", "customer_backbone", "apt", "customer_backbone", "apt"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_5_apt", "customer_backbone", "apt"], "description": "Account payer type distribution", "columns": {"account_id": {"name": "account_id", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "payer_type": {"name": "payer_type", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/apt/schema.yml", "build_path": null, "unrendered_config": {"schema": "APT", "materialized": "table", "tags": ["customer_backbone", "apt"], "enabled": false}, "created_at": 1770177079.730007, "relation_name": "CGONCOLOGY_TEST.APT.account_payer_types", "raw_code": "{{\n    config(\n        schema='APT',\n        materialized='table',\n        tags=['customer_backbone', 'apt']\n    )\n}}\n\n/*\nPROC-APT-021: apt_account_payer_types - Account Payer Type Distribution\nSource: adm_claims_metrics_by_payor, adm_hco_hierarchy, apt_accounts\nBusiness Rules: APT-021\n\nMaps accounts to payer types with percentage share based on TURBT claims.\nUses last 12 months of data (month_id <= 12 equivalent).\nMatches original APT_V2.sql logic but uses adm_claims_metrics_by_payor (which already has L1/L2/L3/L4 metrics).\n*/\n\n-- Get account-level TURBT claims by payor type from adm_claims_metrics_by_payor\n-- This table already has metrics aggregated at L1, L2, L3, L4 separately\n-- Simplified: account_type not needed for payer type distribution\n-- Just get claims by payor from adm_claims_metrics_by_payor\nWITH account_payor_claims AS (\n    SELECT\n        c.entity_id AS account_id,\n        c.payor_type,\n        c.claim_count\n    FROM {{ ref('adm_claims_metrics_by_payor') }} c\n    WHERE c.entity_type = 'HCO'\n      AND c.metric_category = 'TURBT'\n      AND c.payor_type != 'ALL'  -- Exclude ALL aggregate\n      -- Filter to accounts that exist in apt_accounts\n      AND c.entity_id IN (SELECT account_id FROM {{ ref('accounts') }})\n),\n\n-- Map payor types to canonical codes (matching original logic)\npayor_mapped AS (\n    SELECT\n        account_id,\n        CASE \n            WHEN payor_type = 'COMMERCIAL' THEN 'COMMERCIAL'\n            WHEN payor_type = 'MEDICARE' THEN 'MEDICARE'\n            WHEN payor_type = 'MEDICAID' THEN 'MEDICAID'\n            WHEN payor_type = 'MEDICARE_ADVANTAGE' THEN 'MEDICAR_AD'\n            WHEN payor_type = 'PBM' THEN 'PBM'\n            ELSE 'OTHER'\n        END AS payer_type,\n        claim_count\n    FROM account_payor_claims\n),\n\n-- Aggregate claims by account and payer type\naccount_payor_agg AS (\n    SELECT\n        account_id,\n        payer_type,\n        SUM(claim_count) AS claim_share\n    FROM payor_mapped\n    GROUP BY account_id, payer_type\n),\n\n-- Total claims per account\naccount_totals AS (\n    SELECT\n        account_id,\n        SUM(claim_share) AS total_claims\n    FROM account_payor_agg\n    GROUP BY account_id\n),\n\n-- Calculate percentage share\naccount_payor_prc AS (\n    SELECT\n        a.account_id,\n        a.payer_type,\n        a.claim_share,\n        t.total_claims,\n        ROUND(a.claim_share / NULLIF(t.total_claims, 0), 4) AS prc\n    FROM account_payor_agg a\n    INNER JOIN account_totals t\n        ON a.account_id = t.account_id\n),\n\n-- Add row number for adjustment logic (first payer type gets remainder)\nwith_row_num AS (\n    SELECT\n        account_id,\n        payer_type,\n        claim_share,\n        total_claims,\n        prc,\n        ROW_NUMBER() OVER (PARTITION BY account_id ORDER BY payer_type DESC) AS row_num\n    FROM account_payor_prc\n),\n\n-- Calculate sum of all percentages per account\nsum_prc AS (\n    SELECT\n        account_id,\n        SUM(prc) AS sum_prc\n    FROM with_row_num\n    GROUP BY account_id\n),\n\n-- Join sum back\nwith_sum AS (\n    SELECT\n        a.*,\n        s.sum_prc\n    FROM with_row_num a\n    LEFT JOIN sum_prc s\n        ON a.account_id = s.account_id\n),\n\n-- Adjust percentages so they sum to 1.0 (first payer type gets remainder)\nadjusted_prc AS (\n    SELECT\n        account_id,\n        payer_type,\n        'TURBT' AS product,\n        CASE \n            WHEN row_num = 1 THEN 1 - (sum_prc - prc)  -- First payer type gets remainder\n            ELSE prc\n        END AS prc_share,\n        claim_share AS claims_nmb\n    FROM with_sum\n)\n\n-- Final output (only accounts that exist in apt_accounts)\nSELECT\n    account_id::VARCHAR(20) AS account_id,\n    payer_type::VARCHAR(10) AS payer_type,\n    product::VARCHAR(20) AS product,\n    prc_share,\n    claims_nmb::INT AS claims_nmb\nFROM adjusted_prc\nWHERE account_id IN (SELECT account_id FROM {{ ref('accounts') }})\nORDER BY account_id, payer_type", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_claims_metrics_by_payor", "package": null, "version": null}, {"name": "accounts", "package": null, "version": null}, {"name": "accounts", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}], "model.CGOncology_MDM.geo_levels": [{"database": "CGONCOLOGY_TEST", "schema": "APT", "name": "geo_levels", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "apt/geo_levels.sql", "original_file_path": "models/apt/geo_levels.sql", "unique_id": "model.CGOncology_MDM.geo_levels", "fqn": ["CGOncology_MDM", "apt", "geo_levels"], "alias": "geo_levels", "checksum": {"name": "sha256", "checksum": "a04bee249b19aa18c740f473aafbdd2882fae03bfa12dd5d8a660afa9653bf90"}, "config": {"enabled": false, "alias": null, "schema": "APT", "database": null, "tags": ["layer_5_apt", "customer_backbone", "customer_backbone", "apt", "customer_backbone", "apt"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_5_apt", "customer_backbone", "apt"], "description": "Geography level reference", "columns": {"unit_code": {"name": "unit_code", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/apt/schema.yml", "build_path": null, "unrendered_config": {"schema": "APT", "materialized": "table", "tags": ["customer_backbone", "apt"], "enabled": false}, "created_at": 1770177079.7406652, "relation_name": "CGONCOLOGY_TEST.APT.geo_levels", "raw_code": "{{\n    config(\n        schema='APT',\n        materialized='table',\n        tags=['customer_backbone', 'apt']\n    )\n}}\n\n/*\nPROC-APT-022: apt_geo_levels - Geography Levels Reference Table\nSource: Static reference data\nBusiness Rules: APT-022\n\nGeography hierarchy levels reference table.\nCurrently minimal (UNIT_1, level 1), placeholder for future expansion.\nMatches original APT_V2.sql structure.\n*/\n\nSELECT\n    'UNIT_1'::VARCHAR(20) AS unit_code,\n    1::INT AS level,\n    ''::VARCHAR(20) AS code,\n    ''::VARCHAR(50) AS name", "doc_blocks": [], "language": "sql", "refs": [], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}], "model.CGOncology_MDM.accounts": [{"database": "CGONCOLOGY_TEST", "schema": "APT", "name": "accounts", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "apt/accounts.sql", "original_file_path": "models/apt/accounts.sql", "unique_id": "model.CGOncology_MDM.accounts", "fqn": ["CGOncology_MDM", "apt", "accounts"], "alias": "accounts", "checksum": {"name": "sha256", "checksum": "3d2164ab833688daf07902dc6d3eba05afd4ed2654e9ac1752cabc1cd7192660"}, "config": {"enabled": false, "alias": null, "schema": "APT", "database": null, "tags": ["layer_5_apt", "customer_backbone", "customer_backbone", "apt", "customer_backbone", "apt"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_5_apt", "customer_backbone", "apt"], "description": "Account master for APT (61 columns)", "columns": {"account_id": {"name": "account_id", "description": "Primary key - account identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/apt/schema.yml", "build_path": null, "unrendered_config": {"schema": "APT", "materialized": "table", "tags": ["customer_backbone", "apt"], "enabled": false}, "created_at": 1770177079.725945, "relation_name": "CGONCOLOGY_TEST.APT.accounts", "raw_code": "{{\n    config(\n        schema='APT',\n        materialized='table',\n        tags=['customer_backbone', 'apt']\n    )\n}}\n\n/*\nPROC-APT-001: apt_accounts - Account Output for Downstream\nSource: adm_hco_master, adm_claims_metrics_long, adm_ddd_metrics_wide, PP_PAYOR_MASTER\nBusiness Rules: APT-001 to APT-002\n\nFinal output table for application consumption.\nMatches APT Import Format v15 specification (61 columns).\n\nIncludes:\n- Core account attributes (identity, address, hierarchy)\n- Treatment metrics (TURBT, TICE BCG, ADSTILADRIN, KEYTRUDA)\n- NMIBC risk stratification metrics\n- DDD sales metrics\n- Target flags and territory assignments\n- Site-level metrics (_Site suffix columns)\n- Payor accounts with parent-child hierarchy relationships\n*/\n\n-- Inclusion criteria CTE\nWITH inclusion_criteria AS (\n    -- Backbone accounts (always included)\n    SELECT DISTINCT kmk_hco_id, 'BACKBONE' AS inclusion_reason\n    FROM {{ ref('adm_hco_master') }}\n    WHERE cust_backbone_flag = 'Y'\n      AND kmk_hco_id IS NOT NULL\n\n    UNION\n\n    -- Non-backbone HCOs with claims/sales\n    SELECT DISTINCT hco.kmk_hco_id, 'CLAIMS_SALES' AS inclusion_reason\n    FROM {{ ref('adm_hco_master') }} hco\n    LEFT JOIN (\n        SELECT entity_id AS kmk_hco_id,\n            MAX(CASE WHEN metric_category = 'TURBT' AND period_key = 'L12M' THEN claim_count ELSE 0 END) AS l12m_turbt_claims,\n            MAX(CASE WHEN metric_category = 'TICE_BCG' AND period_key = 'L12M' THEN claim_count ELSE 0 END) AS l12m_tice_bcg_claims\n        FROM {{ ref('adm_claims_metrics_long') }}\n        WHERE entity_type = 'HCO' AND period_key = 'L12M'\n        GROUP BY entity_id\n    ) claims ON hco.kmk_hco_id = claims.kmk_hco_id\n    LEFT JOIN (\n        SELECT kmk_hco_id, COALESCE(L12M_SALES, 0) AS ddd_total_branded_sales\n        FROM {{ ref('adm_ddd_metrics_wide') }}\n        WHERE metric_category = 'TOTAL_BRANDED'\n    ) ddd ON hco.kmk_hco_id = ddd.kmk_hco_id\n    WHERE hco.cust_backbone_flag != 'Y'\n      AND hco.kmk_hco_id IS NOT NULL\n      AND (COALESCE(claims.l12m_turbt_claims, 0) > 0\n           OR COALESCE(claims.l12m_tice_bcg_claims, 0) > 0\n           OR COALESCE(ddd.ddd_total_branded_sales, 0) > 0)\n\n    UNION\n\n    -- Parent accounts of selected accounts\n    SELECT DISTINCT parent.kmk_hco_id, 'PARENT' AS inclusion_reason\n    FROM {{ ref('adm_hco_master') }} child\n    INNER JOIN {{ ref('adm_hco_master') }} parent\n        ON child.account_id_l1 = parent.account_id\n    WHERE child.cust_backbone_flag = 'Y'\n      AND parent.kmk_hco_id IS NOT NULL\n),\n\n-- Claims metrics aggregated\nclaims_agg AS (\n    SELECT\n        entity_id AS kmk_hco_id,\n        -- L12M period metrics\n        MAX(CASE WHEN metric_category = 'BC_DIAGNOSIS' AND period_key = 'L12M' THEN claim_count ELSE 0 END) AS bc_diagnosis_claims,\n        MAX(CASE WHEN metric_category = 'BC_DIAGNOSIS' AND period_key = 'L12M' THEN patient_count ELSE 0 END) AS bc_diagnosis_patients,\n        MAX(CASE WHEN metric_category = 'TURBT' AND period_key = 'L12M' THEN claim_count ELSE 0 END) AS turbt_claims,\n        MAX(CASE WHEN metric_category = 'TURBT' AND period_key = 'L12M' THEN patient_count ELSE 0 END) AS turbt_patients,\n        MAX(CASE WHEN metric_category = 'TICE_BCG' AND period_key = 'L12M' THEN claim_count ELSE 0 END) AS tice_bcg_claims,\n        MAX(CASE WHEN metric_category = 'TICE_BCG' AND period_key = 'L12M' THEN patient_count ELSE 0 END) AS tice_bcg_patients,\n        MAX(CASE WHEN metric_category = 'ADSTILADRIN' AND period_key = 'L12M' THEN claim_count ELSE 0 END) AS adstiladrin_claims,\n        MAX(CASE WHEN metric_category = 'ADSTILADRIN' AND period_key = 'L12M' THEN patient_count ELSE 0 END) AS adstiladrin_patients,\n        MAX(CASE WHEN metric_category = 'KEYTRUDA' AND period_key = 'L12M' THEN claim_count ELSE 0 END) AS keytruda_claims,\n        MAX(CASE WHEN metric_category = 'KEYTRUDA' AND period_key = 'L12M' THEN patient_count ELSE 0 END) AS keytruda_patients\n    FROM {{ ref('adm_claims_metrics_long') }}\n    WHERE entity_type = 'HCO' AND period_key = 'L12M'\n    GROUP BY entity_id\n),\n\n-- DDD sales metrics aggregated\nddd_agg AS (\n    SELECT\n        kmk_hco_id,\n        MAX(CASE WHEN metric_category = 'TICE_BCG' THEN L12M_SALES END) AS tice_bcg_sales,\n        MAX(CASE WHEN metric_category = 'ADSTILADRIN' THEN L12M_SALES END) AS adstiladrin_sales\n    FROM {{ ref('adm_ddd_metrics_wide') }}\n    GROUP BY kmk_hco_id\n),\n\n-- NMIBC risk metrics (from adm_hco_nmibc_metrics)\nnmibc_agg AS (\n    SELECT\n        kmk_hco_id,\n        SUM(HIGH_RISK_NMIBC_PATIENTS) AS high_risk_patients,\n        SUM(MID_RISK_NMIBC_PATIENTS) AS mid_risk_patients,\n        SUM(LOW_RISK_NMIBC_PATIENTS) AS low_risk_patients,\n        SUM(TOTAL_NMIBC_PATIENTS) AS total_nmibc_patients\n    FROM {{ ref('adm_hco_nmibc_metrics') }}\n    GROUP BY kmk_hco_id\n),\n\n-- Lowest level claims metrics (direct attribution only, no rollup)\nlowest_level_claims AS (\n    SELECT\n        kmk_hco_id,\n        MAX(CASE WHEN metric_code = 'BC_DIAGNOSIS_CLAIMS' AND period_key = 'L12M' THEN metric_value ELSE 0 END) AS ll_bc_diagnosis_claims,\n        MAX(CASE WHEN metric_code = 'BC_DIAGNOSIS_PATIENTS' AND period_key = 'L12M' THEN metric_value ELSE 0 END) AS ll_bc_diagnosis_patients,\n        MAX(CASE WHEN metric_code = 'TURBT_CLAIMS' AND period_key = 'L12M' THEN metric_value ELSE 0 END) AS ll_turbt_claims,\n        MAX(CASE WHEN metric_code = 'TURBT_PATIENTS' AND period_key = 'L12M' THEN metric_value ELSE 0 END) AS ll_turbt_patients,\n        MAX(CASE WHEN metric_code = 'TICE_BCG_CLAIMS' AND period_key = 'L12M' THEN metric_value ELSE 0 END) AS ll_tice_bcg_claims,\n        MAX(CASE WHEN metric_code = 'TICE_BCG_PATIENTS' AND period_key = 'L12M' THEN metric_value ELSE 0 END) AS ll_tice_bcg_patients,\n        MAX(CASE WHEN metric_code = 'ADSTILADRIN_CLAIMS' AND period_key = 'L12M' THEN metric_value ELSE 0 END) AS ll_adstiladrin_claims,\n        MAX(CASE WHEN metric_code = 'ADSTILADRIN_PATIENTS' AND period_key = 'L12M' THEN metric_value ELSE 0 END) AS ll_adstiladrin_patients,\n        MAX(CASE WHEN metric_code = 'KEYTRUDA_CLAIMS' AND period_key = 'L12M' THEN metric_value ELSE 0 END) AS ll_keytruda_claims,\n        MAX(CASE WHEN metric_code = 'KEYTRUDA_PATIENTS' AND period_key = 'L12M' THEN metric_value ELSE 0 END) AS ll_keytruda_patients\n    FROM {{ ref('adm_lowest_level_metrics') }}\n    WHERE period_key = 'L12M'\n    GROUP BY kmk_hco_id\n),\n\n-- Lowest level DDD metrics (direct attribution only, no rollup)\nlowest_level_ddd AS (\n    SELECT\n        kmk_hco_id,\n        MAX(CASE WHEN metric_code = 'TICE_BCG_SALES' AND period_key = 'L12M' THEN metric_value ELSE 0 END) AS ll_tice_bcg_sales,\n        MAX(CASE WHEN metric_code = 'ADSTILADRIN_SALES' AND period_key = 'L12M' THEN metric_value ELSE 0 END) AS ll_adstiladrin_sales\n    FROM {{ ref('adm_lowest_level_metrics') }}\n    WHERE period_key = 'L12M'\n    GROUP BY kmk_hco_id\n),\n\n-- Clinical trials count\nclinical_trials AS (\n    SELECT\n        CAST(\"Account ID\" AS VARCHAR(100)) AS account_id,\n        COUNT(*) AS clinical_trials_nmb\n    FROM CGONCOLOGY_DEV.REPORTING.CLINICAL_TRIAL_DATA\n    WHERE \"Account ID\" IS NOT NULL\n    GROUP BY \"Account ID\"\n),\n\n-- Parent network ranks for APT_V2 combined account_rank calculation\n-- account_rank = parent_network_rank * 1000 + child_rank (for child sites)\n-- account_rank = network_rank * 1000 (for network accounts)\nparent_network_ranks AS (\n    SELECT\n        child.kmk_hco_id,\n        child.network_rank,\n        child.child_rank,\n        child.network_account_flag,\n        child.child_site_flag,\n        -- Get parent's network_rank for child accounts\n        -- Try direct parent first, then L1 parent\n        COALESCE(\n            direct_parent.network_rank,\n            l1_parent.network_rank\n        ) AS parent_network_rank\n    FROM {{ ref('adm_hco_master') }} child\n    LEFT JOIN {{ ref('adm_hco_master') }} direct_parent\n        ON child.parent_account_id = direct_parent.kmk_hco_id\n        AND direct_parent.network_account_flag = 'Y'\n    LEFT JOIN {{ ref('adm_hco_master') }} l1_parent\n        ON child.account_id_l1 = l1_parent.account_id\n        AND l1_parent.network_account_flag = 'Y'\n),\n\n-- Firm type lookup to convert NAME format to CODE format\n-- ADM layer uses NAME format (e.g., \"Physician Group\"), APT needs CODE format (e.g., \"PHYSICIAN_GROUP\")\nfirm_type_lookup AS (\n    SELECT code, name FROM {{ ref('seed_firm_types') }}\n),\n\n-- HCO accounts\nhco_accounts AS (\n    SELECT\n        -- Core identity (columns 1-13)\n        CAST(hco.account_id AS VARCHAR(20)) AS account_id,\n        CAST(hco.org_name AS VARCHAR(255)) AS name,\n        CAST(hco.parent_account_id AS VARCHAR(20)) AS parent_id,\n        CAST(hco.hq_address_line_1 AS VARCHAR(255)) AS address1,\n        CAST(hco.hq_address_line_2 AS VARCHAR(255)) AS address2,\n        CAST(hco.hq_city AS VARCHAR(50)) AS city,\n        CAST(hco.hq_state AS VARCHAR(2)) AS state,\n        CAST(LEFT(hco.hq_zip_code, 5) AS VARCHAR(5)) AS zip,\n        CAST(hco.account_type AS VARCHAR(20)) AS account_type,\n        -- Transform hierarchy_level to account_level format\n        CAST(CASE hco.hierarchy_level\n            WHEN 'L1' THEN CASE WHEN hco.pe_flag = 'Y' THEN 'L1_PE' ELSE 'L1_IDN' END\n            WHEN 'L2' THEN CASE\n                WHEN hco.firm_type IN ('Hospital', 'Physician Group') THEN 'L2_SUB_IDN'\n                ELSE 'L2_CORPORATIONS'\n            END\n            WHEN 'L3' THEN 'L3_CHILD_ACCOUNT'\n            WHEN 'L4' THEN 'L4_PRACTICE_LOCATION'\n            ELSE hco.hierarchy_level\n        END AS VARCHAR(50)) AS account_level,\n        CAST(TRY_TO_NUMBER(hco.dh_id) AS NUMBER(38,5)) AS DHC_id,\n        -- Convert firm_type from NAME format to CODE format for APT output\n        CAST(COALESCE(ft.code, hco.firm_type) AS VARCHAR(100)) AS firm_type,\n        CAST(NULL AS VARCHAR(50)) AS clinical_trial_type,\n\n        -- DDD Sales (columns 14-15)\n        CAST(COALESCE(ddd.tice_bcg_sales, 0) AS INT) AS DDD_Tice_BCG_Sales,\n        CAST(COALESCE(ddd.adstiladrin_sales, 0) AS INT) AS DDD_Adstiladrin_Sales,\n\n        -- Urologist counts (columns 16-17)\n        CAST(COALESCE(hco.urologist_w_claims_total, hco.urologist_w_claims, 0) AS INT) AS Urologists_with_Claims_nmb,\n        CAST(COALESCE(hco.urologist_count_total, hco.urologist_count, 0) AS INT) AS Urologists_Total_nmb,\n\n        -- Claims metrics (columns 18-27)\n        CAST(COALESCE(claims.bc_diagnosis_claims, 0) AS INT) AS Bladder_Cancer_Diagnosis_Claims,\n        CAST(COALESCE(claims.turbt_claims, 0) AS INT) AS TURBT_Claims,\n        CAST(COALESCE(claims.tice_bcg_claims, 0) AS INT) AS TICE_BCG_Claims,\n        CAST(COALESCE(claims.adstiladrin_claims, 0) AS INT) AS Adstiladrin_Claims,\n        CAST(COALESCE(claims.keytruda_claims, 0) AS INT) AS Keytruda_Claims,\n        CAST(COALESCE(claims.bc_diagnosis_patients, 0) AS INT) AS Bladder_Cancer_Diagnosis_Patients,\n        CAST(COALESCE(claims.turbt_patients, 0) AS INT) AS TURBT_Patients,\n        CAST(COALESCE(claims.tice_bcg_patients, 0) AS INT) AS TICE_BCG_Patients,\n        CAST(COALESCE(claims.adstiladrin_patients, 0) AS INT) AS Adstiladrin_Patients,\n        CAST(COALESCE(claims.keytruda_patients, 0) AS INT) AS Keytruda_Patients,\n\n        -- NMIBC metrics (columns 28-31)\n        CAST(COALESCE(nmibc.high_risk_patients, 0) AS INT) AS High_Risk_NMIBC_Patients,\n        CAST(COALESCE(nmibc.mid_risk_patients, 0) AS INT) AS Mid_Risk_NMIBC_Patients,\n        CAST(COALESCE(nmibc.low_risk_patients, 0) AS INT) AS Low_Risk_NMIBC_Patients,\n        CAST(COALESCE(nmibc.total_nmibc_patients, 0) AS INT) AS Total_NMIBC_Patients,\n\n        -- Account rank and targeting (columns 32-36)\n        -- APT_V2 combined ranking: network_rank * 1000 for networks, parent_network_rank * 1000 + child_rank for children\n        CAST(CASE\n            WHEN pnr.network_account_flag = 'Y' THEN pnr.network_rank * 1000\n            WHEN pnr.child_site_flag = 'Y' AND pnr.parent_network_rank IS NOT NULL\n                THEN (pnr.parent_network_rank * 1000) + COALESCE(pnr.child_rank, 0)\n            WHEN hco.hierarchy_level IN ('L1', 'L2') THEN hco.network_rank * 1000\n            WHEN hco.hierarchy_level IN ('L3', 'L4') THEN hco.child_rank\n            ELSE NULL\n        END AS INT) AS account_rank,\n        IFF(hco.network_target_flag = 1, 'Y', 'N')::VARCHAR(1) AS Network_Account,\n        CAST(hco.network_decile AS INT) AS Network_Account_Decile,\n        IFF(hco.child_target_flag = 1, 'Y', 'N')::VARCHAR(1) AS Child_Site,\n        CAST(hco.child_decile AS INT) AS Child_Site_Decile,\n\n        -- Clinical trials (column 37)\n        CAST(COALESCE(ct.clinical_trials_nmb, 0) AS INT) AS Clinical_Trials_nmb,\n\n        -- Site-level metrics (columns 38-55) - direct attribution from adm_lowest_level_metrics\n        CAST(COALESCE(ll_ddd.ll_tice_bcg_sales, 0) AS INT) AS DDD_Tice_BCG_Sales_Site,\n        CAST(COALESCE(ll_ddd.ll_adstiladrin_sales, 0) AS INT) AS DDD_Adstiladrin_Sales_Site,\n        CASE WHEN hco.hierarchy_level = 'L4' THEN CAST(COALESCE(hco.urologist_count, 0) AS INT) ELSE NULL END AS Urologists_Total_nmb_Site,\n        CASE WHEN hco.hierarchy_level = 'L4' THEN CAST(COALESCE(hco.urologist_w_claims, 0) AS INT) ELSE NULL END AS Urologists_with_Claims_nmb_Site,\n        CAST(COALESCE(ll_claims.ll_bc_diagnosis_claims, 0) AS INT) AS Bladder_Cancer_Diagnosis_Claims_Site,\n        CAST(COALESCE(ll_claims.ll_turbt_claims, 0) AS INT) AS TURBT_Claims_Site,\n        CAST(COALESCE(ll_claims.ll_tice_bcg_claims, 0) AS INT) AS TICE_BCG_Claims_Site,\n        CAST(COALESCE(ll_claims.ll_adstiladrin_claims, 0) AS INT) AS Adstiladrin_Claims_Site,\n        CAST(COALESCE(ll_claims.ll_keytruda_claims, 0) AS INT) AS Keytruda_Claims_Site,\n        CAST(COALESCE(ll_claims.ll_bc_diagnosis_patients, 0) AS INT) AS Bladder_Cancer_Diagnosis_Patients_Site,\n        CAST(COALESCE(ll_claims.ll_turbt_patients, 0) AS INT) AS TURBT_Patients_Site,\n        CAST(COALESCE(ll_claims.ll_tice_bcg_patients, 0) AS INT) AS TICE_BCG_Patients_Site,\n        CAST(COALESCE(ll_claims.ll_adstiladrin_patients, 0) AS INT) AS Adstiladrin_Patients_Site,\n        CAST(COALESCE(ll_claims.ll_keytruda_patients, 0) AS INT) AS Keytruda_Patients_Site,\n        CASE WHEN hco.hierarchy_level = 'L4' THEN CAST(COALESCE(nmibc.high_risk_patients, 0) AS INT) ELSE NULL END AS High_Risk_NMIBC_Patients_Site,\n        CASE WHEN hco.hierarchy_level = 'L4' THEN CAST(COALESCE(nmibc.mid_risk_patients, 0) AS INT) ELSE NULL END AS Mid_Risk_NMIBC_Patients_Site,\n        CASE WHEN hco.hierarchy_level = 'L4' THEN CAST(COALESCE(nmibc.low_risk_patients, 0) AS INT) ELSE NULL END AS Low_Risk_NMIBC_Patients_Site,\n        CASE WHEN hco.hierarchy_level = 'L4' THEN CAST(COALESCE(nmibc.total_nmibc_patients, 0) AS INT) ELSE NULL END AS Total_NMIBC_Patients_Site,\n\n        -- Additional fields (columns 56-61)\n        CAST(hco.child_rank AS INT) AS Child_Site_Rank,\n        CAST(hco.recommended_engagement_type AS VARCHAR(50)) AS Recommended_Engagement_Type,\n        CAST(hco.display_abr AS VARCHAR(10)) AS Display_ABR,\n        CAST(NULL AS VARCHAR(50)) AS Clinical_Trial_Status,\n        CAST(NULL AS INT) AS Covered_Lives,\n        CAST(NULL AS VARCHAR(50)) AS Payor_Target_Type,\n\n        -- Internal field for joins (not in final output but needed for dedup)\n        hco.kmk_hco_id\n\n    FROM {{ ref('adm_hco_master') }} hco\n    INNER JOIN inclusion_criteria ic ON hco.kmk_hco_id = ic.kmk_hco_id\n    LEFT JOIN claims_agg claims ON hco.kmk_hco_id = claims.kmk_hco_id\n    LEFT JOIN ddd_agg ddd ON hco.kmk_hco_id = ddd.kmk_hco_id\n    LEFT JOIN nmibc_agg nmibc ON hco.kmk_hco_id = nmibc.kmk_hco_id\n    LEFT JOIN lowest_level_claims ll_claims ON hco.kmk_hco_id = ll_claims.kmk_hco_id\n    LEFT JOIN lowest_level_ddd ll_ddd ON hco.kmk_hco_id = ll_ddd.kmk_hco_id\n    LEFT JOIN clinical_trials ct ON hco.account_id = ct.account_id\n    LEFT JOIN parent_network_ranks pnr ON hco.kmk_hco_id = pnr.kmk_hco_id\n    LEFT JOIN firm_type_lookup ft ON UPPER(hco.firm_type) = UPPER(ft.name)\n    WHERE (hco.hierarchy_level IN ('L1', 'L2', 'L3', 'L4') OR hco.hierarchy_level IS NULL)\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY hco.kmk_hco_id ORDER BY hco.kmk_hco_id) = 1\n),\n\n-- Payor hierarchy for parent lookups\npayor_hierarchy AS (\n    SELECT\n        p.KMK_PAYOR_ID,\n        p.PAYOR_PARENT_ID,\n        CASE\n            WHEN p.PAYOR_PARENT_ID IS NULL THEN p.KMK_PAYOR_ID\n            WHEN p.PAYOR_PARENT_ID IS NOT NULL AND p2.PAYOR_PARENT_ID IS NULL THEN p.PAYOR_PARENT_ID\n            ELSE COALESCE(p2.PAYOR_PARENT_ID, p.PAYOR_PARENT_ID, p.KMK_PAYOR_ID)\n        END AS account_id_l1\n    FROM {{ target.database }}.MDM.PP_PAYOR_MASTER p\n    LEFT JOIN {{ target.database }}.MDM.PP_PAYOR_MASTER p2\n        ON p.PAYOR_PARENT_ID = p2.KMK_PAYOR_ID\n),\n\n-- Payor accounts\npayor_accounts AS (\n    SELECT\n        CAST(p.KMK_PAYOR_ID AS VARCHAR(20)) AS account_id,\n        CAST(p.DH_PAYOR_NAME AS VARCHAR(255)) AS name,\n        CAST(p.PAYOR_PARENT_ID AS VARCHAR(20)) AS parent_id,\n        CAST(p.ADDRESS AS VARCHAR(255)) AS address1,\n        CAST(NULL AS VARCHAR(255)) AS address2,\n        CAST(p.CITY AS VARCHAR(50)) AS city,\n        CAST(p.STATE AS VARCHAR(2)) AS state,\n        CAST(LEFT(p.ZIP_CODE, 5) AS VARCHAR(5)) AS zip,\n        CAST('Payor' AS VARCHAR(20)) AS account_type,\n        CAST(CASE WHEN h.HIERARCHY_LEVEL = 'PARENT' THEN 'L1_IDN' ELSE 'L2_SUB_IDN' END AS VARCHAR(50)) AS account_level,\n        CAST(TRY_TO_NUMBER(CASE WHEN p.DH_PAYOR_ID LIKE 'P%' THEN NULL ELSE p.DH_PAYOR_ID END) AS NUMBER(38,5)) AS DHC_id,\n        CAST('PAYOR' AS VARCHAR(50)) AS firm_type,\n        CAST(NULL AS VARCHAR(50)) AS clinical_trial_type,\n\n        -- DDD Sales (NULL for payors)\n        CAST(NULL AS INT) AS DDD_Tice_BCG_Sales,\n        CAST(NULL AS INT) AS DDD_Adstiladrin_Sales,\n\n        -- Urologist counts (NULL for payors)\n        CAST(NULL AS INT) AS Urologists_with_Claims_nmb,\n        CAST(NULL AS INT) AS Urologists_Total_nmb,\n\n        -- Claims metrics\n        CAST(NULL AS INT) AS Bladder_Cancer_Diagnosis_Claims,\n        CAST(COALESCE(m.TURBT_CLAIMS, 0) AS INT) AS TURBT_Claims,\n        CAST(COALESCE(m.BCG_CLAIMS, 0) AS INT) AS TICE_BCG_Claims,\n        CAST(COALESCE(m.ADSTILADRIN_CLAIMS, 0) AS INT) AS Adstiladrin_Claims,\n        CAST(0 AS INT) AS Keytruda_Claims,\n        CAST(NULL AS INT) AS Bladder_Cancer_Diagnosis_Patients,\n        CAST(COALESCE(m.TURBT_PATIENTS, 0) AS INT) AS TURBT_Patients,\n        CAST(COALESCE(m.BCG_PATIENTS, 0) AS INT) AS TICE_BCG_Patients,\n        CAST(COALESCE(m.ADSTILADRIN_PATIENTS, 0) AS INT) AS Adstiladrin_Patients,\n        CAST(0 AS INT) AS Keytruda_Patients,\n\n        -- NMIBC metrics (NULL for payors)\n        CAST(0 AS INT) AS High_Risk_NMIBC_Patients,\n        CAST(0 AS INT) AS Mid_Risk_NMIBC_Patients,\n        CAST(0 AS INT) AS Low_Risk_NMIBC_Patients,\n        CAST(0 AS INT) AS Total_NMIBC_Patients,\n\n        -- Targeting (NULL for payors)\n        CAST(NULL AS INT) AS account_rank,\n        'N'::VARCHAR(1) AS Network_Account,\n        CAST(NULL AS INT) AS Network_Account_Decile,\n        'N'::VARCHAR(1) AS Child_Site,\n        CAST(NULL AS INT) AS Child_Site_Decile,\n        CAST(NULL AS INT) AS Clinical_Trials_nmb,\n\n        -- Site-level metrics (NULL for payors)\n        CAST(NULL AS INT) AS DDD_Tice_BCG_Sales_Site,\n        CAST(NULL AS INT) AS DDD_Adstiladrin_Sales_Site,\n        CAST(NULL AS INT) AS Urologists_Total_nmb_Site,\n        CAST(NULL AS INT) AS Urologists_with_Claims_nmb_Site,\n        CAST(NULL AS INT) AS Bladder_Cancer_Diagnosis_Claims_Site,\n        CAST(NULL AS INT) AS TURBT_Claims_Site,\n        CAST(NULL AS INT) AS TICE_BCG_Claims_Site,\n        CAST(NULL AS INT) AS Adstiladrin_Claims_Site,\n        CAST(NULL AS INT) AS Keytruda_Claims_Site,\n        CAST(NULL AS INT) AS Bladder_Cancer_Diagnosis_Patients_Site,\n        CAST(NULL AS INT) AS TURBT_Patients_Site,\n        CAST(NULL AS INT) AS TICE_BCG_Patients_Site,\n        CAST(NULL AS INT) AS Adstiladrin_Patients_Site,\n        CAST(NULL AS INT) AS Keytruda_Patients_Site,\n        CAST(NULL AS INT) AS High_Risk_NMIBC_Patients_Site,\n        CAST(NULL AS INT) AS Mid_Risk_NMIBC_Patients_Site,\n        CAST(NULL AS INT) AS Low_Risk_NMIBC_Patients_Site,\n        CAST(NULL AS INT) AS Total_NMIBC_Patients_Site,\n\n        -- Additional fields\n        CAST(NULL AS INT) AS Child_Site_Rank,\n        CAST(NULL AS VARCHAR(50)) AS Recommended_Engagement_Type,\n        CAST(NULL AS VARCHAR(10)) AS Display_ABR,\n        CAST(NULL AS VARCHAR(50)) AS Clinical_Trial_Status,\n        CAST(p.COVERED_LIVES AS INT) AS Covered_Lives,\n        CAST(p.TARGET_TYPE AS VARCHAR(50)) AS Payor_Target_Type,\n\n        -- Internal field\n        NULL AS kmk_hco_id\n\n    FROM {{ target.database }}.MDM.PP_PAYOR_MASTER p\n    INNER JOIN {{ target.database }}.ADM.PP_PAYOR_HIERARCHY h\n        ON p.KMK_PAYOR_ID = h.KMK_PAYOR_ID\n    LEFT JOIN payor_hierarchy ph\n        ON p.KMK_PAYOR_ID = ph.KMK_PAYOR_ID\n    LEFT JOIN {{ target.database }}.ADM.PP_PAYOR_METRICS m\n        ON p.KMK_PAYOR_ID = m.KMK_PAYOR_ID\n        AND m.TIME_PERIOD = '12 Months'\n        AND m.PAYOR_TYPE = 'Overall'\n    WHERE p.TARGET_TYPE IS NOT NULL\n       OR p.KMK_PAYOR_ID IN (\n           -- Include parent payors of target payors\n           SELECT DISTINCT PAYOR_PARENT_ID\n           FROM {{ target.database }}.MDM.PP_PAYOR_MASTER\n           WHERE TARGET_TYPE IS NOT NULL AND PAYOR_PARENT_ID IS NOT NULL\n       )\n)\n\n-- Final output (61 columns - exclude kmk_hco_id internal field)\nSELECT\n    account_id,\n    name,\n    parent_id,\n    address1,\n    address2,\n    city,\n    state,\n    zip,\n    account_type,\n    account_level,\n    DHC_id,\n    firm_type,\n    clinical_trial_type,\n    DDD_Tice_BCG_Sales,\n    DDD_Adstiladrin_Sales,\n    Urologists_with_Claims_nmb,\n    Urologists_Total_nmb,\n    Bladder_Cancer_Diagnosis_Claims,\n    TURBT_Claims,\n    TICE_BCG_Claims,\n    Adstiladrin_Claims,\n    Keytruda_Claims,\n    Bladder_Cancer_Diagnosis_Patients,\n    TURBT_Patients,\n    TICE_BCG_Patients,\n    Adstiladrin_Patients,\n    Keytruda_Patients,\n    High_Risk_NMIBC_Patients,\n    Mid_Risk_NMIBC_Patients,\n    Low_Risk_NMIBC_Patients,\n    Total_NMIBC_Patients,\n    account_rank,\n    Network_Account,\n    Network_Account_Decile,\n    Child_Site,\n    Child_Site_Decile,\n    Clinical_Trials_nmb,\n    DDD_Tice_BCG_Sales_Site,\n    DDD_Adstiladrin_Sales_Site,\n    Urologists_Total_nmb_Site,\n    Urologists_with_Claims_nmb_Site,\n    Bladder_Cancer_Diagnosis_Claims_Site,\n    TURBT_Claims_Site,\n    TICE_BCG_Claims_Site,\n    Adstiladrin_Claims_Site,\n    Keytruda_Claims_Site,\n    Bladder_Cancer_Diagnosis_Patients_Site,\n    TURBT_Patients_Site,\n    TICE_BCG_Patients_Site,\n    Adstiladrin_Patients_Site,\n    Keytruda_Patients_Site,\n    High_Risk_NMIBC_Patients_Site,\n    Mid_Risk_NMIBC_Patients_Site,\n    Low_Risk_NMIBC_Patients_Site,\n    Total_NMIBC_Patients_Site,\n    Child_Site_Rank,\n    Recommended_Engagement_Type,\n    Display_ABR,\n    Clinical_Trial_Status,\n    Covered_Lives,\n    Payor_Target_Type\nFROM hco_accounts\n\nUNION ALL\n\nSELECT\n    account_id,\n    name,\n    parent_id,\n    address1,\n    address2,\n    city,\n    state,\n    zip,\n    account_type,\n    account_level,\n    DHC_id,\n    firm_type,\n    clinical_trial_type,\n    DDD_Tice_BCG_Sales,\n    DDD_Adstiladrin_Sales,\n    Urologists_with_Claims_nmb,\n    Urologists_Total_nmb,\n    Bladder_Cancer_Diagnosis_Claims,\n    TURBT_Claims,\n    TICE_BCG_Claims,\n    Adstiladrin_Claims,\n    Keytruda_Claims,\n    Bladder_Cancer_Diagnosis_Patients,\n    TURBT_Patients,\n    TICE_BCG_Patients,\n    Adstiladrin_Patients,\n    Keytruda_Patients,\n    High_Risk_NMIBC_Patients,\n    Mid_Risk_NMIBC_Patients,\n    Low_Risk_NMIBC_Patients,\n    Total_NMIBC_Patients,\n    account_rank,\n    Network_Account,\n    Network_Account_Decile,\n    Child_Site,\n    Child_Site_Decile,\n    Clinical_Trials_nmb,\n    DDD_Tice_BCG_Sales_Site,\n    DDD_Adstiladrin_Sales_Site,\n    Urologists_Total_nmb_Site,\n    Urologists_with_Claims_nmb_Site,\n    Bladder_Cancer_Diagnosis_Claims_Site,\n    TURBT_Claims_Site,\n    TICE_BCG_Claims_Site,\n    Adstiladrin_Claims_Site,\n    Keytruda_Claims_Site,\n    Bladder_Cancer_Diagnosis_Patients_Site,\n    TURBT_Patients_Site,\n    TICE_BCG_Patients_Site,\n    Adstiladrin_Patients_Site,\n    Keytruda_Patients_Site,\n    High_Risk_NMIBC_Patients_Site,\n    Mid_Risk_NMIBC_Patients_Site,\n    Low_Risk_NMIBC_Patients_Site,\n    Total_NMIBC_Patients_Site,\n    Child_Site_Rank,\n    Recommended_Engagement_Type,\n    Display_ABR,\n    Clinical_Trial_Status,\n    Covered_Lives,\n    Payor_Target_Type\nFROM payor_accounts\n\nUNION ALL\n\n-- Manual HCO accounts (7000000xxx series)\n-- These are manually-created accounts not in the standard DHC pipeline\n-- but needed for APT application (HSD profiling, clinical trials, etc.)\nSELECT\n    CAST(m.kmk_hco_id AS VARCHAR(20)) AS account_id,\n    CAST(m.org_name AS VARCHAR(255)) AS name,\n    CAST(NULL AS VARCHAR(20)) AS parent_id,\n    CAST(m.address_line_1 AS VARCHAR(255)) AS address1,\n    CAST(NULL AS VARCHAR(255)) AS address2,\n    CAST(m.city AS VARCHAR(50)) AS city,\n    CAST(m.state AS VARCHAR(2)) AS state,\n    CAST(LEFT(m.zip_code, 5) AS VARCHAR(5)) AS zip,\n    CAST(m.account_type AS VARCHAR(20)) AS account_type,\n    CAST(m.account_level AS VARCHAR(50)) AS account_level,\n    CAST(TRY_TO_NUMBER(m.dh_id) AS NUMBER(38,5)) AS DHC_id,\n    CAST(m.firm_type AS VARCHAR(100)) AS firm_type,\n    CAST(NULL AS VARCHAR(50)) AS clinical_trial_type,\n    CAST(NULL AS INT) AS DDD_Tice_BCG_Sales,\n    CAST(NULL AS INT) AS DDD_Adstiladrin_Sales,\n    CAST(NULL AS INT) AS Urologists_with_Claims_nmb,\n    CAST(NULL AS INT) AS Urologists_Total_nmb,\n    CAST(NULL AS INT) AS Bladder_Cancer_Diagnosis_Claims,\n    CAST(NULL AS INT) AS TURBT_Claims,\n    CAST(NULL AS INT) AS TICE_BCG_Claims,\n    CAST(NULL AS INT) AS Adstiladrin_Claims,\n    CAST(NULL AS INT) AS Keytruda_Claims,\n    CAST(NULL AS INT) AS Bladder_Cancer_Diagnosis_Patients,\n    CAST(NULL AS INT) AS TURBT_Patients,\n    CAST(NULL AS INT) AS TICE_BCG_Patients,\n    CAST(NULL AS INT) AS Adstiladrin_Patients,\n    CAST(NULL AS INT) AS Keytruda_Patients,\n    CAST(NULL AS INT) AS High_Risk_NMIBC_Patients,\n    CAST(NULL AS INT) AS Mid_Risk_NMIBC_Patients,\n    CAST(NULL AS INT) AS Low_Risk_NMIBC_Patients,\n    CAST(NULL AS INT) AS Total_NMIBC_Patients,\n    CAST(NULL AS INT) AS account_rank,\n    'N'::VARCHAR(1) AS Network_Account,\n    CAST(NULL AS INT) AS Network_Account_Decile,\n    'Y'::VARCHAR(1) AS Child_Site,\n    CAST(NULL AS INT) AS Child_Site_Decile,\n    CAST(NULL AS INT) AS Clinical_Trials_nmb,\n    CAST(NULL AS INT) AS DDD_Tice_BCG_Sales_Site,\n    CAST(NULL AS INT) AS DDD_Adstiladrin_Sales_Site,\n    CAST(NULL AS INT) AS Urologists_Total_nmb_Site,\n    CAST(NULL AS INT) AS Urologists_with_Claims_nmb_Site,\n    CAST(NULL AS INT) AS Bladder_Cancer_Diagnosis_Claims_Site,\n    CAST(NULL AS INT) AS TURBT_Claims_Site,\n    CAST(NULL AS INT) AS TICE_BCG_Claims_Site,\n    CAST(NULL AS INT) AS Adstiladrin_Claims_Site,\n    CAST(NULL AS INT) AS Keytruda_Claims_Site,\n    CAST(NULL AS INT) AS Bladder_Cancer_Diagnosis_Patients_Site,\n    CAST(NULL AS INT) AS TURBT_Patients_Site,\n    CAST(NULL AS INT) AS TICE_BCG_Patients_Site,\n    CAST(NULL AS INT) AS Adstiladrin_Patients_Site,\n    CAST(NULL AS INT) AS Keytruda_Patients_Site,\n    CAST(NULL AS INT) AS High_Risk_NMIBC_Patients_Site,\n    CAST(NULL AS INT) AS Mid_Risk_NMIBC_Patients_Site,\n    CAST(NULL AS INT) AS Low_Risk_NMIBC_Patients_Site,\n    CAST(NULL AS INT) AS Total_NMIBC_Patients_Site,\n    CAST(NULL AS INT) AS Child_Site_Rank,\n    CAST(NULL AS VARCHAR(50)) AS Recommended_Engagement_Type,\n    CAST(NULL AS VARCHAR(10)) AS Display_ABR,\n    CAST(NULL AS VARCHAR(50)) AS Clinical_Trial_Status,\n    CAST(NULL AS INT) AS Covered_Lives,\n    CAST(NULL AS VARCHAR(50)) AS Payor_Target_Type\nFROM {{ ref('seed_manual_hco_accounts') }} m", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hco_master", "package": null, "version": null}, {"name": "adm_hco_master", "package": null, "version": null}, {"name": "adm_claims_metrics_long", "package": null, "version": null}, {"name": "adm_ddd_metrics_wide", "package": null, "version": null}, {"name": "adm_hco_master", "package": null, "version": null}, {"name": "adm_hco_master", "package": null, "version": null}, {"name": "adm_claims_metrics_long", "package": null, "version": null}, {"name": "adm_ddd_metrics_wide", "package": null, "version": null}, {"name": "adm_hco_nmibc_metrics", "package": null, "version": null}, {"name": "adm_lowest_level_metrics", "package": null, "version": null}, {"name": "adm_lowest_level_metrics", "package": null, "version": null}, {"name": "adm_hco_master", "package": null, "version": null}, {"name": "adm_hco_master", "package": null, "version": null}, {"name": "adm_hco_master", "package": null, "version": null}, {"name": "seed_firm_types", "package": null, "version": null}, {"name": "adm_hco_master", "package": null, "version": null}, {"name": "seed_manual_hco_accounts", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}], "model.CGOncology_MDM.executives": [{"database": "CGONCOLOGY_TEST", "schema": "APT", "name": "executives", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "apt/executives.sql", "original_file_path": "models/apt/executives.sql", "unique_id": "model.CGOncology_MDM.executives", "fqn": ["CGOncology_MDM", "apt", "executives"], "alias": "executives", "checksum": {"name": "sha256", "checksum": "7843acfa4aaf3210fbd53a66a68af00909b644e4b91ee99c5ebf3929d86bcfed"}, "config": {"enabled": false, "alias": null, "schema": "APT", "database": null, "tags": ["layer_5_apt", "customer_backbone", "customer_backbone", "apt", "customer_backbone", "apt"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_5_apt", "customer_backbone", "apt"], "description": "Executive contacts", "columns": {"executive_id": {"name": "executive_id", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/apt/schema.yml", "build_path": null, "unrendered_config": {"schema": "APT", "materialized": "table", "tags": ["customer_backbone", "apt"], "enabled": false}, "created_at": 1770177079.740143, "relation_name": "CGONCOLOGY_TEST.APT.executives", "raw_code": "{{\n    config(\n        schema='APT',\n        materialized='table',\n        tags=['customer_backbone', 'apt']\n    )\n}}\n\n/*\nPROC-APT-023: apt_executives - Executive Contacts\nSource: ADM.PP_PAYOR_EXECUTIVE\nBusiness Rules: APT-023\n\nExecutive contacts associated with payor accounts.\nMatches APT Import Format v15 specification (21 columns).\n*/\n\nSELECT DISTINCT\n    CAST(e.KMK_EXECUTIVE_ID AS INT) AS executive_id,\n    CAST(e.FIRST_NAME AS VARCHAR(100)) AS first_name,\n    CAST(e.LAST_NAME AS VARCHAR(100)) AS last_name,\n    CAST(NULL AS INT) AS npi_number,\n    CAST(e.DH_PAYOR_ID AS VARCHAR(50)) AS source_id,\n    CAST(NULL AS VARCHAR(255)) AS linkedin_url,\n    CAST('DH_PAYOR' AS VARCHAR(50)) AS source,\n    CAST(e.KMK_PAYOR_ID AS VARCHAR(20)) AS account_id,\n    CAST(e.JOB_TITLE AS VARCHAR(100)) AS title,\n    CAST(NULL AS VARCHAR(100)) AS functional_group,\n    CAST(NULL AS VARCHAR(50)) AS position,\n    CAST(NULL AS VARCHAR(100)) AS specialty,\n    CAST(NULL AS VARCHAR(255)) AS address1,\n    CAST(NULL AS VARCHAR(255)) AS address2,\n    CAST(NULL AS VARCHAR(100)) AS city,\n    CAST(e.PAYOR_STATE AS VARCHAR(10)) AS state,\n    CAST(NULL AS VARCHAR(10)) AS zip,\n    CAST(e.EMAIL AS VARCHAR(100)) AS email,\n    CAST(e.PHONE AS VARCHAR(50)) AS phone,\n    CAST(NULL AS VARCHAR(10)) AS phone_ext,\n    CAST(NULL AS VARCHAR(50)) AS location_phone\nFROM {{ target.database }}.ADM.PP_PAYOR_EXECUTIVE e\nWHERE e.KMK_EXECUTIVE_ID IS NOT NULL\n  AND e.KMK_PAYOR_ID IN (SELECT account_id FROM {{ ref('accounts') }})", "doc_blocks": [], "language": "sql", "refs": [{"name": "accounts", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}], "model.CGOncology_MDM.config_charts": [{"database": "CGONCOLOGY_TEST", "schema": "APT", "name": "config_charts", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "apt/config_charts.sql", "original_file_path": "models/apt/config_charts.sql", "unique_id": "model.CGOncology_MDM.config_charts", "fqn": ["CGOncology_MDM", "apt", "config_charts"], "alias": "config_charts", "checksum": {"name": "sha256", "checksum": "c1b3461d364ce7bea7af93b28a31fdf8fb05462a95f92bd2559fcbfda006c84e"}, "config": {"enabled": false, "alias": null, "schema": "APT", "database": null, "tags": ["layer_5_apt", "customer_backbone", "customer_backbone", "apt", "customer_backbone", "apt"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_5_apt", "customer_backbone", "apt"], "description": "Chart configuration", "columns": {"chart_code": {"name": "chart_code", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/apt/schema.yml", "build_path": null, "unrendered_config": {"schema": "APT", "materialized": "table", "tags": ["customer_backbone", "apt"], "enabled": false}, "created_at": 1770177079.739104, "relation_name": "CGONCOLOGY_TEST.APT.config_charts", "raw_code": "{{\n    config(\n        schema='APT',\n        materialized='table',\n        tags=['customer_backbone', 'apt']\n    )\n}}\n\n/*\nPROC-APT-011: apt_config_charts - Chart Configuration\nSource: Static configuration\nBusiness Rules: APT-011\n\nDefines date boundaries for specific UI charts.\nAll dates formatted consistently as DATE type (YYYY-MM-DD).\nUses dbt project variables for dynamic date calculation.\n*/\n\nSELECT\n    'MONTHlY_BAR'::VARCHAR(200) AS chart_code,\n    DATEADD('MONTH', -12, DATE_TRUNC('MONTH', DATE('{{ var(\"data_date\") }}'))) AS min_x,\n    DATE('{{ var(\"data_date\") }}') AS max_x,\n    ''::VARCHAR(200) AS comment\n\nUNION ALL\n\nSELECT\n    'TICE_BCG_SALES'::VARCHAR(200),\n    DATEADD('MONTH', -12, DATE_TRUNC('MONTH', DATE('{{ var(\"data_date\") }}'))),\n    DATE('{{ var(\"data_date\") }}'),\n    ''::VARCHAR(200)", "doc_blocks": [], "language": "sql", "refs": [], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}], "model.CGOncology_MDM.account_executives": [{"database": "CGONCOLOGY_TEST", "schema": "APT", "name": "account_executives", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "apt/account_executives.sql", "original_file_path": "models/apt/account_executives.sql", "unique_id": "model.CGOncology_MDM.account_executives", "fqn": ["CGOncology_MDM", "apt", "account_executives"], "alias": "account_executives", "checksum": {"name": "sha256", "checksum": "a323736722ee25cfe1d5933124300c9aea1eb554aeadb22d81d148f97b8e728a"}, "config": {"enabled": false, "alias": null, "schema": "APT", "database": null, "tags": ["layer_5_apt", "customer_backbone", "customer_backbone", "apt", "customer_backbone", "apt"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_5_apt", "customer_backbone", "apt"], "description": "Account-executive relationships", "columns": {"account_id": {"name": "account_id", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "executive_id": {"name": "executive_id", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/apt/schema.yml", "build_path": null, "unrendered_config": {"schema": "APT", "materialized": "table", "tags": ["customer_backbone", "apt"], "enabled": false}, "created_at": 1770177079.730551, "relation_name": "CGONCOLOGY_TEST.APT.account_executives", "raw_code": "{{\n    config(\n        schema='APT',\n        materialized='table',\n        tags=['customer_backbone', 'apt']\n    )\n}}\n\n/*\nPROC-APT-024: apt_account_executives - Account-Executive Relationships\nSource: apt_executives\nBusiness Rules: APT-024\n\nLinks executives to their associated accounts.\nMatches APT Import Format v15 specification (13 columns).\n*/\n\nSELECT DISTINCT\n    CAST(e.account_id AS VARCHAR(20)) AS account_id,\n    CAST(e.executive_id AS VARCHAR(20)) AS executive_id,\n    CAST('TBD' AS VARCHAR(10)) AS access_level,\n    CAST(e.address1 AS VARCHAR(255)) AS street1,\n    CAST(e.address2 AS VARCHAR(255)) AS street2,\n    CAST(e.city AS VARCHAR(100)) AS city,\n    CAST(e.state AS VARCHAR(10)) AS state,\n    CAST(e.zip AS VARCHAR(10)) AS zip,\n    CAST(e.email AS VARCHAR(100)) AS email,\n    CAST(e.phone AS VARCHAR(50)) AS phone,\n    CAST(e.title AS VARCHAR(100)) AS title,\n    CAST(e.functional_group AS VARCHAR(100)) AS functional_group,\n    CAST(e.position AS VARCHAR(50)) AS position\nFROM {{ ref('executives') }} e\nWHERE e.account_id IS NOT NULL\n  AND e.account_id IN (SELECT account_id FROM {{ ref('accounts') }})", "doc_blocks": [], "language": "sql", "refs": [{"name": "executives", "package": null, "version": null}, {"name": "accounts", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}], "model.CGOncology_MDM.apt_clinical_trial_types": [{"database": "CGONCOLOGY_TEST", "schema": "APT", "name": "apt_clinical_trial_types", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "apt/apt_clinical_trial_types.sql", "original_file_path": "models/apt/apt_clinical_trial_types.sql", "unique_id": "model.CGOncology_MDM.apt_clinical_trial_types", "fqn": ["CGOncology_MDM", "apt", "apt_clinical_trial_types"], "alias": "apt_clinical_trial_types", "checksum": {"name": "sha256", "checksum": "22f488007b3e26451e1064eb38d49ca7ca955c6eaba887da51150c5e49992f7b"}, "config": {"enabled": false, "alias": null, "schema": "APT", "database": null, "tags": ["layer_5_apt", "customer_backbone", "customer_backbone", "apt", "customer_backbone", "apt"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_5_apt", "customer_backbone", "apt"], "description": "Clinical trial types (placeholder - empty)", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/apt/schema.yml", "build_path": null, "unrendered_config": {"schema": "APT", "materialized": "table", "tags": ["customer_backbone", "apt"], "enabled": false}, "created_at": 1770177079.741138, "relation_name": "CGONCOLOGY_TEST.APT.apt_clinical_trial_types", "raw_code": "{{\n    config(\n        schema='APT',\n        materialized='table',\n        tags=['customer_backbone', 'apt']\n    )\n}}\n\n/*\nPROC-APT-020: apt_clinical_trial_types - Clinical Trial Types Reference Table\nSource: Static (empty placeholder)\nBusiness Rules: APT-020\n\nClinical trial type definitions (currently empty, placeholder for future use).\nExposed as view for feed export.\n*/\n\nSELECT\n    CAST(NULL AS VARCHAR(20)) AS code,\n    CAST(NULL AS VARCHAR(50)) AS name,\n    CAST(NULL AS INT) AS sort_num\nWHERE FALSE", "doc_blocks": [], "language": "sql", "refs": [], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}], "model.CGOncology_MDM.account_hcps": [{"database": "CGONCOLOGY_TEST", "schema": "APT", "name": "account_hcps", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "apt/account_hcps.sql", "original_file_path": "models/apt/account_hcps.sql", "unique_id": "model.CGOncology_MDM.account_hcps", "fqn": ["CGOncology_MDM", "apt", "account_hcps"], "alias": "account_hcps", "checksum": {"name": "sha256", "checksum": "e362749b8e0f3ca01700f97e762aa90f7841c4670ac6e399d511c4e61564aa9e"}, "config": {"enabled": false, "alias": null, "schema": "APT", "database": null, "tags": ["layer_5_apt", "customer_backbone", "customer_backbone", "apt", "customer_backbone", "apt"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_5_apt", "customer_backbone", "apt"], "description": "Account-HCP relationships", "columns": {"account_id": {"name": "account_id", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "hcp_id": {"name": "hcp_id", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/apt/schema.yml", "build_path": null, "unrendered_config": {"schema": "APT", "materialized": "table", "tags": ["customer_backbone", "apt"], "enabled": false}, "created_at": 1770177079.728371, "relation_name": "CGONCOLOGY_TEST.APT.account_hcps", "raw_code": "{{\n    config(\n        schema='APT',\n        materialized='table',\n        tags=['customer_backbone', 'apt']\n    )\n}}\n\n/*\nPROC-APT-009: apt_account_hcps - Account-HCP Relationships\nSource: apt_hcps, adm_hcp_master, apt_accounts\nBusiness Rules: APT-009\n\nLinks HCPs to their best affiliated accounts.\nOnly includes accounts that exist in apt_accounts.\nMatches APT Import Format v15 specification (9 columns).\n*/\n\nSELECT\n    CAST(h.best_hco_account_id AS VARCHAR(20)) AS account_id,\n    CAST(hcp.hcp_id AS VARCHAR(20)) AS hcp_id,\n    CAST('Y' AS VARCHAR(1)) AS is_primary,\n    CAST('TBD' AS VARCHAR(10)) AS access_level,\n    CAST(NULL AS VARCHAR(50)) AS email,\n    CAST(NULL AS VARCHAR(50)) AS phone,\n    CAST(NULL AS VARCHAR(100)) AS title,\n    CAST(NULL AS VARCHAR(100)) AS functional_group,\n    CAST(NULL AS VARCHAR(50)) AS position\nFROM {{ ref('adm_hcp_master') }} h\nINNER JOIN {{ ref('hcps') }} hcp ON h.kmk_hcp_id = hcp.hcp_id\nWHERE h.best_hco_account_id IS NOT NULL\n  AND h.best_hco_account_id IN (SELECT account_id FROM {{ ref('accounts') }})", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_hcp_master", "package": null, "version": null}, {"name": "hcps", "package": null, "version": null}, {"name": "accounts", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}], "model.CGOncology_MDM.geo_metric_value": [{"database": "CGONCOLOGY_TEST", "schema": "APT", "name": "geo_metric_value", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "apt/geo_metric_value.sql", "original_file_path": "models/apt/geo_metric_value.sql", "unique_id": "model.CGOncology_MDM.geo_metric_value", "fqn": ["CGOncology_MDM", "apt", "geo_metric_value"], "alias": "geo_metric_value", "checksum": {"name": "sha256", "checksum": "9fc2357004090a8566603a975d060f49bf7025295c7fb4756284453985d451fe"}, "config": {"enabled": false, "alias": null, "schema": "APT", "database": null, "tags": ["layer_5_apt", "customer_backbone", "customer_backbone", "apt", "customer_backbone", "apt", "metrics", "sfe"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_5_apt", "customer_backbone", "apt", "metrics", "sfe"], "description": "Geography metrics time series", "columns": {"geography_id": {"name": "geography_id", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "metric": {"name": "metric", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "x_value": {"name": "x_value", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/apt/schema.yml", "build_path": null, "unrendered_config": {"schema": "APT", "materialized": "table", "tags": ["customer_backbone", "apt", "metrics", "sfe"], "enabled": false}, "created_at": 1770177079.727815, "relation_name": "CGONCOLOGY_TEST.APT.geo_metric_value", "raw_code": "{{\n    config(\n        schema='APT',\n        materialized='table',\n        tags=['customer_backbone', 'apt', 'metrics', 'sfe']\n    )\n}}\n\n/*\nPROC-APT-008: apt_geo_metric_value - Geography Metrics Time Series\nSource: adm_hco_metrics_time_series, apt_account_geo_affiliation, apt_geographies\nBusiness Rules: APT-008\n\nAggregates account metrics by geography (territory, region, team national, HQ national).\nIncludes geo_code field that was missing in original implementation.\nAll dates formatted consistently as DATE type (YYYY-MM-DD).\nOnly includes last 12 months of data.\n\nUPDATED 2026-01-14: Ensure ALL geographies from geographies table are included, even with zero metrics.\nThis ensures identical geography coverage between TEST and DEV environments.\n*/\n\nWITH leaf_geographies AS (\n    -- Get only LEAF geographies (those that are NOT parent_codes of other geographies)\n    -- This prevents duplicates when we UNION with rollup CTEs\n    SELECT DISTINCT g.geo_code\n    FROM {{ ref('geographies') }} g\n    WHERE g.geo_code IS NOT NULL\n      AND g.geo_code NOT IN (\n          SELECT DISTINCT parent_code\n          FROM {{ ref('geographies') }}\n          WHERE parent_code IS NOT NULL\n      )\n),\n\nall_geographies AS (\n    -- Get all geographies from the geographies table to ensure complete coverage\n    SELECT DISTINCT geo_code\n    FROM {{ ref('geographies') }}\n    WHERE geo_code IS NOT NULL\n),\n\nall_metrics_and_dates AS (\n    -- Get all metric/date combinations from account_metric_value\n    SELECT DISTINCT metric, x_value\n    FROM {{ ref('account_metric_value') }}\n),\n\nall_geography_metric_combinations AS (\n    -- Create cartesian product of LEAF geographies \u00d7 all metrics \u00d7 all dates\n    -- Only leaf geographies here; parent geographies are handled by rollup CTEs\n    SELECT\n        lg.geo_code,\n        amd.metric,\n        amd.x_value\n    FROM leaf_geographies lg\n    CROSS JOIN all_metrics_and_dates amd\n),\n\naccount_metrics AS (\n    -- Get account metrics with geography mapping\n    SELECT\n        m.account_id,\n        m.metric,\n        m.x_value,\n        m.y_value,\n        aga.geo_code\n    FROM {{ ref('account_metric_value') }} m\n    INNER JOIN {{ ref('accounts_geo_affiliation') }} aga\n        ON m.account_id = aga.account_id\n    -- Note: No date filter needed - account_metric_value already filters to last 12 months via period_sequence <= 12\n),\n\ngeography_hierarchy AS (\n    -- Get geography hierarchy from apt_geographies\n    SELECT\n        geo_code,\n        parent_code,\n        team\n    FROM {{ ref('geographies') }}\n),\n\n-- Aggregate by territory (geo_code)\n-- Use LEFT JOIN to include all geographies, even with zero metrics\nterritory_metrics AS (\n    SELECT\n        agmc.geo_code AS geography_id,\n        agmc.x_value,\n        agmc.metric,\n        COALESCE(SUM(am.y_value), 0) AS y_value\n    FROM all_geography_metric_combinations agmc\n    LEFT JOIN account_metrics am\n        ON agmc.geo_code = am.geo_code\n        AND agmc.metric = am.metric\n        AND agmc.x_value = am.x_value\n    GROUP BY agmc.geo_code, agmc.x_value, agmc.metric\n),\n\n-- Aggregate by parent geography (L2 regions from L3 territories)\n-- Note: Only roll up from leaf geographies to their immediate parents\nparent_level_metrics AS (\n    SELECT\n        gh.parent_code AS geography_id,\n        am.x_value,\n        am.metric,\n        SUM(am.y_value) AS y_value\n    FROM account_metrics am\n    INNER JOIN geography_hierarchy gh\n        ON am.geo_code = gh.geo_code\n    -- Only include leaf geographies in the rollup source\n    INNER JOIN leaf_geographies lg\n        ON am.geo_code = lg.geo_code\n    WHERE gh.parent_code IS NOT NULL\n    GROUP BY gh.parent_code, am.x_value, am.metric\n),\n\n-- Aggregate by grandparent geography (L1 national from L2 regions)\ngrandparent_level_metrics AS (\n    SELECT\n        gh2.parent_code AS geography_id,\n        plm.x_value,\n        plm.metric,\n        SUM(plm.y_value) AS y_value\n    FROM parent_level_metrics plm\n    INNER JOIN geography_hierarchy gh2\n        ON plm.geography_id = gh2.geo_code\n    WHERE gh2.parent_code IS NOT NULL\n    GROUP BY gh2.parent_code, plm.x_value, plm.metric\n)\n\n-- Combine all levels: leaf territories, parent regions, grandparent nationals\nSELECT\n    geography_id::VARCHAR(20) AS geography_id,\n    metric::VARCHAR(50) AS metric,\n    x_value::DATE AS x_value,\n    y_value::NUMBER(18,2) AS y_value\nFROM territory_metrics\nWHERE geography_id IS NOT NULL\n\nUNION ALL\n\nSELECT\n    geography_id::VARCHAR(20),\n    metric::VARCHAR(50),\n    x_value::DATE,\n    y_value::NUMBER(18,2)\nFROM parent_level_metrics\nWHERE geography_id IS NOT NULL\n\nUNION ALL\n\nSELECT\n    geography_id::VARCHAR(20),\n    metric::VARCHAR(50),\n    x_value::DATE,\n    y_value::NUMBER(18,2)\nFROM grandparent_level_metrics\nWHERE geography_id IS NOT NULL\n\nORDER BY geography_id, metric, x_value", "doc_blocks": [], "language": "sql", "refs": [{"name": "geographies", "package": null, "version": null}, {"name": "geographies", "package": null, "version": null}, {"name": "geographies", "package": null, "version": null}, {"name": "account_metric_value", "package": null, "version": null}, {"name": "account_metric_value", "package": null, "version": null}, {"name": "accounts_geo_affiliation", "package": null, "version": null}, {"name": "geographies", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}], "model.CGOncology_MDM.units": [{"database": "CGONCOLOGY_TEST", "schema": "APT", "name": "units", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "apt/units.sql", "original_file_path": "models/apt/units.sql", "unique_id": "model.CGOncology_MDM.units", "fqn": ["CGOncology_MDM", "apt", "units"], "alias": "units", "checksum": {"name": "sha256", "checksum": "20b142521354b1d7766bbe434984f7fe044a71c62a218854cc9b150188566a79"}, "config": {"enabled": false, "alias": null, "schema": "APT", "database": null, "tags": ["layer_5_apt", "customer_backbone", "customer_backbone", "apt", "customer_backbone", "apt"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_5_apt", "customer_backbone", "apt"], "description": "Units reference", "columns": {"unit_code": {"name": "unit_code", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/apt/schema.yml", "build_path": null, "unrendered_config": {"schema": "APT", "materialized": "table", "tags": ["customer_backbone", "apt"], "enabled": false}, "created_at": 1770177079.7366369, "relation_name": "CGONCOLOGY_TEST.APT.units", "raw_code": "{{\n    config(\n        schema='APT',\n        materialized='table',\n        tags=['customer_backbone', 'apt']\n    )\n}}\n\n/*\nPROC-APT-014: apt_units - Units Reference Table\nSource: apt_units seed\nBusiness Rules: APT-014\n\nSimple reference table for units (UNIT_1, etc.)\nExposed as view for feed export.\n*/\n\nSELECT\n    unit_code,\n    unit_name\nFROM {{ ref('seed_units') }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "seed_units", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}], "model.CGOncology_MDM.data_source": [{"database": "CGONCOLOGY_TEST", "schema": "APT", "name": "data_source", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "apt/data_source.sql", "original_file_path": "models/apt/data_source.sql", "unique_id": "model.CGOncology_MDM.data_source", "fqn": ["CGOncology_MDM", "apt", "data_source"], "alias": "data_source", "checksum": {"name": "sha256", "checksum": "e703da6c20c917a7725b2a99af023476cc1989e0ba8285405b48b77bbb8fb346"}, "config": {"enabled": false, "alias": null, "schema": "APT", "database": null, "tags": ["layer_5_apt", "customer_backbone", "customer_backbone", "apt", "customer_backbone", "apt"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_5_apt", "customer_backbone", "apt"], "description": "Data source dates", "columns": {"data_source": {"name": "data_source", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/apt/schema.yml", "build_path": null, "unrendered_config": {"schema": "APT", "materialized": "table", "tags": ["customer_backbone", "apt"], "enabled": false}, "created_at": 1770177079.738576, "relation_name": "CGONCOLOGY_TEST.APT.data_source", "raw_code": "{{\n    config(\n        schema='APT',\n        materialized='table',\n        tags=['customer_backbone', 'apt']\n    )\n}}\n\n/*\nPROC-APT-013: apt_data_source - Source Data Date Tracking\nSource: dbt_project.yml vars\nBusiness Rules: APT-013\n\nTracks export dates for source systems.\nAll dates formatted consistently as DATE type (YYYY-MM-DD).\nDates configured via dbt_project.yml vars section.\n*/\n\nSELECT\n    'Aissel/Konectar'::VARCHAR(50) AS data_source,\n    DATE('{{ var('data_date') }}') AS data_date\n\nUNION ALL\n\nSELECT\n    'DDD'::VARCHAR(50),\n    DATE('{{ var('ddd_sales_data_date') }}')\n\nUNION ALL\n\nSELECT\n    'Definitive Healthcare'::VARCHAR(50),\n    DATE('{{ var('data_date') }}')", "doc_blocks": [], "language": "sql", "refs": [], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}], "model.CGOncology_MDM.firm_types": [{"database": "CGONCOLOGY_TEST", "schema": "APT", "name": "firm_types", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "apt/firm_types.sql", "original_file_path": "models/apt/firm_types.sql", "unique_id": "model.CGOncology_MDM.firm_types", "fqn": ["CGOncology_MDM", "apt", "firm_types"], "alias": "firm_types", "checksum": {"name": "sha256", "checksum": "ad245d426eba77b7fc279b745f9a8339f9d5846af6589cf4ab7a9531f0ca0446"}, "config": {"enabled": false, "alias": null, "schema": "APT", "database": null, "tags": ["layer_5_apt", "customer_backbone", "customer_backbone", "apt", "customer_backbone", "apt"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_5_apt", "customer_backbone", "apt"], "description": "Firm type reference", "columns": {"code": {"name": "code", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/apt/schema.yml", "build_path": null, "unrendered_config": {"schema": "APT", "materialized": "table", "tags": ["customer_backbone", "apt"], "enabled": false}, "created_at": 1770177079.738042, "relation_name": "CGONCOLOGY_TEST.APT.firm_types", "raw_code": "{{\n    config(\n        schema='APT',\n        materialized='table',\n        tags=['customer_backbone', 'apt']\n    )\n}}\n\n/*\nPROC-APT-019: apt_firm_types - Firm Types Reference Table\nSource: apt_firm_types seed\nBusiness Rules: APT-019\n\nFirm type definitions (HOSPITAL, PHYSICIAN_GROUP, PRACTICE_LOCATION, etc.).\nExposed as view for feed export.\n*/\n\nSELECT\n    code,\n    name,\n    sort_num\nFROM {{ ref('seed_firm_types') }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "seed_firm_types", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}], "model.CGOncology_MDM.teams": [{"database": "CGONCOLOGY_TEST", "schema": "APT", "name": "teams", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "apt/teams.sql", "original_file_path": "models/apt/teams.sql", "unique_id": "model.CGOncology_MDM.teams", "fqn": ["CGOncology_MDM", "apt", "teams"], "alias": "teams", "checksum": {"name": "sha256", "checksum": "010714ffb5bf0b3533e64990501f5a31c7c21a5b361cf090a74e2922794f5413"}, "config": {"enabled": false, "alias": null, "schema": "APT", "database": null, "tags": ["layer_5_apt", "customer_backbone", "customer_backbone", "apt"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_5_apt", "customer_backbone", "apt"], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"schema": "APT", "materialized": "table", "tags": ["customer_backbone", "apt"], "enabled": false}, "created_at": 1770177079.150774, "relation_name": "CGONCOLOGY_TEST.APT.teams", "raw_code": "{{\n    config(\n        schema='APT',\n        materialized='table',\n        tags=['customer_backbone', 'apt']\n    )\n}}\n\n/*\nPROC-APT-015: apt_teams - Teams Reference Table\nSource: Static values (matches teams.csv seed)\nBusiness Rules: APT-015\n\nSales teams reference table (KAM, HSD, MSL, PAYOR).\nMatches APT Import Format v15 specification (4 columns).\n*/\n\nSELECT 'TEAM_KAM'::VARCHAR(20) AS team_code, 'KAM'::VARCHAR(50) AS team_name, 'UNIT_1'::VARCHAR(20) AS unit_code, 1::INT AS sortnum\nUNION ALL SELECT 'TEAM_HSD', 'HSD', 'UNIT_1', 2\nUNION ALL SELECT 'TEAM_MSL', 'MSL', 'UNIT_1', 3\nUNION ALL SELECT 'TEAM_PAYOR', 'PAYOR', 'UNIT_1', 4", "doc_blocks": [], "language": "sql", "refs": [], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}], "model.CGOncology_MDM.account_metric_value": [{"database": "CGONCOLOGY_TEST", "schema": "APT", "name": "account_metric_value", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "apt/account_metric_value.sql", "original_file_path": "models/apt/account_metric_value.sql", "unique_id": "model.CGOncology_MDM.account_metric_value", "fqn": ["CGOncology_MDM", "apt", "account_metric_value"], "alias": "account_metric_value", "checksum": {"name": "sha256", "checksum": "49aae051c1e560d0911735550c1c6a8dec9fc2289c2c6a782edf5ffecdfb9ace"}, "config": {"enabled": false, "alias": null, "schema": "APT", "database": null, "tags": ["layer_5_apt", "customer_backbone", "customer_backbone", "apt", "customer_backbone", "apt", "metrics"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_5_apt", "customer_backbone", "apt", "metrics"], "description": "Account metrics time series", "columns": {"account_id": {"name": "account_id", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "metric": {"name": "metric", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "x_value": {"name": "x_value", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/apt/schema.yml", "build_path": null, "unrendered_config": {"schema": "APT", "materialized": "table", "tags": ["customer_backbone", "apt", "metrics"], "enabled": false}, "created_at": 1770177079.727187, "relation_name": "CGONCOLOGY_TEST.APT.account_metric_value", "raw_code": "{{\n    config(\n        schema='APT',\n        materialized='table',\n        tags=['customer_backbone', 'apt', 'metrics']\n    )\n}}\n\n/*\nPROC-APT-007: apt_account_metric_value - Account Metrics Time Series\nSource: adm_claims_metrics_long, adm_ddd_metrics_long, apt_accounts\nBusiness Rules: APT-007, MET-001 to MET-074\n\nProvides time-series metrics for each account in apt_accounts.\nMetrics include TURBT procedures/patients, TICE BCG patients, and TICE BCG sales.\nAll dates formatted consistently as DATE type (YYYY-MM-DD).\nFilters to only accounts that exist in apt_accounts.\nOnly includes last 12 months of data from the data_date in ADM models.\n\nUPDATED 2026-01-08: Use adm_claims_metrics_long (monthly periods) instead of adm_hco_metrics_time_series.\nThis ensures practice locations (4-prefix accounts) are included via account_id_l4 rollup.\nADM tables already have everything calculated - no need to recalculate from time-series.\n\nUPDATED 2026-01-14: Changed TICE_BCG_SALE metric to use units_count instead of sales_amount from DDD.\nThis fixes the 138x discrepancy in geography-level sales trends (TEST was using dollar amounts, should use units).\n*/\n\n-- Note: Removed data_date_ref CTE as it's no longer needed\n-- adm_ddd_metrics_long already has data_date aligned with ref_time_periods\n\nWITH\n-- Claims metrics from adm_claims_metrics_long (monthly periods M01-M12)\n-- This includes practice locations via account_id_l4 rollup in adm_claims_metrics_long\n-- Note: INNER JOIN with apt_accounts ensures referential integrity (no orphan records)\nclaims_metrics_monthly AS (\n    SELECT\n        a.account_id,\n        'TURBT_PROC' AS metric,\n        tp.period_start_date::DATE AS x_value,\n        m.claim_count AS y_value\n    FROM {{ ref('adm_claims_metrics_long') }} m\n    INNER JOIN {{ ref('accounts') }} a\n        ON m.entity_id = a.account_id\n    INNER JOIN {{ ref('ref_time_periods') }} tp\n        ON m.period_key = tp.period_key\n    WHERE m.entity_type = 'HCO'\n      AND m.metric_category = 'TURBT'  -- Only TURBT claims (no TICE_BCG_PROC in metric list)\n      AND tp.period_type = 'MONTHLY'\n      AND m.claim_count > 0\n      -- Only last 12 months (period_sequence <= 12)\n      AND tp.period_sequence <= 12\n),\n\n-- Patient metrics from adm_claims_metrics_long (monthly periods M01-M12)\n-- Note: INNER JOIN with apt_accounts ensures referential integrity (no orphan records)\npatient_metrics_monthly AS (\n    SELECT\n        a.account_id,\n        CASE \n            WHEN m.metric_category = 'TURBT' THEN 'TURBT_PTS'\n            WHEN m.metric_category = 'TICE_BCG' THEN 'TICE_BCG_PTS'\n            ELSE m.metric_category || '_PTS'\n        END AS metric,\n        tp.period_start_date::DATE AS x_value,\n        m.patient_count AS y_value\n    FROM {{ ref('adm_claims_metrics_long') }} m\n    INNER JOIN {{ ref('accounts') }} a\n        ON m.entity_id = a.account_id\n    INNER JOIN {{ ref('ref_time_periods') }} tp\n        ON m.period_key = tp.period_key\n    WHERE m.entity_type = 'HCO'\n      AND m.metric_category IN ('TURBT', 'TICE_BCG')\n      AND tp.period_type = 'MONTHLY'\n      AND m.patient_count > 0\n      -- Only last 12 months (period_sequence <= 12)\n      AND tp.period_sequence <= 12\n),\n\ntime_series_metrics AS (\n    SELECT * FROM claims_metrics_monthly\n    UNION ALL\n    SELECT * FROM patient_metrics_monthly\n),\n\n-- DDD sales metrics from adm_ddd_metrics_long (monthly periods M01-M12)\n-- Uses adm_ddd_metrics_long instead of adm_ddd_metrics_wide + CROSS JOIN for better performance\n-- Note: INNER JOIN with apt_accounts ensures referential integrity (no orphan records)\n-- UPDATED 2026-01-14: Use units_count instead of sales_amount for TICE_BCG_SALE metric\nddd_sales_metrics AS (\n    SELECT\n        a.account_id,\n        CASE \n            WHEN m.metric_category = 'TICE_BCG' THEN 'TICE_BCG_SALE'\n            ELSE m.metric_category || '_SALE'\n        END AS metric,\n        tp.period_start_date::DATE AS x_value,\n        m.units_count AS y_value  -- Changed from sales_amount to units_count\n    FROM {{ ref('adm_ddd_metrics_long') }} m\n    INNER JOIN {{ ref('accounts') }} a\n        ON m.entity_id = a.account_id\n    INNER JOIN {{ ref('ref_time_periods') }} tp\n        ON m.period_key = tp.period_key\n    WHERE m.entity_type = 'HCO'\n      AND m.metric_category = 'TICE_BCG'\n      AND tp.period_type = 'MONTHLY'\n      AND m.units_count > 0  -- Changed from sales_amount to units_count\n      -- Only last 12 months (period_sequence <= 12)\n      AND tp.period_sequence <= 12\n    -- Note: Removed duplicate TICE_BCG_UNIT section - TICE_BCG_SALE already uses units_count\n)\n\nSELECT \n    account_id::VARCHAR(20) AS account_id,\n    metric::VARCHAR(50) AS metric,\n    x_value::DATE AS x_value,\n    y_value::NUMBER(18,2) AS y_value\nFROM time_series_metrics\n\nUNION ALL\n\nSELECT \n    account_id::VARCHAR(20),\n    metric::VARCHAR(50),\n    x_value::DATE,\n    y_value::NUMBER(18,2)\nFROM ddd_sales_metrics\nWHERE y_value > 0\n\nORDER BY account_id, metric, x_value", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_claims_metrics_long", "package": null, "version": null}, {"name": "accounts", "package": null, "version": null}, {"name": "ref_time_periods", "package": null, "version": null}, {"name": "adm_claims_metrics_long", "package": null, "version": null}, {"name": "accounts", "package": null, "version": null}, {"name": "ref_time_periods", "package": null, "version": null}, {"name": "adm_ddd_metrics_long", "package": null, "version": null}, {"name": "accounts", "package": null, "version": null}, {"name": "ref_time_periods", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}], "model.CGOncology_MDM.hcps": [{"database": "CGONCOLOGY_TEST", "schema": "APT", "name": "hcps", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "apt/hcps.sql", "original_file_path": "models/apt/hcps.sql", "unique_id": "model.CGOncology_MDM.hcps", "fqn": ["CGOncology_MDM", "apt", "hcps"], "alias": "hcps", "checksum": {"name": "sha256", "checksum": "97505d8b15bb3e8aa95bd523c76528727bf5b0c9ca947448a9f751871b0a1b73"}, "config": {"enabled": false, "alias": null, "schema": "APT", "database": null, "tags": ["layer_5_apt", "customer_backbone", "customer_backbone", "apt", "customer_backbone", "apt"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_5_apt", "customer_backbone", "apt"], "description": "HCP master for APT (29 columns)", "columns": {"hcp_id": {"name": "hcp_id", "description": "Primary key - HCP identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/apt/schema.yml", "build_path": null, "unrendered_config": {"schema": "APT", "materialized": "table", "tags": ["customer_backbone", "apt"], "enabled": false}, "created_at": 1770177079.726544, "relation_name": "CGONCOLOGY_TEST.APT.hcps", "raw_code": "{{\n    config(\n        schema='APT',\n        materialized='table',\n        tags=['customer_backbone', 'apt']\n    )\n}}\n\n/*\nPROC-APT-002: apt_hcps - HCP Output for Downstream\nSource: adm_hcp_master, adm_claims_metrics_long\nBusiness Rules: APT-003 to APT-004\n\nFinal output table for application consumption.\nMatches APT Import Format v15 specification (29 columns).\nOnly includes HCPs whose best affiliated account is in apt_accounts.\n*/\n\nWITH hcp_claims AS (\n    -- Get HCP-level claims metrics (L12M)\n    SELECT\n        entity_id AS kmk_hcp_id,\n        MAX(CASE WHEN metric_category = 'BC_DIAGNOSIS' THEN claim_count ELSE 0 END) AS total_bc_claims,\n        MAX(CASE WHEN metric_category = 'BC_DIAGNOSIS' THEN patient_count ELSE 0 END) AS total_bc_patients,\n        MAX(CASE WHEN metric_category = 'TICE_BCG' THEN claim_count ELSE 0 END) AS tice_bcg_claims,\n        MAX(CASE WHEN metric_category = 'TICE_BCG' THEN patient_count ELSE 0 END) AS tice_bcg_patients,\n        MAX(CASE WHEN metric_category = 'TURBT' THEN claim_count ELSE 0 END) AS turbt_claims,\n        MAX(CASE WHEN metric_category = 'TURBT' THEN patient_count ELSE 0 END) AS turbt_patients,\n        MAX(CASE WHEN metric_category = 'CYSTOSCOPY' THEN claim_count ELSE 0 END) AS cystoscopy_claims,\n        MAX(CASE WHEN metric_category = 'CYSTOSCOPY' THEN patient_count ELSE 0 END) AS cystoscopy_patients,\n        MAX(CASE WHEN metric_category = 'ADSTILADRIN' THEN claim_count ELSE 0 END) AS adstiladrin_claims,\n        MAX(CASE WHEN metric_category = 'ADSTILADRIN' THEN patient_count ELSE 0 END) AS adstiladrin_patients\n    FROM {{ ref('adm_claims_metrics_long') }}\n    WHERE entity_type = 'HCP' AND period_key = 'L12M'\n    GROUP BY entity_id\n)\n\nSELECT\n    -- Identity (columns 1-10)\n    CAST(h.kmk_hcp_id AS INT) AS hcp_id,\n    -- Fix for NPI 1225058597: source data has '-Rafik' instead of 'Rafik'\n    CAST(CASE\n        WHEN h.npi = '1225058597' THEN 'Rafik'\n        ELSE h.first_name\n    END AS VARCHAR(100)) AS first_name,\n    CAST(h.last_name AS VARCHAR(100)) AS last_name,\n    CAST(h.npi AS INT) AS npi,\n    CAST(h.primary_specialty AS VARCHAR(100)) AS specialty,\n    CAST(h.address_line1 AS VARCHAR(100)) AS address1,\n    CAST(NULL AS VARCHAR(100)) AS address2,\n    CAST(h.city AS VARCHAR(100)) AS city,\n    CAST(h.state AS VARCHAR(10)) AS state,\n    CAST(LEFT(h.zip, 5) AS VARCHAR(5)) AS zip,\n\n    -- Targeting (columns 11-13)\n    CAST(CASE WHEN h.kam_target_flag = 'Y' THEN 'Y' ELSE 'N' END AS VARCHAR(1)) AS KAM_Target,\n    CAST(h.kam_decile AS INT) AS Decile,\n    CAST(CASE WHEN h.clinical_trial_pi_flag = 'Y' THEN 'Y' ELSE 'N' END AS VARCHAR(1)) AS Clinical_Trial_P1,\n\n    -- Claims metrics (columns 14-23)\n    CAST(COALESCE(c.total_bc_claims, 0) AS INT) AS Total_BC_Claims,\n    CAST(COALESCE(c.total_bc_patients, 0) AS INT) AS Total_BC_Patients,\n    CAST(COALESCE(c.tice_bcg_claims, 0) AS INT) AS TICE_BCG_Claims,\n    CAST(COALESCE(c.tice_bcg_patients, 0) AS INT) AS TICE_BCG_Patients,\n    CAST(COALESCE(c.turbt_claims, 0) AS INT) AS TURBT_Claims,\n    CAST(COALESCE(c.turbt_patients, 0) AS INT) AS TURBT_Patients,\n    CAST(COALESCE(c.cystoscopy_claims, 0) AS INT) AS Cystoscopy_Claims,\n    CAST(COALESCE(c.cystoscopy_patients, 0) AS INT) AS Cystoscopy_Patients,\n    CAST(COALESCE(c.adstiladrin_claims, 0) AS INT) AS Adstiladrin_Claims,\n    CAST(COALESCE(c.adstiladrin_patients, 0) AS INT) AS Adstiladrin_Patients,\n\n    -- Aissel/Konectar enrichment (columns 24-28)\n    CAST(h.aissel_konectar_rank AS INT) AS Aissel_Konectar_Rank,\n    CAST(h.aissel_konectar_events_count AS INT) AS Aissel_Konectar_Events_Count,\n    CAST(h.aissel_konectar_affiliations_count AS INT) AS Aissel_Konectar_Affiliations_Count,\n    CAST(h.aissel_konectar_publications_count AS INT) AS Aissel_Konectar_Publications_Count,\n    CAST(h.aissel_konectar_trial_count AS INT) AS Aissel_Konectar_Trial_Count,\n\n    -- MSL engagement (column 29)\n    CAST(h.last_msl_engaged_date AS DATE) AS Last_MSL_Engaged_Date\n\nFROM {{ ref('adm_hcp_master') }} h\nLEFT JOIN hcp_claims c ON h.kmk_hcp_id = c.kmk_hcp_id\nWHERE h.cust_backbone_flag = 'Y'\n  AND h.best_hco_account_id IN (SELECT account_id FROM {{ ref('accounts') }})", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_claims_metrics_long", "package": null, "version": null}, {"name": "adm_hcp_master", "package": null, "version": null}, {"name": "accounts", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}], "model.CGOncology_MDM.payer_types": [{"database": "CGONCOLOGY_TEST", "schema": "APT", "name": "payer_types", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "apt/payer_types.sql", "original_file_path": "models/apt/payer_types.sql", "unique_id": "model.CGOncology_MDM.payer_types", "fqn": ["CGOncology_MDM", "apt", "payer_types"], "alias": "payer_types", "checksum": {"name": "sha256", "checksum": "199767129f89e5039f97bf18587191ec08185a37c7b3b571d62c1ed3f8cb939b"}, "config": {"enabled": false, "alias": null, "schema": "APT", "database": null, "tags": ["layer_5_apt", "customer_backbone", "customer_backbone", "apt", "customer_backbone", "apt"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_5_apt", "customer_backbone", "apt"], "description": "Payer type reference", "columns": {"code": {"name": "code", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/apt/schema.yml", "build_path": null, "unrendered_config": {"schema": "APT", "materialized": "table", "tags": ["customer_backbone", "apt"], "enabled": false}, "created_at": 1770177079.735434, "relation_name": "CGONCOLOGY_TEST.APT.payer_types", "raw_code": "{{\n    config(\n        schema='APT',\n        materialized='table',\n        tags=['customer_backbone', 'apt']\n    )\n}}\n\n/*\nPROC-APT-017: apt_payer_types - Payer Types Reference Table\nSource: apt_payer_types seed\nBusiness Rules: APT-017\n\nPayer type definitions (COMMERCIAL, MEDICARE, MEDICAID, etc.).\nExposed as view for feed export.\n*/\n\nSELECT\n    code,\n    name,\n    sort_num\nFROM {{ ref('seed_payer_types') }}", "doc_blocks": [], "language": "sql", "refs": [{"name": "seed_payer_types", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}], "model.CGOncology_MDM.geographies": [{"database": "CGONCOLOGY_TEST", "schema": "APT", "name": "geographies", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "apt/geographies.sql", "original_file_path": "models/apt/geographies.sql", "unique_id": "model.CGOncology_MDM.geographies", "fqn": ["CGOncology_MDM", "apt", "geographies"], "alias": "geographies", "checksum": {"name": "sha256", "checksum": "fde44cef0b05f5773b5aaabe3cab7e411bba9b62e5657545bff44f110ff72233"}, "config": {"enabled": false, "alias": null, "schema": "APT", "database": null, "tags": ["layer_5_apt", "customer_backbone", "customer_backbone", "apt", "sfe", "customer_backbone", "apt", "sfe"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_5_apt", "customer_backbone", "apt", "sfe"], "description": "Sales force geography hierarchy", "columns": {"geo_code": {"name": "geo_code", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/apt/schema.yml", "build_path": null, "unrendered_config": {"schema": "APT", "materialized": "table", "tags": ["customer_backbone", "apt", "sfe"], "enabled": false}, "created_at": 1770177079.7310731, "relation_name": "CGONCOLOGY_TEST.APT.geographies", "raw_code": "{{\n    config(\n        schema='APT',\n        materialized='table',\n        tags=['customer_backbone', 'apt', 'sfe']\n    )\n}}\n\n/*\nPROC-APT-003: apt_geographies - Sales Force Geography for Downstream\nSource: adm_sfe_geographies\nBusiness Rules: APT-003\n\nPublishes the sales hierarchy (Territory -> Region -> Nation) for downstream consumption.\nMatches APT Import Format v15 specification (5 columns).\n*/\n\nSELECT\n    geo_code::VARCHAR(20) AS geo_code,\n    geo_name::VARCHAR(100) AS geo_name,\n    parent_geo_code::VARCHAR(20) AS parent_code,\n    'UNIT_1'::VARCHAR(20) AS unit,\n    team::VARCHAR(20) AS team\nFROM {{ ref('adm_sfe_geographies') }}\nWHERE geo_code IS NOT NULL", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_sfe_geographies", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}], "model.CGOncology_MDM.states": [{"database": "CGONCOLOGY_TEST", "schema": "APT", "name": "states", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "apt/states.sql", "original_file_path": "models/apt/states.sql", "unique_id": "model.CGOncology_MDM.states", "fqn": ["CGOncology_MDM", "apt", "states"], "alias": "states", "checksum": {"name": "sha256", "checksum": "022ef2742678a6bf8a3bb7cdf6837af34b80f9a1a9aac0ba6cc4056899a14c4e"}, "config": {"enabled": false, "alias": null, "schema": "APT", "database": null, "tags": ["layer_5_apt", "customer_backbone", "customer_backbone", "apt", "customer_backbone", "apt"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_5_apt", "customer_backbone", "apt"], "description": "State code reference", "columns": {"code": {"name": "code", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/apt/schema.yml", "build_path": null, "unrendered_config": {"schema": "APT", "materialized": "table", "tags": ["customer_backbone", "apt"], "enabled": false}, "created_at": 1770177079.737474, "relation_name": "CGONCOLOGY_TEST.APT.states", "raw_code": "{{\n    config(\n        schema='APT',\n        materialized='table',\n        tags=['customer_backbone', 'apt']\n    )\n}}\n\n/*\nPROC-APT-005: apt_states - State Reference Table\nSource: Static reference data\nBusiness Rules: APT-005\n\nMaps 2-character state codes to full state names for UI display.\nStatic reference table matching APT Import Format v15.\n*/\n\nSELECT code::VARCHAR(2) AS code, name::VARCHAR(50) AS name FROM (VALUES\n    ('AK', 'Alaska'),\n    ('AL', 'Alabama'),\n    ('AR', 'Arkansas'),\n    ('AZ', 'Arizona'),\n    ('CA', 'California'),\n    ('CO', 'Colorado'),\n    ('CT', 'Connecticut'),\n    ('DC', 'District of Columbia'),\n    ('DE', 'Delaware'),\n    ('FL', 'Florida'),\n    ('GA', 'Georgia'),\n    ('GU', 'Guam'),\n    ('HI', 'Hawaii'),\n    ('IA', 'Iowa'),\n    ('ID', 'Idaho'),\n    ('IL', 'Illinois'),\n    ('IN', 'Indiana'),\n    ('KS', 'Kansas'),\n    ('KY', 'Kentucky'),\n    ('LA', 'Louisiana'),\n    ('MA', 'Massachusetts'),\n    ('MD', 'Maryland'),\n    ('ME', 'Maine'),\n    ('MI', 'Michigan'),\n    ('MN', 'Minnesota'),\n    ('MO', 'Missouri'),\n    ('MS', 'Mississippi'),\n    ('MT', 'Montana'),\n    ('NC', 'North Carolina'),\n    ('ND', 'North Dakota'),\n    ('NE', 'Nebraska'),\n    ('NH', 'New Hampshire'),\n    ('NJ', 'New Jersey'),\n    ('NM', 'New Mexico'),\n    ('NV', 'Nevada'),\n    ('NY', 'New York'),\n    ('OH', 'Ohio'),\n    ('OK', 'Oklahoma'),\n    ('OR', 'Oregon'),\n    ('PA', 'Pennsylvania'),\n    ('PR', 'Puerto Rico'),\n    ('RI', 'Rhode Island'),\n    ('SC', 'South Carolina'),\n    ('SD', 'South Dakota'),\n    ('TN', 'Tennessee'),\n    ('TX', 'Texas'),\n    ('UT', 'Utah'),\n    ('VA', 'Virginia'),\n    ('VT', 'Vermont'),\n    ('WA', 'Washington'),\n    ('WI', 'Wisconsin'),\n    ('WV', 'West Virginia'),\n    ('WY', 'Wyoming'),\n    ('VI', 'Virgin Islands')\n) AS t(code, name)\nORDER BY code", "doc_blocks": [], "language": "sql", "refs": [], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}], "model.CGOncology_MDM.targets": [{"database": "CGONCOLOGY_TEST", "schema": "APT", "name": "targets", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "apt/targets.sql", "original_file_path": "models/apt/targets.sql", "unique_id": "model.CGOncology_MDM.targets", "fqn": ["CGOncology_MDM", "apt", "targets"], "alias": "targets", "checksum": {"name": "sha256", "checksum": "becd2dd8273e357b20a6d9de9a42e8c9b42394d2fe7b5391cfd30f815d96686a"}, "config": {"enabled": false, "alias": null, "schema": "APT", "database": null, "tags": ["layer_5_apt", "customer_backbone", "customer_backbone", "apt", "customer_backbone", "apt"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_5_apt", "customer_backbone", "apt"], "description": "Account targeting by team", "columns": {"team_code": {"name": "team_code", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "account_id": {"name": "account_id", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/apt/schema.yml", "build_path": null, "unrendered_config": {"schema": "APT", "materialized": "table", "tags": ["customer_backbone", "apt"], "enabled": false}, "created_at": 1770177079.728917, "relation_name": "CGONCOLOGY_TEST.APT.targets", "raw_code": "{{\n    config(\n        schema='APT',\n        materialized='table',\n        tags=['customer_backbone', 'apt']\n    )\n}}\n\n/*\nPROC-APT-004: apt_targets - Account Targeting for Teams\nSource: adm_sfe_hco_targets (consolidated SFE target flags)\nBusiness Rules: TGT-001 to TGT-020\n\nMaps accounts to teams (KAM, HSD, MSL, PAYOR) based on SFE target flags.\nMatches APT Import Format v15 specification (2 columns).\n*/\n\nWITH sfe_targets AS (\n    SELECT * FROM {{ ref('adm_sfe_hco_targets') }}\n),\n\naccounts AS (\n    SELECT account_id, account_type FROM {{ ref('accounts') }}\n),\n\nkam_targets AS (\n    -- KAM targets: Network + Child (filtered to accounts in ACCOUNTS table)\n    SELECT DISTINCT\n        'TEAM_KAM'::VARCHAR(20) AS team_code,\n        t.kmk_hco_id::VARCHAR(20) AS account_id\n    FROM sfe_targets t\n    WHERE (t.kam_network_target_flag = 'Y' OR t.kam_child_target_flag = 'Y')\n      AND t.kmk_hco_id IN (SELECT account_id FROM accounts)\n),\n\nhsd_targets AS (\n    -- HSD targets: flagged in SFE target list\n    SELECT DISTINCT\n        'TEAM_HSD'::VARCHAR(20) AS team_code,\n        t.kmk_hco_id::VARCHAR(20) AS account_id\n    FROM sfe_targets t\n    WHERE t.hsd_target_flag = 'Y'\n      AND t.kmk_hco_id IN (SELECT account_id FROM accounts)\n),\n\nmsl_targets AS (\n    -- MSL targets: flagged in SFE target list\n    SELECT DISTINCT\n        'TEAM_MSL'::VARCHAR(20) AS team_code,\n        t.kmk_hco_id::VARCHAR(20) AS account_id\n    FROM sfe_targets t\n    WHERE t.msl_target_flag = 'Y'\n      AND t.kmk_hco_id IN (SELECT account_id FROM accounts)\n),\n\npayor_targets AS (\n    -- Payor targets: All payor accounts\n    SELECT DISTINCT\n        'TEAM_PAYOR'::VARCHAR(20) AS team_code,\n        account_id::VARCHAR(20) AS account_id\n    FROM accounts\n    WHERE account_type = 'Payor'\n)\n\nSELECT team_code, account_id FROM kam_targets\nUNION ALL\nSELECT team_code, account_id FROM hsd_targets\nUNION ALL\nSELECT team_code, account_id FROM msl_targets\nUNION ALL\nSELECT team_code, account_id FROM payor_targets", "doc_blocks": [], "language": "sql", "refs": [{"name": "adm_sfe_hco_targets", "package": null, "version": null}, {"name": "accounts", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}], "model.CGOncology_MDM.accounts_geo_affiliation": [{"database": "CGONCOLOGY_TEST", "schema": "APT", "name": "accounts_geo_affiliation", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "apt/accounts_geo_affiliation.sql", "original_file_path": "models/apt/accounts_geo_affiliation.sql", "unique_id": "model.CGOncology_MDM.accounts_geo_affiliation", "fqn": ["CGOncology_MDM", "apt", "accounts_geo_affiliation"], "alias": "accounts_geo_affiliation", "checksum": {"name": "sha256", "checksum": "070f3a5c83800d37f9d6e7b1d183aa5587d461795623bf779b78a3483c7752d9"}, "config": {"enabled": false, "alias": null, "schema": "APT", "database": null, "tags": ["layer_5_apt", "customer_backbone", "customer_backbone", "apt", "customer_backbone", "apt", "sfe"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_5_apt", "customer_backbone", "apt", "sfe"], "description": "Account-geography mapping", "columns": {"account_id": {"name": "account_id", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}, "geo_code": {"name": "geo_code", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/apt/schema.yml", "build_path": null, "unrendered_config": {"schema": "APT", "materialized": "table", "tags": ["customer_backbone", "apt", "sfe"], "enabled": false}, "created_at": 1770177079.729462, "relation_name": "CGONCOLOGY_TEST.APT.accounts_geo_affiliation", "raw_code": "{{\n    config(\n        schema='APT',\n        materialized='table',\n        tags=['customer_backbone', 'apt', 'sfe']\n    )\n}}\n\n/*\nPROC-APT-006: apt_account_geo_affiliation - Account Geography Mapping\nSource: apt_accounts, std_zip_territory\nBusiness Rules: APT-006\n\nMaps accounts to geography codes (territory/region/nation) for each team.\nEach account can have multiple geo_code entries (one per team).\nMatches APT Import Format v15 specification (2 columns).\n*/\n\nWITH account_geos AS (\n    SELECT\n        a.account_id,\n        a.zip,\n        g.kam_territory_code,\n        g.hsd_territory_code,\n        g.msl_territory_code\n    FROM {{ ref('accounts') }} a\n    LEFT JOIN {{ ref('std_zip_territory') }} g\n        ON a.zip = g.zip_code\n    WHERE a.account_id NOT LIKE 'P%'  -- Exclude payors\n)\n\n-- KAM territories\nSELECT\n    account_id::VARCHAR(20) AS account_id,\n    COALESCE(kam_territory_code, 'C1Z9999')::VARCHAR(20) AS geo_code\nFROM account_geos\n\nUNION ALL\n\n-- HSD territories\nSELECT\n    account_id::VARCHAR(20),\n    COALESCE(hsd_territory_code, 'C2Z9999')::VARCHAR(20)\nFROM account_geos\n\nUNION ALL\n\n-- MSL territories\nSELECT\n    account_id::VARCHAR(20),\n    COALESCE(msl_territory_code, 'C3Z99')::VARCHAR(20)\nFROM account_geos\n\nUNION ALL\n\n-- Payor accounts\nSELECT\n    account_id::VARCHAR(20),\n    'C4A0000'::VARCHAR(20)\nFROM {{ ref('accounts') }}\nWHERE account_id LIKE 'P%'", "doc_blocks": [], "language": "sql", "refs": [{"name": "accounts", "package": null, "version": null}, {"name": "std_zip_territory", "package": null, "version": null}, {"name": "accounts", "package": null, "version": null}], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}], "model.CGOncology_MDM.apt_data_quality_log": [{"database": "CGONCOLOGY_TEST", "schema": "APT", "name": "apt_data_quality_log", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "apt/apt_data_quality_log.sql", "original_file_path": "models/apt/apt_data_quality_log.sql", "unique_id": "model.CGOncology_MDM.apt_data_quality_log", "fqn": ["CGOncology_MDM", "apt", "apt_data_quality_log"], "alias": "apt_data_quality_log", "checksum": {"name": "sha256", "checksum": "39eb72ee5b720032731040b3e9fb041410062551ead9075df30f20d7f873bd62"}, "config": {"enabled": false, "alias": null, "schema": "APT", "database": null, "tags": ["layer_5_apt", "customer_backbone", "customer_backbone", "apt", "monitoring", "customer_backbone", "apt", "monitoring"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_5_apt", "customer_backbone", "apt", "monitoring"], "description": "Data quality log (placeholder - empty)", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/apt/schema.yml", "build_path": null, "unrendered_config": {"schema": "APT", "materialized": "table", "tags": ["customer_backbone", "apt", "monitoring"], "enabled": false}, "created_at": 1770177079.741621, "relation_name": "CGONCOLOGY_TEST.APT.apt_data_quality_log", "raw_code": "{{\n    config(\n        schema='APT',\n        materialized='table',\n        tags=['customer_backbone', 'apt', 'monitoring']\n    )\n}}\n\n/*\nPROC-APT-999: apt_data_quality_log - Data Quality Monitoring Log\nPurpose: Track validation failures, data quality metrics, and execution metadata\n\nThis table logs:\n- Validation test results\n- Data quality metrics\n- Execution metadata\n- Error messages\n\nUsed by build_apt_pipeline.py to track build quality over time.\n*/\n\n-- Create table structure (will be populated by validation macros and build script)\nSELECT \n    CAST(NULL AS VARCHAR(100)) AS run_id,\n    CAST(NULL AS VARCHAR(50)) AS test_id,\n    CAST(NULL AS VARCHAR(50)) AS check_type,\n    CAST(NULL AS VARCHAR(20)) AS status,\n    CAST(NULL AS NUMBER) AS failure_count,\n    CAST(NULL AS VARCHAR(1000)) AS message,\n    CAST(NULL AS TIMESTAMP_NTZ) AS created_at\nWHERE 1=0", "doc_blocks": [], "language": "sql", "refs": [], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}], "model.CGOncology_MDM.account_levels": [{"database": "CGONCOLOGY_TEST", "schema": "APT", "name": "account_levels", "resource_type": "model", "package_name": "CGOncology_MDM", "path": "apt/account_levels.sql", "original_file_path": "models/apt/account_levels.sql", "unique_id": "model.CGOncology_MDM.account_levels", "fqn": ["CGOncology_MDM", "apt", "account_levels"], "alias": "account_levels", "checksum": {"name": "sha256", "checksum": "9c2c9d368329131dc8d0fe0721addec43e606be0d68b721f485b6d14262d8ef8"}, "config": {"enabled": false, "alias": null, "schema": "APT", "database": null, "tags": ["layer_5_apt", "customer_backbone", "customer_backbone", "apt", "customer_backbone", "apt"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected", "freshness": null}, "tags": ["layer_5_apt", "customer_backbone", "apt"], "description": "Account level reference", "columns": {"code": {"name": "code", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "config": {"meta": {}, "tags": []}, "tags": [], "granularity": null, "doc_blocks": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "CGOncology_MDM://models/apt/schema.yml", "build_path": null, "unrendered_config": {"schema": "APT", "materialized": "table", "tags": ["customer_backbone", "apt"], "enabled": false}, "created_at": 1770177079.731589, "relation_name": "CGONCOLOGY_TEST.APT.account_levels", "raw_code": "{{\n    config(\n        schema='APT',\n        materialized='table',\n        tags=['customer_backbone', 'apt']\n    )\n}}\n\n/*\nPROC-APT-012: apt_account_levels - Account Level Reference\nSource: Static reference data\nBusiness Rules: APT-012\n\nMaps hierarchy level codes to display names for UI.\nStatic reference table matching APT Import Format v15.\n*/\n\nSELECT 'L1_IDN'::VARCHAR(50) AS code, 'L1 IDN'::VARCHAR(100) AS name, 1::INT AS sort_num\nUNION ALL SELECT 'L1_PE', 'L1 PE', 2\nUNION ALL SELECT 'L2_CORPORATIONS', 'L2 Corporations', 3\nUNION ALL SELECT 'L2_SUB_IDN', 'L2 Sub-IDN', 4\nUNION ALL SELECT 'L3_CHILD_ACCOUNT', 'L3 Child Account', 5\nUNION ALL SELECT 'L4_PRACTICE_LOCATION', 'L4 Practice Location', 6", "doc_blocks": [], "language": "sql", "refs": [], "sources": [], "metrics": [], "functions": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": null, "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null, "primary_key": [], "time_spine": null}]}, "parent_map": {"model.CGOncology_MDM.mdm_customer_master_hco": ["model.CGOncology_MDM.mdm_customer_xref_hco", "model.CGOncology_MDM.std_dh_hco", "model.CGOncology_MDM.std_dh_practice_location_hist"], "model.CGOncology_MDM.mdm_customer_xref_hcp": ["model.CGOncology_MDM.match_medscout_dhc_hcp", "model.CGOncology_MDM.std_dh_hcp", "model.CGOncology_MDM.std_medscout_hcp"], "model.CGOncology_MDM.mdm_customer_xref_hcp_hist": ["model.CGOncology_MDM.mdm_customer_xref_hcp"], "model.CGOncology_MDM.mdm_customer_xref_hco_hist": ["model.CGOncology_MDM.mdm_customer_xref_hco"], "model.CGOncology_MDM.mdm_best_affiliation_hist": ["model.CGOncology_MDM.mdm_best_affiliation"], "model.CGOncology_MDM.mdm_ref_market_definition": ["seed.CGOncology_MDM.config_ddd_sub_category", "seed.CGOncology_MDM.seed_bc_dx_code_mapping", "seed.CGOncology_MDM.seed_bc_px_code_mapping", "seed.CGOncology_MDM.seed_bc_rx_ndc_mapping"], "model.CGOncology_MDM.mdm_best_affiliation": ["model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.mdm_customer_master_hcp", "model.CGOncology_MDM.std_dh_hcp_hco_affiliation", "model.CGOncology_MDM.std_dh_hcp_hist", "model.CGOncology_MDM.std_dx_claims", "model.CGOncology_MDM.std_px_claims", "model.CGOncology_MDM.stg_hcp_bc_metrics"], "model.CGOncology_MDM.mdm_customer_master_hcp": ["model.CGOncology_MDM.mdm_customer_xref_hcp"], "model.CGOncology_MDM.mdm_customer_xref_hco": ["model.CGOncology_MDM.match_ddd_dhc", "model.CGOncology_MDM.std_ddd_hco", "model.CGOncology_MDM.std_dh_hco", "model.CGOncology_MDM.std_dh_practice_location_hist", "model.CGOncology_MDM.std_medscout_hco"], "model.CGOncology_MDM.stg_hcp_hco_claims": ["model.CGOncology_MDM.ref_treatment_categories", "model.CGOncology_MDM.std_dx_claims", "model.CGOncology_MDM.std_px_claims", "model.CGOncology_MDM.std_rx_claims", "model.CGOncology_MDM.stg_bc_patient_pool"], "model.CGOncology_MDM.stg_hcp_bc_metrics": ["model.CGOncology_MDM.mdm_customer_xref_hcp_hist", "model.CGOncology_MDM.std_dh_hcp", "model.CGOncology_MDM.std_dh_hcp_hist", "model.CGOncology_MDM.std_medscout_hcp", "model.CGOncology_MDM.stg_hcp_hco_claims"], "model.CGOncology_MDM.stg_bc_patient_pool": ["model.CGOncology_MDM.std_dx_bc_patients", "model.CGOncology_MDM.std_px_bc_patients", "model.CGOncology_MDM.std_rx_bc_patients"], "model.CGOncology_MDM.match_ddd_dhc": ["model.CGOncology_MDM.std_ddd_hco", "model.CGOncology_MDM.std_dh_hco", "model.CGOncology_MDM.std_dh_practice_location_hist", "source.CGOncology_MDM.raw_dh.PRELAND_CG_ONCOLOGY_FULL_MATCHING_RETURN_20241025", "source.CGOncology_MDM.raw_medscout.PRELAND_MEDSCOUT_HCO_DATA"], "model.CGOncology_MDM.match_medscout_dhc_hcp": ["model.CGOncology_MDM.std_dh_hcp", "model.CGOncology_MDM.std_medscout_hcp"], "model.CGOncology_MDM.adm_sfe_hcp_targets": ["model.CGOncology_MDM.mdm_customer_xref_hcp", "model.CGOncology_MDM.stg_sfe_targets"], "model.CGOncology_MDM.adm_sfe_hco_targets": ["model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.mdm_customer_xref_hco", "model.CGOncology_MDM.stg_sfe_targets"], "model.CGOncology_MDM.hcp_decile": ["source.CGOncology_MDM.cgoncology_dev_reporting.HCP_VIEW_DETAIL_TABLE"], "model.CGOncology_MDM.adm_sfe_zip_alignment": [], "model.CGOncology_MDM.stg_sfe_targets": ["source.CGOncology_MDM.cgoncology_prod_analytical.CG_MSL_Target_list", "source.CGOncology_MDM.cgoncology_prod_analytical.HSD_TARGET_UNIVERSE_UPDATED_RANK", "source.CGOncology_MDM.staging.ADMIN_SITE_TARGET_LIST_ACCT_ID", "source.CGOncology_MDM.staging.CG_ONCOLOGY_HCP_TARGETING_LIST", "source.CGOncology_MDM.staging.CHILD_SITE_TARGET_LIST_ACCT_ID"], "model.CGOncology_MDM.adm_sfe_geographies": ["model.CGOncology_MDM.std_zip_territory"], "model.CGOncology_MDM.std_dh_hco": ["seed.CGOncology_MDM.zip_city_state_config", "source.CGOncology_MDM.raw_dh.PRELAND_DH_ALL_COMPANIES_OVERVIEW"], "model.CGOncology_MDM.std_ddd_sales": ["source.CGOncology_MDM.raw_ddd.PRELAND_DDD_SALES"], "model.CGOncology_MDM.std_dh_hco_hist": ["model.CGOncology_MDM.std_dh_hco"], "model.CGOncology_MDM.std_rx_claims": ["seed.CGOncology_MDM.seed_bc_rx_ndc_mapping", "source.CGOncology_MDM.raw_dh.PRELAND_DH_BLADDERCANCER_RX"], "model.CGOncology_MDM.std_dh_hcp_hist": ["model.CGOncology_MDM.std_dh_hcp"], "model.CGOncology_MDM.std_dx_claims": ["seed.CGOncology_MDM.seed_bc_dx_code_mapping", "source.CGOncology_MDM.raw_dh.PRELAND_DH_BLADDERCANCER_HXMX_DIAGNOSIS"], "model.CGOncology_MDM.std_dh_hcp_hco_affiliation_hist": ["model.CGOncology_MDM.std_dh_hcp", "model.CGOncology_MDM.std_dh_hcp_hco_affiliation"], "model.CGOncology_MDM.std_medscout_hcp": ["source.CGOncology_MDM.raw_medscout.PRELAND_MEDSCOUT_HCP_DATA"], "model.CGOncology_MDM.std_dx_bc_patients": ["model.CGOncology_MDM.std_dx_claims", "seed.CGOncology_MDM.seed_bc_dx_code_mapping"], "model.CGOncology_MDM.std_px_bc_patients": ["model.CGOncology_MDM.std_px_claims", "seed.CGOncology_MDM.seed_bc_px_code_mapping"], "model.CGOncology_MDM.std_dh_hcp_hco_affiliation": ["source.CGOncology_MDM.raw_dh.PRELAND_DH_PHYSICIANS_FACILITY_AFFILIATION"], "model.CGOncology_MDM.std_ddd_hco": ["seed.CGOncology_MDM.config_ddd_sub_category", "seed.CGOncology_MDM.zip_city_state_config", "source.CGOncology_MDM.raw_ddd.PRELAND_DDD_DEMOGRAPHICS", "source.CGOncology_MDM.raw_ddd.PRELAND_DDD_SALES"], "model.CGOncology_MDM.std_ddd_hco_hist": ["model.CGOncology_MDM.std_ddd_hco"], "model.CGOncology_MDM.std_medscout_hco_hist": ["model.CGOncology_MDM.std_medscout_hco"], "model.CGOncology_MDM.std_zip_territory": ["model.CGOncology_MDM.adm_sfe_zip_alignment"], "model.CGOncology_MDM.std_dh_practice_location": ["seed.CGOncology_MDM.zip_city_state_config", "source.CGOncology_MDM.raw_dh.PRELAND_DH_PHYSICIAN_GROUP_PRACTICE_LOCATION"], "model.CGOncology_MDM.std_dh_facility_to_facility_affiliation": ["source.CGOncology_MDM.raw_dh.PRELAND_DH_FACILITY_TO_FACILITY_AFFILIATION"], "model.CGOncology_MDM.std_medscout_hcp_hist": ["model.CGOncology_MDM.std_medscout_hcp"], "model.CGOncology_MDM.std_rx_bc_patients": ["model.CGOncology_MDM.std_rx_claims", "seed.CGOncology_MDM.seed_bc_rx_ndc_mapping"], "model.CGOncology_MDM.std_dh_hcp": ["seed.CGOncology_MDM.zip_city_state_config", "source.CGOncology_MDM.raw_dh.PRELAND_DH_PHYSICIANS_OVERVIEW"], "model.CGOncology_MDM.std_ddd_sales_hist": ["model.CGOncology_MDM.std_ddd_sales"], "model.CGOncology_MDM.std_dh_practice_location_hist": ["model.CGOncology_MDM.std_dh_hco", "model.CGOncology_MDM.std_dh_practice_location"], "model.CGOncology_MDM.std_px_claims": ["seed.CGOncology_MDM.seed_bc_px_code_mapping", "source.CGOncology_MDM.raw_dh.PRELAND_DH_BLADDERCANCER_HXMX_PROCEDURE"], "model.CGOncology_MDM.std_dh_facility_to_facility_affiliation_hist": ["model.CGOncology_MDM.std_dh_facility_to_facility_affiliation"], "model.CGOncology_MDM.std_medscout_hco": ["source.CGOncology_MDM.raw_medscout.PRELAND_MEDSCOUT_HCO_DATA"], "model.CGOncology_MDM.adm_lowest_level_metrics": ["model.CGOncology_MDM.adm_ddd_metrics_grain", "model.CGOncology_MDM.adm_dh_metrics_grain", "model.CGOncology_MDM.adm_hco_hierarchy", "model.CGOncology_MDM.ref_time_periods"], "model.CGOncology_MDM.adm_address_best_ddd_metrics_long": ["model.CGOncology_MDM.adm_ddd_metrics_grain", "model.CGOncology_MDM.ref_address_best_hco", "model.CGOncology_MDM.ref_time_periods"], "model.CGOncology_MDM.ref_time_periods": [], "model.CGOncology_MDM.adm_pipeline_diff": ["model.CGOncology_MDM.adm_pipeline_snapshot"], "model.CGOncology_MDM.adm_nmibc_risk": ["model.CGOncology_MDM.std_dx_claims", "model.CGOncology_MDM.std_px_claims", "model.CGOncology_MDM.stg_bc_patient_pool"], "model.CGOncology_MDM.adm_hcp_master": ["model.CGOncology_MDM.adm_hco_hierarchy", "model.CGOncology_MDM.mdm_best_affiliation_hist", "model.CGOncology_MDM.mdm_customer_master_hcp", "model.CGOncology_MDM.stg_hcp_bc_metrics", "source.CGOncology_MDM.cgoncology_dev_adm.HCP_AISSEL", "source.CGOncology_MDM.cgoncology_dev_adm.MEDICAL_INSIGHTS", "source.CGOncology_MDM.cgoncology_dev_adm.MEDICAL_INTERACTIONS", "source.CGOncology_MDM.cgoncology_dev_reporting.ACTIVITY_DASHBOARD_METRICS", "source.CGOncology_MDM.cgoncology_dev_reporting.CLINICAL_TRIAL_DATA"], "model.CGOncology_MDM.adm_ddd_metrics_wide": ["model.CGOncology_MDM.adm_ddd_metrics_long", "model.CGOncology_MDM.adm_hco_hierarchy", "model.CGOncology_MDM.ref_time_periods"], "model.CGOncology_MDM.adm_ddd_metrics_grain": ["model.CGOncology_MDM.adm_hco_hierarchy", "model.CGOncology_MDM.match_ddd_dhc", "model.CGOncology_MDM.mdm_customer_xref_hco", "model.CGOncology_MDM.std_ddd_hco", "model.CGOncology_MDM.std_ddd_sales"], "model.CGOncology_MDM.adm_hco_claims_wide": ["model.CGOncology_MDM.adm_claims_metrics_long", "model.CGOncology_MDM.adm_hco_hierarchy", "model.CGOncology_MDM.adm_hco_master", "model.CGOncology_MDM.ref_time_periods"], "model.CGOncology_MDM.adm_address_best_hco_metrics_wide": ["model.CGOncology_MDM.adm_address_best_hco_metrics_long", "model.CGOncology_MDM.adm_hco_hierarchy", "model.CGOncology_MDM.adm_hco_master", "model.CGOncology_MDM.ref_address_best_hco", "model.CGOncology_MDM.ref_time_periods"], "model.CGOncology_MDM.adm_pipeline_snapshot": [], "model.CGOncology_MDM.ref_address_best_hco": ["model.CGOncology_MDM.adm_hco_hierarchy", "model.CGOncology_MDM.mdm_customer_master_hco"], "model.CGOncology_MDM.adm_address_best_hco_metrics_long": ["model.CGOncology_MDM.adm_dh_metrics_grain", "model.CGOncology_MDM.ref_address_best_hco", "model.CGOncology_MDM.ref_time_periods"], "model.CGOncology_MDM.adm_ddd_metrics_long": ["model.CGOncology_MDM.adm_ddd_metrics_grain", "model.CGOncology_MDM.ref_time_periods"], "model.CGOncology_MDM.adm_hco_nmibc_metrics": ["model.CGOncology_MDM.adm_hco_hierarchy", "model.CGOncology_MDM.adm_nmibc_risk", "model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.ref_time_periods", "model.CGOncology_MDM.std_dx_claims", "model.CGOncology_MDM.std_px_claims"], "model.CGOncology_MDM.adm_claims_metrics_long": ["model.CGOncology_MDM.adm_dh_metrics_grain", "model.CGOncology_MDM.ref_time_periods"], "model.CGOncology_MDM.ref_treatment_categories": ["seed.CGOncology_MDM.seed_bc_dx_code_mapping", "seed.CGOncology_MDM.seed_bc_px_code_mapping", "seed.CGOncology_MDM.seed_bc_rx_ndc_mapping"], "model.CGOncology_MDM.adm_hcp_claims_wide": ["model.CGOncology_MDM.adm_claims_metrics_long", "model.CGOncology_MDM.mdm_best_affiliation_hist", "model.CGOncology_MDM.mdm_customer_master_hcp", "model.CGOncology_MDM.ref_time_periods"], "model.CGOncology_MDM.adm_dh_metrics_grain": ["model.CGOncology_MDM.adm_hco_hierarchy", "model.CGOncology_MDM.mdm_best_affiliation_hist", "model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.mdm_customer_master_hcp", "model.CGOncology_MDM.std_dx_claims", "model.CGOncology_MDM.std_px_claims", "model.CGOncology_MDM.std_rx_claims", "model.CGOncology_MDM.stg_bc_patient_pool", "seed.CGOncology_MDM.account_type_business_input"], "model.CGOncology_MDM.adm_claims_metrics_by_payor": ["model.CGOncology_MDM.adm_dh_metrics_grain", "model.CGOncology_MDM.ref_payor_types", "model.CGOncology_MDM.ref_time_periods"], "model.CGOncology_MDM.adm_hco_master": ["model.CGOncology_MDM.adm_claims_metrics_long", "model.CGOncology_MDM.adm_ddd_metrics_wide", "model.CGOncology_MDM.adm_hco_hierarchy", "model.CGOncology_MDM.adm_hcp_master", "model.CGOncology_MDM.mdm_best_affiliation_hist", "model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.ref_time_periods", "model.CGOncology_MDM.stg_hcp_bc_metrics", "seed.CGOncology_MDM.account_type_business_input"], "model.CGOncology_MDM.adm_pipeline_trend": ["model.CGOncology_MDM.adm_pipeline_snapshot"], "model.CGOncology_MDM.adm_address_best_ddd_metrics_wide": ["model.CGOncology_MDM.adm_address_best_ddd_metrics_long", "model.CGOncology_MDM.adm_hco_hierarchy", "model.CGOncology_MDM.adm_hco_master", "model.CGOncology_MDM.ref_address_best_hco", "model.CGOncology_MDM.ref_time_periods"], "model.CGOncology_MDM.ref_payor_types": [], "model.CGOncology_MDM.adm_hco_hierarchy": ["model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.ref_time_periods", "model.CGOncology_MDM.std_dh_facility_to_facility_affiliation_hist", "seed.CGOncology_MDM.config_mso_known_affiliations"], "model.CGOncology_MDM.source_orders": [], "model.CGOncology_MDM.incremental_orders": ["model.CGOncology_MDM.source_orders"], "model.CGOncology_MDM.source_customers": [], "snapshot.CGOncology_MDM.snap_customers": ["model.CGOncology_MDM.source_customers"], "analysis.CGOncology_MDM.val_path2_skip_validation": [], "test.CGOncology_MDM.test_ddd_grain_long_reconciliation": ["model.CGOncology_MDM.adm_ddd_metrics_grain", "model.CGOncology_MDM.adm_ddd_metrics_long", "model.CGOncology_MDM.adm_ddd_metrics_wide", "model.CGOncology_MDM.adm_hco_hierarchy"], "test.CGOncology_MDM.qc_date_ranges": ["model.CGOncology_MDM.std_dx_claims", "model.CGOncology_MDM.std_px_claims", "model.CGOncology_MDM.std_rx_claims"], "test.CGOncology_MDM.test_quarterly_freeze_consistency": ["model.CGOncology_MDM.adm_hco_master"], "test.CGOncology_MDM.test_ddd_l4_reconciliation": ["model.CGOncology_MDM.adm_ddd_metrics_grain", "model.CGOncology_MDM.adm_ddd_metrics_long", "model.CGOncology_MDM.adm_hco_hierarchy"], "test.CGOncology_MDM.test_standardization_bounds": ["model.CGOncology_MDM.hcp_decile"], "test.CGOncology_MDM.test_cumulative_decile_boundaries": ["model.CGOncology_MDM.hcp_decile"], "test.CGOncology_MDM.test_weighted_score_formula": ["model.CGOncology_MDM.hcp_decile"], "test.CGOncology_MDM.test_decile_score_distribution": ["model.CGOncology_MDM.hcp_decile"], "test.CGOncology_MDM.val_cb_028_treatment_category_distribution": ["model.CGOncology_MDM.stg_hcp_hco_claims"], "test.CGOncology_MDM.val_cb_025_code_mapping_coverage": ["model.CGOncology_MDM.std_dx_bc_patients", "model.CGOncology_MDM.std_dx_claims", "model.CGOncology_MDM.std_px_bc_patients", "model.CGOncology_MDM.std_px_claims", "model.CGOncology_MDM.std_rx_bc_patients", "model.CGOncology_MDM.std_rx_claims", "seed.CGOncology_MDM.seed_bc_dx_code_mapping", "seed.CGOncology_MDM.seed_bc_px_code_mapping", "seed.CGOncology_MDM.seed_bc_rx_ndc_mapping"], "test.CGOncology_MDM.val_cb_029_code_mapping_completeness": ["model.CGOncology_MDM.std_dx_claims", "model.CGOncology_MDM.std_px_claims", "model.CGOncology_MDM.std_rx_claims", "seed.CGOncology_MDM.seed_bc_dx_code_mapping", "seed.CGOncology_MDM.seed_bc_px_code_mapping", "seed.CGOncology_MDM.seed_bc_rx_ndc_mapping"], "test.CGOncology_MDM.val_cb_026_patient_pool_consolidation": ["model.CGOncology_MDM.std_dx_bc_patients", "model.CGOncology_MDM.std_px_bc_patients", "model.CGOncology_MDM.std_rx_bc_patients", "model.CGOncology_MDM.stg_bc_patient_pool"], "test.CGOncology_MDM.dashboard_reporting_test_cases_dev": [], "test.CGOncology_MDM.val_path2_skip_validation": ["model.CGOncology_MDM.adm_hco_hierarchy", "model.CGOncology_MDM.mdm_best_affiliation_hist", "model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.mdm_customer_master_hcp", "model.CGOncology_MDM.std_dx_claims", "model.CGOncology_MDM.std_px_claims", "model.CGOncology_MDM.std_rx_claims", "model.CGOncology_MDM.stg_bc_patient_pool", "seed.CGOncology_MDM.account_type_business_input"], "test.CGOncology_MDM.val_cb_030_new_code_detection": ["model.CGOncology_MDM.std_dx_claims", "model.CGOncology_MDM.std_px_claims", "seed.CGOncology_MDM.seed_bc_dx_code_mapping", "seed.CGOncology_MDM.seed_bc_px_code_mapping"], "test.CGOncology_MDM.val_apt_data_validation": [], "seed.CGOncology_MDM.seed_new_payor_contacts": [], "seed.CGOncology_MDM.config_account_type_thresholds": [], "seed.CGOncology_MDM.seed_new_payor_upload": [], "seed.CGOncology_MDM.teams": [], "seed.CGOncology_MDM.config_name_aliases": [], "seed.CGOncology_MDM.seed_manual_hco_accounts": [], "seed.CGOncology_MDM.seed_firm_types": [], "seed.CGOncology_MDM.config_survivorship_hco": [], "seed.CGOncology_MDM.seed_bc_rx_ndc_mapping": [], "seed.CGOncology_MDM.zip_city_state_config": [], "seed.CGOncology_MDM.seed_units": [], "seed.CGOncology_MDM.config_fuzzy_match_thresholds": [], "seed.CGOncology_MDM.seed_bc_dx_code_mapping": [], "seed.CGOncology_MDM.seed_metric_list": [], "seed.CGOncology_MDM.config_address_abbreviations": [], "seed.CGOncology_MDM.config_mso_known_affiliations": [], "seed.CGOncology_MDM.seed_payer_types": [], "seed.CGOncology_MDM.config_ddd_sub_category": [], "seed.CGOncology_MDM.account_type_business_input": [], "seed.CGOncology_MDM.seed_bc_px_code_mapping": [], "seed.CGOncology_MDM.config_survivorship_hcp": [], "operation.CGOncology_MDM.CGOncology_MDM-on-run-start-0": [], "test.CGOncology_MDM.not_null_mdm_ref_market_definition_code_type.1ea347293e": ["model.CGOncology_MDM.mdm_ref_market_definition"], "test.CGOncology_MDM.accepted_values_mdm_ref_market_definition_code_type__DX__PX__RX__Sub_category.7430203439": ["model.CGOncology_MDM.mdm_ref_market_definition"], "test.CGOncology_MDM.not_null_mdm_ref_market_definition_code.d44466f5db": ["model.CGOncology_MDM.mdm_ref_market_definition"], "test.CGOncology_MDM.not_null_mdm_customer_master_hco_kmk_hco_id.872bd2a427": ["model.CGOncology_MDM.mdm_customer_master_hco"], "test.CGOncology_MDM.unique_mdm_customer_master_hco_kmk_hco_id.5a263fffb9": ["model.CGOncology_MDM.mdm_customer_master_hco"], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_mdm_customer_master_hco_kmk_hco_id___34_0_9_9_.c57ec6e0c3": ["model.CGOncology_MDM.mdm_customer_master_hco"], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_mdm_customer_master_hco_dh_id___0__dh_id_IS_NOT_NULL.1f6f480f1f": ["model.CGOncology_MDM.mdm_customer_master_hco"], "test.CGOncology_MDM.not_null_mdm_customer_master_hco_org_name.2edb57d8d4": ["model.CGOncology_MDM.mdm_customer_master_hco"], "test.CGOncology_MDM.key_coverage_mdm_customer_master_hco_kmk_hco_id__kmk_hco_id__SOURCE_CODE_DHC_OR_SOURCE_CODE_DDD_AND_DH_ID_IS_NOT_NULL___ref_mdm_customer_xref_hco_.cc390e7732": ["model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.mdm_customer_xref_hco"], "test.CGOncology_MDM.not_null_mdm_customer_master_hcp_kmk_hcp_id.9e02d8cee2": ["model.CGOncology_MDM.mdm_customer_master_hcp"], "test.CGOncology_MDM.unique_mdm_customer_master_hcp_kmk_hcp_id.bb0184f77e": ["model.CGOncology_MDM.mdm_customer_master_hcp"], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_mdm_customer_master_hcp_kmk_hcp_id___15_0_9_9_.a52d55a1ce": ["model.CGOncology_MDM.mdm_customer_master_hcp"], "test.CGOncology_MDM.not_null_mdm_customer_master_hcp_npi.08ade6922b": ["model.CGOncology_MDM.mdm_customer_master_hcp"], "test.CGOncology_MDM.unique_mdm_customer_master_hcp_npi.d95c718672": ["model.CGOncology_MDM.mdm_customer_master_hcp"], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_mdm_customer_master_hcp_npi___0_9_10_.7145d546b1": ["model.CGOncology_MDM.mdm_customer_master_hcp"], "test.CGOncology_MDM.not_null_mdm_customer_master_hcp_last_name.ea89caac8a": ["model.CGOncology_MDM.mdm_customer_master_hcp"], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_mdm_customer_master_hcp_primary_specialty_____primary_specialty_IS_NOT_NULL.63e68a0e35": ["model.CGOncology_MDM.mdm_customer_master_hcp"], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_mdm_customer_master_hcp_primary_specialty___And_Or_Of_The___primary_specialty_IS_NOT_NULL.431e6cdde2": ["model.CGOncology_MDM.mdm_customer_master_hcp"], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_mdm_customer_master_hcp_primary_specialty_____primary_specialty_IS_NOT_NULL.ebd4f1382a": ["model.CGOncology_MDM.mdm_customer_master_hcp"], "test.CGOncology_MDM.dbt_expectations_expect_column_value_lengths_to_be_between_mdm_customer_master_hcp_primary_specialty__100.0751b38539": ["model.CGOncology_MDM.mdm_customer_master_hcp"], "test.CGOncology_MDM.dbt_expectations_expect_column_value_lengths_to_be_between_mdm_customer_master_hcp_primary_specialty_group__100.542c204ac7": ["model.CGOncology_MDM.mdm_customer_master_hcp"], "test.CGOncology_MDM.key_coverage_mdm_customer_master_hcp_kmk_hcp_id__kmk_hcp_id__SOURCE_CODE_DHC___ref_mdm_customer_xref_hcp_.c421076b29": ["model.CGOncology_MDM.mdm_customer_master_hcp", "model.CGOncology_MDM.mdm_customer_xref_hcp"], "test.CGOncology_MDM.not_null_mdm_customer_xref_hco_kmk_hco_id.fa70a0d10c": ["model.CGOncology_MDM.mdm_customer_xref_hco"], "test.CGOncology_MDM.relationships_mdm_customer_xref_hco_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.bb9737f0e4": ["model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.mdm_customer_xref_hco"], "test.CGOncology_MDM.not_null_mdm_customer_xref_hco_source_code.767c39c483": ["model.CGOncology_MDM.mdm_customer_xref_hco"], "test.CGOncology_MDM.accepted_values_mdm_customer_xref_hco_source_code__DHC__DDD__MEDSCOUT__PRACTICE_LOCATION.55e13c3ae2": ["model.CGOncology_MDM.mdm_customer_xref_hco"], "test.CGOncology_MDM.not_null_mdm_customer_xref_hco_source_id.d0ee1617fe": ["model.CGOncology_MDM.mdm_customer_xref_hco"], "test.CGOncology_MDM.key_coverage_mdm_customer_xref_hco_source_id__dh_id__ref_std_dh_hco___SOURCE_CODE_DHC_.2474a26f9d": ["model.CGOncology_MDM.mdm_customer_xref_hco", "model.CGOncology_MDM.std_dh_hco"], "test.CGOncology_MDM.not_null_mdm_customer_xref_hcp_kmk_hcp_id.5ee8ca04b8": ["model.CGOncology_MDM.mdm_customer_xref_hcp"], "test.CGOncology_MDM.relationships_mdm_customer_xref_hcp_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_.fd7d7aed14": ["model.CGOncology_MDM.mdm_customer_master_hcp", "model.CGOncology_MDM.mdm_customer_xref_hcp"], "test.CGOncology_MDM.not_null_mdm_customer_xref_hcp_npi.3df694fd52": ["model.CGOncology_MDM.mdm_customer_xref_hcp"], "test.CGOncology_MDM.relationships_mdm_customer_xref_hcp_npi__npi__ref_mdm_customer_master_hcp_.af000d17f9": ["model.CGOncology_MDM.mdm_customer_master_hcp", "model.CGOncology_MDM.mdm_customer_xref_hcp"], "test.CGOncology_MDM.not_null_mdm_customer_xref_hcp_source_code.125eb81841": ["model.CGOncology_MDM.mdm_customer_xref_hcp"], "test.CGOncology_MDM.accepted_values_mdm_customer_xref_hcp_source_code__DHC__MEDSCOUT.48cc60fa51": ["model.CGOncology_MDM.mdm_customer_xref_hcp"], "test.CGOncology_MDM.key_coverage_mdm_customer_xref_hcp_source_id__npi__ref_std_dh_hcp___SOURCE_CODE_DHC_.1ea045b04f": ["model.CGOncology_MDM.mdm_customer_xref_hcp", "model.CGOncology_MDM.std_dh_hcp"], "test.CGOncology_MDM.not_null_mdm_best_affiliation_npi.09b0285e48": ["model.CGOncology_MDM.mdm_best_affiliation"], "test.CGOncology_MDM.unique_mdm_best_affiliation_npi.41d120735b": ["model.CGOncology_MDM.mdm_best_affiliation"], "test.CGOncology_MDM.not_null_mdm_best_affiliation_kmk_hcp_id.50709ac5e3": ["model.CGOncology_MDM.mdm_best_affiliation"], "test.CGOncology_MDM.relationships_mdm_best_affiliation_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_.14c07bfe64": ["model.CGOncology_MDM.mdm_best_affiliation", "model.CGOncology_MDM.mdm_customer_master_hcp"], "test.CGOncology_MDM.relationships_mdm_best_affiliation_best_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.94418604ac": ["model.CGOncology_MDM.mdm_best_affiliation", "model.CGOncology_MDM.mdm_customer_master_hco"], "test.CGOncology_MDM.not_null_mdm_best_affiliation_mapping_rule.9c21268898": ["model.CGOncology_MDM.mdm_best_affiliation"], "test.CGOncology_MDM.not_null_mdm_best_affiliation_hist_npi.dcaef99ecf": ["model.CGOncology_MDM.mdm_best_affiliation_hist"], "test.CGOncology_MDM.not_null_mdm_best_affiliation_hist_version_number.ec106bab60": ["model.CGOncology_MDM.mdm_best_affiliation_hist"], "test.CGOncology_MDM.not_null_mdm_best_affiliation_hist_is_current.7996664e31": ["model.CGOncology_MDM.mdm_best_affiliation_hist"], "test.CGOncology_MDM.accepted_values_mdm_best_affiliation_hist_is_current__Y__N.115e68cd06": ["model.CGOncology_MDM.mdm_best_affiliation_hist"], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_mdm_best_affiliation_hist_npi__version_number.b205a74dfb": ["model.CGOncology_MDM.mdm_best_affiliation_hist"], "test.CGOncology_MDM.not_null_mdm_customer_xref_hco_hist_kmk_hco_id.97be341d89": ["model.CGOncology_MDM.mdm_customer_xref_hco_hist"], "test.CGOncology_MDM.not_null_mdm_customer_xref_hco_hist_version_number.5a5057b6ac": ["model.CGOncology_MDM.mdm_customer_xref_hco_hist"], "test.CGOncology_MDM.accepted_values_mdm_customer_xref_hco_hist_is_current__Y__N.f0f38b0287": ["model.CGOncology_MDM.mdm_customer_xref_hco_hist"], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_mdm_customer_xref_hco_hist_kmk_hco_id__source_code__source_id__version_number.09dfa39014": ["model.CGOncology_MDM.mdm_customer_xref_hco_hist"], "test.CGOncology_MDM.not_null_mdm_customer_xref_hcp_hist_kmk_hcp_id.7ec0ca69e8": ["model.CGOncology_MDM.mdm_customer_xref_hcp_hist"], "test.CGOncology_MDM.not_null_mdm_customer_xref_hcp_hist_version_number.f4744eacf4": ["model.CGOncology_MDM.mdm_customer_xref_hcp_hist"], "test.CGOncology_MDM.accepted_values_mdm_customer_xref_hcp_hist_is_current__Y__N.1da3a07768": ["model.CGOncology_MDM.mdm_customer_xref_hcp_hist"], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_mdm_customer_xref_hcp_hist_kmk_hcp_id__source_code__version_number.257291777b": ["model.CGOncology_MDM.mdm_customer_xref_hcp_hist"], "test.CGOncology_MDM.not_null_match_ddd_dhc_DDD_OUTLET_ID.9431d55a7f": ["model.CGOncology_MDM.match_ddd_dhc"], "test.CGOncology_MDM.unique_match_ddd_dhc_DDD_OUTLET_ID.fcadb410cf": ["model.CGOncology_MDM.match_ddd_dhc"], "test.CGOncology_MDM.not_null_match_ddd_dhc_DDD_OUTLET_NAME.cf75f8fcd7": ["model.CGOncology_MDM.match_ddd_dhc"], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_be_between_match_ddd_dhc_ADDRESS_MATCH_SCORE__100__0.59ba604c8c": ["model.CGOncology_MDM.match_ddd_dhc"], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_be_between_match_ddd_dhc_NAME_MATCH_SCORE__100__0.ba2d1026eb": ["model.CGOncology_MDM.match_ddd_dhc"], "test.CGOncology_MDM.accepted_values_match_ddd_dhc_MATCH_BUCKET__0__1__2__3__4.a27fe795cf": ["model.CGOncology_MDM.match_ddd_dhc"], "test.CGOncology_MDM.accepted_values_match_ddd_dhc_MATCH_STEP__0__1__2__3__4.029afef2fa": ["model.CGOncology_MDM.match_ddd_dhc"], "test.CGOncology_MDM.accepted_values_match_ddd_dhc_DHC_MATCH_SOURCE__Practice_Location__HQ_Location__City_State_Fallback__Medscout_Bridge__DH_Matching_Return__Legacy_History__XREF_History.e46667f474": ["model.CGOncology_MDM.match_ddd_dhc"], "test.CGOncology_MDM.not_null_match_ddd_dhc_MATCH_STATUS.50e40ba959": ["model.CGOncology_MDM.match_ddd_dhc"], "test.CGOncology_MDM.accepted_values_match_ddd_dhc_MATCH_STATUS__MATCHED__UNMATCHED.623af1049a": ["model.CGOncology_MDM.match_ddd_dhc"], "test.CGOncology_MDM.accepted_values_match_ddd_dhc_CONFIDENCE_LEVEL__HIGH__MEDIUM__STEWARD__HISTORICAL.690cc051c1": ["model.CGOncology_MDM.match_ddd_dhc"], "test.CGOncology_MDM.not_null_match_ddd_dhc_IS_HISTORICAL_MATCH.d9bf2310fd": ["model.CGOncology_MDM.match_ddd_dhc"], "test.CGOncology_MDM.not_null_match_ddd_dhc_IS_DELTA.14815dedb4": ["model.CGOncology_MDM.match_ddd_dhc"], "test.CGOncology_MDM.not_null_match_medscout_dhc_hcp_MEDSCOUT_ID.f3c6209b8f": ["model.CGOncology_MDM.match_medscout_dhc_hcp"], "test.CGOncology_MDM.unique_match_medscout_dhc_hcp_MEDSCOUT_ID.a4ddb83f70": ["model.CGOncology_MDM.match_medscout_dhc_hcp"], "test.CGOncology_MDM.not_null_match_medscout_dhc_hcp_NPI.1d48ccd718": ["model.CGOncology_MDM.match_medscout_dhc_hcp"], "test.CGOncology_MDM.accepted_values_match_medscout_dhc_hcp_MATCH_TYPE__NPI_EXACT.b0e6786039": ["model.CGOncology_MDM.match_medscout_dhc_hcp"], "test.CGOncology_MDM.not_null_match_medscout_dhc_hcp_MATCH_STATUS.58d977e8e9": ["model.CGOncology_MDM.match_medscout_dhc_hcp"], "test.CGOncology_MDM.accepted_values_match_medscout_dhc_hcp_MATCH_STATUS__MATCHED__UNMATCHED.b9609b5d31": ["model.CGOncology_MDM.match_medscout_dhc_hcp"], "test.CGOncology_MDM.not_null_match_medscout_dhc_hcp_IS_DELTA.62a95babd1": ["model.CGOncology_MDM.match_medscout_dhc_hcp"], "test.CGOncology_MDM.not_null_match_medscout_dhc_hcp_IS_HISTORICAL_MATCH.e1fe9b7c05": ["model.CGOncology_MDM.match_medscout_dhc_hcp"], "test.CGOncology_MDM.not_null_match_medscout_dhc_hcp_MATCH_DATE.132412ad64": ["model.CGOncology_MDM.match_medscout_dhc_hcp"], "test.CGOncology_MDM.not_null_stg_bc_patient_pool_PATIENT_ID.d047ac8e90": ["model.CGOncology_MDM.stg_bc_patient_pool"], "test.CGOncology_MDM.unique_stg_bc_patient_pool_PATIENT_ID.38ad9d6549": ["model.CGOncology_MDM.stg_bc_patient_pool"], "test.CGOncology_MDM.not_null_stg_bc_patient_pool_IDENTIFIED_VIA_DX.259ef11f32": ["model.CGOncology_MDM.stg_bc_patient_pool"], "test.CGOncology_MDM.accepted_values_stg_bc_patient_pool_IDENTIFIED_VIA_DX__Y__N.1ee43ae670": ["model.CGOncology_MDM.stg_bc_patient_pool"], "test.CGOncology_MDM.not_null_stg_bc_patient_pool_IDENTIFIED_VIA_PX.3936f0c36d": ["model.CGOncology_MDM.stg_bc_patient_pool"], "test.CGOncology_MDM.accepted_values_stg_bc_patient_pool_IDENTIFIED_VIA_PX__Y__N.70b904dc00": ["model.CGOncology_MDM.stg_bc_patient_pool"], "test.CGOncology_MDM.not_null_stg_bc_patient_pool_IDENTIFIED_VIA_RX.a4f6073e8a": ["model.CGOncology_MDM.stg_bc_patient_pool"], "test.CGOncology_MDM.accepted_values_stg_bc_patient_pool_IDENTIFIED_VIA_RX__Y__N.c11d1877c2": ["model.CGOncology_MDM.stg_bc_patient_pool"], "test.CGOncology_MDM.not_null_stg_bc_patient_pool_IDENTIFICATION_PATHWAY_COUNT.3ed02c7eac": ["model.CGOncology_MDM.stg_bc_patient_pool"], "test.CGOncology_MDM.accepted_values_stg_bc_patient_pool_IDENTIFICATION_PATHWAY_COUNT__1__2__3.59434ca4f4": ["model.CGOncology_MDM.stg_bc_patient_pool"], "test.CGOncology_MDM.not_null_stg_bc_patient_pool_EARLIEST_BC_EVENT_DATE.1d286cde6b": ["model.CGOncology_MDM.stg_bc_patient_pool"], "test.CGOncology_MDM.not_null_stg_bc_patient_pool_LATEST_BC_EVENT_DATE.f0a01e8ad2": ["model.CGOncology_MDM.stg_bc_patient_pool"], "test.CGOncology_MDM.not_null_stg_bc_patient_pool_TOTAL_BC_CLAIM_COUNT.256c214c05": ["model.CGOncology_MDM.stg_bc_patient_pool"], "test.CGOncology_MDM.accepted_values_stg_bc_patient_pool_PATIENT_GENDER__M__F__U__X.2f60f286c0": ["model.CGOncology_MDM.stg_bc_patient_pool"], "test.CGOncology_MDM.not_null_stg_hcp_hco_claims_PATIENT_ID.9a0bcf8302": ["model.CGOncology_MDM.stg_hcp_hco_claims"], "test.CGOncology_MDM.relationships_stg_hcp_hco_claims_PATIENT_ID__PATIENT_ID__ref_stg_bc_patient_pool_.8c28be3c10": ["model.CGOncology_MDM.stg_bc_patient_pool", "model.CGOncology_MDM.stg_hcp_hco_claims"], "test.CGOncology_MDM.not_null_stg_hcp_hco_claims_SERVICE_DATE.3a3afd17c5": ["model.CGOncology_MDM.stg_hcp_hco_claims"], "test.CGOncology_MDM.not_null_stg_hcp_hco_claims_CLAIM_TYPE.2672d69539": ["model.CGOncology_MDM.stg_hcp_hco_claims"], "test.CGOncology_MDM.accepted_values_stg_hcp_hco_claims_CLAIM_TYPE__DX__PX__RX.183fef863b": ["model.CGOncology_MDM.stg_hcp_hco_claims"], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_NPI.57a8a3ff0f": ["model.CGOncology_MDM.stg_hcp_bc_metrics"], "test.CGOncology_MDM.unique_stg_hcp_bc_metrics_NPI.092de56925": ["model.CGOncology_MDM.stg_hcp_bc_metrics"], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_BC_PATIENT_COUNT.963cf7cf30": ["model.CGOncology_MDM.stg_hcp_bc_metrics"], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_DX_PATIENT_COUNT.914c0df3f0": ["model.CGOncology_MDM.stg_hcp_bc_metrics"], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_RX_PATIENT_COUNT.592d04ea6e": ["model.CGOncology_MDM.stg_hcp_bc_metrics"], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_TURBT_PATIENTS.70efb088e0": ["model.CGOncology_MDM.stg_hcp_bc_metrics"], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_BCG_PATIENTS.8b51cdd62e": ["model.CGOncology_MDM.stg_hcp_bc_metrics"], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_ADSTILADRIN_PATIENTS.c85b423b99": ["model.CGOncology_MDM.stg_hcp_bc_metrics"], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_ANKTIVA_PATIENTS.9ce93db81c": ["model.CGOncology_MDM.stg_hcp_bc_metrics"], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_KEYTRUDA_PATIENTS.11c0558b26": ["model.CGOncology_MDM.stg_hcp_bc_metrics"], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_CYSTOSCOPY_PATIENTS.26524a772d": ["model.CGOncology_MDM.stg_hcp_bc_metrics"], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_RX_BCG_PATIENTS.1b19cc04a6": ["model.CGOncology_MDM.stg_hcp_bc_metrics"], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_RX_ADSTILADRIN_PATIENTS.83317531f5": ["model.CGOncology_MDM.stg_hcp_bc_metrics"], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_RX_ANKTIVA_PATIENTS.6d08e257a9": ["model.CGOncology_MDM.stg_hcp_bc_metrics"], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_IS_UROLOGIST.77ceba9871": ["model.CGOncology_MDM.stg_hcp_bc_metrics"], "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_IS_UROLOGIST__Y__N.62a606d1c8": ["model.CGOncology_MDM.stg_hcp_bc_metrics"], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_IS_TARGET.541cb9e827": ["model.CGOncology_MDM.stg_hcp_bc_metrics"], "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_IS_TARGET__Y__N.8e09f806ba": ["model.CGOncology_MDM.stg_hcp_bc_metrics"], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_HAS_ACTIVITY.360aaae1ed": ["model.CGOncology_MDM.stg_hcp_bc_metrics"], "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_HAS_ACTIVITY__Y__N.2b140a4257": ["model.CGOncology_MDM.stg_hcp_bc_metrics"], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_HAS_BC_TREATMENT_CLAIMS.ad9b758830": ["model.CGOncology_MDM.stg_hcp_bc_metrics"], "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_HAS_BC_TREATMENT_CLAIMS__Y__N.2df31db436": ["model.CGOncology_MDM.stg_hcp_bc_metrics"], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_HAS_BC_PROCEDURE_CLAIMS.54530c687b": ["model.CGOncology_MDM.stg_hcp_bc_metrics"], "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_HAS_BC_PROCEDURE_CLAIMS__Y__N.192be9057e": ["model.CGOncology_MDM.stg_hcp_bc_metrics"], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_HAS_BC_RX_CLAIMS.c66cedcecc": ["model.CGOncology_MDM.stg_hcp_bc_metrics"], "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_HAS_BC_RX_CLAIMS__Y__N.b26915858b": ["model.CGOncology_MDM.stg_hcp_bc_metrics"], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_BC_BACKBONE_FLAG.a17b979898": ["model.CGOncology_MDM.stg_hcp_bc_metrics"], "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_BC_BACKBONE_FLAG__Y__N.ba1821dd61": ["model.CGOncology_MDM.stg_hcp_bc_metrics"], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_HCP_CATEGORY.b39969faec": ["model.CGOncology_MDM.stg_hcp_bc_metrics"], "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_HCP_CATEGORY__Urologist__BC_Treatment_Patient_Pool__BC_RX_Prescriber__Target_HCP__Activity_HCP__Total_BC_Patient_Pool.f12bf82f00": ["model.CGOncology_MDM.stg_hcp_bc_metrics"], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_BC_VOLUME_TIER.b6e432164c": ["model.CGOncology_MDM.stg_hcp_bc_metrics"], "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_BC_VOLUME_TIER__HIGH__MEDIUM__LOW__NONE.610aafdce1": ["model.CGOncology_MDM.stg_hcp_bc_metrics"], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_DATA_DATE.cdf6c17b7c": ["model.CGOncology_MDM.stg_hcp_bc_metrics"], "test.CGOncology_MDM.not_null_hcp_decile_NPI.e208cb8767": ["model.CGOncology_MDM.hcp_decile"], "test.CGOncology_MDM.unique_hcp_decile_NPI.9eca6ac110": ["model.CGOncology_MDM.hcp_decile"], "test.CGOncology_MDM.not_null_hcp_decile_TIME_PERIOD.f5eac4fc6a": ["model.CGOncology_MDM.hcp_decile"], "test.CGOncology_MDM.not_null_hcp_decile_STANDARDIZED_TOTAL_PATIENTS.ee7998a705": ["model.CGOncology_MDM.hcp_decile"], "test.CGOncology_MDM.not_null_hcp_decile_STANDARDIZED_BCG_CLAIMS.dd05c0a210": ["model.CGOncology_MDM.hcp_decile"], "test.CGOncology_MDM.not_null_hcp_decile_STANDARDIZED_TURBT_CLAIMS.80c23eabcf": ["model.CGOncology_MDM.hcp_decile"], "test.CGOncology_MDM.not_null_hcp_decile_COMPOSITE_SCORE.1570178381": ["model.CGOncology_MDM.hcp_decile"], "test.CGOncology_MDM.not_null_hcp_decile_DECILE.4053a88425": ["model.CGOncology_MDM.hcp_decile"], "test.CGOncology_MDM.accepted_values_hcp_decile_DECILE__1__2__3__4__5__6__7__8__9__10.113157d98c": ["model.CGOncology_MDM.hcp_decile"], "test.CGOncology_MDM.not_null_stg_sfe_targets_entity_id.c065cd9d0a": ["model.CGOncology_MDM.stg_sfe_targets"], "test.CGOncology_MDM.not_null_stg_sfe_targets_entity_type.8082c3d2af": ["model.CGOncology_MDM.stg_sfe_targets"], "test.CGOncology_MDM.accepted_values_stg_sfe_targets_entity_type__HCO__HCP.e4003662ec": ["model.CGOncology_MDM.stg_sfe_targets"], "test.CGOncology_MDM.not_null_stg_sfe_targets_target_type.6d0a8711b5": ["model.CGOncology_MDM.stg_sfe_targets"], "test.CGOncology_MDM.accepted_values_stg_sfe_targets_target_type__KAM_NETWORK__KAM_CHILD__HSD__HCP_TARGET__MSL_TARGET.19afec1207": ["model.CGOncology_MDM.stg_sfe_targets"], "test.CGOncology_MDM.not_null_stg_sfe_targets_target_flag.02d4b9155f": ["model.CGOncology_MDM.stg_sfe_targets"], "test.CGOncology_MDM.not_null_adm_sfe_geographies_geo_code.3bf1753026": ["model.CGOncology_MDM.adm_sfe_geographies"], "test.CGOncology_MDM.unique_adm_sfe_geographies_geo_code.2eea9dd057": ["model.CGOncology_MDM.adm_sfe_geographies"], "test.CGOncology_MDM.not_null_adm_sfe_geographies_geo_name.4bc8946e84": ["model.CGOncology_MDM.adm_sfe_geographies"], "test.CGOncology_MDM.not_null_adm_sfe_geographies_geo_type.ac40d5904e": ["model.CGOncology_MDM.adm_sfe_geographies"], "test.CGOncology_MDM.accepted_values_adm_sfe_geographies_geo_type__TERRITORY__REGION__NATION.b2998d82da": ["model.CGOncology_MDM.adm_sfe_geographies"], "test.CGOncology_MDM.accepted_values_adm_sfe_geographies_team__KAM__HSD__MSL__PAYOR.d41f96ee2a": ["model.CGOncology_MDM.adm_sfe_geographies"], "test.CGOncology_MDM.not_null_adm_sfe_zip_alignment_zip_code.650f602114": ["model.CGOncology_MDM.adm_sfe_zip_alignment"], "test.CGOncology_MDM.unique_adm_sfe_zip_alignment_zip_code.d5a56b576f": ["model.CGOncology_MDM.adm_sfe_zip_alignment"], "test.CGOncology_MDM.not_null_adm_sfe_hco_targets_kmk_hco_id.5878b9508f": ["model.CGOncology_MDM.adm_sfe_hco_targets"], "test.CGOncology_MDM.unique_adm_sfe_hco_targets_kmk_hco_id.de0c13379d": ["model.CGOncology_MDM.adm_sfe_hco_targets"], "test.CGOncology_MDM.relationships_adm_sfe_hco_targets_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.07e79ca121": ["model.CGOncology_MDM.adm_sfe_hco_targets", "model.CGOncology_MDM.mdm_customer_master_hco"], "test.CGOncology_MDM.accepted_values_adm_sfe_hco_targets_kam_network_target_flag__Y__N.5d3ad1f11a": ["model.CGOncology_MDM.adm_sfe_hco_targets"], "test.CGOncology_MDM.accepted_values_adm_sfe_hco_targets_kam_child_target_flag__Y__N.fafd69b0be": ["model.CGOncology_MDM.adm_sfe_hco_targets"], "test.CGOncology_MDM.accepted_values_adm_sfe_hco_targets_hsd_target_flag__Y__N.276ace2e5a": ["model.CGOncology_MDM.adm_sfe_hco_targets"], "test.CGOncology_MDM.accepted_values_adm_sfe_hco_targets_msl_target_flag__Y__N.0e207c3aaa": ["model.CGOncology_MDM.adm_sfe_hco_targets"], "test.CGOncology_MDM.not_null_adm_sfe_hcp_targets_kmk_hcp_id.343a5058c2": ["model.CGOncology_MDM.adm_sfe_hcp_targets"], "test.CGOncology_MDM.unique_adm_sfe_hcp_targets_kmk_hcp_id.b80969407d": ["model.CGOncology_MDM.adm_sfe_hcp_targets"], "test.CGOncology_MDM.relationships_adm_sfe_hcp_targets_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_.4ca0295145": ["model.CGOncology_MDM.adm_sfe_hcp_targets", "model.CGOncology_MDM.mdm_customer_master_hcp"], "test.CGOncology_MDM.accepted_values_adm_sfe_hcp_targets_kam_target_flag__Y__N.b025c684ba": ["model.CGOncology_MDM.adm_sfe_hcp_targets"], "test.CGOncology_MDM.accepted_values_adm_sfe_hcp_targets_kam_decile__1__2__3__4__5__6__7__8__9__10.acc477934d": ["model.CGOncology_MDM.adm_sfe_hcp_targets"], "test.CGOncology_MDM.not_null_std_dh_hco_dh_id.155e4b5801": ["model.CGOncology_MDM.std_dh_hco"], "test.CGOncology_MDM.unique_std_dh_hco_dh_id.c89c925785": ["model.CGOncology_MDM.std_dh_hco"], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_std_dh_hco_dh_id___0.c014a1da7b": ["model.CGOncology_MDM.std_dh_hco"], "test.CGOncology_MDM.dbt_expectations_expect_column_value_lengths_to_be_between_std_dh_hco_normalized_org_name__2.5f688cf1f4": ["model.CGOncology_MDM.std_dh_hco"], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_dh_hco_hq_address_line_1___a_z___hq_address_line_1_IS_NOT_NULL.027089ef29": ["model.CGOncology_MDM.std_dh_hco"], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_std_dh_hco_hq_address_line_1_____hq_address_line_1_IS_NOT_NULL.bb2ad3576e": ["model.CGOncology_MDM.std_dh_hco"], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_dh_hco_hq_city___a_z___hq_city_IS_NOT_NULL.be52dcc2b8": ["model.CGOncology_MDM.std_dh_hco"], "test.CGOncology_MDM.not_null_std_dh_hco_source_hash.c5c2443af6": ["model.CGOncology_MDM.std_dh_hco"], "test.CGOncology_MDM.dbt_expectations_expect_column_value_lengths_to_be_between_std_dh_hco_source_hash__64__64.524a96ddc2": ["model.CGOncology_MDM.std_dh_hco"], "test.CGOncology_MDM.accepted_values_std_dh_hco_hq_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY__DC__PR__VI__GU__AS__MP.22828f4652": ["model.CGOncology_MDM.std_dh_hco"], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_dh_hco_hq_zip_code___0_9_5___hq_zip_code_IS_NOT_NULL.53831fcfe7": ["model.CGOncology_MDM.std_dh_hco"], "test.CGOncology_MDM.row_count_match_std_dh_hco_source_raw_dh_PRELAND_DH_ALL_COMPANIES_OVERVIEW_.8f7f1522b5": ["model.CGOncology_MDM.std_dh_hco", "source.CGOncology_MDM.raw_dh.PRELAND_DH_ALL_COMPANIES_OVERVIEW"], "test.CGOncology_MDM.dbt_expectations_expect_table_row_count_to_be_between_std_dh_hco_300000.3c0c96a031": ["model.CGOncology_MDM.std_dh_hco"], "test.CGOncology_MDM.not_null_std_dh_hcp_npi.f78527bf39": ["model.CGOncology_MDM.std_dh_hcp"], "test.CGOncology_MDM.unique_std_dh_hcp_npi.3d97c53efa": ["model.CGOncology_MDM.std_dh_hcp"], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_dh_hcp_npi___0_9_10_.f3ce611aa7": ["model.CGOncology_MDM.std_dh_hcp"], "test.CGOncology_MDM.not_null_std_dh_hcp_last_name.4a4b23e2b8": ["model.CGOncology_MDM.std_dh_hcp"], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_std_dh_hcp_last_name_____last_name_IS_NOT_NULL.1257101c2c": ["model.CGOncology_MDM.std_dh_hcp"], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_std_dh_hcp_first_name_____first_name_IS_NOT_NULL.d2932f7c96": ["model.CGOncology_MDM.std_dh_hcp"], "test.CGOncology_MDM.accepted_values_std_dh_hcp_practice_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY__DC__PR__VI__GU__AS__MP__NS__PH.cc7ab9603a": ["model.CGOncology_MDM.std_dh_hcp"], "test.CGOncology_MDM.row_count_match_std_dh_hcp_NPI_IS_NOT_NULL__source_raw_dh_PRELAND_DH_PHYSICIANS_OVERVIEW_.396fdde72a": ["model.CGOncology_MDM.std_dh_hcp", "source.CGOncology_MDM.raw_dh.PRELAND_DH_PHYSICIANS_OVERVIEW"], "test.CGOncology_MDM.not_null_std_dh_practice_location_practice_location_id.87970307c4": ["model.CGOncology_MDM.std_dh_practice_location"], "test.CGOncology_MDM.unique_std_dh_practice_location_practice_location_id.d81b4d0eeb": ["model.CGOncology_MDM.std_dh_practice_location"], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_dh_practice_location_address_line_1___a_z___address_line_1_IS_NOT_NULL.7604558e84": ["model.CGOncology_MDM.std_dh_practice_location"], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_std_dh_practice_location_address_line_1_____address_line_1_IS_NOT_NULL.d38c4fa34d": ["model.CGOncology_MDM.std_dh_practice_location"], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_dh_practice_location_zip_code___0_9_5___zip_code_IS_NOT_NULL.08e160408e": ["model.CGOncology_MDM.std_dh_practice_location"], "test.CGOncology_MDM.accepted_values_std_dh_practice_location_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY__DC__PR__VI__GU__AS__MP.4b60111d92": ["model.CGOncology_MDM.std_dh_practice_location"], "test.CGOncology_MDM.not_null_std_dh_practice_location_unique_combined_key.c6f3a69f42": ["model.CGOncology_MDM.std_dh_practice_location"], "test.CGOncology_MDM.row_count_match_std_dh_practice_location_PRACTICE_LOCATION_ID_IS_NOT_NULL__source_raw_dh_PRELAND_DH_PHYSICIAN_GROUP_PRACTICE_LOCATION_.176238d91c": ["model.CGOncology_MDM.std_dh_practice_location", "source.CGOncology_MDM.raw_dh.PRELAND_DH_PHYSICIAN_GROUP_PRACTICE_LOCATION"], "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_npi.980d3a3d64": ["model.CGOncology_MDM.std_dh_hcp_hco_affiliation"], "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_affiliated_dh_id.d792350727": ["model.CGOncology_MDM.std_dh_hcp_hco_affiliation"], "test.CGOncology_MDM.accepted_values_std_dh_hcp_hco_affiliation_affiliation_type__CURRENT__HISTORICAL.c5017b3e1e": ["model.CGOncology_MDM.std_dh_hcp_hco_affiliation"], "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_is_current.55af4662bf": ["model.CGOncology_MDM.std_dh_hcp_hco_affiliation"], "test.CGOncology_MDM.accepted_values_std_dh_hcp_hco_affiliation_is_current__True__False.133669a192": ["model.CGOncology_MDM.std_dh_hcp_hco_affiliation"], "test.CGOncology_MDM.row_count_match_std_dh_hcp_hco_affiliation_NPI_IS_NOT_NULL_AND_AFFILIATED_ID_IS_NOT_NULL_AND_TRIM_CAST_AFFILIATED_ID_AS_VARCHAR_50___source_raw_dh_PRELAND_DH_PHYSICIANS_FACILITY_AFFILIATION_.b965d97151": ["model.CGOncology_MDM.std_dh_hcp_hco_affiliation", "source.CGOncology_MDM.raw_dh.PRELAND_DH_PHYSICIANS_FACILITY_AFFILIATION"], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_hcp_hco_affiliation_npi__affiliated_dh_id.59c0275aa4": ["model.CGOncology_MDM.std_dh_hcp_hco_affiliation"], "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_dh_id.c15863164f": ["model.CGOncology_MDM.std_dh_facility_to_facility_affiliation"], "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_affiliated_id.41b2bd78b8": ["model.CGOncology_MDM.std_dh_facility_to_facility_affiliation"], "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_source_hash.0bd14f03fe": ["model.CGOncology_MDM.std_dh_facility_to_facility_affiliation"], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_facility_to_facility_affiliation_dh_id__affiliated_id.8ff632a963": ["model.CGOncology_MDM.std_dh_facility_to_facility_affiliation"], "test.CGOncology_MDM.not_null_std_ddd_hco_ddd_outlet_id.1b0484230f": ["model.CGOncology_MDM.std_ddd_hco"], "test.CGOncology_MDM.unique_std_ddd_hco_ddd_outlet_id.c70c0abdc6": ["model.CGOncology_MDM.std_ddd_hco"], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_ddd_hco_ddd_outlet_name___a_z___ddd_outlet_name_IS_NOT_NULL.35cba45a91": ["model.CGOncology_MDM.std_ddd_hco"], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_ddd_hco_zip_code___0_9_5___zip_code_IS_NOT_NULL.b2c4f2e2df": ["model.CGOncology_MDM.std_ddd_hco"], "test.CGOncology_MDM.accepted_values_std_ddd_hco_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY__DC__PR__VI__GU__AS__MP.1e74911fad": ["model.CGOncology_MDM.std_ddd_hco"], "test.CGOncology_MDM.not_null_std_ddd_hco_class_of_trade.966b717e30": ["model.CGOncology_MDM.std_ddd_hco"], "test.CGOncology_MDM.accepted_values_std_ddd_hco_class_of_trade__CLINICS__HOSPITALS__CHAIN__INDEPENDENT__NURSING_HOME__HEALTH_CARE_PLAN__MAIL_SERVICE__MISCELLANEOUS__FOODSTORE__MASS_MERCHANDISER__N_A__UNKNOWN.f93e3e0083": ["model.CGOncology_MDM.std_ddd_hco"], "test.CGOncology_MDM.not_null_std_ddd_hco_is_zip_excluded.c6559e9806": ["model.CGOncology_MDM.std_ddd_hco"], "test.CGOncology_MDM.accepted_values_std_ddd_hco_is_zip_excluded__True__False.39c820062c": ["model.CGOncology_MDM.std_ddd_hco"], "test.CGOncology_MDM.not_null_std_ddd_hco_is_supply_chain_excluded.0e5299adc6": ["model.CGOncology_MDM.std_ddd_hco"], "test.CGOncology_MDM.accepted_values_std_ddd_hco_is_supply_chain_excluded__True__False.a885c0891c": ["model.CGOncology_MDM.std_ddd_hco"], "test.CGOncology_MDM.not_null_std_ddd_sales_ddd_outlet_id.d18206dc26": ["model.CGOncology_MDM.std_ddd_sales"], "test.CGOncology_MDM.not_null_std_ddd_sales_product_group_id.28e5d2f6ee": ["model.CGOncology_MDM.std_ddd_sales"], "test.CGOncology_MDM.accepted_values_std_ddd_sales_product_name__ADSTILADRIN__ANKTIVA__TICE_BCG__INLEXZO__OTHER.bd0919193d": ["model.CGOncology_MDM.std_ddd_sales"], "test.CGOncology_MDM.row_count_match_std_ddd_sales_DDD_OUTLET_NUMBER_IS_NOT_NULL_AND_PRODUCT_GROUP_ID_IS_NOT_NULL__source_raw_ddd_PRELAND_DDD_SALES_.e723d1ef6c": ["model.CGOncology_MDM.std_ddd_sales", "source.CGOncology_MDM.raw_ddd.PRELAND_DDD_SALES"], "test.CGOncology_MDM.not_null_std_medscout_hco_medscout_id.b291b23043": ["model.CGOncology_MDM.std_medscout_hco"], "test.CGOncology_MDM.unique_std_medscout_hco_medscout_id.a77c97f5fa": ["model.CGOncology_MDM.std_medscout_hco"], "test.CGOncology_MDM.not_null_std_medscout_hco_npi.f5cc69b5b3": ["model.CGOncology_MDM.std_medscout_hco"], "test.CGOncology_MDM.row_count_match_std_medscout_hco_NPI_IS_NOT_NULL__source_raw_medscout_PRELAND_MEDSCOUT_HCO_DATA_.bef7505a83": ["model.CGOncology_MDM.std_medscout_hco", "source.CGOncology_MDM.raw_medscout.PRELAND_MEDSCOUT_HCO_DATA"], "test.CGOncology_MDM.not_null_std_medscout_hcp_medscout_id.24a1ca994e": ["model.CGOncology_MDM.std_medscout_hcp"], "test.CGOncology_MDM.unique_std_medscout_hcp_medscout_id.48cf6c0773": ["model.CGOncology_MDM.std_medscout_hcp"], "test.CGOncology_MDM.not_null_std_medscout_hcp_npi.77f3adaf1e": ["model.CGOncology_MDM.std_medscout_hcp"], "test.CGOncology_MDM.not_null_std_medscout_hcp_last_name.32a63aaea7": ["model.CGOncology_MDM.std_medscout_hcp"], "test.CGOncology_MDM.row_count_match_std_medscout_hcp_NPI_IS_NOT_NULL__source_raw_medscout_PRELAND_MEDSCOUT_HCP_DATA_.c13864403f": ["model.CGOncology_MDM.std_medscout_hcp", "source.CGOncology_MDM.raw_medscout.PRELAND_MEDSCOUT_HCP_DATA"], "test.CGOncology_MDM.not_null_std_dx_claims_MX_CLAIM_ID.2533d41622": ["model.CGOncology_MDM.std_dx_claims"], "test.CGOncology_MDM.not_null_std_dx_claims_PATIENT_ID.f957d7d8f1": ["model.CGOncology_MDM.std_dx_claims"], "test.CGOncology_MDM.not_null_std_dx_claims_SERVICE_DATE.9235ca5535": ["model.CGOncology_MDM.std_dx_claims"], "test.CGOncology_MDM.not_null_std_dx_claims_DIAGNOSIS_CODE.eb269d8bef": ["model.CGOncology_MDM.std_dx_claims"], "test.CGOncology_MDM.accepted_values_std_dx_claims_TREATMENT_CATEGORY__BC_DIAGNOSIS.fc5d7f855e": ["model.CGOncology_MDM.std_dx_claims"], "test.CGOncology_MDM.accepted_values_std_dx_claims_PATIENT_GENDER__M__F__U__X.15a4bb0c64": ["model.CGOncology_MDM.std_dx_claims"], "test.CGOncology_MDM.not_null_std_px_claims_PX_CLAIM_ID.ee2882f522": ["model.CGOncology_MDM.std_px_claims"], "test.CGOncology_MDM.not_null_std_px_claims_PATIENT_ID.bee2b9e04e": ["model.CGOncology_MDM.std_px_claims"], "test.CGOncology_MDM.not_null_std_px_claims_SERVICE_DATE.1002e03153": ["model.CGOncology_MDM.std_px_claims"], "test.CGOncology_MDM.accepted_values_std_px_claims_PROCEDURE_CODE_TYPE__CPTHCPCS__ICD10PROC.5ab255ec5c": ["model.CGOncology_MDM.std_px_claims"], "test.CGOncology_MDM.accepted_values_std_px_claims_TREATMENT_CATEGORY__TURBT__TICE_BCG__ADSTILADRIN__ANKTIVA__CYSTOSCOPY__KEYTRUDA__OTHER_PROCEDURES.49a71a7de5": ["model.CGOncology_MDM.std_px_claims"], "test.CGOncology_MDM.accepted_values_std_px_claims_PATIENT_GENDER__M__F__U__X.8c1d91c8d7": ["model.CGOncology_MDM.std_px_claims"], "test.CGOncology_MDM.not_null_std_rx_claims_RX_CLAIM_ID.bf79ee906e": ["model.CGOncology_MDM.std_rx_claims"], "test.CGOncology_MDM.not_null_std_rx_claims_PATIENT_ID.465afae066": ["model.CGOncology_MDM.std_rx_claims"], "test.CGOncology_MDM.not_null_std_rx_claims_FILL_DATE.70a2e61aad": ["model.CGOncology_MDM.std_rx_claims"], "test.CGOncology_MDM.not_null_std_rx_claims_NDC11.1bfec2ed95": ["model.CGOncology_MDM.std_rx_claims"], "test.CGOncology_MDM.accepted_values_std_rx_claims_TREATMENT_CATEGORY__TICE_BCG__ADSTILADRIN__ANKTIVA__OTHER_PROCEDURES.236093b5b7": ["model.CGOncology_MDM.std_rx_claims"], "test.CGOncology_MDM.accepted_values_std_rx_claims_PATIENT_GENDER__M__F__U__X.0e6fac2fd6": ["model.CGOncology_MDM.std_rx_claims"], "test.CGOncology_MDM.not_null_std_dx_bc_patients_PATIENT_ID.5f1553fb03": ["model.CGOncology_MDM.std_dx_bc_patients"], "test.CGOncology_MDM.unique_std_dx_bc_patients_PATIENT_ID.2b164dce90": ["model.CGOncology_MDM.std_dx_bc_patients"], "test.CGOncology_MDM.not_null_std_dx_bc_patients_EARLIEST_DX_DATE.9511ca689b": ["model.CGOncology_MDM.std_dx_bc_patients"], "test.CGOncology_MDM.accepted_values_std_dx_bc_patients_IDENTIFICATION_SOURCE__DX.d52ce05901": ["model.CGOncology_MDM.std_dx_bc_patients"], "test.CGOncology_MDM.not_null_std_px_bc_patients_PATIENT_ID.58b2a57a43": ["model.CGOncology_MDM.std_px_bc_patients"], "test.CGOncology_MDM.unique_std_px_bc_patients_PATIENT_ID.e2e20292bd": ["model.CGOncology_MDM.std_px_bc_patients"], "test.CGOncology_MDM.not_null_std_px_bc_patients_EARLIEST_PX_DATE.afa0f2a8ce": ["model.CGOncology_MDM.std_px_bc_patients"], "test.CGOncology_MDM.accepted_values_std_px_bc_patients_IDENTIFICATION_SOURCE__PX.52f2870006": ["model.CGOncology_MDM.std_px_bc_patients"], "test.CGOncology_MDM.not_null_std_rx_bc_patients_PATIENT_ID.71727e35f0": ["model.CGOncology_MDM.std_rx_bc_patients"], "test.CGOncology_MDM.unique_std_rx_bc_patients_PATIENT_ID.02957e8bb5": ["model.CGOncology_MDM.std_rx_bc_patients"], "test.CGOncology_MDM.not_null_std_rx_bc_patients_EARLIEST_RX_DATE.6fcf09063b": ["model.CGOncology_MDM.std_rx_bc_patients"], "test.CGOncology_MDM.accepted_values_std_rx_bc_patients_IDENTIFICATION_SOURCE__RX.8755a20de4": ["model.CGOncology_MDM.std_rx_bc_patients"], "test.CGOncology_MDM.not_null_std_dh_hco_hist_dh_id.7937f17fc0": ["model.CGOncology_MDM.std_dh_hco_hist"], "test.CGOncology_MDM.not_null_std_dh_hco_hist_version_number.7c4e6114b5": ["model.CGOncology_MDM.std_dh_hco_hist"], "test.CGOncology_MDM.not_null_std_dh_hco_hist_is_current.7ddaa82390": ["model.CGOncology_MDM.std_dh_hco_hist"], "test.CGOncology_MDM.accepted_values_std_dh_hco_hist_is_current__Y__N.4e0f166b09": ["model.CGOncology_MDM.std_dh_hco_hist"], "test.CGOncology_MDM.not_null_std_dh_hco_hist_is_active.131197f8f7": ["model.CGOncology_MDM.std_dh_hco_hist"], "test.CGOncology_MDM.accepted_values_std_dh_hco_hist_is_active__Y__N.b27d95e392": ["model.CGOncology_MDM.std_dh_hco_hist"], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_hco_hist_dh_id__version_number.23ca9667d1": ["model.CGOncology_MDM.std_dh_hco_hist"], "test.CGOncology_MDM.not_null_std_dh_practice_location_hist_kmk_pl_id.13975dc992": ["model.CGOncology_MDM.std_dh_practice_location_hist"], "test.CGOncology_MDM.not_null_std_dh_practice_location_hist_version_number.ca12478fce": ["model.CGOncology_MDM.std_dh_practice_location_hist"], "test.CGOncology_MDM.not_null_std_dh_practice_location_hist_is_current.85bf5428f8": ["model.CGOncology_MDM.std_dh_practice_location_hist"], "test.CGOncology_MDM.accepted_values_std_dh_practice_location_hist_is_current__Y__N.97ab5347ed": ["model.CGOncology_MDM.std_dh_practice_location_hist"], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_practice_location_hist_kmk_pl_id__version_number.8e31476c9a": ["model.CGOncology_MDM.std_dh_practice_location_hist"], "test.CGOncology_MDM.not_null_std_dh_hcp_hist_npi.019b3d8523": ["model.CGOncology_MDM.std_dh_hcp_hist"], "test.CGOncology_MDM.not_null_std_dh_hcp_hist_version_number.855d421cee": ["model.CGOncology_MDM.std_dh_hcp_hist"], "test.CGOncology_MDM.not_null_std_dh_hcp_hist_is_current.1974f68cf0": ["model.CGOncology_MDM.std_dh_hcp_hist"], "test.CGOncology_MDM.accepted_values_std_dh_hcp_hist_is_current__Y__N.4648d155b9": ["model.CGOncology_MDM.std_dh_hcp_hist"], "test.CGOncology_MDM.not_null_std_dh_hcp_hist_is_active.e041856ff2": ["model.CGOncology_MDM.std_dh_hcp_hist"], "test.CGOncology_MDM.accepted_values_std_dh_hcp_hist_is_active__Y__N.882f8b924d": ["model.CGOncology_MDM.std_dh_hcp_hist"], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_hcp_hist_npi__version_number.dbfe70f933": ["model.CGOncology_MDM.std_dh_hcp_hist"], "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_hist_npi.28b5fbc518": ["model.CGOncology_MDM.std_dh_hcp_hco_affiliation_hist"], "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_hist_affiliated_id.9b572d258d": ["model.CGOncology_MDM.std_dh_hcp_hco_affiliation_hist"], "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_hist_version_number.e994c81d25": ["model.CGOncology_MDM.std_dh_hcp_hco_affiliation_hist"], "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_hist_is_current.37f0597c4a": ["model.CGOncology_MDM.std_dh_hcp_hco_affiliation_hist"], "test.CGOncology_MDM.accepted_values_std_dh_hcp_hco_affiliation_hist_is_current__Y__N.1017a9ee9d": ["model.CGOncology_MDM.std_dh_hcp_hco_affiliation_hist"], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_hcp_hco_affiliation_hist_npi__affiliated_id__version_number.e5ea84e2ec": ["model.CGOncology_MDM.std_dh_hcp_hco_affiliation_hist"], "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_hist_dh_id.c1156c613e": ["model.CGOncology_MDM.std_dh_facility_to_facility_affiliation_hist"], "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_hist_affiliated_id.e6f7b4617d": ["model.CGOncology_MDM.std_dh_facility_to_facility_affiliation_hist"], "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_hist_version_number.03382a4b79": ["model.CGOncology_MDM.std_dh_facility_to_facility_affiliation_hist"], "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_hist_is_current.5b8241a75f": ["model.CGOncology_MDM.std_dh_facility_to_facility_affiliation_hist"], "test.CGOncology_MDM.accepted_values_std_dh_facility_to_facility_affiliation_hist_is_current__Y__N.6d0529eaa0": ["model.CGOncology_MDM.std_dh_facility_to_facility_affiliation_hist"], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_facility_to_facility_affiliation_hist_dh_id__affiliated_id__version_number.6a1c689fcc": ["model.CGOncology_MDM.std_dh_facility_to_facility_affiliation_hist"], "test.CGOncology_MDM.not_null_std_ddd_hco_hist_ddd_outlet_id.9edec51303": ["model.CGOncology_MDM.std_ddd_hco_hist"], "test.CGOncology_MDM.not_null_std_ddd_hco_hist_version_number.f697601dc5": ["model.CGOncology_MDM.std_ddd_hco_hist"], "test.CGOncology_MDM.not_null_std_ddd_hco_hist_is_current.3ab5dde3a4": ["model.CGOncology_MDM.std_ddd_hco_hist"], "test.CGOncology_MDM.accepted_values_std_ddd_hco_hist_is_current__Y__N.3cc9ac69ad": ["model.CGOncology_MDM.std_ddd_hco_hist"], "test.CGOncology_MDM.not_null_std_ddd_hco_hist_is_active.d1163cfd85": ["model.CGOncology_MDM.std_ddd_hco_hist"], "test.CGOncology_MDM.accepted_values_std_ddd_hco_hist_is_active__Y__N.228110045d": ["model.CGOncology_MDM.std_ddd_hco_hist"], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_ddd_hco_hist_ddd_outlet_id__version_number.3ed056f0fc": ["model.CGOncology_MDM.std_ddd_hco_hist"], "test.CGOncology_MDM.not_null_std_ddd_sales_hist_ddd_outlet_id.aae4b0d159": ["model.CGOncology_MDM.std_ddd_sales_hist"], "test.CGOncology_MDM.not_null_std_medscout_hco_hist_medscout_id.32eb6a182a": ["model.CGOncology_MDM.std_medscout_hco_hist"], "test.CGOncology_MDM.not_null_std_medscout_hco_hist_version_number.6fcd0d9465": ["model.CGOncology_MDM.std_medscout_hco_hist"], "test.CGOncology_MDM.not_null_std_medscout_hco_hist_is_current.c89f159e10": ["model.CGOncology_MDM.std_medscout_hco_hist"], "test.CGOncology_MDM.accepted_values_std_medscout_hco_hist_is_current__Y__N.1b6303c595": ["model.CGOncology_MDM.std_medscout_hco_hist"], "test.CGOncology_MDM.not_null_std_medscout_hco_hist_is_active.97ee31c0e1": ["model.CGOncology_MDM.std_medscout_hco_hist"], "test.CGOncology_MDM.accepted_values_std_medscout_hco_hist_is_active__Y__N.9be0124c5d": ["model.CGOncology_MDM.std_medscout_hco_hist"], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_medscout_hco_hist_medscout_id__version_number.f5a93c52f3": ["model.CGOncology_MDM.std_medscout_hco_hist"], "test.CGOncology_MDM.not_null_std_medscout_hcp_hist_medscout_id.0e8f48d476": ["model.CGOncology_MDM.std_medscout_hcp_hist"], "test.CGOncology_MDM.not_null_std_medscout_hcp_hist_version_number.be260d61c7": ["model.CGOncology_MDM.std_medscout_hcp_hist"], "test.CGOncology_MDM.not_null_std_medscout_hcp_hist_is_current.e6054c50ee": ["model.CGOncology_MDM.std_medscout_hcp_hist"], "test.CGOncology_MDM.accepted_values_std_medscout_hcp_hist_is_current__Y__N.cf3bdfa364": ["model.CGOncology_MDM.std_medscout_hcp_hist"], "test.CGOncology_MDM.not_null_std_medscout_hcp_hist_is_active.119b7dfec8": ["model.CGOncology_MDM.std_medscout_hcp_hist"], "test.CGOncology_MDM.accepted_values_std_medscout_hcp_hist_is_active__Y__N.927a3159c2": ["model.CGOncology_MDM.std_medscout_hcp_hist"], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_medscout_hcp_hist_medscout_id__version_number.2807cc00e5": ["model.CGOncology_MDM.std_medscout_hcp_hist"], "test.CGOncology_MDM.not_null_ref_time_periods_period_key.a9e994cf12": ["model.CGOncology_MDM.ref_time_periods"], "test.CGOncology_MDM.unique_ref_time_periods_period_key.557cb7d317": ["model.CGOncology_MDM.ref_time_periods"], "test.CGOncology_MDM.not_null_ref_time_periods_period_type.5eeae962e8": ["model.CGOncology_MDM.ref_time_periods"], "test.CGOncology_MDM.accepted_values_ref_time_periods_period_type__MONTHLY__QUARTERLY__ROLLING__YTD__QTD__PY__PYTD__P2Y__CALENDAR_YEAR__LTD__TOTAL.5af4e4a14b": ["model.CGOncology_MDM.ref_time_periods"], "test.CGOncology_MDM.not_null_ref_treatment_categories_code.1067f5254b": ["model.CGOncology_MDM.ref_treatment_categories"], "test.CGOncology_MDM.not_null_ref_treatment_categories_code_type.4e9dabd64d": ["model.CGOncology_MDM.ref_treatment_categories"], "test.CGOncology_MDM.accepted_values_ref_treatment_categories_code_type__DX__CPT__HCPCS__ICD10PCS__ICD9__NDC.67743f64a9": ["model.CGOncology_MDM.ref_treatment_categories"], "test.CGOncology_MDM.accepted_values_ref_treatment_categories_metric_category__BC_DIAGNOSIS__TURBT__TICE_BCG__ADSTILADRIN__ANKTIVA__KEYTRUDA__CYSTOSCOPY__OTHER_PX__OTHER.3764e2253e": ["model.CGOncology_MDM.ref_treatment_categories"], "test.CGOncology_MDM.not_null_ref_payor_types_raw_payor_type.7785659b91": ["model.CGOncology_MDM.ref_payor_types"], "test.CGOncology_MDM.not_null_ref_payor_types_canonical_payor_type.67a25c16e9": ["model.CGOncology_MDM.ref_payor_types"], "test.CGOncology_MDM.accepted_values_ref_payor_types_canonical_payor_type__COMMERCIAL__MEDICARE__MEDICAID__MEDICARE_ADVANTAGE__OTHER.0219c536fb": ["model.CGOncology_MDM.ref_payor_types"], "test.CGOncology_MDM.not_null_adm_hco_master_kmk_hco_id.19c041cf01": ["model.CGOncology_MDM.adm_hco_master"], "test.CGOncology_MDM.unique_adm_hco_master_kmk_hco_id.595890ac11": ["model.CGOncology_MDM.adm_hco_master"], "test.CGOncology_MDM.relationships_adm_hco_master_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.5e67cf4dd2": ["model.CGOncology_MDM.adm_hco_master", "model.CGOncology_MDM.mdm_customer_master_hco"], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_adm_hco_master_kmk_hco_id___34_0_9_9_.59162648b2": ["model.CGOncology_MDM.adm_hco_master"], "test.CGOncology_MDM.accepted_values_adm_hco_master_account_type__P1_LUGPA__P2_ACADEMIC__P2_NON_ACADEMIC__P3__FEDERAL__P3_CCS__P4_SMALL_INDEP_Ctr.4bd3ff3d4d": ["model.CGOncology_MDM.adm_hco_master"], "test.CGOncology_MDM.accepted_values_adm_hco_master_account_type_priority__P1__P2__P3__P4.c308974a6e": ["model.CGOncology_MDM.adm_hco_master"], "test.CGOncology_MDM.accepted_values_adm_hco_master_hierarchy_level__L1__L2__L3__L4.17118f63d4": ["model.CGOncology_MDM.adm_hco_master"], "test.CGOncology_MDM.not_null_adm_hco_master_cust_backbone_flag.2eb804314f": ["model.CGOncology_MDM.adm_hco_master"], "test.CGOncology_MDM.accepted_values_adm_hco_master_cust_backbone_flag__Y__N.66c59561ee": ["model.CGOncology_MDM.adm_hco_master"], "test.CGOncology_MDM.accepted_values_adm_hco_master_network_target_flag__0__1.f1bb7a4710": ["model.CGOncology_MDM.adm_hco_master"], "test.CGOncology_MDM.accepted_values_adm_hco_master_child_target_flag__0__1.f2eb08ef11": ["model.CGOncology_MDM.adm_hco_master"], "test.CGOncology_MDM.accepted_values_adm_hco_master_kam_target_flag__Y__N.bae2588bce": ["model.CGOncology_MDM.adm_hco_master"], "test.CGOncology_MDM.accepted_values_adm_hco_master_hsd_target_flag__Y__N.6622511c65": ["model.CGOncology_MDM.adm_hco_master"], "test.CGOncology_MDM.accepted_values_adm_hco_master_msl_target_flag__Y__N.fc14917e51": ["model.CGOncology_MDM.adm_hco_master"], "test.CGOncology_MDM.row_count_match_adm_hco_master_ref_mdm_customer_master_hco_.8e0ebfab64": ["model.CGOncology_MDM.adm_hco_master", "model.CGOncology_MDM.mdm_customer_master_hco"], "test.CGOncology_MDM.not_null_adm_hcp_master_kmk_hcp_id.9fed89113c": ["model.CGOncology_MDM.adm_hcp_master"], "test.CGOncology_MDM.unique_adm_hcp_master_kmk_hcp_id.3250d72e22": ["model.CGOncology_MDM.adm_hcp_master"], "test.CGOncology_MDM.relationships_adm_hcp_master_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_.29aa3c4a53": ["model.CGOncology_MDM.adm_hcp_master", "model.CGOncology_MDM.mdm_customer_master_hcp"], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_adm_hcp_master_kmk_hcp_id___15_0_9_9_.0f016d3772": ["model.CGOncology_MDM.adm_hcp_master"], "test.CGOncology_MDM.not_null_adm_hcp_master_npi.b8c1e61554": ["model.CGOncology_MDM.adm_hcp_master"], "test.CGOncology_MDM.relationships_adm_hcp_master_npi__npi__ref_mdm_customer_master_hcp_.c817192688": ["model.CGOncology_MDM.adm_hcp_master", "model.CGOncology_MDM.mdm_customer_master_hcp"], "test.CGOncology_MDM.not_null_adm_hcp_master_cust_backbone_flag.aae912f453": ["model.CGOncology_MDM.adm_hcp_master"], "test.CGOncology_MDM.accepted_values_adm_hcp_master_cust_backbone_flag__Y__N.c77ea1fe72": ["model.CGOncology_MDM.adm_hcp_master"], "test.CGOncology_MDM.accepted_values_adm_hcp_master_kam_target_flag__Y__N.64ee4b29c7": ["model.CGOncology_MDM.adm_hcp_master"], "test.CGOncology_MDM.accepted_values_adm_hcp_master_kam_decile__1__2__3__4__5__6__7__8__9__10.756fdeacaf": ["model.CGOncology_MDM.adm_hcp_master"], "test.CGOncology_MDM.row_count_match_adm_hcp_master_ref_mdm_customer_master_hcp_.45f3a4cae5": ["model.CGOncology_MDM.adm_hcp_master", "model.CGOncology_MDM.mdm_customer_master_hcp"], "test.CGOncology_MDM.not_null_adm_hco_hierarchy_kmk_hco_id.57589754c5": ["model.CGOncology_MDM.adm_hco_hierarchy"], "test.CGOncology_MDM.unique_adm_hco_hierarchy_kmk_hco_id.af11937683": ["model.CGOncology_MDM.adm_hco_hierarchy"], "test.CGOncology_MDM.relationships_adm_hco_hierarchy_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.1d6b8c0dce": ["model.CGOncology_MDM.adm_hco_hierarchy", "model.CGOncology_MDM.mdm_customer_master_hco"], "test.CGOncology_MDM.not_null_adm_hco_hierarchy_hierarchy_level.8368eddce9": ["model.CGOncology_MDM.adm_hco_hierarchy"], "test.CGOncology_MDM.accepted_values_adm_hco_hierarchy_hierarchy_level__L1__L2__L3__L4.aedee61f35": ["model.CGOncology_MDM.adm_hco_hierarchy"], "test.CGOncology_MDM.relationships_adm_hco_hierarchy_account_id_l1__kmk_hco_id__ref_mdm_customer_master_hco_.23c5f3762e": ["model.CGOncology_MDM.adm_hco_hierarchy", "model.CGOncology_MDM.mdm_customer_master_hco"], "test.CGOncology_MDM.relationships_adm_hco_hierarchy_account_id_l2__kmk_hco_id__ref_mdm_customer_master_hco_.1db54b1492": ["model.CGOncology_MDM.adm_hco_hierarchy", "model.CGOncology_MDM.mdm_customer_master_hco"], "test.CGOncology_MDM.relationships_adm_hco_hierarchy_account_id_l3__kmk_hco_id__ref_mdm_customer_master_hco_.c75c8794ac": ["model.CGOncology_MDM.adm_hco_hierarchy", "model.CGOncology_MDM.mdm_customer_master_hco"], "test.CGOncology_MDM.relationships_adm_hco_hierarchy_account_id_l4__kmk_hco_id__ref_mdm_customer_master_hco_.11f5ece339": ["model.CGOncology_MDM.adm_hco_hierarchy", "model.CGOncology_MDM.mdm_customer_master_hco"], "test.CGOncology_MDM.not_null_adm_claims_metrics_long_entity_type.4ee8824a9d": ["model.CGOncology_MDM.adm_claims_metrics_long"], "test.CGOncology_MDM.accepted_values_adm_claims_metrics_long_entity_type__HCO__HCP.ae7d2aedac": ["model.CGOncology_MDM.adm_claims_metrics_long"], "test.CGOncology_MDM.not_null_adm_claims_metrics_long_entity_id.62f222c646": ["model.CGOncology_MDM.adm_claims_metrics_long"], "test.CGOncology_MDM.not_null_adm_claims_metrics_long_metric_category.a993d0d928": ["model.CGOncology_MDM.adm_claims_metrics_long"], "test.CGOncology_MDM.accepted_values_adm_claims_metrics_long_metric_category__BC_DIAGNOSIS__TURBT__TICE_BCG__ADSTILADRIN__ANKTIVA__KEYTRUDA__CYSTOSCOPY__OTHER_PROCEDURES__Total_Claims.94301565dc": ["model.CGOncology_MDM.adm_claims_metrics_long"], "test.CGOncology_MDM.not_null_adm_claims_metrics_long_period_key.a7e5be47da": ["model.CGOncology_MDM.adm_claims_metrics_long"], "test.CGOncology_MDM.not_null_adm_claims_metrics_long_claim_count.e55d380d3c": ["model.CGOncology_MDM.adm_claims_metrics_long"], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_be_between_adm_claims_metrics_long_claim_count__0.d16650926f": ["model.CGOncology_MDM.adm_claims_metrics_long"], "test.CGOncology_MDM.not_null_adm_claims_metrics_long_patient_count.a793935234": ["model.CGOncology_MDM.adm_claims_metrics_long"], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_be_between_adm_claims_metrics_long_patient_count__0.52b56d55e6": ["model.CGOncology_MDM.adm_claims_metrics_long"], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_adm_claims_metrics_long_entity_type__entity_id__metric_category__period_key.bd089e0447": ["model.CGOncology_MDM.adm_claims_metrics_long"], "test.CGOncology_MDM.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_adm_claims_metrics_long_claim_count__patient_count__True.4687b44aa9": ["model.CGOncology_MDM.adm_claims_metrics_long"], "test.CGOncology_MDM.not_null_adm_claims_metrics_by_payor_entity_type.cab3d439d4": ["model.CGOncology_MDM.adm_claims_metrics_by_payor"], "test.CGOncology_MDM.accepted_values_adm_claims_metrics_by_payor_entity_type__HCO__HCP.0d142bb56f": ["model.CGOncology_MDM.adm_claims_metrics_by_payor"], "test.CGOncology_MDM.not_null_adm_claims_metrics_by_payor_entity_id.da949df3be": ["model.CGOncology_MDM.adm_claims_metrics_by_payor"], "test.CGOncology_MDM.not_null_adm_claims_metrics_by_payor_metric_category.4d935aea00": ["model.CGOncology_MDM.adm_claims_metrics_by_payor"], "test.CGOncology_MDM.not_null_adm_claims_metrics_by_payor_payor_type.0155c9899e": ["model.CGOncology_MDM.adm_claims_metrics_by_payor"], "test.CGOncology_MDM.accepted_values_adm_claims_metrics_by_payor_payor_type__COMMERCIAL__MEDICARE__MEDICAID__MEDICARE_ADVANTAGE__OTHER__ALL.6c39bb89fc": ["model.CGOncology_MDM.adm_claims_metrics_by_payor"], "test.CGOncology_MDM.not_null_adm_hco_claims_wide_kmk_hco_id.c341d38d95": ["model.CGOncology_MDM.adm_hco_claims_wide"], "test.CGOncology_MDM.relationships_adm_hco_claims_wide_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.6f179ab665": ["model.CGOncology_MDM.adm_hco_claims_wide", "model.CGOncology_MDM.mdm_customer_master_hco"], "test.CGOncology_MDM.not_null_adm_hco_claims_wide_metric_category.0ee4d97e6c": ["model.CGOncology_MDM.adm_hco_claims_wide"], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_adm_hco_claims_wide_kmk_hco_id__metric_category.6de5f75027": ["model.CGOncology_MDM.adm_hco_claims_wide"], "test.CGOncology_MDM.not_null_adm_hcp_claims_wide_kmk_hcp_id.8632196ef4": ["model.CGOncology_MDM.adm_hcp_claims_wide"], "test.CGOncology_MDM.relationships_adm_hcp_claims_wide_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_.a271032517": ["model.CGOncology_MDM.adm_hcp_claims_wide", "model.CGOncology_MDM.mdm_customer_master_hcp"], "test.CGOncology_MDM.not_null_adm_hcp_claims_wide_metric_category.2721711915": ["model.CGOncology_MDM.adm_hcp_claims_wide"], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_adm_hcp_claims_wide_kmk_hcp_id__metric_category.f671822c9f": ["model.CGOncology_MDM.adm_hcp_claims_wide"], "test.CGOncology_MDM.not_null_adm_nmibc_risk_patient_id.fab493a5d5": ["model.CGOncology_MDM.adm_nmibc_risk"], "test.CGOncology_MDM.unique_adm_nmibc_risk_patient_id.0f914ec428": ["model.CGOncology_MDM.adm_nmibc_risk"], "test.CGOncology_MDM.not_null_adm_nmibc_risk_nmibc_risk_tier.d7a1407372": ["model.CGOncology_MDM.adm_nmibc_risk"], "test.CGOncology_MDM.accepted_values_adm_nmibc_risk_nmibc_risk_tier__HIGH__INTERMEDIATE__LOW.ea5c66bfb9": ["model.CGOncology_MDM.adm_nmibc_risk"], "test.CGOncology_MDM.not_null_adm_hco_nmibc_metrics_kmk_hco_id.879ce27570": ["model.CGOncology_MDM.adm_hco_nmibc_metrics"], "test.CGOncology_MDM.unique_adm_hco_nmibc_metrics_kmk_hco_id.d9d7542acd": ["model.CGOncology_MDM.adm_hco_nmibc_metrics"], "test.CGOncology_MDM.relationships_adm_hco_nmibc_metrics_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.9077e1ad59": ["model.CGOncology_MDM.adm_hco_nmibc_metrics", "model.CGOncology_MDM.mdm_customer_master_hco"], "test.CGOncology_MDM.not_null_adm_hco_nmibc_metrics_total_nmibc_patients.a38658c0ce": ["model.CGOncology_MDM.adm_hco_nmibc_metrics"], "test.CGOncology_MDM.not_null_adm_hco_nmibc_metrics_high_risk_nmibc_patients.05ab66c196": ["model.CGOncology_MDM.adm_hco_nmibc_metrics"], "test.CGOncology_MDM.not_null_adm_hco_nmibc_metrics_mid_risk_nmibc_patients.fa614f1d00": ["model.CGOncology_MDM.adm_hco_nmibc_metrics"], "test.CGOncology_MDM.not_null_adm_hco_nmibc_metrics_low_risk_nmibc_patients.3ca3bd0262": ["model.CGOncology_MDM.adm_hco_nmibc_metrics"], "test.CGOncology_MDM.not_null_adm_ddd_metrics_grain_outlet_no.bd9c6a4fba": ["model.CGOncology_MDM.adm_ddd_metrics_grain"], "test.CGOncology_MDM.not_null_adm_ddd_metrics_grain_product_group_id.b56b99cd4d": ["model.CGOncology_MDM.adm_ddd_metrics_grain"], "test.CGOncology_MDM.accepted_values_adm_ddd_metrics_grain_product_group_id__1__2__3__4__7.85590311ef": ["model.CGOncology_MDM.adm_ddd_metrics_grain"], "test.CGOncology_MDM.not_null_adm_ddd_metrics_grain_kmk_hco_id.af8e20f7b3": ["model.CGOncology_MDM.adm_ddd_metrics_grain"], "test.CGOncology_MDM.not_null_adm_ddd_metrics_grain_sales_amount.c0f65820e3": ["model.CGOncology_MDM.adm_ddd_metrics_grain"], "test.CGOncology_MDM.not_null_adm_ddd_metrics_grain_units_count.05cd92af6c": ["model.CGOncology_MDM.adm_ddd_metrics_grain"], "test.CGOncology_MDM.not_null_adm_ddd_metrics_grain_month_num.e58f620175": ["model.CGOncology_MDM.adm_ddd_metrics_grain"], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_be_between_adm_ddd_metrics_grain_month_num__24__1.cca6edfe9a": ["model.CGOncology_MDM.adm_ddd_metrics_grain"], "test.CGOncology_MDM.dbt_expectations_expect_table_row_count_to_be_between_adm_ddd_metrics_grain_50000.0acb967837": ["model.CGOncology_MDM.adm_ddd_metrics_grain"], "test.CGOncology_MDM.not_null_adm_ddd_metrics_wide_kmk_hco_id.eb1befe131": ["model.CGOncology_MDM.adm_ddd_metrics_wide"], "test.CGOncology_MDM.relationships_adm_ddd_metrics_wide_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.7717014ac4": ["model.CGOncology_MDM.adm_ddd_metrics_wide", "model.CGOncology_MDM.mdm_customer_master_hco"], "test.CGOncology_MDM.not_null_adm_ddd_metrics_wide_metric_category.5264fc27ec": ["model.CGOncology_MDM.adm_ddd_metrics_wide"], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_adm_ddd_metrics_wide_kmk_hco_id__metric_category.95bbc51f56": ["model.CGOncology_MDM.adm_ddd_metrics_wide"], "test.CGOncology_MDM.not_null_adm_ddd_metrics_long_entity_type.3a48119566": ["model.CGOncology_MDM.adm_ddd_metrics_long"], "test.CGOncology_MDM.accepted_values_adm_ddd_metrics_long_entity_type__HCO.8cdf8eb4c5": ["model.CGOncology_MDM.adm_ddd_metrics_long"], "test.CGOncology_MDM.not_null_adm_ddd_metrics_long_entity_id.5d26527a34": ["model.CGOncology_MDM.adm_ddd_metrics_long"], "test.CGOncology_MDM.not_null_adm_ddd_metrics_long_metric_category.6ff3e16807": ["model.CGOncology_MDM.adm_ddd_metrics_long"], "test.CGOncology_MDM.accepted_values_adm_ddd_metrics_long_metric_category__TICE_BCG__ADSTILADRIN__ANKTIVA__INLEXZO__TOTAL_BRANDED__TOTAL__OTHER.84c56bf16a": ["model.CGOncology_MDM.adm_ddd_metrics_long"], "test.CGOncology_MDM.not_null_adm_ddd_metrics_long_period_key.9bdfea608e": ["model.CGOncology_MDM.adm_ddd_metrics_long"], "test.CGOncology_MDM.not_null_adm_ddd_metrics_long_period_type.1b0e3c4c83": ["model.CGOncology_MDM.adm_ddd_metrics_long"], "test.CGOncology_MDM.accepted_values_adm_ddd_metrics_long_period_type__MONTHLY__QUARTERLY__ROLLING__YTD__QTD__PY__PYTD__P2Y__CALENDAR_YEAR__LTD__TOTAL.60fff9a04a": ["model.CGOncology_MDM.adm_ddd_metrics_long"], "test.CGOncology_MDM.not_null_adm_ddd_metrics_long_data_date.350c355f44": ["model.CGOncology_MDM.adm_ddd_metrics_long"], "test.CGOncology_MDM.dbt_expectations_expect_table_row_count_to_be_between_adm_ddd_metrics_long_100000.0fbaec9138": ["model.CGOncology_MDM.adm_ddd_metrics_long"], "test.CGOncology_MDM.not_null_adm_lowest_level_metrics_kmk_hco_id.55b4f59cf8": ["model.CGOncology_MDM.adm_lowest_level_metrics"], "test.CGOncology_MDM.relationships_adm_lowest_level_metrics_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.a9076ad74b": ["model.CGOncology_MDM.adm_lowest_level_metrics", "model.CGOncology_MDM.mdm_customer_master_hco"], "test.CGOncology_MDM.not_null_adm_lowest_level_metrics_metric_category.70e347ae8a": ["model.CGOncology_MDM.adm_lowest_level_metrics"], "test.CGOncology_MDM.not_null_adm_lowest_level_metrics_metric_code.b05b2de93c": ["model.CGOncology_MDM.adm_lowest_level_metrics"], "test.CGOncology_MDM.not_null_adm_lowest_level_metrics_period_key.580102b640": ["model.CGOncology_MDM.adm_lowest_level_metrics"], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_adm_lowest_level_metrics_kmk_hco_id__metric_category__metric_code__period_key.98b6841877": ["model.CGOncology_MDM.adm_lowest_level_metrics"], "test.CGOncology_MDM.not_null_ref_address_best_hco_kmk_hco_id.f5e718f933": ["model.CGOncology_MDM.ref_address_best_hco"], "test.CGOncology_MDM.unique_ref_address_best_hco_kmk_hco_id.a384281d43": ["model.CGOncology_MDM.ref_address_best_hco"], "test.CGOncology_MDM.relationships_ref_address_best_hco_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.0936f794de": ["model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.ref_address_best_hco"], "test.CGOncology_MDM.not_null_ref_address_best_hco_address_group_id.53d638d7eb": ["model.CGOncology_MDM.ref_address_best_hco"], "test.CGOncology_MDM.not_null_ref_address_best_hco_address_best_hco_id.dab8f5f797": ["model.CGOncology_MDM.ref_address_best_hco"], "test.CGOncology_MDM.not_null_ref_address_best_hco_is_address_best.49ac58e764": ["model.CGOncology_MDM.ref_address_best_hco"], "test.CGOncology_MDM.accepted_values_ref_address_best_hco_is_address_best__Y__N.4821daa5cd": ["model.CGOncology_MDM.ref_address_best_hco"], "test.CGOncology_MDM.not_null_ref_address_best_hco_address_group_count.a48f51a241": ["model.CGOncology_MDM.ref_address_best_hco"], "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_entity_type.7f2a2cf4d0": ["model.CGOncology_MDM.adm_address_best_hco_metrics_long"], "test.CGOncology_MDM.accepted_values_adm_address_best_hco_metrics_long_entity_type__ADDRESS_BEST_HCO.e3223ff58e": ["model.CGOncology_MDM.adm_address_best_hco_metrics_long"], "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_entity_id.58f585bf06": ["model.CGOncology_MDM.adm_address_best_hco_metrics_long"], "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_metric_category.61333a3296": ["model.CGOncology_MDM.adm_address_best_hco_metrics_long"], "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_period_key.6479f81b48": ["model.CGOncology_MDM.adm_address_best_hco_metrics_long"], "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_claim_count.16f35ae23f": ["model.CGOncology_MDM.adm_address_best_hco_metrics_long"], "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_patient_count.e3d2699c30": ["model.CGOncology_MDM.adm_address_best_hco_metrics_long"], "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_contributing_hco_count.95bedc6749": ["model.CGOncology_MDM.adm_address_best_hco_metrics_long"], "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_wide_kmk_hco_id.7132de2edb": ["model.CGOncology_MDM.adm_address_best_hco_metrics_wide"], "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_wide_metric_category.2d7e0dbc9e": ["model.CGOncology_MDM.adm_address_best_hco_metrics_wide"], "test.CGOncology_MDM.not_null_adm_address_best_ddd_metrics_long_entity_type.bbb73a3e00": ["model.CGOncology_MDM.adm_address_best_ddd_metrics_long"], "test.CGOncology_MDM.accepted_values_adm_address_best_ddd_metrics_long_entity_type__ADDRESS_BEST_HCO.76d303acb5": ["model.CGOncology_MDM.adm_address_best_ddd_metrics_long"], "test.CGOncology_MDM.not_null_adm_address_best_ddd_metrics_long_entity_id.dc95135281": ["model.CGOncology_MDM.adm_address_best_ddd_metrics_long"], "test.CGOncology_MDM.not_null_adm_address_best_ddd_metrics_long_metric_category.d523793836": ["model.CGOncology_MDM.adm_address_best_ddd_metrics_long"], "test.CGOncology_MDM.accepted_values_adm_address_best_ddd_metrics_long_metric_category__TICE_BCG__ADSTILADRIN__ANKTIVA__INLEXZO__TOTAL_BRANDED__TOTAL__OTHER.c8ce60c168": ["model.CGOncology_MDM.adm_address_best_ddd_metrics_long"], "test.CGOncology_MDM.not_null_adm_address_best_ddd_metrics_long_period_key.10fec1acd6": ["model.CGOncology_MDM.adm_address_best_ddd_metrics_long"], "test.CGOncology_MDM.not_null_adm_address_best_ddd_metrics_wide_kmk_hco_id.945c4a01b0": ["model.CGOncology_MDM.adm_address_best_ddd_metrics_wide"], "test.CGOncology_MDM.not_null_adm_address_best_ddd_metrics_wide_metric_category.215003c5bc": ["model.CGOncology_MDM.adm_address_best_ddd_metrics_wide"], "test.CGOncology_MDM.not_null_adm_pipeline_snapshot_run_timestamp.ff8bc8e6ff": ["model.CGOncology_MDM.adm_pipeline_snapshot"], "test.CGOncology_MDM.not_null_adm_pipeline_snapshot_data_date.d3d141b40b": ["model.CGOncology_MDM.adm_pipeline_snapshot"], "test.CGOncology_MDM.not_null_adm_pipeline_snapshot_metric_group.3587125e97": ["model.CGOncology_MDM.adm_pipeline_snapshot"], "test.CGOncology_MDM.not_null_adm_pipeline_snapshot_metric_name.7ed1bacdec": ["model.CGOncology_MDM.adm_pipeline_snapshot"], "test.CGOncology_MDM.not_null_adm_pipeline_snapshot_metric_value.f59cc31a65": ["model.CGOncology_MDM.adm_pipeline_snapshot"], "test.CGOncology_MDM.accepted_values_adm_pipeline_diff_severity__CRITICAL__WARNING__INFO__OK.5092607787": ["model.CGOncology_MDM.adm_pipeline_diff"], "test.CGOncology_MDM.not_null_adm_pipeline_trend_data_date.f3fa81fdfb": ["model.CGOncology_MDM.adm_pipeline_trend"], "test.CGOncology_MDM.not_null_adm_pipeline_trend_metric_group.7c11051e3c": ["model.CGOncology_MDM.adm_pipeline_trend"], "test.CGOncology_MDM.not_null_adm_pipeline_trend_metric_name.e432676a27": ["model.CGOncology_MDM.adm_pipeline_trend"], "test.CGOncology_MDM.not_null_accounts_account_id.f3516ebe86": [], "test.CGOncology_MDM.unique_accounts_account_id.4e8028f44d": [], "test.CGOncology_MDM.not_null_hcps_hcp_id.9d00a42a49": [], "test.CGOncology_MDM.unique_hcps_hcp_id.7cd4d1db94": [], "test.CGOncology_MDM.not_null_account_metric_value_account_id.daca68f839": [], "test.CGOncology_MDM.not_null_account_metric_value_metric.7d4142e6c1": [], "test.CGOncology_MDM.not_null_account_metric_value_x_value.7266aac6a3": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_account_metric_value_account_id__metric__x_value.a7fdcfc32d": [], "test.CGOncology_MDM.not_null_geo_metric_value_geography_id.c03bcc8173": [], "test.CGOncology_MDM.not_null_geo_metric_value_metric.6c74eefef1": [], "test.CGOncology_MDM.not_null_geo_metric_value_x_value.7d369f5606": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_geo_metric_value_geography_id__metric__x_value.9b6b21c19d": [], "test.CGOncology_MDM.not_null_account_hcps_account_id.9105429673": [], "test.CGOncology_MDM.not_null_account_hcps_hcp_id.4ade91a768": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_account_hcps_account_id__hcp_id.e5ab65a978": [], "test.CGOncology_MDM.not_null_targets_team_code.f3721486b3": [], "test.CGOncology_MDM.not_null_targets_account_id.1ed19c89aa": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_targets_team_code__account_id.7822ba6bb9": [], "test.CGOncology_MDM.not_null_accounts_geo_affiliation_account_id.d02fe7ab82": [], "test.CGOncology_MDM.not_null_accounts_geo_affiliation_geo_code.4cc1f22303": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_accounts_geo_affiliation_account_id__geo_code.33b45a1a4a": [], "test.CGOncology_MDM.not_null_account_payer_types_account_id.f1840ce997": [], "test.CGOncology_MDM.not_null_account_payer_types_payer_type.de70e0d27e": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_account_payer_types_account_id__payer_type__product.91f9599d2f": [], "test.CGOncology_MDM.not_null_account_executives_account_id.fcc34ca9c9": [], "test.CGOncology_MDM.not_null_account_executives_executive_id.3fc9f05c72": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_account_executives_account_id__executive_id.bd23489999": [], "test.CGOncology_MDM.not_null_geographies_geo_code.a5991755ab": [], "test.CGOncology_MDM.unique_geographies_geo_code.7f462935fb": [], "test.CGOncology_MDM.not_null_account_levels_code.849ccc9022": [], "test.CGOncology_MDM.unique_account_levels_code.5bdbf79dd1": [], "test.CGOncology_MDM.not_null_account_types_code.71ee76f58d": [], "test.CGOncology_MDM.unique_account_types_code.970ebf6203": [], "test.CGOncology_MDM.not_null_teams_team_code.564726c6b6": ["seed.CGOncology_MDM.teams"], "test.CGOncology_MDM.unique_teams_team_code.4a63fda674": ["seed.CGOncology_MDM.teams"], "test.CGOncology_MDM.not_null_metric_list_code.decbcfb7bd": [], "test.CGOncology_MDM.unique_metric_list_code.e46edf3df9": [], "test.CGOncology_MDM.not_null_payer_types_code.fe7996f333": [], "test.CGOncology_MDM.unique_payer_types_code.bb3be8482d": [], "test.CGOncology_MDM.not_null_units_unit_code.06667a1d29": [], "test.CGOncology_MDM.unique_units_unit_code.f733452279": [], "test.CGOncology_MDM.not_null_states_code.ef45871ca2": [], "test.CGOncology_MDM.unique_states_code.a1c69eafa1": [], "test.CGOncology_MDM.not_null_firm_types_code.de9c62050f": [], "test.CGOncology_MDM.unique_firm_types_code.05448a131a": [], "test.CGOncology_MDM.not_null_data_source_data_source.bac58ac78f": [], "test.CGOncology_MDM.unique_data_source_data_source.add5f8ee8f": [], "test.CGOncology_MDM.not_null_config_charts_chart_code.a0fe743549": [], "test.CGOncology_MDM.unique_config_charts_chart_code.053a97cd50": [], "test.CGOncology_MDM.not_null_data_points_code.3eed85fe8d": [], "test.CGOncology_MDM.unique_data_points_code.a0594e6970": [], "test.CGOncology_MDM.not_null_executives_executive_id.cfcbd8a9f1": [], "test.CGOncology_MDM.unique_executives_executive_id.d4fe1ece33": [], "test.CGOncology_MDM.not_null_geo_levels_unit_code.2ed13993b7": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_geo_levels_unit_code__level.620331e0a0": [], "source.CGOncology_MDM.raw_dh.PRELAND_DH_ALL_COMPANIES_OVERVIEW": [], "source.CGOncology_MDM.raw_dh.PRELAND_DH_PHYSICIANS_OVERVIEW": [], "source.CGOncology_MDM.raw_dh.PRELAND_DH_PHYSICIAN_GROUP_PRACTICE_LOCATION": [], "source.CGOncology_MDM.raw_dh.PRELAND_DH_PHYSICIANS_FACILITY_AFFILIATION": [], "source.CGOncology_MDM.raw_dh.PRELAND_DH_FACILITY_TO_FACILITY_AFFILIATION": [], "source.CGOncology_MDM.raw_dh.PRELAND_DH_BLADDERCANCER_HXMX_DIAGNOSIS": [], "source.CGOncology_MDM.raw_dh.PRELAND_DH_BLADDERCANCER_HXMX_PROCEDURE": [], "source.CGOncology_MDM.raw_dh.PRELAND_DH_BLADDERCANCER_RX": [], "source.CGOncology_MDM.raw_dh.PRELAND_CG_ONCOLOGY_FULL_MATCHING_RETURN_20241025": [], "source.CGOncology_MDM.raw_medscout.PRELAND_MEDSCOUT_HCO_DATA": [], "source.CGOncology_MDM.raw_medscout.PRELAND_MEDSCOUT_HCP_DATA": [], "source.CGOncology_MDM.raw_ddd.PRELAND_DDD_DEMOGRAPHICS": [], "source.CGOncology_MDM.raw_ddd.PRELAND_DDD_SALES": [], "source.CGOncology_MDM.cgoncology_dev_adm.HCP_AISSEL": [], "source.CGOncology_MDM.cgoncology_dev_adm.MEDICAL_INTERACTIONS": [], "source.CGOncology_MDM.cgoncology_dev_adm.MEDICAL_INSIGHTS": [], "source.CGOncology_MDM.cgoncology_dev_reporting.ACTIVITY_DASHBOARD_METRICS": [], "source.CGOncology_MDM.cgoncology_dev_reporting.CLINICAL_TRIAL_DATA": [], "source.CGOncology_MDM.cgoncology_dev_reporting.HCP_VIEW_DETAIL_TABLE": [], "source.CGOncology_MDM.staging.ADMIN_SITE_TARGET_LIST_ACCT_ID": [], "source.CGOncology_MDM.staging.CHILD_SITE_TARGET_LIST_ACCT_ID": [], "source.CGOncology_MDM.staging.CG_ONCOLOGY_HCP_TARGETING_LIST": [], "source.CGOncology_MDM.cgoncology_prod_analytical.HSD_TARGET_UNIVERSE_UPDATED_RANK": [], "source.CGOncology_MDM.cgoncology_prod_analytical.CG_MSL_Target_list": []}, "child_map": {"model.CGOncology_MDM.mdm_customer_master_hco": ["model.CGOncology_MDM.adm_dh_metrics_grain", "model.CGOncology_MDM.adm_hco_hierarchy", "model.CGOncology_MDM.adm_hco_master", "model.CGOncology_MDM.adm_hco_nmibc_metrics", "model.CGOncology_MDM.adm_sfe_hco_targets", "model.CGOncology_MDM.mdm_best_affiliation", "model.CGOncology_MDM.ref_address_best_hco", "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_mdm_customer_master_hco_kmk_hco_id___34_0_9_9_.c57ec6e0c3", "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_mdm_customer_master_hco_dh_id___0__dh_id_IS_NOT_NULL.1f6f480f1f", "test.CGOncology_MDM.key_coverage_mdm_customer_master_hco_kmk_hco_id__kmk_hco_id__SOURCE_CODE_DHC_OR_SOURCE_CODE_DDD_AND_DH_ID_IS_NOT_NULL___ref_mdm_customer_xref_hco_.cc390e7732", "test.CGOncology_MDM.not_null_mdm_customer_master_hco_kmk_hco_id.872bd2a427", "test.CGOncology_MDM.not_null_mdm_customer_master_hco_org_name.2edb57d8d4", "test.CGOncology_MDM.relationships_adm_ddd_metrics_wide_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.7717014ac4", "test.CGOncology_MDM.relationships_adm_hco_claims_wide_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.6f179ab665", "test.CGOncology_MDM.relationships_adm_hco_hierarchy_account_id_l1__kmk_hco_id__ref_mdm_customer_master_hco_.23c5f3762e", "test.CGOncology_MDM.relationships_adm_hco_hierarchy_account_id_l2__kmk_hco_id__ref_mdm_customer_master_hco_.1db54b1492", "test.CGOncology_MDM.relationships_adm_hco_hierarchy_account_id_l3__kmk_hco_id__ref_mdm_customer_master_hco_.c75c8794ac", "test.CGOncology_MDM.relationships_adm_hco_hierarchy_account_id_l4__kmk_hco_id__ref_mdm_customer_master_hco_.11f5ece339", "test.CGOncology_MDM.relationships_adm_hco_hierarchy_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.1d6b8c0dce", "test.CGOncology_MDM.relationships_adm_hco_master_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.5e67cf4dd2", "test.CGOncology_MDM.relationships_adm_hco_nmibc_metrics_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.9077e1ad59", "test.CGOncology_MDM.relationships_adm_lowest_level_metrics_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.a9076ad74b", "test.CGOncology_MDM.relationships_adm_sfe_hco_targets_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.07e79ca121", "test.CGOncology_MDM.relationships_mdm_best_affiliation_best_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.94418604ac", "test.CGOncology_MDM.relationships_mdm_customer_xref_hco_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.bb9737f0e4", "test.CGOncology_MDM.relationships_ref_address_best_hco_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.0936f794de", "test.CGOncology_MDM.row_count_match_adm_hco_master_ref_mdm_customer_master_hco_.8e0ebfab64", "test.CGOncology_MDM.unique_mdm_customer_master_hco_kmk_hco_id.5a263fffb9", "test.CGOncology_MDM.val_path2_skip_validation"], "model.CGOncology_MDM.mdm_customer_xref_hcp": ["model.CGOncology_MDM.adm_sfe_hcp_targets", "model.CGOncology_MDM.mdm_customer_master_hcp", "model.CGOncology_MDM.mdm_customer_xref_hcp_hist", "test.CGOncology_MDM.accepted_values_mdm_customer_xref_hcp_source_code__DHC__MEDSCOUT.48cc60fa51", "test.CGOncology_MDM.key_coverage_mdm_customer_master_hcp_kmk_hcp_id__kmk_hcp_id__SOURCE_CODE_DHC___ref_mdm_customer_xref_hcp_.c421076b29", "test.CGOncology_MDM.key_coverage_mdm_customer_xref_hcp_source_id__npi__ref_std_dh_hcp___SOURCE_CODE_DHC_.1ea045b04f", "test.CGOncology_MDM.not_null_mdm_customer_xref_hcp_kmk_hcp_id.5ee8ca04b8", "test.CGOncology_MDM.not_null_mdm_customer_xref_hcp_npi.3df694fd52", "test.CGOncology_MDM.not_null_mdm_customer_xref_hcp_source_code.125eb81841", "test.CGOncology_MDM.relationships_mdm_customer_xref_hcp_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_.fd7d7aed14", "test.CGOncology_MDM.relationships_mdm_customer_xref_hcp_npi__npi__ref_mdm_customer_master_hcp_.af000d17f9"], "model.CGOncology_MDM.mdm_customer_xref_hcp_hist": ["model.CGOncology_MDM.stg_hcp_bc_metrics", "test.CGOncology_MDM.accepted_values_mdm_customer_xref_hcp_hist_is_current__Y__N.1da3a07768", "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_mdm_customer_xref_hcp_hist_kmk_hcp_id__source_code__version_number.257291777b", "test.CGOncology_MDM.not_null_mdm_customer_xref_hcp_hist_kmk_hcp_id.7ec0ca69e8", "test.CGOncology_MDM.not_null_mdm_customer_xref_hcp_hist_version_number.f4744eacf4"], "model.CGOncology_MDM.mdm_customer_xref_hco_hist": ["test.CGOncology_MDM.accepted_values_mdm_customer_xref_hco_hist_is_current__Y__N.f0f38b0287", "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_mdm_customer_xref_hco_hist_kmk_hco_id__source_code__source_id__version_number.09dfa39014", "test.CGOncology_MDM.not_null_mdm_customer_xref_hco_hist_kmk_hco_id.97be341d89", "test.CGOncology_MDM.not_null_mdm_customer_xref_hco_hist_version_number.5a5057b6ac"], "model.CGOncology_MDM.mdm_best_affiliation_hist": ["model.CGOncology_MDM.adm_dh_metrics_grain", "model.CGOncology_MDM.adm_hco_master", "model.CGOncology_MDM.adm_hcp_claims_wide", "model.CGOncology_MDM.adm_hcp_master", "test.CGOncology_MDM.accepted_values_mdm_best_affiliation_hist_is_current__Y__N.115e68cd06", "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_mdm_best_affiliation_hist_npi__version_number.b205a74dfb", "test.CGOncology_MDM.not_null_mdm_best_affiliation_hist_is_current.7996664e31", "test.CGOncology_MDM.not_null_mdm_best_affiliation_hist_npi.dcaef99ecf", "test.CGOncology_MDM.not_null_mdm_best_affiliation_hist_version_number.ec106bab60", "test.CGOncology_MDM.val_path2_skip_validation"], "model.CGOncology_MDM.mdm_ref_market_definition": ["test.CGOncology_MDM.accepted_values_mdm_ref_market_definition_code_type__DX__PX__RX__Sub_category.7430203439", "test.CGOncology_MDM.not_null_mdm_ref_market_definition_code.d44466f5db", "test.CGOncology_MDM.not_null_mdm_ref_market_definition_code_type.1ea347293e"], "model.CGOncology_MDM.mdm_best_affiliation": ["model.CGOncology_MDM.mdm_best_affiliation_hist", "test.CGOncology_MDM.not_null_mdm_best_affiliation_kmk_hcp_id.50709ac5e3", "test.CGOncology_MDM.not_null_mdm_best_affiliation_mapping_rule.9c21268898", "test.CGOncology_MDM.not_null_mdm_best_affiliation_npi.09b0285e48", "test.CGOncology_MDM.relationships_mdm_best_affiliation_best_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.94418604ac", "test.CGOncology_MDM.relationships_mdm_best_affiliation_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_.14c07bfe64", "test.CGOncology_MDM.unique_mdm_best_affiliation_npi.41d120735b"], "model.CGOncology_MDM.mdm_customer_master_hcp": ["model.CGOncology_MDM.adm_dh_metrics_grain", "model.CGOncology_MDM.adm_hcp_claims_wide", "model.CGOncology_MDM.adm_hcp_master", "model.CGOncology_MDM.mdm_best_affiliation", "test.CGOncology_MDM.dbt_expectations_expect_column_value_lengths_to_be_between_mdm_customer_master_hcp_primary_specialty__100.0751b38539", "test.CGOncology_MDM.dbt_expectations_expect_column_value_lengths_to_be_between_mdm_customer_master_hcp_primary_specialty_group__100.542c204ac7", "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_mdm_customer_master_hcp_kmk_hcp_id___15_0_9_9_.a52d55a1ce", "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_mdm_customer_master_hcp_npi___0_9_10_.7145d546b1", "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_mdm_customer_master_hcp_primary_specialty___And_Or_Of_The___primary_specialty_IS_NOT_NULL.431e6cdde2", "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_mdm_customer_master_hcp_primary_specialty_____primary_specialty_IS_NOT_NULL.63e68a0e35", "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_mdm_customer_master_hcp_primary_specialty_____primary_specialty_IS_NOT_NULL.ebd4f1382a", "test.CGOncology_MDM.key_coverage_mdm_customer_master_hcp_kmk_hcp_id__kmk_hcp_id__SOURCE_CODE_DHC___ref_mdm_customer_xref_hcp_.c421076b29", "test.CGOncology_MDM.not_null_mdm_customer_master_hcp_kmk_hcp_id.9e02d8cee2", "test.CGOncology_MDM.not_null_mdm_customer_master_hcp_last_name.ea89caac8a", "test.CGOncology_MDM.not_null_mdm_customer_master_hcp_npi.08ade6922b", "test.CGOncology_MDM.relationships_adm_hcp_claims_wide_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_.a271032517", "test.CGOncology_MDM.relationships_adm_hcp_master_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_.29aa3c4a53", "test.CGOncology_MDM.relationships_adm_hcp_master_npi__npi__ref_mdm_customer_master_hcp_.c817192688", "test.CGOncology_MDM.relationships_adm_sfe_hcp_targets_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_.4ca0295145", "test.CGOncology_MDM.relationships_mdm_best_affiliation_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_.14c07bfe64", "test.CGOncology_MDM.relationships_mdm_customer_xref_hcp_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_.fd7d7aed14", "test.CGOncology_MDM.relationships_mdm_customer_xref_hcp_npi__npi__ref_mdm_customer_master_hcp_.af000d17f9", "test.CGOncology_MDM.row_count_match_adm_hcp_master_ref_mdm_customer_master_hcp_.45f3a4cae5", "test.CGOncology_MDM.unique_mdm_customer_master_hcp_kmk_hcp_id.bb0184f77e", "test.CGOncology_MDM.unique_mdm_customer_master_hcp_npi.d95c718672", "test.CGOncology_MDM.val_path2_skip_validation"], "model.CGOncology_MDM.mdm_customer_xref_hco": ["model.CGOncology_MDM.adm_ddd_metrics_grain", "model.CGOncology_MDM.adm_sfe_hco_targets", "model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.mdm_customer_xref_hco_hist", "test.CGOncology_MDM.accepted_values_mdm_customer_xref_hco_source_code__DHC__DDD__MEDSCOUT__PRACTICE_LOCATION.55e13c3ae2", "test.CGOncology_MDM.key_coverage_mdm_customer_master_hco_kmk_hco_id__kmk_hco_id__SOURCE_CODE_DHC_OR_SOURCE_CODE_DDD_AND_DH_ID_IS_NOT_NULL___ref_mdm_customer_xref_hco_.cc390e7732", "test.CGOncology_MDM.key_coverage_mdm_customer_xref_hco_source_id__dh_id__ref_std_dh_hco___SOURCE_CODE_DHC_.2474a26f9d", "test.CGOncology_MDM.not_null_mdm_customer_xref_hco_kmk_hco_id.fa70a0d10c", "test.CGOncology_MDM.not_null_mdm_customer_xref_hco_source_code.767c39c483", "test.CGOncology_MDM.not_null_mdm_customer_xref_hco_source_id.d0ee1617fe", "test.CGOncology_MDM.relationships_mdm_customer_xref_hco_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.bb9737f0e4"], "model.CGOncology_MDM.stg_hcp_hco_claims": ["model.CGOncology_MDM.stg_hcp_bc_metrics", "test.CGOncology_MDM.accepted_values_stg_hcp_hco_claims_CLAIM_TYPE__DX__PX__RX.183fef863b", "test.CGOncology_MDM.not_null_stg_hcp_hco_claims_CLAIM_TYPE.2672d69539", "test.CGOncology_MDM.not_null_stg_hcp_hco_claims_PATIENT_ID.9a0bcf8302", "test.CGOncology_MDM.not_null_stg_hcp_hco_claims_SERVICE_DATE.3a3afd17c5", "test.CGOncology_MDM.relationships_stg_hcp_hco_claims_PATIENT_ID__PATIENT_ID__ref_stg_bc_patient_pool_.8c28be3c10", "test.CGOncology_MDM.val_cb_028_treatment_category_distribution"], "model.CGOncology_MDM.stg_hcp_bc_metrics": ["model.CGOncology_MDM.adm_hco_master", "model.CGOncology_MDM.adm_hcp_master", "model.CGOncology_MDM.mdm_best_affiliation", "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_BC_BACKBONE_FLAG__Y__N.ba1821dd61", "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_BC_VOLUME_TIER__HIGH__MEDIUM__LOW__NONE.610aafdce1", "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_HAS_ACTIVITY__Y__N.2b140a4257", "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_HAS_BC_PROCEDURE_CLAIMS__Y__N.192be9057e", "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_HAS_BC_RX_CLAIMS__Y__N.b26915858b", "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_HAS_BC_TREATMENT_CLAIMS__Y__N.2df31db436", "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_HCP_CATEGORY__Urologist__BC_Treatment_Patient_Pool__BC_RX_Prescriber__Target_HCP__Activity_HCP__Total_BC_Patient_Pool.f12bf82f00", "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_IS_TARGET__Y__N.8e09f806ba", "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_IS_UROLOGIST__Y__N.62a606d1c8", "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_ADSTILADRIN_PATIENTS.c85b423b99", "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_ANKTIVA_PATIENTS.9ce93db81c", "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_BCG_PATIENTS.8b51cdd62e", "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_BC_BACKBONE_FLAG.a17b979898", "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_BC_PATIENT_COUNT.963cf7cf30", "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_BC_VOLUME_TIER.b6e432164c", "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_CYSTOSCOPY_PATIENTS.26524a772d", "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_DATA_DATE.cdf6c17b7c", "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_DX_PATIENT_COUNT.914c0df3f0", "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_HAS_ACTIVITY.360aaae1ed", "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_HAS_BC_PROCEDURE_CLAIMS.54530c687b", "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_HAS_BC_RX_CLAIMS.c66cedcecc", "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_HAS_BC_TREATMENT_CLAIMS.ad9b758830", "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_HCP_CATEGORY.b39969faec", "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_IS_TARGET.541cb9e827", "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_IS_UROLOGIST.77ceba9871", "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_KEYTRUDA_PATIENTS.11c0558b26", "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_NPI.57a8a3ff0f", "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_RX_ADSTILADRIN_PATIENTS.83317531f5", "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_RX_ANKTIVA_PATIENTS.6d08e257a9", "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_RX_BCG_PATIENTS.1b19cc04a6", "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_RX_PATIENT_COUNT.592d04ea6e", "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_TURBT_PATIENTS.70efb088e0", "test.CGOncology_MDM.unique_stg_hcp_bc_metrics_NPI.092de56925"], "model.CGOncology_MDM.stg_bc_patient_pool": ["model.CGOncology_MDM.adm_dh_metrics_grain", "model.CGOncology_MDM.adm_nmibc_risk", "model.CGOncology_MDM.stg_hcp_hco_claims", "test.CGOncology_MDM.accepted_values_stg_bc_patient_pool_IDENTIFICATION_PATHWAY_COUNT__1__2__3.59434ca4f4", "test.CGOncology_MDM.accepted_values_stg_bc_patient_pool_IDENTIFIED_VIA_DX__Y__N.1ee43ae670", "test.CGOncology_MDM.accepted_values_stg_bc_patient_pool_IDENTIFIED_VIA_PX__Y__N.70b904dc00", "test.CGOncology_MDM.accepted_values_stg_bc_patient_pool_IDENTIFIED_VIA_RX__Y__N.c11d1877c2", "test.CGOncology_MDM.accepted_values_stg_bc_patient_pool_PATIENT_GENDER__M__F__U__X.2f60f286c0", "test.CGOncology_MDM.not_null_stg_bc_patient_pool_EARLIEST_BC_EVENT_DATE.1d286cde6b", "test.CGOncology_MDM.not_null_stg_bc_patient_pool_IDENTIFICATION_PATHWAY_COUNT.3ed02c7eac", "test.CGOncology_MDM.not_null_stg_bc_patient_pool_IDENTIFIED_VIA_DX.259ef11f32", "test.CGOncology_MDM.not_null_stg_bc_patient_pool_IDENTIFIED_VIA_PX.3936f0c36d", "test.CGOncology_MDM.not_null_stg_bc_patient_pool_IDENTIFIED_VIA_RX.a4f6073e8a", "test.CGOncology_MDM.not_null_stg_bc_patient_pool_LATEST_BC_EVENT_DATE.f0a01e8ad2", "test.CGOncology_MDM.not_null_stg_bc_patient_pool_PATIENT_ID.d047ac8e90", "test.CGOncology_MDM.not_null_stg_bc_patient_pool_TOTAL_BC_CLAIM_COUNT.256c214c05", "test.CGOncology_MDM.relationships_stg_hcp_hco_claims_PATIENT_ID__PATIENT_ID__ref_stg_bc_patient_pool_.8c28be3c10", "test.CGOncology_MDM.unique_stg_bc_patient_pool_PATIENT_ID.38ad9d6549", "test.CGOncology_MDM.val_cb_026_patient_pool_consolidation", "test.CGOncology_MDM.val_path2_skip_validation"], "model.CGOncology_MDM.match_ddd_dhc": ["model.CGOncology_MDM.adm_ddd_metrics_grain", "model.CGOncology_MDM.mdm_customer_xref_hco", "test.CGOncology_MDM.accepted_values_match_ddd_dhc_CONFIDENCE_LEVEL__HIGH__MEDIUM__STEWARD__HISTORICAL.690cc051c1", "test.CGOncology_MDM.accepted_values_match_ddd_dhc_DHC_MATCH_SOURCE__Practice_Location__HQ_Location__City_State_Fallback__Medscout_Bridge__DH_Matching_Return__Legacy_History__XREF_History.e46667f474", "test.CGOncology_MDM.accepted_values_match_ddd_dhc_MATCH_BUCKET__0__1__2__3__4.a27fe795cf", "test.CGOncology_MDM.accepted_values_match_ddd_dhc_MATCH_STATUS__MATCHED__UNMATCHED.623af1049a", "test.CGOncology_MDM.accepted_values_match_ddd_dhc_MATCH_STEP__0__1__2__3__4.029afef2fa", "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_be_between_match_ddd_dhc_ADDRESS_MATCH_SCORE__100__0.59ba604c8c", "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_be_between_match_ddd_dhc_NAME_MATCH_SCORE__100__0.ba2d1026eb", "test.CGOncology_MDM.not_null_match_ddd_dhc_DDD_OUTLET_ID.9431d55a7f", "test.CGOncology_MDM.not_null_match_ddd_dhc_DDD_OUTLET_NAME.cf75f8fcd7", "test.CGOncology_MDM.not_null_match_ddd_dhc_IS_DELTA.14815dedb4", "test.CGOncology_MDM.not_null_match_ddd_dhc_IS_HISTORICAL_MATCH.d9bf2310fd", "test.CGOncology_MDM.not_null_match_ddd_dhc_MATCH_STATUS.50e40ba959", "test.CGOncology_MDM.unique_match_ddd_dhc_DDD_OUTLET_ID.fcadb410cf"], "model.CGOncology_MDM.match_medscout_dhc_hcp": ["model.CGOncology_MDM.mdm_customer_xref_hcp", "test.CGOncology_MDM.accepted_values_match_medscout_dhc_hcp_MATCH_STATUS__MATCHED__UNMATCHED.b9609b5d31", "test.CGOncology_MDM.accepted_values_match_medscout_dhc_hcp_MATCH_TYPE__NPI_EXACT.b0e6786039", "test.CGOncology_MDM.not_null_match_medscout_dhc_hcp_IS_DELTA.62a95babd1", "test.CGOncology_MDM.not_null_match_medscout_dhc_hcp_IS_HISTORICAL_MATCH.e1fe9b7c05", "test.CGOncology_MDM.not_null_match_medscout_dhc_hcp_MATCH_DATE.132412ad64", "test.CGOncology_MDM.not_null_match_medscout_dhc_hcp_MATCH_STATUS.58d977e8e9", "test.CGOncology_MDM.not_null_match_medscout_dhc_hcp_MEDSCOUT_ID.f3c6209b8f", "test.CGOncology_MDM.not_null_match_medscout_dhc_hcp_NPI.1d48ccd718", "test.CGOncology_MDM.unique_match_medscout_dhc_hcp_MEDSCOUT_ID.a4ddb83f70"], "model.CGOncology_MDM.adm_sfe_hcp_targets": ["test.CGOncology_MDM.accepted_values_adm_sfe_hcp_targets_kam_decile__1__2__3__4__5__6__7__8__9__10.acc477934d", "test.CGOncology_MDM.accepted_values_adm_sfe_hcp_targets_kam_target_flag__Y__N.b025c684ba", "test.CGOncology_MDM.not_null_adm_sfe_hcp_targets_kmk_hcp_id.343a5058c2", "test.CGOncology_MDM.relationships_adm_sfe_hcp_targets_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_.4ca0295145", "test.CGOncology_MDM.unique_adm_sfe_hcp_targets_kmk_hcp_id.b80969407d"], "model.CGOncology_MDM.adm_sfe_hco_targets": ["test.CGOncology_MDM.accepted_values_adm_sfe_hco_targets_hsd_target_flag__Y__N.276ace2e5a", "test.CGOncology_MDM.accepted_values_adm_sfe_hco_targets_kam_child_target_flag__Y__N.fafd69b0be", "test.CGOncology_MDM.accepted_values_adm_sfe_hco_targets_kam_network_target_flag__Y__N.5d3ad1f11a", "test.CGOncology_MDM.accepted_values_adm_sfe_hco_targets_msl_target_flag__Y__N.0e207c3aaa", "test.CGOncology_MDM.not_null_adm_sfe_hco_targets_kmk_hco_id.5878b9508f", "test.CGOncology_MDM.relationships_adm_sfe_hco_targets_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.07e79ca121", "test.CGOncology_MDM.unique_adm_sfe_hco_targets_kmk_hco_id.de0c13379d"], "model.CGOncology_MDM.hcp_decile": ["test.CGOncology_MDM.accepted_values_hcp_decile_DECILE__1__2__3__4__5__6__7__8__9__10.113157d98c", "test.CGOncology_MDM.not_null_hcp_decile_COMPOSITE_SCORE.1570178381", "test.CGOncology_MDM.not_null_hcp_decile_DECILE.4053a88425", "test.CGOncology_MDM.not_null_hcp_decile_NPI.e208cb8767", "test.CGOncology_MDM.not_null_hcp_decile_STANDARDIZED_BCG_CLAIMS.dd05c0a210", "test.CGOncology_MDM.not_null_hcp_decile_STANDARDIZED_TOTAL_PATIENTS.ee7998a705", "test.CGOncology_MDM.not_null_hcp_decile_STANDARDIZED_TURBT_CLAIMS.80c23eabcf", "test.CGOncology_MDM.not_null_hcp_decile_TIME_PERIOD.f5eac4fc6a", "test.CGOncology_MDM.test_cumulative_decile_boundaries", "test.CGOncology_MDM.test_decile_score_distribution", "test.CGOncology_MDM.test_standardization_bounds", "test.CGOncology_MDM.test_weighted_score_formula", "test.CGOncology_MDM.unique_hcp_decile_NPI.9eca6ac110"], "model.CGOncology_MDM.adm_sfe_zip_alignment": ["model.CGOncology_MDM.std_zip_territory", "test.CGOncology_MDM.not_null_adm_sfe_zip_alignment_zip_code.650f602114", "test.CGOncology_MDM.unique_adm_sfe_zip_alignment_zip_code.d5a56b576f"], "model.CGOncology_MDM.stg_sfe_targets": ["model.CGOncology_MDM.adm_sfe_hco_targets", "model.CGOncology_MDM.adm_sfe_hcp_targets", "test.CGOncology_MDM.accepted_values_stg_sfe_targets_entity_type__HCO__HCP.e4003662ec", "test.CGOncology_MDM.accepted_values_stg_sfe_targets_target_type__KAM_NETWORK__KAM_CHILD__HSD__HCP_TARGET__MSL_TARGET.19afec1207", "test.CGOncology_MDM.not_null_stg_sfe_targets_entity_id.c065cd9d0a", "test.CGOncology_MDM.not_null_stg_sfe_targets_entity_type.8082c3d2af", "test.CGOncology_MDM.not_null_stg_sfe_targets_target_flag.02d4b9155f", "test.CGOncology_MDM.not_null_stg_sfe_targets_target_type.6d0a8711b5"], "model.CGOncology_MDM.adm_sfe_geographies": ["test.CGOncology_MDM.accepted_values_adm_sfe_geographies_geo_type__TERRITORY__REGION__NATION.b2998d82da", "test.CGOncology_MDM.accepted_values_adm_sfe_geographies_team__KAM__HSD__MSL__PAYOR.d41f96ee2a", "test.CGOncology_MDM.not_null_adm_sfe_geographies_geo_code.3bf1753026", "test.CGOncology_MDM.not_null_adm_sfe_geographies_geo_name.4bc8946e84", "test.CGOncology_MDM.not_null_adm_sfe_geographies_geo_type.ac40d5904e", "test.CGOncology_MDM.unique_adm_sfe_geographies_geo_code.2eea9dd057"], "model.CGOncology_MDM.std_dh_hco": ["model.CGOncology_MDM.match_ddd_dhc", "model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.mdm_customer_xref_hco", "model.CGOncology_MDM.std_dh_hco_hist", "model.CGOncology_MDM.std_dh_practice_location_hist", "test.CGOncology_MDM.accepted_values_std_dh_hco_hq_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY__DC__PR__VI__GU__AS__MP.22828f4652", "test.CGOncology_MDM.dbt_expectations_expect_column_value_lengths_to_be_between_std_dh_hco_normalized_org_name__2.5f688cf1f4", "test.CGOncology_MDM.dbt_expectations_expect_column_value_lengths_to_be_between_std_dh_hco_source_hash__64__64.524a96ddc2", "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_dh_hco_hq_address_line_1___a_z___hq_address_line_1_IS_NOT_NULL.027089ef29", "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_dh_hco_hq_city___a_z___hq_city_IS_NOT_NULL.be52dcc2b8", "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_dh_hco_hq_zip_code___0_9_5___hq_zip_code_IS_NOT_NULL.53831fcfe7", "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_std_dh_hco_dh_id___0.c014a1da7b", "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_std_dh_hco_hq_address_line_1_____hq_address_line_1_IS_NOT_NULL.bb2ad3576e", "test.CGOncology_MDM.dbt_expectations_expect_table_row_count_to_be_between_std_dh_hco_300000.3c0c96a031", "test.CGOncology_MDM.key_coverage_mdm_customer_xref_hco_source_id__dh_id__ref_std_dh_hco___SOURCE_CODE_DHC_.2474a26f9d", "test.CGOncology_MDM.not_null_std_dh_hco_dh_id.155e4b5801", "test.CGOncology_MDM.not_null_std_dh_hco_source_hash.c5c2443af6", "test.CGOncology_MDM.row_count_match_std_dh_hco_source_raw_dh_PRELAND_DH_ALL_COMPANIES_OVERVIEW_.8f7f1522b5", "test.CGOncology_MDM.unique_std_dh_hco_dh_id.c89c925785"], "model.CGOncology_MDM.std_ddd_sales": ["model.CGOncology_MDM.adm_ddd_metrics_grain", "model.CGOncology_MDM.std_ddd_sales_hist", "test.CGOncology_MDM.accepted_values_std_ddd_sales_product_name__ADSTILADRIN__ANKTIVA__TICE_BCG__INLEXZO__OTHER.bd0919193d", "test.CGOncology_MDM.not_null_std_ddd_sales_ddd_outlet_id.d18206dc26", "test.CGOncology_MDM.not_null_std_ddd_sales_product_group_id.28e5d2f6ee", "test.CGOncology_MDM.row_count_match_std_ddd_sales_DDD_OUTLET_NUMBER_IS_NOT_NULL_AND_PRODUCT_GROUP_ID_IS_NOT_NULL__source_raw_ddd_PRELAND_DDD_SALES_.e723d1ef6c"], "model.CGOncology_MDM.std_dh_hco_hist": ["test.CGOncology_MDM.accepted_values_std_dh_hco_hist_is_active__Y__N.b27d95e392", "test.CGOncology_MDM.accepted_values_std_dh_hco_hist_is_current__Y__N.4e0f166b09", "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_hco_hist_dh_id__version_number.23ca9667d1", "test.CGOncology_MDM.not_null_std_dh_hco_hist_dh_id.7937f17fc0", "test.CGOncology_MDM.not_null_std_dh_hco_hist_is_active.131197f8f7", "test.CGOncology_MDM.not_null_std_dh_hco_hist_is_current.7ddaa82390", "test.CGOncology_MDM.not_null_std_dh_hco_hist_version_number.7c4e6114b5"], "model.CGOncology_MDM.std_rx_claims": ["model.CGOncology_MDM.adm_dh_metrics_grain", "model.CGOncology_MDM.std_rx_bc_patients", "model.CGOncology_MDM.stg_hcp_hco_claims", "test.CGOncology_MDM.accepted_values_std_rx_claims_PATIENT_GENDER__M__F__U__X.0e6fac2fd6", "test.CGOncology_MDM.accepted_values_std_rx_claims_TREATMENT_CATEGORY__TICE_BCG__ADSTILADRIN__ANKTIVA__OTHER_PROCEDURES.236093b5b7", "test.CGOncology_MDM.not_null_std_rx_claims_FILL_DATE.70a2e61aad", "test.CGOncology_MDM.not_null_std_rx_claims_NDC11.1bfec2ed95", "test.CGOncology_MDM.not_null_std_rx_claims_PATIENT_ID.465afae066", "test.CGOncology_MDM.not_null_std_rx_claims_RX_CLAIM_ID.bf79ee906e", "test.CGOncology_MDM.qc_date_ranges", "test.CGOncology_MDM.val_cb_025_code_mapping_coverage", "test.CGOncology_MDM.val_cb_029_code_mapping_completeness", "test.CGOncology_MDM.val_path2_skip_validation"], "model.CGOncology_MDM.std_dh_hcp_hist": ["model.CGOncology_MDM.mdm_best_affiliation", "model.CGOncology_MDM.stg_hcp_bc_metrics", "test.CGOncology_MDM.accepted_values_std_dh_hcp_hist_is_active__Y__N.882f8b924d", "test.CGOncology_MDM.accepted_values_std_dh_hcp_hist_is_current__Y__N.4648d155b9", "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_hcp_hist_npi__version_number.dbfe70f933", "test.CGOncology_MDM.not_null_std_dh_hcp_hist_is_active.e041856ff2", "test.CGOncology_MDM.not_null_std_dh_hcp_hist_is_current.1974f68cf0", "test.CGOncology_MDM.not_null_std_dh_hcp_hist_npi.019b3d8523", "test.CGOncology_MDM.not_null_std_dh_hcp_hist_version_number.855d421cee"], "model.CGOncology_MDM.std_dx_claims": ["model.CGOncology_MDM.adm_dh_metrics_grain", "model.CGOncology_MDM.adm_hco_nmibc_metrics", "model.CGOncology_MDM.adm_nmibc_risk", "model.CGOncology_MDM.mdm_best_affiliation", "model.CGOncology_MDM.std_dx_bc_patients", "model.CGOncology_MDM.stg_hcp_hco_claims", "test.CGOncology_MDM.accepted_values_std_dx_claims_PATIENT_GENDER__M__F__U__X.15a4bb0c64", "test.CGOncology_MDM.accepted_values_std_dx_claims_TREATMENT_CATEGORY__BC_DIAGNOSIS.fc5d7f855e", "test.CGOncology_MDM.not_null_std_dx_claims_DIAGNOSIS_CODE.eb269d8bef", "test.CGOncology_MDM.not_null_std_dx_claims_MX_CLAIM_ID.2533d41622", "test.CGOncology_MDM.not_null_std_dx_claims_PATIENT_ID.f957d7d8f1", "test.CGOncology_MDM.not_null_std_dx_claims_SERVICE_DATE.9235ca5535", "test.CGOncology_MDM.qc_date_ranges", "test.CGOncology_MDM.val_cb_025_code_mapping_coverage", "test.CGOncology_MDM.val_cb_029_code_mapping_completeness", "test.CGOncology_MDM.val_cb_030_new_code_detection", "test.CGOncology_MDM.val_path2_skip_validation"], "model.CGOncology_MDM.std_dh_hcp_hco_affiliation_hist": ["test.CGOncology_MDM.accepted_values_std_dh_hcp_hco_affiliation_hist_is_current__Y__N.1017a9ee9d", "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_hcp_hco_affiliation_hist_npi__affiliated_id__version_number.e5ea84e2ec", "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_hist_affiliated_id.9b572d258d", "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_hist_is_current.37f0597c4a", "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_hist_npi.28b5fbc518", "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_hist_version_number.e994c81d25"], "model.CGOncology_MDM.std_medscout_hcp": ["model.CGOncology_MDM.match_medscout_dhc_hcp", "model.CGOncology_MDM.mdm_customer_xref_hcp", "model.CGOncology_MDM.std_medscout_hcp_hist", "model.CGOncology_MDM.stg_hcp_bc_metrics", "test.CGOncology_MDM.not_null_std_medscout_hcp_last_name.32a63aaea7", "test.CGOncology_MDM.not_null_std_medscout_hcp_medscout_id.24a1ca994e", "test.CGOncology_MDM.not_null_std_medscout_hcp_npi.77f3adaf1e", "test.CGOncology_MDM.row_count_match_std_medscout_hcp_NPI_IS_NOT_NULL__source_raw_medscout_PRELAND_MEDSCOUT_HCP_DATA_.c13864403f", "test.CGOncology_MDM.unique_std_medscout_hcp_medscout_id.48cf6c0773"], "model.CGOncology_MDM.std_dx_bc_patients": ["model.CGOncology_MDM.stg_bc_patient_pool", "test.CGOncology_MDM.accepted_values_std_dx_bc_patients_IDENTIFICATION_SOURCE__DX.d52ce05901", "test.CGOncology_MDM.not_null_std_dx_bc_patients_EARLIEST_DX_DATE.9511ca689b", "test.CGOncology_MDM.not_null_std_dx_bc_patients_PATIENT_ID.5f1553fb03", "test.CGOncology_MDM.unique_std_dx_bc_patients_PATIENT_ID.2b164dce90", "test.CGOncology_MDM.val_cb_025_code_mapping_coverage", "test.CGOncology_MDM.val_cb_026_patient_pool_consolidation"], "model.CGOncology_MDM.std_px_bc_patients": ["model.CGOncology_MDM.stg_bc_patient_pool", "test.CGOncology_MDM.accepted_values_std_px_bc_patients_IDENTIFICATION_SOURCE__PX.52f2870006", "test.CGOncology_MDM.not_null_std_px_bc_patients_EARLIEST_PX_DATE.afa0f2a8ce", "test.CGOncology_MDM.not_null_std_px_bc_patients_PATIENT_ID.58b2a57a43", "test.CGOncology_MDM.unique_std_px_bc_patients_PATIENT_ID.e2e20292bd", "test.CGOncology_MDM.val_cb_025_code_mapping_coverage", "test.CGOncology_MDM.val_cb_026_patient_pool_consolidation"], "model.CGOncology_MDM.std_dh_hcp_hco_affiliation": ["model.CGOncology_MDM.mdm_best_affiliation", "model.CGOncology_MDM.std_dh_hcp_hco_affiliation_hist", "test.CGOncology_MDM.accepted_values_std_dh_hcp_hco_affiliation_affiliation_type__CURRENT__HISTORICAL.c5017b3e1e", "test.CGOncology_MDM.accepted_values_std_dh_hcp_hco_affiliation_is_current__True__False.133669a192", "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_hcp_hco_affiliation_npi__affiliated_dh_id.59c0275aa4", "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_affiliated_dh_id.d792350727", "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_is_current.55af4662bf", "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_npi.980d3a3d64", "test.CGOncology_MDM.row_count_match_std_dh_hcp_hco_affiliation_NPI_IS_NOT_NULL_AND_AFFILIATED_ID_IS_NOT_NULL_AND_TRIM_CAST_AFFILIATED_ID_AS_VARCHAR_50___source_raw_dh_PRELAND_DH_PHYSICIANS_FACILITY_AFFILIATION_.b965d97151"], "model.CGOncology_MDM.std_ddd_hco": ["model.CGOncology_MDM.adm_ddd_metrics_grain", "model.CGOncology_MDM.match_ddd_dhc", "model.CGOncology_MDM.mdm_customer_xref_hco", "model.CGOncology_MDM.std_ddd_hco_hist", "test.CGOncology_MDM.accepted_values_std_ddd_hco_class_of_trade__CLINICS__HOSPITALS__CHAIN__INDEPENDENT__NURSING_HOME__HEALTH_CARE_PLAN__MAIL_SERVICE__MISCELLANEOUS__FOODSTORE__MASS_MERCHANDISER__N_A__UNKNOWN.f93e3e0083", "test.CGOncology_MDM.accepted_values_std_ddd_hco_is_supply_chain_excluded__True__False.a885c0891c", "test.CGOncology_MDM.accepted_values_std_ddd_hco_is_zip_excluded__True__False.39c820062c", "test.CGOncology_MDM.accepted_values_std_ddd_hco_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY__DC__PR__VI__GU__AS__MP.1e74911fad", "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_ddd_hco_ddd_outlet_name___a_z___ddd_outlet_name_IS_NOT_NULL.35cba45a91", "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_ddd_hco_zip_code___0_9_5___zip_code_IS_NOT_NULL.b2c4f2e2df", "test.CGOncology_MDM.not_null_std_ddd_hco_class_of_trade.966b717e30", "test.CGOncology_MDM.not_null_std_ddd_hco_ddd_outlet_id.1b0484230f", "test.CGOncology_MDM.not_null_std_ddd_hco_is_supply_chain_excluded.0e5299adc6", "test.CGOncology_MDM.not_null_std_ddd_hco_is_zip_excluded.c6559e9806", "test.CGOncology_MDM.unique_std_ddd_hco_ddd_outlet_id.c70c0abdc6"], "model.CGOncology_MDM.std_ddd_hco_hist": ["test.CGOncology_MDM.accepted_values_std_ddd_hco_hist_is_active__Y__N.228110045d", "test.CGOncology_MDM.accepted_values_std_ddd_hco_hist_is_current__Y__N.3cc9ac69ad", "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_ddd_hco_hist_ddd_outlet_id__version_number.3ed056f0fc", "test.CGOncology_MDM.not_null_std_ddd_hco_hist_ddd_outlet_id.9edec51303", "test.CGOncology_MDM.not_null_std_ddd_hco_hist_is_active.d1163cfd85", "test.CGOncology_MDM.not_null_std_ddd_hco_hist_is_current.3ab5dde3a4", "test.CGOncology_MDM.not_null_std_ddd_hco_hist_version_number.f697601dc5"], "model.CGOncology_MDM.std_medscout_hco_hist": ["test.CGOncology_MDM.accepted_values_std_medscout_hco_hist_is_active__Y__N.9be0124c5d", "test.CGOncology_MDM.accepted_values_std_medscout_hco_hist_is_current__Y__N.1b6303c595", "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_medscout_hco_hist_medscout_id__version_number.f5a93c52f3", "test.CGOncology_MDM.not_null_std_medscout_hco_hist_is_active.97ee31c0e1", "test.CGOncology_MDM.not_null_std_medscout_hco_hist_is_current.c89f159e10", "test.CGOncology_MDM.not_null_std_medscout_hco_hist_medscout_id.32eb6a182a", "test.CGOncology_MDM.not_null_std_medscout_hco_hist_version_number.6fcd0d9465"], "model.CGOncology_MDM.std_zip_territory": ["model.CGOncology_MDM.adm_sfe_geographies"], "model.CGOncology_MDM.std_dh_practice_location": ["model.CGOncology_MDM.std_dh_practice_location_hist", "test.CGOncology_MDM.accepted_values_std_dh_practice_location_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY__DC__PR__VI__GU__AS__MP.4b60111d92", "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_dh_practice_location_address_line_1___a_z___address_line_1_IS_NOT_NULL.7604558e84", "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_dh_practice_location_zip_code___0_9_5___zip_code_IS_NOT_NULL.08e160408e", "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_std_dh_practice_location_address_line_1_____address_line_1_IS_NOT_NULL.d38c4fa34d", "test.CGOncology_MDM.not_null_std_dh_practice_location_practice_location_id.87970307c4", "test.CGOncology_MDM.not_null_std_dh_practice_location_unique_combined_key.c6f3a69f42", "test.CGOncology_MDM.row_count_match_std_dh_practice_location_PRACTICE_LOCATION_ID_IS_NOT_NULL__source_raw_dh_PRELAND_DH_PHYSICIAN_GROUP_PRACTICE_LOCATION_.176238d91c", "test.CGOncology_MDM.unique_std_dh_practice_location_practice_location_id.d81b4d0eeb"], "model.CGOncology_MDM.std_dh_facility_to_facility_affiliation": ["model.CGOncology_MDM.std_dh_facility_to_facility_affiliation_hist", "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_facility_to_facility_affiliation_dh_id__affiliated_id.8ff632a963", "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_affiliated_id.41b2bd78b8", "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_dh_id.c15863164f", "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_source_hash.0bd14f03fe"], "model.CGOncology_MDM.std_medscout_hcp_hist": ["test.CGOncology_MDM.accepted_values_std_medscout_hcp_hist_is_active__Y__N.927a3159c2", "test.CGOncology_MDM.accepted_values_std_medscout_hcp_hist_is_current__Y__N.cf3bdfa364", "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_medscout_hcp_hist_medscout_id__version_number.2807cc00e5", "test.CGOncology_MDM.not_null_std_medscout_hcp_hist_is_active.119b7dfec8", "test.CGOncology_MDM.not_null_std_medscout_hcp_hist_is_current.e6054c50ee", "test.CGOncology_MDM.not_null_std_medscout_hcp_hist_medscout_id.0e8f48d476", "test.CGOncology_MDM.not_null_std_medscout_hcp_hist_version_number.be260d61c7"], "model.CGOncology_MDM.std_rx_bc_patients": ["model.CGOncology_MDM.stg_bc_patient_pool", "test.CGOncology_MDM.accepted_values_std_rx_bc_patients_IDENTIFICATION_SOURCE__RX.8755a20de4", "test.CGOncology_MDM.not_null_std_rx_bc_patients_EARLIEST_RX_DATE.6fcf09063b", "test.CGOncology_MDM.not_null_std_rx_bc_patients_PATIENT_ID.71727e35f0", "test.CGOncology_MDM.unique_std_rx_bc_patients_PATIENT_ID.02957e8bb5", "test.CGOncology_MDM.val_cb_025_code_mapping_coverage", "test.CGOncology_MDM.val_cb_026_patient_pool_consolidation"], "model.CGOncology_MDM.std_dh_hcp": ["model.CGOncology_MDM.match_medscout_dhc_hcp", "model.CGOncology_MDM.mdm_customer_xref_hcp", "model.CGOncology_MDM.std_dh_hcp_hco_affiliation_hist", "model.CGOncology_MDM.std_dh_hcp_hist", "model.CGOncology_MDM.stg_hcp_bc_metrics", "test.CGOncology_MDM.accepted_values_std_dh_hcp_practice_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY__DC__PR__VI__GU__AS__MP__NS__PH.cc7ab9603a", "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_dh_hcp_npi___0_9_10_.f3ce611aa7", "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_std_dh_hcp_first_name_____first_name_IS_NOT_NULL.d2932f7c96", "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_std_dh_hcp_last_name_____last_name_IS_NOT_NULL.1257101c2c", "test.CGOncology_MDM.key_coverage_mdm_customer_xref_hcp_source_id__npi__ref_std_dh_hcp___SOURCE_CODE_DHC_.1ea045b04f", "test.CGOncology_MDM.not_null_std_dh_hcp_last_name.4a4b23e2b8", "test.CGOncology_MDM.not_null_std_dh_hcp_npi.f78527bf39", "test.CGOncology_MDM.row_count_match_std_dh_hcp_NPI_IS_NOT_NULL__source_raw_dh_PRELAND_DH_PHYSICIANS_OVERVIEW_.396fdde72a", "test.CGOncology_MDM.unique_std_dh_hcp_npi.3d97c53efa"], "model.CGOncology_MDM.std_ddd_sales_hist": ["test.CGOncology_MDM.not_null_std_ddd_sales_hist_ddd_outlet_id.aae4b0d159"], "model.CGOncology_MDM.std_dh_practice_location_hist": ["model.CGOncology_MDM.match_ddd_dhc", "model.CGOncology_MDM.mdm_customer_master_hco", "model.CGOncology_MDM.mdm_customer_xref_hco", "test.CGOncology_MDM.accepted_values_std_dh_practice_location_hist_is_current__Y__N.97ab5347ed", "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_practice_location_hist_kmk_pl_id__version_number.8e31476c9a", "test.CGOncology_MDM.not_null_std_dh_practice_location_hist_is_current.85bf5428f8", "test.CGOncology_MDM.not_null_std_dh_practice_location_hist_kmk_pl_id.13975dc992", "test.CGOncology_MDM.not_null_std_dh_practice_location_hist_version_number.ca12478fce"], "model.CGOncology_MDM.std_px_claims": ["model.CGOncology_MDM.adm_dh_metrics_grain", "model.CGOncology_MDM.adm_hco_nmibc_metrics", "model.CGOncology_MDM.adm_nmibc_risk", "model.CGOncology_MDM.mdm_best_affiliation", "model.CGOncology_MDM.std_px_bc_patients", "model.CGOncology_MDM.stg_hcp_hco_claims", "test.CGOncology_MDM.accepted_values_std_px_claims_PATIENT_GENDER__M__F__U__X.8c1d91c8d7", "test.CGOncology_MDM.accepted_values_std_px_claims_PROCEDURE_CODE_TYPE__CPTHCPCS__ICD10PROC.5ab255ec5c", "test.CGOncology_MDM.accepted_values_std_px_claims_TREATMENT_CATEGORY__TURBT__TICE_BCG__ADSTILADRIN__ANKTIVA__CYSTOSCOPY__KEYTRUDA__OTHER_PROCEDURES.49a71a7de5", "test.CGOncology_MDM.not_null_std_px_claims_PATIENT_ID.bee2b9e04e", "test.CGOncology_MDM.not_null_std_px_claims_PX_CLAIM_ID.ee2882f522", "test.CGOncology_MDM.not_null_std_px_claims_SERVICE_DATE.1002e03153", "test.CGOncology_MDM.qc_date_ranges", "test.CGOncology_MDM.val_cb_025_code_mapping_coverage", "test.CGOncology_MDM.val_cb_029_code_mapping_completeness", "test.CGOncology_MDM.val_cb_030_new_code_detection", "test.CGOncology_MDM.val_path2_skip_validation"], "model.CGOncology_MDM.std_dh_facility_to_facility_affiliation_hist": ["model.CGOncology_MDM.adm_hco_hierarchy", "test.CGOncology_MDM.accepted_values_std_dh_facility_to_facility_affiliation_hist_is_current__Y__N.6d0529eaa0", "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_facility_to_facility_affiliation_hist_dh_id__affiliated_id__version_number.6a1c689fcc", "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_hist_affiliated_id.e6f7b4617d", "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_hist_dh_id.c1156c613e", "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_hist_is_current.5b8241a75f", "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_hist_version_number.03382a4b79"], "model.CGOncology_MDM.std_medscout_hco": ["model.CGOncology_MDM.mdm_customer_xref_hco", "model.CGOncology_MDM.std_medscout_hco_hist", "test.CGOncology_MDM.not_null_std_medscout_hco_medscout_id.b291b23043", "test.CGOncology_MDM.not_null_std_medscout_hco_npi.f5cc69b5b3", "test.CGOncology_MDM.row_count_match_std_medscout_hco_NPI_IS_NOT_NULL__source_raw_medscout_PRELAND_MEDSCOUT_HCO_DATA_.bef7505a83", "test.CGOncology_MDM.unique_std_medscout_hco_medscout_id.a77c97f5fa"], "model.CGOncology_MDM.adm_lowest_level_metrics": ["test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_adm_lowest_level_metrics_kmk_hco_id__metric_category__metric_code__period_key.98b6841877", "test.CGOncology_MDM.not_null_adm_lowest_level_metrics_kmk_hco_id.55b4f59cf8", "test.CGOncology_MDM.not_null_adm_lowest_level_metrics_metric_category.70e347ae8a", "test.CGOncology_MDM.not_null_adm_lowest_level_metrics_metric_code.b05b2de93c", "test.CGOncology_MDM.not_null_adm_lowest_level_metrics_period_key.580102b640", "test.CGOncology_MDM.relationships_adm_lowest_level_metrics_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.a9076ad74b"], "model.CGOncology_MDM.adm_address_best_ddd_metrics_long": ["model.CGOncology_MDM.adm_address_best_ddd_metrics_wide", "test.CGOncology_MDM.accepted_values_adm_address_best_ddd_metrics_long_entity_type__ADDRESS_BEST_HCO.76d303acb5", "test.CGOncology_MDM.accepted_values_adm_address_best_ddd_metrics_long_metric_category__TICE_BCG__ADSTILADRIN__ANKTIVA__INLEXZO__TOTAL_BRANDED__TOTAL__OTHER.c8ce60c168", "test.CGOncology_MDM.not_null_adm_address_best_ddd_metrics_long_entity_id.dc95135281", "test.CGOncology_MDM.not_null_adm_address_best_ddd_metrics_long_entity_type.bbb73a3e00", "test.CGOncology_MDM.not_null_adm_address_best_ddd_metrics_long_metric_category.d523793836", "test.CGOncology_MDM.not_null_adm_address_best_ddd_metrics_long_period_key.10fec1acd6"], "model.CGOncology_MDM.ref_time_periods": ["model.CGOncology_MDM.adm_address_best_ddd_metrics_long", "model.CGOncology_MDM.adm_address_best_ddd_metrics_wide", "model.CGOncology_MDM.adm_address_best_hco_metrics_long", "model.CGOncology_MDM.adm_address_best_hco_metrics_wide", "model.CGOncology_MDM.adm_claims_metrics_by_payor", "model.CGOncology_MDM.adm_claims_metrics_long", "model.CGOncology_MDM.adm_ddd_metrics_long", "model.CGOncology_MDM.adm_ddd_metrics_wide", "model.CGOncology_MDM.adm_hco_claims_wide", "model.CGOncology_MDM.adm_hco_hierarchy", "model.CGOncology_MDM.adm_hco_master", "model.CGOncology_MDM.adm_hco_nmibc_metrics", "model.CGOncology_MDM.adm_hcp_claims_wide", "model.CGOncology_MDM.adm_lowest_level_metrics", "test.CGOncology_MDM.accepted_values_ref_time_periods_period_type__MONTHLY__QUARTERLY__ROLLING__YTD__QTD__PY__PYTD__P2Y__CALENDAR_YEAR__LTD__TOTAL.5af4e4a14b", "test.CGOncology_MDM.not_null_ref_time_periods_period_key.a9e994cf12", "test.CGOncology_MDM.not_null_ref_time_periods_period_type.5eeae962e8", "test.CGOncology_MDM.unique_ref_time_periods_period_key.557cb7d317"], "model.CGOncology_MDM.adm_pipeline_diff": ["test.CGOncology_MDM.accepted_values_adm_pipeline_diff_severity__CRITICAL__WARNING__INFO__OK.5092607787"], "model.CGOncology_MDM.adm_nmibc_risk": ["model.CGOncology_MDM.adm_hco_nmibc_metrics", "test.CGOncology_MDM.accepted_values_adm_nmibc_risk_nmibc_risk_tier__HIGH__INTERMEDIATE__LOW.ea5c66bfb9", "test.CGOncology_MDM.not_null_adm_nmibc_risk_nmibc_risk_tier.d7a1407372", "test.CGOncology_MDM.not_null_adm_nmibc_risk_patient_id.fab493a5d5", "test.CGOncology_MDM.unique_adm_nmibc_risk_patient_id.0f914ec428"], "model.CGOncology_MDM.adm_hcp_master": ["model.CGOncology_MDM.adm_hco_master", "test.CGOncology_MDM.accepted_values_adm_hcp_master_cust_backbone_flag__Y__N.c77ea1fe72", "test.CGOncology_MDM.accepted_values_adm_hcp_master_kam_decile__1__2__3__4__5__6__7__8__9__10.756fdeacaf", "test.CGOncology_MDM.accepted_values_adm_hcp_master_kam_target_flag__Y__N.64ee4b29c7", "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_adm_hcp_master_kmk_hcp_id___15_0_9_9_.0f016d3772", "test.CGOncology_MDM.not_null_adm_hcp_master_cust_backbone_flag.aae912f453", "test.CGOncology_MDM.not_null_adm_hcp_master_kmk_hcp_id.9fed89113c", "test.CGOncology_MDM.not_null_adm_hcp_master_npi.b8c1e61554", "test.CGOncology_MDM.relationships_adm_hcp_master_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_.29aa3c4a53", "test.CGOncology_MDM.relationships_adm_hcp_master_npi__npi__ref_mdm_customer_master_hcp_.c817192688", "test.CGOncology_MDM.row_count_match_adm_hcp_master_ref_mdm_customer_master_hcp_.45f3a4cae5", "test.CGOncology_MDM.unique_adm_hcp_master_kmk_hcp_id.3250d72e22"], "model.CGOncology_MDM.adm_ddd_metrics_wide": ["model.CGOncology_MDM.adm_hco_master", "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_adm_ddd_metrics_wide_kmk_hco_id__metric_category.95bbc51f56", "test.CGOncology_MDM.not_null_adm_ddd_metrics_wide_kmk_hco_id.eb1befe131", "test.CGOncology_MDM.not_null_adm_ddd_metrics_wide_metric_category.5264fc27ec", "test.CGOncology_MDM.relationships_adm_ddd_metrics_wide_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.7717014ac4", "test.CGOncology_MDM.test_ddd_grain_long_reconciliation"], "model.CGOncology_MDM.adm_ddd_metrics_grain": ["model.CGOncology_MDM.adm_address_best_ddd_metrics_long", "model.CGOncology_MDM.adm_ddd_metrics_long", "model.CGOncology_MDM.adm_lowest_level_metrics", "test.CGOncology_MDM.accepted_values_adm_ddd_metrics_grain_product_group_id__1__2__3__4__7.85590311ef", "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_be_between_adm_ddd_metrics_grain_month_num__24__1.cca6edfe9a", "test.CGOncology_MDM.dbt_expectations_expect_table_row_count_to_be_between_adm_ddd_metrics_grain_50000.0acb967837", "test.CGOncology_MDM.not_null_adm_ddd_metrics_grain_kmk_hco_id.af8e20f7b3", "test.CGOncology_MDM.not_null_adm_ddd_metrics_grain_month_num.e58f620175", "test.CGOncology_MDM.not_null_adm_ddd_metrics_grain_outlet_no.bd9c6a4fba", "test.CGOncology_MDM.not_null_adm_ddd_metrics_grain_product_group_id.b56b99cd4d", "test.CGOncology_MDM.not_null_adm_ddd_metrics_grain_sales_amount.c0f65820e3", "test.CGOncology_MDM.not_null_adm_ddd_metrics_grain_units_count.05cd92af6c", "test.CGOncology_MDM.test_ddd_grain_long_reconciliation", "test.CGOncology_MDM.test_ddd_l4_reconciliation"], "model.CGOncology_MDM.adm_hco_claims_wide": ["test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_adm_hco_claims_wide_kmk_hco_id__metric_category.6de5f75027", "test.CGOncology_MDM.not_null_adm_hco_claims_wide_kmk_hco_id.c341d38d95", "test.CGOncology_MDM.not_null_adm_hco_claims_wide_metric_category.0ee4d97e6c", "test.CGOncology_MDM.relationships_adm_hco_claims_wide_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.6f179ab665"], "model.CGOncology_MDM.adm_address_best_hco_metrics_wide": ["test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_wide_kmk_hco_id.7132de2edb", "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_wide_metric_category.2d7e0dbc9e"], "model.CGOncology_MDM.adm_pipeline_snapshot": ["model.CGOncology_MDM.adm_pipeline_diff", "model.CGOncology_MDM.adm_pipeline_trend", "test.CGOncology_MDM.not_null_adm_pipeline_snapshot_data_date.d3d141b40b", "test.CGOncology_MDM.not_null_adm_pipeline_snapshot_metric_group.3587125e97", "test.CGOncology_MDM.not_null_adm_pipeline_snapshot_metric_name.7ed1bacdec", "test.CGOncology_MDM.not_null_adm_pipeline_snapshot_metric_value.f59cc31a65", "test.CGOncology_MDM.not_null_adm_pipeline_snapshot_run_timestamp.ff8bc8e6ff"], "model.CGOncology_MDM.ref_address_best_hco": ["model.CGOncology_MDM.adm_address_best_ddd_metrics_long", "model.CGOncology_MDM.adm_address_best_ddd_metrics_wide", "model.CGOncology_MDM.adm_address_best_hco_metrics_long", "model.CGOncology_MDM.adm_address_best_hco_metrics_wide", "test.CGOncology_MDM.accepted_values_ref_address_best_hco_is_address_best__Y__N.4821daa5cd", "test.CGOncology_MDM.not_null_ref_address_best_hco_address_best_hco_id.dab8f5f797", "test.CGOncology_MDM.not_null_ref_address_best_hco_address_group_count.a48f51a241", "test.CGOncology_MDM.not_null_ref_address_best_hco_address_group_id.53d638d7eb", "test.CGOncology_MDM.not_null_ref_address_best_hco_is_address_best.49ac58e764", "test.CGOncology_MDM.not_null_ref_address_best_hco_kmk_hco_id.f5e718f933", "test.CGOncology_MDM.relationships_ref_address_best_hco_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.0936f794de", "test.CGOncology_MDM.unique_ref_address_best_hco_kmk_hco_id.a384281d43"], "model.CGOncology_MDM.adm_address_best_hco_metrics_long": ["model.CGOncology_MDM.adm_address_best_hco_metrics_wide", "test.CGOncology_MDM.accepted_values_adm_address_best_hco_metrics_long_entity_type__ADDRESS_BEST_HCO.e3223ff58e", "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_claim_count.16f35ae23f", "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_contributing_hco_count.95bedc6749", "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_entity_id.58f585bf06", "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_entity_type.7f2a2cf4d0", "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_metric_category.61333a3296", "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_patient_count.e3d2699c30", "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_period_key.6479f81b48"], "model.CGOncology_MDM.adm_ddd_metrics_long": ["model.CGOncology_MDM.adm_ddd_metrics_wide", "test.CGOncology_MDM.accepted_values_adm_ddd_metrics_long_entity_type__HCO.8cdf8eb4c5", "test.CGOncology_MDM.accepted_values_adm_ddd_metrics_long_metric_category__TICE_BCG__ADSTILADRIN__ANKTIVA__INLEXZO__TOTAL_BRANDED__TOTAL__OTHER.84c56bf16a", "test.CGOncology_MDM.accepted_values_adm_ddd_metrics_long_period_type__MONTHLY__QUARTERLY__ROLLING__YTD__QTD__PY__PYTD__P2Y__CALENDAR_YEAR__LTD__TOTAL.60fff9a04a", "test.CGOncology_MDM.dbt_expectations_expect_table_row_count_to_be_between_adm_ddd_metrics_long_100000.0fbaec9138", "test.CGOncology_MDM.not_null_adm_ddd_metrics_long_data_date.350c355f44", "test.CGOncology_MDM.not_null_adm_ddd_metrics_long_entity_id.5d26527a34", "test.CGOncology_MDM.not_null_adm_ddd_metrics_long_entity_type.3a48119566", "test.CGOncology_MDM.not_null_adm_ddd_metrics_long_metric_category.6ff3e16807", "test.CGOncology_MDM.not_null_adm_ddd_metrics_long_period_key.9bdfea608e", "test.CGOncology_MDM.not_null_adm_ddd_metrics_long_period_type.1b0e3c4c83", "test.CGOncology_MDM.test_ddd_grain_long_reconciliation", "test.CGOncology_MDM.test_ddd_l4_reconciliation"], "model.CGOncology_MDM.adm_hco_nmibc_metrics": ["test.CGOncology_MDM.not_null_adm_hco_nmibc_metrics_high_risk_nmibc_patients.05ab66c196", "test.CGOncology_MDM.not_null_adm_hco_nmibc_metrics_kmk_hco_id.879ce27570", "test.CGOncology_MDM.not_null_adm_hco_nmibc_metrics_low_risk_nmibc_patients.3ca3bd0262", "test.CGOncology_MDM.not_null_adm_hco_nmibc_metrics_mid_risk_nmibc_patients.fa614f1d00", "test.CGOncology_MDM.not_null_adm_hco_nmibc_metrics_total_nmibc_patients.a38658c0ce", "test.CGOncology_MDM.relationships_adm_hco_nmibc_metrics_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.9077e1ad59", "test.CGOncology_MDM.unique_adm_hco_nmibc_metrics_kmk_hco_id.d9d7542acd"], "model.CGOncology_MDM.adm_claims_metrics_long": ["model.CGOncology_MDM.adm_hco_claims_wide", "model.CGOncology_MDM.adm_hco_master", "model.CGOncology_MDM.adm_hcp_claims_wide", "test.CGOncology_MDM.accepted_values_adm_claims_metrics_long_entity_type__HCO__HCP.ae7d2aedac", "test.CGOncology_MDM.accepted_values_adm_claims_metrics_long_metric_category__BC_DIAGNOSIS__TURBT__TICE_BCG__ADSTILADRIN__ANKTIVA__KEYTRUDA__CYSTOSCOPY__OTHER_PROCEDURES__Total_Claims.94301565dc", "test.CGOncology_MDM.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_adm_claims_metrics_long_claim_count__patient_count__True.4687b44aa9", "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_be_between_adm_claims_metrics_long_claim_count__0.d16650926f", "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_be_between_adm_claims_metrics_long_patient_count__0.52b56d55e6", "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_adm_claims_metrics_long_entity_type__entity_id__metric_category__period_key.bd089e0447", "test.CGOncology_MDM.not_null_adm_claims_metrics_long_claim_count.e55d380d3c", "test.CGOncology_MDM.not_null_adm_claims_metrics_long_entity_id.62f222c646", "test.CGOncology_MDM.not_null_adm_claims_metrics_long_entity_type.4ee8824a9d", "test.CGOncology_MDM.not_null_adm_claims_metrics_long_metric_category.a993d0d928", "test.CGOncology_MDM.not_null_adm_claims_metrics_long_patient_count.a793935234", "test.CGOncology_MDM.not_null_adm_claims_metrics_long_period_key.a7e5be47da"], "model.CGOncology_MDM.ref_treatment_categories": ["model.CGOncology_MDM.stg_hcp_hco_claims", "test.CGOncology_MDM.accepted_values_ref_treatment_categories_code_type__DX__CPT__HCPCS__ICD10PCS__ICD9__NDC.67743f64a9", "test.CGOncology_MDM.accepted_values_ref_treatment_categories_metric_category__BC_DIAGNOSIS__TURBT__TICE_BCG__ADSTILADRIN__ANKTIVA__KEYTRUDA__CYSTOSCOPY__OTHER_PX__OTHER.3764e2253e", "test.CGOncology_MDM.not_null_ref_treatment_categories_code.1067f5254b", "test.CGOncology_MDM.not_null_ref_treatment_categories_code_type.4e9dabd64d"], "model.CGOncology_MDM.adm_hcp_claims_wide": ["test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_adm_hcp_claims_wide_kmk_hcp_id__metric_category.f671822c9f", "test.CGOncology_MDM.not_null_adm_hcp_claims_wide_kmk_hcp_id.8632196ef4", "test.CGOncology_MDM.not_null_adm_hcp_claims_wide_metric_category.2721711915", "test.CGOncology_MDM.relationships_adm_hcp_claims_wide_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_.a271032517"], "model.CGOncology_MDM.adm_dh_metrics_grain": ["model.CGOncology_MDM.adm_address_best_hco_metrics_long", "model.CGOncology_MDM.adm_claims_metrics_by_payor", "model.CGOncology_MDM.adm_claims_metrics_long", "model.CGOncology_MDM.adm_lowest_level_metrics"], "model.CGOncology_MDM.adm_claims_metrics_by_payor": ["test.CGOncology_MDM.accepted_values_adm_claims_metrics_by_payor_entity_type__HCO__HCP.0d142bb56f", "test.CGOncology_MDM.accepted_values_adm_claims_metrics_by_payor_payor_type__COMMERCIAL__MEDICARE__MEDICAID__MEDICARE_ADVANTAGE__OTHER__ALL.6c39bb89fc", "test.CGOncology_MDM.not_null_adm_claims_metrics_by_payor_entity_id.da949df3be", "test.CGOncology_MDM.not_null_adm_claims_metrics_by_payor_entity_type.cab3d439d4", "test.CGOncology_MDM.not_null_adm_claims_metrics_by_payor_metric_category.4d935aea00", "test.CGOncology_MDM.not_null_adm_claims_metrics_by_payor_payor_type.0155c9899e"], "model.CGOncology_MDM.adm_hco_master": ["model.CGOncology_MDM.adm_address_best_ddd_metrics_wide", "model.CGOncology_MDM.adm_address_best_hco_metrics_wide", "model.CGOncology_MDM.adm_hco_claims_wide", "test.CGOncology_MDM.accepted_values_adm_hco_master_account_type__P1_LUGPA__P2_ACADEMIC__P2_NON_ACADEMIC__P3__FEDERAL__P3_CCS__P4_SMALL_INDEP_Ctr.4bd3ff3d4d", "test.CGOncology_MDM.accepted_values_adm_hco_master_account_type_priority__P1__P2__P3__P4.c308974a6e", "test.CGOncology_MDM.accepted_values_adm_hco_master_child_target_flag__0__1.f2eb08ef11", "test.CGOncology_MDM.accepted_values_adm_hco_master_cust_backbone_flag__Y__N.66c59561ee", "test.CGOncology_MDM.accepted_values_adm_hco_master_hierarchy_level__L1__L2__L3__L4.17118f63d4", "test.CGOncology_MDM.accepted_values_adm_hco_master_hsd_target_flag__Y__N.6622511c65", "test.CGOncology_MDM.accepted_values_adm_hco_master_kam_target_flag__Y__N.bae2588bce", "test.CGOncology_MDM.accepted_values_adm_hco_master_msl_target_flag__Y__N.fc14917e51", "test.CGOncology_MDM.accepted_values_adm_hco_master_network_target_flag__0__1.f1bb7a4710", "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_adm_hco_master_kmk_hco_id___34_0_9_9_.59162648b2", "test.CGOncology_MDM.not_null_adm_hco_master_cust_backbone_flag.2eb804314f", "test.CGOncology_MDM.not_null_adm_hco_master_kmk_hco_id.19c041cf01", "test.CGOncology_MDM.relationships_adm_hco_master_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.5e67cf4dd2", "test.CGOncology_MDM.row_count_match_adm_hco_master_ref_mdm_customer_master_hco_.8e0ebfab64", "test.CGOncology_MDM.test_quarterly_freeze_consistency", "test.CGOncology_MDM.unique_adm_hco_master_kmk_hco_id.595890ac11"], "model.CGOncology_MDM.adm_pipeline_trend": ["test.CGOncology_MDM.not_null_adm_pipeline_trend_data_date.f3fa81fdfb", "test.CGOncology_MDM.not_null_adm_pipeline_trend_metric_group.7c11051e3c", "test.CGOncology_MDM.not_null_adm_pipeline_trend_metric_name.e432676a27"], "model.CGOncology_MDM.adm_address_best_ddd_metrics_wide": ["test.CGOncology_MDM.not_null_adm_address_best_ddd_metrics_wide_kmk_hco_id.945c4a01b0", "test.CGOncology_MDM.not_null_adm_address_best_ddd_metrics_wide_metric_category.215003c5bc"], "model.CGOncology_MDM.ref_payor_types": ["model.CGOncology_MDM.adm_claims_metrics_by_payor", "test.CGOncology_MDM.accepted_values_ref_payor_types_canonical_payor_type__COMMERCIAL__MEDICARE__MEDICAID__MEDICARE_ADVANTAGE__OTHER.0219c536fb", "test.CGOncology_MDM.not_null_ref_payor_types_canonical_payor_type.67a25c16e9", "test.CGOncology_MDM.not_null_ref_payor_types_raw_payor_type.7785659b91"], "model.CGOncology_MDM.adm_hco_hierarchy": ["model.CGOncology_MDM.adm_address_best_ddd_metrics_wide", "model.CGOncology_MDM.adm_address_best_hco_metrics_wide", "model.CGOncology_MDM.adm_ddd_metrics_grain", "model.CGOncology_MDM.adm_ddd_metrics_wide", "model.CGOncology_MDM.adm_dh_metrics_grain", "model.CGOncology_MDM.adm_hco_claims_wide", "model.CGOncology_MDM.adm_hco_master", "model.CGOncology_MDM.adm_hco_nmibc_metrics", "model.CGOncology_MDM.adm_hcp_master", "model.CGOncology_MDM.adm_lowest_level_metrics", "model.CGOncology_MDM.ref_address_best_hco", "test.CGOncology_MDM.accepted_values_adm_hco_hierarchy_hierarchy_level__L1__L2__L3__L4.aedee61f35", "test.CGOncology_MDM.not_null_adm_hco_hierarchy_hierarchy_level.8368eddce9", "test.CGOncology_MDM.not_null_adm_hco_hierarchy_kmk_hco_id.57589754c5", "test.CGOncology_MDM.relationships_adm_hco_hierarchy_account_id_l1__kmk_hco_id__ref_mdm_customer_master_hco_.23c5f3762e", "test.CGOncology_MDM.relationships_adm_hco_hierarchy_account_id_l2__kmk_hco_id__ref_mdm_customer_master_hco_.1db54b1492", "test.CGOncology_MDM.relationships_adm_hco_hierarchy_account_id_l3__kmk_hco_id__ref_mdm_customer_master_hco_.c75c8794ac", "test.CGOncology_MDM.relationships_adm_hco_hierarchy_account_id_l4__kmk_hco_id__ref_mdm_customer_master_hco_.11f5ece339", "test.CGOncology_MDM.relationships_adm_hco_hierarchy_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.1d6b8c0dce", "test.CGOncology_MDM.test_ddd_grain_long_reconciliation", "test.CGOncology_MDM.test_ddd_l4_reconciliation", "test.CGOncology_MDM.unique_adm_hco_hierarchy_kmk_hco_id.af11937683", "test.CGOncology_MDM.val_path2_skip_validation"], "model.CGOncology_MDM.source_orders": ["model.CGOncology_MDM.incremental_orders"], "model.CGOncology_MDM.incremental_orders": [], "model.CGOncology_MDM.source_customers": ["snapshot.CGOncology_MDM.snap_customers"], "snapshot.CGOncology_MDM.snap_customers": [], "analysis.CGOncology_MDM.val_path2_skip_validation": [], "test.CGOncology_MDM.test_ddd_grain_long_reconciliation": [], "test.CGOncology_MDM.qc_date_ranges": [], "test.CGOncology_MDM.test_quarterly_freeze_consistency": [], "test.CGOncology_MDM.test_ddd_l4_reconciliation": [], "test.CGOncology_MDM.test_standardization_bounds": [], "test.CGOncology_MDM.test_cumulative_decile_boundaries": [], "test.CGOncology_MDM.test_weighted_score_formula": [], "test.CGOncology_MDM.test_decile_score_distribution": [], "test.CGOncology_MDM.val_cb_028_treatment_category_distribution": [], "test.CGOncology_MDM.val_cb_025_code_mapping_coverage": [], "test.CGOncology_MDM.val_cb_029_code_mapping_completeness": [], "test.CGOncology_MDM.val_cb_026_patient_pool_consolidation": [], "test.CGOncology_MDM.dashboard_reporting_test_cases_dev": [], "test.CGOncology_MDM.val_path2_skip_validation": [], "test.CGOncology_MDM.val_cb_030_new_code_detection": [], "test.CGOncology_MDM.val_apt_data_validation": [], "seed.CGOncology_MDM.seed_new_payor_contacts": [], "seed.CGOncology_MDM.config_account_type_thresholds": [], "seed.CGOncology_MDM.seed_new_payor_upload": [], "seed.CGOncology_MDM.teams": ["test.CGOncology_MDM.not_null_teams_team_code.564726c6b6", "test.CGOncology_MDM.unique_teams_team_code.4a63fda674"], "seed.CGOncology_MDM.config_name_aliases": [], "seed.CGOncology_MDM.seed_manual_hco_accounts": [], "seed.CGOncology_MDM.seed_firm_types": [], "seed.CGOncology_MDM.config_survivorship_hco": [], "seed.CGOncology_MDM.seed_bc_rx_ndc_mapping": ["model.CGOncology_MDM.mdm_ref_market_definition", "model.CGOncology_MDM.ref_treatment_categories", "model.CGOncology_MDM.std_rx_bc_patients", "model.CGOncology_MDM.std_rx_claims", "test.CGOncology_MDM.val_cb_025_code_mapping_coverage", "test.CGOncology_MDM.val_cb_029_code_mapping_completeness"], "seed.CGOncology_MDM.zip_city_state_config": ["model.CGOncology_MDM.std_ddd_hco", "model.CGOncology_MDM.std_dh_hco", "model.CGOncology_MDM.std_dh_hcp", "model.CGOncology_MDM.std_dh_practice_location"], "seed.CGOncology_MDM.seed_units": [], "seed.CGOncology_MDM.config_fuzzy_match_thresholds": [], "seed.CGOncology_MDM.seed_bc_dx_code_mapping": ["model.CGOncology_MDM.mdm_ref_market_definition", "model.CGOncology_MDM.ref_treatment_categories", "model.CGOncology_MDM.std_dx_bc_patients", "model.CGOncology_MDM.std_dx_claims", "test.CGOncology_MDM.val_cb_025_code_mapping_coverage", "test.CGOncology_MDM.val_cb_029_code_mapping_completeness", "test.CGOncology_MDM.val_cb_030_new_code_detection"], "seed.CGOncology_MDM.seed_metric_list": [], "seed.CGOncology_MDM.config_address_abbreviations": [], "seed.CGOncology_MDM.config_mso_known_affiliations": ["model.CGOncology_MDM.adm_hco_hierarchy"], "seed.CGOncology_MDM.seed_payer_types": [], "seed.CGOncology_MDM.config_ddd_sub_category": ["model.CGOncology_MDM.mdm_ref_market_definition", "model.CGOncology_MDM.std_ddd_hco"], "seed.CGOncology_MDM.account_type_business_input": ["model.CGOncology_MDM.adm_dh_metrics_grain", "model.CGOncology_MDM.adm_hco_master", "test.CGOncology_MDM.val_path2_skip_validation"], "seed.CGOncology_MDM.seed_bc_px_code_mapping": ["model.CGOncology_MDM.mdm_ref_market_definition", "model.CGOncology_MDM.ref_treatment_categories", "model.CGOncology_MDM.std_px_bc_patients", "model.CGOncology_MDM.std_px_claims", "test.CGOncology_MDM.val_cb_025_code_mapping_coverage", "test.CGOncology_MDM.val_cb_029_code_mapping_completeness", "test.CGOncology_MDM.val_cb_030_new_code_detection"], "seed.CGOncology_MDM.config_survivorship_hcp": [], "operation.CGOncology_MDM.CGOncology_MDM-on-run-start-0": [], "test.CGOncology_MDM.not_null_mdm_ref_market_definition_code_type.1ea347293e": [], "test.CGOncology_MDM.accepted_values_mdm_ref_market_definition_code_type__DX__PX__RX__Sub_category.7430203439": [], "test.CGOncology_MDM.not_null_mdm_ref_market_definition_code.d44466f5db": [], "test.CGOncology_MDM.not_null_mdm_customer_master_hco_kmk_hco_id.872bd2a427": [], "test.CGOncology_MDM.unique_mdm_customer_master_hco_kmk_hco_id.5a263fffb9": [], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_mdm_customer_master_hco_kmk_hco_id___34_0_9_9_.c57ec6e0c3": [], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_mdm_customer_master_hco_dh_id___0__dh_id_IS_NOT_NULL.1f6f480f1f": [], "test.CGOncology_MDM.not_null_mdm_customer_master_hco_org_name.2edb57d8d4": [], "test.CGOncology_MDM.key_coverage_mdm_customer_master_hco_kmk_hco_id__kmk_hco_id__SOURCE_CODE_DHC_OR_SOURCE_CODE_DDD_AND_DH_ID_IS_NOT_NULL___ref_mdm_customer_xref_hco_.cc390e7732": [], "test.CGOncology_MDM.not_null_mdm_customer_master_hcp_kmk_hcp_id.9e02d8cee2": [], "test.CGOncology_MDM.unique_mdm_customer_master_hcp_kmk_hcp_id.bb0184f77e": [], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_mdm_customer_master_hcp_kmk_hcp_id___15_0_9_9_.a52d55a1ce": [], "test.CGOncology_MDM.not_null_mdm_customer_master_hcp_npi.08ade6922b": [], "test.CGOncology_MDM.unique_mdm_customer_master_hcp_npi.d95c718672": [], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_mdm_customer_master_hcp_npi___0_9_10_.7145d546b1": [], "test.CGOncology_MDM.not_null_mdm_customer_master_hcp_last_name.ea89caac8a": [], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_mdm_customer_master_hcp_primary_specialty_____primary_specialty_IS_NOT_NULL.63e68a0e35": [], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_mdm_customer_master_hcp_primary_specialty___And_Or_Of_The___primary_specialty_IS_NOT_NULL.431e6cdde2": [], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_mdm_customer_master_hcp_primary_specialty_____primary_specialty_IS_NOT_NULL.ebd4f1382a": [], "test.CGOncology_MDM.dbt_expectations_expect_column_value_lengths_to_be_between_mdm_customer_master_hcp_primary_specialty__100.0751b38539": [], "test.CGOncology_MDM.dbt_expectations_expect_column_value_lengths_to_be_between_mdm_customer_master_hcp_primary_specialty_group__100.542c204ac7": [], "test.CGOncology_MDM.key_coverage_mdm_customer_master_hcp_kmk_hcp_id__kmk_hcp_id__SOURCE_CODE_DHC___ref_mdm_customer_xref_hcp_.c421076b29": [], "test.CGOncology_MDM.not_null_mdm_customer_xref_hco_kmk_hco_id.fa70a0d10c": [], "test.CGOncology_MDM.relationships_mdm_customer_xref_hco_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.bb9737f0e4": [], "test.CGOncology_MDM.not_null_mdm_customer_xref_hco_source_code.767c39c483": [], "test.CGOncology_MDM.accepted_values_mdm_customer_xref_hco_source_code__DHC__DDD__MEDSCOUT__PRACTICE_LOCATION.55e13c3ae2": [], "test.CGOncology_MDM.not_null_mdm_customer_xref_hco_source_id.d0ee1617fe": [], "test.CGOncology_MDM.key_coverage_mdm_customer_xref_hco_source_id__dh_id__ref_std_dh_hco___SOURCE_CODE_DHC_.2474a26f9d": [], "test.CGOncology_MDM.not_null_mdm_customer_xref_hcp_kmk_hcp_id.5ee8ca04b8": [], "test.CGOncology_MDM.relationships_mdm_customer_xref_hcp_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_.fd7d7aed14": [], "test.CGOncology_MDM.not_null_mdm_customer_xref_hcp_npi.3df694fd52": [], "test.CGOncology_MDM.relationships_mdm_customer_xref_hcp_npi__npi__ref_mdm_customer_master_hcp_.af000d17f9": [], "test.CGOncology_MDM.not_null_mdm_customer_xref_hcp_source_code.125eb81841": [], "test.CGOncology_MDM.accepted_values_mdm_customer_xref_hcp_source_code__DHC__MEDSCOUT.48cc60fa51": [], "test.CGOncology_MDM.key_coverage_mdm_customer_xref_hcp_source_id__npi__ref_std_dh_hcp___SOURCE_CODE_DHC_.1ea045b04f": [], "test.CGOncology_MDM.not_null_mdm_best_affiliation_npi.09b0285e48": [], "test.CGOncology_MDM.unique_mdm_best_affiliation_npi.41d120735b": [], "test.CGOncology_MDM.not_null_mdm_best_affiliation_kmk_hcp_id.50709ac5e3": [], "test.CGOncology_MDM.relationships_mdm_best_affiliation_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_.14c07bfe64": [], "test.CGOncology_MDM.relationships_mdm_best_affiliation_best_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.94418604ac": [], "test.CGOncology_MDM.not_null_mdm_best_affiliation_mapping_rule.9c21268898": [], "test.CGOncology_MDM.not_null_mdm_best_affiliation_hist_npi.dcaef99ecf": [], "test.CGOncology_MDM.not_null_mdm_best_affiliation_hist_version_number.ec106bab60": [], "test.CGOncology_MDM.not_null_mdm_best_affiliation_hist_is_current.7996664e31": [], "test.CGOncology_MDM.accepted_values_mdm_best_affiliation_hist_is_current__Y__N.115e68cd06": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_mdm_best_affiliation_hist_npi__version_number.b205a74dfb": [], "test.CGOncology_MDM.not_null_mdm_customer_xref_hco_hist_kmk_hco_id.97be341d89": [], "test.CGOncology_MDM.not_null_mdm_customer_xref_hco_hist_version_number.5a5057b6ac": [], "test.CGOncology_MDM.accepted_values_mdm_customer_xref_hco_hist_is_current__Y__N.f0f38b0287": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_mdm_customer_xref_hco_hist_kmk_hco_id__source_code__source_id__version_number.09dfa39014": [], "test.CGOncology_MDM.not_null_mdm_customer_xref_hcp_hist_kmk_hcp_id.7ec0ca69e8": [], "test.CGOncology_MDM.not_null_mdm_customer_xref_hcp_hist_version_number.f4744eacf4": [], "test.CGOncology_MDM.accepted_values_mdm_customer_xref_hcp_hist_is_current__Y__N.1da3a07768": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_mdm_customer_xref_hcp_hist_kmk_hcp_id__source_code__version_number.257291777b": [], "test.CGOncology_MDM.not_null_match_ddd_dhc_DDD_OUTLET_ID.9431d55a7f": [], "test.CGOncology_MDM.unique_match_ddd_dhc_DDD_OUTLET_ID.fcadb410cf": [], "test.CGOncology_MDM.not_null_match_ddd_dhc_DDD_OUTLET_NAME.cf75f8fcd7": [], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_be_between_match_ddd_dhc_ADDRESS_MATCH_SCORE__100__0.59ba604c8c": [], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_be_between_match_ddd_dhc_NAME_MATCH_SCORE__100__0.ba2d1026eb": [], "test.CGOncology_MDM.accepted_values_match_ddd_dhc_MATCH_BUCKET__0__1__2__3__4.a27fe795cf": [], "test.CGOncology_MDM.accepted_values_match_ddd_dhc_MATCH_STEP__0__1__2__3__4.029afef2fa": [], "test.CGOncology_MDM.accepted_values_match_ddd_dhc_DHC_MATCH_SOURCE__Practice_Location__HQ_Location__City_State_Fallback__Medscout_Bridge__DH_Matching_Return__Legacy_History__XREF_History.e46667f474": [], "test.CGOncology_MDM.not_null_match_ddd_dhc_MATCH_STATUS.50e40ba959": [], "test.CGOncology_MDM.accepted_values_match_ddd_dhc_MATCH_STATUS__MATCHED__UNMATCHED.623af1049a": [], "test.CGOncology_MDM.accepted_values_match_ddd_dhc_CONFIDENCE_LEVEL__HIGH__MEDIUM__STEWARD__HISTORICAL.690cc051c1": [], "test.CGOncology_MDM.not_null_match_ddd_dhc_IS_HISTORICAL_MATCH.d9bf2310fd": [], "test.CGOncology_MDM.not_null_match_ddd_dhc_IS_DELTA.14815dedb4": [], "test.CGOncology_MDM.not_null_match_medscout_dhc_hcp_MEDSCOUT_ID.f3c6209b8f": [], "test.CGOncology_MDM.unique_match_medscout_dhc_hcp_MEDSCOUT_ID.a4ddb83f70": [], "test.CGOncology_MDM.not_null_match_medscout_dhc_hcp_NPI.1d48ccd718": [], "test.CGOncology_MDM.accepted_values_match_medscout_dhc_hcp_MATCH_TYPE__NPI_EXACT.b0e6786039": [], "test.CGOncology_MDM.not_null_match_medscout_dhc_hcp_MATCH_STATUS.58d977e8e9": [], "test.CGOncology_MDM.accepted_values_match_medscout_dhc_hcp_MATCH_STATUS__MATCHED__UNMATCHED.b9609b5d31": [], "test.CGOncology_MDM.not_null_match_medscout_dhc_hcp_IS_DELTA.62a95babd1": [], "test.CGOncology_MDM.not_null_match_medscout_dhc_hcp_IS_HISTORICAL_MATCH.e1fe9b7c05": [], "test.CGOncology_MDM.not_null_match_medscout_dhc_hcp_MATCH_DATE.132412ad64": [], "test.CGOncology_MDM.not_null_stg_bc_patient_pool_PATIENT_ID.d047ac8e90": [], "test.CGOncology_MDM.unique_stg_bc_patient_pool_PATIENT_ID.38ad9d6549": [], "test.CGOncology_MDM.not_null_stg_bc_patient_pool_IDENTIFIED_VIA_DX.259ef11f32": [], "test.CGOncology_MDM.accepted_values_stg_bc_patient_pool_IDENTIFIED_VIA_DX__Y__N.1ee43ae670": [], "test.CGOncology_MDM.not_null_stg_bc_patient_pool_IDENTIFIED_VIA_PX.3936f0c36d": [], "test.CGOncology_MDM.accepted_values_stg_bc_patient_pool_IDENTIFIED_VIA_PX__Y__N.70b904dc00": [], "test.CGOncology_MDM.not_null_stg_bc_patient_pool_IDENTIFIED_VIA_RX.a4f6073e8a": [], "test.CGOncology_MDM.accepted_values_stg_bc_patient_pool_IDENTIFIED_VIA_RX__Y__N.c11d1877c2": [], "test.CGOncology_MDM.not_null_stg_bc_patient_pool_IDENTIFICATION_PATHWAY_COUNT.3ed02c7eac": [], "test.CGOncology_MDM.accepted_values_stg_bc_patient_pool_IDENTIFICATION_PATHWAY_COUNT__1__2__3.59434ca4f4": [], "test.CGOncology_MDM.not_null_stg_bc_patient_pool_EARLIEST_BC_EVENT_DATE.1d286cde6b": [], "test.CGOncology_MDM.not_null_stg_bc_patient_pool_LATEST_BC_EVENT_DATE.f0a01e8ad2": [], "test.CGOncology_MDM.not_null_stg_bc_patient_pool_TOTAL_BC_CLAIM_COUNT.256c214c05": [], "test.CGOncology_MDM.accepted_values_stg_bc_patient_pool_PATIENT_GENDER__M__F__U__X.2f60f286c0": [], "test.CGOncology_MDM.not_null_stg_hcp_hco_claims_PATIENT_ID.9a0bcf8302": [], "test.CGOncology_MDM.relationships_stg_hcp_hco_claims_PATIENT_ID__PATIENT_ID__ref_stg_bc_patient_pool_.8c28be3c10": [], "test.CGOncology_MDM.not_null_stg_hcp_hco_claims_SERVICE_DATE.3a3afd17c5": [], "test.CGOncology_MDM.not_null_stg_hcp_hco_claims_CLAIM_TYPE.2672d69539": [], "test.CGOncology_MDM.accepted_values_stg_hcp_hco_claims_CLAIM_TYPE__DX__PX__RX.183fef863b": [], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_NPI.57a8a3ff0f": [], "test.CGOncology_MDM.unique_stg_hcp_bc_metrics_NPI.092de56925": [], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_BC_PATIENT_COUNT.963cf7cf30": [], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_DX_PATIENT_COUNT.914c0df3f0": [], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_RX_PATIENT_COUNT.592d04ea6e": [], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_TURBT_PATIENTS.70efb088e0": [], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_BCG_PATIENTS.8b51cdd62e": [], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_ADSTILADRIN_PATIENTS.c85b423b99": [], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_ANKTIVA_PATIENTS.9ce93db81c": [], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_KEYTRUDA_PATIENTS.11c0558b26": [], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_CYSTOSCOPY_PATIENTS.26524a772d": [], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_RX_BCG_PATIENTS.1b19cc04a6": [], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_RX_ADSTILADRIN_PATIENTS.83317531f5": [], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_RX_ANKTIVA_PATIENTS.6d08e257a9": [], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_IS_UROLOGIST.77ceba9871": [], "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_IS_UROLOGIST__Y__N.62a606d1c8": [], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_IS_TARGET.541cb9e827": [], "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_IS_TARGET__Y__N.8e09f806ba": [], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_HAS_ACTIVITY.360aaae1ed": [], "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_HAS_ACTIVITY__Y__N.2b140a4257": [], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_HAS_BC_TREATMENT_CLAIMS.ad9b758830": [], "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_HAS_BC_TREATMENT_CLAIMS__Y__N.2df31db436": [], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_HAS_BC_PROCEDURE_CLAIMS.54530c687b": [], "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_HAS_BC_PROCEDURE_CLAIMS__Y__N.192be9057e": [], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_HAS_BC_RX_CLAIMS.c66cedcecc": [], "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_HAS_BC_RX_CLAIMS__Y__N.b26915858b": [], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_BC_BACKBONE_FLAG.a17b979898": [], "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_BC_BACKBONE_FLAG__Y__N.ba1821dd61": [], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_HCP_CATEGORY.b39969faec": [], "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_HCP_CATEGORY__Urologist__BC_Treatment_Patient_Pool__BC_RX_Prescriber__Target_HCP__Activity_HCP__Total_BC_Patient_Pool.f12bf82f00": [], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_BC_VOLUME_TIER.b6e432164c": [], "test.CGOncology_MDM.accepted_values_stg_hcp_bc_metrics_BC_VOLUME_TIER__HIGH__MEDIUM__LOW__NONE.610aafdce1": [], "test.CGOncology_MDM.not_null_stg_hcp_bc_metrics_DATA_DATE.cdf6c17b7c": [], "test.CGOncology_MDM.not_null_hcp_decile_NPI.e208cb8767": [], "test.CGOncology_MDM.unique_hcp_decile_NPI.9eca6ac110": [], "test.CGOncology_MDM.not_null_hcp_decile_TIME_PERIOD.f5eac4fc6a": [], "test.CGOncology_MDM.not_null_hcp_decile_STANDARDIZED_TOTAL_PATIENTS.ee7998a705": [], "test.CGOncology_MDM.not_null_hcp_decile_STANDARDIZED_BCG_CLAIMS.dd05c0a210": [], "test.CGOncology_MDM.not_null_hcp_decile_STANDARDIZED_TURBT_CLAIMS.80c23eabcf": [], "test.CGOncology_MDM.not_null_hcp_decile_COMPOSITE_SCORE.1570178381": [], "test.CGOncology_MDM.not_null_hcp_decile_DECILE.4053a88425": [], "test.CGOncology_MDM.accepted_values_hcp_decile_DECILE__1__2__3__4__5__6__7__8__9__10.113157d98c": [], "test.CGOncology_MDM.not_null_stg_sfe_targets_entity_id.c065cd9d0a": [], "test.CGOncology_MDM.not_null_stg_sfe_targets_entity_type.8082c3d2af": [], "test.CGOncology_MDM.accepted_values_stg_sfe_targets_entity_type__HCO__HCP.e4003662ec": [], "test.CGOncology_MDM.not_null_stg_sfe_targets_target_type.6d0a8711b5": [], "test.CGOncology_MDM.accepted_values_stg_sfe_targets_target_type__KAM_NETWORK__KAM_CHILD__HSD__HCP_TARGET__MSL_TARGET.19afec1207": [], "test.CGOncology_MDM.not_null_stg_sfe_targets_target_flag.02d4b9155f": [], "test.CGOncology_MDM.not_null_adm_sfe_geographies_geo_code.3bf1753026": [], "test.CGOncology_MDM.unique_adm_sfe_geographies_geo_code.2eea9dd057": [], "test.CGOncology_MDM.not_null_adm_sfe_geographies_geo_name.4bc8946e84": [], "test.CGOncology_MDM.not_null_adm_sfe_geographies_geo_type.ac40d5904e": [], "test.CGOncology_MDM.accepted_values_adm_sfe_geographies_geo_type__TERRITORY__REGION__NATION.b2998d82da": [], "test.CGOncology_MDM.accepted_values_adm_sfe_geographies_team__KAM__HSD__MSL__PAYOR.d41f96ee2a": [], "test.CGOncology_MDM.not_null_adm_sfe_zip_alignment_zip_code.650f602114": [], "test.CGOncology_MDM.unique_adm_sfe_zip_alignment_zip_code.d5a56b576f": [], "test.CGOncology_MDM.not_null_adm_sfe_hco_targets_kmk_hco_id.5878b9508f": [], "test.CGOncology_MDM.unique_adm_sfe_hco_targets_kmk_hco_id.de0c13379d": [], "test.CGOncology_MDM.relationships_adm_sfe_hco_targets_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.07e79ca121": [], "test.CGOncology_MDM.accepted_values_adm_sfe_hco_targets_kam_network_target_flag__Y__N.5d3ad1f11a": [], "test.CGOncology_MDM.accepted_values_adm_sfe_hco_targets_kam_child_target_flag__Y__N.fafd69b0be": [], "test.CGOncology_MDM.accepted_values_adm_sfe_hco_targets_hsd_target_flag__Y__N.276ace2e5a": [], "test.CGOncology_MDM.accepted_values_adm_sfe_hco_targets_msl_target_flag__Y__N.0e207c3aaa": [], "test.CGOncology_MDM.not_null_adm_sfe_hcp_targets_kmk_hcp_id.343a5058c2": [], "test.CGOncology_MDM.unique_adm_sfe_hcp_targets_kmk_hcp_id.b80969407d": [], "test.CGOncology_MDM.relationships_adm_sfe_hcp_targets_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_.4ca0295145": [], "test.CGOncology_MDM.accepted_values_adm_sfe_hcp_targets_kam_target_flag__Y__N.b025c684ba": [], "test.CGOncology_MDM.accepted_values_adm_sfe_hcp_targets_kam_decile__1__2__3__4__5__6__7__8__9__10.acc477934d": [], "test.CGOncology_MDM.not_null_std_dh_hco_dh_id.155e4b5801": [], "test.CGOncology_MDM.unique_std_dh_hco_dh_id.c89c925785": [], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_std_dh_hco_dh_id___0.c014a1da7b": [], "test.CGOncology_MDM.dbt_expectations_expect_column_value_lengths_to_be_between_std_dh_hco_normalized_org_name__2.5f688cf1f4": [], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_dh_hco_hq_address_line_1___a_z___hq_address_line_1_IS_NOT_NULL.027089ef29": [], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_std_dh_hco_hq_address_line_1_____hq_address_line_1_IS_NOT_NULL.bb2ad3576e": [], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_dh_hco_hq_city___a_z___hq_city_IS_NOT_NULL.be52dcc2b8": [], "test.CGOncology_MDM.not_null_std_dh_hco_source_hash.c5c2443af6": [], "test.CGOncology_MDM.dbt_expectations_expect_column_value_lengths_to_be_between_std_dh_hco_source_hash__64__64.524a96ddc2": [], "test.CGOncology_MDM.accepted_values_std_dh_hco_hq_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY__DC__PR__VI__GU__AS__MP.22828f4652": [], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_dh_hco_hq_zip_code___0_9_5___hq_zip_code_IS_NOT_NULL.53831fcfe7": [], "test.CGOncology_MDM.row_count_match_std_dh_hco_source_raw_dh_PRELAND_DH_ALL_COMPANIES_OVERVIEW_.8f7f1522b5": [], "test.CGOncology_MDM.dbt_expectations_expect_table_row_count_to_be_between_std_dh_hco_300000.3c0c96a031": [], "test.CGOncology_MDM.not_null_std_dh_hcp_npi.f78527bf39": [], "test.CGOncology_MDM.unique_std_dh_hcp_npi.3d97c53efa": [], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_dh_hcp_npi___0_9_10_.f3ce611aa7": [], "test.CGOncology_MDM.not_null_std_dh_hcp_last_name.4a4b23e2b8": [], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_std_dh_hcp_last_name_____last_name_IS_NOT_NULL.1257101c2c": [], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_std_dh_hcp_first_name_____first_name_IS_NOT_NULL.d2932f7c96": [], "test.CGOncology_MDM.accepted_values_std_dh_hcp_practice_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY__DC__PR__VI__GU__AS__MP__NS__PH.cc7ab9603a": [], "test.CGOncology_MDM.row_count_match_std_dh_hcp_NPI_IS_NOT_NULL__source_raw_dh_PRELAND_DH_PHYSICIANS_OVERVIEW_.396fdde72a": [], "test.CGOncology_MDM.not_null_std_dh_practice_location_practice_location_id.87970307c4": [], "test.CGOncology_MDM.unique_std_dh_practice_location_practice_location_id.d81b4d0eeb": [], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_dh_practice_location_address_line_1___a_z___address_line_1_IS_NOT_NULL.7604558e84": [], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_not_match_regex_std_dh_practice_location_address_line_1_____address_line_1_IS_NOT_NULL.d38c4fa34d": [], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_dh_practice_location_zip_code___0_9_5___zip_code_IS_NOT_NULL.08e160408e": [], "test.CGOncology_MDM.accepted_values_std_dh_practice_location_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY__DC__PR__VI__GU__AS__MP.4b60111d92": [], "test.CGOncology_MDM.not_null_std_dh_practice_location_unique_combined_key.c6f3a69f42": [], "test.CGOncology_MDM.row_count_match_std_dh_practice_location_PRACTICE_LOCATION_ID_IS_NOT_NULL__source_raw_dh_PRELAND_DH_PHYSICIAN_GROUP_PRACTICE_LOCATION_.176238d91c": [], "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_npi.980d3a3d64": [], "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_affiliated_dh_id.d792350727": [], "test.CGOncology_MDM.accepted_values_std_dh_hcp_hco_affiliation_affiliation_type__CURRENT__HISTORICAL.c5017b3e1e": [], "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_is_current.55af4662bf": [], "test.CGOncology_MDM.accepted_values_std_dh_hcp_hco_affiliation_is_current__True__False.133669a192": [], "test.CGOncology_MDM.row_count_match_std_dh_hcp_hco_affiliation_NPI_IS_NOT_NULL_AND_AFFILIATED_ID_IS_NOT_NULL_AND_TRIM_CAST_AFFILIATED_ID_AS_VARCHAR_50___source_raw_dh_PRELAND_DH_PHYSICIANS_FACILITY_AFFILIATION_.b965d97151": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_hcp_hco_affiliation_npi__affiliated_dh_id.59c0275aa4": [], "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_dh_id.c15863164f": [], "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_affiliated_id.41b2bd78b8": [], "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_source_hash.0bd14f03fe": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_facility_to_facility_affiliation_dh_id__affiliated_id.8ff632a963": [], "test.CGOncology_MDM.not_null_std_ddd_hco_ddd_outlet_id.1b0484230f": [], "test.CGOncology_MDM.unique_std_ddd_hco_ddd_outlet_id.c70c0abdc6": [], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_ddd_hco_ddd_outlet_name___a_z___ddd_outlet_name_IS_NOT_NULL.35cba45a91": [], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_std_ddd_hco_zip_code___0_9_5___zip_code_IS_NOT_NULL.b2c4f2e2df": [], "test.CGOncology_MDM.accepted_values_std_ddd_hco_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY__DC__PR__VI__GU__AS__MP.1e74911fad": [], "test.CGOncology_MDM.not_null_std_ddd_hco_class_of_trade.966b717e30": [], "test.CGOncology_MDM.accepted_values_std_ddd_hco_class_of_trade__CLINICS__HOSPITALS__CHAIN__INDEPENDENT__NURSING_HOME__HEALTH_CARE_PLAN__MAIL_SERVICE__MISCELLANEOUS__FOODSTORE__MASS_MERCHANDISER__N_A__UNKNOWN.f93e3e0083": [], "test.CGOncology_MDM.not_null_std_ddd_hco_is_zip_excluded.c6559e9806": [], "test.CGOncology_MDM.accepted_values_std_ddd_hco_is_zip_excluded__True__False.39c820062c": [], "test.CGOncology_MDM.not_null_std_ddd_hco_is_supply_chain_excluded.0e5299adc6": [], "test.CGOncology_MDM.accepted_values_std_ddd_hco_is_supply_chain_excluded__True__False.a885c0891c": [], "test.CGOncology_MDM.not_null_std_ddd_sales_ddd_outlet_id.d18206dc26": [], "test.CGOncology_MDM.not_null_std_ddd_sales_product_group_id.28e5d2f6ee": [], "test.CGOncology_MDM.accepted_values_std_ddd_sales_product_name__ADSTILADRIN__ANKTIVA__TICE_BCG__INLEXZO__OTHER.bd0919193d": [], "test.CGOncology_MDM.row_count_match_std_ddd_sales_DDD_OUTLET_NUMBER_IS_NOT_NULL_AND_PRODUCT_GROUP_ID_IS_NOT_NULL__source_raw_ddd_PRELAND_DDD_SALES_.e723d1ef6c": [], "test.CGOncology_MDM.not_null_std_medscout_hco_medscout_id.b291b23043": [], "test.CGOncology_MDM.unique_std_medscout_hco_medscout_id.a77c97f5fa": [], "test.CGOncology_MDM.not_null_std_medscout_hco_npi.f5cc69b5b3": [], "test.CGOncology_MDM.row_count_match_std_medscout_hco_NPI_IS_NOT_NULL__source_raw_medscout_PRELAND_MEDSCOUT_HCO_DATA_.bef7505a83": [], "test.CGOncology_MDM.not_null_std_medscout_hcp_medscout_id.24a1ca994e": [], "test.CGOncology_MDM.unique_std_medscout_hcp_medscout_id.48cf6c0773": [], "test.CGOncology_MDM.not_null_std_medscout_hcp_npi.77f3adaf1e": [], "test.CGOncology_MDM.not_null_std_medscout_hcp_last_name.32a63aaea7": [], "test.CGOncology_MDM.row_count_match_std_medscout_hcp_NPI_IS_NOT_NULL__source_raw_medscout_PRELAND_MEDSCOUT_HCP_DATA_.c13864403f": [], "test.CGOncology_MDM.not_null_std_dx_claims_MX_CLAIM_ID.2533d41622": [], "test.CGOncology_MDM.not_null_std_dx_claims_PATIENT_ID.f957d7d8f1": [], "test.CGOncology_MDM.not_null_std_dx_claims_SERVICE_DATE.9235ca5535": [], "test.CGOncology_MDM.not_null_std_dx_claims_DIAGNOSIS_CODE.eb269d8bef": [], "test.CGOncology_MDM.accepted_values_std_dx_claims_TREATMENT_CATEGORY__BC_DIAGNOSIS.fc5d7f855e": [], "test.CGOncology_MDM.accepted_values_std_dx_claims_PATIENT_GENDER__M__F__U__X.15a4bb0c64": [], "test.CGOncology_MDM.not_null_std_px_claims_PX_CLAIM_ID.ee2882f522": [], "test.CGOncology_MDM.not_null_std_px_claims_PATIENT_ID.bee2b9e04e": [], "test.CGOncology_MDM.not_null_std_px_claims_SERVICE_DATE.1002e03153": [], "test.CGOncology_MDM.accepted_values_std_px_claims_PROCEDURE_CODE_TYPE__CPTHCPCS__ICD10PROC.5ab255ec5c": [], "test.CGOncology_MDM.accepted_values_std_px_claims_TREATMENT_CATEGORY__TURBT__TICE_BCG__ADSTILADRIN__ANKTIVA__CYSTOSCOPY__KEYTRUDA__OTHER_PROCEDURES.49a71a7de5": [], "test.CGOncology_MDM.accepted_values_std_px_claims_PATIENT_GENDER__M__F__U__X.8c1d91c8d7": [], "test.CGOncology_MDM.not_null_std_rx_claims_RX_CLAIM_ID.bf79ee906e": [], "test.CGOncology_MDM.not_null_std_rx_claims_PATIENT_ID.465afae066": [], "test.CGOncology_MDM.not_null_std_rx_claims_FILL_DATE.70a2e61aad": [], "test.CGOncology_MDM.not_null_std_rx_claims_NDC11.1bfec2ed95": [], "test.CGOncology_MDM.accepted_values_std_rx_claims_TREATMENT_CATEGORY__TICE_BCG__ADSTILADRIN__ANKTIVA__OTHER_PROCEDURES.236093b5b7": [], "test.CGOncology_MDM.accepted_values_std_rx_claims_PATIENT_GENDER__M__F__U__X.0e6fac2fd6": [], "test.CGOncology_MDM.not_null_std_dx_bc_patients_PATIENT_ID.5f1553fb03": [], "test.CGOncology_MDM.unique_std_dx_bc_patients_PATIENT_ID.2b164dce90": [], "test.CGOncology_MDM.not_null_std_dx_bc_patients_EARLIEST_DX_DATE.9511ca689b": [], "test.CGOncology_MDM.accepted_values_std_dx_bc_patients_IDENTIFICATION_SOURCE__DX.d52ce05901": [], "test.CGOncology_MDM.not_null_std_px_bc_patients_PATIENT_ID.58b2a57a43": [], "test.CGOncology_MDM.unique_std_px_bc_patients_PATIENT_ID.e2e20292bd": [], "test.CGOncology_MDM.not_null_std_px_bc_patients_EARLIEST_PX_DATE.afa0f2a8ce": [], "test.CGOncology_MDM.accepted_values_std_px_bc_patients_IDENTIFICATION_SOURCE__PX.52f2870006": [], "test.CGOncology_MDM.not_null_std_rx_bc_patients_PATIENT_ID.71727e35f0": [], "test.CGOncology_MDM.unique_std_rx_bc_patients_PATIENT_ID.02957e8bb5": [], "test.CGOncology_MDM.not_null_std_rx_bc_patients_EARLIEST_RX_DATE.6fcf09063b": [], "test.CGOncology_MDM.accepted_values_std_rx_bc_patients_IDENTIFICATION_SOURCE__RX.8755a20de4": [], "test.CGOncology_MDM.not_null_std_dh_hco_hist_dh_id.7937f17fc0": [], "test.CGOncology_MDM.not_null_std_dh_hco_hist_version_number.7c4e6114b5": [], "test.CGOncology_MDM.not_null_std_dh_hco_hist_is_current.7ddaa82390": [], "test.CGOncology_MDM.accepted_values_std_dh_hco_hist_is_current__Y__N.4e0f166b09": [], "test.CGOncology_MDM.not_null_std_dh_hco_hist_is_active.131197f8f7": [], "test.CGOncology_MDM.accepted_values_std_dh_hco_hist_is_active__Y__N.b27d95e392": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_hco_hist_dh_id__version_number.23ca9667d1": [], "test.CGOncology_MDM.not_null_std_dh_practice_location_hist_kmk_pl_id.13975dc992": [], "test.CGOncology_MDM.not_null_std_dh_practice_location_hist_version_number.ca12478fce": [], "test.CGOncology_MDM.not_null_std_dh_practice_location_hist_is_current.85bf5428f8": [], "test.CGOncology_MDM.accepted_values_std_dh_practice_location_hist_is_current__Y__N.97ab5347ed": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_practice_location_hist_kmk_pl_id__version_number.8e31476c9a": [], "test.CGOncology_MDM.not_null_std_dh_hcp_hist_npi.019b3d8523": [], "test.CGOncology_MDM.not_null_std_dh_hcp_hist_version_number.855d421cee": [], "test.CGOncology_MDM.not_null_std_dh_hcp_hist_is_current.1974f68cf0": [], "test.CGOncology_MDM.accepted_values_std_dh_hcp_hist_is_current__Y__N.4648d155b9": [], "test.CGOncology_MDM.not_null_std_dh_hcp_hist_is_active.e041856ff2": [], "test.CGOncology_MDM.accepted_values_std_dh_hcp_hist_is_active__Y__N.882f8b924d": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_hcp_hist_npi__version_number.dbfe70f933": [], "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_hist_npi.28b5fbc518": [], "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_hist_affiliated_id.9b572d258d": [], "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_hist_version_number.e994c81d25": [], "test.CGOncology_MDM.not_null_std_dh_hcp_hco_affiliation_hist_is_current.37f0597c4a": [], "test.CGOncology_MDM.accepted_values_std_dh_hcp_hco_affiliation_hist_is_current__Y__N.1017a9ee9d": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_hcp_hco_affiliation_hist_npi__affiliated_id__version_number.e5ea84e2ec": [], "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_hist_dh_id.c1156c613e": [], "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_hist_affiliated_id.e6f7b4617d": [], "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_hist_version_number.03382a4b79": [], "test.CGOncology_MDM.not_null_std_dh_facility_to_facility_affiliation_hist_is_current.5b8241a75f": [], "test.CGOncology_MDM.accepted_values_std_dh_facility_to_facility_affiliation_hist_is_current__Y__N.6d0529eaa0": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_dh_facility_to_facility_affiliation_hist_dh_id__affiliated_id__version_number.6a1c689fcc": [], "test.CGOncology_MDM.not_null_std_ddd_hco_hist_ddd_outlet_id.9edec51303": [], "test.CGOncology_MDM.not_null_std_ddd_hco_hist_version_number.f697601dc5": [], "test.CGOncology_MDM.not_null_std_ddd_hco_hist_is_current.3ab5dde3a4": [], "test.CGOncology_MDM.accepted_values_std_ddd_hco_hist_is_current__Y__N.3cc9ac69ad": [], "test.CGOncology_MDM.not_null_std_ddd_hco_hist_is_active.d1163cfd85": [], "test.CGOncology_MDM.accepted_values_std_ddd_hco_hist_is_active__Y__N.228110045d": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_ddd_hco_hist_ddd_outlet_id__version_number.3ed056f0fc": [], "test.CGOncology_MDM.not_null_std_ddd_sales_hist_ddd_outlet_id.aae4b0d159": [], "test.CGOncology_MDM.not_null_std_medscout_hco_hist_medscout_id.32eb6a182a": [], "test.CGOncology_MDM.not_null_std_medscout_hco_hist_version_number.6fcd0d9465": [], "test.CGOncology_MDM.not_null_std_medscout_hco_hist_is_current.c89f159e10": [], "test.CGOncology_MDM.accepted_values_std_medscout_hco_hist_is_current__Y__N.1b6303c595": [], "test.CGOncology_MDM.not_null_std_medscout_hco_hist_is_active.97ee31c0e1": [], "test.CGOncology_MDM.accepted_values_std_medscout_hco_hist_is_active__Y__N.9be0124c5d": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_medscout_hco_hist_medscout_id__version_number.f5a93c52f3": [], "test.CGOncology_MDM.not_null_std_medscout_hcp_hist_medscout_id.0e8f48d476": [], "test.CGOncology_MDM.not_null_std_medscout_hcp_hist_version_number.be260d61c7": [], "test.CGOncology_MDM.not_null_std_medscout_hcp_hist_is_current.e6054c50ee": [], "test.CGOncology_MDM.accepted_values_std_medscout_hcp_hist_is_current__Y__N.cf3bdfa364": [], "test.CGOncology_MDM.not_null_std_medscout_hcp_hist_is_active.119b7dfec8": [], "test.CGOncology_MDM.accepted_values_std_medscout_hcp_hist_is_active__Y__N.927a3159c2": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_std_medscout_hcp_hist_medscout_id__version_number.2807cc00e5": [], "test.CGOncology_MDM.not_null_ref_time_periods_period_key.a9e994cf12": [], "test.CGOncology_MDM.unique_ref_time_periods_period_key.557cb7d317": [], "test.CGOncology_MDM.not_null_ref_time_periods_period_type.5eeae962e8": [], "test.CGOncology_MDM.accepted_values_ref_time_periods_period_type__MONTHLY__QUARTERLY__ROLLING__YTD__QTD__PY__PYTD__P2Y__CALENDAR_YEAR__LTD__TOTAL.5af4e4a14b": [], "test.CGOncology_MDM.not_null_ref_treatment_categories_code.1067f5254b": [], "test.CGOncology_MDM.not_null_ref_treatment_categories_code_type.4e9dabd64d": [], "test.CGOncology_MDM.accepted_values_ref_treatment_categories_code_type__DX__CPT__HCPCS__ICD10PCS__ICD9__NDC.67743f64a9": [], "test.CGOncology_MDM.accepted_values_ref_treatment_categories_metric_category__BC_DIAGNOSIS__TURBT__TICE_BCG__ADSTILADRIN__ANKTIVA__KEYTRUDA__CYSTOSCOPY__OTHER_PX__OTHER.3764e2253e": [], "test.CGOncology_MDM.not_null_ref_payor_types_raw_payor_type.7785659b91": [], "test.CGOncology_MDM.not_null_ref_payor_types_canonical_payor_type.67a25c16e9": [], "test.CGOncology_MDM.accepted_values_ref_payor_types_canonical_payor_type__COMMERCIAL__MEDICARE__MEDICAID__MEDICARE_ADVANTAGE__OTHER.0219c536fb": [], "test.CGOncology_MDM.not_null_adm_hco_master_kmk_hco_id.19c041cf01": [], "test.CGOncology_MDM.unique_adm_hco_master_kmk_hco_id.595890ac11": [], "test.CGOncology_MDM.relationships_adm_hco_master_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.5e67cf4dd2": [], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_adm_hco_master_kmk_hco_id___34_0_9_9_.59162648b2": [], "test.CGOncology_MDM.accepted_values_adm_hco_master_account_type__P1_LUGPA__P2_ACADEMIC__P2_NON_ACADEMIC__P3__FEDERAL__P3_CCS__P4_SMALL_INDEP_Ctr.4bd3ff3d4d": [], "test.CGOncology_MDM.accepted_values_adm_hco_master_account_type_priority__P1__P2__P3__P4.c308974a6e": [], "test.CGOncology_MDM.accepted_values_adm_hco_master_hierarchy_level__L1__L2__L3__L4.17118f63d4": [], "test.CGOncology_MDM.not_null_adm_hco_master_cust_backbone_flag.2eb804314f": [], "test.CGOncology_MDM.accepted_values_adm_hco_master_cust_backbone_flag__Y__N.66c59561ee": [], "test.CGOncology_MDM.accepted_values_adm_hco_master_network_target_flag__0__1.f1bb7a4710": [], "test.CGOncology_MDM.accepted_values_adm_hco_master_child_target_flag__0__1.f2eb08ef11": [], "test.CGOncology_MDM.accepted_values_adm_hco_master_kam_target_flag__Y__N.bae2588bce": [], "test.CGOncology_MDM.accepted_values_adm_hco_master_hsd_target_flag__Y__N.6622511c65": [], "test.CGOncology_MDM.accepted_values_adm_hco_master_msl_target_flag__Y__N.fc14917e51": [], "test.CGOncology_MDM.row_count_match_adm_hco_master_ref_mdm_customer_master_hco_.8e0ebfab64": [], "test.CGOncology_MDM.not_null_adm_hcp_master_kmk_hcp_id.9fed89113c": [], "test.CGOncology_MDM.unique_adm_hcp_master_kmk_hcp_id.3250d72e22": [], "test.CGOncology_MDM.relationships_adm_hcp_master_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_.29aa3c4a53": [], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_match_regex_adm_hcp_master_kmk_hcp_id___15_0_9_9_.0f016d3772": [], "test.CGOncology_MDM.not_null_adm_hcp_master_npi.b8c1e61554": [], "test.CGOncology_MDM.relationships_adm_hcp_master_npi__npi__ref_mdm_customer_master_hcp_.c817192688": [], "test.CGOncology_MDM.not_null_adm_hcp_master_cust_backbone_flag.aae912f453": [], "test.CGOncology_MDM.accepted_values_adm_hcp_master_cust_backbone_flag__Y__N.c77ea1fe72": [], "test.CGOncology_MDM.accepted_values_adm_hcp_master_kam_target_flag__Y__N.64ee4b29c7": [], "test.CGOncology_MDM.accepted_values_adm_hcp_master_kam_decile__1__2__3__4__5__6__7__8__9__10.756fdeacaf": [], "test.CGOncology_MDM.row_count_match_adm_hcp_master_ref_mdm_customer_master_hcp_.45f3a4cae5": [], "test.CGOncology_MDM.not_null_adm_hco_hierarchy_kmk_hco_id.57589754c5": [], "test.CGOncology_MDM.unique_adm_hco_hierarchy_kmk_hco_id.af11937683": [], "test.CGOncology_MDM.relationships_adm_hco_hierarchy_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.1d6b8c0dce": [], "test.CGOncology_MDM.not_null_adm_hco_hierarchy_hierarchy_level.8368eddce9": [], "test.CGOncology_MDM.accepted_values_adm_hco_hierarchy_hierarchy_level__L1__L2__L3__L4.aedee61f35": [], "test.CGOncology_MDM.relationships_adm_hco_hierarchy_account_id_l1__kmk_hco_id__ref_mdm_customer_master_hco_.23c5f3762e": [], "test.CGOncology_MDM.relationships_adm_hco_hierarchy_account_id_l2__kmk_hco_id__ref_mdm_customer_master_hco_.1db54b1492": [], "test.CGOncology_MDM.relationships_adm_hco_hierarchy_account_id_l3__kmk_hco_id__ref_mdm_customer_master_hco_.c75c8794ac": [], "test.CGOncology_MDM.relationships_adm_hco_hierarchy_account_id_l4__kmk_hco_id__ref_mdm_customer_master_hco_.11f5ece339": [], "test.CGOncology_MDM.not_null_adm_claims_metrics_long_entity_type.4ee8824a9d": [], "test.CGOncology_MDM.accepted_values_adm_claims_metrics_long_entity_type__HCO__HCP.ae7d2aedac": [], "test.CGOncology_MDM.not_null_adm_claims_metrics_long_entity_id.62f222c646": [], "test.CGOncology_MDM.not_null_adm_claims_metrics_long_metric_category.a993d0d928": [], "test.CGOncology_MDM.accepted_values_adm_claims_metrics_long_metric_category__BC_DIAGNOSIS__TURBT__TICE_BCG__ADSTILADRIN__ANKTIVA__KEYTRUDA__CYSTOSCOPY__OTHER_PROCEDURES__Total_Claims.94301565dc": [], "test.CGOncology_MDM.not_null_adm_claims_metrics_long_period_key.a7e5be47da": [], "test.CGOncology_MDM.not_null_adm_claims_metrics_long_claim_count.e55d380d3c": [], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_be_between_adm_claims_metrics_long_claim_count__0.d16650926f": [], "test.CGOncology_MDM.not_null_adm_claims_metrics_long_patient_count.a793935234": [], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_be_between_adm_claims_metrics_long_patient_count__0.52b56d55e6": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_adm_claims_metrics_long_entity_type__entity_id__metric_category__period_key.bd089e0447": [], "test.CGOncology_MDM.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_adm_claims_metrics_long_claim_count__patient_count__True.4687b44aa9": [], "test.CGOncology_MDM.not_null_adm_claims_metrics_by_payor_entity_type.cab3d439d4": [], "test.CGOncology_MDM.accepted_values_adm_claims_metrics_by_payor_entity_type__HCO__HCP.0d142bb56f": [], "test.CGOncology_MDM.not_null_adm_claims_metrics_by_payor_entity_id.da949df3be": [], "test.CGOncology_MDM.not_null_adm_claims_metrics_by_payor_metric_category.4d935aea00": [], "test.CGOncology_MDM.not_null_adm_claims_metrics_by_payor_payor_type.0155c9899e": [], "test.CGOncology_MDM.accepted_values_adm_claims_metrics_by_payor_payor_type__COMMERCIAL__MEDICARE__MEDICAID__MEDICARE_ADVANTAGE__OTHER__ALL.6c39bb89fc": [], "test.CGOncology_MDM.not_null_adm_hco_claims_wide_kmk_hco_id.c341d38d95": [], "test.CGOncology_MDM.relationships_adm_hco_claims_wide_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.6f179ab665": [], "test.CGOncology_MDM.not_null_adm_hco_claims_wide_metric_category.0ee4d97e6c": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_adm_hco_claims_wide_kmk_hco_id__metric_category.6de5f75027": [], "test.CGOncology_MDM.not_null_adm_hcp_claims_wide_kmk_hcp_id.8632196ef4": [], "test.CGOncology_MDM.relationships_adm_hcp_claims_wide_kmk_hcp_id__kmk_hcp_id__ref_mdm_customer_master_hcp_.a271032517": [], "test.CGOncology_MDM.not_null_adm_hcp_claims_wide_metric_category.2721711915": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_adm_hcp_claims_wide_kmk_hcp_id__metric_category.f671822c9f": [], "test.CGOncology_MDM.not_null_adm_nmibc_risk_patient_id.fab493a5d5": [], "test.CGOncology_MDM.unique_adm_nmibc_risk_patient_id.0f914ec428": [], "test.CGOncology_MDM.not_null_adm_nmibc_risk_nmibc_risk_tier.d7a1407372": [], "test.CGOncology_MDM.accepted_values_adm_nmibc_risk_nmibc_risk_tier__HIGH__INTERMEDIATE__LOW.ea5c66bfb9": [], "test.CGOncology_MDM.not_null_adm_hco_nmibc_metrics_kmk_hco_id.879ce27570": [], "test.CGOncology_MDM.unique_adm_hco_nmibc_metrics_kmk_hco_id.d9d7542acd": [], "test.CGOncology_MDM.relationships_adm_hco_nmibc_metrics_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.9077e1ad59": [], "test.CGOncology_MDM.not_null_adm_hco_nmibc_metrics_total_nmibc_patients.a38658c0ce": [], "test.CGOncology_MDM.not_null_adm_hco_nmibc_metrics_high_risk_nmibc_patients.05ab66c196": [], "test.CGOncology_MDM.not_null_adm_hco_nmibc_metrics_mid_risk_nmibc_patients.fa614f1d00": [], "test.CGOncology_MDM.not_null_adm_hco_nmibc_metrics_low_risk_nmibc_patients.3ca3bd0262": [], "test.CGOncology_MDM.not_null_adm_ddd_metrics_grain_outlet_no.bd9c6a4fba": [], "test.CGOncology_MDM.not_null_adm_ddd_metrics_grain_product_group_id.b56b99cd4d": [], "test.CGOncology_MDM.accepted_values_adm_ddd_metrics_grain_product_group_id__1__2__3__4__7.85590311ef": [], "test.CGOncology_MDM.not_null_adm_ddd_metrics_grain_kmk_hco_id.af8e20f7b3": [], "test.CGOncology_MDM.not_null_adm_ddd_metrics_grain_sales_amount.c0f65820e3": [], "test.CGOncology_MDM.not_null_adm_ddd_metrics_grain_units_count.05cd92af6c": [], "test.CGOncology_MDM.not_null_adm_ddd_metrics_grain_month_num.e58f620175": [], "test.CGOncology_MDM.dbt_expectations_expect_column_values_to_be_between_adm_ddd_metrics_grain_month_num__24__1.cca6edfe9a": [], "test.CGOncology_MDM.dbt_expectations_expect_table_row_count_to_be_between_adm_ddd_metrics_grain_50000.0acb967837": [], "test.CGOncology_MDM.not_null_adm_ddd_metrics_wide_kmk_hco_id.eb1befe131": [], "test.CGOncology_MDM.relationships_adm_ddd_metrics_wide_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.7717014ac4": [], "test.CGOncology_MDM.not_null_adm_ddd_metrics_wide_metric_category.5264fc27ec": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_adm_ddd_metrics_wide_kmk_hco_id__metric_category.95bbc51f56": [], "test.CGOncology_MDM.not_null_adm_ddd_metrics_long_entity_type.3a48119566": [], "test.CGOncology_MDM.accepted_values_adm_ddd_metrics_long_entity_type__HCO.8cdf8eb4c5": [], "test.CGOncology_MDM.not_null_adm_ddd_metrics_long_entity_id.5d26527a34": [], "test.CGOncology_MDM.not_null_adm_ddd_metrics_long_metric_category.6ff3e16807": [], "test.CGOncology_MDM.accepted_values_adm_ddd_metrics_long_metric_category__TICE_BCG__ADSTILADRIN__ANKTIVA__INLEXZO__TOTAL_BRANDED__TOTAL__OTHER.84c56bf16a": [], "test.CGOncology_MDM.not_null_adm_ddd_metrics_long_period_key.9bdfea608e": [], "test.CGOncology_MDM.not_null_adm_ddd_metrics_long_period_type.1b0e3c4c83": [], "test.CGOncology_MDM.accepted_values_adm_ddd_metrics_long_period_type__MONTHLY__QUARTERLY__ROLLING__YTD__QTD__PY__PYTD__P2Y__CALENDAR_YEAR__LTD__TOTAL.60fff9a04a": [], "test.CGOncology_MDM.not_null_adm_ddd_metrics_long_data_date.350c355f44": [], "test.CGOncology_MDM.dbt_expectations_expect_table_row_count_to_be_between_adm_ddd_metrics_long_100000.0fbaec9138": [], "test.CGOncology_MDM.not_null_adm_lowest_level_metrics_kmk_hco_id.55b4f59cf8": [], "test.CGOncology_MDM.relationships_adm_lowest_level_metrics_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.a9076ad74b": [], "test.CGOncology_MDM.not_null_adm_lowest_level_metrics_metric_category.70e347ae8a": [], "test.CGOncology_MDM.not_null_adm_lowest_level_metrics_metric_code.b05b2de93c": [], "test.CGOncology_MDM.not_null_adm_lowest_level_metrics_period_key.580102b640": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_adm_lowest_level_metrics_kmk_hco_id__metric_category__metric_code__period_key.98b6841877": [], "test.CGOncology_MDM.not_null_ref_address_best_hco_kmk_hco_id.f5e718f933": [], "test.CGOncology_MDM.unique_ref_address_best_hco_kmk_hco_id.a384281d43": [], "test.CGOncology_MDM.relationships_ref_address_best_hco_kmk_hco_id__kmk_hco_id__ref_mdm_customer_master_hco_.0936f794de": [], "test.CGOncology_MDM.not_null_ref_address_best_hco_address_group_id.53d638d7eb": [], "test.CGOncology_MDM.not_null_ref_address_best_hco_address_best_hco_id.dab8f5f797": [], "test.CGOncology_MDM.not_null_ref_address_best_hco_is_address_best.49ac58e764": [], "test.CGOncology_MDM.accepted_values_ref_address_best_hco_is_address_best__Y__N.4821daa5cd": [], "test.CGOncology_MDM.not_null_ref_address_best_hco_address_group_count.a48f51a241": [], "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_entity_type.7f2a2cf4d0": [], "test.CGOncology_MDM.accepted_values_adm_address_best_hco_metrics_long_entity_type__ADDRESS_BEST_HCO.e3223ff58e": [], "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_entity_id.58f585bf06": [], "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_metric_category.61333a3296": [], "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_period_key.6479f81b48": [], "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_claim_count.16f35ae23f": [], "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_patient_count.e3d2699c30": [], "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_long_contributing_hco_count.95bedc6749": [], "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_wide_kmk_hco_id.7132de2edb": [], "test.CGOncology_MDM.not_null_adm_address_best_hco_metrics_wide_metric_category.2d7e0dbc9e": [], "test.CGOncology_MDM.not_null_adm_address_best_ddd_metrics_long_entity_type.bbb73a3e00": [], "test.CGOncology_MDM.accepted_values_adm_address_best_ddd_metrics_long_entity_type__ADDRESS_BEST_HCO.76d303acb5": [], "test.CGOncology_MDM.not_null_adm_address_best_ddd_metrics_long_entity_id.dc95135281": [], "test.CGOncology_MDM.not_null_adm_address_best_ddd_metrics_long_metric_category.d523793836": [], "test.CGOncology_MDM.accepted_values_adm_address_best_ddd_metrics_long_metric_category__TICE_BCG__ADSTILADRIN__ANKTIVA__INLEXZO__TOTAL_BRANDED__TOTAL__OTHER.c8ce60c168": [], "test.CGOncology_MDM.not_null_adm_address_best_ddd_metrics_long_period_key.10fec1acd6": [], "test.CGOncology_MDM.not_null_adm_address_best_ddd_metrics_wide_kmk_hco_id.945c4a01b0": [], "test.CGOncology_MDM.not_null_adm_address_best_ddd_metrics_wide_metric_category.215003c5bc": [], "test.CGOncology_MDM.not_null_adm_pipeline_snapshot_run_timestamp.ff8bc8e6ff": [], "test.CGOncology_MDM.not_null_adm_pipeline_snapshot_data_date.d3d141b40b": [], "test.CGOncology_MDM.not_null_adm_pipeline_snapshot_metric_group.3587125e97": [], "test.CGOncology_MDM.not_null_adm_pipeline_snapshot_metric_name.7ed1bacdec": [], "test.CGOncology_MDM.not_null_adm_pipeline_snapshot_metric_value.f59cc31a65": [], "test.CGOncology_MDM.accepted_values_adm_pipeline_diff_severity__CRITICAL__WARNING__INFO__OK.5092607787": [], "test.CGOncology_MDM.not_null_adm_pipeline_trend_data_date.f3fa81fdfb": [], "test.CGOncology_MDM.not_null_adm_pipeline_trend_metric_group.7c11051e3c": [], "test.CGOncology_MDM.not_null_adm_pipeline_trend_metric_name.e432676a27": [], "test.CGOncology_MDM.not_null_accounts_account_id.f3516ebe86": [], "test.CGOncology_MDM.unique_accounts_account_id.4e8028f44d": [], "test.CGOncology_MDM.not_null_hcps_hcp_id.9d00a42a49": [], "test.CGOncology_MDM.unique_hcps_hcp_id.7cd4d1db94": [], "test.CGOncology_MDM.not_null_account_metric_value_account_id.daca68f839": [], "test.CGOncology_MDM.not_null_account_metric_value_metric.7d4142e6c1": [], "test.CGOncology_MDM.not_null_account_metric_value_x_value.7266aac6a3": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_account_metric_value_account_id__metric__x_value.a7fdcfc32d": [], "test.CGOncology_MDM.not_null_geo_metric_value_geography_id.c03bcc8173": [], "test.CGOncology_MDM.not_null_geo_metric_value_metric.6c74eefef1": [], "test.CGOncology_MDM.not_null_geo_metric_value_x_value.7d369f5606": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_geo_metric_value_geography_id__metric__x_value.9b6b21c19d": [], "test.CGOncology_MDM.not_null_account_hcps_account_id.9105429673": [], "test.CGOncology_MDM.not_null_account_hcps_hcp_id.4ade91a768": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_account_hcps_account_id__hcp_id.e5ab65a978": [], "test.CGOncology_MDM.not_null_targets_team_code.f3721486b3": [], "test.CGOncology_MDM.not_null_targets_account_id.1ed19c89aa": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_targets_team_code__account_id.7822ba6bb9": [], "test.CGOncology_MDM.not_null_accounts_geo_affiliation_account_id.d02fe7ab82": [], "test.CGOncology_MDM.not_null_accounts_geo_affiliation_geo_code.4cc1f22303": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_accounts_geo_affiliation_account_id__geo_code.33b45a1a4a": [], "test.CGOncology_MDM.not_null_account_payer_types_account_id.f1840ce997": [], "test.CGOncology_MDM.not_null_account_payer_types_payer_type.de70e0d27e": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_account_payer_types_account_id__payer_type__product.91f9599d2f": [], "test.CGOncology_MDM.not_null_account_executives_account_id.fcc34ca9c9": [], "test.CGOncology_MDM.not_null_account_executives_executive_id.3fc9f05c72": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_account_executives_account_id__executive_id.bd23489999": [], "test.CGOncology_MDM.not_null_geographies_geo_code.a5991755ab": [], "test.CGOncology_MDM.unique_geographies_geo_code.7f462935fb": [], "test.CGOncology_MDM.not_null_account_levels_code.849ccc9022": [], "test.CGOncology_MDM.unique_account_levels_code.5bdbf79dd1": [], "test.CGOncology_MDM.not_null_account_types_code.71ee76f58d": [], "test.CGOncology_MDM.unique_account_types_code.970ebf6203": [], "test.CGOncology_MDM.not_null_teams_team_code.564726c6b6": [], "test.CGOncology_MDM.unique_teams_team_code.4a63fda674": [], "test.CGOncology_MDM.not_null_metric_list_code.decbcfb7bd": [], "test.CGOncology_MDM.unique_metric_list_code.e46edf3df9": [], "test.CGOncology_MDM.not_null_payer_types_code.fe7996f333": [], "test.CGOncology_MDM.unique_payer_types_code.bb3be8482d": [], "test.CGOncology_MDM.not_null_units_unit_code.06667a1d29": [], "test.CGOncology_MDM.unique_units_unit_code.f733452279": [], "test.CGOncology_MDM.not_null_states_code.ef45871ca2": [], "test.CGOncology_MDM.unique_states_code.a1c69eafa1": [], "test.CGOncology_MDM.not_null_firm_types_code.de9c62050f": [], "test.CGOncology_MDM.unique_firm_types_code.05448a131a": [], "test.CGOncology_MDM.not_null_data_source_data_source.bac58ac78f": [], "test.CGOncology_MDM.unique_data_source_data_source.add5f8ee8f": [], "test.CGOncology_MDM.not_null_config_charts_chart_code.a0fe743549": [], "test.CGOncology_MDM.unique_config_charts_chart_code.053a97cd50": [], "test.CGOncology_MDM.not_null_data_points_code.3eed85fe8d": [], "test.CGOncology_MDM.unique_data_points_code.a0594e6970": [], "test.CGOncology_MDM.not_null_executives_executive_id.cfcbd8a9f1": [], "test.CGOncology_MDM.unique_executives_executive_id.d4fe1ece33": [], "test.CGOncology_MDM.not_null_geo_levels_unit_code.2ed13993b7": [], "test.CGOncology_MDM.dbt_utils_unique_combination_of_columns_geo_levels_unit_code__level.620331e0a0": [], "source.CGOncology_MDM.raw_dh.PRELAND_DH_ALL_COMPANIES_OVERVIEW": ["model.CGOncology_MDM.std_dh_hco", "test.CGOncology_MDM.row_count_match_std_dh_hco_source_raw_dh_PRELAND_DH_ALL_COMPANIES_OVERVIEW_.8f7f1522b5"], "source.CGOncology_MDM.raw_dh.PRELAND_DH_PHYSICIANS_OVERVIEW": ["model.CGOncology_MDM.std_dh_hcp", "test.CGOncology_MDM.row_count_match_std_dh_hcp_NPI_IS_NOT_NULL__source_raw_dh_PRELAND_DH_PHYSICIANS_OVERVIEW_.396fdde72a"], "source.CGOncology_MDM.raw_dh.PRELAND_DH_PHYSICIAN_GROUP_PRACTICE_LOCATION": ["model.CGOncology_MDM.std_dh_practice_location", "test.CGOncology_MDM.row_count_match_std_dh_practice_location_PRACTICE_LOCATION_ID_IS_NOT_NULL__source_raw_dh_PRELAND_DH_PHYSICIAN_GROUP_PRACTICE_LOCATION_.176238d91c"], "source.CGOncology_MDM.raw_dh.PRELAND_DH_PHYSICIANS_FACILITY_AFFILIATION": ["model.CGOncology_MDM.std_dh_hcp_hco_affiliation", "test.CGOncology_MDM.row_count_match_std_dh_hcp_hco_affiliation_NPI_IS_NOT_NULL_AND_AFFILIATED_ID_IS_NOT_NULL_AND_TRIM_CAST_AFFILIATED_ID_AS_VARCHAR_50___source_raw_dh_PRELAND_DH_PHYSICIANS_FACILITY_AFFILIATION_.b965d97151"], "source.CGOncology_MDM.raw_dh.PRELAND_DH_FACILITY_TO_FACILITY_AFFILIATION": ["model.CGOncology_MDM.std_dh_facility_to_facility_affiliation"], "source.CGOncology_MDM.raw_dh.PRELAND_DH_BLADDERCANCER_HXMX_DIAGNOSIS": ["model.CGOncology_MDM.std_dx_claims"], "source.CGOncology_MDM.raw_dh.PRELAND_DH_BLADDERCANCER_HXMX_PROCEDURE": ["model.CGOncology_MDM.std_px_claims"], "source.CGOncology_MDM.raw_dh.PRELAND_DH_BLADDERCANCER_RX": ["model.CGOncology_MDM.std_rx_claims"], "source.CGOncology_MDM.raw_dh.PRELAND_CG_ONCOLOGY_FULL_MATCHING_RETURN_20241025": ["model.CGOncology_MDM.match_ddd_dhc"], "source.CGOncology_MDM.raw_medscout.PRELAND_MEDSCOUT_HCO_DATA": ["model.CGOncology_MDM.match_ddd_dhc", "model.CGOncology_MDM.std_medscout_hco", "test.CGOncology_MDM.row_count_match_std_medscout_hco_NPI_IS_NOT_NULL__source_raw_medscout_PRELAND_MEDSCOUT_HCO_DATA_.bef7505a83"], "source.CGOncology_MDM.raw_medscout.PRELAND_MEDSCOUT_HCP_DATA": ["model.CGOncology_MDM.std_medscout_hcp", "test.CGOncology_MDM.row_count_match_std_medscout_hcp_NPI_IS_NOT_NULL__source_raw_medscout_PRELAND_MEDSCOUT_HCP_DATA_.c13864403f"], "source.CGOncology_MDM.raw_ddd.PRELAND_DDD_DEMOGRAPHICS": ["model.CGOncology_MDM.std_ddd_hco"], "source.CGOncology_MDM.raw_ddd.PRELAND_DDD_SALES": ["model.CGOncology_MDM.std_ddd_hco", "model.CGOncology_MDM.std_ddd_sales", "test.CGOncology_MDM.row_count_match_std_ddd_sales_DDD_OUTLET_NUMBER_IS_NOT_NULL_AND_PRODUCT_GROUP_ID_IS_NOT_NULL__source_raw_ddd_PRELAND_DDD_SALES_.e723d1ef6c"], "source.CGOncology_MDM.cgoncology_dev_adm.HCP_AISSEL": ["model.CGOncology_MDM.adm_hcp_master"], "source.CGOncology_MDM.cgoncology_dev_adm.MEDICAL_INTERACTIONS": ["model.CGOncology_MDM.adm_hcp_master"], "source.CGOncology_MDM.cgoncology_dev_adm.MEDICAL_INSIGHTS": ["model.CGOncology_MDM.adm_hcp_master"], "source.CGOncology_MDM.cgoncology_dev_reporting.ACTIVITY_DASHBOARD_METRICS": ["model.CGOncology_MDM.adm_hcp_master"], "source.CGOncology_MDM.cgoncology_dev_reporting.CLINICAL_TRIAL_DATA": ["model.CGOncology_MDM.adm_hcp_master"], "source.CGOncology_MDM.cgoncology_dev_reporting.HCP_VIEW_DETAIL_TABLE": ["model.CGOncology_MDM.hcp_decile"], "source.CGOncology_MDM.staging.ADMIN_SITE_TARGET_LIST_ACCT_ID": ["model.CGOncology_MDM.stg_sfe_targets"], "source.CGOncology_MDM.staging.CHILD_SITE_TARGET_LIST_ACCT_ID": ["model.CGOncology_MDM.stg_sfe_targets"], "source.CGOncology_MDM.staging.CG_ONCOLOGY_HCP_TARGETING_LIST": ["model.CGOncology_MDM.stg_sfe_targets"], "source.CGOncology_MDM.cgoncology_prod_analytical.HSD_TARGET_UNIVERSE_UPDATED_RANK": ["model.CGOncology_MDM.stg_sfe_targets"], "source.CGOncology_MDM.cgoncology_prod_analytical.CG_MSL_Target_list": ["model.CGOncology_MDM.stg_sfe_targets"]}, "group_map": {}, "saved_queries": {}, "semantic_models": {}, "unit_tests": {}, "functions": {}}